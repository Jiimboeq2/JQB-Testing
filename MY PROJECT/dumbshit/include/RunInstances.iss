;RunInstances Script by Herculezz

variable(global) string help=Written by Herculezz, Join Discord: https://discord.gg/FT4VxMe, or visit www.isxri.com
variable(global) string about=Written by Herculezz, Join Discord: https://discord.gg/FT4VxMe, or visit www.isxri.com

variable(global) bool RI_Var_Bool_Podtstombhorrow=FALSE
variable(global) bool RI_Var_Bool_Podts=FALSE
variable(global) bool RI_Var_Bool_AcceptLoot=TRUE
variable(global) bool RI_Var_Bool_Loot=TRUE
variable(global) bool RI_Var_Bool_CorpseLoot=TRUE
variable(global) bool RI_Var_Bool_CancelMovement=FALSE
variable(global) bool RI_Var_Bool_BreakPathFunction=FALSE
variable(global) bool RI_Var_Bool_PauseMovement=FALSE
variable(global) string RI_Var_String_RunInstancesScriptName=${Script.Filename}
variable(global) bool RI_Var_Bool_QuestMode=FALSE
variable(global) bool RI_Var_Bool_PathDebug=FALSE
variable(global) bool RI_Var_Bool_RemoveAfterTrigger=FALSE
variable(global) bool RI_Var_Bool_AcceptRewards=TRUE
variable(global) bool RI_Var_Bool_IgnoreNamedForShiny=FALSE
variable int Distance=2
variable int MDistance=4
variable string CurrentLootWindowID=0
variable(global) bool ICantSeeMyTarget=FALSE
variable int ICantSeeMyTargetCNT=0
variable(global) bool RI_Var_Bool_Follow=TRUE
variable float TempX=0
variable float TempY=0
variable float TempZ=0
variable float TempOX=0
variable float TempOY=0
variable float TempOZ=0
variable(global) int RI_Var_Int_ShinyID=0
variable(global) int RI_Var_Int_LastShinyID=0
variable(global) int RI_Var_Int_SameShinyCount=0
variable int Precision=2
variable int LockSpotMax=125
variable string LineRead
variable file Filename
variable string CustomFunction
variable string CustomLoc
variable int WaitTime
variable string WaitLoc
variable string ClickActorName
variable string ClickActorLoc
variable string HailActorName
variable string HailActorLoc
variable string NamedName
variable bool LOD
variable string LODXYZ="2 2 2"
variable bool StandardNamed
variable bool CustomNamed
variable string NamedLoc
variable int ArrayPosition=0
variable int TempArrayPosition=0
variable bool FoundCloserWaypoint=FALSE
variable int64 ClosestWaypointDistance=999999
variable string ClosestWaypoint
variable string GarbageCollector
variable string AddName
variable bool KillAdd
variable bool LockForCombat=TRUE
variable bool StopForCombat=TRUE
variable bool ClearTarget=TRUE
variable bool Trigger=FALSE

variable bool MoveBehind=FALSE

variable(global) bool GlobalMoveBehind=TRUE
variable(global) bool GlobalRunQuests=FALSE
variable(global) index:string RI_Var_IndexString_MainToon
variable index:string IncomingText
variable index:string IncomingText2
variable index:string AnnounceText
variable string TriggerMessage
variable(global) int NameID
variable(global) int MobID
variable(global) bool GlobalExitInstance=FALSE
variable bool Developer=FALSE
variable bool Consuming=FALSE
variable bool RecentlyCheckedGatherRemains=FALSE
variable bool LockSpottingWasOff=FALSE
variable int ShinyScanDistance=100
;ArrayCounter variable
variable(global) int MainArrayCounter=0
variable int MyGroupSize
variable index:string MainQuestName
variable(global) RunInstancesObject RIObj
variable index:string istrMain
variable bool NoFile=FALSE
variable string MyZone=${Me.GetGameData[Self.ZoneName].Label}
variable string MyName=${Me.Name}
variable(global) bool IJustZonedLessThan10SecondsAgo=FALSE
variable(global) bool RI_Var_Bool_LoopZoneFile=FALSE
variable bool LoadedTLO=FALSE
variable string LoadedTLOName
variable(global) bool RI_MoveBehind=${RI_Obj_CB.GetUISetting[SettingsMoveBehindCheckBox]}
variable(global) bool RI_SkipMoveHealthCheck=${RI_Obj_CB.GetUISetting[SettingsSkipMobMoveHealthCheckBox]}
variable(global) int RI_MoveHealth=${RI_Obj_CB.GetUISetting[SettingsMoveHealthTextEntry]}
variable bool AcceptLootWasOff=FALSE
variable bool Skip100NotChecked=FALSE
;; Including what i need from these files directly

; #ifndef _PositionUtils_
	; #define _IncludePositionUtils_
	; #include "${LavishScript.HomeDirectory}/Scripts/EQ2Common/PositionUtils.iss"
; #endif
; #ifndef _CustomNamedToV_
	; #define _IncludeCustomNamedToV_
	; #include "${LavishScript.HomeDirectory}/Scripts/RunInstances/CustomNamedToV.iss"
; #endif
; #ifndef _CustomNamedAoM_
	; #define _IncludeCustomNamedAoM_
	; #include "${LavishScript.HomeDirectory}/Scripts/RunInstances/CustomNamedAoM.iss"
; #endif

;main function
function main(string FunctionToRun=NONE)
{
	;echo ${FunctionToRun}
	;disable RI_Var_Bool_Debugging
	Script:DisableDebugging
	
	;if ${FunctionToRun.Left[3].Upper.Equal["DEV"]} && ${Script[RI](exists)}
	;	noop
	;else
		RI_CMD_Hidden_RIS
	
	RI_Var_Bool_CancelMovement:Set[FALSE]
	RI_Var_Bool_PauseMovement:Set[FALSE]
	RI_Var_Bool_GlobalOthers:Set[FALSE]
	RI_Var_Bool_Start:Set[FALSE]
	RI_Var_Bool_Paused:Set[FALSE]
	Script[Buffer:RIMovement]:Resume
	RI_Var_Bool_Follow:Set[1]
	;set my groupsize
	;MyGroupSize:Set[${Me.Group}]
	
	;remove outdated files and folders
	declare count int
	declare FP filepath "${LavishScript.HomeDirectory}/Extensions/ISXDK34/"
	if ${FP.FileExists[ISXRIold.dll]}
		rm "${LavishScript.HomeDirectory}/Extensions/ISXDK34/ISXRIold.dll"
	if ${FP.FileExists[RI.dll]}
		rm "${LavishScript.HomeDirectory}/Extensions/ISXDK34/RI.dll"
	if ${FP.FileExists[RIold.dll]}
		rm "${LavishScript.HomeDirectory}/Extensions/ISXDK34/RIold.dll"
	FP:Set["${LavishScript.HomeDirectory}/Scripts/RunInstances/Zones/"]
	declare FL filelist 
	FL:GetFiles[${FP}*.*]

	if ${FP.PathExists}
	{
		if ${FL.Files}>0
		{

			for(count:Set[1];${count}<=${FL.Files};count:Inc)
			{
				if ${RI_Var_Bool_Debug}
					echo ${Time}: Removing file ${count}: ${FL.File[${count}].Filename}
				rm "${LavishScript.HomeDirectory}/Scripts/RunInstances/Zones/${FL.File[${count}].Filename}"
			}
			if ${RI_Var_Bool_Debug}
				echo ${Time}: Removing directory ${FP}
			rmdir "${FP}"
		}
		else
		{
			if ${RI_Var_Bool_Debug}
				echo ${Time}: Removing directory ${FP}
			rmdir "${FP}"
		}
	}
	FP:Set["${LavishScript.HomeDirectory}/Scripts/RunInstances/"]
	FL:Reset
	FL:GetFiles[${FP}*.*]

	if ${FP.PathExists}
	{
		if ${FL.Files}>0
		{

			for(count:Set[1];${count}<=${FL.Files};count:Inc)
			{
				if ${RI_Var_Bool_Debug}
					echo ${Time}: Removing file ${count}: ${FL.File[${count}].Filename}
				rm "${LavishScript.HomeDirectory}/Scripts/RunInstances/${FL.File[${count}].Filename}"
			}
			if ${RI_Var_Bool_Debug}
				echo ${Time}: Removing directory ${FP}
			rmdir "${FP}"
		}
		else
		{
			if ${RI_Var_Bool_Debug}
				echo ${Time}: Removing directory ${FP}
			rmdir "${FP}"
		}
	}
	;check if RI.xml exists, if not create
	FP:Set["${LavishScript.HomeDirectory}/Scripts/RI/"]
	if !${FP.PathExists}
	{
		FP:Set["${LavishScript.HomeDirectory}/Scripts/"]
		FP:MakeSubdirectory[RI]	
		FP:Set["${LavishScript.HomeDirectory}/Scripts/RI/"]
	}
	if !${FP.FileExists[RI.xml]}
	{
		if ${RI_Var_Bool_Debug}
			echo ${Time}: Getting RI.XML
		http -file "${LavishScript.HomeDirectory}/Scripts/RI/RI.xml" http://www.isxri.com/RI.xml
		wait 50
	}
	
	;events
	Event[EQ2_onAnnouncement]:AttachAtom[EQ2_onAnnouncement]
	Event[EQ2_onIncomingText]:AttachAtom[EQ2_onIncomingText]
	Event[EQ2_ReplyDialogAppeared]:AttachAtom[EQ2_ReplyDialogAppeared]
	Event[EQ2_onRewardWindowAppeared]:AttachAtom[EQ2_onRewardWindowAppeared]
	Event[EQ2_onQuestOffered]:AttachAtom[EQ2_onQuestOffered]
	
	if ${Exit}
		GlobalExitInstance:Set[TRUE]
	
	if ${Devel.Equal[TRUE]}
	{
		Developer:Set[TRUE]
		; if ${Me.Equipment[Food].AutoConsumeOn}
			; relay ${RI_Var_String_RelayGroup} Me.Equipment[Food]:ToggleAutoConsume
		; if ${Me.Equipment[Drink].AutoConsumeOn}
			; relay ${RI_Var_String_RelayGroup} Me.Equipment[Drink]:ToggleAutoConsume
		; if ${Me.Inventory[Elixir of Piety](exists)} && ${Me.Archetype.Equal[priest]} && ${Me.Inventory[Elixir of Piety].AutoConsumeOn}
			; Me.Inventory[Elixir of Piety]:ToggleAutoConsume
		; if ${Me.Inventory[Elixir of Deftness](exists)} && ${Me.Archetype.Equal[scout]} && ${Me.Inventory[Elixir of Deftness].AutoConsumeOn}
			; Me.Inventory[Elixir of Deftness]:ToggleAutoConsume
		; if ${Me.Inventory[Elixir of Intellect](exists)} && ${Me.Archetype.Equal[mage]} && ${Me.Inventory[Elixir of Intellect].AutoConsumeOn}
			; Me.Inventory[Elixir of Intellect]:ToggleAutoConsume
		; if ${Me.Inventory[Elixir of Fortitude](exists)} && !${RI_Var_Bool_GlobalOthers} && ${Me.Inventory[Elixir of Fortitude].AutoConsumeOn}
			; Me.Inventory[Elixir of Fortitude]:ToggleAutoConsume
	}
	variable bool Solo=FALSE
	if ( ${Me.Group}==1 || ${Me.GetGameData[Self.ZoneName].Label.Find["Solo]"](exists)} || ${Me.GetGameData[Self.ZoneName].Label.Equal["Arcanna'se Spire: Revealed"]} ) && ${FunctionToRun.Left[5].NotEqualCS[MAIN-]}
		Solo:Set[TRUE]

	;turn off ogre loot
	; if ${ISXOgre(exists)}
		; OgreBotAtom aExecuteAtom ${Me} a_UplinkControllerFunctionAutoType checkbox_settings_loot FALSE
	
	;changeloot options to round robin if developer
	if ${Developer} && ${FunctionToRun.NotEqual[RI_Var_Bool_GlobalOthers]} && ( ${FunctionToRun.Equal[NONE]} || ${FunctionToRun.Equal[DEVN]} ) && ${Me.IsGroupLeader} && ( ( !${Solo} && ${Me.Group}>2 ) || ( ${Solo} && ${Me.Group}==2 && ${Me.Group[1].Type.Equal[PC]} )
		call LootOptions RoundRobin
	
	;echo ${FunctionToRun}
	
	;enable LockSpotting if not enabled
	if ${Script[${RI_Var_String_CombatBotScriptName}](exists)} && ${RI_Obj_CB.GetUISetting[SettingsLockSpottingCheckBox].Equal[FALSE]}
	{
		RI_Obj_CB:SetUISetting[SettingsLockSpottingCheckBox,TRUE]
		LockSpottingWasOff:Set[TRUE]
	}

	;if we are not the main or we are calling a specific function

	if ( ${FunctionToRun.Equal[Q-RI_Var_Bool_GlobalOthers]} || ${FunctionToRun.Equal[DEV-RI_Var_Bool_GlobalOthers]} || ${FunctionToRun.Equal[RI_Var_Bool_GlobalOthers]} || !${Solo} || ${FunctionToRun.Find[MAIN]} || ${FunctionToRun.Find[DEVM]} || ${FunctionToRun.Find[DEVO]} ) && ( ( ${FunctionToRun.Equal[Q-RI_Var_Bool_GlobalOthers]} || ${FunctionToRun.Equal[RI_Var_Bool_GlobalOthers]} || ${FunctionToRun.Equal[DEV-RI_Var_Bool_GlobalOthers]} || ${FunctionToRun.Find[DEV]} || ${FunctionToRun.Find[MAIN]} || ${FunctionToRun.NotEqual[NONE]} ) && ${FunctionToRun.NotEqual[NONE]} && ${FunctionToRun.NotEqual[DEVN]} ) && !${FunctionToRun.Find[QUEST-](exists)}
	{
		RI_Var_IndexString_MainToon:Clear
		ui -reload "${LavishScript.HomeDirectory}/Interface/skins/eq2/eq2.xml"
		ui -reload -skin eq2 "${LavishScript.HomeDirectory}/Scripts/RI/RI.xml"
		UIElement[Start@RI]:SetText[Pause]
		UIElement[AutoLoot@RI]:Hide
		UIElement[RI]:SetHeight[40]
		UIElement[RI]:SetWidth[102]
		;;UIElement[RI]:SetWidth[112]
		;;UIElement[Start@RI]:SetX[26]
		;one our relaygroup is set, transfer over our relaygroup string and close RelayGroup
		;while !${RG_Var_Bool_RelayGroupSet}
		;wait 20
		;RI_Var_String_RelayGroup:Set[${RG_Var_String_RelayGroup}]
		;endscript Buffer:RelayGroup
		
		;turn on start bool and set RI_Var_Bool_GlobalOthers to true
		RI_Var_Bool_Start:Set[TRUE]
		RI_Var_Bool_GlobalOthers:Set[TRUE]
		RI_Var_Bool_Loot:Set[FALSE]
		;run movement script
		RIMovement
		if ${FunctionToRun.NotEqual[DEVN]} && ${FunctionToRun.NotEqual[NONE]} && ${FunctionToRun.NotEqual[RI_Var_Bool_GlobalOthers]} && ${FunctionToRun.NotEqual[DEV-RI_Var_Bool_GlobalOthers]} && ${FunctionToRun.NotEqual[Q-RI_Var_Bool_GlobalOthers]}
		{
			if ${FunctionToRun.Upper.Find[NAMEDLIST](exists)}
			{
				echo Available Nameds: Check Patch Notes
			}
			else
			{
				if ${FunctionToRun.Left[5].EqualCS[MAIN-]}
				{
					RI_Var_Bool_GlobalOthers:Set[FALSE]
					RIMUIObj:SetRIFollow[OFF]
					;RI_Atom_SetRIFollow OFF
					relay all -noredirect RG
					wait 20
					relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_RunInstances ${FunctionToRun.Right[-5].Left[1].Upper}${FunctionToRun.Right[-5].Right[-1].Lower}
					if ${FunctionToRun.Find[Tabor](exists)}
						call ${FunctionToRun.Right[-5].Left[1].Upper}${FunctionToRun.Right[-5].Right[-1]}
					call ${FunctionToRun.Right[-5].Left[1].Upper}${FunctionToRun.Right[-5].Right[-1].Lower}
				}
				elseif ${FunctionToRun.Left[5].EqualCS[DEVM-]}
				{
					echo ISXRI: DevMode Main
					RI_Var_Bool_GlobalOthers:Set[FALSE]
					RIMUIObj:SetRIFollow[OFF]
					;RI_Atom_SetRIFollow OFF
					relay all -noredirect RG
					wait 20
					relay "other ${RI_Var_String_RelayGroup}" run run RunInstances DEVO-${FunctionToRun.Right[-5].Left[1].Upper}${FunctionToRun.Right[-5].Right[-1].Lower}
					if ${FunctionToRun.Find[Tabor](exists)}
						call ${FunctionToRun.Right[-5].Left[1].Upper}${FunctionToRun.Right[-5].Right[-1]}
					call ${FunctionToRun.Right[-5].Left[1].Upper}${FunctionToRun.Right[-5].Right[-1].Lower}
				}
				elseif ${FunctionToRun.Left[5].EqualCS[DEVO-]}
				{
					echo ISXRI: DevMode GO
					call ${FunctionToRun.Right[-5].Left[1].Upper}${FunctionToRun.Right[-5].Right[-1].Lower}
				}
				else
					call ${FunctionToRun}
			}
			wait 20
			Script:End
		}
		;run looter script - Now Part of RI
		;RILooter
		
		;run ogreplaynice
		;OgrePlayNice
		
		;run RI_CoT
		RI_CoT
		if ${FunctionToRun.Equal[DEV-RI_Var_Bool_GlobalOthers]}
			echo ISXRI: DevModeGO
		echo ISXRI: Starting RI v${RI_Var_Float_Version.Precision[2]}
		;get the zoneset if not questmode
		if ${FunctionToRun.NotEqual[Q-RI_Var_Bool_GlobalOthers]}
		{
			_PreGo_
			if ${NoFile}
				ImportZoneFile
		}
		if ${RI_Var_Bool_BackOffMerc}
		{
			eq2ex /merc backoff
			wait 5
			eq2ex /merc backoff	
		}
		while 1
		{
			call ExecuteQueued
			call ShinyCollection
			; if !${Consuming} && !${Developer}
			; {
				; if !${Me.Equipment[Food].AutoConsumeOn}
					; Me.Equipment[Food]:ToggleAutoConsume
				; if !${Me.Equipment[Drink].AutoConsumeOn}
					; Me.Equipment[Drink]:ToggleAutoConsume
				; if !${Me.Inventory[Elixir of Piety](exists)} && ${Me.Archetype.Equal[priest]} && ${Me.Inventory[Elixir of Piety].AutoConsumeOn}
					; Me.Inventory[Elixir of Piety]:ToggleAutoConsume
				; if !${Me.Inventory[Elixir of Deftness](exists)} && ${Me.Archetype.Equal[scout]} && ${Me.Inventory[Elixir of Deftness].AutoConsumeOn}
					; Me.Inventory[Elixir of Deftness]:ToggleAutoConsume
				; if !${Me.Inventory[Elixir of Intellect](exists)} && ${Me.Archetype.Equal[mage]} && ${Me.Inventory[Elixir of Intellect].AutoConsumeOn}
					; Me.Inventory[Elixir of Intellect]:ToggleAutoConsume
				; if !${Me.Inventory[Elixir of Fortitude](exists)} && !${RI_Var_Bool_GlobalOthers} && ${Me.Inventory[Elixir of Fortitude].AutoConsumeOn}
					; Me.Inventory[Elixir of Fortitude]:ToggleAutoConsume
				; Consuming:Set[TRUE]
			; }
				
			if ${Me.Archetype.Equal[priest]} && !${RecentlyCheckedGatherRemains}
			{
				call CheckGatherRemains
				RecentlyCheckedGatherRemains:Set[TRUE]
				TimedCommand 100 Script[${RI_Var_String_RunInstancesScriptName}].Variable[RecentlyCheckedGatherRemains]:Set[FALSE]
			}
			wait 2
		}
	}
	else
	{	
		;echo main
		ui -reload "${LavishScript.HomeDirectory}/Interface/skins/eq2/eq2.xml"
		ui -reload -skin eq2 "${LavishScript.HomeDirectory}/Scripts/RI/RI.xml"
		UIElement[AutoLoot@RI]:SetChecked
		UIElement[RI]:SetHeight[60]
		UIElement[RI]:SetWidth[102]
		;;UIElement[RI]:SetWidth[112]
		;;UIElement[AutoLoot@RI]:SetX[20]
		;;UIElement[Start@RI]:SetX[26]
		echo ISXRI: Starting RI v${RI_Var_Float_Version.Precision[2]}
		if ${Developer}
			echo Developer Mode
		echo ${about}
		
		;set and join our relaygroup, and wait a few
		relay all -noredirect RG
		;while !${RG_Var_Bool_RelayGroupSet}
		RI_Var_IndexString_MainToon:Clear
		wait 10
		relay ${RI_Var_String_RelayGroup} RI_Var_IndexString_MainToon:Insert["${Me.Name}"]
		wait 10
		relay ${RI_Var_String_RelayGroup} RI_CMD_Assist 1 ${Me.Name}
		if ${RI_Var_IndexString_MainToon.Used}>1
		{
			call MessageBox "Please do not relay all to run RI, just type RI on your MainToon/Tank and it will handle relaying to your group" 0
			Script:End
		}
		if !${UIElement[SettingsSkipMobAttackHealthCheckBox@SettingsFrame@CombatBotUI].Checked}
		{
			Skip100NotChecked:Set[TRUE]
			UIElement[SettingsSkipMobAttackHealthCheckBox@SettingsFrame@CombatBotUI]:SetChecked
		}
		;RI_Var_String_RelayGroup:Set[${RG_Var_String_RelayGroup}]
		;endscript Buffer:RelayGroup
		if !${RI_Obj_CB.GetUISetting[SettingsAcceptLootCheckBox]}
		{
			AcceptLootWasOff:Set[1]
			RI_Obj_CB:SetUISetting[SettingsAcceptLootCheckBox,1]
		}
		if ${FunctionToRun.Find[QUEST-](exists)}
		{
			;wait until we start
			RI_Var_Bool_QuestMode:Set[TRUE]
			UIElement[RI]:SetTitle[RQv${RI_Var_Float_Version.Precision[2]}]
			relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_RunInstances Q-RI_Var_Bool_GlobalOthers
			while !${RI_Var_Bool_Start}
				wait 1
			call QuestM "${FunctionToRun.Right[-6]}"
			return
		}
		
		;invoke RI on all other in our relaygroup
		if ${FunctionToRun.Equal[DEVN]}
		{
			echo ISXRI: DevMode
			relay "other ${RI_Var_String_RelayGroup}" -noredirect run run RunInstances DEV-RI_Var_Bool_GlobalOthers
		}
		else
		{
			relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_RunInstances RI_Var_Bool_GlobalOthers
		}
		;run movement script
		RIMovement
		;run looter script - NOW Part of RI
		;RILooter
		;run ogreplaynice
		;OgrePlayNice
		;run RI_AggroControl
		;RI_AggroControl
		RIMUIObj:SetRIFollow[OFF]
		;RI_Atom_SetRIFollow OFF
		wait 10
		if ${Started}
		{
			RI_Var_Bool_Start:Set[TRUE]
			UIElement[RunInstances].FindChild[RunInstances].FindChild[Main].FindChild[Start]:SetText[Pause]
		}
		
		;get the zoneset
		_PreGo_
		if ${NoFile}
			ImportZoneFile
			
		eq2ex /merc backoff
		wait 5
		eq2ex /merc backoff		
		
		do
		{
			;check for commands in que if so execute
			
			;check if Start has been triggered and Start script
			while !${RI_Var_Bool_Start}
			{
				wait 10
				call ExecuteQueued
			}
			;{
				;turn on food,drink and potion consumption
				; if !${Consuming} && !${Developer}
				; {
					; if !${Me.Equipment[Food].AutoConsumeOn}
						; Me.Equipment[Food]:ToggleAutoConsume
					; if !${Me.Equipment[Drink].AutoConsumeOn}
						; Me.Equipment[Drink]:ToggleAutoConsume
					; if !${Me.Inventory[Elixir of Piety](exists)} && ${Me.Archetype.Equal[priest]} && ${Me.Inventory[Elixir of Piety].AutoConsumeOn}
						; Me.Inventory[Elixir of Piety]:ToggleAutoConsume
					; if !${Me.Inventory[Elixir of Deftness](exists)} && ${Me.Archetype.Equal[scout]} && ${Me.Inventory[Elixir of Deftness].AutoConsumeOn}
						; Me.Inventory[Elixir of Deftness]:ToggleAutoConsume
					; if !${Me.Inventory[Elixir of Intellect](exists)} && ${Me.Archetype.Equal[mage]} && ${Me.Inventory[Elixir of Intellect].AutoConsumeOn}
						; Me.Inventory[Elixir of Intellect]:ToggleAutoConsume
					; if !${Me.Inventory[Elixir of Fortitude](exists)} && !${RI_Var_Bool_GlobalOthers} && ${Me.Inventory[Elixir of Fortitude].AutoConsumeOn}
						; Me.Inventory[Elixir of Fortitude]:ToggleAutoConsume
					; Consuming:Set[TRUE]
				; }
				;start script
				if ${RI_Var_Bool_Start}
					call Go
			;}
			call ShinyCollection
			wait 2
		}
		while ${RI_Var_Bool_LoopZoneFile}
	}
}
atom(global) WhereWeAt()
{
	echo ISXRI: We are at ${MainArrayCounter} position in the index and it reads:
	echo ISXRI: ${istrMain.Get[${MainArrayCounter}]}
}
atom(global) RI_Atom_AutoLoot(bool TF)
{
	relay ${RI_Var_String_RelayGroup} RI_Var_Bool_Loot:Set[${TF}]
	RI_Var_Bool_AcceptLoot:Set[${TF}]
}

atom EQ2_onQuestOffered(string Name, string Description, int Level, int StatusReward)
{
	if ${RI_Var_Bool_AcceptRewards}
	{
		if ${RewardWindow.NumRewards}<=1 && ${RewardWindow.NumRewards(exists)}
			TimedCommand 10 relay ${RI_Var_String_RelayGroup} RewardWindow:AcceptReward
	}
	TimedCommand 15 relay ${RI_Var_String_RelayGroup} RewardWindow:AcceptReward
	TimedCommand 17 relay ${RI_Var_String_RelayGroup} EQ2:AcceptPendingQuest
	TimedCommand 19 relay ${RI_Var_String_RelayGroup} RewardWindow:AcceptReward
	TimedCommand 20 QuestJournalWindow.ActiveQuest[${Name}]:Share
}
;atom triggered when an announcement is detected
atom EQ2_onAnnouncement(string Message, string SoundType, float Timer)
{
	if ${RI_Var_Bool_Debug}
		echo ${Time}:AnnounceText: ${Message}
	;if ${AnnounceText} exists in the announce, execute
	variable int _count
	for(_count:Set[1];${_count}<=${AnnounceText.Used};_count:Inc)
	{
		;echo ${Time}:AnnounceText: checking ${AnnounceText.Get[${_count}]} in ${Message}
		if ${Message.Find["${AnnounceText.Get[${_count}]}"](exists)}
		{
			;echo ${Time}:AnnounceText: Found ${AnnounceText.Get[${_count}]} in ${Message}
			Trigger:Set[TRUE]
			TriggerMessage:Set["${Message}"]
			if ${RI_Var_Bool_RemoveAfterTrigger}
				AnnounceText:Remove[${_count}]
		}
	}
	if ${RI_Var_Bool_RemoveAfterTrigger} && ${Trigger}
		AnnounceText:Collapse
}
;atom triggered when incommingtext is detected
atom EQ2_onIncomingText(string Text)
{
	if ${Text.Find["You have fallen to the ground"](exists)}
	{
		relay ${RI_Var_String_RelayGroup} eq2ex stand
		TimedCommand 10 relay ${RI_Var_String_RelayGroup} eq2ex stand
	}
	if ${Text.Find["You cannot see your target"](exists)} || ${Text.Find["Can't see target"](exists)}
	{
		if ${ICantSeeMyTargetCNT}<3
			ICantSeeMyTargetCNT:Inc
		else
		{
			ICantSeeMyTargetCNT:Set[0]
			ICantSeeMyTarget:Set[TRUE]
			TimedCommand 5 ICantSeeMyTarget:Set[FALSE]
			TimedCommand 5 ICantSeeMyTarget:Set[FALSE]
			TimedCommand 5 ICantSeeMyTarget:Set[FALSE]
		}
	}
	if ${RI_Var_Bool_Debug}
		echo ${Time}:IncomingText: ${Text}
	;if ${IncomingText} exists in the Incoming, execute
	variable int _count
	for(_count:Set[1];${_count}<=${IncomingText.Used};_count:Inc)
	{
		;echo ${Time}:IncomingText: checking "${IncomingText.Get[${_count}]}" in "${Text}" // \${Text.Find[${IncomingText.Get[${_count}]}](exists)} // ${Text.Find[${IncomingText.Get[${_count}]}](exists)}
		if ${IncomingText2.Used}>=${_count}
		{
			if ${Text.Find["${IncomingText.Get[${_count}]}"](exists)} && ${Text.Find["${IncomingText2.Get[${_count}]}"](exists)}
			{
				;echo ${Time}:IncomingText: Found ${IncomingText.Get[${_count}]} in ${Text}
				Trigger:Set[TRUE]
				TriggerMessage:Set["${Text}"]
				if ${RI_Var_Bool_RemoveAfterTrigger}
					IncomingText:Remove[${_count}];IncomingText2:Remove[${_count}]
			}
		}
		else
		{
			if ${Text.Find["${IncomingText.Get[${_count}]}"](exists)}
			{
				;echo ${Time}:IncomingText: Found ${IncomingText.Get[${_count}]} in ${Text}
				Trigger:Set[TRUE]
				TriggerMessage:Set["${Text}"]
				if ${RI_Var_Bool_RemoveAfterTrigger}
					IncomingText:Remove[${_count}]
			}
		}
	}	
	if ${RI_Var_Bool_RemoveAfterTrigger} && ${Trigger}
		IncomingText:Collapse;IncomingText2:Collapse
}
atom EQ2_ReplyDialogAppeared(string ID)
{
   	relay ${RI_Var_String_RelayGroup} -noredirect EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
}
atom EQ2_onRewardWindowAppeared()
{
	if ${RI_Var_Bool_AcceptRewards}
	{
		if ${EQ2.PendingQuestName.Equal[None]} && ${RewardWindow.NumRewards}<2
		{
			TimedCommand 15 RewardWindow:AcceptReward
			TimedCommand 18 RewardWindow:AcceptReward
			TimedCommand 20 RewardWindow:AcceptReward
		}
	}
	;relay ${RI_Var_String_RelayGroup} -noredirect 
}
function ShinyCollection()
{
	if ${EQ2UIPage[Journals,JournalsQuest].IsVisible} && ${EQ2UIPage[Journals,JournalsQuest].Child[Page,TabPages].Child[2].IsEnabled}
	{	
		wait 5
		EQ2UIPage[Journals,JournalsQuest].Child[Page,TabPages].Child[2].Child[6].Child[2].Child[1].Child[1]:LeftClick
		wait 5
		EQ2UIPage[Journals,JournalsQuest].Child[Page,TabPages].Child[2].Child[6].Child[2].Child[1].Child[1]:LeftClick
		wait 5
		EQ2UIPage[Journals,JournalsQuest]:Close
	}
}
function ReadBook(string _BookName, bool _ClickLastPage=FALSE, bool _CloseBook=FALSE)
{
	Me.Inventory["${_BookName}"]:Read
	wait 25
	if ${_ClickLastPage}
		EQ2UIPage[Popup,Book_Simple].Child[Button,LastButton]:LeftClick
	wait 25
	if ${_CloseBook}
		EQ2UIPage[Popup,Book_Simple]:Close
}
; atom(global) _PreGo_(string _EXTVar=~NONE~, bool _Verbose=TRUE)
; {
	; ;echo call PreGo "${_EXTVar}" "${_Verbose}"
	; call PreGo "${_EXTVar}" "${_Verbose}"
; }
atom(global) _PreGo_(string _EXTVar=~NONE~, bool _Verbose=TRUE, bool _Quest=FALSE)
{
    ;echo PreGo(string _EXTVar=~NONE~=${_EXTVar}, bool _Verbose=TRUE=${_Verbose})
	if ${_EXTVar.NotEqual[~NONE~]}
	{
		if ${_Quest}
		{
			istrMain:Clear
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${${_EXTVar}[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${${_EXTVar}[3rtZdjv7,${MainArrayCounter}]}]
		}
		else
			LoadZone ${_EXTVar}
		return
	}
	;if ${_Verbose}
	;	echo ISXRI: ${Time} Importing ZoneFile from Extension
	istrMain:Clear
	switch ${Me.GetGameData[Self.ZoneName].Label}
	{
		case Brokenskull Bay: Bilgewater Falls [Solo]
		case Brokenskull Bay: Bilgewater Falls [Advanced Solo]
		case Brokenskull Bay: Bilgewater Falls [Heroic]
		{
			RI_CMD_Hidden_AddTLO Bilgewater
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Bilgewater]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Bilgewater[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Bilgewater[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case The Fabled Acadechism [Heroic]
		{
			RI_CMD_Hidden_AddTLO Acadechism
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Acadechism]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Acadechism[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Acadechism[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Brokenskull Bay: Hoist the Yellow Jack [Heroic]
		{
			RI_CMD_Hidden_AddTLO Hoist
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Hoist]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Hoist[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Hoist[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Brokenskull Bay: Bosun's Private Stock [Event Heroic]
		{
			RI_CMD_Hidden_AddTLO Bosun
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Bosun]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Bosun[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Bosun[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Zavith'loa: The Lost Caverns [Heroic]
		{
			RI_CMD_Hidden_AddTLO Caverns
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Caverns]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Caverns[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Caverns[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Zavith'loa: The Hidden Caldera [Heroic]
		case Zavith'loa: The Hidden Caldera [Solo]
		case Zavith'loa: The Hidden Caldera [Advanced Solo]
		{
			RI_CMD_Hidden_AddTLO Caldera
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Caldera]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Caldera[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Caldera[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Zavith'loa: The Hunt [Event Heroic]
		{
			RI_CMD_Hidden_AddTLO Hunt
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Hunt]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Hunt[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Hunt[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Castle Highhold [Solo]
		case Castle Highhold [Advanced Solo]
		case Castle Highhold [Heroic]
		{
			RI_CMD_Hidden_AddTLO Highhold
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Highhold]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Highhold[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Highhold[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Castle Highhold: Thresinet's Den [Heroic]
		{
			RI_CMD_Hidden_AddTLO Thresinets
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Thresinets]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Thresinets[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Thresinets[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Castle Highhold: Insider Treachery [Event Heroic]
		{
			RI_CMD_Hidden_AddTLO Treachery
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Treachery]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Treachery[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Treachery[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Ossuary: Resonance of Malice [Heroic]
		{
			RI_CMD_Hidden_AddTLO Resonance
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Resonance]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Resonance[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Resonance[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Ossuary: Sanguine Fountains [Heroic]
		{
			RI_CMD_Hidden_AddTLO Sanguine
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Sanguine]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Sanguine[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Sanguine[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Ssraeshza Temple [Heroic]
		{
			RI_CMD_Hidden_AddTLO Temple
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Temple]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Temple[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Temple[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Ssraeshza Temple: Inner Sanctum [Heroic]
		{
			RI_CMD_Hidden_AddTLO InnerSanctum
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[InnerSanctum]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${InnerSanctum[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${InnerSanctum[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Ssraeshza Temple: Taskmaster's ;echo [Event Heroic]
		{
			RI_CMD_Hidden_AddTLO Taskmaster
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Taskmaster]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Taskmaster[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Taskmaster[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Ossuary of Malevolence [Contested]
		{
			RI_CMD_Hidden_AddTLO OssCon
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[OssCon]
			if ${Developer}
			{
				for(MainArrayCounter:Set[0];${MainArrayCounter}<${OssCon[3rtZdjv7,#]};MainArrayCounter:Inc)
					istrMain:Insert[${OssCon[3rtZdjv7,${MainArrayCounter}]}]
			}
			else
			{
				MessageBox "This is not a supported zone, please contact Herculezz on Either forums or IRC and let him know the zone name: ${Me.GetGameData[Self.ZoneName].Label} to be added, Best to get and post a screenshot of this."
				Script:End
			}
			break
		}
		case F.S. Distillery: Stowaways [Event Heroic]
		{
			RI_CMD_Hidden_AddTLO Stowaways
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Stowaways]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Stowaways[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Stowaways[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case F.S. Distillery: Stowaways [Challenge]
		{
			RI_CMD_Hidden_AddTLO StowawaysHM
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[StowawaysHM]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${StowawaysHM[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${StowawaysHM[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case F.S. Distillery: Distill or Be Killed [Heroic]
		{
			RI_CMD_Hidden_AddTLO Distill
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Distill]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Distill[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Distill[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case The Fabled Crypt of Valdoon [Heroic]
		{
			RI_CMD_Hidden_AddTLO Valdoon
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Valdoon]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Valdoon[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Valdoon[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case The Fabled Court of Innovation [Heroic]
		{
			RI_CMD_Hidden_AddTLO Court
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Court]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Court[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Court[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Stygian Threshold [Heroic] 
		case Stygian Threshold [Agnostic]
		{
			RI_CMD_Hidden_AddTLO Stygian
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Stygian]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Stygian[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Stygian[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Maldura: Bar Brawl [Event Heroic]
		{
			RI_CMD_Hidden_AddTLO BarBrawl
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[BarBrawl]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${BarBrawl[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${BarBrawl[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Maldura: District of Ash [Heroic]
		case Maldura: District of Ash [Agnostic]
		{
			RI_CMD_Hidden_AddTLO Ash
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Ash]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Ash[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Ash[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Maldura: Palace Foray [Event Heroic]
		{
			RI_CMD_Hidden_AddTLO Foray
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Foray]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Foray[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Foray[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Stygian Threshold: The Howling Gateway [Event Heroic]
		{
			RI_CMD_Hidden_AddTLO Howling
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Howling]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Howling[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Howling[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Kralet Penumbra: Rise to Power [Heroic]
		{
			RI_CMD_Hidden_AddTLO RiseToPower
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[RiseToPower]
			ShinyScanDistance:Set[10]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${RiseToPower[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Revealed[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Kralet Penumbra: Temple of the Ill-Seen [Heroic]
		{
			RI_CMD_Hidden_AddTLO IllSeen
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[IllSeen]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${IllSeen[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${IllSeen[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Kaesora: Xalgozian Stronghold [Expert]
		case Kaesora: Xalgozian Stronghold [Heroic]
		case Kaesora: Xalgozian Stronghold [Solo]
		{
			RI_CMD_Hidden_AddTLO Xalgozian
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Xalgozian]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Xalgozian[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Xalgozian[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Arcanna'se Spire: Forgotten Sanctum [Solo]
		case Arcanna'se Spire: Forgotten Sanctum [Heroic]
		case Arcanna'se Spire: Forgotten Sanctum [Expert]
		{
			RI_CMD_Hidden_AddTLO Sanctum
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Sanctum]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Sanctum[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Sanctum[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Arcanna'se Spire: Revealed
		{
			RI_CMD_Hidden_AddTLO Revealed
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Revealed]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Revealed[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Revealed[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Arcanna'se Spire: Repository of Secrets [Solo]
		case Arcanna'se Spire: Repository of Secrets [Heroic]
		case Arcanna'se Spire: Repository of Secrets [Expert]
		{
			RI_CMD_Hidden_AddTLO Repository
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Repository]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Repository[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Repository[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Arcanna'se Spire: Vessel of the Sorceress [Advanced Solo]
		case Arcanna'se Spire: Vessel of the Sorceress [Event Heroic]
		case Arcanna'se Spire: Vessel of the Sorceress [Expert Event]
		{
			RI_CMD_Hidden_AddTLO Vessel
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[Vessel]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${Vessel[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${Vessel[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Crypt of Dalnir: Baron's Workshop [Expert]
		case Crypt of Dalnir: Baron's Workshop [Heroic]
		case Crypt of Dalnir: Baron's Workshop [Solo]
		{
			RI_CMD_Hidden_AddTLO CryptofDalnirBaronsWorkshop
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[CryptofDalnirBaronsWorkshop]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${CryptofDalnirBaronsWorkshop[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${CryptofDalnirBaronsWorkshop[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Crypt of Dalnir: Ritual Chamber [Expert]
		case Crypt of Dalnir: Ritual Chamber [Heroic]
		case Crypt of Dalnir: Ritual Chamber [Solo]
		{
			RI_CMD_Hidden_AddTLO CryptofDalnirRitualChamber
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[CryptofDalnirRitualChamber]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${CryptofDalnirRitualChamber[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${CryptofDalnirRitualChamber[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Crypt of Dalnir: Wizard's Den [Advanced Solo]
		case Crypt of Dalnir: Wizard's Den [Event Heroic]
		case Crypt of Dalnir: Wizard's Den [Expert Event]
		{
			RI_CMD_Hidden_AddTLO WizardsDen
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[WizardsDen]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${WizardsDen[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${WizardsDen[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case The Ruins of Cabilis [Expert]
		case The Ruins of Cabilis [Heroic]
		case The Ruins of Cabilis [Solo]
		{
			RI_CMD_Hidden_AddTLO TheRuinsofCabilis
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[TheRuinsofCabilis]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${TheRuinsofCabilis[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${TheRuinsofCabilis[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Kaesora: Tomb of the Venerated [Expert Event]
		case Kaesora: Tomb of the Venerated [Event Heroic]
		case Kaesora: Tomb of the Venerated [Advanced Solo]
		{
			RI_CMD_Hidden_AddTLO KaesoraTomboftheVenerated
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[KaesoraTomboftheVenerated]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${KaesoraTomboftheVenerated[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${KaesoraTomboftheVenerated[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Lost City of Torsis: The Spectral Market [Expert]
		case Lost City of Torsis: The Spectral Market [Heroic]
		case Lost City of Torsis: The Spectral Market [Solo]
		{
			RI_CMD_Hidden_AddTLO LostCityofTorsisTheSpectralMarket
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[LostCityofTorsisTheSpectralMarket]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${LostCityofTorsisTheSpectralMarket[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${LostCityofTorsisTheSpectralMarket[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Lost City of Torsis: Reaver's Remnants [Expert Challenge]
		case Lost City of Torsis: Reaver's Remnants [Expert]
		case Lost City of Torsis: Reaver's Remnants [Challenge Heroic]
		case Lost City of Torsis: Reaver's Remnants [Heroic]
		case Lost City of Torsis: Reaver's Remnants [Solo]
		{
			RI_CMD_Hidden_AddTLO LostCityofTorsisReaversRemnants
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[LostCityofTorsisReaversRemnants]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${LostCityofTorsisReaversRemnants[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${LostCityofTorsisReaversRemnants[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Lost City of Torsis: The Shrouded Temple [Advanced Solo]
		case Lost City of Torsis: The Shrouded Temple [Expert Event]
		case Lost City of Torsis: The Shrouded Temple [Event Heroic]
		{
			RI_CMD_Hidden_AddTLO ShroudedTemple
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[ShroudedTemple]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${ShroudedTemple[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${ShroudedTemple[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Befallen: Cavern of the Afflicted [Agnostic]
		{
			echo ISXRI: ${Time} There is no ZoneFile in the Extension for ${Me.GetGameData[Self.ZoneName].Label}, Attempting to import default ZoneFile, or you can type ImportZoneFile filename to import a file (omitting filename, will attempt to load WriteLocs default file for the zone)
			NoFile:Set[TRUE]
			break
		}
		case Charasis: Maiden's Chamber [Agnostic]
		{
			RI_CMD_Hidden_AddTLO CharasisMaidensChamberAgnostic
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[CharasisMaidensChamberAgnostic]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${CharasisMaidensChamberAgnostic[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${CharasisMaidensChamberAgnostic[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Crypt of Valdoon [Agnostic]
		{
			echo ISXRI: ${Time} There is no ZoneFile in the Extension for ${Me.GetGameData[Self.ZoneName].Label}, Attempting to import default ZoneFile, or you can type ImportZoneFile filename to import a file (omitting filename, will attempt to load WriteLocs default file for the zone)
			NoFile:Set[TRUE]
			break
		}
		case Iceshard Keep [Agnostic]
		{
			echo ISXRI: ${Time} There is no ZoneFile in the Extension for ${Me.GetGameData[Self.ZoneName].Label}, Attempting to import default ZoneFile, or you can type ImportZoneFile filename to import a file (omitting filename, will attempt to load WriteLocs default file for the zone)
			NoFile:Set[TRUE]
			break
		}
		case Kralet Penumbra: Tepid Depths [Agnostic]
		{
			echo ISXRI: ${Time} There is no ZoneFile in the Extension for ${Me.GetGameData[Self.ZoneName].Label}, Attempting to import default ZoneFile, or you can type ImportZoneFile filename to import a file (omitting filename, will attempt to load WriteLocs default file for the zone)
			NoFile:Set[TRUE]
			break
		}
		case Kralet Penumbra: The Master's Chosen [Agnostic]
		{
			echo ISXRI: ${Time} There is no ZoneFile in the Extension for ${Me.GetGameData[Self.ZoneName].Label}, Attempting to import default ZoneFile, or you can type ImportZoneFile filename to import a file (omitting filename, will attempt to load WriteLocs default file for the zone)
			NoFile:Set[TRUE]
			break
		}
		case Library of Erudin [Agnostic]
		{
			echo ISXRI: ${Time} There is no ZoneFile in the Extension for ${Me.GetGameData[Self.ZoneName].Label}, Attempting to import default ZoneFile, or you can type ImportZoneFile filename to import a file (omitting filename, will attempt to load WriteLocs default file for the zone)
			NoFile:Set[TRUE]
			break
		}
		case Maldura: Algorithm For Destruction [Agnostic]
		{
			echo ISXRI: ${Time} There is no ZoneFile in the Extension for ${Me.GetGameData[Self.ZoneName].Label}, Attempting to import default ZoneFile, or you can type ImportZoneFile filename to import a file (omitting filename, will attempt to load WriteLocs default file for the zone)
			NoFile:Set[TRUE]
			break
		}
		case Temple of the Faceless [Agnostic]
		{ 
			echo ISXRI: ${Time} There is no ZoneFile in the Extension for ${Me.GetGameData[Self.ZoneName].Label}, Attempting to import default ZoneFile, or you can type ImportZoneFile filename to import a file (omitting filename, will attempt to load WriteLocs default file for the zone)
			NoFile:Set[TRUE]
			break
		}
		case The Crypt of Agony [Agnostic]
		{
			RI_CMD_Hidden_AddTLO CoA
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[CoA]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${CoA[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${CoA[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case The Deep Forge [Agnostic]
		{
			echo ISXRI: ${Time} There is no ZoneFile in the Extension for ${Me.GetGameData[Self.ZoneName].Label}, Attempting to import default ZoneFile, or you can type ImportZoneFile filename to import a file (omitting filename, will attempt to load WriteLocs default file for the zone)
			NoFile:Set[TRUE]
			break
		}
		case The Ruins of Guk: Halls of the Fallen [Agnostic]
		{
			echo ISXRI: ${Time} There is no ZoneFile in the Extension for ${Me.GetGameData[Self.ZoneName].Label}, Attempting to import default ZoneFile, or you can type ImportZoneFile filename to import a file (omitting filename, will attempt to load WriteLocs default file for the zone)
			NoFile:Set[TRUE]
			break
		}
		case Vasty Deep: The Conservatory [Agnostic]
		{
			echo ISXRI: ${Time} There is no ZoneFile in the Extension for ${Me.GetGameData[Self.ZoneName].Label}, Attempting to import default ZoneFile, or you can type ImportZoneFile filename to import a file (omitting filename, will attempt to load WriteLocs default file for the zone)
			NoFile:Set[TRUE]
			break
		}
		case Vaedenmoor, Realm of Despair
		{
			RI_CMD_Hidden_AddTLO VaedenmoorRealmofDespair
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[VaedenmoorRealmofDespair]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${VaedenmoorRealmofDespair[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${VaedenmoorRealmofDespair[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case The Frillik Tide
		{
			RI_CMD_Hidden_AddTLO TheFrillikTide
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[TheFrillikTide]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${TheFrillikTide[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${TheFrillikTide[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case The Underdepths [Proving Ground]
		{
			RI_CMD_Hidden_AddTLO TheUnderdepthsProvingGround
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[TheUnderdepthsProvingGround]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${TheUnderdepthsProvingGround[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${TheUnderdepthsProvingGround[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Mistmyr Manor
		{
			RI_CMD_Hidden_AddTLO MistmyrManor
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[MistmyrManor]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${MistmyrManor[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${MistmyrManor[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Ravenscale Repository
		{
			RI_CMD_Hidden_AddTLO RavenscaleRepository
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[RavenscaleRepository]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${RavenscaleRepository[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${RavenscaleRepository[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Plane of Innovation: Masks of the Marvelous [Solo]
		case Plane of Innovation: Masks of the Marvelous [Heroic]
		case Plane of Innovation: Masks of the Marvelous [Expert]
		{
			RI_CMD_Hidden_AddTLO PlaneofInnovationMasksoftheMarvelous
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[PlaneofInnovationMasksoftheMarvelous]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${PlaneofInnovationMasksoftheMarvelous[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${PlaneofInnovationMasksoftheMarvelous[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Plane of Innovation: Gears in the Machine [Solo]
		case Plane of Innovation: Gears in the Machine [Heroic]
		case Plane of Innovation: Gears in the Machine [Expert]
		{
			RI_CMD_Hidden_AddTLO PlaneofInnovationGearsintheMachine
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[PlaneofInnovationGearsintheMachine]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${PlaneofInnovationGearsintheMachine[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${PlaneofInnovationGearsintheMachine[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Plane of Innovation: Parts Not Included [Duo]
		case Plane of Innovation: Parts Not Included [Event Heroic]
		case Plane of Innovation: Parts Not Included [Expert Event]
		{
			RI_CMD_Hidden_AddTLO PlaneofInnovationPartsNotIncluded
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[PlaneofInnovationPartsNotIncluded]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${PlaneofInnovationPartsNotIncluded[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${PlaneofInnovationPartsNotIncluded[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Plane of Disease: Outbreak [Solo]
		case Plane of Disease: Outbreak [Heroic]
		case Plane of Disease: Outbreak [Expert]
		{
			RI_CMD_Hidden_AddTLO PlaneofDiseaseOutbreak
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[PlaneofDiseaseOutbreak]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${PlaneofDiseaseOutbreak[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${PlaneofDiseaseOutbreak[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Plane of Disease: The Source [Solo]
		case Plane of Disease: The Source [Heroic]
		case Plane of Disease: The Source [Expert]
		{
			RI_CMD_Hidden_AddTLO PlaneofDiseaseTheSource 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[PlaneofDiseaseTheSource]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${PlaneofDiseaseTheSource[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${PlaneofDiseaseTheSource[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Plane of Disease: Infested Mesa [Duo]
		case Plane of Disease: Infested Mesa [Event Heroic]
		case Plane of Disease: Infested Mesa [Expert Event]
		{
			RI_CMD_Hidden_AddTLO PlaneofDiseaseInfestedMesa 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[PlaneofDiseaseInfestedMesa]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${PlaneofDiseaseInfestedMesa[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${PlaneofDiseaseInfestedMesa[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Torden, Bastion of Thunder: Tower Breach [Solo]
		case Torden, Bastion of Thunder: Tower Breach [Heroic]
		case Torden, Bastion of Thunder: Tower Breach [Expert]
		{
			RI_CMD_Hidden_AddTLO TordenBastionofThunderTowerBreach 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[TordenBastionofThunderTowerBreach]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${TordenBastionofThunderTowerBreach[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${TordenBastionofThunderTowerBreach[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Torden, Bastion of Thunder: Winds of Change [Solo]
		case Torden, Bastion of Thunder: Winds of Change [Heroic]
		case Torden, Bastion of Thunder: Winds of Change [Expert]
		{
			RI_CMD_Hidden_AddTLO TordenBastionofThunderWindsofChange 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[TordenBastionofThunderWindsofChange]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${TordenBastionofThunderWindsofChange[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${TordenBastionofThunderWindsofChange[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Solusek Ro's Tower: The Obsidian Core [Solo]
		case Solusek Ro's Tower: The Obsidian Core [Heroic]
		case Solusek Ro's Tower: The Obsidian Core [Expert]
		{
			RI_CMD_Hidden_AddTLO SolusekRosTowerTheObsidianCore 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[SolusekRosTowerTheObsidianCore]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${SolusekRosTowerTheObsidianCore[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${SolusekRosTowerTheObsidianCore[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Solusek Ro's Tower: Monolith of Fire [Solo]
		case Solusek Ro's Tower: Monolith of Fire [Heroic]
		case Solusek Ro's Tower: Monolith of Fire [Expert]
		{
			RI_CMD_Hidden_AddTLO SolusekRosTowerMonolithofFire 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[SolusekRosTowerMonolithofFire]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${SolusekRosTowerMonolithofFire[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${SolusekRosTowerMonolithofFire[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Shard of Hate: Utter Contempt [Solo]
		case Shard of Hate: Utter Contempt [Heroic]
		case Shard of Hate: Udder Contempt [Herd Mode]
		{
			RI_CMD_Hidden_AddTLO ShardofHateUtterContempt
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[ShardofHateUtterContempt]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${ShardofHateUtterContempt[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${ShardofHateUtterContempt[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case "Brackish Vaults [Solo]"
		case "Brackish Vaults [Duo]"
		{
			RI_CMD_Hidden_AddTLO BrackishVaults 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[BrackishVaults]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${BrackishVaults[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${BrackishVaults[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Plane of Innovation: Security Measures [Tradeskill]
		{
			RI_CMD_Hidden_AddTLO PlaneofInnovationSecurityMeasuresTradeskill 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[PlaneofInnovationSecurityMeasuresTradeskill]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${PlaneofInnovationSecurityMeasuresTradeskill[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${PlaneofInnovationSecurityMeasuresTradeskill[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Torden, Bastion of Thunder: Lightning Strikes [Tradeskill]
		{
			RI_CMD_Hidden_AddTLO TordenBastionofThunderLightningStrikesTradeskill 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[TordenBastionofThunderLightningStrikesTradeskill]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${TordenBastionofThunderLightningStrikesTradeskill[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${TordenBastionofThunderLightningStrikesTradeskill[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Plane of Disease: Crypt of Decay [Tradeskill]
		{
			RI_CMD_Hidden_AddTLO PlaneofDiseaseCryptofDecayTradeskill
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[PlaneofDiseaseCryptofDecayTradeskill]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${PlaneofDiseaseCryptofDecayTradeskill[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${PlaneofDiseaseCryptofDecayTradeskill[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Solusek Ro's Tower: From the Ashes [Tradeskill]
		{
			RI_CMD_Hidden_AddTLO SolusekRosTowerFromtheAshesTradeskill
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[SolusekRosTowerFromtheAshesTradeskill]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${SolusekRosTowerFromtheAshesTradeskill[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${SolusekRosTowerFromtheAshesTradeskill[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Shard of Hate: Eye Spy [Tradeskill]
		{
			RI_CMD_Hidden_AddTLO ShardofHateEyeSpyTradeskill
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[ShardofHateEyeSpyTradeskill]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${ShardofHateEyeSpyTradeskill[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${ShardofHateEyeSpyTradeskill[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case The Molten Throne: Hate's Essences [Tradeskill]
		{
			RI_CMD_Hidden_AddTLO TheMoltenThroneHatesEssencesTradeskill
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[TheMoltenThroneHatesEssencesTradeskill]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${TheMoltenThroneHatesEssencesTradeskill[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${TheMoltenThroneHatesEssencesTradeskill[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Doomfire: The Enkindled Towers [Solo]
		case Doomfire: The Enkindled Towers [Heroic]
		case Doomfire: The Enkindled Towers [Expert]
		{
			RI_CMD_Hidden_AddTLO DoomfireTheEnkindledTowers 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[DoomfireTheEnkindledTowers]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${DoomfireTheEnkindledTowers[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${DoomfireTheEnkindledTowers[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Eryslai: The Bixel Hive [Solo]
		case Eryslai: The Bixel Hive [Heroic]
		case Eryslai: The Bixel Hive [Expert]
		{
			RI_CMD_Hidden_AddTLO EryslaiTheBixelHive
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[EryslaiTheBixelHive]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${EryslaiTheBixelHive[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${EryslaiTheBixelHive[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Awuidor: The Nebulous Deep [Solo]
		case Awuidor: The Nebulous Deep [Heroic]
		case Awuidor: The Nebulous Deep [Expert]
		{
			RI_CMD_Hidden_AddTLO AwuidorTheNebulousDeep
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[AwuidorTheNebulousDeep]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${AwuidorTheNebulousDeep[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${AwuidorTheNebulousDeep[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Doomfire: Elements of Rage [Solo]
		case Doomfire: Elements of Rage [Heroic]
		case Doomfire: Elements of Rage [Expert]
		{
			RI_CMD_Hidden_AddTLO DoomfireElementsofRage
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[DoomfireElementsofRage]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${DoomfireElementsofRage[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${DoomfireElementsofRage[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Vegarlson: Ruins of Rathe [Solo]
		case Vegarlson: Ruins of Rathe [Heroic]
		case Vegarlson: Ruins of Rathe [Expert]
		{
			RI_CMD_Hidden_AddTLO VegarlsonRuinsofRathe
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[VegarlsonRuinsofRathe]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${VegarlsonRuinsofRathe[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${VegarlsonRuinsofRathe[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Eryslai: The Midnight Aerie [Solo]
		case Eryslai: The Midnight Aerie [Heroic]
		case Eryslai: The Midnight Aerie [Expert]
		{
			RI_CMD_Hidden_AddTLO EryslaiTheMidnightAerie
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[EryslaiTheMidnightAerie]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${EryslaiTheMidnightAerie[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${EryslaiTheMidnightAerie[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Awuidor: Marr's Ascent [Solo]
		case Awuidor: Marr's Ascent [Heroic]
		case Awuidor: Marr's Ascent [Expert]
		{
			RI_CMD_Hidden_AddTLO AwuidorMarrsAscent
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[AwuidorMarrsAscent]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${AwuidorMarrsAscent[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${AwuidorMarrsAscent[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Doomfire: Vengeance of Ro [Solo]
		case Doomfire: Vengeance of Ro [Event Heroic]
		case Doomfire: Vengeance of Ro [Expert Event]
		{
			RI_CMD_Hidden_AddTLO DoomfireVengeanceofRo
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[DoomfireVengeanceofRo]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${DoomfireVengeanceofRo[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${DoomfireVengeanceofRo[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Eryslai: Trials of Air [Solo]
		case Eryslai: Trials of Air [Event Heroic]
		case Eryslai: Trials of Air [Expert Event]
		{
			RI_CMD_Hidden_AddTLO EryslaiTrialsofAir
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[EryslaiTrialsofAir]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${EryslaiTrialsofAir[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${EryslaiTrialsofAir[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Awuidor: The Veiled Precipice [Solo]
		case Awuidor: The Veiled Precipice [Event Heroic]
		case Awuidor: The Veiled Precipice [Expert Event]
		{
			RI_CMD_Hidden_AddTLO AwuidorTheVeiledPrecipice
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[AwuidorTheVeiledPrecipice]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${AwuidorTheVeiledPrecipice[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${AwuidorTheVeiledPrecipice[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Vegarlson: The Terrene Rift [Solo]
		case Vegarlson: The Terrene Rift [Event Heroic]
		case Vegarlson: The Terrene Rift [Expert Event]
		{
			RI_CMD_Hidden_AddTLO VegarlsonTheTerreneRift
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[VegarlsonTheTerreneRift]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${VegarlsonTheTerreneRift[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${VegarlsonTheTerreneRift[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Deep Chelsith: Vault of Omens [Solo]
		case Deep Chelsith: Vault of Omens [Heroic]
		{
			RI_CMD_Hidden_AddTLO DeepChelsithVaultofOmens
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[DeepChelsithVaultofOmens]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${DeepChelsithVaultofOmens[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${DeepChelsithVaultofOmens[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Aurelian Coast: Sambata Village [Solo]
		case Aurelian Coast: Sambata Village [Heroic]
		{
			RI_CMD_Hidden_AddTLO AurelianCoastSambataVillage
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[AurelianCoastSambataVillage]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${AurelianCoastSambataVillage[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${AurelianCoastSambataVillage[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Aurelian Coast: Reishi Rumble [Solo]
		case Aurelian Coast: Reishi Rumble [Event Heroic]
		{
			RI_CMD_Hidden_AddTLO AurelianCoastReishiRumble
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[AurelianCoastReishiRumble]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${AurelianCoastReishiRumble[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${AurelianCoastReishiRumble[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Aurelian Coast: Maiden's Eye [Solo]
		case Aurelian Coast: Maiden's Eye [Heroic]
		{
			RI_CMD_Hidden_AddTLO AurelianCoastMaidensEye
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[AurelianCoastMaidensEye]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${AurelianCoastMaidensEye[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${AurelianCoastMaidensEye[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Sanctus Seru: Echelon of Order [Solo]
		case Sanctus Seru: Echelon of Order [Heroic]
		{
			RI_CMD_Hidden_AddTLO SanctusSeruEchelonofOrder
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[SanctusSeruEchelonofOrder]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${SanctusSeruEchelonofOrder[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${SanctusSeruEchelonofOrder[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Sanctus Seru: Echelon of Divinity [Solo]
		case Sanctus Seru: Echelon of Divinity [Heroic]
		{
			RI_CMD_Hidden_AddTLO SanctusSeruEchelonofDivinity
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[SanctusSeruEchelonofDivinity]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${SanctusSeruEchelonofDivinity[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${SanctusSeruEchelonofDivinity[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Sanctus Seru: Arx Aeturnus [Solo]
		case Sanctus Seru: Arx Aeturnus [Event Heroic]
		{
			RI_CMD_Hidden_AddTLO SanctusSeruArxAeturnus 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[SanctusSeruArxAeturnus]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${SanctusSeruArxAeturnus[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${SanctusSeruArxAeturnus[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Fordel Midst: The Listless Spires [Solo]
		case Fordel Midst: The Listless Spires [Event Heroic]
		{
			RI_CMD_Hidden_AddTLO FordelMidstTheListlessSpires 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[FordelMidstTheListlessSpires]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${FordelMidstTheListlessSpires[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${FordelMidstTheListlessSpires[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Fordel Midst: Wayward Manor [Solo]
		case Fordel Midst: Wayward Manor [Heroic]
		{
			RI_CMD_Hidden_AddTLO FordelMidstWaywardManor 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[FordelMidstWaywardManor]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${FordelMidstWaywardManor[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${FordelMidstWaywardManor[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case The Ruins of Ssraeshza [Solo]
		case The Ruins of Ssraeshza [Heroic]
		{
			RI_CMD_Hidden_AddTLO TheRuinsofSsraeshza 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[TheRuinsofSsraeshza]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${TheRuinsofSsraeshza[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${TheRuinsofSsraeshza[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case The Venom of Ssraeshza [Solo]
		case The Venom of Ssraeshza [Event Heroic]
		{
			RI_CMD_Hidden_AddTLO TheVenomofSsraeshza 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[TheVenomofSsraeshza]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${TheVenomofSsraeshza[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${TheVenomofSsraeshza[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case The Vault of Ssraeshza [Solo]
		case The Vault of Ssraeshza [Heroic]
		{
			RI_CMD_Hidden_AddTLO TheVaultofSsraeshza 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[TheVaultofSsraeshza]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${TheVaultofSsraeshza[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${TheVaultofSsraeshza[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Fordel Midst: Bizarre Bazaar [Solo]
		case Fordel Midst: Bizarre Bazaar [Heroic]
		{
			RI_CMD_Hidden_AddTLO FordelMidstBizarreBazaar 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[FordelMidstBizarreBazaar]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${FordelMidstBizarreBazaar[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${FordelMidstBizarreBazaar[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Solusek's Eye: The Calling [Heroic]
		{
			RI_CMD_Hidden_AddTLO SoluseksEyeTheCallingHeroic 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[SoluseksEyeTheCallingHeroic]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${SoluseksEyeTheCallingHeroic[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${SoluseksEyeTheCallingHeroic[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case The Icy Keep (Hard)
		{
			RI_CMD_Hidden_AddTLO TheIcyKeepHard
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[TheIcyKeepHard]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${TheIcyKeepHard[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${TheIcyKeepHard[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Echo Caverns: Quarry Quandary [Solo]
		case Echo Caverns: Quarry Quandary [Heroic]
		case Echo Caverns: Quarry Quandary [Expert]
		{
			RI_CMD_Hidden_AddTLO EchoCavernsQuarryQuandary
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[EchoCavernsQuarryQuandary]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${EchoCavernsQuarryQuandary[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${EchoCavernsQuarryQuandary[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Echo Caverns: Fungal Foray [Solo]
		case Echo Caverns: Fungal Foray [Heroic]
		case Echo Caverns: Fungal Foray [Expert]
		{
			RI_CMD_Hidden_AddTLO EchoCavernsFungalForay
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[EchoCavernsFungalForay]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${EchoCavernsFungalForay[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${EchoCavernsFungalForay[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Savage Weald: Fort Grim [Solo]
		case Savage Weald: Fort Grim [Event Heroic]
		case Savage Weald: Fort Grim [Expert Event]
		{
			RI_CMD_Hidden_AddTLO SavageWealdFortGrim
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[SavageWealdFortGrim]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${SavageWealdFortGrim[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${SavageWealdFortGrim[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Savage Weald: Chaotic Caverns [Solo]
		case Savage Weald: Chaotic Caverns [Heroic]
		case Savage Weald: Chaotic Caverns [Expert]
		{
			RI_CMD_Hidden_AddTLO SavageWealdChaoticCaverns
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[SavageWealdChaoticCaverns]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${SavageWealdChaoticCaverns[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${SavageWealdChaoticCaverns[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Shadeweaver's Thicket: Feral Reserve [Solo]
		case Shadeweaver's Thicket: Feral Reserve [Heroic]
		case Shadeweaver's Thicket: Feral Reserve [Expert]
		{
			RI_CMD_Hidden_AddTLO ShadeweaversThicketFeralReserve
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[ShadeweaversThicketFeralReserve]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${ShadeweaversThicketFeralReserve[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${ShadeweaversThicketFeralReserve[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Shadeweaver's Thicket: Untamed Lands [Solo]
		case Shadeweaver's Thicket: Untamed Lands [Heroic]
		case Shadeweaver's Thicket: Untamed Lands [Expert]
		{
			RI_CMD_Hidden_AddTLO ShadeweaversThicketUntamedLands
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[ShadeweaversThicketUntamedLands]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${ShadeweaversThicketUntamedLands[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${ShadeweaversThicketUntamedLands[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Shadeweaver's Thicket: Loda Kai Isle [Solo]
		case Shadeweaver's Thicket: Loda Kai Isle [Event Heroic]
		case Shadeweaver's Thicket: Loda Kai Isle [Expert Event]
		{
			RI_CMD_Hidden_AddTLO ShadeweaversThicketLodaKaiIsle
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[ShadeweaversThicketLodaKaiIsle]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${ShadeweaversThicketLodaKaiIsle[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${ShadeweaversThicketLodaKaiIsle[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Echo Caverns: Zelmie Sortie [Solo]
		case Echo Caverns: Zelmie Sortie [Event Heroic]
		case Echo Caverns: Zelmie Sortie [Expert Event]
		{
			RI_CMD_Hidden_AddTLO EchoCavernsZelmieSortie
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[EchoCavernsZelmieSortie]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${EchoCavernsZelmieSortie[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${EchoCavernsZelmieSortie[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Shar Vahl: Siege Break [Solo]
		case Shar Vahl: Siege Break [Heroic]
		case Shar Vahl: Siege Break [Expert]
		{
			RI_CMD_Hidden_AddTLO SharVahlSiegeBreak
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[SharVahlSiegeBreak]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${SharVahlSiegeBreak[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${SharVahlSiegeBreak[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Vex Thal: Shadow Citadel
		{
			RI_CMD_Hidden_AddTLO VexThalShadowCitadel
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[VexThalShadowCitadel]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${VexThalShadowCitadel[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${VexThalShadowCitadel[3rtZdjv7,${MainArrayCounter}]}]
			break
		}
		case Vasty Deep: Toil and Trouble [Solo]
		case Vasty Deep: Toil and Trouble [Heroic I]
		case Vasty Deep: Toil and Trouble [Heroic II]
		{
			RI_CMD_Hidden_AddTLO VastyDeepToilandTrouble
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[VastyDeepToilandTrouble]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${VastyDeepToilandTrouble[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${VastyDeepToilandTrouble[3rtZdjv7,${MainArrayCounter}]}]

			;Weekly
			call AddShinyActor "WEEKLY ARTIFACT"
			call AddShinyActor "WEEKLY LOCATION"

			;Dailies
			call AddShinyActor "a bewitched weapon"
			call AddShinyActor "a bewtiched weapon"
			call AddShinyActor "an Akashic spell scroll"
			call AddShinyActor "unusual lab equipment"
			call AddShinyActor "an arcane book"
			call AddShinyActor "a mysterious otherworldly map"
			break
		}
		case Forlorn Gist: Nightmares of Old [Solo]
		case Forlorn Gist: Nightmares of Old [Heroic I]
		{
			RI_CMD_Hidden_AddTLO ForlornGistNightmaresofOld
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[ForlornGistNightmaresofOld]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${ForlornGistNightmaresofOld[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${ForlornGistNightmaresofOld[3rtZdjv7,${MainArrayCounter}]}]

			break
		}
		case Svarni Expanse: Carrion Crag [Solo]
		case Svarni Expanse: Carrion Crag [Heroic I]
		case Svarni Expanse: Carrion Crag [Heroic II]
		{
			LoadZone SvarniExpanseCarrionCrag
			;LoadedTLO:Set[TRUE]
			;LoadedTLOName:Set[SvarniExpanseCarrionCrag]
			;for(MainArrayCounter:Set[0];${MainArrayCounter}<${SvarniExpanseCarrionCrag[3rtZdjv7,#]};MainArrayCounter:Inc)
		;		istrMain:Insert[${SvarniExpanseCarrionCrag[3rtZdjv7,${MainArrayCounter}]}]

			break
		}
		case Karuupa Jungle: Heart of Conflict [Solo]
		case Karuupa Jungle: Heart of Conflict [Heroic I]
		case Karuupa Jungle: Heart of Conflict [Heroic II]
		{
			RI_CMD_Hidden_AddTLO KaruupaJungleHeartofConflict
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[KaruupaJungleHeartofConflict]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${KaruupaJungleHeartofConflict[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${KaruupaJungleHeartofConflict[3rtZdjv7,${MainArrayCounter}]}]

			break
		}
		case Karuupa Jungle: Dedraka's Descent [Solo]
		case Karuupa Jungle: Dedraka's Descent [Heroic I]
		{
			RI_CMD_Hidden_AddTLO KaruupaJungleDedrakasDescent
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[KaruupaJungleDedrakasDescent]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${KaruupaJungleDedrakasDescent[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${KaruupaJungleDedrakasDescent[3rtZdjv7,${MainArrayCounter}]}]

			break
		}
		case Karuupa Jungle: Predator's Perch [Solo]
		{
			RI_CMD_Hidden_AddTLO KaruupaJunglePredatorsPerch
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[KaruupaJunglePredatorsPerch]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${KaruupaJunglePredatorsPerch[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${KaruupaJunglePredatorsPerch[3rtZdjv7,${MainArrayCounter}]}]

			break
		}
		case Mahngavi Wastes: Phantasmal Shades [Solo]
		case Mahngavi Wastes: Phantasmal Shades [Heroic I]
		{
			RI_CMD_Hidden_AddTLO MahngaviWastesPhantasmalShades
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[MahngaviWastesPhantasmalShades]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${MahngaviWastesPhantasmalShades[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${MahngaviWastesPhantasmalShades[3rtZdjv7,${MainArrayCounter}]}]

			break
		}
		case Mahngavi Wastes: Warpwood Cairn [Solo]
		case Mahngavi Wastes: Warpwood Cairn [Heroic I]
		{
			RI_CMD_Hidden_AddTLO MahngaviWastesWarpwoodCairn
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[MahngaviWastesWarpwoodCairn]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${MahngaviWastesWarpwoodCairn[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${MahngaviWastesWarpwoodCairn[3rtZdjv7,${MainArrayCounter}]}]

			break
		}
		case Castle Vacrul: Rosy Reverie [Solo]
		case Castle Vacrul: Rosy Reverie [Heroic I]
		{
			RI_CMD_Hidden_AddTLO CastleVacrulRosyReverie
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[CastleVacrulRosyReverie]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${CastleVacrulRosyReverie[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${CastleVacrulRosyReverie[3rtZdjv7,${MainArrayCounter}]}]

			break
		}
		case Castle Vacrul: Caverns of the Forsaken [Solo]
		case Castle Vacrul: Caverns of the Forsaken [Heroic I]
		{
			RI_CMD_Hidden_AddTLO CastleVacrulCavernsoftheForsaken
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[CastleVacrulCavernsoftheForsaken]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${CastleVacrulCavernsoftheForsaken[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${CastleVacrulCavernsoftheForsaken[3rtZdjv7,${MainArrayCounter}]}]

			break
		}
		case Castle Vacrul: Suite of Screams [Solo]
		{
			RI_CMD_Hidden_AddTLO CastleVacrulSuiteofScreams
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[CastleVacrulSuiteofScreams]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${CastleVacrulSuiteofScreams[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${CastleVacrulSuiteofScreams[3rtZdjv7,${MainArrayCounter}]}]

			break
		}
		case Castle Vacrul: Throne of the Ydal
		{
			RI_CMD_Hidden_AddTLO CastleVacrulThroneoftheYdal
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[CastleVacrulThroneoftheYdal]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${CastleVacrulThroneoftheYdal[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${CastleVacrulThroneoftheYdal[3rtZdjv7,${MainArrayCounter}]}]

			break
		}
		case The Merchant's Den [Solo]
		;case The Merchant's Den [Heroic I]
		;case The Merchant's Den [Heroic II]
		{
			RI_CMD_Hidden_AddTLO TheMerchantsDen
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[TheMerchantsDen]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${TheMerchantsDen[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${TheMerchantsDen[3rtZdjv7,${MainArrayCounter}]}]

			call SetShinyIgnoreNamed 1
			RI_Var_Bool_IgnoreShinyY:Set[1]
			call AddShinyActor "!"

			;Storage Wars
			if ${QuestJournalWindow.ActiveQuest["Storage Wars"](exists)}
			{
				RI_Var_Bool_GrabShinys:Set[1]
				call AddShinyActor "a captive Vikana associate"
			}

			;Competitive Market Strategies
			if ${QuestJournalWindow.ActiveQuest["Competitive Market Strategies"](exists)}
			{
				RI_Var_Bool_GrabShinys:Set[1]
				call AddShinyActor "a captive Vikana associate"
				call AddShinyActor "Kelethin Crate"
				call AddShinyActor "Erudin Rugs"
				call AddShinyActor "Maj'Dul Pottery"
			}
			;Contract Termination
			if ${QuestJournalWindow.ActiveQuest["Contract Termination"](exists)}
			{
				RI_Var_Bool_GrabShinys:Set[1]
				call AddShinyActor "Glintswift Gang Promissory Notes"
				call AddShinyActor "Furdock & Friends Merchant Contracts"
			}
			;Cut-throat Competition
			if ${QuestJournalWindow.ActiveQuest["Cut-throat Competition"](exists)}
			{
				RI_Var_Bool_GrabShinys:Set[1]
				call AddShinyActor "Glintswift Gang Promissory Notes"
				call AddShinyActor "Furdock & Friends Merchant Contracts"
				call AddShinyActor "Kelethin Crate"
				call AddShinyActor "Erudin Rugs"
				call AddShinyActor "Maj'Dul Pottery"
			}
			break
		}
		case Raj'Dur Plateaus: Blood and Sand [Signature]
		;case Raj'Dur Plateaus: Blood and Sand
		{
			LoadZone RajDurPlateausBloodandSand
			;LoadedTLO:Set[TRUE]
			;LoadedTLOName:Set[RajDurPlateausBloodandSand]
			;for(MainArrayCounter:Set[0];${MainArrayCounter}<${RajDurPlateausBloodandSand[3rtZdjv7,#]};MainArrayCounter:Inc)
			;	istrMain:Insert[${RajDurPlateausBloodandSand[3rtZdjv7,${MainArrayCounter}]}]

			break
		}
		case Raj'Dur Plateaus: The Sultan's Dagger [Signature]
		;case Raj'Dur Plateaus: The Sultan's Dagger
		{
			RI_CMD_Hidden_AddTLO RajDurPlateausTheSultansDagger
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[RajDurPlateausTheSultansDagger]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${RajDurPlateausTheSultansDagger[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${RajDurPlateausTheSultansDagger[3rtZdjv7,${MainArrayCounter}]}]
			
			;Taskish Tablets for the Taking
            if ${QuestJournalWindow.ActiveQuest["Taskish Tablets for the Taking"](exists)}
            {
                RI_Var_Bool_GrabShinys:Set[1]
                call AddShinyActor "Stolen Ancient Tablet"
            }

			break
		}
		case Buried Takish'Hiz: Terrene Threshold [Signature]
		;case Buried Takish'Hiz: Terrene Threshold
		{
			RI_CMD_Hidden_AddTLO BuriedTakishHizTerreneThreshold
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[BuriedTakishHizTerreneThreshold]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${BuriedTakishHizTerreneThreshold[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${BuriedTakishHizTerreneThreshold[3rtZdjv7,${MainArrayCounter}]}]

			break
		}
		case Buried Takish'Hiz: The Sacred Gift [Signature]
		;case Buried Takish'Hiz: The Sacred Gift
		{
			RI_CMD_Hidden_AddTLO BuriedTakishHizTheSacredGift
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[BuriedTakishHizTheSacredGift]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${BuriedTakishHizTheSacredGift[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${BuriedTakishHizTheSacredGift[3rtZdjv7,${MainArrayCounter}]}]

			break
		}
		case Takish Badlands: Overgrowth [Solo]
		;case Takish Badlands: Overgrowth
		{
			
			RI_CMD_Hidden_AddTLO TakishBadlandsOvergrowth
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[TakishBadlandsOvergrowth]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${TakishBadlandsOvergrowth[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${TakishBadlandsOvergrowth[3rtZdjv7,${MainArrayCounter}]}]

			;Renewal of Ro: Tailing Dragons
			if ${QuestJournalWindow.ActiveQuest["Renewal of Ro: Tailing Dragons"](exists)}
			{
				RI_Var_Bool_GrabShinys:Set[1]
				call AddShinyActor "Spell-shaped Stone"
			}
			;Overgrowth Seed Stealers
            if ${QuestJournalWindow.ActiveQuest["Overgrowth Seed Stealers"](exists)}
            {
                RI_Var_Bool_GrabShinys:Set[1]
                call AddShinyActor "Jar of Seeds"
            }
			break
		}
		case Takish Badlands: Kigathor's Glade [Solo]
		;case Takish Badlands: Kigathor's Glade
		{
			RI_CMD_Hidden_AddTLO TakishBadlandsKigathorsGlade
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[TakishBadlandsKigathorsGlade]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${TakishBadlandsKigathorsGlade[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${TakishBadlandsKigathorsGlade[3rtZdjv7,${MainArrayCounter}]}]

			break
		}
		case Sandstone Delta: Eye of the Storm [Solo]
		;case Sandstone Delta: Eye of the Storm
		{
			RI_CMD_Hidden_AddTLO SandstoneDeltaEyeoftheStorm
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[SandstoneDeltaEyeoftheStorm]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${SandstoneDeltaEyeoftheStorm[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${SandstoneDeltaEyeoftheStorm[3rtZdjv7,${MainArrayCounter}]}]

			;Sans Manifested Sands /SandstoneDeltaEyeoftheStorm
            if ${QuestJournalWindow.ActiveQuest["Sans Manifested Sands"](exists)}
            {
                RI_Var_Bool_GrabShinys:Set[1]
                call AddShinyActor "Sands of Clarity"
                call AddShinyActor "Sands of Supremacy"
            }

			break
		}
		case Sandstone Delta: Eye of Night [Solo]
		;case Sandstone Delta: Eye of Night
		{
			RI_CMD_Hidden_AddTLO SandstoneDeltaEyeofNight 
			LoadedTLO:Set[TRUE]
			LoadedTLOName:Set[SandstoneDeltaEyeofNight]
			for(MainArrayCounter:Set[0];${MainArrayCounter}<${SandstoneDeltaEyeofNight[3rtZdjv7,#]};MainArrayCounter:Inc)
				istrMain:Insert[${SandstoneDeltaEyeofNight[3rtZdjv7,${MainArrayCounter}]}]

			;Renewal of Ro: Illusion From the Disillusioned
			if ${QuestJournalWindow.ActiveQuest["Renewal of Ro: Illusion From the Disillusioned"](exists)}
			{
				RI_Var_Bool_GrabShinys:Set[1]
				call AddShinyActor "Eye of Night Ward"
				call AddShinyActor "Night Metal"
			}
			;Sand By Me
            if ${QuestJournalWindow.ActiveQuest["Sand By Me"](exists)}
            {
                RI_Var_Bool_GrabShinys:Set[1]
                call AddShinyActor "Sands of Zealotry"
                call AddShinyActor "Sands of Blessing"
                call AddShinyActor "Sands of Secrets"
            }
			break
		}
		default
		{
			if ${Zone.Name.Equal["Brackish Vaults [Solo]"]} || ${Zone.Name.Equal["Brackish Vaults [Duo]"]}
			{
				RI_CMD_Hidden_AddTLO BrackishVaults 
				LoadedTLO:Set[TRUE]
				LoadedTLOName:Set[BrackishVaults]
				for(MainArrayCounter:Set[0];${MainArrayCounter}<${BrackishVaults[3rtZdjv7,#]};MainArrayCounter:Inc)
					istrMain:Insert[${BrackishVaults[3rtZdjv7,${MainArrayCounter}]}]
				break
			}
			;need to put in here for default loading of zones with names stripping [Heroic] [Event Heroic] [Solo] [Advanced Solo] [Agnostic] [Expert] etc
			;MessageBox "This is not a supported zone, please contact Herculezz on Either forums or IRC and let him know the zone name: ${Me.GetGameData[Self.ZoneName].Label} to be added, Best to get and post a screenshot of this."
			;Script:End
			echo ISXRI: ${Time} There is no ZoneFile in the Extension for ${Me.GetGameData[Self.ZoneName].Label}, Attempting to import default ZoneFile, or you can type ImportZoneFile filename to import a file (omitting filename, will attempt to load WriteLocs default file for the zone)
			NoFile:Set[TRUE]
			break
		}
	}
}
atom LoadZone(string ZoneFileName="${Me.GetGameData[Self.ZoneName].Label.Replace[" ",""].Replace["'",""].Replace[":",""].Replace["[",,""].Replace["]",""].Replace["\,",""]}")
{
	declare FP filepath "${LavishScript.HomeDirectory}/Scripts/RI/ZoneFiles/"
	if ${FP.FileExists[${ZoneFileName}.dat]}
	{
		if ${Debug}
			ISXRI: File ${LavishScript.HomeDirectory}/Scripts/RI/ZoneFiles/${ZoneFileName}.dat found Importing
		ImportZoneFile ${ZoneFileName}
	}
	else
	{
		if ${Debug}
			ISXRI: File ${LavishScript.HomeDirectory}/Scripts/RI/ZoneFiles/${ZoneFileName}.dat not found Importing from Extension
		echo ISXRI: ${Time} Importing ZoneFile from Extension
		RI_CMD_Hidden_AddTLO ${ZoneFileName}
		LoadedTLO:Set[TRUE]
		LoadedTLOName:Set[${ZoneFileName}]
		for(MainArrayCounter:Set[0];${MainArrayCounter}<${${ZoneFileName}[3rtZdjv7,#]};MainArrayCounter:Inc)
			istrMain:Insert[${${ZoneFileName}[3rtZdjv7,${MainArrayCounter}]}]
		echo ISXRI: ${Time} Done Importing ZoneFile from Extension, to Load from File type ImportZoneFile filename (omitting filename, will attempt to load WriteLocs default file for the zone)
	}
}

atom(global) IZF(string ZoneFileName="${Me.GetGameData[Self.ZoneName].Label.Replace[" ",""].Replace["'",""].Replace[":",""].Replace["[",,""].Replace["]",""].Replace["\,",""]}", bool _Verbose=TRUE)
{
	ImportZoneFile "${ZoneFileName}" ${_Verbose}
}
atom(global) ImportZoneFile(string ZoneFileName="${Me.GetGameData[Self.ZoneName].Label.Replace[" ",""].Replace["'",""].Replace[":",""].Replace["[",,""].Replace["]",""].Replace["\,",""]}", bool _Verbose=TRUE)
{
	declare FP filepath "${LavishScript.HomeDirectory}/Scripts/RI/ZoneFiles/"
	;check if ZineFileName exists, if not end
	if !${FP.FileExists[${ZoneFileName}.dat]} && ${ZoneFileName.Find[Solo](exists)} && ${FP.FileExists[${ZoneFileName.Left[-4]}.dat]}
	{
		ZoneFileName:Set[${ZoneFileName.Left[-4]}]
		if ${_Verbose}
			echo ISXRI: ${Time} Loading ZoneFile: "${LavishScript.HomeDirectory}/Scripts/RI/ZoneFiles/${ZoneFileName}.dat"
	}
	elseif !${FP.FileExists[${ZoneFileName}.dat]} && ${ZoneFileName.Find[Heroic](exists)} && ${FP.FileExists[${ZoneFileName.Left[-6]}.dat]}
	{
		ZoneFileName:Set[${ZoneFileName.Left[-6]}]
		if ${_Verbose}
			echo ISXRI: ${Time} Loading ZoneFile: "${LavishScript.HomeDirectory}/Scripts/RI/ZoneFiles/${ZoneFileName}.dat"
	}
	elseif !${FP.FileExists[${ZoneFileName}.dat]} && ${ZoneFileName.Find[HeroicI](exists)} && ${FP.FileExists[${ZoneFileName.Left[-7]}.dat]}
	{
		ZoneFileName:Set[${ZoneFileName.Left[-7]}]
		if ${_Verbose}
			echo ISXRI: ${Time} Loading ZoneFile: "${LavishScript.HomeDirectory}/Scripts/RI/ZoneFiles/${ZoneFileName}.dat"
	}
	elseif !${FP.FileExists[${ZoneFileName}.dat]} && ${ZoneFileName.Find[HeroicII](exists)} && ${FP.FileExists[${ZoneFileName.Left[-8]}.dat]}
	{
		ZoneFileName:Set[${ZoneFileName.Left[-8]}]
		if ${_Verbose}
			echo ISXRI: ${Time} Loading ZoneFile: "${LavishScript.HomeDirectory}/Scripts/RI/ZoneFiles/${ZoneFileName}.dat"
	}
	elseif !${FP.FileExists[${ZoneFileName}.dat]} && ${ZoneFileName.Find[Duo](exists)} && ${FP.FileExists[${ZoneFileName.Left[-3]}.dat]}
	{
		ZoneFileName:Set[${ZoneFileName.Left[-3]}]
		if ${_Verbose}
			echo ISXRI: ${Time} Loading ZoneFile: "${LavishScript.HomeDirectory}/Scripts/RI/ZoneFiles/${ZoneFileName}.dat"
	}
	elseif !${FP.FileExists[${ZoneFileName}.dat]} && ${ZoneFileName.Find[EventHeroic](exists)} && ${FP.FileExists[${ZoneFileName.Left[-11]}.dat]}
	{
		ZoneFileName:Set[${ZoneFileName.Left[-11]}]
		if ${_Verbose}
			echo ISXRI: ${Time} Loading ZoneFile: "${LavishScript.HomeDirectory}/Scripts/RI/ZoneFiles/${ZoneFileName}.dat"
	}
	elseif !${FP.FileExists[${ZoneFileName}.dat]}
	{
		echo ISXRI: ${Time} Missing ZoneFile: "${LavishScript.HomeDirectory}/Scripts/RI/ZoneFiles/${ZoneFileName}.dat"
		if ${RI_Var_Bool_QuestMode}
			Script:End
		else
			return
	}
	else
	{
		if ${_Verbose}
			echo ISXRI: ${Time} Loading ZoneFile: "${LavishScript.HomeDirectory}/Scripts/RI/ZoneFiles/${ZoneFileName}.dat"
	}
	
	variable file Filename
	variable int Count
	
	variable string TempString
	istrMain:Clear
	Count:Set[1]
	;set file to read in to Filename variable
	Filename:SetFilename["${LavishScript.HomeDirectory}/Scripts/RI/ZoneFiles/${ZoneFileName}.dat"]

	;open the file
	Filename:Open
	
	;seek to the beginning of file
	Filename:Seek[0]
	
	;while we are not at the end of file
	while !${Filename.EOF}
	{
		;store each line of the file in var
		TempString:Set[${Filename.Read}]
		if ${TempString.Equal[NULL]}
			continue
		istrMain:Insert[${TempString.Left[-1]}]
		;echo Adding ${istrMain.Get[${Count}]} to istrMain Variable in Element ${Count} : Length ${istrMain.Get[${Count}].Length}
		Count:Inc
		;waitframe
	}
	
	;close file
	Filename:Close
	if ${_Verbose}
		echo ISXRI: ${Time} Done Loading ZoneFile
}
function CheckImReady()
{
	while ${EQ2.Zoning}!=0
	{
		IJustZonedLessThan10SecondsAgo:Set[TRUE]
		if ${RI_Var_Bool_Debug}
			echo ISXRI: ${Time} Waiting while zoning
		wait 10
	}	
	if ${IJustZonedLessThan10SecondsAgo}
		TimedCommand 100 IJustZonedLessThan10SecondsAgo:Set[FALSE]
	if ${RI_Var_Bool_WaitForHealth} && ( ${Solo} || ${RI_Var_Bool_QuestMode} || ${InstanceMode} ) && ${Me.Health}<75
	{
		press -release ${RI_Var_String_FlyUpKey}
		press -release ${RI_Var_String_FlyDownKey}
		press -release ${RI_Var_String_ForwardKey}
		wait 1
		if ${Me.IsMoving}
		{
			press ${RI_Var_String_BackwardKey}
			press ${RI_Var_String_BackwardKey}
			press ${RI_Var_String_BackwardKey}
		}
		echo ISXRI: Waiting for Health
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Loc}]
		while ${RI_Var_Bool_WaitForHealth} && ( ${Solo} || ${RI_Var_Bool_QuestMode} || ${InstanceMode} ) && ${Me.Health}<100
		{
			if ${RI_Var_Bool_Debug}
				echo ISXRI: ${Time} Waiting while low health
			wait 10
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[OFF]
	}
	while ${Me.IsCamping}
	{
		if ${RI_Var_Bool_Debug}
			echo ISXRI: ${Time} Waiting while camping
		wait 10
	}
	while !${Me.InGameWorld} && ${EQ2.Zoning}==0
	{
		if ${RI_Var_Bool_Debug}
			echo ISXRI: ${Time} Waiting while not in game world
		wait 10
	}
	while ${Zone.Name.Equal[LoginScene]}
	{
		if ${RI_Var_Bool_Debug}
			echo ISXRI: ${Time} Waiting while at LoginScene
		wait 10
	}
	while ${Me.IsDead}
	{
		if ${RI_Var_Bool_Debug}
			echo ISXRI: ${Time} Waiting while dead
		wait 10 !${Me.IsDead}
	}
	if ${Me.GetGameData[Self.ZoneName].Label.NotEqual["${MyZone}"]} && !${RI_Var_Bool_QuestMode} && !${InstanceMode}
	{
		echo ISXRI: ${Time} We are no longer in ${MyZone}, exiting RunInstances
		Script:End
	}
}
function Go(bool _Quest=FALSE)
{
	;make sure we are not dead or zoning or in the incorrect zone
	call CheckImReady

	;start group follow
	call RIMObj.follow
	
	;find closestwaypoint to our current location that we have LOS to
	;call FindClosestWaypoint
	variable string _FirstLoc
	;read istrMain until the end -1 (no need to check last waypoint) or start has been pressed
	if !${_Quest}
	{
		_FirstLoc:Set["${istrMain.Get[1].Replace[" ",","]}"]
		;echo ${istrMain.Get[1]} // ${_FirstLoc} // ${Me.Distance[${_FirstLoc}]}<25 // ${Math.Distance[${Me.Loc},${_FirstLoc}]}<25
		if ${Me.Distance[${_FirstLoc}]}<25
		{
			echo ISXRI: ${Time} I am within 25 of the First Waypoint skipping Reading ZoneFile to find closest waypoint
		}
		else
		{
			echo ISXRI: ${Time} Reading ZoneFile to find closest waypoint
			for(MainArrayCounter:Set[1];${MainArrayCounter}<${Math.Calc[${istrMain.Used}-1]};MainArrayCounter:Inc)
			{
				if ${istrMain.Get[${MainArrayCounter}].NotEqual[ReturnLOCS]}
					call FindClosestWaypoint "${istrMain.Get[${MainArrayCounter}]}"
				else
					MainArrayCounter:Set[${Math.Calc[${istrMain.Used}+1]}]
			}
			echo ISXRI: ${Time} Done Reading ZoneFile
		}
		MainArrayCounter:Set[1]
	}
	else
	{
		if ${istrMain.Get[2].Equal[Repeatable]}
			MainArrayCounter:Set[3]
		else
			MainArrayCounter:Set[2]
		wait 50
	}
	for(;${MainArrayCounter}<=${istrMain.Used};MainArrayCounter:Inc)
	{
		;make sure we are not dead or zoning or in the incorrect zone or low health if solo
		call CheckImReady
		call ShinyCollection
		if ${ArrayPosition}!=0
		{
			MainArrayCounter:Set[${Math.Calc[${ArrayPosition}-1]}]
			ArrayPosition:Set[0]
			continue
		}
		;read a line from Array
		LineRead:Set[${istrMain.Get[${MainArrayCounter}]}]
				
		if ${RI_Var_Bool_Debug}
		{
			echo ${Time}: Inside ArrayRead For Loop
			echo ${Time}: "${MainArrayCounter}: ${LineRead}//${LineRead.Length}"
		}
		if ${LineRead.Left[17].Equal[DontStopForCombat]}
			StopForCombat:Set[FALSE]
		elseif ${LineRead.Left[13].Equal[StopForCombat]}
			StopForCombat:Set[TRUE]
		elseif ${LineRead.Left[17].Equal[DontClearTarget]}
			ClearTarget:Set[FALSE]
		elseif ${LineRead.Left[13].Equal[ClearTarget]}
			ClearTarget:Set[TRUE]
		elseif ${LineRead.Left[6].Equal[Custom]}
		{
			MainArrayCounter:Inc
			CustomFunction:Set[${istrMain.Get[${MainArrayCounter}]}]
			MainArrayCounter:Inc
			CustomLoc:Set[${istrMain.Get[${MainArrayCounter}]}]
			call CustomFunction
		}
		;elseif LineRead equals wait, set waitfunction variables and call WaitFunction
		elseif ${LineRead.Left[4].Equal[Wait]}
		{
			MainArrayCounter:Inc
			WaitTime:Set[${istrMain.Get[${MainArrayCounter}]}]
			MainArrayCounter:Inc
			WaitLoc:Set[${istrMain.Get[${MainArrayCounter}]}]
			call WaitFunction
		}
		elseif ${LineRead.Left[10].Equal[ClickActor]}
		{
			MainArrayCounter:Inc
			ClickActorName:Set[${istrMain.Get[${MainArrayCounter}]}]
			MainArrayCounter:Inc
			ClickActorLoc:Set[${istrMain.Get[${MainArrayCounter}]}]
			call ClickActorFunction
		}
		elseif ${LineRead.Left[9].Equal[HailActor]}
		{
			MainArrayCounter:Inc
			HailActorName:Set[${istrMain.Get[${MainArrayCounter}]}]
			MainArrayCounter:Inc
			HailActorLoc:Set[${istrMain.Get[${MainArrayCounter}]}]
			call HailActorFunction
		}
		elseif ${LineRead.Left[5].Equal[Named]}
		{
			MainArrayCounter:Inc
			NamedName:Set[${istrMain.Get[${MainArrayCounter}]}]
			MainArrayCounter:Inc
			if ${istrMain.Get[${MainArrayCounter}].Left[13].Equal[StandardNamed]}
			{
				StandardNamed:Set[TRUE]
				CustomNamed:Set[FALSE]
				MainArrayCounter:Inc
				if ${istrMain.Get[${MainArrayCounter}].Left[8].Equal[SameLock]}
					LOD:Set[FALSE]
				else
				{
					LOD:Set[TRUE]
					MainArrayCounter:Inc
					LODXYZ:Set[${istrMain.Get[${MainArrayCounter}]}]
				}
				MainArrayCounter:Inc
				if ${istrMain.Get[${MainArrayCounter}].Left[7].Equal[KillAdd]}
				{
					KillAdd:Set[TRUE]
					MainArrayCounter:Inc
					AddName:Set[${istrMain.Get[${MainArrayCounter}]}]
				}
				else
					KillAdd:Set[FALSE]
				MainArrayCounter:Inc
				if ${istrMain.Get[${MainArrayCounter}].Left[10].Equal[MoveBehind]}
					MoveBehind:Set[TRUE]
				else
					MoveBehind:Set[FALSE]
			}
			else
			{
				StandardNamed:Set[FALSE]
				CustomNamed:Set[TRUE]
			}
			MainArrayCounter:Inc
			NamedLoc:Set[${istrMain.Get[${MainArrayCounter}]}]
			call NamedFunction
		}
		elseif ${LineRead.Left[10].Equal[ReturnLOCS]}
		{
			noop
		}
		else
			call EndForFunction
		wait 1
	}
	wait 5
}
atom(global) ____displayindex_213412jk123ui123km()
{
	variable int counter
	for(counter:Set[1];${counter}<=${istrMain.Used};counter:Inc)
	{
		echo ${counter}: ${istrMain.Get[${counter}]}
	}
}
function CustomFunction(string arg1="", string arg2="", string arg3="", string arg4="", string arg5="")
{
	if ${RI_Var_Bool_Debug}
		echo ${Time}: Calling custom function ${CustomFunction}
	;move to custom location
	if !${CustomLoc.Find["0 0 0"]} && !${CustomFunction.Find[WaitForZoning](exists)}
	{
		call RIMObj.Move ${CustomLoc} ${Precision} 0 TRUE ${StopForCombat} TRUE FALSE TRUE
	}
	call MakeCurrentActiveQuest
	call ${CustomFunction} ${arg1} ${arg2} ${arg3} ${arg4} ${arg5}
	wait 5
	if ${StopForCombat}
		call RIMObj.CheckCombat
}
function FlyDown(bool _AllToons=TRUE)
{
	wait 5
	call RIMObj.FlyDown ${_AllToons}
}
;WaitFunction
function WaitFunction()
{
	;move to custom location
	if ${WaitLoc.NotEqual["0 0 0"]}
	{
		call RIMObj.follow
		call RIMObj.Move ${WaitLoc} ${Precision} 0 TRUE ${StopForCombat} TRUE FALSE TRUE
	}
	if ${StopForCombat}
		call RIMObj.CheckCombat
	if ${RI_Var_Bool_Debug}
		echo ${Time}: Wait ${WaitTime}
	wait ${WaitTime}
	if ${StopForCombat}
		call RIMObj.CheckCombat
}
atom(global) RI_Atom_RIXMLClose()
{
	Script:End
}
;ClickActorFunction
function ClickActorFunction()
{
	if ${Script[Buffer:CoT]}
		endscript Buffer:CoT
	
	RI_Var_Bool_Follow:Set[FALSE]
	if ${ClickActorLoc.NotEqual["0 0 0"]}
	{
		;stop follow
		call RIMObj.stopfollow
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call RIMObj.Move ${ClickActorLoc} ${Precision} 0 TRUE TRUE TRUE FALSE TRUE"]
		call RIMObj.Move ${ClickActorLoc} ${Precision} 0 TRUE TRUE TRUE FALSE TRUE
	}
	wait 20
	
	if ${StopForCombat}
		call RIMObj.CheckCombat
	;echo Clicking: ${ClickActorName}
	variable int _ID=${Actor[Query, Name=-"${ClickActorName}"].ID}
	wait 5
	relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
	wait 5
	relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
	wait 5
	relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
	wait 20
	if ${StopForCombat}
		call RIMObj.CheckCombat
	;cancel others movement if they are still trying to move
	;to avoid ping ponging
	relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Var_Bool_CancelMovement:Set[TRUE]
	;follow
	RI_Var_Bool_Follow:Set[TRUE]
	call RIMObj.follow
	wait 5
	relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Var_Bool_CancelMovement:Set[FALSE]
	wait 5
	if !${Script[Buffer:CoT]}
		TimedCommand 50 RI_CoT
}

;HailActorFunction
function HailActorFunction()
{
	;move to HailActor location
	;stop follow
	
	;echo Moving to ${HailActorLoc} and Clicking ${HailActorName}
	relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call RIMObj.Move ${HailActorLoc} ${Precision} 0 TRUE TRUE TRUE FALSE TRUE"]
	call RIMObj.Move ${HailActorLoc} ${Precision} 0 TRUE TRUE TRUE FALSE TRUE
	wait 20
	call RIMObj.stopfollow
	;make sure HailActorName exists so we do not go through the motions for nothign
	if ${Actor[${HailActorName},radius,20](exists)}
	{
		;wait until we are out of combat
		if ${StopForCombat}
			call RIMObj.CheckCombat
		;wait 10
		;pause bots
		relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
		;wait 5
		relay ${RI_Var_String_RelayGroup} -noredirect Actor[${HailActorName}]:DoFace
		;wait 2
		relay ${RI_Var_String_RelayGroup} -noredirect Actor[${HailActorName}]:DoTarget
		wait 2
		relay ${RI_Var_String_RelayGroup} -noredirect eq2execute hail
		wait 2
		if ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1](exists)}
			relay ${RI_Var_String_RelayGroup} -noredirect EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 5
		;unpause bots
		relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 0
	}
	if ${StopForCombat}
		call RIMObj.CheckCombat
	;follow
	call RIMObj.follow
}

;NamedFunction
function NamedFunction()
{
	;move to Named location
	call RIMObj.Move ${NamedLoc} ${Precision} 0 TRUE ${StopForCombat} TRUE FALSE TRUE
	wait 10
	if ${StandardNamed}
	{
		;echo call Named ${NamedName} TRUE ${NamedLoc} ${LOD} ${LODXYZ} ${MoveBehind} FALSE 0 ${KillAdd} ${AddName}
		call Named ${NamedName} TRUE ${NamedLoc} ${LOD} ${LODXYZ} ${MoveBehind} FALSE 0 ${KillAdd} ${AddName}
	}
	elseif ${CustomNamed}
	{
		declare FP filepath "${LavishScript.HomeDirectory}/Scripts/RI/ZoneFiles/"
		if ${FP.FileExists[${NamedName}.iss]}
		{
			echo running ${NamedName}.iss
			run ${LavishScript.HomeDirectory}/Scripts/RI/ZoneFiles/${NamedName}.iss
			wait 5
			while ${Script[${NamedName}]}
			{
				echo waiting for script to end
				wait 1
			}
			echo script ended
		}
		else
			call Named ${NamedName} FALSE 0 0 0 FALSE 0 0 0 FALSE TRUE ${NamedName} FALSE 0
	}
}
function AddShinyActor(string _Name)
{
	RI_Var_IndexString_ShinyNames:Insert["${_Name}"]
	RIMObj:BuildShinyQuery
}
function ClearShinyActors(string _Name)
{
	RI_Var_IndexString_ShinyNames:Clear
	RIMObj:BuildShinyQuery
}
function SetShinyScanDistance(int _Distance)
{
	ShinyScanDistance:Set[${_Distance}]
}
function SetShinyIgnoreNamed(bool _Setter)
{
	RI_Var_Bool_IgnoreNamedForShiny:Set[${_Setter}]
}
function SetShinyMoveDistance(int _Distance)
{
	RI_Var_Int_ShinyMoveDistance:Set[${_Distance}]
}
function SetIgnoreShinyY(int _OnOff)
{
	RI_Var_Bool_IgnoreShinyY:Set[${_OnOff}]
}

;object RunInstancesObject
objectdef RunInstancesObject
{
	member:bool PathTrigger(bool _CheckItemQty, string _ItemName, string _ItemQty, bool _QuestStepExists, bool _QuestExists, bool _QuestDNE, bool _QuestStepChecked, string _tempName, weakref _QuestStep, weakref _Quest, string CommonTrigger)
	{
		variable int _countor=0
		if ${RI_Var_Bool_PathDebug}
		{
			echo _CheckItemQty=${_CheckItemQty} _ItemName=${_ItemName} _ItemQty=${_ItemQty} _QuestStepExists=${_QuestStepExists} _QuestExists=${_QuestExists} _QuestDNE=${_QuestDNE} _QuestStepChecked=${_QuestStepChecked} _tempName=${_tempName} _QuestStep.Used=${_QuestStep.Used} _Quest.Used=${_Quest.Used} CommonTrigger=${CommonTrigger}
			if ${_QuestStep.Used}>0
			{
				for(_countor:Set[1];${_countor}<=${_QuestStep.Used};_countor:Inc)
				{
					echo _QuestStep(${_countor}):${_QuestStep[${_countor}]}
				}
			}
			if ${_Quest.Used}>0
			{
				for(_countor:Set[1];${_countor}<=${_Quest.Used};_countor:Inc)
				{
					echo _Quest(${_countor}):${_Quest[${_countor}]}
				}
			}
		}
		;${RIObj.PathTrigger[${_CheckItemQty},${_ItemName},${_ItemQty},${_QuestStepExists},${_QuestExists},${_QuestDNE},${_QuestStepChecked},${_tempName},_QuestStep,_Quest,${CommonTrigger}]}
		;${RIObj.PathTrigger[${_CheckItemQty},${_ItemName},${_ItemQty},${_QuestStepExists},${_QuestExists},${_QuestDNE},${_QuestStepChecked},${_tempName},_QuestStep,_Quest,${CommonTrigger}]}
		if ${_CheckItemQty} && ${RIMUIObj.InventoryQuantity["${_ItemName}"]}>=${_ItemQty}
		{
			echo ISXRI: Triggered: ${_ItemQty} of ${_ItemName}
			Trigger:Set[FALSE]
			return TRUE
		}
		if ${_QuestStepExists}
		{
			for(_countor:Set[1];${_countor}<=${_QuestStep.Used};_countor:Inc)
			{
				if ${RIObj.QuestStepExists["${_QuestStep.Get[${_countor}]}"]}
				{
					echo ISXRI: Triggered: ${_QuestStep.Get[${_countor}]} from ${_tempName}
					Trigger:Set[FALSE]
					return TRUE
				}
			}
		}
		if ${_QuestExists}
		{
			for(_countor:Set[1];${_countor}<=${_Quest.Used};_countor:Inc)
			{
				if ${QuestJournalWindow.ActiveQuest["${_Quest.Get[${_countor}]}"]}
				{
					echo ISXRI: Triggered: ${_Quest.Get[${_countor}]} Exists from ${_tempName}
					Trigger:Set[FALSE]
					return TRUE
				}	
			}
		}
		if ${_QuestDNE}
		{
			for(_countor:Set[1];${_countor}<=${_Quest.Used};_countor:Inc)
			{
				if !${QuestJournalWindow.ActiveQuest["${_Quest.Get[${_countor}]}"]}
				{
					echo ISXRI: Triggered: ${_Quest.Get[${_countor}]} Does Not Exist from ${_tempName}
					Trigger:Set[FALSE]
					return TRUE
				}	
			}
			
		}
		if ${_QuestStepChecked}
		{
			for(_countor:Set[1];${_countor}<=${_QuestStep.Used};_countor:Inc)
			{
				;echo ISXRI: QuestStep: ${_QuestStep.Get[${_countor}]}
				if ${_QuestStep.Get[${_countor}].Token[2,+](exists)}
				{
					;echo ISXRI: Checking Quest: ${_QuestStep.Get[${_countor}].Token[2,+]} for QuestStep: ${_QuestStep.Get[${_countor}].Token[1,+]}
					QuestJournalWindow.ActiveQuest["${_QuestStep.Get[${_countor}].Token[2,+]}"]:MakeCurrentActiveQuest
					QuestJournalWindow.ActiveQuest["${_QuestStep.Get[${_countor}].Token[2,+]}"]:MakeCurrentActiveQuest
					QuestJournalWindow.ActiveQuest["${_QuestStep.Get[${_countor}].Token[2,+]}"]:MakeCurrentActiveQuest
					if ${RIObj.QuestStepExists["${_QuestStep.Get[${_countor}].Token[1,+]}",${_QuestStepChecked}]}
					{
						echo ISXRI: Triggered: ${_QuestStep.Get[${_countor}].Token[1,+]}
						Trigger:Set[FALSE]
						return TRUE
					}
				}
				else
				{
					if ${RIObj.QuestStepExists["${_QuestStep.Get[${_countor}]}",${_QuestStepChecked}]}
					{
						echo ISXRI: Triggered: ${_QuestStep.Get[${_countor}]}
						Trigger:Set[FALSE]
						return TRUE
					}
				}	
			}
		}
		if ${Trigger}
		{
			echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
			Trigger:Set[FALSE]
			return TRUE
		}
		if ${CommonTrigger.NotEqual[""]}
		{
			if ( ${CommonTrigger.Token[1,:].Equal[QuestStepChecked]} || ${CommonTrigger.Token[1,:].Equal[QSC]} )&& ${RIObj.QuestStepExists["${CommonTrigger.Token[2,:]}",1]}
			{
				echo ISXRI: Triggered:${CommonTrigger.Token[2,:]}
				Trigger:Set[FALSE]
				return TRUE
			}
			if ${CommonTrigger.Token[1,:].Equal[QuestStepExists]} && ${RIObj.QuestStepExists["${CommonTrigger.Token[2,:]}"]}
			{
				echo ISXRI: Triggered: ${CommonTrigger.Token[2,:]} from ${_tempName}
				Trigger:Set[FALSE]
				return TRUE
			}
			if ${CommonTrigger.Token[1,:].Equal[QuestStepDNE]} && !${RIObj.QuestStepExists["${CommonTrigger.Token[2,:]}"]}
			{
				echo ISXRI: Triggered: ${CommonTrigger.Token[2,:]} from ${_tempName}
				Trigger:Set[FALSE]
				return TRUE
			}
			if ${CommonTrigger.Token[1,:].Equal[QuestExists]} && ${QuestJournalWindow.ActiveQuest["${CommonTrigger.Token[2,:]}"]}
			{
				echo ISXRI: Triggered: ${CommonTrigger.Token[2,:]} Exists from ${_tempName}
				Trigger:Set[FALSE]
				return TRUE
			}
			if ${CommonTrigger.Token[1,:].Equal[QuestDNE]} && !${QuestJournalWindow.ActiveQuest["${CommonTrigger.Token[2,:]}"]}
			{
				echo ISXRI: Triggered: ${CommonTrigger.Token[2,:]} Does Not Exist from ${_tempName}
				Trigger:Set[FALSE]
				return TRUE
			}
		}
		return FALSE
	}
	method Start()
	{
		RI_Var_Bool_Start:Set[TRUE]
		UIElement[Start@RI]:SetText[Pause]
	}
	member:string ConvertedZoneName(string _ZoneName)
	{	
		if ${_ZoneName.Find["[Signature]"]}
			return ${_ZoneName.Left[-12]}
		if ${_ZoneName.Find["[Solo]"]}
			return ${_ZoneName.Left[-7]}
		if ${_ZoneName.Find["[Heroic]"]}
			return ${_ZoneName.Left[-9]}
		if ${_ZoneName.Find["[Expert]"]}
			return ${_ZoneName.Left[-9]}
		if ${_ZoneName.Find["[Expert Event]"]}
			return ${_ZoneName.Left[-15]}
		if ${_ZoneName.Find["[Event Heroic]"]}
			return ${_ZoneName.Left[-15]}
		if ${_ZoneName.Find["Signature"]}
			return ${_ZoneName.Left[-9]}
		if ${_ZoneName.Find["Solo"]}
			return ${_ZoneName.Left[-4]}
		if ${_ZoneName.Find["Heroic"]}
			return ${_ZoneName.Left[-6]}
		if ${_ZoneName.Find["Expert"]}
			return ${_ZoneName.Left[-6]}
		if ${_ZoneName.Find["Expert Event"]}
			return ${_ZoneName.Left[-12]}
		if ${_ZoneName.Find["Event Heroic"]}
			return ${_ZoneName.Left[-12]}
		return ${_ZoneName}
	}
	member:int GroupDetrimentCount(string _Type)
	{
		variable int detcnt
		variable int i
		detcnt:Set[0]
		if ${_Type.Equals[Trauma]}
		{
			for(i:Set[0];${i}<${Me.Group};i:Inc)
			{
				if ${Me.Group[${i}].Trauma}>0
				{
					detcnt:Inc
				}
			}
		}
		elseif ${_Type.Equals[Noxious]}
		{
			for(i:Set[0];${i}<${Me.Group};i:Inc)
			{
				if ${Me.Group[${i}].Noxious}>0
				{
					detcnt:Inc
				}
			}
		}
		elseif ${_Type.Equals[Arcane]}
		{
			for(i:Set[0];${i}<${Me.Group};i:Inc)
			{
				if ${Me.Group[${i}].Arcane}>0
				{
					detcnt:Inc
				}
			}
		}
		elseif ${_Type.Equals[Elemental]}
		{
			for(i:Set[0];${i}<${Me.Group};i:Inc)
			{
				if ${Me.Group[${i}].Elemental}>0
				{
					detcnt:Inc
				}
			}
		}
		elseif ${_Type.Equals[Cursed]} || ${_Type.Equals[Curse]}
		{
			for(i:Set[0];${i}<${Me.Group};i:Inc)
			{
				if ${Me.Group[${i}].Cursed}>0
				{
					detcnt:Inc
				}
			}
		}
		return ${detcnt}
	}
	member:int ClosestPoint(int CurrentArrayPosition, string Loc, int _HowManyPoints=20, bool _Reverse=FALSE, bool _CheckCollision=TRUE)
	{
		;echo ClosestPoint(int CurrentArrayPosition=${CurrentArrayPosition}, string Loc=${Loc}, int _HowManyPoints=${_HowManyPoints}, bool _Reverse=${_Reverse}, bool _CheckCollision=${_CheckCollision}
		variable int counter=0
		variable int ClosestArrayPosition=${CurrentArrayPosition}
		variable int Distance=${Math.Distance[${Loc},${istrMain.Get[${CurrentArrayPosition}].Replace[" ",","]}]}
		if ${_Reverse}
		{
			if ${Math.Calc[${CurrentArrayPosition}-${_HowManyPoints}]}<1
				_HowManyPoints:Set[${Math.Calc[${CurrentArrayPosition}-1]}]
			for(counter:Set[${CurrentArrayPosition}];${counter}>=${Math.Calc[${CurrentArrayPosition}-${_HowManyPoints}]};counter:Dec)
			{
				if ${istrMain.Get[${counter}].NotEqual[Custom]} && ${istrMain.Get[${counter}].NotEqual[Wait]} && ${istrMain.Get[${counter}].NotEqual[ClickActor]} && ${istrMain.Get[${counter}].NotEqual[HailActor]} && ${istrMain.Get[${counter}].NotEqual[Named]} && ${istrMain.Get[${counter}].NotEqual[CustomNamed]} && ${istrMain.Get[${counter}].NotEqual[StandardNamed]} && ${istrMain.Get[${counter}].NotEqual[SameLock]} && ${istrMain.Get[${counter}].NotEqual[DontMoveBehind]} && ${istrMain.Get[${counter}].NotEqual[MoveBehind]} && ${istrMain.Get[${counter}].NotEqual[StopForCombat]} && ${istrMain.Get[${counter}].NotEqual[DontStopForCombat]} && ${istrMain.Get[${counter}].NotEqual[ClearTarget]} && ${istrMain.Get[${counter}].NotEqual[DontClearTarget]} && ${istrMain.Get[${counter}].NotEqual[DontKillAdd]} && ${istrMain.Get[${counter}].NotEqual[ReturnLOCS]} && ${istrMain.Get[${counter}].NotEqual["0 0 0"]} && ${istrMain.Get[${counter}].Length}>25 && ${Math.Distance[${Loc},${istrMain.Get[${counter}].Replace[" ",","]}](exists)}
				{
					;echo Checking ${counter}:: ${istrMain.Get[${counter}].Replace[" ",","]} :: ${Math.Distance[${Loc},${istrMain.Get[${counter}].Replace[" ",","]}]}<${Distance} :: ${Math.Distance[${Loc},${istrMain.Get[${counter}].Replace[" ",","]}](exists)}
					if ${Math.Distance[${Loc},${istrMain.Get[${counter}].Replace[" ",","]}]}<${Distance}
					; && ( !${EQ2.CheckCollision[${Loc},${istrMain.Get[${counter}].Replace[" ",","]}]} || !${_CheckCollision} )
					{
						ClosestArrayPosition:Set[${counter}]
						Distance:Set[${Math.Distance[${Loc},${istrMain.Get[${counter}].Replace[" ",","]}]}]
					}
				}
				;else
				;	echo Skipping ${counter}:: ${istrMain.Get[${counter}]}
			}
		}
		else
		{
			if ${Math.Calc[${CurrentArrayPosition}+${_HowManyPoints}]}>${istrMain.Used}
				_HowManyPoints:Set[${Math.Calc[${istrMain.Used}-${CurrentArrayPosition}]}]
			for(counter:Set[${CurrentArrayPosition}];${counter}<=${Math.Calc[${CurrentArrayPosition}+${_HowManyPoints}]};counter:Inc)
			{
				;echo Checking ${counter}:: ${istrMain.Get[${counter}].Replace[" ",","]}
				if ${istrMain.Get[${counter}].NotEqual[Custom]} && ${istrMain.Get[${counter}].NotEqual[Wait]} && ${istrMain.Get[${counter}].NotEqual[ClickActor]} && ${istrMain.Get[${counter}].NotEqual[HailActor]} && ${istrMain.Get[${counter}].NotEqual[Named]} && ${istrMain.Get[${counter}].NotEqual[CustomNamed]} && ${istrMain.Get[${counter}].NotEqual[StandardNamed]} && ${istrMain.Get[${counter}].NotEqual[SameLock]} && ${istrMain.Get[${counter}].NotEqual[DontMoveBehind]} && ${istrMain.Get[${counter}].NotEqual[MoveBehind]} && ${istrMain.Get[${counter}].NotEqual[StopForCombat]} && ${istrMain.Get[${counter}].NotEqual[DontStopForCombat]} && ${istrMain.Get[${counter}].NotEqual[ClearTarget]} && ${istrMain.Get[${counter}].NotEqual[DontClearTarget]} && ${istrMain.Get[${counter}].NotEqual[DontKillAdd]} && ${istrMain.Get[${counter}].NotEqual[ReturnLOCS]} && ${istrMain.Get[${counter}].NotEqual["0 0 0"]} && ${istrMain.Get[${counter}].Length}>13 && ${Math.Distance[${Loc},${istrMain.Get[${counter}].Replace[" ",","]}](exists)}
				{
					;echo Checking ${counter}:: ${istrMain.Get[${counter}].Replace[" ",","]} :: ${Math.Distance[${Loc},${istrMain.Get[${counter}].Replace[" ",","]}]}<${Distance} :: ${Math.Distance[${Loc},${istrMain.Get[${counter}].Replace[" ",","]}](exists)}
					if ${Math.Distance[${Loc},${istrMain.Get[${counter}].Replace[" ",","]}]}<${Distance}
					; && ( !${EQ2.CheckCollision[${Loc},${istrMain.Get[${counter}].Replace[" ",","]}]} || !${_CheckCollision} )  /// while checkcollision is broken
					{
						ClosestArrayPosition:Set[${counter}]
						Distance:Set[${Math.Distance[${Loc},${istrMain.Get[${counter}].Replace[" ",","]}]}]
					}
				}
				;else
				;	echo Skipping ${counter}:: ${istrMain.Get[${counter}]}
			}
		}

		;echo RETURNING: ${ClosestArrayPosition} and Our Main: ${MainArrayCounter}
		return ${ClosestArrayPosition}
	}
	member:int MobCount(string _MobName, int _Distance=100)
	{
		variable index:actor ActorIndex
		EQ2:GetActors[ActorIndex,range,${_Distance}]
		EQ2:QueryActors[ActorIndex,( Type =="NPC" || Type =="NamedNPC" ) && Health >0 && IsDead = FALSE && Distance <= ${_Distance} && Name=-"${_MobName}"]
		return ${ActorIndex.Used}
	}
	function SingularFocus(int _OnOff=1)
	{
		if ${_OnOff}==1
		{
			;turn on Singular Focus 4026518400  or if guardian Focused Offensive 1432018334
			if ${Me.SubClass.Equal[guardian]} && ${Me.Ability[id,1432018334].IsReady}
			{
				while !${Me.Maintained[Focused Offensive](exists)}
				{
					while ${Me.Ability[id,1432018334].IsReady}
					{
						Me.Ability[id,1432018334]:Use
						wait 5 ${Me.Maintained[Focused Offensive](exists)}
					}
					wait 5 ${Me.Maintained[Focused Offensive](exists)}
				}
			}
			elseif ${Me.Ability[id,4026518400].IsReady}
			{
				
				while !${Me.Maintained[Singular Focus](exists)}
				{
					while ${Me.Ability[id,4026518400].IsReady}
					{
						Me.Ability[id,4026518400]:Use
						wait 5 ${Me.Maintained[Singular Focus](exists)}
					}
					wait 5 ${Me.Maintained[Singular Focus](exists)}
				}
			}
		}
		else
		{
			if ${Me.SubClass.Equal[guardian]}
				Me.Maintained[Focused Offensive]:Cancel
			else
				Me.Maintained[Singular Focus]:Cancel
		}
		
	}
	member:int LowestGroupHealth()
	{
		variable int _cnt=0
		variable int _lowestHealth=100
		for(_cnt:Set[0];${_cnt}<${Me.Group};_cnt:Inc)
		{
			if ${Me.Group[${_cnt}].Health}<${_lowestHealth}
				_lowestHealth:Set[${Me.Group[${_cnt}].Health}]
		}
		return ${_lowestHealth}
	}
	member:int CountActors(string _ActorName, int _Range=100)
	{
		variable index:actor ActorIndex
		EQ2:GetActors[ActorIndex,range,${_Range}]
		EQ2:QueryActors[ActorIndex, Name=-"${_ActorName}"]
		return ${ActorIndex.Used}
	}
	member:int CountAllAggroActors(int _Range=100)
	{
		variable index:actor ActorIndex
		EQ2:GetActors[ActorIndex,range,${_Range}]
		EQ2:QueryActors[ActorIndex, IsAggro=TRUE && Target.InMyGroup=TRUE]
		return ${ActorIndex.Used}
	}
	function Target(... args)
	{
		variable int _cnt=0
		variable bool LowestHealth=0
		variable int MobWithLowestHealth=100
		variable int MobWithLowestHealthID=100
		variable index:actor ActorIndex
		variable int i=0
		if !${RI_Var_Bool_GlobalOthers}
		{
			for(_cnt:Set[1];${_cnt}<=${args.Used};_cnt:Inc)
			{
				if ${args[${_cnt}].Find["-Distance"](exists)}
				{
					_cnt:Inc
					continue
				}
				if ${args[${_cnt}].Find["-LowestHealth"](exists)}
				{
					LowestHealth:Set[1]
					continue
				}
				if ${Int[${args[${_cnt}]}]}>0
				{
					;echo ${_cnt}: ${args[${_cnt}]}: ${Actor[Query, ID=${args[${_cnt}]} && IsDead=FALSE]}: ${Actor[Query, ID=${args[${_cnt}]} && IsDead=FALSE](exists)}  ${args[${Math.Calc[${_cnt}+1]}].Find["-Distance"](exists)} ${Int[${args[${Math.Calc[${_cnt}+2]}]}]}
					if ${args[${Math.Calc[${_cnt}+1]}].Find["-Distance"](exists)}
					{
						if ${Actor[Query, ID=${args[${_cnt}]} && InCombatMode=TRUE && IsDead=FALSE && Distance<=${Int[${args[${Math.Calc[${_cnt}+2]}]}]}](exists)}
						{
							if ${Target.ID}!=${args[${_cnt}]}
								Actor[Query, ID=${args[${_cnt}]} && InCombatMode=TRUE && IsDead=FALSE]:DoTarget
							return
						}
					}
					else
					{
						if ${Actor[Query, ID=${args[${_cnt}]} && InCombatMode=TRUE && IsDead=FALSE](exists)}
						{
							if ${Target.ID}!=${args[${_cnt}]}
								Actor[Query, ID=${args[${_cnt}]} && InCombatMode=TRUE && IsDead=FALSE]:DoTarget
							return
						}
					}
				}
				else
				{
					;echo ${_cnt}: ${args[${_cnt}]}: ${Actor[Query, Name=-"${args[${_cnt}]}" && IsDead=FALSE]}: ${Actor[Query, Name=-"${args[${_cnt}]}" && IsDead=FALSE](exists)}  ${args[${Math.Calc[${_cnt}+1]}].Find["-Distance"](exists)} ${Int[${args[${Math.Calc[${_cnt}+2]}]}]} ${args[${Math.Calc[${_cnt}+2]}]}
					if ${args[${Math.Calc[${_cnt}+1]}].Find["-Distance"](exists)}
					{
						if ${Actor[Query, Name=-"${args[${_cnt}]}" && ( Type =="NPC" || Type =="NamedNPC" ) && InCombatMode=TRUE && IsDead=FALSE && Distance<=${Int[${args[${Math.Calc[${_cnt}+2]}]}]}](exists)}
						{
							if ${LowestHealth}
							{	
								EQ2:GetActors[ActorIndex,range,${Int[${args[${Math.Calc[${_cnt}+2]}]}]}]
								EQ2:QueryActors[ActorIndex,( Type =="NPC" || Type =="NamedNPC" ) && InCombatMode = TRUE && Health >0 && IsDead = FALSE && Distance <= ${Int[${args[${Math.Calc[${_cnt}+2]}]}]} && Name=-"${args[${_cnt}]}"]
								for(i:Set[1];${i}<=${ActorIndex.Used};i:Inc)
								{
									if ${ActorIndex[${i}].Health}<=${MobWithLowestHealth}
									{
										MobWithLowestHealthID:Set[${ActorIndex[${i}].ID}]
										MobWithLowestHealth:Set[${ActorIndex[${i}].Health}]
									}
								}
								if ${Target.ID}!=${MobWithLowestHealthID}
									Actor[Query, ID=${MobWithLowestHealthID} && InCombatMode=TRUE && IsDead=FALSE]:DoTarget
								return
							}
							else
							{
								if ${Target.ID}!=${Actor[Query, Name=-"${args[${_cnt}]}" && ( Type =="NPC" || Type =="NamedNPC" ) && InCombatMode=TRUE && IsDead=FALSE].ID}
									Actor[Query, Name=-"${args[${_cnt}]}" && ( Type =="NPC" || Type =="NamedNPC" ) && InCombatMode=TRUE && IsDead=FALSE]:DoTarget
								return
							}
						}
					}
					else
					{
						if ${Actor[Query, Name=-"${args[${_cnt}]}" && ( Type =="NPC" || Type =="NamedNPC" ) && InCombatMode=TRUE && IsDead=FALSE](exists)}
						{
							if ${LowestHealth}
							{	
								EQ2:GetActors[ActorIndex,range,${Int[${args[${Math.Calc[${_cnt}+2]}]}]}]
								EQ2:QueryActors[ActorIndex,( Type =="NPC" || Type =="NamedNPC" ) && InCombatMode = TRUE && Health >0 && IsDead = FALSE && Distance <= ${Int[${args[${Math.Calc[${_cnt}+2]}]}]} && Name=-"${args[${_cnt}]}"]
								for(i:Set[1];${i}<=${ActorIndex.Used};i:Inc)
								{
									if ${ActorIndex.Get[${i}].Health]}<=${MobWithLowestHealth}
									{
										MobWithLowestHealthID:Set[${ActorIndex.Get[${i}].ID]}]
										MobWithLowestHealth:Set[${ActorIndex.Get[${i}].Health]}]
									}
								}
								if ${Target.ID}!=${MobWithLowestHealthID}
									Actor[Query, ID=${MobWithLowestHealthID} && InCombatMode=TRUE && IsDead=FALSE]:DoTarget
								return
							}
							else
							{
								if ${Target.ID}!=${Actor[Query, Name=-"${args[${_cnt}]}" && Type!="Mercenary" && InCombatMode=TRUE && IsDead=FALSE].ID}
									Actor[Query, Name=-"${args[${_cnt}]}" && ( Type =="NPC" || Type =="NamedNPC" ) && InCombatMode=TRUE && IsDead=FALSE]:DoTarget
								return
							}
						}
					}
				}
			}
		}
	}
	function LockAndPull(int _ID, string _LockSpot, int _Distance=10, bool _MoveBehind=TRUE, bool _WaitMob=TRUE)
	{
		;set lockspot
		if !${RI_Var_Bool_GlobalOthers}
		{
			variable int _lpfailcnt=0
			Actor[Query, ID=${_ID} && IsDead=FALSE]:DoTarget
			while ${_WaitMob} && ${Actor[Query, ID=${_ID} && IsDead=FALSE].Distance}<30 && ${Actor[Query, ID=${_ID} && IsDead=FALSE].Distance}>15 && ${_lpfailcnt:Inc}<250
			{
				Actor[Query, ID=${_ID} && IsDead=FALSE]:DoTarget
				wait 2
			}
			if ${_LockSpot.Find["|"](exists)}
			{
				RIMUIObj:SetLockSpot[${Me.Name},${_LockSpot.Token[1,|]},1,1000]
				relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${_LockSpot.Token[2,|]},1,1000]
			}
			else
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_LockSpot},1,1000]
			wait 150 ${Math.Distance[${Me.Loc},${_LockSpot}]}<3
			wait 150 ${Actor[Query, ID=${_ID} && IsDead=FALSE].Distance}<${_Distance}
			wait 10
			relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
		}
		elseif ${_MoveBehind} && ${Me.Archetype.Equal[scout]}
		{
			if ${_LockSpot.Find["|"](exists)}
				wait 150 ${Math.Distance[${Me.Loc},${_LockSpot.Token[2,|]}]}<3
			else
				wait 150 ${Math.Distance[${Me.Loc},${_LockSpot}]}<3
			wait 150 ${Actor[Query, ID=${_ID} && IsDead=FALSE].Distance}<${_Distance}
			RIMUIObj:SetLockSpot[OFF]
			wait 20
			call MoveBehind 1
		}
	}
	function AvoidActors(weakref _Locs, weakref _ActorIndex, int _DistanceAllowed)
	{
		variable int _i
		variable int _f
		
		variable int _ClosestDistance=100000
		variable int _ClosestDistanceToMe=100000
		variable int _ClosestLoc=0
				
		if ${_ActorIndex.Used}==0
			return
		;First check each loc distance from each actor and check they are at allowed distance or more
		;add each loc to the index that meets the requirements
		;then check which of those locs is closest to me and set it

		variable bool _Meets=TRUE
		variable index:int _LocMeets
		for(_i:Set[1];${_i}<=${_Locs.Used};_i:Inc)
		{
			_Meets:Set[TRUE]
			for(_f:Set[1];${_f}<=${_ActorIndex.Used};_f:Inc)
			{
				;echo ${_i}\${Math.Distance[${_Locs.Get[${_i}]},${_ActorIndex.Get[${_f}].Loc}]}<\${_DistanceAllowed} =${Math.Distance[${_Locs.Get[${_i}]},${_ActorIndex.Get[${_f}].Loc}]}<${_DistanceAllowed}
				if ${Math.Distance[${_Locs.Get[${_i}]},${_ActorIndex.Get[${_f}].Loc}]}<${_DistanceAllowed}
					_Meets:Set[FALSE]
			}
			if ${_Meets}
			{
				_LocMeets:Insert[${_i}]
			}
		}
		;echo _LocMeets=${_LocMeets.Used}
		;echo _DistanceAllowed=${_DistanceAllowed}
		_ClosestDistance:Set[10000000]
		for(_i:Set[1];${_i}<=${_LocMeets.Used};_i:Inc)
		{
			;echo ${_LocMeets.Get[${_i}]}: \${Me.Distance[${_Locs.Get[${_LocMeets.Get[${_i}]}]}]}<${_ClosestDistance} // ${Me.Distance[${_Locs.Get[${_LocMeets.Get[${_i}]}]}]}<${_ClosestDistance}
			if ${Me.Distance[${_Locs.Get[${_LocMeets.Get[${_i}]}]}]}<${_ClosestDistance}
			{
				_ClosestDistance:Set[${Me.Distance[${_Locs.Get[${_LocMeets.Get[${_i}]}]}]}]
				_ClosestLoc:Set[${_LocMeets.Get[${_i}]}]
			}
		}
		;echo ${_ClosestLoc}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Locs.Get[${_ClosestLoc}]}]
	}
	function Dispell(int _ID, int _MainIconID=-1, int _Increments=0)
	{
		variable string _DispellName
		variable int _DispellID
		if ${Me.SubClass.Equal[warden]}
		{
			_DispellName:Set[Serene Symbol]
			_DispellID:Set[3407210004]
		}
		elseif ${Me.Class.Equal[shaman]} && ${Me.Ability[id,1404539726](exists)}
		{
			_DispellName:Set[Scourge]
			_DispellID:Set[1404539726]
		}
		elseif ${Me.Archetype.Equal[mage]}
		{
			_DispellName:Set[Absorb Magic]
			_DispellID:Set[1812025739]
		}
		else
			return
		
		;if we see The MainIconID of the Ability on Named, pause bot, stop casting and cast _DispellName
		if ( ${_MainIconID}==-1 || ( ${RIMUIObj.MainIconIDExists[${_ID},${_MainIconID}]} && ${_Increments}==0 ) || ( ${RIMUIObj.MainIconIDExists[${_ID},${_MainIconID}]} && ${Actor[id,${_ID}].Effect[${RIMUIObj.MainIconIDExists[${_ID},${_MainIconID}]}].CurrentIncrements}>=${_Increments} ) ) && ${Me.Ability[id,${_DispellID}].IsReady}
		{
			;echo ( ${_MainIconID}==-1 || ( ${RIMUIObj.MainIconIDExists[${_ID},${_MainIconID}]} && ${_Increments}==0 ) || ( ${RIMUIObj.MainIconIDExists[${_ID},${_MainIconID}]} && ${Actor[id,${_ID}].Effect[${RIMUIObj.MainIconIDExists[${_ID},${_MainIconID}]}].CurrentIncrements}>=${_Increments} ) ) && ${Me.Ability[id,${_DispellID}].IsReady}
			if ${RI_Var_Bool_Debug}
				echo ISXRI: ${Time}: MainIconID: ${_MainIconID} Found or none required, and ${_DispellName} is ready
			
			;turn off assisting
			RI_CMD_Assisting 0
			
			;pause bots
			RI_CMD_PauseCombatBots 1
			
			;target
			Actor[Query, ID=${_ID}]:DoTarget
			
			;cancel spellcast and clear ability queue
			eq2ex cancel_spellcast
			eq2ex clearabilityqueue 
			
			;wait until we are not casting
			wait 200 !${Me.CastingSpell}
			
			;keep attempting to cast ${_DispellName} (ID=${_DispellID}) until it is no longer ready (aka casted)
			do
			{
				if ${Target.ID}==${_ID}
					Me.Ability[id,${_DispellID}]:Use
				else
					Actor[Query, ID=${_ID}]:DoTarget
				wait 1
			}
			while ${Me.Ability[id,${_DispellID}].IsReady}
			
			;wait until we are not casting
			wait 200 !${Me.CastingSpell}
			
			;turn on assisting
			RI_CMD_Assisting 1
			
			;unpause bots
			RI_CMD_PauseCombatBots 0
		}
	}
	function MageAbsorbMagic(int _ID, int _MainIconID=-1, int _Increments=0)
	{
		;if we are a mage watch for spell's MainIconID and cast absorb magic
		if ${Me.Archetype.Equal[mage]}
		{
			;if we see The MainIconID of the Ability on Named, pause bot, stop casting and cast Absorb Magic
			if ( ${_MainIconID}==-1 || ( ${RIMUIObj.MainIconIDExists[${_ID},${_MainIconID}]} && ${_Increments}==0 ) || ( ${Actor[id,${_ID}].Effect[${RIMUIObj.MainIconIDExists[${_ID},${_MainIconID}]}].CurrentIncrements}>=${_Increments} ) ) && ${Me.Ability[id,1812025739].IsReady}
			{
				if ${RI_Var_Bool_Debug}
					echo ISXRI: ${Time}: MainIconID: ${_MainIconID} Found or none required
				
				;turn off assisting
				RI_CMD_Assisting 0
				
				;pause bots
				RI_CMD_PauseCombatBots 1
				
				;target
				Actor[Query, ID=${_ID}]:DoTarget
				
				;cancel spellcast and clear ability queue
				eq2ex cancel_spellcast
				eq2ex clearabilityqueue 
				
				;wait until we are not casting
				wait 200 !${Me.CastingSpell}
				
				;keep attempting to cast absorb magic (ID=1812025739) until it is no longer ready (aka casted)
				do
				{
					if ${Target.ID}==${_ID}
						Me.Ability[id,1812025739]:Use
					else
						Actor[Query, ID=${_ID}]:DoTarget
					wait 1
				}
				while ${Me.Ability[id,1812025739].IsReady}
				
				;wait until we are not casting
				wait 200 !${Me.CastingSpell}
				
				;turn on assisting
				RI_CMD_Assisting 1
				
				;unpause bots
				RI_CMD_PauseCombatBots 0
			}
		}
	}
	member:string Archetype(string _Actor)
	{
		variable int _ID
		if ${Int[${_Actor}]}>5
		{
			_ID:Set[${Int[${_Actor}]}]
		}
		elseif ${Int[${_Actor}]}>0
		{
			_ID:Set[${Me.Group[${Int[${_Actor}]}].ID}]
		}
		else
		{
			_ID:Set[${Actor[Query, Name=-"${_Actor}"].ID}]
		}
		switch ${Actor[Query, ID=${_ID}].Class}
		{
			case defiler
			case mystic
			case warden
			case fury
			case templar
			case inquisitor
			case channeler
			{
				return priest
				break
			}
			case dirge
			case troubador
			case assassin
			case ranger
			case brigand
			case swashbuckler
			case beastlord
			{
				return scout
				break
			}
			case monk
			case bruiser
			case guardian
			case berserker
			case shadowknight
			case paladin
			{
				return fighter
				break
			}
			case coercer
			case illusionist
			case wizard
			case warlock
			case necromancer
			case conjuror
			{
				return mage
				break
			}
		}
	}
	method SetShinyScanDistance(int _Distance)
	{
		ShinyScanDistance:Set[${_Distance}]
	}
	method BreakPathFunction()
	{
		RI_Var_Bool_BreakPathFunction:Set[1]
	}
	variable index:string ZoneList
	method GetZoneLists()
	{
		if !${EQ2UIPage[popup,ZoneTeleporter].IsVisible}
			return
		variable index:collection:string _Zones
		variable iterator _ZonesIterator

		EQ2UIPage[popup,ZoneTeleporter].Child[list,Destinations.DestinationList]:GetOptions[_Zones]

		ZoneList:Clear
		
		_Zones:GetIterator[_ZonesIterator]
		if ${_ZonesIterator:First(exists)}
		{
			do
			{
				ZoneList:Insert["${_ZonesIterator.Value.Element[text]}"]
			}
			while ${_ZonesIterator:Next(exists)}
		}
	}
	member:int RowByName(string _ZoneName)
	{
		variable iterator _ZonesIterator
		ZoneList:GetIterator[_ZonesIterator]
		if ${_ZonesIterator:First(exists)}
		{
			do
			{
				if ${_ZonesIterator.Value.Upper.Find["${_ZoneName.Upper}"](exists)}
					return ${_ZonesIterator.Key}
			}
			while ${_ZonesIterator:Next(exists)}
		}
		return 0
	}
	
	member:int MainIconIDExists(int _ActorID, int _MainIconID, bool _Det=TRUE)
	{
		variable int Counter=1
		variable int NumActorEffects
		if ${_ActorID}==${Me.ID}
		{
			if ${_Det}
				NumActorEffects:Set[${Me.CountEffects[detrimental]}]
			else
				NumActorEffects:Set[${Me.CountEffects}]
				
			if (${NumActorEffects} > 0)
			{
				do
				{
					if ${_Det}
					{
						if ${Me.Effect[detrimental,${Counter}].MainIconID}==${_MainIconID}
						{
							return ${Counter}
						}
					}
					else
					{
						if ${Me.Effect[${Counter}].MainIconID}==${_MainIconID}
						{
							return ${Counter}
						}
					}
				}
				while (${Counter:Inc} <= ${NumActorEffects})
				return 0
			}
			else
				return 0
		}
		elseif (${Actor[id,${_ActorID}](exists)})
		{
			NumActorEffects:Set[${Actor[id,${_ActorID}].NumEffects}]
			
			if (${NumActorEffects} > 0)
			{
				do
				{
					if ${Actor[id,${_ActorID}].Effect[${Counter}].MainIconID}==${_MainIconID}
					{
						return ${Counter}
					}
				}
				while (${Counter:Inc} <= ${NumActorEffects})
				return 0
			}
			else
				return 0
		}
		else
			return 0
	}
	variable int ScriptTargetTime=0
	method BalanceMobs(string MobName=ALL, int BalanceNum=2, int WaitTime=5000, bool _SeperateCalling=FALSE)
	{
		;echo BalanceMobs(string MobName=${MobName}, int BalanceNum=${BalanceNum}, int WaitTime=${WaitTime})
		if !${RI_Var_Bool_BalanceTrash} && !${_SeperateCalling}
			return
		variable index:actor ActorIndex
		variable iterator ActorIterator
		variable int BalanceMobWithHighestHealth=0
		
		;QueryActors to our ActorIndex that are NPC or NamedNPC and within distance 20 and InCombatMode and NotDead
		
		if ${MobName.Equal[ALL]}	
			EQ2:QueryActors[ActorIndex,( Type =="NPC" || Type =="NamedNPC" ) && Target.InMyGroup = TRUE && InCombatMode = TRUE && IsDead = FALSE && Distance <= 20]
		else
			EQ2:QueryActors[ActorIndex,( Type =="NPC" || Type =="NamedNPC" ) && Target.InMyGroup = TRUE && Name=-"${MobName}" && InCombatMode = TRUE && IsDead = FALSE && Distance <= 20]
			
		ActorIndex:GetIterator[ActorIterator]
		
		;echo ${ActorIndex.Used}
		if ${ActorIterator:First(exists)}
		{
			do
			{
				;if the actor's health is higher than BalanceMobWithHighestHealth
				;set them to BalanceMobWithHighestHealth
				if ${ActorIterator.Value.Health}>${Math.Calc[${Actor[${BalanceMobWithHighestHealth}].Health}+${BalanceNum}]}
					BalanceMobWithHighestHealth:Set[${ActorIterator.Value.ID}]
			}
			while ${ActorIterator:Next(exists)}
			;if i am not targeting BalanceMobWithHighestHealth and it is not 0 and exists
			;target BalanceMobWithHighestHealth
			if ${Target.ID}!=${BalanceMobWithHighestHealth} && ${BalanceMobWithHighestHealth}!=0 && ${Actor[${BalanceMobWithHighestHealth}](exists)} && !${Actor[${BalanceMobWithHighestHealth}].IsDead} && ${Script.RunningTime}>${Math.Calc[${ScriptTargetTime}+${WaitTime}]}
			{
				;echo ${Time}: Targeting ${BalanceMobWithHighestHealth} / ${Actor[${BalanceMobWithHighestHealth}]} Health: ${Actor[${BalanceMobWithHighestHealth}].Health}
				Actor[${BalanceMobWithHighestHealth}]:DoTarget
				ScriptTargetTime:Set[${Script.RunningTime}]
			}
		}
	}
	member:bool QuestStepExists(string _QuestStep, bool _isChecked=FALSE)
	{
		variable index:collection:string Details    
		variable iterator DetailsIterator
		variable int DetailsCounter = 0
		variable bool _FoundIt = FALSE
		variable bool _Checked = FALSE
	;    echo "Journal Current Quest:"
	;    echo "- Name: ${QuestJournalWindow.CurrentQuest.Name.GetProperty["LocalText"]}"
	;    echo "- Level: ${QuestJournalWindow.CurrentQuest.Level.GetProperty["LocalText"]}"
	;    echo "- Category: ${QuestJournalWindow.CurrentQuest.Category.GetProperty["LocalText"]}"
	;    echo "- CurrentZone: ${QuestJournalWindow.CurrentQuest.CurrentZone.GetProperty["LocalText"]}"
	;    echo "- TimeStamp: ${QuestJournalWindow.CurrentQuest.TimeStamp.GetProperty["LocalText"]}"
	;    echo "- MissionGroup: ${QuestJournalWindow.CurrentQuest.MissionGroup.GetProperty["LocalText"]}"
	;    echo "- Status: ${QuestJournalWindow.CurrentQuest.Status.GetProperty["LocalText"]}"
	;    echo "- ExpirationTime: ${QuestJournalWindow.CurrentQuest.ExpirationTime.GetProperty["LocalText"]}"
	;    echo "- Body: ${QuestJournalWindow.CurrentQuest.Body.GetProperty["LocalText"]}"
		
		QuestJournalWindow.CurrentQuest:GetDetails[Details]
		Details:GetIterator[DetailsIterator]
	;    echo "- Details:"
		if (${DetailsIterator:First(exists)})
		{
			do
			{
				if (${DetailsIterator.Value.FirstKey(exists)})
				{
					do
					{
						;echo "-- ${DetailsCounter}::  '${DetailsIterator.Value.CurrentKey}' => '${DetailsIterator.Value.CurrentValue}'"
						;echo ${DetailsIterator.Value.CurrentValue.Find[${_QuestStep}](exists)} // ${DetailsIterator.Value.CurrentValue}
						if ${DetailsIterator.Value.CurrentKey.Equal[Check]} && ${DetailsIterator.Value.CurrentValue.Find[true](exists)}
							_Checked:Set[TRUE]
						if ${DetailsIterator.Value.CurrentKey.Equal[Check]} && ${DetailsIterator.Value.CurrentValue.Find[false](exists)}
							_Checked:Set[FALSE]
						if ${DetailsIterator.Value.CurrentKey.Equal[Text]} && ${DetailsIterator.Value.CurrentValue.Find[${_QuestStep}](exists)}
							_FoundIt:Set[TRUE]
					}
					while ${DetailsIterator.Value.NextKey(exists)}
					 ;echo "------"
				}
				DetailsCounter:Inc
			}
			while ${DetailsIterator:Next(exists)} && !${_FoundIt}
		}
		;echo FoundIt: ${_FoundIt} isChecked: ${_isChecked} Checked: ${_Checked}
		if ( ${_FoundIt} && !${_isChecked} && !${_Checked} ) || ( ${_FoundIt} && ${_isChecked} && ${_Checked} )
			return TRUE
		else
			return FALSE
	}
	
	member:bool QuestExists(string _QuestName)
	{
		variable index:quest Quests
		variable iterator QuestsIterator
		
		QuestJournalWindow:GetActiveQuests[Quests]
		Quests:GetIterator[QuestsIterator]
	  
		if ${QuestsIterator:First(exists)}
		{
			do
			{
				;echo ${QuestsIterator.Value.Name}==${_QuestName} :: ${QuestsIterator.Value.Name.Equal[${_QuestName}]}
				if ${QuestsIterator.Value.Name.Equal["${_QuestName}"]}
				{
					return TRUE
				}
			}
			while ${QuestsIterator:Next(exists)}
		}
		return FALSE
	}
	member:bool CompletedQuestExists(string _QuestName)
	{
		variable index:quest Quests
		variable iterator QuestsIterator
		
		QuestJournalWindow:GetCompletedQuests[Quests]
		Quests:GetIterator[QuestsIterator]
	  
		if ${QuestsIterator:First(exists)}
		{
			do
			{
				;echo ${QuestsIterator.Value.Name}==${_QuestName} :: ${QuestsIterator.Value.Name.Equal[${_QuestName}]}
				if ${QuestsIterator.Value.Name.Equal["${_QuestName}"]}
				{
					return TRUE
				}
			}
			while ${QuestsIterator:Next(exists)}
		}
		return FALSE
	}
	method EndScript()
	{
		Script:End
	}
	method QueueCommand(string _ForWho, string _ScriptName, string _Command, string _args)
	{
		echo QueueCommand(string _ForWho=${_ForWho}, string _ScriptName=${_ScriptName}, string _Command=${_Command}, string _args=${_args})
		if ${RIMUIObj.ForWhoCheck["${_ForWho}"]}
			Script[${_ScriptName}]:QueueCommand["${_Command} ${_args}"]
	}
}

;EndForFunction
function EndForFunction()
{
	if ${LineRead.Equal[DontStopForCombat]}
		StopForCombat:Set[FALSE]
	elseif ${LineRead.Equal[StopForCombat]}
		StopForCombat:Set[TRUE]
	elseif ${LineRead.Equal[DontClearTarget]}
		ClearTarget:Set[FALSE]
	elseif ${LineRead.Equal[ClearTarget]}
		ClearTarget:Set[TRUE]
	elseif ${LineRead.NotEqual[Custom]} && ${LineRead.NotEqual[Wait]} && ${LineRead.NotEqual[ClickActor]} && ${LineRead.NotEqual[HailActor]} && ${LineRead.NotEqual[Named]} && ${LineRead.NotEqual[DontStopForCombat]} && ${LineRead.NotEqual[StopForCombat]} && ${LineRead.NotEqual[DontClearTarget]} && ${LineRead.NotEqual[ClearTarget]} && ${LineRead.NotEqual[StartQuest]} && ${LineRead.NotEqual[StopQuest]} && ${LineRead.NotEqual[NULL]}
	{
		if ${RI_Var_Bool_Debug}
			echo ${Time}: Move ${LineRead}
		if ${LineRead.NotEqual["0 0 0"]}
		{
			call RIMObj.Move ${LineRead} ${Precision} 0 ${ClearTarget} ${StopForCombat} FALSE TRUE TRUE
		}
	}
	wait 1
}

;CheckGatherRemains function
function CheckGatherRemains()
{
	;Gather Remains ID=2607033953
	if !${Me.InCombat}
	{
		if (${Me.Group[1].IsDead} || ${Me.Group[2].IsDead} || ${Me.Group[3].IsDead} || ${Me.Group[4].IsDead} || ${Me.Group[5].IsDead})
		{
			if (${Me.Group[1].Distance}>30 || ${Me.Group[2].Distance}>30 || ${Me.Group[3].Distance}>30 || ${Me.Group[4].Distance}>30 || ${Me.Group[5].Distance}>30 )
			{
				if ${Me.Ability[id,2607033953].IsReady}
					Me.Ability[id,2607033953]:Use
			}
		}
	}
}


function FindClosestWaypoint(string InputArrayElement)
{
	
	TempArrayPosition:Set[${MainArrayCounter}]
	if ${RI_Var_Bool_Debug}
		echo ${Time}: Checking Array at ${TempArrayPosition} Element: "${InputArrayElement}"

	if ${InputArrayElement.Equal[Custom]}
		MainArrayCounter:Inc
	elseif ${InputArrayElement.Equal[Wait]}
		MainArrayCounter:Inc
	elseif ${InputArrayElement.Equal[ClickActor]}
		MainArrayCounter:Inc
	elseif ${InputArrayElement.Equal[HailActor]}
		MainArrayCounter:Inc
	elseif ${InputArrayElement.Equal[Named]}
		MainArrayCounter:Inc
	elseif ${InputArrayElement.Equal[DiffLock]}
		MainArrayCounter:Inc
	elseif ${InputArrayElement.Equal[KillAdd]}
		MainArrayCounter:Inc
	elseif ${InputArrayElement.Length}<15
		MainArrayCounter:Inc
	;elseif ${InputArrayElement.Equal["0 0 0"]}
	;	MainArrayCounter:Inc
	elseif ${InputArrayElement.Equal[ReturnLOCS]}
		MainArrayCounter:Set[${istrMain.Used}]
	;found waypoint on line call waypointchecker
	elseif ${InputArrayElement.NotEqual[Custom]} && ${InputArrayElement.NotEqual[Wait]} && ${InputArrayElement.NotEqual[ClickActor]} && ${InputArrayElement.NotEqual[HailActor]} && ${InputArrayElement.NotEqual[Named]} && ${InputArrayElement.NotEqual[CustomNamed]} && ${InputArrayElement.NotEqual[StandardNamed]} && ${InputArrayElement.NotEqual[SameLock]} && ${InputArrayElement.NotEqual[DontMoveBehind]} && ${InputArrayElement.NotEqual[MoveBehind]} && ${InputArrayElement.NotEqual[StopForCombat]} && ${InputArrayElement.NotEqual[DontStopForCombat]} && ${InputArrayElement.NotEqual[ClearTarget]} && ${InputArrayElement.NotEqual[DontClearTarget]} && ${InputArrayElement.NotEqual[DontKillAdd]} && ${InputArrayElement.NotEqual[ReturnLOCS]} && ${InputArrayElement.NotEqual["0 0 0"]} && ${InputArrayElement.Length}>10
		call WaypointChecker ${InputArrayElement}
}
function WaypointChecker(float WX, float WY, float WZ)
{
	if ${WX}==0 && ${WY}==0 && ${WZ}==0
		return
	if ${RI_Var_Bool_Debug}
		echo ${Time}: TempArrayPosition is ${TempArrayPosition} and ArrayPosition is: ${ArrayPosition} ClosestWaypointDistance is ${ClosestWaypointDistance} and ClosestWaypoint is ${ClosestWaypoint}, Checking Waypoint ${WX} ${WY} ${WZ}
	;set vars if we are at begining of file
	if ${TempArrayPosition}==1
	{
		ArrayPosition:Set[${TempArrayPosition}]
		ClosestWaypointDistance:Set[${Math.Distance[${Me.X},${Me.Y},${Me.Z},${WX},${WY},${WZ}]}]
		ClosestWaypoint:Set[${WX} ${WY} ${WZ}]
	}
	;compare waypoint with current position and store them in variables if they are closer
	if ${Math.Distance[${Me.X},${Me.Y},${Me.Z},${WX},${WY},${WZ}]}<${ClosestWaypointDistance} && !${Me.CheckCollision[${Me.X},${Me.Y},${Me.Z},${WX},${WY},${WZ}]}
	{
		if ${RI_Var_Bool_Debug}
			echo ${Time}: We found a closter waypoint at ${TempArrayPosition}, position in the array it is ${ClosestWaypoint} at a distance of ${Math.Distance[${Me.X},${Me.Y},${Me.Z},${WX},${WY},${WZ}]} and our collision is ${Me.CheckCollision[${Me.X},${Me.Y},${Me.Z},${WX},${WY},${WZ}]}
		ArrayPosition:Set[${TempArrayPosition}]
		ClosestWaypointDistance:Set[${Math.Distance[${Me.X},${Me.Y},${Me.Z},${WX},${WY},${WZ}]}]
		ClosestWaypoint:Set[${ClosestWaypoint}]
		FoundCloserWaypoint:Set[TRUE]
	}
	;else
	;	echo the waypoint is ${Math.Distance[${Me.X},${Me.Y},${Me.Z},${WX},${WY},${WZ}]} away and is smaller than ${ClosestWaypointDistance}
}
function Named(string Name, bool Lock, float LockMXN, float LockMYN, float LockMZN, bool LockOthersDiff, float LockOXN, float LockOYN, float LockOZN, bool NMoveBehind, bool RunSpecificFunction, string NameofSpecificFunction, bool NKillAdd, string NAddName)
{
	;echo Named(string Name=${Name}, bool Lock=${Lock}, float LockMXN=${LockMXN}, float LockMYN=${LockMYN}, float LockMZN=${LockMZN}, bool LockOthersDiff=${LockOthersDiff}, float LockOXN=${LockOXN}, float LockOYN=${LockOYN}, float LockOZN=${LockOZN}, bool NMoveBehind=${NMoveBehind}, bool RunSpecificFunction=${RunSpecificFunction}, string NameofSpecificFunction=${NameofSpecificFunction}, bool NKillAdd=${NKillAdd}, string NAddName=${NAddName})
	if ${Actor[NamedNPC,${Name}](exists)}
		NameID:Set[${Actor[NamedNPC,${Name}].ID}]
	else
		NameID:Set[${Actor[${Name}].ID}]
	wait 5
	if ${NameID} == 0 && !${RunSpecificFunction}
	{
		wait 5 
		if ${Actor[NamedNPC,${Name}](exists)}
			NameID:Set[${Actor[NamedNPC,${Name}].ID}]
		else
			NameID:Set[${Actor[${Name}].ID}]
		wait 5
	}
	if ${NameID} == 0 && !${RunSpecificFunction}
	{
		wait 5
		if ${Actor[NamedNPC,${Name}](exists)}
			NameID:Set[${Actor[NamedNPC,${Name}].ID}]
		else
			NameID:Set[${Actor[${Name}].ID}]
		wait 5
	}
	if ${NameID} == 0 && !${RunSpecificFunction}
	{
		wait 5
		if ${Actor[NamedNPC,${Name}](exists)}
			NameID:Set[${Actor[NamedNPC,${Name}].ID}]
		else
			NameID:Set[${Actor[${Name}].ID}]
		wait 5
	}
	variable int TargetID
	wait 5 ${RunSpecificFunction}
	if ${NameID} == 0 && !${RunSpecificFunction}
	{
		wait 5
		if ${Actor[${Name}].Type.Equal[NoKill NPC]}
		{
			if ${RI_Var_Bool_Debug}
				echo ${Time}: Named: ${Name} is NoKill NPC, Moving on
			return
		}
		NameID:Set[${Actor[${Name}].ID}]
		wait 5
		if ${NameID} == 0 && !${Actor[${Name}](exists)} 
		{
			if ${RI_Var_Bool_Debug}
				echo ${Time}: Named: ${Name} Does Not Exist
			return
		}
		else
		{
			while ${NameID} == 0
			{
				NameID:Set[${Actor[${Name}].ID}]
				wait 5
			}
		}
	}
	if ${Actor[id,${NameID}](exists)} && !${Actor[id,${NameID}].IsDead} && !${RunSpecificFunction}
	{
		if ${RI_Var_Bool_Debug}
			echo ${Time}: We are at ${Name}, waiting for ${Name} to die!
		if ${Script[Buffer:CoT]}
			endscript Buffer:CoT
		;Script[Buffer:AggroControl].Variable[TrashTargeting]:Set[FALSE]
		call RIMObj.stopfollow
		RI_Var_Bool_Follow:Set[FALSE]
		if !${RunSpecificFunction} && ${NMoveBehind}
		{
			;target named
			if !${RI_Var_Bool_GlobalOthers}
				Actor[id,${NameID}]:DoTarget
				
			;lockspot to ${LockMXN} ${LockMYN} ${LockMZN}
			RIMUIObj:SetLockSpot[ALL,${LockMXN},${LockMYN},${LockMZN},${Precision},${LockSpotMax}]
			;RI_Atom_SetLockSpot ${Me.Name} ${LockMXN} ${LockMYN} ${LockMZN} ${Precision} ${LockSpotMax}
			
			;wait until we are at lockspot
			wait 50 ${Math.Distance[${Me.Loc},${LockMXN},${LockMYN},${LockMZN}}]}<${Precision}
			
			;wait until named is within 10m
			wait 50 ${Math.Distance[${Me.Loc},${Actor[id,${NameID}].Loc}]}<11
			
			;move others behind named
			;relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_MoveBehind ALL ${NameID} 15 99 ${Me.Name}
			relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call MoveBehind 1"]
			wait 5
			relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
		}
		if ${LockOthersDiff} && !${RunSpecificFunction} && !${NMoveBehind}
		{
			;echo relay "other ${RI_Var_String_RelayGroup}" -noredirect RIMUIObj:SetLockSpot[ALL,${LockOXN},${LockOYN},${LockOZN},${Precision},${LockSpotMax}]
			relay "other ${RI_Var_String_RelayGroup}" -noredirect RIMUIObj:SetLockSpot[ALL,${LockOXN},${LockOYN},${LockOZN},${Precision},${LockSpotMax}]
			;relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_SetLockSpot ALL ${LockOXN} ${LockOYN} ${LockOZN} ${Precision} ${LockSpotMax}
			RIMUIObj:SetLockSpot[ALL,${LockMXN},${LockMYN},${LockMZN},${Precision},${LockSpotMax}]
			;RI_Atom_SetLockSpot ${Me.Name} ${LockMXN} ${LockMYN} ${LockMZN} ${Precision} ${LockSpotMax}
		}
		elseif !${RunSpecificFunction} && !${NMoveBehind}
			relay ${RI_Var_String_RelayGroup} -noredirect RIMUIObj:SetLockSpot[ALL,${LockMXN},${LockMYN},${LockMZN},${Precision},${LockSpotMax}]
			;relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ALL ${LockMXN} ${LockMYN} ${LockMZN} ${Precision} ${LockSpotMax}
		while ${Actor[id,${NameID}](exists)} && !${Actor[id,${NameID}].IsDead} && ${RI_Var_Bool_Start} 
		{
			;check if we are paused
			call RIMObj.CheckPause
			;echo Named ${Name} exists we are killing
			if !${RunSpecificFunction}
			{
				;if ${NKillAdd} && ${Actor[${NAddName},radius,35](exists)} && ${Actor[${NAddName},radius,35].IsAggro} && !${Actor[${NAddName},radius,35].IsDead} && !${RI_Var_Bool_GlobalOthers}
				if ${NKillAdd} && ${Actor[Query, Name =- "${NAddName}" && Distance <= 35 && IsDead = FALSE && IsAggro = TRUE](exists)} && !${RI_Var_Bool_GlobalOthers}
				{
					
					;balance mobs, if set or just target
					if ${RI_Var_Bool_BalanceTrash} && !${NMoveBehind}
						RIObj:BalanceMobs["${NAddName}"]
					else
						Actor[Query, Name =- "${NAddName}"]:DoTarget
				}
				elseif ${NKillAdd} && ${Actor[Query, Name =- "${NAddName}" && Distance <= 35 && IsDead = TRUE](exists)} && !${RI_Var_Bool_GlobalOthers}
					Actor[Query, Name =- "${NAddName}"]:DoubleClick
				elseif !${RI_Var_Bool_GlobalOthers}
					Actor[id,${NameID}]:DoTarget
				if ${TargetID}!=${Target.ID} && ${Target.ID}!=0
				{
					TargetID:Set[${Target.ID}]
					relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Var_Int_MoveBehindMobID:Set[${Target.ID}]
				}
				;if (${Target.Type.Equal[NPC]} || ${Target.Type.Equal[NamedNPC]})
				;	Face ${Target.X} ${Target.Z}
				;elseif ${Target.Type.Equal[PC]} && (${Target.Target.Type.Equal[NPC]} || ${Target.Target.Type.Equal[NamedNPC]})
				;	Face ${Target.Target.X} ${Target.Target.Z}
				;if ${Math.Distance[${Me.X},${Me.Y},${Me.Z},${LockMXN},${LockMYN},${LockMZN}]}>2
				;	call RIMObj.Move ${LockMXN} ${LockMYN} ${LockMZN} ${Precision} 0 FALSE FALSE TRUE FALSE TRUE
			}
			call ExecuteQueued
			wait 1
		}
		wait 10
		if !${RunSpecificFunction} && ${NMoveBehind}
		{
			;relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_MoveBehind ALL OFF
			relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call MoveBehind 0"]
			RIMUIObj:SetLockSpot[OFF]
			;RI_Atom_SetLockSpot OFF
		}
		else
			relay ${RI_Var_String_RelayGroup} -noredirect RIMUIObj:SetLockSpot[OFF]
			;relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot OFF
		; if ${ISXOgre(exists)}
			; relay "other ${RI_Var_String_RelayGroup}" -noredirect OgreBotAtom a_LetsGo all
		RI_Var_Bool_Follow:Set[TRUE]
		call RIMObj.follow
		if !${RI_Var_Bool_SkipLoot}
			call RIMObj.LootChest
		if !${Script[Buffer:CoT]}
			RI_CoT
		;Script[Buffer:AggroControl].Variable[TrashTargeting]:Set[TRUE]
	}
	if ${RunSpecificFunction}
	{	
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call ${NameofSpecificFunction}"]
		call ${NameofSpecificFunction}
		relay ${RI_Var_String_RelayGroup} -noredirect RIMUIObj:SetLockSpot[OFF]
		RI_Var_Bool_Follow:Set[TRUE]
		call RIMObj.follow
		wait 20
		if !${RI_Var_Bool_SkipLoot}
			call RIMObj.LootChest
		if !${Script[Buffer:CoT]}
			RI_CoT
	}
}
function GrabShinys(int _OnOff)
{
	if ${Script[${RI_Var_String_RZScriptName}](exists)} && ${_OnOff} && !${UIElement[GrabShinysCheckBox@RZ].Checked}
		return
	;;;;; This code can be removed once amadeus fixes CheckCollision
	;if ${_OnOff}
	;	return
	relay ${RI_Var_String_RelayGroup} RI_Var_Bool_GrabShinys:Set[${_OnOff}]
}
function LootChest()
{
	wait 5
	eq2ex summon
	wait 5
	if !${RI_Var_Bool_SkipLoot}
		call RIMObj.LootChest
	wait 20
}
function MoveBehind(int _On, int _Dist=30, int _Health=99)
{
	if ${_On}>1
	{
		RI_Var_Bool_MoveCBImmunity:Set[1]
		RIMUIObj:SetLockSpot[OFF]
		RI_Atom_MoveBehind ${Me.Name} ${_On} ${_Dist} ${_Health}
	}
	elseif ${_On}==1
	{
		;declare RI_MoveBehind bool global ${RI_Obj_CB.GetUISetting[SettingsMoveBehindCheckBox]}
		;declare RI_SkipMoveHealthCheck bool global ${RI_Obj_CB.GetUISetting[SettingsSkipMobMoveHealthCheckBox]}
		;declare RI_MoveHealth int global ${RI_Obj_CB.GetUISetting[SettingsMoveHealthTextEntry]}
		RI_Var_Bool_MoveCBImmunity:Set[0]
		RIMUIObj:SetLockSpot[OFF]
		RI_Obj_CB:SetUISetting[SettingsMoveBehindCheckBox,1]
		RI_Obj_CB:SetUISetting[SettingsSkipMobMoveHealthCheckBox,0]
		RI_Obj_CB:SetUISetting[SettingsMoveHealthTextEntry,${_Health}]
		RI_Obj_CB:SetUISetting[SettingsMoveDistanceTextEntry,${_Dist}]
	}
	elseif ${_On}==0
	{
		RI_Var_Bool_MoveCBImmunity:Set[0]
		;if !${RI_MoveBehind}
			RI_Obj_CB:SetUISetting[SettingsMoveBehindCheckBox,0]
		;if ${RI_SkipMoveHealthCheck}
		;	RI_Obj_CB:SetUISetting[SettingsSkipMobMoveHealthCheckBox,1]
		;if ${RI_MoveHealth(exists)}
		;	RI_Obj_CB:SetUISetting[SettingsMoveHealthTextEntry,${RI_MoveHealth}]
	}
}
function MoveInFront(bool _On)
{
	if ${_On}
	{
		RI_Obj_CB:SetUISetting[SettingsMoveInFrontCheckBox,1]
		RI_Obj_CB:SetUISetting[SettingsSkipMobMoveHealthCheckBox,1]
	}
	else
	{
		RI_Obj_CB:SetUISetting[SettingsMoveInFrontCheckBox,0]
		RI_Obj_CB:SetUISetting[SettingsSkipMobMoveHealthCheckBox,0]
		RI_Atom_MoveBehind OFF
	}
}
;OLD WAY
; function LockSpot(float LX, float LY, float LZ, string LName)
; {
	;lock to LX LY LZ until LName is dead
	; while ${Actor[${LName},radius,150](exists)} && !${Actor[${LName},radius,150].IsDead} && !${LockSpotting}
	; {
		;check if we are paused
		; call RIMObj.CheckPause
		; call ExecuteQueued
		; if ${Math.Distance[${Me.X},${Me.Y},${Me.Z},${LX},${LY},${LZ}]}>2
			; call RIMObj.Move ${LX} ${LY} ${LZ} ${Precision} 0 FALSE FALSE TRUE FALSE TRUE
		; wait 1
	; }
	;lock to LX LY LZ until LockSpotting is set FALSE
	; while ${LockSpotting}
	; {
		;check if we are paused
		; call RIMObj.CheckPause
		; call ExecuteQueued
		; if ${Math.Distance[${Me.X},${Me.Y},${Me.Z},${LX},${LY},${LZ}]}>2
			; call RIMObj.Move ${LX} ${LY} ${LZ} ${Precision} 0 FALSE FALSE TRUE FALSE TRUE
		; wait 1
	; }
; }
function WaitMob(string WMName, int _distance=25)
{
	;set ID number of closest mob named WMName
	variable int WMID = ${Actor[${WMName},radius,${_distance}].ID}
	;wait for mob to die if exists is in range and is not dead
	relay "${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${Me.X},${Me.Y},${Me.Z}]
	;relay "${RI_Var_String_RelayGroup}" RI_Atom_SetLockSpot ALL ${Me.X} ${Me.Y} ${Me.Z}
	
	while ${Actor[id,${WMID}](exists)} && !${Actor[id,${WMID}].IsDead} && ${RI_Var_Bool_Start} && ${WMID}!=0
	{
		call ExecuteQueued
		wait 1
	}
	relay "${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[OFF]
	;relay "${RI_Var_String_RelayGroup}" RI_Atom_SetLockSpot OFF
}
function WaitForMobQuery(string _Query, int WMDistance=100, bool Aggro=FALSE, bool CheckExists=FALSE)
{
	;set ID number of closest mob named WMName
	;variable int WMID = ${Actor[Query, Name=-"${WMName}" && Distance<=${WMDistance}].ID}
	;wait for mob to exist
	relay "${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${Me.X},${Me.Y},${Me.Z}]
	;relay "${RI_Var_String_RelayGroup}" RI_Atom_SetLockSpot ALL ${Me.X} ${Me.Y} ${Me.Z}
	if ${Aggro}
	{
		if ${CheckExists} && !${Actor[Query,Name=-"${WMName}"](exists)}
			return
		while !${Actor[Query,${_Query}](exists)} && ${RI_Var_Bool_Start}
		{
			call ExecuteQueued
			if ${Me.InCombat}
				RIObj:BalanceMobs[ALL]
			wait 1
			if ${RI_Var_Bool_Debug}
				echo ISXRI: ${Time} Waiting for Mob ${_Query} to exist
		}
	}
	else
	{
		if ${CheckExists} && !${Actor[Query,${_Query}](exists)}
			return
		while !${Actor[Query,${_Query}](exists)} && ${RI_Var_Bool_Start}
		{
			call ExecuteQueued
			if ${Me.InCombat}
				RIObj:BalanceMobs[ALL]
			wait 1
			if ${RI_Var_Bool_Debug}
				echo ISXRI: ${Time} Waiting for Mob ${_Query} to exist or be in range
			if ${CheckExists} && !${Actor[Query,${_Query}](exists)}
				return
		}
	}
	relay "${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[OFF]
	;relay "${RI_Var_String_RelayGroup}" RI_Atom_SetLockSpot OFF
}
function POISTWaitForMobDeactivated(string _Mob, int _Distance=100, int ZLess=0)
{
	if ${ZLess}<0
	{
		while !${Actor[Query, Name=="${_Mob}" && Distance<=${_Distance} && Guild=="STATUS: DEACTIVATED" && Z<=${ZLess}](exists)} && ${RI_Var_Bool_Start}
		{
			call ExecuteQueued
			if ${Me.InCombat}
				RIObj:BalanceMobs[ALL]
			wait 1
			if ${RI_Var_Bool_Debug}
				echo ISXRI: ${Time} Waiting for Mob ${_Mob} to exist or be in range
		}
	}
	else
	{
		while !${Actor[Query, Name=="${_Mob}" && Distance<=${_Distance} && Guild=="STATUS: DEACTIVATED"](exists)} && ${RI_Var_Bool_Start}
		{
			call ExecuteQueued
			if ${Me.InCombat}
				RIObj:BalanceMobs[ALL]
			wait 1
			if ${RI_Var_Bool_Debug}
				echo ISXRI: ${Time} Waiting for Mob ${_Mob} to exist or be in range
		}
	}
}
function WaitForMob(string WMName, int WMDistance=100, bool Aggro=FALSE, bool CheckExists=FALSE, int _BreakTime=999999999999999999999999999999)
{
	echo ISXRI: Waiting for ${WMName} to exist
	;set ID number of closest mob named WMName
	;variable int WMID = ${Actor[Query, Name=-"${WMName}" && Distance<=${WMDistance}].ID}
	;wait for mob to exist
	variable int _breaker=0
	relay "${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${Me.X},${Me.Y},${Me.Z}]
	;relay "${RI_Var_String_RelayGroup}" RI_Atom_SetLockSpot ALL ${Me.X} ${Me.Y} ${Me.Z}
	if ${Aggro}
	{
		if ${CheckExists} && !${Actor[Query,Name=-"${WMName}"](exists)}
			return
		while !${Actor[Query,Name=-"${WMName}" && Distance<=${WMDistance} && IsDead=FALSE && IsAggro=TRUE](exists)} && ${RI_Var_Bool_Start} && ${_breaker:Inc}<${_BreakTime}
		{
			call ExecuteQueued
			if ${Me.InCombat}
				RIObj:BalanceMobs[ALL]
			wait 1
			if ${RI_Var_Bool_Debug}
				echo ISXRI: ${Time} Waiting for Mob ${WMName} to exist
		}
	}
	else
	{
		if ${CheckExists} && !${Actor[Query,Name=-"${WMName}"](exists)}
			return
		while !${Actor[Query,Name=-"${WMName}" && Distance<=${WMDistance} && IsDead=FALSE](exists)} && ${RI_Var_Bool_Start} && ${_breaker:Inc}<${_BreakTime}
		{
			call ExecuteQueued
			if ${Me.InCombat}
				RIObj:BalanceMobs[ALL]
			wait 1
			if ${RI_Var_Bool_Debug}
				echo ISXRI: ${Time} Waiting for Mob ${WMName} to exist or be in range
			if ${CheckExists} && !${Actor[Query,Name=-"${WMName}"](exists)}
				return
		}
	}
	relay "${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[OFF]
	wait 5
	;relay "${RI_Var_String_RelayGroup}" RI_Atom_SetLockSpot OFF
}
function CatalogCreature(string _Name)
{
	;get ID
	variable int _ID
	if ${Actor[Query, Name=-"${_Name}" && Distance<=15](exists)}
		_ID:Set[${Actor[Query, Name=-"${_Name}" && Distance<=15].ID}]
	else
		return
	;Add trigger text
	;IncomingText:Insert[Currently targeting]
	;IncomingText2:Insert["${_Name}"]
	
	if ${RI_Var_Bool_Debug}
		echo ISXRI: ${Time}: CatalogCreature: ${_Name}
	
	;turn off assisting
	RI_CMD_Assisting 0
	
	;pause bots
	RI_CMD_PauseCombatBots 1
	
	;target
	Actor[Query, ID=${_ID}]:DoTarget
	
	;cancel spellcast and clear ability queue
	eq2ex cancel_spellcast
	eq2ex clearabilityqueue 
	
	;wait until we are not casting
	wait 200 !${Me.CastingSpell}
	
	;keep attempting to cast absorb magic (ID=1812025739) until it is no longer ready (aka casted)
	do
	{
		if ${Target.ID}==${_ID}
			Me.Ability[id,738679878]:Use
		else
			Actor[Query, ID=${_ID}]:DoTarget
		
		if ${Actor[Query, ID=${_ID}].Distance}>15
			call RIMObj.Move ${String["${Actor[Query, ID=${_ID}].Loc}"].Replace[","," "]} 14 0 0 0 1 0 1 1

		wait 5
	}
	while ${Actor[Query, ID=${_ID}].Target.ID}!=${Me.ID} && ${Actor[Query, ID=${_ID}](exists)} && !${Actor[Query, ID=${_ID}].IsDead}
	;Trigger:Set[0]

	;wait until we are not casting
	wait 200 !${Me.CastingSpell}
	
	;turn on assisting
	RI_CMD_Assisting 1
	
	;unpause bots
	RI_CMD_PauseCombatBots 0

	;Clear trigger text
	;IncomingText:Remove[${IncomingText.Used}]
	;IncomingText2:Remove[${IncomingText.Used}]
}
function CatalogCreatureID(int _ID)
{
	;Add trigger text
	;IncomingText:Insert[Currently targeting]
	;IncomingText2:Insert["${Actor[id,${_ID}].Name}"]

	if ${RI_Var_Bool_Debug}
		echo ISXRI: ${Time}: CatalogCreature: ${Actor[id,${_ID}].Name}
	
	;turn off assisting
	RI_CMD_Assisting 0
	
	;pause bots
	RI_CMD_PauseCombatBots 1
	
	;target
	Actor[Query, ID=${_ID}]:DoTarget
	
	;cancel spellcast and clear ability queue
	eq2ex cancel_spellcast
	eq2ex clearabilityqueue 
	
	;wait until we are not casting
	wait 200 !${Me.CastingSpell}
	
	;keep attempting to cast absorb magic (ID=1812025739) until it is no longer ready (aka casted)
	do
	{
		if ${Target.ID}==${_ID}
			Me.Ability[id,738679878]:Use
		else
			Actor[Query, ID=${_ID}]:DoTarget

		if ${Actor[Query, ID=${_ID}].Distance}>15
			call RIMObj.Move ${String["${Actor[Query, ID=${_ID}].Loc}"].Replace[","," "]} 14 0 0 0 1 0 1 1

		wait 5
	}
	while ${Actor[Query, ID=${_ID}].Target.ID}!=${Me.ID} && ${Actor[Query, ID=${_ID}](exists)} && !${Actor[Query, ID=${_ID}].IsDead}
	;Trigger:Set[0]

	;wait until we are not casting
	wait 200 !${Me.CastingSpell}
	
	;turn on assisting
	RI_CMD_Assisting 1
	
	;unpause bots
	RI_CMD_PauseCombatBots 0

	;Clear trigger text
	;IncomingText:Remove[${IncomingText.Used}]
	;IncomingText2:Remove[${IncomingText.Used}]
}
function WaitForMobAway(string WMName, int WMDistance=100)
{
	call WaitForMobExists "${WMName}" ${WMDistance}
}
function WaitForMobExists(string WMName, int WMDistance=100)
{
	;set ID number of closest mob named WMName
	;wait for mob to exist
	relay "${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${Me.X},${Me.Y},${Me.Z}]

	while ${Actor[Query,Name=-"${WMName}" && Distance<=${WMDistance} && IsDead=FALSE](exists)} && ${RI_Var_Bool_Start}
	{
		call ExecuteQueued
		if ${Me.InCombat}
			RIObj:BalanceMobs[ALL]
		wait 1
		if ${RI_Var_Bool_Debug}
			echo ISXRI: ${Time} Waiting for Mob ${WMName} to NOT exist
	}
	relay "${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[OFF]
}
function PreHeal(int _FighterStoneSkin=0)
{
	if ( ${Me.Group}==1 || ( ${Me.Group}==2 && ${Me.Group[1].Type.NotEqual[PC]} ) ) && ( ${Me.Archetype.NotEqual[priest]} || ${Me.Archetype.NotEqual[fighter]} )
		return
	if ${Me.Archetype.Equal[fighter]} && ${_FighterStoneSkin}>0
	{
		call FighterStoneskin
	}
	wait 20
	if ${Me.Class.Equal[druid]}
		wait 30
	relay ${RI_Var_String_RelayGroup} -noredirect RIMUIObj:PreHeal[ALL,${Me.Name}]
	if ${Me.Class.Equal[druid]}
		wait 40
	else
		wait 70
}
function FighterStoneskin()
{
	switch ${Me.SubClass}
	{
		case guardian
		{
			;echo Guard
			if ${Me.Ability[id,2822291254].IsReady}
			{
				;echo LMS
				do
				{
					RI_Obj_CB:Cast[Last Man Standing,1]
					wait 1
				}
				while ${Me.Ability[id,2822291254].TimeUntilReady}<1
			}
			elseif ${Me.Ability[id,2660262412].IsReady}
			{
				;echo PC
				do
				{
					RI_Obj_CB:Cast[Perfect Counter,1]
					wait 1
				}
				while ${Me.Ability[id,2660262412].TimeUntilReady}<1
			}
			elseif ${Me.Ability[id,1110318339].IsReady}
			{
				;echo TOS
				do
				{
					RI_Obj_CB:Cast[Tower of Stone,1]
					wait 1
				}
				while ${Me.Ability[id,1110318339].TimeUntilReady}<1
			}
			break
		}
	}
}
;script to change loot options
function LootOptions(string Options)
{
	;open group options window
	relay ${RI_Var_String_RelayGroup} eq2ex groupoptions
	wait 5
	
	;switch which options was requested
	switch ${Options.Upper}
	{
		case LEADERONLY
		{
			relay ${RI_Var_String_RelayGroup} EQ2UIPage[popup,groupoptions].Child[DropDownBox,GroupOptions.LootPage.LootMethodCombo]:Set[0]
			break
		}
		case FREEFORALL
		{
			relay ${RI_Var_String_RelayGroup} EQ2UIPage[popup,groupoptions].Child[DropDownBox,GroupOptions.LootPage.LootMethodCombo]:Set[1]
			break
		}
		case LOTTO
		{
			relay ${RI_Var_String_RelayGroup} EQ2UIPage[popup,groupoptions].Child[DropDownBox,GroupOptions.LootPage.LootMethodCombo]:Set[2]
			break
		}
		case NEEDBEFOREGREED
		{
			relay ${RI_Var_String_RelayGroup} EQ2UIPage[popup,groupoptions].Child[DropDownBox,GroupOptions.LootPage.LootMethodCombo]:Set[3]
			break
		}
		case ROUNDROBIN
		{
			relay ${RI_Var_String_RelayGroup} EQ2UIPage[popup,groupoptions].Child[DropDownBox,GroupOptions.LootPage.LootMethodCombo]:Set[4]
			break
		}
	}
	wait 1
	;set to all items
	relay ${RI_Var_String_RelayGroup} EQ2UIPage[popup,groupoptions].Child[DropDownBox,GroupOptions.LootPage.ItemTierCombo]:Set[0]
	
	wait 5
	
	;press Apply
	relay ${RI_Var_String_RelayGroup} EQ2UIPage[popup,groupoptions].Child[Button,GroupOptions.ApplyButton]:LeftClick
	
	wait 5
}
;script to target a specific mob
function Target(string TName, bool StayTargeted, int Distance=1000, bool _NoKillNPC=TRUE, bool _UseName=FALSE, int _WaitTime=0)
{
	;echo Target(string TName=${TName}, bool StayTargeted=${StayTargeted}, int Distance=${Distance}, bool _NoKillNPC=${_NoKillNPC})
	;set TargetsID
	variable int TID
	if ${TName.Equal[Me]}
		TName:Set[${Me.Name}]
	;echo ${TName}
	;echo "${TName}"
	;echo if ${Actor[Query, Name=-"${TName}" && Distance<=${Distance} && IsDead=FALSE && Type!="NoKill NPC"](exists)}
	if ${Actor[Query, Name=-"${TName}" && Distance<=${Distance} && IsDead=FALSE](exists)}
	{
		;echo ${Actor[Query, Name=-"${TName}" && Distance<=${Distance} && IsDead=FALSE && Type!="NoKill NPC"].ID}
		if ${_NoKillNPC}
			TID:Set[${Actor[Query, Name=-"${TName}" && Distance<=${Distance} && IsDead=FALSE].ID}]
		else
			TID:Set[${Actor[Query, Name=-"${TName}" && Distance<=${Distance} && IsDead=FALSE && Type!="NoKill NPC"].ID}]
	}
	else
		return
	;echo ${TID}
	;target
	if ${_UseName}
	{
		if !${RI_Var_Bool_GlobalOthers}
			Actor[Query, Name=-"${TName}" && Distance<=${Distance} && IsDead=FALSE]:DoTarget
		while ${Actor[Query, Name=-"${TName}" && Distance<=${Distance} && IsDead=FALSE](exists)} && !${RI_Var_Bool_GlobalOthers} && ${StayTargeted}
		{
			;check if we are paused
			call RIMObj.CheckPause
			Actor[Query, Name=-"${TName}" && Distance<=${Distance} && IsDead=FALSE]:DoTarget
			wait 1
		}
	}
	else
	{
		if !${RI_Var_Bool_GlobalOthers}
			Actor[id,${TID}]:DoTarget
		while ${Actor[id,${TID}](exists)} && !${Actor[id,${TID}].IsDead} && !${RI_Var_Bool_GlobalOthers} && ${StayTargeted}
		{
			;check if we are paused
			call RIMObj.CheckPause
			Actor[id,${TID}]:DoTarget
			wait 1
		}
	}
	wait ${_WaitTime}
	;echo end target
}
function SpireDoor()
{
	call Door
}
function Door(int distance=10)
{
	wait 10
	if ${RI_Var_Bool_Debug}
		echo ISXRI: ${Time} Opening any doors within ${distance}

	relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 1	
	variable index:actor Actors
    variable iterator ActorIterator
    
	EQ2:QueryActors[Actors, Type !="NPC" && Type !="NamedNPC" && Type !="Pet" && Type !="PC" && Type !="Mercenary" && Type !="Me" && Name !="${Me.Name}" && Distance <= ${distance}]
    Actors:GetIterator[ActorIterator]
  
    if ${ActorIterator:First(exists)}
    {
        do
        {
            relay ${RI_Var_String_RelayGroup} Actor[${ActorIterator.Value}]:DoubleClick
			relay ${RI_Var_String_RelayGroup} Actor[id,${ActorIterator.Value.ID}]:DoubleClick
			waitframe
			relay ${RI_Var_String_RelayGroup} Actor[${ActorIterator.Value}]:DoubleClick
			relay ${RI_Var_String_RelayGroup} Actor[id,${ActorIterator.Value.ID}]:DoubleClick
			waitframe
			relay ${RI_Var_String_RelayGroup} Actor[${ActorIterator.Value}]:DoubleClick
			relay ${RI_Var_String_RelayGroup} Actor[id,${ActorIterator.Value.ID}]:DoubleClick
        }
        while ${ActorIterator:Next(exists)}
    }
	relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 0
}
function StopFollow()
{
	call RIMObj.stopfollow
}
function HailActorFast(string _Actor, int _NumberOfResponses=1, int _ResponseNumber=1, bool _Hail=TRUE)
{
	;move to HailActor location
	;stop follow
	call RIMObj.stopfollow
	;echo Moving to ${CustomLoc} and Clicking ${_Actor}
	relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call RIMObj.Move ${CustomLoc} ${Precision} 0 TRUE TRUE TRUE FALSE TRUE"]
	if ${CustomLoc.NotEqual[0 0 0]}
	{
		call RIMObj.Move ${CustomLoc} ${Precision} 0 TRUE TRUE TRUE FALSE TRUE
		;wait 20
	}
	if ${Me.FlyingUsingMount}
		call FlyDown
	;make sure _Actor exists so we do not go through the motions for nothing
	if ${Actor["${_Actor}",radius,20](exists)}
	{
		;wait until we are out of combat
		if ${StopForCombat}
			call RIMObj.CheckCombat
		;wait 10
		;pause bots
		
		relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
		wait 2
		if ${_Hail}
		{
			relay ${RI_Var_String_RelayGroup} -noredirect Actor["${_Actor}"]:DoFace
			;wait 5
			relay ${RI_Var_String_RelayGroup} -noredirect Actor["${_Actor}"]:DoTarget
			wait 2
			relay ${RI_Var_String_RelayGroup} -noredirect eq2execute hail
			wait 2
			relay ${RI_Var_String_RelayGroup} -noredirect eq2execute hail
			if ${_NumberOfResponses}>0
				wait 5
		}
		variable int count
		variable string _tempbtntxt
		for(count:Set[1];${count}<=${_NumberOfResponses};count:Inc)
		{
			_tempbtntxt:Set["${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${_ResponseNumber}].GetProperty[LocalText]}"]
			if ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1](exists)}
				relay ${RI_Var_String_RelayGroup} -noredirect EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${_ResponseNumber}]:LeftClick
			wait 5
			wait 50 ( ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${_ResponseNumber}].GetProperty[LocalText].NotEqual["${_tempbtntxt}"]} || !${EQ2UIPage[ProxyActor,Conversation].IsVisible} )
		}
		;unpause bots
		relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 0
	}
	if ${StopForCombat}
		call RIMObj.CheckCombat
	;follow
	call RIMObj.follow
}
function HailActorMultiOption(string _Actor, ... args)
{
	if ${Me.FlyingUsingMount}
		call FlyDown
	variable int _count
	variable string _tempbtntxt
	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		_tempbtntxt:Set["${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${_count}]}].GetProperty[LocalText]}"]
		;echo ${args[${_count}]}
		if ${_count}==1
			call HailActor "${_Actor}" 1 ${args[${_count}]} 1
		else
			call HailActor "${_Actor}" 1 ${args[${_count}]} 0
		wait 5
		wait 50 ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${_count}]}].GetProperty[LocalText].NotEqual["${_tempbtntxt}"]} 
		;|| !${EQ2UIPage[ProxyActor,Conversation].IsVisible}
	}
}
function ConversationDialog( ... args)
{
	if ${Me.FlyingUsingMount}
		call FlyDown
	variable int _count
	variable string _tempbtntxt
	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		_tempbtntxt:Set["${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${_count}]}].GetProperty[LocalText]}"]
		;echo ${args[${_count}]}
		if ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1](exists)}
				relay ${RI_Var_String_RelayGroup} -noredirect EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${_count}]}]:LeftClick
		wait 5
		wait 50 ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${_count}]}].GetProperty[LocalText].NotEqual["${_tempbtntxt}"]} 
		;|| !${EQ2UIPage[ProxyActor,Conversation].IsVisible}
	}
}
function ChoiceWindow(int _Choice)
{
	wait 5
	if ${ChoiceWindow(exists)}
		relay ${RI_Var_String_RelayGroup} ChoiceWindow:DoChoice${_Choice}
	wait 5
}
function FastTravel(string _ZoneName, int _RelayToGroup=1, string _DoorOption=0)
{	
	;echo FastTravel(string _ZoneName=${_ZoneName}, int _RelayToGroup=${_RelayToGroup}, string _DoorOption=${_DoorOption})
	eq2execute hidden_effects delete 4221996095
	wait 5
	if ${RIMUIObj.MainIconIDExists[${Me.ID},955,0]}==0
	{
		call MessageBox "You must be gold to use the FastTravel feature required for this quest Pausing RQ please resume in ${_ZoneName} at the location FastTravel would normally take you"
	}
	else
	{
		if ${_RelayToGroup}>0
			relay ${RI_Var_String_RelayGroup} RIMUIObj:FastTravel[ALL,"${_ZoneName}","${_DoorOption}"]
		else
			RIMUIObj:FastTravel[${Me.Name},"${_ZoneName}","${_DoorOption}"]
		wait 50 ${EQ2.Zoning}==1
		if ${EQ2.Zoning}==0
		{
			if ${EQ2UIPage[popup,ZoneTeleporter].IsVisible}
				call DoorOption 0;wait 10
			if ${ChoiceWindow(exists)}
				ChoiceWindow:DoChoice1
		}
		wait 600 ${EQ2.Zoning}==1
		wait 600 ${EQ2.Zoning}==0
	}
}
function AcceptReward(string _Reward)
{
	if !${RI_Var_Bool_GlobalOthers}
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call AcceptReward \"${_Reward}\""]
	variable int _failcnt=0
	while ${RewardWindow.NumRewards}>1 && ${_failcnt:Inc}<25
	{
		RewardWindow:AcceptReward[${_Reward}]
		wait 2
	}
}
function AcceptRewards(int _OnOff)
{
	relay ${RI_Var_String_RelayGroup} RI_Var_Bool_AcceptRewards:Set[${_OnOff}]
}
function HailActor(... args)
{

	;move to HailActor location
	;stop follow
	;string _Actor, bool _LoopUntilNoHighlightOnMouseHover=0, bool _LoopUntilDNE=0, int _GiveUpCNT=50
	;echo ClickActor(string _Actor=${_Actor}, int _LoopUntilNoHighlightOnMouseHover=0=${_LoopUntilNoHighlightOnMouseHover}, int _GiveUpCNT=50=${_GiveUpCNT})
	;move to ClickActor location
	;stop follow
	
	variable string _Actor
	variable int _NumberOfResponses=1
	variable int _ResponseNumber=1
	variable int _CameraTime=15
	variable bool _Hail=TRUE
	variable int _acnt=0
	variable bool _Follow=TRUE
	variable bool _ExactName=FALSE
	variable bool _RelayToGroup=TRUE
	variable string _Relay

	for(_acnt:Set[1];${_acnt}<=${args.Used};_acnt:Inc)
	{
		;backwards compatibility
		if ${_acnt}==1 && ${args[1].Left[1].NotEqual[-]}
		{
			_Actor:Set["${args[1]}"]
			continue
		}
		if ${args[2].Left[1].NotEqual[-]} && ${_acnt}==2
		{
			_NumberOfResponses:Set[${Int[${args[2]}]}]
			continue
		}
		if ${args[3].Left[1].NotEqual[-]} && ${_acnt}==3
		{
			_ResponseNumber:Set[${Int[${args[3]}]}]
			continue
		}
		if ${args[4].Left[1].NotEqual[-]} && ${_acnt}==4
		{
			_Hail:Set[${args[4]}]
			continue
		}
		if ${args[5].Left[1].NotEqual[-]} && ${_acnt}==5
		{
			_Follow:Set[${args[5]}]
			continue
		}
		if ${args[6].Left[1].NotEqual[-]} && ${_acnt}==6
		{
			_ExactName:Set[${args[6]}]
			continue
		}
		if ${args[7].Left[1].NotEqual[-]} && ${_acnt}==7
		{
			_CameraTime:Set[${args[7]}]
			continue
		}
		;echo args ${_acnt} : ${args[${_acnt}]}
		switch ${args[${_acnt}]}
		{
			case -Actor
			{
				_Actor:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -NumberofResponses
			{
				_NumberOfResponses:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -ResponseNumber
			{
				_ResponseNumber:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -NoHail
			{
				_Hail:Set[FALSE]
				break
			}
			case -NoFollow
			{
				_Follow:Set[FALSE]
				break
			}
			case -ExactName
			{
				_ExactName:Set[TRUE]
				break
			}
			case -CameraTime
			{
				_CameraTime:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -NoRelayToGroup
			{
				_RelayToGroup:Set[FALSE]
				break
			}
		}
	}
	if ${_RelayToGroup}
		_Relay:Set["${RI_Var_String_RelayGroup}"]
	else
		_Relay:Set["${Session}"]

	if ${_Actor.Left[6].Upper.Equal[GUILD-]}
		_Actor:Set["guild,${_Actor.Right[-6]}"]
	if ${_Actor.Left[6].Upper.Equal[QUERY-]}
		_Actor:Set["Query,${_Actor.Right[-6].Replace["`","\""]}"]
	;echo Moving to ${CustomLoc} and Hailing ${_Actor}
	if ${CustomLoc.NotEqual[0 0 0]}
	;&& ${Math.Distance[${Me.Loc},${CustomLoc.Replace[" ",","]}]}>5
	{
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call RIMObj.Move ${CustomLoc} ${Precision} 0 TRUE TRUE TRUE FALSE TRUE"]
		call RIMObj.Move ${CustomLoc} ${Precision} 0 TRUE TRUE TRUE FALSE TRUE
	}
	;echo HailActor(string _Actor=${_Actor}, int _NumberOfResponses=1=${_NumberOfResponses}, int _ResponseNumber=1=${_ResponseNumber}, bool _Hail=TRUE=${_Hail})
	;echo after move
	if ${_Hail}
	{
		wait 20
	}
	if ${_Follow}
		call RIMObj.stopfollow
	if ${Me.FlyingUsingMount}
		call FlyDown
	;make sure _Actor exists so we do not go through the motions for nothign
	;echo \${Actor[${_Actor}](exists)}  //  ${Actor[${_Actor}](exists)}
	if ${Actor[${_Actor}](exists)}
	{
		variable int _ID
		if ${_ExactName}
			_ID:Set[${Actor[Query, Name=="${_Actor}"].ID}]
		else
			_ID:Set[${Actor[${_Actor}].ID}]
		;echo ${_ID}
		;wait until we are out of combat
		if ${StopForCombat}
			call RIMObj.CheckCombat
		
		if ${_Hail}
		{
			wait 10
			;pause bots
			
			relay ${_Relay} -noredirect RI_CMD_PauseCombatBots 1
			;wait 5
			;change camera
			relay ${_Relay} -noredirect Press -hold ${RI_Var_String_LookDownKey}
			wait ${_CameraTime}
			;change camera
			relay ${_Relay} -noredirect Press -release ${RI_Var_String_LookDownKey}
			relay ${_Relay} -noredirect Press -hold ${RI_Var_String_LookUpKey}
			wait 3
			relay ${_Relay} -noredirect Press -release ${RI_Var_String_LookUpKey}
			
			relay ${_Relay} -noredirect Actor[${_ID}]:DoFace
			relay ${_Relay} -noredirect Actor[${_ID}]:DoFace
			wait 5
			;scroll the mouse wheel
			relay ${_Relay} -noredirect MouseWheel -10000
			relay ${_Relay} -noredirect Actor[${_ID}]:DoTarget
			wait 2
			relay ${_Relay} -noredirect Actor[${_ID}]:DoTarget
			wait 2
			relay ${_Relay} -noredirect Actor[${_ID}]:DoTarget
			wait 5
			relay ${_Relay} -noredirect eq2execute hail
			wait 2
			relay ${_Relay} -noredirect eq2execute hail
			wait 2
		}
		variable int count
		variable string _tempbtntxt
		variable int NoReplyExistsCount=-1
		;echo before for
		for(count:Set[1];${count}<=${_NumberOfResponses};count:Inc)
		{
			;echo for count: ${count}
			if !${EQ2UIPage[ProxyActor,Conversation].IsVisible}
				NoReplyExistsCount:Inc
			else
				NoReplyExistsCount:Set[0]
			
			if ${NoReplyExistsCount}>2
			{
				waitframe
				continue	
			}
			
			_tempbtntxt:Set["${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${_ResponseNumber}].GetProperty[LocalText]}"]
			if ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1](exists)}
				relay ${_Relay} -noredirect EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${_ResponseNumber}]:LeftClick
			wait 5
			wait 50 ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${_ResponseNumber}].GetProperty[LocalText].NotEqual["${_tempbtntxt}"]}
			;|| !${EQ2UIPage[ProxyActor,Conversation].IsVisible}
		}
		;unpause bots
		relay ${_Relay} -noredirect RI_CMD_PauseCombatBots 0
	}
	;echo after for
	if ${StopForCombat}
		call RIMObj.CheckCombat
	;follow
	if ${_Follow}
	{
		;echo follow
		call RIMObj.follow
	}
	;echo end of function
}
function StayAfloat(int _OnOff)
{
	relay ${RI_Var_String_RelayGroup} RI_Var_Bool_StayAfloat:Set[${Int[${_OnOff}]}]
}
function HailActorGetQuest(... args)
{
	 ;string _QuestName, int _NumberOfResponses=1, int _ResponseNumber=1, bool _Hail=TRUE, bool _Follow=TRUE, bool _ExactName=FALSE
	;echo HailActor(string _Actor=${_Actor}, int _NumberOfResponses=1=${_NumberOfResponses}, int _ResponseNumber=1=${_ResponseNumber}, bool _Hail=TRUE=${_Hail})
	;move to HailActor location
	;stop follow
	variable string _Actor
	variable int _NumberOfResponses=1
	variable int _ResponseNumber=1
	variable bool _Hail=TRUE
	variable bool _Cam=TRUE
	variable bool _CheckQuestExists=TRUE
	variable string _QuestName="${MainQuestName.Get[${MainQuestName.Used}]}"
	variable int _acnt=0
	for(_acnt:Set[1];${_acnt}<=${args.Used};_acnt:Inc)
	{
		;echo args ${_acnt} : ${args[${_acnt}]}
		switch ${args[${_acnt}]}
		{
			case -Actor
			{
				if ${args[${Math.Calc[${_acnt}+1]}].Left[6].Upper.Equal[GUILD-]}
					_Actor:Set["guild,${args[${Math.Calc[${_acnt}+1]}].Right[-6]}"]
				else
					_Actor:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -NumberOfResponses
			{
				_NumberOfResponses:Set[${args[${Math.Calc[${_acnt}+1]}]}]
				break
			}
			case -ResponseNumber
			{
				_ResponseNumber:Set[${args[${Math.Calc[${_acnt}+1]}]}]
				break
			}
			case -NoHail
			{
				_Hail:Set[0]
				break
			}
			case -Quest
			case -QuestName
			{
				_QuestName:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -NoCheckQuestExists
			{
				_CheckQuestExists:Set[0]
				break
			}
			case -NoCam
			{
				_Cam:Set[0]
				break
			}
		}
	}
	;echo "${_QuestName}" // ${QuestJournalWindow.ActiveQuest[${_QuestName}](exists)} // ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)}
	;echo Moving to ${CustomLoc} and Clicking ${_Actor}
	if ${CustomLoc.NotEqual[0 0 0]} && ${Math.Distance[${Me.Loc},${CustomLoc.Replace[" ",","]}]}>5
	{
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call RIMObj.Move ${CustomLoc} ${Precision} 0 TRUE TRUE TRUE FALSE TRUE"]
		call RIMObj.Move ${CustomLoc} ${Precision} 0 TRUE TRUE TRUE FALSE TRUE
	}
	if ${_Hail} && ${_Cam}
	{
		wait 20
	}
	;if ${_Follow}
		call RIMObj.stopfollow
	if ${Me.FlyingUsingMount}
		call FlyDown
	if ${_CheckQuestExists} && ( ${QuestJournalWindow.ActiveQuest[${_QuestName}](exists)} || ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} )
		return
	;make sure _Actor exists so we do not go through the motions for nothign
	;echo \${Actor[${_Actor}](exists)}  //  ${Actor[${_Actor}](exists)}
	if ${Actor[${_Actor}](exists)}
	{
		variable int _ID
		if ${_ExactName}
			_ID:Set[${Actor[Query, Name=="${_Actor}"].ID}]
		else
			_ID:Set[${Actor[${_Actor}].ID}]
		;wait until we are out of combat
		if ${StopForCombat}
			call RIMObj.CheckCombat
		
		if ${_Hail} && ${_Cam}
		{
			wait 10
			;pause bots
			
			relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
			;wait 5
			;change camera
			relay ${RI_Var_String_RelayGroup} -noredirect Press -hold ${RI_Var_String_LookDownKey}
			wait 15
			;change camera
			relay ${RI_Var_String_RelayGroup} -noredirect Press -release ${RI_Var_String_LookDownKey}
			relay ${RI_Var_String_RelayGroup} -noredirect Press -hold ${RI_Var_String_LookUpKey}
			wait 3
			relay ${RI_Var_String_RelayGroup} -noredirect Press -release ${RI_Var_String_LookUpKey}
			
			relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoFace
			relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoFace
			wait 5
			;scroll the mouse wheel
			relay ${RI_Var_String_RelayGroup} -noredirect MouseWheel -10000
			relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoTarget
			wait 2
			relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoTarget
			wait 2
			relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoTarget
			wait 5
			relay ${RI_Var_String_RelayGroup} -noredirect eq2execute hail
			wait 2
			relay ${RI_Var_String_RelayGroup} -noredirect eq2execute hail
			wait 2
		}
		elseif ${_Hail} && !${_Cam}
		{
			relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
			wait 2
			relay ${RI_Var_String_RelayGroup} -noredirect eq2execute hail
			wait 2
		}
		variable int count
		variable string _tempbtntxt
		;for(count:Set[1];${count}<=${_NumberOfResponses};count:Inc)
		variable int _wcount=${Math.Calc[${Time.SecondsSinceMidnight}+60]}
		while !${QuestJournalWindow.ActiveQuest[${_QuestName}](exists)} && !${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} && ${Time.SecondsSinceMidnight}<=${_wcount}
		{
			_tempbtntxt:Set["${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${_ResponseNumber}].GetProperty[LocalText]}"]
			if ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1](exists)}
				relay ${RI_Var_String_RelayGroup} -noredirect EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${_ResponseNumber}]:LeftClick
			wait 5
			wait 50 ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${_ResponseNumber}].GetProperty[LocalText].NotEqual["${_tempbtntxt}"]} || ${QuestJournalWindow.ActiveQuest[${_QuestName}](exists)} || ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)}
			;|| !${EQ2UIPage[ProxyActor,Conversation].IsVisible}
		}
		;unpause bots
		relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 0
	}
	elseif !${QuestJournalWindow.ActiveQuest[${_QuestName}](exists)} && !${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)}
	{
		call MessageBox "We were unable to find ${_Actor} to start the quest ${MainQuestName.Get[${MainQuestName.Used}]}"
		MainArrayCounter:Set[${Math.Calc[${MainArrayCounter}-3]}]
		return
	}
		
	if !${QuestJournalWindow.ActiveQuest[${_QuestName}](exists)} && !${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)}
	{
		call MessageBox "We were unable to start the quest ${MainQuestName.Get[${MainQuestName.Used}]}"
		MainArrayCounter:Set[${Math.Calc[${MainArrayCounter}-3]}]
	}	
		
	if ${StopForCombat}
		call RIMObj.CheckCombat
	;follow
	;if ${_Follow}
		call RIMObj.follow
}
function BalanceTrash(int _OnOff)
{
	RI_Var_Bool_BalanceTrash:Set[${Int[${_OnOff}]}]
}
function ClickActor(... args)
{
	;string _Actor, bool _LoopUntilNoHighlightOnMouseHover=0, bool _LoopUntilDNE=0, int _GiveUpCNT=50
	;echo ClickActor(string _Actor=${_Actor}, int _LoopUntilNoHighlightOnMouseHover=0=${_LoopUntilNoHighlightOnMouseHover}, int _GiveUpCNT=50=${_GiveUpCNT})
	;move to ClickActor location
	;stop follow
	
	variable string _Actor
	variable int _LoopUntilNoHighlightOnMouseHover=0
	variable int _LoopUntilNotInteractable=0
	variable int _LoopUntilDNE=0
	variable int _HighlightOnMouseHover=0
	variable int _GiveUpCNT=50
	variable string _LoopUntilQSE=~NONE~
	variable bool _TintFlags=FALSE
	variable int _acnt=0
	variable bool _ExactName=FALSE
	variable bool _LockSpot=FALSE
	variable bool _RelayToGroup=TRUE
	
	for(_acnt:Set[1];${_acnt}<=${args.Used};_acnt:Inc)
	{
		;backwards compatibility
		if ${_acnt}<5 && ${args[1].Left[1].NotEqual[-]}
		{
			_Actor:Set["${args[1]}"]
			if ${args[2].Left[1].NotEqual[-]}
			{
				_LoopUntilNoHighlightOnMouseHover:Set[${Int[${args[2]}]}]
				if ${args[3].Left[1].NotEqual[-]}
				{
					_LoopUntilDNE:Set[${Int[${args[3]}]}]
					if ${args[4].Left[1].NotEqual[-]}
					{
						_GiveUpCNT:Set[${Int[${args[4]}]}]
					}
				}
			}
		}
		
		;echo args ${_acnt} : ${args[${_acnt}]}
		switch ${args[${_acnt}]}
		{
			case -LockSpot
			{
				_LockSpot:Set[1]
			}
			case -ActorName
			case -Actor
			{
				_Actor:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -LoopUntilNoHighlightOnMouseHover
			{
				_LoopUntilNoHighlightOnMouseHover:Set[1]
				break
			}
			case -LoopUntilNotInteractable
			{
				_LoopUntilNotInteractable:Set[1]
				break
			}
			case -ExactName
			{
				_ExactName:Set[1]
				break
			}
			case -HighlightOnMouseHover
			{
				_HighlightOnMouseHover:Set[1]
				break
			}
			case -LoopUntilDNE
			{
				_LoopUntilDNE:Set[1]
				break
			}
			case -GiveUpCNT
			{
				_GiveUpCNT:Set[${args[${Math.Calc[${_acnt}+1]}]}]
				break
			}
			case -LoopUntilQSE
			{
				_LoopUntilQSE:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -TintFlags
			{
				_TintFlags:Set[1]
				break
			}
			case -NoRelayToGroup
			{
				_RelayToGroup:Set[0]
				break
			}
		}
	}
	
	variable int _Cnt=0
	variable int _ID
	if  ${_Actor.Left[5].Equal[ByLoc]} && ${_LoopUntilNoHighlightOnMouseHover}
		_ID:Set[${Actor[Query, X=${_Actor.Token[2,|]} && Y=${_Actor.Token[3,|]} && Z=${_Actor.Token[4,|]} && HighlightOnMouseHover=TRUE].ID}]
	elseif ${_Actor.Left[5].Equal[ByLoc]}
		_ID:Set[${Actor[Query, X=${_Actor.Token[2,|]} && Y=${_Actor.Token[3,|]} && Z=${_Actor.Token[4,|]}].ID}]
	elseif ${_Actor.Left[10].Equal[TintFlags-]} && ${_LoopUntilNoHighlightOnMouseHover}
		_ID:Set[${Actor[Query, TintFlags=${_Actor.Right[-10]} && HighlightOnMouseHover=TRUE].ID}]
	elseif ${_Actor.Left[10].Equal[TintFlags-]}
		_ID:Set[${Actor[Query, TintFlags=${_Actor.Right[-10]}].ID}]
	elseif ${_TintFlags} && ${_LoopUntilNoHighlightOnMouseHover}
		_ID:Set[${Actor[Query, TintFlags=${_Actor} && HighlightOnMouseHover=TRUE].ID}]
	elseif ${_TintFlags}
		_ID:Set[${Actor[Query, TintFlags=${_Actor}].ID}]
	elseif ${_LoopUntilNoHighlightOnMouseHover} && ${_ExactName}
		_ID:Set[${Actor[Query, Name=="${_Actor}" && HighlightOnMouseHover=TRUE].ID}]
	elseif ${_LoopUntilNoHighlightOnMouseHover}
		_ID:Set[${Actor[Query, Name=-"${_Actor}" && HighlightOnMouseHover=TRUE].ID}]
	elseif ${_Actor.Find[Ulteran Spire Portal]} || ${_HighlightOnMouseHover}
		_ID:Set[${Actor[Query, Name=-"${_Actor}" && HighlightOnMouseHover=TRUE].ID}]
	elseif ${_ExactName}
		_ID:Set[${Actor[Query, Name=="${_Actor}"].ID}]
	else
		_ID:Set[${Actor[Query, Name=-"${_Actor}"].ID}]
	;echo Moving to ${CustomLoc} and Clicking ${_Actor} with Actor ID: ${_ID}
	
	if ${CustomLoc.NotEqual[0 0 0]}
	{	
		if ${LockSpot}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${CustomLoc.Replace[" ",","]}]
			wait 300 ${Me.Distance[${CustomLoc.Replace[" ",","]}]}<3
			wait 50 ${RIMObj.AllGroupWithinRange[5]} && !${Me.IsMoving}
			wait 10
		}
		else
		{
			;stop follow
			call RIMObj.stopfollow
			call RIMObj.Move ${CustomLoc} ${Precision} 0 TRUE TRUE TRUE FALSE TRUE
			relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call RIMObj.Move ${CustomLoc} ${Precision} 0 TRUE TRUE TRUE FALSE TRUE"]
			wait 20
		}
	}
	
	;call RIMObj.stopfollow
	;wait until we are out of combat
	if ${StopForCombat}
		call RIMObj.CheckCombat
	;make sure _Actor exists so we do not go through the motions for nothign
	;echo \${Actor[Query, Name=-"${_Actor}"](exists)}  //  ${Actor[Query, Name=-"${_Actor}"](exists)}
	if ${_LoopUntilNoHighlightOnMouseHover}
	{
		if ${Actor[id,${_ID}](exists)}
		{
			;wait until we are out of combat
			if ${StopForCombat}
				call RIMObj.CheckCombat
			wait 10
			;pause bots
			if ${_RelayToGroup}
				relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
			else
				RI_CMD_PauseCombatBots 1
			wait 5
			eq2ex cancel_spellcast
			wait 2
			while ${Actor[${_ID}].HighlightOnMouseHover} && ${_Cnt:Inc} <= ${_GiveUpCNT}
			{
				if ${_RelayToGroup}
					relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
				else
					Actor[${_ID}]:DoubleClick
				wait 5 ${Me.CastingSpell}
				wait 50 !${Me.CastingSpell}
				wait 5
			}
		}
	}
	elseif ${_LoopUntilNotInteractable}
	{
		if ${Actor[id,${_ID}](exists)}
		{
			;wait until we are out of combat
			if ${StopForCombat}
				call RIMObj.CheckCombat
			wait 10
			;pause bots
			
			if ${_RelayToGroup}
				relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
			else
				RI_CMD_PauseCombatBots 1
			wait 5
			eq2ex cancel_spellcast
			wait 2
			while ${Actor[${_ID}].Interactable} && ${_Cnt:Inc} <= ${_GiveUpCNT}
			{
				if ${_RelayToGroup}
					relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
				else
					Actor[${_ID}]:DoubleClick
				wait 5 ${Me.CastingSpell}
				wait 50 !${Me.CastingSpell}
				wait 5
			}
		}
	}
	elseif ${_LoopUntilDNE}
	{
		if ${Actor[id,${_ID}](exists)}
		{
			;wait until we are out of combat
			if ${StopForCombat}
				call RIMObj.CheckCombat
			wait 10
			;pause bots
			if ${_RelayToGroup}
				relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
			else
				RI_CMD_PauseCombatBots 1
			wait 5
			
			while ${Actor[${_ID}](exists)} && ${_Cnt:Inc} <= ${_GiveUpCNT}
			{
				if ${_RelayToGroup}
					relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
				else
					Actor[${_ID}]:DoubleClick
				wait 5 ${Me.CastingSpell}
				wait 50 !${Me.CastingSpell}
			}
		}
	}
	elseif ${_LoopUntilQSE.NotEqual[~NONE~]}
	{
		if ${Actor[id,${_ID}](exists)}
		{
			;wait until we are out of combat
			if ${StopForCombat}
				call RIMObj.CheckCombat
			wait 10
			;pause bots
			if ${_RelayToGroup}
				relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
			else
				RI_CMD_PauseCombatBots 1
			wait 5
			
			while ${Actor[${_ID}](exists)} && ${_Cnt:Inc} <= ${_GiveUpCNT} && !${RIObj.QuestStepExists[${_LoopUntilQSE}]}
			{
				if ${_RelayToGroup}
					relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
				else
					Actor[${_ID}]:DoubleClick
				wait 5 ${Me.CastingSpell}
				wait 50 !${Me.CastingSpell}
			}
		}
	}
	else
	{
		if ${Actor[id,${_ID}](exists)}
		{
			;wait until we are out of combat
			if ${StopForCombat}
				call RIMObj.CheckCombat
			wait 10
			;pause bots
			if ${_RelayToGroup}
				relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
			else
				RI_CMD_PauseCombatBots 1
			wait 5
			
			wait 5
			if ${_RelayToGroup}
				relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
			else
				Actor[${_ID}]:DoubleClick
			wait 5
			if ${_RelayToGroup}
				relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
			else
				Actor[${_ID}]:DoubleClick
			wait 5
			if ${_RelayToGroup}
				relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
			else
				Actor[${_ID}]:DoubleClick
			wait 5 ${Me.CastingSpell}
			wait 50 !${Me.CastingSpell}
		}

	}
	if ${_RelayToGroup}
		relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 0
	else
		RI_CMD_PauseCombatBots 0
	if ${_LockSpot}
	{
		if ${_RelayToGroup}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[OFF]
		else
			RIMUIObj:SetLockSpot[OFF]
	}
	;follow
	wait 1
	if ${_Follow}
		call RIMObj.follow
}
function RightClickActor(... args)
{
	;string _Actor, bool _LoopUntilNoHighlightOnMouseHover=0, bool _LoopUntilDNE=0, int _GiveUpCNT=50
	;echo ClickActor(string _Actor=${_Actor}, int _LoopUntilNoHighlightOnMouseHover=0=${_LoopUntilNoHighlightOnMouseHover}, int _GiveUpCNT=50=${_GiveUpCNT})
	;move to ClickActor location
	;stop follow
	
	variable string _Actor
	variable int _LoopUntilNoHighlightOnMouseHover=0
	variable int _LoopUntilDNE=0
	variable int _HighlightOnMouseHover=0
	variable int _GiveUpCNT=50
	variable string _LoopUntilQSE=~NONE~
	variable bool _TintFlags=FALSE
	variable int _acnt=0
	variable bool _ExactName=FALSE
	
	for(_acnt:Set[1];${_acnt}<=${args.Used};_acnt:Inc)
	{
		;backwards compatibility
		if ${_acnt}<5 && ${args[1].Left[1].NotEqual[-]}
		{
			_Actor:Set["${args[1]}"]
			if ${args[2].Left[1].NotEqual[-]}
			{
				_LoopUntilNoHighlightOnMouseHover:Set[${Int[${args[2]}]}]
				if ${args[3].Left[1].NotEqual[-]}
				{
					_LoopUntilDNE:Set[${Int[${args[3]}]}]
					if ${args[4].Left[1].NotEqual[-]}
					{
						_GiveUpCNT:Set[${Int[${args[4]}]}]
					}
				}
			}
		}
		
		;echo args ${_acnt} : ${args[${_acnt}]}
		switch ${args[${_acnt}]}
		{
			case -Actor
			{
				_Actor:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -LoopUntilNoHighlightOnMouseHover
			{
				_LoopUntilNoHighlightOnMouseHover:Set[1]
				break
			}
			case -ExactName
			{
				_ExactName:Set[1]
				break
			}
			case -HighlightOnMouseHover
			{
				_HighlightOnMouseHover:Set[1]
				break
			}
			case -LoopUntilDNE
			{
				_LoopUntilDNE:Set[1]
				break
			}
			case -GiveUpCNT
			{
				_GiveUpCNT:Set[${args[${Math.Calc[${_acnt}+1]}]}]
				break
			}
			case -LoopUntilQSE
			{
				_LoopUntilQSE:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -TintFlags
			{
				_TintFlags:Set[1]
				break
			}
		}
	}
	
	variable int _Cnt=0
	variable int _ID
	if  ${_Actor.Left[5].Equal[ByLoc]} && ${_LoopUntilNoHighlightOnMouseHover}
		_ID:Set[${Actor[Query, X=${_Actor.Token[2,|]} && Y=${_Actor.Token[3,|]} && Z=${_Actor.Token[4,|]} && HighlightOnMouseHover=TRUE].ID}]
	elseif ${_Actor.Left[5].Equal[ByLoc]}
		_ID:Set[${Actor[Query, X=${_Actor.Token[2,|]} && Y=${_Actor.Token[3,|]} && Z=${_Actor.Token[4,|]}].ID}]
	elseif ${_Actor.Left[10].Equal[TintFlags-]} && ${_LoopUntilNoHighlightOnMouseHover}
		_ID:Set[${Actor[Query, TintFlags=${_Actor.Right[-10]} && HighlightOnMouseHover=TRUE].ID}]
	elseif ${_Actor.Left[10].Equal[TintFlags-]}
		_ID:Set[${Actor[Query, TintFlags=${_Actor.Right[-10]}].ID}]
	elseif ${_TintFlags} && ${_LoopUntilNoHighlightOnMouseHover}
		_ID:Set[${Actor[Query, TintFlags=${_Actor} && HighlightOnMouseHover=TRUE].ID}]
	elseif ${_TintFlags}
		_ID:Set[${Actor[Query, TintFlags=${_Actor}].ID}]
	elseif ${_LoopUntilNoHighlightOnMouseHover} && ${_ExactName}
		_ID:Set[${Actor[Query, Name=="${_Actor}" && HighlightOnMouseHover=TRUE].ID}]
	elseif ${_LoopUntilNoHighlightOnMouseHover}
		_ID:Set[${Actor[Query, Name=-"${_Actor}" && HighlightOnMouseHover=TRUE].ID}]
	elseif ${_Actor.Find[Ulteran Spire Portal]} || ${_HighlightOnMouseHover}
		_ID:Set[${Actor[Query, Name=-"${_Actor}" && HighlightOnMouseHover=TRUE].ID}]
	elseif ${_ExactName}
		_ID:Set[${Actor[Query, Name=="${_Actor}"].ID}]
	else
		_ID:Set[${Actor[Query, Name=-"${_Actor}"].ID}]
	;echo Moving to ${CustomLoc} and Clicking ${_Actor} with Actor ID: ${_ID}
	
	if ${CustomLoc.NotEqual[0 0 0]}
	{	
		;call RIMObj.follow
		call RIMObj.Move ${CustomLoc} ${Precision} 0 TRUE TRUE TRUE FALSE TRUE
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call RIMObj.Move ${CustomLoc} ${Precision} 0 TRUE TRUE TRUE FALSE TRUE"]
		wait 20
	}
	;call RIMObj.stopfollow
	;wait until we are out of combat
	if ${StopForCombat}
		call RIMObj.CheckCombat
	;make sure _Actor exists so we do not go through the motions for nothign
	;echo \${Actor[Query, Name=-"${_Actor}"](exists)}  //  ${Actor[Query, Name=-"${_Actor}"](exists)}
	if ${_LoopUntilNoHighlightOnMouseHover}
	{
		if ${Actor[id,${_ID}](exists)}
		{
			;wait until we are out of combat
			if ${StopForCombat}
				call RIMObj.CheckCombat
			wait 10
			;pause bots
			
			relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
			wait 5
			eq2ex cancel_spellcast
			wait 2
			while ${Actor[${_ID}].HighlightOnMouseHover} && ${_Cnt:Inc} <= ${_GiveUpCNT}
			{
				relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:RightClick
				wait 5 ${Me.CastingSpell}
				wait 50 !${Me.CastingSpell}
				wait 5
			}
		}
	}
	elseif ${_LoopUntilDNE}
	{
		if ${Actor[id,${_ID}](exists)}
		{
			;wait until we are out of combat
			if ${StopForCombat}
				call RIMObj.CheckCombat
			wait 10
			;pause bots
			
			relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
			wait 5
			
			while ${Actor[${_ID}](exists)} && ${_Cnt:Inc} <= ${_GiveUpCNT}
			{
				relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:RightClick
				wait 5 ${Me.CastingSpell}
				wait 50 !${Me.CastingSpell}
			}
		}
	}
	elseif ${_LoopUntilQSE.NotEqual[~NONE~]}
	{
		if ${Actor[id,${_ID}](exists)}
		{
			;wait until we are out of combat
			if ${StopForCombat}
				call RIMObj.CheckCombat
			wait 10
			;pause bots
			
			relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
			wait 5
			
			while ${Actor[${_ID}](exists)} && ${_Cnt:Inc} <= ${_GiveUpCNT} && !${RIObj.QuestStepExists[${_LoopUntilQSE}]}
			{
				relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:RightClick
				wait 5 ${Me.CastingSpell}
				wait 50 !${Me.CastingSpell}
			}
		}
	}
	else
	{
		if ${Actor[id,${_ID}](exists)}
		{
			;wait until we are out of combat
			if ${StopForCombat}
				call RIMObj.CheckCombat
			wait 10
			;pause bots
			
			relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
			wait 5
			
			wait 5
			relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:RightClick
			wait 5
			relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:RightClick
			wait 5
			relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:RightClick
			wait 5 ${Me.CastingSpell}
			wait 50 !${Me.CastingSpell}
		}

	}
	relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 0
	;follow
	if ${_Follow}
		call RIMObj.follow
}
function KillAll(string MobName, int Distance=1000)
{
	wait 20
	echo ISXRI: Killing All: ${MobName} Within: ${Distance}
	;echo KillAll(string MobName=${MobName}, int Distance=${Distance})
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Loc}]
	;echo \${Actor[Query, Name=-"${MobName}" && Distance<=${Distance} && IsDead=FALSE](exists)} // ${Actor[Query, Name=-"${MobName}" && Distance<=${Distance} && IsDead=FALSE](exists)}
	while ${Actor[Query, Name=-"${MobName}" && Distance<=${Distance} && IsDead=FALSE](exists)}
	{
		Actor[Query, Name=-"${MobName}" && Distance<=${Distance} && IsDead=FALSE]:DoTarget
		wait 1
		call RIMObj.CheckCombat
	}
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[OFF]
}
function KillAllVV(... args)
{
	;string MobName, string _VisualVariant, int Distance=1000
	;variable index:string _MobName
	;variable index:string _VisualVariant
	;variable index:int _Distance
	variable string _Query
	variable int _acnt
	for(_acnt:Set[1];${_acnt}<=${args.Used};_acnt:Inc)
	{
		if ${Math.Calc[${_acnt}+2]}>=${args.Used}
			_Query:Concat["(Name=-\"${args[${_acnt}]}\"&&VisualVariant=-\"${args[${Math.Calc[${_acnt}+1]}]}\"&&Distance<=${Int[${args[${Math.Calc[${_acnt}+2]}]}]}&&IsDead=FALSE)"]
		else
			_Query:Concat["(Name=-\"${args[${_acnt}]}\"&&VisualVariant=-\"${args[${Math.Calc[${_acnt}+1]}]}\"&&Distance<=${Int[${args[${Math.Calc[${_acnt}+2]}]}]}&&IsDead=FALSE)||"]
		;_MobName:Insert["${args[${_acnt}]}"]
		;_VisualVariant:Insert["${args[${Math.Calc[${_acnt}+1]}]}"]
		;_Distance:Insert[${Int[${args[${Math.Calc[${_acnt}+2]}]}]}]
		_acnt:Inc
		_acnt:Inc
	}
	wait 20
	echo ISXRI: Kill All VisualVariant Running
	;echo KillAll Query=${_Query}
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Loc}]
	;echo \${Actor[Query, Name=-"${MobName}" && Distance<=${Distance} && IsDead=FALSE](exists)} // ${Actor[Query, Name=-"${MobName}" && Distance<=${Distance} && IsDead=FALSE](exists)}
	while ${Actor[Query, ${_Query}](exists)}
	{
		Actor[Query, ${_Query}]:DoTarget
		wait 1
		call RIMObj.CheckCombat
	}
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[OFF]
}
function Podts(int OnOff)
{
	RI_Var_Bool_Podts:Set[${OnOff}]
}
function Podtstombhorrow(int OnOff)
{
	RI_Var_Bool_Podtstombhorrow:Set[${OnOff}]
}
function Klyreject()
{
	variable int cnt=0
	while ${cnt:Inc}<450 && ${Actor[a Kly Overseer](exists)}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
		relay ${RI_Var_String_RelayGroup} eq2ex pet backoff
		Me:DoTarget
		wait 1
	}
	eq2ex target_none
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
}
function PauseCombatBot(int _Pause=0)
{
	if ${_Pause}>0
		relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
	else
		relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 0
}
function ClickAllActors(string _ActorQuery, int _Distance=0)
{
	;wait 20
	;echo ISXRI: ${Time} Clicking any Actors within ${distance}
		
	variable index:actor Actors
    variable iterator ActorIterator
    if ${_ActorQuery.Find[TintFlags](exists)} && ${_Distance}>0
		EQ2:QueryActors[Actors, ${_ActorQuery.Replace["-","="]} && Distance<=${_Distance}]
	elseif ${_ActorQuery.Find[TintFlags](exists)} && ${_Distance}==0
		EQ2:QueryActors[Actors, ${_ActorQuery.Replace["-","="]}]
	elseif ${_Distance}>0
		EQ2:QueryActors[Actors, Name=-"${_ActorQuery}" && Distance<=${_Distance}]
	else
		EQ2:QueryActors[Actors, Name=-"${_ActorQuery}"]
    Actors:GetIterator[ActorIterator]
  
    if ${ActorIterator:First(exists)}
    {
        do
        {
			echo ISXRI: ${Time} Clicking Actor ID: ${ActorIterator.Value.ID} at ${ActorIterator.Value.Loc}
			;if ${ActorIterator.Value.Name.Equal[""]}
			;	echo this one has no name
            ; relay ${RI_Var_String_RelayGroup} -noredirect execute noop ${Actor[Query, ID=${ActorIterator.Value.ID}]:DoubleClick}
			; wait 1
			; relay ${RI_Var_String_RelayGroup} -noredirect execute noop ${Actor[Query, ID=${ActorIterator.Value.ID}]:DoubleClick}
			; wait 1
			; relay ${RI_Var_String_RelayGroup} -noredirect execute noop ${Actor[Query, ID=${ActorIterator.Value.ID}]:DoubleClick}
			relay ${RI_Var_String_RelayGroup} -noredirect Actor[${ActorIterator.Value.ID}]:DoubleClick
			wait 1
			relay ${RI_Var_String_RelayGroup} -noredirect Actor[${ActorIterator.Value.ID}]:DoubleClick
			wait 1
			relay ${RI_Var_String_RelayGroup} -noredirect Actor[${ActorIterator.Value.ID}]:DoubleClick
			wait 50 !${Me.CastingSpell}
        }
        while ${ActorIterator:Next(exists)}
    }
	;wait 20
}
function ClickNoNameActor(int distance=5)
{
	;wait 20
	;echo ISXRI: ${Time} Clicking any Actors within ${distance}
		
	variable index:actor Actors
    variable iterator ActorIterator
    
	EQ2:QueryActors[Actors, Type !="Pet" && Type !="PC" && Name !="${Me.Name}" && Distance <= ${distance} && Name==""]
    Actors:GetIterator[ActorIterator]
  
    if ${ActorIterator:First(exists)}
    {
        do
        {
			;echo ISXRI: ${Time} Clicking Actor ID: ${ActorIterator.Value.ID} at ${ActorIterator.Value.Loc}
			;if ${ActorIterator.Value.Name.Equal[""]}
			;	echo this one has no name
            ; relay ${RI_Var_String_RelayGroup} -noredirect execute noop ${Actor[Query, ID=${ActorIterator.Value.ID}]:DoubleClick}
			; wait 1
			; relay ${RI_Var_String_RelayGroup} -noredirect execute noop ${Actor[Query, ID=${ActorIterator.Value.ID}]:DoubleClick}
			; wait 1
			; relay ${RI_Var_String_RelayGroup} -noredirect execute noop ${Actor[Query, ID=${ActorIterator.Value.ID}]:DoubleClick}
			relay ${RI_Var_String_RelayGroup} -noredirect Actor[${ActorIterator.Value.ID}]:DoubleClick
			wait 1
			relay ${RI_Var_String_RelayGroup} -noredirect Actor[${ActorIterator.Value.ID}]:DoubleClick
			wait 1
			relay ${RI_Var_String_RelayGroup} -noredirect Actor[${ActorIterator.Value.ID}]:DoubleClick
			wait 20
        }
        while ${ActorIterator:Next(exists)}
    }
	;wait 20
}
function MoveToNoNameActor(int _Precision=2, bool _SkipCollisionCheck=FALSE)
{
	call RIMObj.Move ${Actor[Query, Type !="Pet" && Type !="PC" && Name !="${Me.Name}" && Name==""].X} ${Actor[Query, Type !="Pet" && Type !="PC" && Name !="${Me.Name}" && Name==""].Y} ${Actor[Query, Type !="Pet" && Type !="PC" && Name !="${Me.Name}" && Name==""].Z}  ${_Precision} 0 0 0 1 0 1 ${_SkipCollisionCheck}
}
;function to handle lifts in FSD Heroic
function Lift(int onX, int onZ, int offFace, string lVerb)
{
	if !${RI_Var_Bool_GlobalOthers}
	{
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Lift ${onX} ${onZ} ${offFace}"]
		call RIMObj.stopfollow
	}
	if ${RI_Var_Bool_Debug}
		echo ${Time}: Moving onto lift by facing ${onX},${onZ}, Pressing forward until we reach destination point, then ApplyVerb: ${lVerb} to ${Actor[Lever]}: ${Actor[Lever].ID}, then Move off via facing ${offFace} and moving until we are more than 8m away
	wait 20
	Face ${onX} ${onZ}
	press -hold ${RI_Var_String_ForwardKey}
	wait 30 ${Math.Distance[${Me.X},${Me.Z},${onX},${onZ}]}<2
	press -release ${RI_Var_String_ForwardKey}
	wait 20
	if ${lVerb(exists)}
		eq2ex apply_verb ${Actor[Lever].ID} "${lVerb}"
	wait 100
	Face ${offFace}
	press -hold ${RI_Var_String_ForwardKey}
	wait 30 ${Math.Distance[${Me.X},${Me.Z},${onX},${onZ}]}>8
	press -release ${RI_Var_String_ForwardKey}
	wait 20
	if !${RI_Var_Bool_GlobalOthers}
	{
		call RIMObj.follow
	}
}
function MercBackOff(int _OnOff)
{
	RI_Var_Bool_BackOffMerc:Set[${_OnOff}]
}
;function to run a custom script
function RunCustomScript(string ScriptName,... args)
{
	;echo ${ScriptName} ${arg1} ${arg2} ${arg3} ${arg4} ${arg5}
	if !${Script[Buffer:${ScriptName}](exists)}
	{
		variable int _cnt=0
		variable string _arguments=""
		for(_cnt:Set[1];${cnt}<=${args.Used};_cnt:Inc)
		{
			_arguments:Concat[${args.Get[${_cnt}]}]
		}
		execute ${ScriptName} ${arguments}
	}
}
;function to end a custom script
function EndCustomScript(string ScriptName)
{
	if ${Script[Buffer:${ScriptName}](exists)}
		endscript Buffer:${ScriptName}
}
;function to toggle between walk and run
function ToggleWalkRun(bool ALL)
{
	wait 20
	;toggle Walk Run
	if ${ALL}
		relay ${RI_Var_String_RelayGroup} -noredirect press shift+r
	else
		press shift+r
	wait 10
}
;function to target called named and relay a cast of severhate 
function SeverHate(string SHTarget)
{
	if ${Actor[${SHTarget}](exists)}
	{
		variable int SHTargetID=${Actor[${SHTarget}].ID}
		if ${SHTargetID} == 0
		{
			wait 5
			SHTargetID:Set[${Actor[${SHTarget}].ID}]
			wait 5
			if ${SHTargetID} == 0 && !${Actor[${SHTarget}](exists)}
			{
				if ${RI_Var_Bool_Debug}
					 SeverHate Target: ${SHTarget} Does Not Exist, Skipping Sever Hate
				return
			}
		}

		wait 20
		Actor[${SHTargetID}]:DoTarget
		wait 5
		relay ${RI_Var_String_RelayGroup} -noredirect Me.Ability["Sever Hate"]:Use
		while ${Actor[${SHTargetID}](exists)} && !${Actor[${SHTargetID}].Target(exists)}
		{
			Actor[${SHTargetID}]:DoTarget
			wait 5
			relay ${RI_Var_String_RelayGroup} -noredirect Me.Ability["Sever Hate"]:Use
		}
	}
	else
		echo ${Time}: SeverHate Target: ${SHTarget} Does Not Exist, Skipping Sever Hate
}
;function to end RI
function EndScript()
{
	if !${InstanceMode} && !${RI_Var_Bool_QuestMode}
	{
		wait 20
		Script:End
	}
}
;function to evac and end ri if requested
function Evac(bool EndScript)
{
	wait 10
	relay ${RI_Var_String_RelayGroup} RI_Evac
	wait 5
	relay ${RI_Var_String_RelayGroup} RI_Evac
	wait 45
	if ${Me.Group}>1 && ${Me.Group[1].Type.Equal[PC]}
	{
		wait 50000 ${RIMObj.AllGroupInZone}
		wait 200
	}
	;check for a Shiny if set
	if ${RI_Var_Bool_GrabShinys}
	; && ${Actor[Query, Name=-"?" && Distance<=${ShinyScanDistance}](exists)}
	{
		if ( !${Actor[NamedNPC,radius,50](exists)} || ${RI_Var_Bool_IgnoreNamedForShiny} || ${Math.Distance[${Actor[?,radius,${ShinyScanDistance}].Y},${Actor[NamedNPC,radius,50].Y}]}>10 ) && ${Math.Distance[${Actor[?,radius,${ShinyScanDistance}].Y},${Me.Y}]}<3
		{
			;RI_Var_Int_ShinyID:Set[${Actor[?,radius,${ShinyScanDistance}].ID}]
			;if ${RI_Var_Bool_Debug}
			;	echo ${Time}: Closest Shiny ID: ${RI_Var_Int_ShinyID} @ ${Actor[${RI_Var_Int_ShinyID}].X} ${Actor[${RI_Var_Int_ShinyID}].Y} ${Actor[${RI_Var_Int_ShinyID}].Z} Which is ${Actor[${RI_Var_Int_ShinyID}].Distance} Away
			;press -release ${RI_Var_String_ForwardKey}
			call RIMObj.CheckShiny
		}
	}
	if ${EndScript} && !${InstanceMode} && !${RI_Var_Bool_QuestMode}
		relay ${RI_Var_String_RelayGroup} -noredirect endscript ${RI_Var_String_RunInstancesScriptName}
}
function ExecuteQueued()
{
	;execute queued commands
	if ${QueuedCommands}
	{
		ExecuteQueued
	}
}
function CheckChest()
{
	variable int _ChestID=0
	variable int _ChestCNT=0
	relay ${RI_Var_String_RelayGroup} RI_Var_Bool_SkipLoot:Set[1]
	wait 5
	call LootOptions LO
	wait 5
	if ${Actor[Chest,radius,100](exists)} && ${Me.WaterDepth}==0 && !${Me.FlyingUsingMount}
	{
		;stop moving
		press -release ${RI_Var_String_ForwardKey}

		;chest's id
		variable int _ChestID=${Actor[Chest,radius,100].ID}
		
		;if _ChestID is 0 leave function
		if ${_ChestID}==0
			return

		eq2ex apply_verb ${_ChestID} Summon
		eq2ex summon ${_ChestID}
		wait 2
		eq2ex apply_verb ${_ChestID} Summon
		eq2ex summon ${_ChestID}
		wait 2
		eq2ex apply_verb ${_ChestID} Summon
		eq2ex summon ${_ChestID}

		wait 10
		
		Actor[id,${_ChestID}]:DoubleClick
		wait 2
		Actor[id,${_ChestID}]:DoubleClick
		wait 2
		Actor[id,${_ChestID}]:DoubleClick
		
		;set 40min timer, then loot anyways
		if ${RIObj.ItemsInChest[]}
		while ${Actor[id,${_ChestID}](exists)} && ${_ChestCNT:Inc}<2400
		{
			wait 10
		}
	}
}
;code to execute when close is pressed on ui
function atexit()
{
	if ${UIElement[SettingsSkipMobAttackHealthCheckBox@SettingsFrame@CombatBotUI].Checked} && !${Skip100NotChecked}
		UIElement[SettingsSkipMobAttackHealthCheckBox@SettingsFrame@CombatBotUI]:SetChecked
	if ${RI_Var_Bool_WaitForLastNamedChest}
		relay ${RI_Var_String_RelayGroup} RI_Var_Bool_SkipLoot:Set[0]
		if ${Script[Buffer:RunInstances](exists)}
			Script[Buffer:RunInstances]:Resume
		if ${Script[Buffer:RIMovement](exists)}
			Script[Buffer:RIMovement]:Resume
		if ${Script[Buffer:RILooter](exists)}
			Script[Buffer:RILooter]:Resume
		if ${Script[Buffer:OgrePlayNice](exists)}
			Script[Buffer:OgrePlayNice]:Resume
		if ${Script[Buffer:CoT](exists)}
			Script[Buffer:CoT]:Resume
		if ${Script[Buffer:AggroControl](exists)}
			Script[Buffer:AggroControl]:Resume
		if ${Script[Buffer:Bull](exists)}
			Script[Buffer:Bull]:Resume
		if ${Script[Buffer:Captain](exists)}
			Script[Buffer:Captain]:Resume
		if ${Script[Buffer:Charanda](exists)}
			Script[Buffer:Charanda]:Resume
		if ${Script[Buffer:Farozth](exists)}
			Script[Buffer:Ferun]:Resume
		if ${Script[Buffer:Grethah](exists)}
			Script[Buffer:Grethah]:Resume
		if ${Script[Buffer:Grevog](exists)}
			Script[Buffer:Grevog]:Resume
		if ${Script[Buffer:Icon](exists)}
			Script[Buffer:Icon]:Resume
		if ${Script[Buffer:Imbiber](exists)}
			Script[Buffer:Imbiber]:Resume
		if ${Script[Buffer:Jessip](exists)}
			Script[Buffer:Jessip]:Resume
		if ${Script[Buffer:Kerridicus](exists)}
			Script[Buffer:Kerridicus]:Resume
		if ${Script[Buffer:Protector](exists)}
			Script[Buffer:Protector]:Resume
		if ${Script[Buffer:Sacrificer](exists)}
			Script[Buffer:Sacrificer]:Resume
		if ${Script[Buffer:Teraradus](exists)}
			Script[Buffer:Teraradus]:Resume
		if ${Script[Buffer:Torso](exists)}
			Script[Buffer:Torso]:Resume
		if ${Script[Buffer:Virtuoso](exists)}
			Script[Buffer:Virtuoso]:Resume
		if ${Script[Buffer:Zadune](exists)}
			Script[Buffer:Zadune]:Resume
		if ${Script[Buffer:Ritual](exists)}
			Script[Buffer:Ritual]:Resume
		RI_Var_Bool_Paused:Set[FALSE]
	RI_Var_Bool_Paused:Set[0]
	RI_Var_Bool_SkipLoot:Set[0]
	relay ${RI_Var_String_RelayGroup} RI_Obj_CB:SetUISetting[SettingsMoveBehindCheckBox,0]
	squelch HUD -remove east
	squelch HUD -remove west
	if ${LoadedTLO} && ${Extension[ISXRI](exists)}
		squelch RI_CMD_Hidden_RemoveTLO ${LoadedTLOName}

	if ${AcceptLootWasOff}
	{
		RI_Obj_CB:SetUISetting[SettingsAcceptLootCheckBox,0]
	}		
	
	; if ${ISXOgre(exists)}
	; {
		; OgreBotAtom aExecuteAtom ${Me} a_UplinkControllerFunctionAutoType checkbox_settings_disablecaststack FALSE
		; OgreBotAtom aExecuteAtom ${Me} a_UplinkControllerFunctionAutoType checkbox_settings_disablecaststack_combat FALSE
		; OgreBotAtom aExecuteAtom ${Me} a_UplinkControllerFunctionAutoType checkbox_settings_disablecaststack_ca FALSE
		; OgreBotAtom aExecuteAtom ${Me} a_UplinkControllerFunctionAutoType checkbox_settings_disablecaststack_namedca FALSE
	; }
			
	;disable LockSpotting if it was originally off
	if ${Script[${RI_Var_String_CombatBotScriptName}](exists)} && ${LockSpottingWasOff} && !${Script[Buffer:RZ](exists)}
		RI_Obj_CB:SetUISetting[SettingsLockSpottingCheckBox,FALSE]

			
	;if ${Script[Buffer:RIMovement]}
	;	endscript Buffer:RIMovement
	relay ${RI_Var_String_RelayGroup} Squelch RIMUIObj:SetLockSpot[OFF]
	relay ${RI_Var_String_RelayGroup} Squelch RIMUIObj:SetRIFollow[OFF]
	;relay ${RI_Var_String_RelayGroup} Squelch RI_Atom_SetLockSpot OFF
	;relay ${RI_Var_String_RelayGroup} Squelch RI_Atom_SetRIFollow OFF
	relay ${RI_Var_String_RelayGroup} Squelch press -release ${RI_Var_String_ForwardKey}
	relay ${RI_Var_String_RelayGroup} Squelch press -release ${RI_Var_String_BackwardKey}
	relay ${RI_Var_String_RelayGroup} Squelch press -release ${RI_Var_String_FlyUpKey}
	
	;if ${Script[Buffer:RILooter]}
	;	endscript Buffer:RILooter
	;if ${Script[Buffer:OgrePlayNice]}
		;endscript Buffer:OgrePlayNice
	if ${Script[Buffer:Detarget]}
		endscript Buffer:Detarget
	if ${Script[Buffer:Vexven]}
		endscript Buffer:Vexven
	if ${Script[Buffer:CoT]}
		endscript Buffer:CoT
	if ${Script[Buffer:AggroControl]}
		endscript Buffer:AggroControl
		
	if ${RI_Var_Bool_GlobalOthers}
	{
		echo Ending RI
		ui -unload "${LavishScript.HomeDirectory}/Scripts/RI/RI.xml"
	}
	else
	{
		echo Ending RI
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RIObj:EndScript
		ui -unload "${LavishScript.HomeDirectory}/Scripts/RI/RI.xml"
	}
	if ${Me.IsMoving}
	{
		press ${RI_Var_String_BackwardKey}
		press ${RI_Var_String_BackwardKey}
		press ${RI_Var_String_BackwardKey}
	}
	press -release ${RI_Var_String_StrafeLeftKey}
	press -release ${RI_Var_String_StrafeRightKey}
	press -release ${RI_Var_String_FlyUpKey}
	press -release ${RI_Var_String_FlyDownKey}
	;if ${Script[Buffer:Craft](exists)}
	;	Script[Buffer:Craft]:End
	
	;turn off food,drink and potion consumption   ---- ADD THIS TO RZ and Make Optional
;	if ${Me.Equipment[Food].AutoConsumeOn} 
;		Me.Equipment[Food]:ToggleAutoConsume
;	if ${Me.Equipment[Drink].AutoConsumeOn}
;		Me.Equipment[Drink]:ToggleAutoConsume
;	if ${Me.Inventory[Elixir of Piety](exists)} && ${Me.Archetype.Equal[priest]} && ${Me.Inventory[Elixir of Piety].AutoConsumeOn}
;		Me.Inventory[Elixir of Piety]:ToggleAutoConsume
;	if ${Me.Inventory[Elixir of Deftness](exists)} && ${Me.Archetype.Equal[scout]} && ${Me.Inventory[Elixir of Deftness].AutoConsumeOn}
;		Me.Inventory[Elixir of Deftness]:ToggleAutoConsume
;	if ${Me.Inventory[Elixir of Intellect](exists)} && ${Me.Archetype.Equal[mage]} && ${Me.Inventory[Elixir of Intellect].AutoConsumeOn}
;		Me.Inventory[Elixir of Intellect]:ToggleAutoConsume
;	if ${Me.Inventory[Elixir of Fortitude](exists)} && !${RI_Var_Bool_GlobalOthers} && ${Me.Inventory[Elixir of Fortitude].AutoConsumeOn}
;		Me.Inventory[Elixir of Fortitude]:ToggleAutoConsume
	;clear shiny actors
	call ClearShinyActors
}

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; AOM NAMED CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

variable(global) string CurseName
variable(global) bool RecentlyCured=FALSE
variable(global) int Tapestry=1
variable(global) bool NeedsBotDisable=TRUE
variable bool CastAntidote=TRUE
variable bool CastAntidote2=FALSE
variable string InterruptAbility
variable string AbilityToInterrupt=Symptomatic Dementia
variable bool SenshaliEngaged=FALSE
variable int PerisID
variable int AchionID
variable int UrsherID
variable int AltoID
variable int BassID
variable int SopranoID
variable int TenorID
variable int ValdimusID

;#define _CustomNamedAoM_

function Mo'iana()
{
	echo Mo'iana Script v3
	variable int CurseCallTime=0
	if !${RI_Var_Bool_GlobalOthers}
	{
		RI_Atom_SetLockSpot ${Me.Name} -3653.846680 -78.433472 140.835564 1 100
		relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[1].Name} -3664.163330 -80.522331 149.706558 1 100
		relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[2].Name} -3666.393311 -81.096672 138.827965 1 100
		relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[3].Name} -3655.729736 -78.304756 153.642868 1 100
		relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[4].Name} -3646.757324 -76.068604 149.589691 1 100
		relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[5].Name} -3658.892578 -79.401596 130.722755 1 100
	}
	echo ${Time}: Waiting for Mo'iana the Ravenous
	wait 2000000 ${Actor["Mo'iana the Ravenous"](exists)}
	echo ${Time}: Done Waiting for Mo'iana the Ravenous
	if ${Me.Archetype.Equal[priest]}
		RI_CMD_AbilityEnableDisable "Cure Curse" 0
	while ${Actor["Mo'iana"](exists)} && !${Actor["Mo'iana"].IsDead}
	{
		if ${Target.ID}!=${Actor["Mo'iana"].ID} && !${RI_Var_Bool_GlobalOthers}
			Actor["Mo'iana"]:DoTarget
		Me:InitializeEffects
		wait 5
		if ${RIMUIObj.MainIconIDExists[000]}
		{
			;echo i have bad curse
			if ( ${Script.RunningTime}>${Math.Calc[${CurseCallTime}+10000]} || ${CurseCallTime}==0 )
			{
				eq2ex g need a cure curse
				CurseCallTime:Set[${Script.RunningTime}]
			}
		}
	}
	if ${Me.Archetype.Equal[priest]}
		RI_CMD_AbilityEnableDisable "Cure Curse" 1
}
function ClickRiders()
{
	wait 20
	call RIMObj.stopfollow
	;pause bots
	relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 1
	eq2ex cancel_spellcast
	eq2execute clearabilityqueue 
	wait 200 !${Me.CastingSpell}
	relay ${RI_Var_String_RelayGroup} -noredirect Actor[Special]:DoubleClick
	wait 5
	while !${Me.IsMoving}
	{
		relay ${RI_Var_String_RelayGroup} -noredirect Actor[Special]:DoubleClick
		wait 2
	}
	while ${Me.IsMoving}
		wait 2
	wait 20
	;unpause bots
	relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 0
}
;need to code to disable these spells!!!
function Telaris()
{
	echo ISXRI: Starting Telaris 
	RI_Atom_SetLockSpot ${Me.Name} -35 0 71 2 100
	call _MoveC -35 71
	call _MoveC -47 89
	if !${RI_Var_Bool_GlobalOthers}
	{
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_SetLockSpot off
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_MoveBehind ALL ${Actor[Telaris].ID} 30 99 ${Me.Name}
		RI_Atom_SetLockSpot ${Me.Name} -47 0 89 2 100
	}
	;main loop
	do
	{
		if (${Me.GetGameData[Target.Casting].Label.Equal[${AbilityToInterrupt}]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[${AbilityToInterrupt}]})
		{
			if ${RI_Var_Bool_Debug}
				echo ${Time}: Detected interrupt ability: ${AbilityToInterrupt} casting 
			call SetInterruptSpell
			call Interrupt
		}
		wait 1
	}
	while ${Actor[Telaris](exists)} && !${Actor[Telaris].IsDead}
	;reload Bots
	RI_CMD_ReloadBots
	if !${RI_Var_Bool_GlobalOthers}
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_MoveBehind ALL OFF	
}
function Interrupt()
{
	;if ${RI_Var_Bool_Debug}
		;echo ${Time}: Interrupting ability: ${AbilityToInterrupt} with ability: ${InterruptAbility}
	;pause bots
	;relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 1
	;eq2ex cancel_spellcast
	;eq2execute clearabilityqueue 
	;wait 200 !${Me.CastingSpell}
	;if ${RI_Var_Bool_Debug}
		;echo ${Time}: We are not casting and ${InterruptAbility} IsReady: ${Me.Ability[id,${InterruptAbility.Token[2,|]}].IsReady}
	while ${Me.Ability[id,${InterruptAbility.Token[2,|]}].TimeUntilReady}<1
	{
		if ${RI_Var_Bool_Debug}
			echo ${Time}: Casting ${InterruptAbility.Token[1,|]}
		RI_CMD_Cast "${InterruptAbility.Token[1,|]}" 1
		wait 1
	}
	;wait 200 !${Me.CastingSpell}
	;unpause bots
	;relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 0
}
function SetInterruptSpell()
{
	;based on subclass, and if their ability is ready, set interruptability
	switch ${Me.SubClass}
	{
		case guardian
		{
			;Provoke XI
			if ${Me.Ability[id,840484940].IsReady}
				InterruptAbility:Set[Provoke|840484940]
			;Gut Kick X
			elseif ${Me.Ability[id,1686339786].IsReady}
				InterruptAbility:Set[Gut Kick|1686339786]
			break
		}
		case berserker
			if ${Me.Ability[Ability1].IsReady}
				InterruptAbility:Set[Ability1]
			elseif ${Me.Ability[Ability2].IsReady}
				InterruptAbility:Set[Ability2]
			break
		case paladin
			if ${Me.Ability[Ability1].IsReady}
				InterruptAbility:Set[Ability1]
			elseif ${Me.Ability[Ability2].IsReady}
				InterruptAbility:Set[Ability2]
			break
		case shadowknight
			if ${Me.Ability[Ability1].IsReady}
				InterruptAbility:Set[Ability1]
			elseif ${Me.Ability[Ability2].IsReady}
				InterruptAbility:Set[Ability2]
			break
		case monk
			if ${Me.Ability[Ability1].IsReady}
				InterruptAbility:Set[Ability1]
			elseif ${Me.Ability[Ability2].IsReady}
				InterruptAbility:Set[Ability2]
			break
		case bruiser
			if ${Me.Ability[Ability1].IsReady}
				InterruptAbility:Set[Ability1]
			elseif ${Me.Ability[Ability2].IsReady}
				InterruptAbility:Set[Ability2]
			break
		case swashbuckler
			if ${Me.Ability[Ability1].IsReady}
				InterruptAbility:Set[Ability1]
			elseif ${Me.Ability[Ability2].IsReady}
				InterruptAbility:Set[Ability2]
			break
		case brigand
			if ${Me.Ability[Bum Rush VIII].IsReady}
				InterruptAbility:Set[Bum Rush VIII]
			elseif ${Me.Ability[Barroom Negotiation VIII].IsReady}
				InterruptAbility:Set[Barroom Negotiation VIII]
			elseif ${Me.Ability[Cuss VII].IsReady}
				InterruptAbility:Set[Cuss VII]
			break
		case ranger
			if ${Me.Ability[Ability1].IsReady}
				InterruptAbility:Set[Ability1]
			elseif ${Me.Ability[Ability2].IsReady}
				InterruptAbility:Set[Ability2]
			break
		case assassin
			if ${Me.Ability[Ability1].IsReady}
				InterruptAbility:Set[Ability1]
			elseif ${Me.Ability[Ability2].IsReady}
				InterruptAbility:Set[Ability2]
			break
		case dirge
		{
			;Tarven's Crippling Crescendo X
			if ${Me.Ability[id,179772051].IsReady}
				InterruptAbility:Set[Tarven's Crippling Crescendo|179772051]
			;Hymn of Horror
			elseif ${Me.Ability[id,3885621092].IsReady}
				InterruptAbility:Set[Hymn of Horror|3885621092]
			break
		}
		case troubador
			if ${Me.Ability[Ability1].IsReady}
				InterruptAbility:Set[Ability1]
			elseif ${Me.Ability[Ability2].IsReady}
				InterruptAbility:Set[Ability2]
			break
		case templar
			if ${Me.Ability[Ability1].IsReady}
				InterruptAbility:Set[Ability1]
			elseif ${Me.Ability[Ability2].IsReady}
				InterruptAbility:Set[Ability2]
			break
		case inquisitor
			if ${Me.Ability[Invocation Strike].IsReady}
				InterruptAbility:Set[Invocation Strike]
			elseif ${Me.Ability[Skull Crack].IsReady}
				InterruptAbility:Set[Skull Crack]
			elseif ${Me.Ability[Litany Circle].IsReady}
				InterruptAbility:Set[Litany Circle]
			break
		case defiler
		{
			;Absolute Corruption VIII
			if ${Me.Ability[id,3930012145].IsReady}
				InterruptAbility:Set[Absolute Corruption|3930012145]
			;Leg Bite
			elseif ${Me.Ability[id,1665799777].IsReady}
				InterruptAbility:Set[Leg Bite|1665799777]
			break
		}
		case mystic
			if ${Me.Ability[Ability1].IsReady}
				InterruptAbility:Set[Ability1]
			elseif ${Me.Ability[Ability2].IsReady}
				InterruptAbility:Set[Ability2]
			break
		case warden
			;Willow Wisp X
			if ${Me.Ability[id,428142199].IsReady}
				InterruptAbility:Set[Willow Wisp|428142199]
			break
		case fury
			if ${Me.Ability[Ability1].IsReady}
				InterruptAbility:Set[Ability1]
			elseif ${Me.Ability[Ability2].IsReady}
				InterruptAbility:Set[Ability2]
			break
		case warlock
			if ${Me.Ability[Ability1].IsReady}
				InterruptAbility:Set[Ability1]
			elseif ${Me.Ability[Ability2].IsReady}
				InterruptAbility:Set[Ability2]
			break
		case wizard
			if ${Me.Ability[Ability1].IsReady}
				InterruptAbility:Set[Ability1]
			elseif ${Me.Ability[Ability2].IsReady}
				InterruptAbility:Set[Ability2]
			break
		case nercomancer
			if ${Me.Ability[Ability1].IsReady}
				InterruptAbility:Set[Ability1]
			elseif ${Me.Ability[Ability2].IsReady}
				InterruptAbility:Set[Ability2]
			break
		case conjurer
			if ${Me.Ability[Ability1].IsReady}
				InterruptAbility:Set[Ability1]
			elseif ${Me.Ability[Ability2].IsReady}
				InterruptAbility:Set[Ability2]
			break
		case coercer
		{
			;Spellblade's Counter
			if ${Me.Ability[id,2805714224].IsReady}
				InterruptAbility:Set[Spellblade's Counter|2805714224]
			;Hemorrhage XII
			elseif ${Me.Ability[1736909674].IsReady}
				InterruptAbility:Set[Hemorrhage|1736909674]
			break
		}
		case illusionist
			if ${Me.Ability[Ability1].IsReady}
				InterruptAbility:Set[Ability1]
			elseif ${Me.Ability[Ability2].IsReady}
				InterruptAbility:Set[Ability2]
			break
		case beastlord
		{
			;Sharpened Claws
			if ${Me.Ability[id,2486204354].IsReady}
				InterruptAbility:Set[Sharpened Claws|2486204354]
			break
		}
	}
}
function Senshali()
{
	SenshaliEngaged:Set[TRUE]
	echo ISXRI: Starting Senshali v2
	;events
	AnnounceText:Clear
	AnnounceText:Insert["lights glow about"]
	
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor["Sa'Dax Senshali"]:DoTarget
		relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot all 95 0 45 2 100
		wait 20
		;relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Var_Bool_LockSpotting:Set[FALSE]	
		;relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_MoveBehind ALL ${Actor["Sa'Dax Senshali"].ID} 30 99 ${Me.Name}	
	}
	;main loop
	do
	{
		;if we get text call orbs
		if ${Trigger}
			call Orbs
		if ${Actor["Dark Luclinite"].Distance}<10
			Actor["Dark Luclinite"]:DoubleClick
		wait 1
	}
	while ${Actor[Query, Name=="Sa'Dax Senshali" && IsDead=FALSE](exists)}
	SenshaliEngaged:Set[FALSE]
}
;click orbs
function Orbs()
{
	; if ${RI_Var_Bool_GlobalOthers}
	; {
		; RI_Var_Bool_MovingBehind:Set[FALSE]
		; RI_Var_Bool_LockSpotting:Set[TRUE]
	; }
	wait 5
	if ${RI_Var_Bool_Debug}
		echo ${Time}: Clicking Orbs, ${TriggerMessage}, ${TriggerMessage.Find[Green]}, ${TriggerMessage.Find[Orange]}, ${TriggerMessage.Find[Purple]}
	Trigger:Set[FALSE]
	;pause bots
	relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 1
	eq2execute cancel_spellcast 
	eq2execute clearabilityqueue 
	wait 5
	if ${TriggerMessage.Find[Green]}
	{
		if ${RI_Var_Bool_Debug}
			echo ${Time}: Needs Green	
		wait 10
		while ${Math.Distance[${Me.Y},-109.4]}<2 && ${Actor[Query, Name=="Sa'Dax Senshali" && IsDead=FALSE](exists)}
		{
			Actor[Blue]:DoubleClick
			Actor[Yellow]:DoubleClick
			waitframe
		}
	}
	if ${TriggerMessage.Find[Orange]}
	{
		if ${RI_Var_Bool_Debug}
			echo ${Time}: Needs Orange
		wait 10
		while ${Math.Distance[${Me.Y},-109.4]}<2 && ${Actor[Query, Name=="Sa'Dax Senshali" && IsDead=FALSE](exists)}
		{
			Actor[Red]:DoubleClick
			Actor[Yellow]:DoubleClick
			waitframe
		}
	}
	if ${TriggerMessage.Find[Purple]}
	{
		if ${RI_Var_Bool_Debug}
			echo ${Time}: Needs Purple
		wait 10
		while ${Math.Distance[${Me.Y},-109.4]}<2 && ${Actor[Query, Name=="Sa'Dax Senshali" && IsDead=FALSE](exists)}
		{
			Actor[Blue]:DoubleClick
			Actor[Red]:DoubleClick
			waitframe
		}
	}
	;unpause bots
	relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 0
	while ${Math.Distance[${Me.Y},-109.4]}>2 && ${Actor[Query, Name=="Sa'Dax Senshali" && IsDead=FALSE](exists)}
	{
		;if ${RI_Var_Bool_LockSpotting}
		;	RI_Var_Bool_LockSpotting:Set[FALSE]
		RI_Atom_SetLockSpot ALL OFF
		press -release ${RI_Var_String_ForwardKey}
		wait 5
		if !${Actor[platform](exists)}
		{
			press -hold ${RI_Var_String_ForwardKey}
			wait 2
			press -release ${RI_Var_String_ForwardKey}
		}
		elseif !${RI_Var_Bool_GlobalOthers}
			target platform
	}
	; if ${RI_Var_Bool_GlobalOthers}
		; RI_Var_Bool_MovingBehind:Set[TRUE]
	; else
		;RI_Var_Bool_LockSpotting:Set[TRUE]
	RI_Atom_SetLockSpot ALL 95 0 45 2 100
}
function _MoveC(float X1, float Z1, bool CheckDeath, bool TargetSelf)
{
	while ${Math.Distance[${Me.X},${Me.Z},${X1},${Z1}]}>2
	{
		RIMUIObj:SetLockSpot[${Me.Name},${X1},0,${Z1}]
		if ${CheckDeath}
			call RIMObj.checktoons
		if ${TargetSelf}
			Actor[${Me.ID}]:DoTarget
		call RIMObj.CheckPause
		wait 1
	}
}
function _Move3(float X1, float Y1, float Z1, bool CheckDeath=0, bool TargetSelf=0)
{
	RI_Atom_SetLockSpot ${Me.Name}
	wait 1
	RI_Atom_ChangeLockSpot ALL ${X1} 0 ${Z1}
	while ${Math.Distance[${Me.X},${Me.Z},${X1},${Z1}]}>2
	{
		if ${CheckDeath}
			call RIMObj.checktoons
		if ${TargetSelf}
			Actor[${Me.ID}]:DoTarget
		call RIMObj.CheckPause
		wait 1
	}
}
function Blackhand()
{
	if ${QuestJournalWindow.ActiveQuest[Awakening Bonds: Whispers of the Past](exists)}
		return
	echo ISXRI: Starting Blackhand v6
	
	RI_Atom_SetLockSpot ${Me.Name} 96.219154 -85.600647 -177.131744
	;target blackhand and turn on ranged auto
	if !${RI_Var_Bool_GlobalOthers}
		target blackhand
	while !${Me.RangedAutoAttackOn} && !${RI_Var_Bool_GlobalOthers}
	{
		eq2ex togglerangedattack
		wait 2
	}
	if !${RI_Var_Bool_GlobalOthers}
	{
		relay "other ${RI_Var_String_RelayGroup}" -noredirect call _MoveC 96.219154 -177.131744
		wait 2
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_SetLockSpot ALL OFF
		wait 5
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_MoveBehind ALL ${Actor["Gudre Blackhand"].ID} 50 100 ${Me.Name}
		wait 2
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_MoveBehind ALL ${Actor["Gudre Blackhand"].ID} 50 100 ${Me.Name}
		wait 2
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_MoveBehind ALL ${Actor["Gudre Blackhand"].ID} 50 100 ${Me.Name}
	}
	;if !${RI_Var_Bool_GlobalOthers} && !${Script[Blackhandaggro]}
	;	run "${LavishScript.HomeDirectory}/Scripts/RunInstances/BlackhandAggro.iss"
	;main loop
	do
	{
		if (${Me.GetGameData[Target.Casting].Label.Equal[Centien Favor]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[Centien Favor]})
			relay ${RI_Var_String_RelayGroup} -noredirect Actor[Blackhand]:DoubleClick
	}
	while ${Actor[Blackhand](exists)} && !${Actor[Blackhand].IsDead}
	if !${RI_Var_Bool_GlobalOthers}
	{
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_MoveBehind ALL OFF	
	}
}
;function to move to appropriate tapestry and burn it
function Tapestry()
{
	echo tapestry
	Trigger:Set[FALSE]
	;pause bots
	relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 1
	if ${RI_Var_Bool_GlobalOthers}
	{
		RI_Var_Bool_LockSpotting:Set[TRUE]
		RI_Var_Bool_MovingBehind:Set[FALSE]
	}
	;switch for which tapestry is active, then advance the count and move to and click tapestry then move back
	Switch ${Tapestry}
	{
		case 1
			call AdvanceCount
			call _MoveC ${Actor["Tapestry 1"].X} ${Actor["Tapestry 1"].Z}
			wait 2
			Actor["Tapestry 1"]:DoubleClick
			wait 15
			call _MoveC 95.84 -177.59
			break
		case 2
			call AdvanceCount
			call _MoveC ${Actor["Tapestry 2"].X} ${Actor["Tapestry 2"].Z}
			wait 2
			Actor["Tapestry 2"]:DoubleClick
			wait 15
			call _MoveC 95.84 -177.59
			break
		case 3
			call AdvanceCount
			call _MoveC ${Actor["Tapestry 3"].X} ${Actor["Tapestry 3"].Z}
			wait 2
			Actor["Tapestry 3"]:DoubleClick
			wait 15
			call _MoveC 95.84 -177.59
			break
		case 4
			call AdvanceCount
			call _MoveC ${Actor["Tapestry 4"].X} ${Actor["Tapestry 4"].Z}
			wait 2
			Actor["Tapestry 4"]:DoubleClick
			wait 15
			call _MoveC 95.84 -177.59
			break
		case 5
			call AdvanceCount
			call _MoveC ${Actor["Tapestry 5"].X} ${Actor["Tapestry 5"].Z}
			wait 2
			Actor["Tapestry 5"]:DoubleClick
			wait 15
			call _MoveC 95.84 -177.59
			break
		case 6
			call AdvanceCount
			call _MoveC ${Actor["Tapestry 6"].X} ${Actor["Tapestry 6"].Z}
			wait 2
			Actor["Tapestry 6"]:DoubleClick
			wait 15
			call _MoveC 95.84 -177.59
			break
		case 7
			call AdvanceCount
			call _MoveC ${Actor["Tapestry 7"].X} ${Actor["Tapestry 7"].Z}
			wait 2
			Actor["Tapestry 7"]:DoubleClick
			wait 15
			call _MoveC 95.84 -177.59
			break
		case 8
			call _MoveC 63 -155
			wait 2
			Actor[Tapestry]:DoubleClick
			wait 15
			call _MoveC 95.84 -177.59
			break
	}
	;unpause bots
	relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 0
	Trigger:Set[FALSE]
	if ${RI_Var_Bool_GlobalOthers}
	{
		RI_Var_Bool_LockSpotting:Set[FALSE]
		RI_Var_Bool_MovingBehind:Set[TRUE]
	}
}
function AdvanceCount()
{
	;increment tapestry
	if ${Tapestry}<8
		relay ${RI_Var_String_RelayGroup} -noredirect Tapestry:Inc
	else
		Tapestry:Set[8]
}
variable bool BipsieCasting=FALSE
function Bipsie()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert[Oh... boys! these scallywags are givin me a hard time... Do me a favor and sink them]
	echo ISXRI: Starting Bipsie v2
			
	;target her and turn on ranged auto
	target bipsie
	while !${Me.RangedAutoAttackOn}
	{
		eq2ex togglerangedattack
		wait 2
	}
	RI_Atom_SetLockSpot ${Me.Name} 50 0 -60 2 100
	;move to her and grab her
	if !${RI_Var_Bool_GlobalOthers}
		call _MoveToHerSpawnPoint
	wait 20

	
	do
	{
		if ${RI_Var_Bool_Debug}
			echo ${Time}:Main Loop
		;keep us in position where we are supposed to be
		if ${Math.Distance[${Me.X},${Me.Z},50,-60]}>2
			call _MoveC 50 -60
		if (${Me.GetGameData[Target.Casting].Label.Equal[Long Distance Relations]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[Long Distance Relations]})
		{
			;pause bots, turn off melee and ranged attacks
			;turn off auto attack, cancel casting and clear queue
				
			RI_CMD_PauseCombatBots 1
			press `
			eq2ex autoattack 0
			eq2ex cancel_spellcast
			eq2ex clearabilityqueue
			eq2ex target_none
			wait 2
			Target Bipsie
			BipsieCasting:Set[TRUE]
			TimedCommand 150 Script[${RI_Var_String_RunInstancesScriptName}].Variable[BipsieCasting]:Set[FALSE]
			call CheckBipsie
		}
		if ${Actor[brokenskull,radius,15](exists)} && !${Actor[brokenskull,radius,15].IsDead} && !${Trigger}
			Actor[brokenskull,radius,15]:DoTarget
		if ${Actor[rat,radius,15](exists)} && !${Actor[rat,radius,15].IsDead} && !${Trigger}
			Actor[rat,radius,15]:DoTarget
		if ${Trigger}
		{
			if ${RI_Var_Bool_Debug}
				echo ${Time}: Targeting Bipsie for 10s or Until she Starts Casting
			
			;pause bots, turn off melee and ranged attacks
			;turn off auto attack, cancel casting and clear queue
			RI_CMD_PauseCombatBots 1
			press `
			eq2ex autoattack 0
			eq2ex cancel_spellcast
			eq2ex clearabilityqueue
			eq2ex target_none
			wait 2
			Target Bipsie
			wait 100 ( ${Me.GetGameData[Target.Casting].Label.Equal[Long Distance Relations]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[Long Distance Relations]} )
			BipsieCasting:Set[TRUE]
			TimedCommand 150 Script[${RI_Var_String_RunInstancesScriptName}].Variable[BipsieCasting]:Set[FALSE]
			Trigger:Set[FALSE]
			if ${RI_Var_Bool_Debug}
				echo ${Time}: Bipsie has Started Casting, Moving to her location
			call CheckBipsie
		}
		wait 1
	}
	while ${Actor[Query, Name=-"Bipsie" && IsDead=FALSE](exists)}
	;unpause bots
	RI_CMD_PauseCombatBots 0
}
function CheckBipsie()
{
	wait 10
	if ${RI_Var_Bool_Debug}
		echo ${Time}:Function Check Bipse
	if ${Math.Distance[${Actor[Bipsie].X},${Actor[Bipsie].Z},47,23]}<15
		call _MoveToHerSpawnPoint
	elseif ${Math.Distance[${Actor[Bipsie].X},${Actor[Bipsie].Z},40,8]}<15
		call _MoveToBottomOfRampByCorner
	elseif ${Math.Distance[${Actor[Bipsie].X},${Actor[Bipsie].Z},44,-46]}<15
		call _MoveToTopOfRamp
	elseif ${Math.Distance[${Actor[Bipsie].X},${Actor[Bipsie].Z},57,-17]}<15
		call _MoveToRats
	elseif ${Math.Distance[${Actor[Bipsie].X},${Actor[Bipsie].Z},-14,-58]}<15
		call _MoveToOutlook
		
	;unpause bots
	RI_CMD_PauseCombatBots 0
}
function _MoveToTopOfRamp()
{
	if ${RI_Var_Bool_Debug}
		echo ${Time}: Moving to top of ramp
	call _MoveC 44 -46
	wait 5
	while ${BipsieCasting} && ${Actor[Query, Name=-"Bipsie" && IsDead=FALSE](exists)}
		wait 2
	wait 15
}
function _MoveToHerSpawnPoint()
{
	if ${RI_Var_Bool_Debug}
		echo ${Time}:Moving to her spawn
	call _MoveC 44 -46
	call _MoveC 38 7
	call _MoveC 47 8
	call _MoveC 47 23
	wait 5
	while ${BipsieCasting} && ${Actor[Query, Name=-"Bipsie" && IsDead=FALSE](exists)}
		wait 2
	wait 15
	call _MoveC 47 8
	call _MoveC 38 7
	call _MoveC 44 -46
}
function _MoveToBottomOfRampByCorner()
{
	if ${RI_Var_Bool_Debug}
		echo ${Time}:Moving to Bottom of Ramp by Corner
	call _MoveC 44 -46
	call _MoveC 40 8
	wait 5
	while ${BipsieCasting} && ${Actor[Query, Name=-"Bipsie" && IsDead=FALSE](exists)}
		wait 2
	wait 15
	call _MoveC 44 -46
}
function _MoveToRats()
{
	if ${RI_Var_Bool_Debug}
		echo ${Time}:Moving to rats
	call _MoveC 56 -47
	call _MoveC 57 -17
	wait 5
	while ${BipsieCasting} && ${Actor[Query, Name=-"Bipsie" && IsDead=FALSE](exists)}
		wait 2
	wait 15
	call _MoveC 56 -47
	
}
function _MoveToOutlook()
{
	if ${RI_Var_Bool_Debug}
		echo ${Time}:Moving to outlook
	call _MoveC -14 -58
	wait 5
	while ${BipsieCasting} && ${Actor[Query, Name=-"Bipsie" && IsDead=FALSE](exists)}
		wait 2
	wait 15
}
function Pheris()
{
	echo Running Pheris 
		
	RI_Atom_SetLockSpot ${Me.Name} -137 0 -24 2 100
	do
	{
		if ${Math.Distance[${Actor["Praetor Pheris"].X},${Actor["Praetor Pheris"].Z},-148,32]}<6
			call _MoveToSouth
		elseif ${Math.Distance[${Actor["Praetor Pheris"].X},${Actor["Praetor Pheris"].Z},-148,-80]}<6
			call _MoveToNorth
		wait 1
	}
	while ${Actor["Praetor Pheris"](exists)} && !${Actor["Praetor Pheris"].IsDead}
}
function _MoveToSouth()
{
	if ${RI_Var_Bool_Debug}
		echo ${Time}: Moving to South Cubby
	call _MoveC -137 15 TRUE
	call _MoveC -148 32 TRUE
	wait 100
	call _MoveC -137 15
	call _MoveC -137 -24
	wait 100
}
function _MoveToNorth()
{
	if ${RI_Var_Bool_Debug}
		echo ${Time}: Moving to North Cubby
	call _MoveC -137 -64 TRUE
	call _MoveC -148 -80 TRUE
	wait 100
	call _MoveC -137 -64
	call _MoveC -137 -24
	wait 100
}
function Verish()
{
	echo Running Verish 
	
	Actor["Elder Senistus Verish"]:DoTarget
	wait 20
	if !${RI_Var_Bool_GlobalOthers}
	{
			RI_Atom_SetLockSpot ${Me.Name} -205 -24 -24 1 100
			relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[1].Name} -208 -24 -14 1 100
			relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[2].Name} -197 -24 -18 1 100
			relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[3].Name} -198 -24 -30 1 100
			relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[4].Name} -209 -24 -34 1 100
			relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[5].Name} -216 -24 -24 1 100
	}
	
	do
	{
		if ${Target.ID}!=${Actor["Elder Senistus Verish"].ID}
			Actor["Elder Senistus Verish"]:DoTarget
		wait 1
	}
	while ${Actor["Elder Senistus Verish"](exists)}
}
function Ursher()
{
	echo Running Ursher 
	
	PerisID:Set[${Actor["Peris K'dal"].ID}]
	AchionID:Set[${Actor["Achiun K'dal"].ID}]
	UrsherID:Set[${Actor["Ursher K'dal"].ID}]
	;turn off assisting
	RI_CMD_Assisting 0
	
	if !${RI_Var_Bool_GlobalOthers}
	{
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_MoveBehind ALL ${UrsherID} 30 100 ${Me.Name}
		RI_Atom_SetLockSpot ${Me.Name} -320 0 -21 2 100
	}
	Actor[id,${UrsherID}]:DoTarget
	do
	{
		while (${Me.Archetype.Equal[priest]} || ${Me.SubClass.Equal[dirge]} || ${Me.SubClass.Equal[necromancer]} || ${Me.SubClass.Equal[paladin]}) && (${Me.Group[1].IsDead} || ${Me.Group[2].IsDead} || ${Me.Group[3].IsDead} || ${Me.Group[4].IsDead} || ${Me.Group[5].IsDead})
			wait 1
		
		if ${Actor[id,${PerisID}](exists)} && !${Actor[id,${PerisID}].IsDead}
		{
			if ${Target.ID}!=${PerisID} 
				Actor[id,${PerisID}]:DoTarget
			;RI_Var_Int_MoveBehindMobID:Set[${PerisID}]
		}
		elseif ${Actor[id,${AchionID}](exists)} && !${Actor[id,${AchionID}].IsDead}
		{
			if ${Target.ID}!=${AchionID}
				Actor[id,${AchionID}]:DoTarget
			;RI_Var_Int_MoveBehindMobID:Set[${AchionID}]
		}
		elseif ${Actor[id,${UrsherID}](exists)}
		{
			if ${Target.ID}!=${UrsherID}
				Actor[id,${UrsherID}]:DoTarget
			;RI_Var_Int_MoveBehindMobID:Set[${UrsherID}]
		}
		wait 1
	}
	while ${Actor[id,${UrsherID}](exists)} && !${Actor[id,${UrsherID}].IsDead}
	
	;turn on assisting
	RI_CMD_Assisting 1
}
function Valdimus()
{
	AltoID:Set[${Actor["Malice Alto"].ID}]
	BassID:Set[${Actor["Malice Bass"].ID}]
	SopranoID:Set[${Actor["Malice Soprano"].ID}]
	TenorID:Set[${Actor["Malice Tenor"].ID}]
	ValdimusID:Set[${Actor["Valdimus V'Derun"].ID}]
	
	if !${RI_Var_Bool_GlobalOthers}
	{
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_MoveBehind ALL ${ValdimusID} 30 99 ${Me.Name}
		RI_Atom_SetLockSpot ${Me.Name} -504.978699 0.643444 -23.940384 2 100
	}

	do
	{
		while (${Me.Archetype.Equal[priest]} || ${Me.SubClass.Equal[dirge]} || ${Me.SubClass.Equal[necromancer]} || ${Me.SubClass.Equal[paladin]}) && (${Me.Group[1].IsDead} || ${Me.Group[2].IsDead} || ${Me.Group[3].IsDead} || ${Me.Group[4].IsDead} || ${Me.Group[5].IsDead})
			wait 1
		if !${RI_Var_Bool_GlobalOthers}
		{
			; if ${Actor[id,${AltoID}].Health}>20
			; {
				; if ${Target.ID}!=${AltoID} 
					; Actor[id,${AltoID}]:DoTarget
				; relay ${RI_Var_String_RelayGroup} -noredirect RI_Var_Int_MoveBehindMobID:Set[${AltoID}]
			; }
			; elseif ${Actor[id,${BassID}].Health}>15
			; {
				; if ${Target.ID}!=${BassID}
					; Actor[id,${BassID}]:DoTarget
				; relay ${RI_Var_String_RelayGroup} -noredirect RI_Var_Int_MoveBehindMobID:Set[${BassID}]
			; }
			; elseif ${Actor[id,${SopranoID}].Health}>10
			; {
				; if ${Target.ID}!=${SopranoID}
					; Actor[id,${SopranoID}]:DoTarget
				; relay ${RI_Var_String_RelayGroup} -noredirect RI_Var_Int_MoveBehindMobID:Set[${SopranoID}]
			; }
			; elseif ${Actor[id,${TenorID}].Health}>5
			; {
				; if ${Target.ID}!=${TenorID}
					; Actor[id,${TenorID}]:DoTarget
				; relay ${RI_Var_String_RelayGroup} -noredirect RI_Var_Int_MoveBehindMobID:Set[${TenorID}]
			; }
			; else
			; {
				if ${Target.ID}!=${ValdimusID}
					Actor[id,${ValdimusID}]:DoTarget
				relay ${RI_Var_String_RelayGroup} -noredirect RI_Var_Int_MoveBehindMobID:Set[${ValdimusID}]
			;}
		}
		wait 1
	}
	while ${Actor[id,${ValdimusID}](exists)} && !${Actor[id,${ValdimusID}].IsDead}
}
function Kaimanu()
{
	RI_Atom_SetLockSpot ALL -3395.301270 17.157639 -140.931152 2 100
	do
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor["Obsidian Warrior Koa"].ID} && ${Actor["Obsidian Warrior Koa"](exists)} && !${Actor["Obsidian Warrior Koa"].IsDead}
				Actor["Obsidian Warrior Koa"]:DoTarget
			elseif ${Target.ID}!=${Actor["Lavacrafter Peleaina"].ID} && ${Actor["Lavacrafter Peleaina"](exists)} && !${Actor["Lavacrafter Peleaina"].IsDead} && !${Actor["Obsidian Warrior Koa"](exists)}
				Actor["Lavacrafter Peleaina"]:DoTarget
		}
		wait 1
	}
	while ( ${Actor["Obsidian Warrior Koa"](exists)} && !${Actor["Obsidian Warrior Koa"].IsDead} )|| ( ${Actor["Lavacrafter Peleaina"](exists)} && !${Actor["Lavacrafter Peleaina"].IsDead} )
	;move to Augur
	RI_Atom_ChangeLockSpot ALL -3405.95 18.18 -159.69
	wait 50 ${Math.Distance[${Me.Loc},-3405.95,18.18,-159.69]}<2
	RI_Atom_ChangeLockSpot ALL -3415.95 18.18 -158.69
	do
	{
		if ${Target.ID}!=${Actor["Augur Kaimanu"].ID} && ${Actor["Augur Kaimanu"](exists)} && !${RI_Var_Bool_GlobalOthers}
			Actor["Augur Kaimanu"]:DoTarget
		wait 1
	}
	while ${Actor["Augur Kaimanu"](exists)} && !${Actor["Augur Kaimanu"].IsDead}
}

function Clotl'thoa()
{
	RI_Atom_SetLockSpot ALL -3334.001270 11.490292 76.188400 1 100
	if ${RI_Var_Bool_GlobalOthers}
		return
	RI_Atom_ChangeLockSpot ALL -3337.714844 11.281310 91.941048
	wait 10
	RI_Atom_ChangeLockSpot ALL -3334.001270 11.490292 76.188400
	wait 30
	do
	{	
		;initialize actor Fiery Effigy of Clotl'thoa's effects.
		;Actor["Fiery Effigy of Clotl'thoa"]:InitializeEffects

		;wait 2 while we are initializing effects`
		while ${ISXEQ2.InitializingActorEffects}
			wait 5
		;while Lavatar on Fiery Effigy of Clotl'thoa is less than 9 increments
		while ${Actor["Fiery Effigy of Clotl'thoa"].Effect[1].CurrentIncrements}<8 && ${Actor["Fiery Effigy of Clotl'thoa"](exists)} 
		{
			;if ${Math.Distance[]}>2
				RI_Atom_ChangeLockSpot ALL -3338.872559 10.002500 86.951920
			if ${Target.ID}!=${Actor["Fiery Effigy of Clotl'thoa"].ID} && ${Actor["Fiery Effigy of Clotl'thoa"](exists)} && !${RI_Var_Bool_GlobalOthers}
				Actor["Fiery Effigy of Clotl'thoa"]:DoTarget
			wait 5
		}
		;while Lavatar increments are greater than 0
		while ${Actor["Fiery Effigy of Clotl'thoa"].Effect[1].CurrentIncrements}>0 && ${Actor["Fiery Effigy of Clotl'thoa"](exists)} 
		{
			;if ${Math.Distance[]}>2
				RI_Atom_ChangeLockSpot ALL -3327.887939 10.002500 63.727303
			if ${Actor[fanatic,radius,35](exists)} && !${Actor[fanatic,radius,35].IsDead}
				target fanatic
			elseif ${Actor[hunter,radius,15](exists)} && !${Actor[hunter,radius,15].IsDead}
				target hunter
			elseif ${Actor[lavacrafter,radius,15](exists)} && !${Actor[lavacrafter,radius,15].IsDead}
				target lavacrafter
			elseif ${Target.ID}!=${Actor["Fiery Effigy of Clotl'thoa"].ID} && ${Actor["Fiery Effigy of Clotl'thoa"](exists)}
				Actor["Fiery Effigy of Clotl'thoa"]:DoTarget
			wait 5
		}
		wait 5
	}
	while ${Actor["Fiery Effigy of Clotl'thoa"](exists)} && !${Actor["Fiery Effigy of Clotl'thoa"].IsDead}
	RI_Atom_ChangeLockSpot ALL -3334.001270 11.490292 76.188400
	wait 30
}
function Bitterman()
{
	AnnounceText:Clear
	AnnounceText:Insert["has a gross barnacle growing on their neck"]
	if !${RI_Var_Bool_GlobalOthers}
	{
		RI_Atom_SetLockSpot ${Me.Name} 1.62 17.330944 -35.689749 2 100
		while ${Actor[Query, Name=="Barnacle Bitterman" && IsDead=FALSE].Distance}>10
		{
			if ${Target.ID}!=${Actor["Barnacle Bitterman"].ID}
				Actor["Barnacle Bitterman"]:DoTarget
			wait 1
		}
		RI_Atom_SetLockSpot ${Me.Name} -23.322641 17.330944 -36.689749 2 100
		wait 100 ${Math.Distance[${Me.Loc},-23.322641,17.330944,-36.689749]}<2
		wait 100 ${Actor["Barnacle Bitterman"].Distance}<10
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_MoveBehind ALL ${Actor["Barnacle Bitterman"].ID} 30 99 ${Me.Name}
	}
	while ${Actor[Query, Name=="Barnacle Bitterman" && IsDead=FALSE](exists)} && ${Start}
	{
		if ${Trigger}
		{
			;echo ${Time}: Saw Announce, Waiting for a barnacle to appear
			wait 50 ${Actor["a barnacle"](exists)}
			;echo ${Time}: Saw a barnacle, targeting
			eq2ex target "a barnacle"
			;echo ${Time}: Waiting while a barnacle exists or is dead
			wait 100 !${Actor["a barnacle"](exists)} || ${Actor["a barnacle"].IsDead}
			;echo ${Time}: a barnacle is gone.
			Trigger:Set[FALSE]
		}
		elseif !${RI_Var_Bool_GlobalOthers}
			Actor["Barnacle Bitterman"]:DoTarget
		;if ${TargetID}!=${Target.ID} && ${Target.ID}!=0
		wait 1
	}
}
function D'Nari()
{
	AnnounceText:Clear
	AnnounceText:Insert["You feel a chill"]
	Trigger:Set[FALSE]
	RI_Atom_SetLockSpot ALL 260 0 -10 2 100
	wait 20
	if !${RI_Var_Bool_GlobalOthers}
		Target Sculpted
	wait 10
	while ${Actor["D'Nari"](exists)} && !${Actor["D'Nari"].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor["D'Nari"].ID}
				Actor["D'Nari"]:DoTarget
			if ${Trigger}
			{
				Trigger:Set[FALSE]
				if ${Math.Distance[${Me.X},${Me.Z},260,-10]}<10
					relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_ChangeLockSpot ALL 260 0 -35
				if ${Math.Distance[${Me.X},${Me.Z},260,-35]}<10
					relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_ChangeLockSpot ALL 260 0 -10
				wait 30
			}
		}
		if ${Me.SubClass.Equal[coercer]} && ${Me.Ability[Silence VII].IsReady}
		{
			;pause bots
			RI_CMD_PauseCombatBots 1
			
			;cancel spellcast and clear ability queue
			eq2ex cancel_spellcast
			eq2ex clearabilityqueue 
			;wait until we are not casting
			wait 200 !${Me.CastingSpell}
			
			;keep attempting to cast Silence VII until it is no longer ready (aka casted)
			do
			{
				Me.Ability["Silence VII"]:Use
				waitframe
			}
			while ${Me.Ability["Silence VII"].IsReady}
			
			;wait until we are not casting
			wait 200 !${Me.CastingSpell}
			
			;unpause bots
			RI_CMD_PauseCombatBots 0
		}
		wait 2
	}
}
function BilgewaterSigCheck()
{
	if ${QuestJournalWindow.ActiveQuest[Shattered Seas: Pirates' Plot](exists)}
	{
		call _Move3 -29.273731 120.691887 -243.175934
		wait 50
		Actor["treasure chest"]:DoubleClick
		wait 50
		call _Move3 29.190001 146.789993 -432.470001
		call _Move3 19.200871 146.794250 -431.640961
		call _Move3 9.285765 145.558548 -432.394592
		call _Move3 0.140608 146.540344 -436.983978
		call _Move3 -9.566537 148.135559 -438.805328
		call _Move3 -18.144396 146.794250 -436.691406
		CustomLoc:Set["0 0 0"]
		call ClickActor exp11_sig_ts_x3_shissar_artifact
		call _Move3 -18.144396 146.794250 -436.691406
		wait 20
		call _Move3 -18.144396 146.794250 -436.691406
		CustomLoc:Set["0 0 0"]
		call UseItem "Ancient Arcane Artifact"
		call _Move3 -18.144396 146.794250 -436.691406
		CustomLoc:Set["0 0 0"]
		call ReplyDialog 1 1 1
		call _Move3 -18.144396 146.794250 -436.691406
		wait 50
		call _Move3 -8.516136 146.865738 -433.447266
		call _Move3 1.124704 147.371826 -430.521515
		call _Move3 11.027602 146.794266 -429.241058
		call _Move3 21.025633 146.794250 -431.802307
		call _Move3 29.013916 146.794250 -431.079285
		wait 50
		Actor["treasure chest"]:DoubleClick
		wait 50
		call _Move3 -20.169353 120.691895 -251.030228
	}
}
function Bilgewater()
{
	if !${RI_Var_Bool_GlobalOthers}
		RI_Atom_SetLockSpot ${Me.Name} 125 149.59 -361.48 2 100 ${Me.Name}
	else
		RI_Atom_MoveBehind ALL ${Actor["Captain Berlon Bilgewater"].ID} 100 100
	while ${Actor["Captain Berlon Bilgewater"](exists)} && !${Actor["Captain Berlon Bilgewater"].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor["a skeletal crew member"](exists)}
				Actor["a skeletal crew member"]:DoTarget
			elseif ${Target.ID}!=${Actor["Captain Berlon Bilgewater"].ID} 
				Actor["Captain Berlon Bilgewater"]:DoTarget
		}
		wait 1
	}
}
function Cruikshank()
{
	RI_Atom_SetLockSpot ${Me.Name} -166.73 7.62 -160.22 2 100
	
	while ${Actor["Torturer Cruikshank the Mad"](exists)} && !${Actor["Torturer Cruikshank the Mad"].IsDead}
	{
		if ${Math.Distance[${Me.Loc},-166.73,7.62,-160.22]}>5
			press ${RI_Var_String_JumpKey}
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor["Torturer Cruikshank the Mad"].ID} 
				Actor["Torturer Cruikshank the Mad"]:DoTarget
		}
		wait 1
	}
	press ${RI_Var_String_JumpKey}
	wait 2
	press ${RI_Var_String_JumpKey}
}
function Krasnok()
{
	echo ISXRI: Starting Krasnok 
	
	;turn on lockspot
	RI_Atom_SetLockSpot ${Me.Name} -309.81 15.26 -83.11 2 100
	
	;if i am a fighter target captain
	if !${RI_Var_Bool_GlobalOthers}
		Actor["Captain Krasnok the Immortal"]:DoTarget
		
	;wait until we are at camp
	wait 500 ${Math.Distance[${Me.Loc},-309.81,15.26,-83.11]}<3
	
	;if i am a bard move cannons
	if ${Me.Class.Equal[bard]}
		call _MoveCannons
		
	;while captain exists and is alive
	while ${Actor["Captain Krasnok the Immortal"](exists)} && !${Actor["Captain Krasnok the Immortal"].IsDead}
	{
		;if i am a bard and cannoneer exists, get cannonball and find and kill them
		if ${Me.Class.Equal[bard]} && ${Actor["Bloodskull Cannoneer"](exists)}
		{
			call GetCannonBall
			call FindCannoneerAndKill
		}
		
		;if i am a fighter target crewmembers then captain
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor["a Brokenskull crewmember"](exists)}
				Actor["a Brokenskull crewmember"]:DoTarget
			elseif ${Target.ID}!=${Actor["Torturer Cruikshank the Mad"].ID} 
				Actor["Torturer Cruikshank the Mad"]:DoTarget
		}
		wait 1
	}
	echo Ending Krasnok
}
function FindCannoneerAndKill()
{
	declare CannoneerX int ${Actor["Bloodskull Cannoneer"].X}
	switch ${CannoneerX}
	{
		case -307
		{
			call KillCannoneer -302.96 -99.02
			break
		}
		case -262
		{
			call KillCannoneer -286.70 -84.10
			break
		}
		case -282
		{
			call KillCannoneer -301.16 -68.67
			break
		}
		case -347
		{
			call KillCannoneer -329.67 -72.20
			break
		}
		case -366
		{
			call _MoveC -335.53 -61.68
			call _MoveC -339.36 -58.03
			call _MoveC -334.21 -53.06
			call _MoveC -343.31 -48.07
			call _MoveC -343.28 -44.36
			wait 10
			Face -341.76 -45.42
			wait 10
			call KillCannoneer -341.76 -45.42
			break
		}
		case -303
		{
			call KillCannoneer -319.51 -53.92
			break
		}
	}
}
function KillCannoneer(float kcX, float kcZ)
{
	;move to Cannon
	call _MoveC ${kcX} ${kcZ}
	
	wait 5
	
	;load and fire cannon
	eq2ex apply_verb ${Actor["a cannon"].ID} "Load Cannon"
	wait 10
	eq2ex apply_verb ${Actor["a cannon"].ID} "Fire Cannon"
	wait 10
	
	;move back to camp
	call _MoveC -309.81 -83.11
	
	;turn on assisting
	RI_CMD_Assisting 1
	
	;wait 15s
	wait 150
}
function GetCannonBall()
{
	;turn off assisting
	RI_CMD_Assisting 0
	
	;target self
	Actor[${Me.ID}]:DoTarget

	if !${Me.Inventory["a heavy cannonball"](exists)}
	{
		;move to cannonball
		call _MoveC -311.85 -74.5
		
		;get cannonball
		while !${Me.Inventory["a heavy cannonball"](exists)}
		{
			Actor[cannonballs]:DoubleClick
			wait 5
		}
				
		;move back to camp
		call _MoveC -309.81 -83.11
	}
}
function _MoveCannons()
{
	;turn off assisting
	RI_CMD_Assisting 0
	
	;target self
	Actor[${Me.ID}]:DoTarget
	
	;move cannon1
	call _MoveCannon	-301.40 -98.80 -302.96 -99.02
	
	;move cannon2
	call _MoveCannon -288.70 -87.26 -286.70 -84.10
	
	;move cannon3
	call _MoveCannon -309.65 -70.37 -301.16 -68.67 
	
	;move cannon4
	call _MoveCannon -315.13 -75.17 -329.67 -72.20
	
	;move cannon5
	;move to cannon
	call _MoveC -331.23 -62.59
	
	;change camera, pick up Cannon
	Press -hold ${RI_Var_String_LookDownKey}
	wait 5
	Actor["a cannon"]:DoubleClick
	wait 5
	
	;move to and face position
	call _MoveC -335.53 -61.68
	call _MoveC -339.36 -58.03
	call _MoveC -334.21 -53.06
	call _MoveC -343.31 -48.07
	call _MoveC -343.28 -44.36
	wait 10
	Face -341.76 -45.42
	wait 10
	
	;move mouse to just above center of screen aka on top of you and up
	Mouse:SetPosition[${Math.Calc[${Display.Width}/2]},${Math.Calc[(${Display.Height}/2)-((${Display.Height}/2)*.1)]}]
	wait 2
	
	;click to place
	Mouse:LeftClick
	
	wait 10
	
	;move cannon6
	call _MoveCannon -328.29 -57.28 -319.51 -53.92
	
	;turn on assisting
	RI_CMD_Assisting 1
	
	wait 5
	Press -release ${RI_Var_String_LookDownKey}
	Press -hold ${RI_Var_String_LookUpKey}
	wait 2
	Press -release ${RI_Var_String_LookUpKey}
	
	;move back to camp
	call _MoveC -309.81 -83.11

}
function _MoveCannon(float mcX, float mcZ, float mcX2, float mcZ2)
{
	echo Moving To ${mcX} ${mcZ} and Placing Cannon at {mcX2} ${mcZ2}
	;move to cannon
	call _MoveC ${mcX} ${mcZ}
	
	;change camera, pick up Cannon
	Press -hold ${RI_Var_String_LookDownKey}
	wait 5
	Actor["a cannon"]:DoubleClick
	wait 5
	
	;move to and face position
	call _MoveC ${mcX2} ${mcZ2}
	Face ${mcX2} ${mcZ2}
	wait 10
	
	;move mouse to just above center of screen aka on top of you and up
	Mouse:SetPosition[${Math.Calc[${Display.Width}/2]},${Math.Calc[(${Display.Height}/2)-((${Display.Height}/2)*.1)]}]
	wait 2
	
	;click to place
	Mouse:LeftClick
	
	wait 10
}
function K'Deru()
{
	if ${RI_Var_Bool_GlobalOthers}
		RI_Atom_MoveBehind ALL ${Actor["K'Deru"].ID} 100 100
	else
		RI_Atom_MoveBehind ALL ${Actor["K'Deru"].ID} 100 100
	while ${Actor["K'Deru"](exists)} && !${Actor["K'Deru"].IsDead}
	{
		if ${Target.ID}!=${Actor["K'Deru"].ID} && !${RI_Var_Bool_GlobalOthers}
			Actor["K'Deru"]:DoTarget
		wait 1
	}
}
;
;
;;;;;; Ossuary: Sanguine Fountains
;
;
function Sanguine()
{
	;if we are mage turn off absorb magic in bots
	if ${Me.Archetype.Equal[mage]}
		RI_CMD_AbilityEnableDisable "Absorb Magic" 0
	;set announce trigger
	AnnounceText:Clear
	AnnounceText:Insert[The Sanguine Fiend aims his splinters]
	RI_Atom_SetLockSpot all 70 0 -24 2 100
	wait 20
	variable int _SanguineID=${Actor["The Sanguine Fiend"].ID}
	if ${RI_Var_Bool_GlobalOthers}
	{
		RI_Atom_SetLockSpot off
		RI_Atom_MoveBehind ALL ${Actor["The Sanguine Fiend"].ID} 100 99
	}
	while ${Actor["The Sanguine Fiend"](exists)} && !${Actor["The Sanguine Fiend"].IsDead}
	{
		if ${Actor[welp](exists)} && !${Actor[welp].IsDead} && !${RI_Var_Bool_GlobalOthers}
		{
			Actor[welp]:DoTarget
			if ( ${Math.Distance[${Actor[welp].X},${Actor[welp].Z},91,-52]}<10 || ${Math.Distance[${Actor[welp].X},${Actor[welp].Z},91,2]}<10 )
			{
				RI_Atom_ChangeLockSpot ALL 82.68 -0.46 -23.51
				while ${Actor[welp](exists)}
					wait 1
				RI_Atom_ChangeLockSpot ALL 70 0 -24
			}
			while ${Actor[welp](exists)}
				wait 1
		}
		elseif ${Actor["a Sanguine Fiend",radius,20](exists)} && !${Actor["a Sanguine Fiend",radius,20].IsDead} && !${RI_Var_Bool_GlobalOthers}
			Actor["a Sanguine Fiend",radius,20]:DoTarget
		elseif ${Target.ID}!=${Actor["The Sanguine Fiend"].ID} && !${RI_Var_Bool_GlobalOthers}
			Actor["The Sanguine Fiend"]:DoTarget
		if ${Trigger} && ${RI_Var_Bool_GlobalOthers}
		{
			Trigger:Set[FALSE]
			echo ${TriggerMessage}
			if ${TriggerMessage.Equal[The Sanguine Fiend aims his splinters behind him! WATCHOUT!]}
			{
				echo moving in front
				RI_Atom_SetLockSpot off
				RI_Atom_MoveBehind ALL OFF
				RI_Atom_MoveInFront ALL ${Actor["The Sanguine Fiend"].ID} 100 100
			}
			if ${TriggerMessage.Equal[The Sanguine Fiend aims his splinters in front of him! WATCHOUT!]}
			{
				echo Moving behind
				RI_Atom_SetLockSpot off
				RI_Atom_MoveInFront ALL OFF
				RI_Atom_MoveBehind ALL ${Actor["The Sanguine Fiend"].ID} 100 100
			}
			if ${TriggerMessage.Equal[The Sanguine Fiend aims his splinters far from him! WATCHOUT!]} && ${Actor["The Sanguine Fiend"].Distance}>10
			{
				RI_Atom_SetLockSpot off
				RI_Atom_MoveBehind ALL OFF
				RI_Atom_MoveInFront ALL OFF
				echo moving close
				while ${Actor["The Sanguine Fiend"].Distance}>4
				{
					Actor["The Sanguine Fiend"]:DoFace
					press -hold ${RI_Var_String_ForwardKey}
					wait 1
				}
				press -release ${RI_Var_String_ForwardKey}
			}
			if ${TriggerMessage.Equal[The Sanguine Fiend aims his splinters close to him! WATCHOUT!]} && ${Actor["The Sanguine Fiend"].Distance}<10
			{
				RI_Atom_SetLockSpot off
				RI_Atom_MoveBehind ALL OFF
				RI_Atom_MoveInFront ALL OFF
				echo moving away
				while ${Actor["The Sanguine Fiend"].Distance}<16
				{
					Actor["The Sanguine Fiend"]:DoFace
					press -hold ${RI_Var_String_BackwardKey}
					wait 1
				}
				press -release ${RI_Var_String_BackwardKey}
			}
			TimedCommand 120 RI_Atom_MoveBehind ALL ${Actor["The Sanguine Fiend"].ID} 100 99
		}
		;if we are a mage watch for hardened bones and cast absorb magic
		if ${Me.Archetype.Equal[mage]}
		{
		
			;if we see "hardened bones" (MainIconID=) on "The Sanguine Fiend", pause bot, stop casting and cast Absorb Magic
			if ${RIObj.MainIconIDExists[${_SanguineID},]} && ${Me.Ability[id,1812025739].IsReady}
			{
				;turn off assisting
				RI_CMD_Assisting 0
				
				;pause bots
				RI_CMD_PauseCombatBots 1
				
				;target "The Sanguine Fiend"
				Actor[Query, ID="${_SanguineID}"]:DoTarget
				
				;cancel spellcast and clear ability queue
				eq2ex cancel_spellcast
				eq2ex clearabilityqueue 
				
				;wait until we are not casting
				wait 200 !${Me.CastingSpell}
				
				;keep attempting to cast absorb magic (ID=1812025739) until it is no longer ready (aka casted)
				do
				{
					if ${Target.ID}==${_SanguineID}
						Me.Ability[id,1812025739]:Use
					else
						Actor[Query, ID="${_SanguineID}"]:DoTarget
					wait 1
				}
				while ${Me.Ability[id,1812025739].IsReady}
				
				;wait until we are not casting
				wait 200 !${Me.CastingSpell}
				
				;turn on assisting
				RI_CMD_Assisting 1
				
				;unpause bots
				RI_CMD_PauseCombatBots 0
			}
		}
		wait 5
	}
	;if we are mage turn on absorb magic
	if ${Me.Archetype.Equal[mage]}
		RI_CMD_AbilityEnableDisable "Absorb Magic" 1
}
function V'Raudin()
{
	if ${Me.Ability[Singular Focus].IsReady}
		Me.Ability[Singular Focus]:Use
	elseif ${Me.Ability[Focus Offensive].IsReady}
		Me.Ability[Focus Offensive]:Use
	wait 20
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert[screams at]
	RI_Atom_SetLockSpot ${Me.Name} 414 -11 -24 2 100
	call _MoveC 414 -24
	if ${RI_Var_Bool_GlobalOthers}
	{
		RI_Atom_SetLockSpot OFF
		RI_Atom_MoveBehind ALL ${Actor["V'Raudin"].ID} 30 99
	}
	wait 20
	;if we are an enchanter, disable manasoul in ogre for 60s
	; if ${Me.Class.Equal[enchanter]}
	; {
		; OgreBotAtom aExecuteAtom ${Me.Name} a_QueueCommand ChangeCastStackListBoxItem "Manasoul" FALSE
		; TimedCommand 600 OgreBotAtom aExecuteAtom ${Me.Name} a_QueueCommand ChangeCastStackListBoxItem "Manasoul" TRUE
	; }
	while ${Actor["V'Raudin"](exists)} && !${Actor["V'Raudin"].IsDead}
	{
		if ${Trigger} && ${Me.Class.Equal[enchanter]}
		{
			echo ${Time}: Found Trigger: ${TriggerMessage}: Casting Mana Flow on ${TriggerMessage.Left[${Math.Calc[${TriggerMessage.Find[screams]}-2]}]}
			Trigger:Set[FALSE]
			
			;pause bots
			RI_CMD_PauseCombatBots 1
			
			;cancel spellcast and clear ability queue
			eq2ex cancel_spellcast
			eq2ex clearabilityqueue 
			
			;wait until we are not casting
			wait 200 !${Me.CastingSpell}
			
			;keep attempting to cast Manasoul until it is no longer ready (aka casted)
			do
			{
				;eq2ex useabilityonplayer ${TriggerMessage.Left[${Math.Calc[${TriggerMessage.Find[screams]}-2]}]} "Mana Flow"
				Me.Ability[Manasoul]:Use
				wait 1
			}
			while ${Me.Ability["Manasoul"].IsReady}
			
			;wait until we are not casting
			wait 200 !${Me.CastingSpell}
			
			;unpause bots
			RI_CMD_PauseCombatBots 0
		}
		if ${Target.ID}!=${Actor["V'Raudin"].ID} && !${RI_Var_Bool_GlobalOthers}
			Actor["V'Raudin"]:DoTarget
	}
	Me.Maintained[Singular Focus]:Cancel
	Me.Maintained[Focused Offensive]:Cancel
}
function Embodiment()
{
	;if we are mage turn off absorb magic
	if ${Me.Archetype.Equal[mage]}
		RI_CMD_AbilityEnableDisable "Absorb Magic" 0
		
	;set lockspots
	RI_Atom_SetLockSpot ALL 498.28 -0.05 -27.28 2 100
	wait 20
	call _MoveC 517.60 -66.26
	if ${RI_Var_Bool_GlobalOthers}
		RI_Atom_ChangeLockSpot ALL 511.39 -0.05 -53.79
	wait 20		
	variable int _EmbodimentID=${Actor["Embodiment"].ID}
	;while Emodiment exists and is not dead, target him or his adds if there up and absorb Enriched Blood
	while ${Actor["Embodiment"](exists)} && !${Actor["Embodiment"].IsDead}
	{
		while ${Actor["sanguine spray",radius,30](exists)} && !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor["sanguine spray",radius,30].IsDead}
			{
				Actor["sanguine spray",radius,30]:DoubleClick
				eq2ex apply_verb ${Actor["sanguine spray",radius,30].ID} Loot
			}
			RI_Atom_ChangeLockSpot ALL 511.39 -0.05 -53.79
			Actor["sanguine spray",radius,30]:DoTarget
			wait 2
		}
		if !${RI_Var_Bool_GlobalOthers}
		{
			RI_Atom_ChangeLockSpot ALL 517.60 -0.47 -66.26
			if ${Target.ID}!=${Actor["Embodiment"].ID} && !${RI_Var_Bool_GlobalOthers}
				Actor["Embodiment"]:DoTarget
		}
		;if we are a mage watch for Enriched Blood and cast absorb magic
		if ${Me.Archetype.Equal[mage]}
		{
		
			;if we see "Enriched Blood" (MainIconID=) on "The Embodiment of Gore", pause bot, stop casting and cast Absorb Magic
			if ${RIObj.MainIconIDExists[${_EmbodimentID},]} && ${Me.Ability[id,1812025739].IsReady}
			{
				;turn off assisting
				RI_CMD_Assisting 0
				
				;pause bots
				RI_CMD_PauseCombatBots 1
				
				;target "The Sanguine Fiend"
				Actor[Query, ID="${_EmbodimentID}"]:DoTarget
				
				;cancel spellcast and clear ability queue
				eq2ex cancel_spellcast
				eq2ex clearabilityqueue 
				
				;wait until we are not casting
				wait 200 !${Me.CastingSpell}
				
				;keep attempting to cast absorb magic (ID=1812025739) until it is no longer ready (aka casted)
				do
				{
					if ${Target.ID}==${_SanguineID}
						Me.Ability[id,1812025739]:Use
					else
						Actor[Query, ID="${_EmbodimentID}"]:DoTarget
					wait 1
				}
				while ${Me.Ability[id,1812025739].IsReady}
				
				;wait until we are not casting
				wait 200 !${Me.CastingSpell}
				
				;turn on assisting
				RI_CMD_Assisting 1
				
				;unpause bots
				RI_CMD_PauseCombatBots 0
			}
		}
		wait 5
	}
	;if we are mage turn on absorb magic
	if ${Me.Archetype.Equal[mage]}
		RI_CMD_AbilityEnableDisable "Absorb Magic" 1
}
function BosunRing()
{
	if !${RI_Var_Bool_GlobalOthers}
		relay ${RI_Var_String_RelayGroup} RI_Atom_SetLockSpot ALL -305.27 -123.61 -317.21
	while !${Actor[Bosun](exists)}
	{
		if ${Actor["Garrut Berogg"](exists)} && !${Actor["Garrut Berogg"].IsDead}
		{
			if ${Target.ID}!=${Actor["Garrut Berogg"].ID}
				Actor["Garrut Berogg"]:DoTarget
		}
		elseif ${Actor["a ruby emperor"](exists)}
		{
			if ${Target.ID}!=${Actor["a ruby emperor"].ID} && !${Actor["a ruby emperor"].IsDead}
				Actor["a ruby emperor"]:DoTarget
		}
		elseif ${Actor["Eggtender Varogg"](exists)} && ${Actor["Eggtender Varogg"].Distance}<10 && !${Actor["Eggtender Varogg"].IsDead}
		{
			if ${Target.ID}!=${Actor["Eggtender Varogg"].ID}
				Actor["Eggtender Varogg"]:DoTarget
		}
		elseif ${Actor["an urzarach webweaver"](exists)} && !${Actor["an urzarach webweaver"].IsDead}
		{
			if ${Target.ID}!=${Actor["an urzarach webweaver"].ID}
				Actor["an urzarach webweaver"]:DoTarget
		}
		wait 1
	}
	while ${Actor["Bosun Broogle"].Health}>25
		wait 2
		
	if !${RI_Var_Bool_GlobalOthers}
		call _MoveC ${Actor["Bosun Broogle"].X} ${Actor["Bosun Broogle"].Z}
	wait 10
	Actor["Bosun Broogle"]:DoubleClick
	wait 20
	if !${RI_Var_Bool_GlobalOthers}
	{
		echo moving behind
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_SetLockSpot off
		wait 2
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_MoveBehind ALL ${Actor["Veerach the Vile"].ID} 30 99
	}
	;echo right before while loop
	while ${Actor["Veerach the Vile"](exists)} && !${Actor["Veerach the Vile"].IsDead}
	{
		;echo in loop
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor["Veerach the Vile"].ID}
				Actor["Veerach the Vile"]:DoTarget
			if ${CastAntidote}
			{
				Me.Ability["Vial of Antidote"]:Use
				CastAntidote:Set[FALSE]
				TimedCommand 100 Scripts[${RI_Var_String_RunInstancesScriptName}].Variable[CastAntidote2]:Set[TRUE]
			}
			elseif ${CastAntidote2}
			{
				eq2ex usea "Vial of Antidote"
				CastAntidote2:Set[FALSE]
			}
		}
		wait 1
	}
}
function Pinboggle()
{
	variable int PinboggleID=${Actor[Pinboggle].ID}
	while ${Actor[id,${PinboggleID}](exists)} && !${Actor[id,${PinboggleID}].IsDead} && ${RI_Var_Bool_Start}
	{
		if ${Actor["an electro-cell warbot",radius,35](exists)} && ${Actor["an electro-cell warbot",radius,35].IsAggro} && !${Actor["an electro-cell warbot",radius,35].IsDead} && !${RI_Var_Bool_GlobalOthers}
			Actor["an electro-cell warbot"]:DoTarget
		elseif !${RI_Var_Bool_GlobalOthers}
			Actor[id,${PinboggleID}]:DoTarget
		wait 1
	}
}
;again need to update DAT from Kaas to Zona
function Zona()
{
	Actor[Zona]:DoTarget
	wait 40
	if !${RI_Var_Bool_GlobalOthers}
	{
		while ${Actor["Zona"].Distance}>2
		{
			Actor["Zona"]:DoFace
			press -hold ${RI_Var_String_ForwardKey}
			wait 1
		}
		press -release ${RI_Var_String_ForwardKey}
		relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ALL ${Me.X} ${Me.Y} ${Me.Z} 2 100
	}
	wait 20
	;pause bots
	RI_CMD_PauseCombatBots 1
	eq2ex cancel_spellcast
	eq2ex clearabilityqueue
	wait 2
	relay ${RI_Var_String_RelayGroup} -noredirect Me.Inventory["Zov'Vyl Crystal"]:Use
	wait 2
	relay ${RI_Var_String_RelayGroup} -noredirect Me.Inventory["Zov'Vyl Crystal"]:Use
	wait 2
	relay ${RI_Var_String_RelayGroup} -noredirect Me.Inventory["Zov'Vyl Crystal"]:Use
	;unpause bots
	RI_CMD_PauseCombatBots 0
	if ${RI_Var_Bool_GlobalOthers}
	{
		RI_Atom_SetLockSpot OFF
		RI_Atom_MoveBehind ALL ${Actor["Zona"].ID} 30 100
	}
	while ${Actor[Kaas](exists)} && !${Actor[Kaas].IsDead} && ${RI_Var_Bool_Start}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			while ${Actor[Zona](exists)}
			{
				Actor[Zona]:DoTarget
				wait 1
			}
			relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_MoveBehind ALL ${Actor[Zom].ID} 30 100
			while ${Actor[Zom](exists)}
			{
				Actor[Zom]:DoTarget
				wait 1
			}
		}
		wait 1
	}
}
function Vaz'Din()
{
	if !${RI_Var_Bool_GlobalOthers}
	{
		RI_Atom_SetLockSpot ${Me.Name} 139.20 -50.35 27.42 1 100
		relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[1].Name} 159.35 -50.18 21.75 1 100
		relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[2].Name} 148.19 -50.18 10.59 1 100
		relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[3].Name} 152.51 -50.31 31.19 1 100
		relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[4].Name} 153.34 -50.18 17.12 1 100
		relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[5].Name} 142.08 -50.35 17.50 1 100
	}
	while ${Actor["Vaz'Din"](exists)} && !${Actor["Vaz'Din"].IsDead} && ${RI_Var_Bool_Start}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			Actor["Vaz'Din"]:DoTarget
		}
		wait 1
	}
}
function Sha'Kaz()
{
	if !${RI_Var_Bool_GlobalOthers}
	{
		RI_Atom_SetLockSpot ${Me.Name} 139.20 -50.35 27.42 1 100
		relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[1].Name} 159.35 -50.18 21.75 1 100
		relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[2].Name} 148.19 -50.18 10.59 1 100
		relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[3].Name} 152.51 -50.31 31.19 1 100
		relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[4].Name} 153.34 -50.18 17.12 1 100
		relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot ${Me.Group[5].Name} 142.08 -50.35 17.50 1 100
	}
	declare ShakazID int ${Actor["Sha'Kaz"].ID}
	while ${Actor[${ShakazID}](exists)} && !${Actor[${ShakazID}].IsDead} && ${RI_Var_Bool_Start}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			Actor[${ShakazID}]:DoTarget
		}
		wait 1
	}
}
function echo()
{	

	;set lockspot at 88.45 -49.44 45.85
	RI_Atom_SetLockSpot ${Me.Name} 88.45 -49.44 45.85 1 100
	
	;if we are a fighter target
	if !${RI_Var_Bool_GlobalOthers}
		Actor["echo of Mikazha"]:DoTarget
		
	;wait while we are more than 2 away from 88.45 45.85, and cast rescue
	while ${Math.Distance[${Me.X},${Me.Z},88.45,45.85]}>2
	{
		if ${Me.Ability[Rescue].IsReady}
			Me.Ability[Rescue]:Use
		wait 1
	}
	
	;if we are not a fighter turn off lockspot and move behind
	if ${Me.Archetype.NotEqual[fighter]}
	{
		RI_Atom_SetLockSpot off
		RI_Atom_MoveBehind ALL ${Actor["echo of Mikazha"].ID} 30 100
	}
	
	;while echo of Mikazha exists and is not dead, wait
	while ${Actor["echo of Mikazha"](exists)} && !${Actor["echo of Mikazha"].IsDead}
	{
		if ${EQ2.CustomActorArraySize}<1
			EQ2:CreateCustomActorArray[byDist,25]
		variable int count
		variable int ID
		for(count:Set[1];${count}<=${EQ2.CustomActorArraySize};count:Inc)
		{
			ID:Set[${CustomActor[${count}].ID}]
			if (${Actor[id,${ID}].Type.Equal[NPC]} || ${Actor[id,${ID}].Type.Equal[NamedNPC]}) && ${Actor[id,${ID}].InCombatMode} && ${Actor[id,${ID}].Target.ID}!=${Me.ID} && !${Actor[id,${ID}].IsDead}
			{
				;echo targeting ${Actor[id,${ID}]} because they are not targeting me
				while ${Actor[id,${ID}].Target.ID}!=${Me.ID} && ${Actor[id,${ID}](exists)} && !${Actor[id,${ID}].IsDead}
				{
					if ${Target.ID}!=${ID}
						Actor[id,${ID}]:DoTarget
					wait 2
				}
			}
			wait 1
			;echo checking ${count}
		}
		Actor["echo of Mikazha"]:DoTarget
		wait 2
	}
}

;TargetSelf Function
function TargetSelf()
{
	;target Me
	Target ${Me}
	
	;while We have the detrimental Taskmaster's Reprimand I, wait 1
	while ${Me.Effect[detrimental,Taskmaster's Reprimand I](exists)}
	{
		Target ${Me}
		wait 1
	}
	
	Actor["echo of Mikazha"]:DoTarget
}

;
;
;;;;;; SSRA InnerSanctum
;
;
function Pov()
{
	echo ISXRI: ${Time}: Starting Pov

	RIMUIObj:SetLockSpot[ALL,378.702728,-88.344337,66.403709]
	wait 5

	;else
	;{
		Actor[Pov]:DoTarget
		while !${Me.RangedAutoAttackOn}
		{
			eq2ex togglerangedattack
			wait 1
		}
	;}
	wait 50
	if ${RI_Var_Bool_GlobalOthers}
		RI_Obj_CB:SetUISetting[SettingsSkipMobAttackHealthCheckBox,0]
		
	while ${Actor[Pov](exists)} && !${Actor[Pov].IsDead} && ${RI_Var_Bool_Start}
	{
		if ${Actor["a Senshali Shadow",radius,35](exists)} && ${Actor["a Senshali Shadow",radius,35].IsAggro} && !${Actor["a Senshali Shadow",radius,35].IsDead} && !${RI_Var_Bool_GlobalOthers}
		{
			RIObj:BalanceMobs["a Senshali Shadow"]	
		}
		elseif !${RI_Var_Bool_GlobalOthers}
			Actor[Pov]:DoTarget
		wait 1
		if (${Me.GetGameData[Target.Casting].Label.Equal[Will of the Senshali]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[Will of the Senshali]})
		{
			if !${RI_Var_Bool_GlobalOthers}
			{
				relay "other ${RI_Var_String_RelayGroup}" -noredirect RIMUIObj:SetLockSpot[ALL,377.9,-114.55,78.01]
				RIMUIObj:SetLockSpot[${Me.Name},377.5,-116.16,103.75]
				while ${Math.Distance[${Me.X},${Me.Z},377.5,104.75]}>3
					wait 1
				while ${Actor[Pov].Distance}>8
					wait 1
				wait 10
				RIMUIObj:SetLockSpot[${Me.Name},377.25,-116.16,105.75]
				relay "other ${RI_Var_String_RelayGroup}" -noredirect RIMUIObj:SetLockSpot[OFF]
				relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_MoveBehind ALL ${Actor[Pov].ID} 30 100
			}
		}
	}
	call _Move3 373.265991 -116.161865 95.464760
	relay ${RI_Var_String_RelayGroup} -noredirect RIMUIObj:SetLockSpot[OFF]
	
}

function Stonefang()
{
	AnnounceText:Insert[Stonefang starts shedding his stoney scales!]
	;AnnounceText:Insert[You find safety behind the wall!]
	AnnounceText:Insert[Stonefang fills each room with clouds of poisonous dust!]

	RIMUIObj:SetLockSpot[ALL,229.427933,-101.081787,53.755280]
	
	wait 10
	Actor[Stonefang]:DoTarget
	while ${Actor[Stonefang](exists)} && !${Actor[Stonefang].IsDead} && ${RI_Var_Bool_Start}
	{
		if !${RI_Var_Bool_GlobalOthers}
			Actor[Stonefang]:DoTarget
		
		if ${Trigger}
		{
			Trigger:Set[FALSE]
			call _Move3 246.832962 -103.415260 54.349815
			call _Move3 244.436279 -101.384964 57.843193
			
			; if ${TriggerMessage.Find[stoney scales](exists)}
			; {
				; while !${TriggerMessage}
					; wait 2
				; Trigger:Set[FALSE]
			; }
			; else
			;{
				wait 50
			;}
			if !${Trigger}
			{
				call _Move3 246.832962 -103.415260 54.349815
				RIMUIObj:SetLockSpot[ALL,229.427933,-101.081787,53.755280]
			}
		}
		wait 1
	}
	relay ${RI_Var_String_RelayGroup} -noredirect OgreBotAtom a_LetsGo all
}

function Kessatras()
{
	echo ISXRI: Starting Kessatras v1
	
	;turn on lockspot at 223.42 -83.34 55.40
	RIMUIObj:SetLockSpot[ALL,223.42,-83.34,55.40]
	
	;main loop, while Kessatras is alive and exists
	while ${Actor["Kessatras Sonssiu"](exists)} && !${Actor["Kessatras Sonssiu"].IsDead}
	{
		;if im a fighter, keep my target on Kessatras
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor["Kessatras Sonssiu"].ID}
				Actor["Kessatras Sonssiu"]:DoTarget
		}
		
		;if i have the detrimental Hypnoitic Vision
		if ${RIMUIObj.MainIconIDExists[${Me.ID},577]}
		{
			;reset Lockspot and move the group to my location
			relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${Me.X},${Me.Y},${Me.Z}]
			
			;while I still have the detrimental, loop
			while ${RIMUIObj.MainIconIDExists[${Me.ID},577]}
			{
				;while the group is more than 3 units from me, loop
				while ${Me.Group[1].Distance}>3 && ${Me.Group[2].Distance}>3 && ${Me.Group[3].Distance}>3 && ${Me.Group[4].Distance}>3 && ${Me.Group[5].Distance}>3
				{	
					relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${Me.X},${Me.Y},${Me.Z}]
					wait 1
				}	
				;everyone click the statue
				relay ${RI_Var_String_RelayGroup} Actor[special]:DoubleClick
				wait 1
			}
			
			;set lockspot to original location, 223.42 -83.34 55.40
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,223.42,-83.34,55.40]
		}
		
		;if I have the detrimental Manic Mind (aka, Fear)
		;if ${Me.Effect[detrimental,"Manic Mind"](exists)}
		;{
			;start walking
		;	press shift+r
			
			;loop while I have the detrimental, Manic Mind
		;	while ${Me.Effect[detrimental,"Manic Mind"](exists)}
		;		wait 1
				
			;start running
		;	press shift+r
		;}
		wait 1
	}
	echo ISXRI: Ending Kessatras v1
}

function Xon'Xiu()
{
	echo ISXRI: ${Time}: Starting XonXiu
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["lest the spirits herein tear apart your mortal form"]
	;set lockspot and engage mob
	RIMUIObj:SetLockSpot[ALL,244.075272,-65.208748,55.773190]
	
	while ${Actor["Kesa'Tra Xon'Xiu"](exists)} && !${Actor["Kesa'Tra Xon'Xiu"].IsDead}
	{
		if ${Trigger}
		{
			if ${Actor["Kesa'Tra Xon'Xiu"].Health}>12 && !${RI_Var_Bool_GlobalOthers}
				call Dodgeechoes
			else
			{
				if !${RI_Var_Bool_GlobalOthers}
				{
					RIMUIObj:SetLockSpot[${Me.Name},207.51,-65.128748,54.273190]
					wait 10
					relay "other ${RI_Var_String_RelayGroup}" -noredirect RIMUIObj:SetLockSpot[ALL,207.51,-65.128748,54.273190]
				}
			}
		}
	}
}

function Dodgeechoes()
{
	variable bool MovingToSecond=FALSE
	wait 50
	echo ${Time}: Waiting for Kesa'Tra Xon'Xiu to Become Aggro Again
	while !${Actor["Kesa'Tra Xon'Xiu"].IsAggro} && ${Actor["Kesa'Tra Xon'Xiu"](exists)} && !${Actor["Kesa'Tra Xon'Xiu"].IsDead}
		wait 1
	echo ${Time}: Kesa'Tra Xon'Xiu Has Become Aggro Again, Starting Dodging
	wait 10 
	while ${Actor["an echo reflection"](exists)}
	{
		if ${Actor["an echo reflection"](exists)}
		{
			echo ${Time}: Moving to first corner
			RIMUIObj:SetLockSpot[${Me.Name},211.538010,-65.634575,102.540901]
			wait 10
			relay ${RI_Var_String_RelayGroup} -noredirect RIMUIObj:SetLockSpot[ALL,211.538010,-65.634575,102.540901]
			echo ${Time}: Waiting until we get to first corner
			while ${Math.Distance[${Me.X},${Me.Z},212,102]}>5 && ${Actor["an echo reflection"](exists)}
				wait 1
			wait 20
			echo ${Time}: Waiting until Kesa'Tra Xon'Xiu is within 10m
			while ${Math.Distance[${Me.X},${Me.Z},${Actor["Kesa'Tra Xon'Xiu"].X},${Actor["Kesa'Tra Xon'Xiu"].Z}]}>10 && ${Actor["an echo reflection"](exists)}
				wait 1
			echo ${Time}: Waiting until an echo is within 15m of Kesa'Tra Xon'Xiu
			while ${Actor["an echo reflection"](exists)} && ${Math.Distance[${Actor["Kesa'Tra Xon'Xiu"].X},${Actor["Kesa'Tra Xon'Xiu"].Z},${Actor["an echo reflection"].X},${Actor["an echo reflection"].Z}]}>15
				wait 1
		}
		if ${Actor["an echo reflection"](exists)}
		{
			MovingToSecond:Set[TRUE]
			echo ${Time}: Moving to second corner
			relay ${RI_Var_String_RelayGroup} -noredirect RIMUIObj:SetLockSpot[ALL,274.871124,-65.617584,102.805832]
			echo ${Time}: Waiting until we get to second corner
			while ${Math.Distance[${Me.X},${Me.Z},275,102]}>5 && ${Actor["an echo reflection"](exists)}
				wait 1
			echo ${Time}: Waiting until Kesa'Tra Xon'Xiu is within 10m
			while ${Math.Distance[${Me.X},${Me.Z},${Actor["Kesa'Tra Xon'Xiu"].X},${Actor["Kesa'Tra Xon'Xiu"].Z}]}>10 && ${Actor["an echo reflection"](exists)}
				wait 1
			echo ${Time}: Waiting until an echo is within 15m of Kesa'Tra Xon'Xiu
			while ${Actor["an echo reflection"](exists)} && ${Math.Distance[${Actor["Kesa'Tra Xon'Xiu"].X},${Actor["Kesa'Tra Xon'Xiu"].Z},${Actor["an echo reflection"].X},${Actor["an echo reflection"].Z}]}>15
				wait 1
		}
		if ${Actor["an echo reflection"](exists)}
		{
			MovingToSecond:Set[FALSE]
			echo ${Time}: Moving to third corner
			relay ${RI_Var_String_RelayGroup} -noredirect RIMUIObj:SetLockSpot[ALL,274.762207,-65.616768,6.784461]
			echo ${Time}: Waiting until we get to third corner
			while ${Math.Distance[${Me.X},${Me.Z},275,7]}>5 && ${Actor["an echo reflection"](exists)}
				wait 1
			echo ${Time}: Waiting until Kesa'Tra Xon'Xiu is within 10m
			while ${Math.Distance[${Me.X},${Me.Z},${Actor["Kesa'Tra Xon'Xiu"].X},${Actor["Kesa'Tra Xon'Xiu"].Z}]}>10 && ${Actor["an echo reflection"](exists)}
				wait 1
			echo ${Time}: Waiting until an echo is within 15m of Kesa'Tra Xon'Xiu
			while ${Actor["an echo reflection"](exists)} && ${Math.Distance[${Actor["Kesa'Tra Xon'Xiu"].X},${Actor["Kesa'Tra Xon'Xiu"].Z},${Actor["an echo reflection"].X},${Actor["an echo reflection"].Z}]}>15
				wait 1
		}
		if ${Actor["an echo reflection"](exists)}
		{
			echo ${Time}: Moving to fourth corner
			relay ${RI_Var_String_RelayGroup} -noredirect RIMUIObj:SetLockSpot[ALL,216.707535,-65.606873,7.913361]
			echo ${Time}: Waiting until we get to fourth corner
			while ${Math.Distance[${Me.X},${Me.Z},217,8]}>5 && ${Actor["an echo reflection"](exists)}
				wait 1
			echo ${Time}: Waiting until Kesa'Tra Xon'Xiu is within 10m
			while ${Math.Distance[${Me.X},${Me.Z},${Actor["Kesa'Tra Xon'Xiu"].X},${Actor["Kesa'Tra Xon'Xiu"].Z}]}>10 && ${Actor["an echo reflection"](exists)}
				wait 1
			echo ${Time}: Waiting until an echo is within 15m of Kesa'Tra Xon'Xiu
			while ${Actor["an echo reflection"](exists)} && ${Math.Distance[${Actor["Kesa'Tra Xon'Xiu"].X},${Actor["Kesa'Tra Xon'Xiu"].Z},${Actor["an echo reflection"].X},${Actor["an echo reflection"].Z}]}>15
				wait 1
		}

		wait 1
	}
	Trigger:Set[FALSE]
	if ${MovingToSecond}
	{
		wait 30
		MovingToSecond:Set[FALSE]
	}
	echo ${Time}: Moving to center
	relay ${RI_Var_String_RelayGroup} -noredirect RIMUIObj:SetLockSpot[ALL,244.075272,-65.208748,55.773190]
}

function Lich()
{
	;IncomingText:Clear
	;IncomingText2:Clear
	;IncomingText:Insert["Need a cure curse!"]
	
	RIMUIObj:SetLockSpot[ALL,124.466675,-49.157383,55.329491]
	wait 10
	Actor[Lich]:DoTarget
	while ${Actor[Lich](exists)} && !${Actor[Lich].IsDead} && ${RI_Var_Bool_Start}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor["a portal defender",radius,35](exists)} && ${Actor["a portal defender",radius,35].IsAggro} && !${Actor["a portal defender",radius,35].IsDead}
				Actor["a portal defender"]:DoTarget
			elseif ${Actor["Vhen Ras Centien",radius,35](exists)} && ${Actor["Vhen Ras Centien",radius,35].IsAggro} && !${Actor["Vhen Ras Centien",radius,35].IsDead}
				Actor["Vhen Ras Centien"]:DoTarget
			elseif ${Actor["Toz Nak Xakra",radius,35](exists)} && ${Actor["Toz Nak Xakra",radius,35].IsAggro} && !${Actor["Toz Nak Xakra",radius,35].IsDead}
				Actor["Toz Nak Xakra"]:DoTarget
			elseif ${Actor["Des Kas Xakra",radius,35](exists)} && ${Actor["Des Kas Xakra",radius,35].IsAggro} && !${Actor["Des Kas Xakra",radius,35].IsDead}
				Actor["Des Kas Xakra"]:DoTarget
			elseif ${Actor["Rhag'Vozgath",radius,35](exists)}
				call Rhags
			else
				Actor[Lich]:DoTarget
		}
		if ${Actor["Vhen Ras Centien",radius,35](exists)} && ${Actor["Vhen Ras Centien",radius,35].IsAggro} && !${Actor["Vhen Ras Centien",radius,35].IsDead}
		{
			if ${Math.Distance[${Me.Loc},124.427200,-49.157383,69.211929]}>5
				call _Move3 124.427200 -49.157383 69.211929
		}
		elseif ${Actor["Toz Nak Xakra",radius,35](exists)} && ${Actor["Toz Nak Xakra",radius,35].IsAggro} && !${Actor["Toz Nak Xakra",radius,35].IsDead}
		{
			if ${Actor["Toz Nak Xakra",radius,35].Distance}>5
			{
				call _Move3 124.427200 -49.157383 69.211929
				call _Move3 ${Actor["Toz Nak Xakra",radius,35].X} ${Actor["Toz Nak Xakra",radius,35].Y} ${Actor["Toz Nak Xakra",radius,35].Z}
			}
		}
		elseif ${Actor["Des Kas Xakra",radius,35](exists)} && ${Actor["Des Kas Xakra",radius,35].IsAggro} && !${Actor["Des Kas Xakra",radius,35].IsDead}
		{
			if ${Actor["Des Kas Xakra",radius,35].Distance}>5
			{
				call _Move3 124.427200 -49.157383 69.211929
				call _Move3 ${Actor["Des Kas Xakra",radius,35].X} ${Actor["Des Kas Xakra",radius,35].Y} ${Actor["Des Kas Xakra",radius,35].Z}
			}
		}
		;if ${Trigger} && ${Me.Archetype.Equal[priest]} && ${Me.Ability[Cure Curse].IsReady} && ${Me.Cursed}!=0
		;	call CureMyCurse
		;else
		;	Trigger:Set[FALSE]
		wait 1
	}
}

function CureMyCurse()
{
	;pause bot
	RI_CMD_PauseCombatBots 1
	
	;cancel spellcast and clear ability queue
	eq2ex cancel_spellcast
	eq2ex clearabilityqueue 
	
	;wait until we are not casting
	wait 200 !${Me.CastingSpell}
	
	Actor[id,${Me.ID}]:DoTarget
	wait 1
	
	;keep attempting to cast Cure Curse until it is no longer ready (aka casted)
	do
	{
		Actor[id,${Me.ID}]:DoTarget
		eq2ex useabilityonplayer ${Me.Name} Cure Curse
		wait 1
	}
	while ${Me.Cursed}!=0
	
	;unpause ogre
	RI_CMD_PauseCombatBots 0
	
	Trigger:Set[FALSE]
}

function Rhags()
{
	;if !${RI_Var_Bool_GlobalOthers}
	;	relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_MoveBehind ALL ${Actor[Pov].ID} 30 100
	while ${Actor["Rhag",radius,35](exists)} && !${RI_Var_Bool_GlobalOthers}
	{
		;initialize actor Fiery Effigy of Clotl'thoa's effects.
		;Actor["Rhag'Yalzzen"]:InitializeEffects

		;wait 2 while we are initializing effects`
		;while ${ISXEQ2.InitializingActorEffects}
		;	wait 2
		;;while Lavatar on Fiery Effigy of Clotl'thoa is less than 9 increments
		while ${Actor["Rhag'Yalzzen"].Effect["Infected Coating"].CurrentIncrements}<10 && ${Actor["Rhag'Yalzzen"](exists)} && !${Actor["Rhag'Yalzzen"].IsDead}
		{
			Actor["Rhag'Yalzzen"]:DoTarget
			wait 1
		}
		while ${Actor["Rhag'Yalzzen"].Effect["Infected Coating"].CurrentIncrements}>1 && ${Actor["Rhag'Yalzzen"](exists)} && !${Actor["Rhag'Yalzzen"].IsDead}
		{
			if ${Actor["Rhag'Vozgath"](exists)} && !${Actor["Rhag'Vozgath"].IsDead}
				Actor["Rhag'Vozgath"]:DoTarget
			else
				Actor[id,${Me.ID}]:DoTarget
			wait 1
		}
		Actor["Rhag"]:DoubleClick
		Actor["Rhag'Vozgath"]:DoTarget
		wait 5
	}
}
; function OgreGrindOptions(int OnOff)
; {
	; if ${ISXOgre(exists)}
	; {
		; if ${OnOff}==1
			; relay ${RI_Var_String_RelayGroup} -noredirect OgreBotAtom aExecuteAtom ALL a_UplinkControllerFunctionAutoType checkbox_settings_grindoptions TRUE
		; else
			; relay ${RI_Var_String_RelayGroup} -noredirect OgreBotAtom aExecuteAtom ALL a_UplinkControllerFunctionAutoType checkbox_settings_grindoptions FALSE
	; }
; }
function InnerSanctumCharm(int OnOff)
{
	if ${OnOff}==1
	{
		relay ${RI_Var_String_RelayGroup} -noredirect RI_DeTarget
	}
	else
	{
		if ${Script[Buffer:DeTarget](exists)}
			relay ${RI_Var_String_RelayGroup} -noredirect EndScript Buffer:Detarget
	}
}
function Kladnog()
{
	variable float CSX=6.79
	variable float CSY=-109.29
	variable float CSZ=29.98
	variable int CSpot=0
	echo ISXRI: Starting Kladnog v2
	RI_Atom_SetLockSpot ${Me.Name} ${CSX} ${CSY} ${CSZ} 1 100
	while ${Math.Distance[${Me.X},${Me.Z},${CSX},${CSZ}]}>2
		wait 1
	if ${Me.Archetype.NotEqual[fighter]}
	{
		;turn off assisting
		RI_CMD_Assisting 0
		; RI_Atom_SetLockSpot off
		; RI_Atom_MoveBehind ALL ${Actor["Kladnog"].ID} 30 100
		; removed move behind because it was causing issue with the puddles.
	}
	;main loop, while Kladnog is alive and exists
	while ${Actor["Kladnog Shralok"](exists)} && !${Actor["Kladnog Shralok"].IsDead}
	{
		if ${Actor["Disease Puddle",radius,10](exists)}
		{
			CSpot:Inc
			echo ${Time}: Disease Pool Found Incrementing CSpot to ${CSpot}
			switch ${CSpot}
			{
				case 1
					CSX:Set[3.06]
					CSY:Set[-109.52]
					CSZ:Set[12.62]
					echo ${Time}: Changing CampSpot to ${CSX} ${CSY} ${CSZ}
					break
				case 2
					CSX:Set[-3.26]
					CSY:Set[-109.52]
					CSZ:Set[-2.76]
					echo ${Time}: Changing CampSpot to ${CSX} ${CSY} ${CSZ}
					break
				case 3
					CSX:Set[-5.77]
					CSY:Set[-109.52]
					CSZ:Set[-25.48]
					echo ${Time}: Changing CampSpot to ${CSX} ${CSY} ${CSZ}
					break
				case 4
					CSX:Set[-7.80]
					CSY:Set[-109.51]
					CSZ:Set[-45.36]
					echo ${Time}: Changing CampSpot to ${CSX} ${CSY} ${CSZ}
					break
				case 5
					CSX:Set[-9.81]
					CSY:Set[-109.52]
					CSZ:Set[-64.36]
					echo ${Time}: Changing CampSpot to ${CSX} ${CSY} ${CSZ}
					break
				case 6
					CSX:Set[2.10]
					CSY:Set[-109.52]
					CSZ:Set[-83.88]
					echo ${Time}: Changing CampSpot to ${CSX} ${CSY} ${CSZ}
					break
				case 7
					CSX:Set[-22.13]
					CSY:Set[-109.52]
					CSZ:Set[-76.78]
					echo ${Time}: Changing CampSpot to ${CSX} ${CSY} ${CSZ}
					break
				case 8
					CSX:Set[-21.20]
					CSY:Set[-109.51]
					CSZ:Set[-50.44]
					echo ${Time}: Changing CampSpot to ${CSX} ${CSY} ${CSZ}
					break
				case 9
					CSX:Set[-2.75]
					CSY:Set[-109.52]
					CSZ:Set[-20.58]
					echo ${Time}: Changing CampSpot to ${CSX} ${CSY} ${CSZ}
					break
				case 10
					CSX:Set[0.89]
					CSY:Set[-109.52]
					CSZ:Set[4.39]
					echo ${Time}: Changing CampSpot to ${CSX} ${CSY} ${CSZ}
					break
				case 11
					CSX:Set[6.79]
					CSY:Set[-109.29]
					CSZ:Set[29.98]
					echo ${Time}: Changing CampSpot to ${CSX} ${CSY} ${CSZ}
					break
			}
			; if ${Actor["Kladnog Shralok"].Target.ID}==${Me.ID} || !${RI_Var_Bool_GlobalOthers}
			; {
			RI_Atom_SetLockSpot ${Me.Name} ${CSX} ${CSY} ${CSZ} 1 100
			while ${Math.Distance[${Me.X},${Me.Z},${CSX},${CSZ}]}>2
				wait 1
			; }
			; else
				; wait 30
		}
		if ${Target.ID}!=${Actor["Kladnog Shralok"].ID}
			Actor["Kladnog Shralok"]:DoTarget
		;if Kladnog starts casting 
		if ${Me.GetGameData[Target.Casting].Label.Equal["Shralok Infection"]}
			call KMove
		; if ${Actor["Kladnog Shralok"].Target.ID}==${Me.ID}
			; RI_Atom_SetLockSpot ${Me.Name} ${CSX} ${CSY} ${CSZ} 1 100
		; elseif ${Me.Archetype.NotEqual[fighter]}
			; RI_Atom_SetLockSpot off
		wait 1
	}
	;turn on assisting
	RI_CMD_Assisting 1

		echo Ending Kladnog v2
}
function KMove()
{
	; RI_Var_Bool_MovingBehind:Set[FALSE]
	RI_Atom_SetLockSpot off
	while ${Target.Distance}<25 && ${Actor["Kladnog Shralok"](exists)} && !${Actor["Kladnog Shralok"].IsDead}
	{	
		Actor["Kladnog Shralok"]:DoFace
		Actor["Kladnog Shralok"]:DoTarget
		press -hold ${RI_Var_String_BackwardKey}
		wait 1
	}
	press -release ${RI_Var_String_BackwardKey}
	while ${Me.GetGameData[Target.Casting].Label.Equal["Shralok Infection"]}
		wait 1
	
	RI_Atom_SetLockSpot ${Me.Name} 6.79 -109.29 29.98 1 100
	while ${Math.Distance[${Me.X},${Me.Z},6.79,29.98]}>4
		wait 1
	; if ${Me.Archetype.NotEqual[fighter]}
	; {
		; RI_Atom_SetLockSpot off
		; RI_Var_Bool_MovingBehind:Set[TRUE]
	; }
}
function Thresinet()
{
;;;
;
;still need to perfect this fight, make the tank keep targeting himself while moving, and
;fix the bard routine to check that he is behind before attacking and not doing the wait 5
;
;need to fix 2,3,4. Maybe just set specific move to poitns for each deathdent then wait until he is not targeting
;check to make sure we are behind and hit him, but not while in front and not moving behind mob
;
;;;
	variable int ThresinetID=${Actor[namednpc,"Thresinet"].ID}
	variable float Angle
	variable float Heading
	variable float HeadingTo
	
	echo ${Time}: ${ThresinetID}
	;set announce trigger
	AnnounceText:Clear
	AnnounceText:Insert[Thresinet targets]
	if !${RI_Var_Bool_GlobalOthers}
		press f1
	RI_Atom_SetLockSpot ${Me.Name} 112.75 -87.60 -150.75 1 100
	call _MoveC 112.75 -150.75
	call _MoveC 112.81 -203.10
	wait 20
	variable int DeathDenID=${Actor[deathden,radius,10].ID}
	;echo ${DeathDenID}
	DeathDenID:Set[${Actor[deathden,radius,10].ID}]
	;echo ${DeathDenID}
	while ${Actor[id,${DeathDenID}](exists)}
	{
		;here we need to target the deathden while he is targetable 
		;and if not send our bard behind the named and attack, while tank
		;targets himself
		if ${Me.Class.Equal[bard]} && ${Actor[id,${ThresinetID}].IsAggro}
		{
			echo ${Time}: Thresinet is Aggro Again, Starting My Routine
			;bard butt punch
			
			;pause bots
			RI_CMD_PauseCombatBots 1
						
			;turn off assisting
			RI_CMD_Assisting 0
			
			wait 5
			;press `
			eq2ex autoattack 0
			eq2ex cancel_spellcast
			eq2ex clearabilityqueue

				
			RI_Atom_ChangeLockSpot ALL 91.11 -85.78 -181.51
			while ${Math.Distance[${Me.Loc},91.11,-85.78,-181.51]}>2
			{
				if ${Me.AutoAttackOn}
					eq2ex autoattack 0
				press f1
				wait 1
			}
			;echo ${Time}: I am in position, checking if i am behing and not being targeted and attacking
			while ${Actor[id,${ThresinetID}].IsAggro}
			{
				while ${TriggerMessage.Find[you!](exists)}
				{
					press f1
					eq2ex autoattack 0
					wait 2
				}
				;if i am behind the mob
				Heading:Set[${Actor[${ThresinetID}].Heading}]
				HeadingTo:Set[${Actor[${ThresinetID}].HeadingTo}]
				Angle:Set[${Math.Calc[${Math.Cos[${Heading}]} * ${Math.Cos[${HeadingTo}]} + ${Math.Sin[${Heading}]} * ${Math.Sin[${HeadingTo}]}]}]
				Angle:Set[${Math.Acos[${Angle}]}]
				;echo ${Time}: Angle: ${Angle}
				if ${Angle}<30 && !${TriggerMessage.Find[you!](exists)}
				{
					;echo ${Time}: I must be behind, my Angle is ${Angle}, TARGETING AND HITTING
					Actor[id,${ThresinetID}]:DoFace
					Actor[id,${ThresinetID}]:DoTarget
					eq2ex autoattack 1
				}
				wait 2
			}
			;turn off movebehind from thresinet, turn on AA, turn back on cast stack,
			;turn on melee and ranged and move back to deathden
			RI_Atom_MoveBehind ALL OFF
			
			;unpause bots
			RI_CMD_PauseCombatBots 0

			RI_Atom_SetLockSpot ${Me.Name} 112.81 0 -203.10 1 100
			call _MoveC 112.81 -203.10
		}
		if !${RI_Var_Bool_GlobalOthers} && !${Actor[Thresinet].IsAggro}
			Actor[id,${DeathDenID}]:DoTarget
		if !${RI_Var_Bool_GlobalOthers} && ${Actor[Thresinet].IsAggro} 
			press f1
		wait 1
	}
	if !${RI_Var_Bool_GlobalOthers}
	{
		RI_Atom_ChangeLockSpot ALL 81.52 0 -202.52
		while ${Math.Distance[${Me.X},${Me.Z},81.52,-202.52]}>2
		{
			press f1
			wait 1
		}
	}
	else
		call _MoveC 81.52 -202.52
	wait 5
	DeathDenID:Set[${Actor[deathden,radius,10].ID}]
	while ${Actor[id,${DeathDenID}](exists)}
	{
		;here we need to target the deathden while he is targetable 
		;and if not send our bard behind the named and attack, while tank
		;targets himself
		if ${Me.Class.Equal[bard]} && ${Actor[id,${ThresinetID}].IsAggro}
		{
			echo ${Time}: Thresinet is Aggro Again, Starting My Routine
			;bard butt punch
			
			;pause bots
			RI_CMD_PauseCombatBots 1
						
			;turn off assisting
			RI_CMD_Assisting 0
			
			wait 5
			;press `
			eq2ex autoattack 0
			eq2ex cancel_spellcast
			eq2ex clearabilityqueue
			
			
			RI_Atom_ChangeLockSpot ALL 100.88 -85.77 -179.71
			while ${Math.Distance[${Me.Loc},100.88,-85.77,-179.71]}>2
			{
				if ${Me.AutoAttackOn}
					eq2ex autoattack 0
				press f1
				wait 1
			}
			;echo ${Time}: I am in position, checking if i am behing and not being targeted and attacking
			while ${Actor[id,${ThresinetID}].IsAggro}
			{
				while ${TriggerMessage.Find[you!](exists)}
				{
					press f1
					eq2ex autoattack 0
					wait 2
				}
				;if i am behind the mob
				Heading:Set[${Actor[${ThresinetID}].Heading}]
				HeadingTo:Set[${Actor[${ThresinetID}].HeadingTo}]
				Angle:Set[${Math.Calc[${Math.Cos[${Heading}]} * ${Math.Cos[${HeadingTo}]} + ${Math.Sin[${Heading}]} * ${Math.Sin[${HeadingTo}]}]}]
				Angle:Set[${Math.Acos[${Angle}]}]
				;echo ${Time}: Angle: ${Angle}
				if ${Angle}<30 && !${TriggerMessage.Find[you!](exists)}
				{
					;echo ${Time}: I must be behind, my Angle is ${Angle}, TARGETING AND HITTING
					Actor[id,${ThresinetID}]:DoFace
					Actor[id,${ThresinetID}]:DoTarget
					eq2ex autoattack 1
				}
				wait 2
			}
			;turn off movebehind from thresinet, turn on AA, turn back on cast stack,
			;turn on melee and ranged and move back to deathden
			RI_Atom_MoveBehind ALL OFF
			;unpause bots
			RI_CMD_PauseCombatBots 0
			
			RI_Atom_SetLockSpot ${Me.Name} 81.52 0 -202.52 1 100
			call _MoveC 81.52 -202.52
		}
		if !${RI_Var_Bool_GlobalOthers} && !${Actor[Thresinet].IsAggro}
			Actor[id,${DeathDenID}]:DoTarget
		if !${RI_Var_Bool_GlobalOthers} && ${Actor[Thresinet].IsAggro} 
			press f1
		wait 1
	}
	if !${RI_Var_Bool_GlobalOthers}
	{
		RI_Atom_ChangeLockSpot ALL 121.80 0 -165.39
		while ${Math.Distance[${Me.X},${Me.Z},121.80,-165.39]}>2
		{
			press f1
			wait 1
		}
	}
	else
		call _MoveC 121.80 -165.39
	wait 5
	DeathDenID:Set[${Actor[deathden,radius,10].ID}]
	while ${Actor[id,${DeathDenID}](exists)}
	{
		;here we need to target the deathden while he is targetable 
		;and if not send our bard behind the named and attack, while tank
		;targets himself
		if ${Me.Class.Equal[bard]} && ${Actor[id,${ThresinetID}].IsAggro}
		{
			echo ${Time}: Thresinet is Aggro Again, Starting My Routine
			;bard butt punch
			
			;pause bots
			RI_CMD_PauseCombatBots 1
						
			;turn off assisting
			RI_CMD_Assisting 0
			
			wait 5
			;press `
			eq2ex autoattack 0
			eq2ex cancel_spellcast
			eq2ex clearabilityqueue
			
			;change lockspot
			RI_Atom_ChangeLockSpot ALL 90.69 -85.66 -190.58
			while ${Math.Distance[${Me.Loc},90.69,-85.66,-190.58]}>2
			{
				if ${Me.AutoAttackOn}
					eq2ex autoattack 0
				press f1
				wait 1
			}
			;echo ${Time}: I am in position, checking if i am behing and not being targeted and attacking
			while ${Actor[id,${ThresinetID}].IsAggro}
			{
				while ${TriggerMessage.Find[you!](exists)}
				{
					press f1
					eq2ex autoattack 0
					wait 2
				}
				;if i am behind the mob
				Heading:Set[${Actor[${ThresinetID}].Heading}]
				HeadingTo:Set[${Actor[${ThresinetID}].HeadingTo}]
				Angle:Set[${Math.Calc[${Math.Cos[${Heading}]} * ${Math.Cos[${HeadingTo}]} + ${Math.Sin[${Heading}]} * ${Math.Sin[${HeadingTo}]}]}]
				Angle:Set[${Math.Acos[${Angle}]}]
				;echo ${Time}: Angle: ${Angle}
				if ${Angle}<30 && !${TriggerMessage.Find[you!](exists)}
				{
					;echo ${Time}: I must be behind, my Angle is ${Angle}, TARGETING AND HITTING
					Actor[id,${ThresinetID}]:DoFace
					Actor[id,${ThresinetID}]:DoTarget
					eq2ex autoattack 1
				}
				wait 2
			}
			;turn off movebehind from thresinet, turn on AA, turn back on cast stack,
			;turn on melee and ranged and move back to deathden
			RI_Atom_MoveBehind ALL OFF
			
			;unpause bots
			RI_CMD_PauseCombatBots 0
			
			RI_Atom_SetLockSpot ${Me.Name} 121.80 0 -165.39 1 100
			call _MoveC 121.80 -165.39
		}
		if !${RI_Var_Bool_GlobalOthers} && !${Actor[Thresinet].IsAggro}
			Actor[id,${DeathDenID}]:DoTarget
		if !${RI_Var_Bool_GlobalOthers} && ${Actor[Thresinet].IsAggro} 
			press f1
		wait 1
	}
	if !${RI_Var_Bool_GlobalOthers}
	{
		RI_Atom_ChangeLockSpot ALL 71.68 0 -166.21
		while ${Math.Distance[${Me.X},${Me.Z},71.68,-166.21]}>2
		{
			press f1
			wait 1
		}
	}
	else
		call _MoveC 71.68 -166.21
	wait 5
	DeathDenID:Set[${Actor[deathden,radius,10].ID}]
	while ${Actor[id,${DeathDenID}](exists)}
	{
		;here we need to target the deathden while he is targetable 
		;and if not send our bard behind the named and attack, while tank
		;targets himself
		if ${Me.Class.Equal[bard]} && ${Actor[id,${ThresinetID}].IsAggro}
		{
			echo ${Time}: Thresinet is Aggro Again, Starting My Routine
			;bard butt punch
			
			;pause bots
			RI_CMD_PauseCombatBots 1
						
			;turn off assisting
			RI_CMD_Assisting 0
			
			wait 5
			;press `
			eq2ex autoattack 0
			eq2ex cancel_spellcast
			eq2ex clearabilityqueue
			
			;change lockspot
			RI_Atom_ChangeLockSpot ALL 101.52 -85.67 -189.27
			while ${Math.Distance[${Me.Loc},101.52,-85.67,-189.27]}>2
			{
				if ${Me.AutoAttackOn}
					eq2ex autoattack 0
				press f1
				wait 1
			}
			;echo ${Time}: I am in position, checking if i am behing and not being targeted and attacking
			while ${Actor[id,${ThresinetID}].IsAggro}
			{
				while ${TriggerMessage.Find[you!](exists)}
				{
					press f1
					eq2ex autoattack 0
					wait 2
				}
				;if i am behind the mob
				Heading:Set[${Actor[${ThresinetID}].Heading}]
				HeadingTo:Set[${Actor[${ThresinetID}].HeadingTo}]
				Angle:Set[${Math.Calc[${Math.Cos[${Heading}]} * ${Math.Cos[${HeadingTo}]} + ${Math.Sin[${Heading}]} * ${Math.Sin[${HeadingTo}]}]}]
				Angle:Set[${Math.Acos[${Angle}]}]
				;echo ${Time}: Angle: ${Angle}
				if ${Angle}<30 && !${TriggerMessage.Find[you!](exists)}
				{
					;echo ${Time}: I must be behind, my Angle is ${Angle}, TARGETING AND HITTING
					Actor[id,${ThresinetID}]:DoFace
					Actor[id,${ThresinetID}]:DoTarget
					eq2ex autoattack 1
				}
				wait 2
			}
			;turn off movebehind from thresinet, turn on AA, turn back on cast stack,
			;turn on melee and ranged and move back to deathden
			RI_Atom_MoveBehind ALL OFF
			;unpause bots
			RI_CMD_PauseCombatBots 0
			RI_Atom_SetLockSpot ${Me.Name} 71.68 0 -166.21 1 100
			call _MoveC 71.68 -166.21
		}
		if !${RI_Var_Bool_GlobalOthers} && !${Actor[Thresinet].IsAggro}
			Actor[id,${DeathDenID}]:DoTarget
		if !${RI_Var_Bool_GlobalOthers} && ${Actor[Thresinet].IsAggro} 
			press f1
		wait 1
	}
	
	;if i am a fighter and not targeting thresinet target her
	if !${RI_Var_Bool_GlobalOthers} && ${Target.ID}!=${Actor[id,${ThresinetID}].ID}
		Actor[id,${ThresinetID}]:DoTarget
			
	;move lockspot to the center of the room and wait 3 secs to thresinet to arrive
	RI_Atom_SetLockSpot ${Me.Name} 96.60 0 -194.81 1 100
	call _MoveC 96.60 -194.81
	wait 30
	
	;if we are not a fighter turn off lockspot and turn on movebehind
	if ${Me.Archetype.NotEqual[fighter]}
	{
		RI_Atom_SetLockSpot off
		RI_Atom_MoveBehind ALL ${ThresinetID} 30 100
	}
	
	;while thresinet exists and is not dead
	while ${Actor[id,${ThresinetID}](exists)} && !${Actor[id,${ThresinetID}].IsDead}
	{
		;if i am a fighter and not targeting thresinet target her
		if !${RI_Var_Bool_GlobalOthers} && ${Target.ID}!=${Actor[id,${ThresinetID}].ID}
			Actor[id,${ThresinetID}]:DoTarget
	}
}
function Kavis()
{
	RI_Atom_SetLockSpot ${Me.Name} 149.47 -47.35 -25.76 1 100
	call _MoveC 149.47 -25.76
	while ${Actor[namednpc,"Kavis Set'Ra"](exists)} && !${Actor[namednpc,"Kavis Set'Ra"].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers} && ${Target.ID}!=${Actor[namednpc,"Kavis Set'Ra"].ID}
			Actor[namednpc,"Kavis Set'Ra"]:DoTarget
		wait 1
	}
	echo ${Time}: Kavis is Gone, Waiting for Bubbles
	while !${Actor[Kavis,radius,3](exists)}
		wait 1
	echo ${Time}: Bubbles are here Moving to 149.47 -25.76
	call _MoveC 145.17 -30.13
	echo ${Time}: We are at 149.47 -25.76, waiting until we are swimming
	while ${Me.WaterDepth}==0
		wait 1
	echo ${Time}: We are swimming, Holding space until we are less than 5m from 10y
	while ${Math.Distance[${Me.Y},-10]}>5
	{
		echo ${Time}: ${Math.Distance[${Me.Y},-10]}>5
		press -hold space
		wait 1
	}
	press -release space
	echo ${Time}: we are at the correct height, moving to 124.22 -50.72
	call _MoveC 133.80 -47.70
	call _MoveC 124.22 -50.72
	wait 20
	echo ${Time}: we are at 124.22 -50.72, targeting and killing reflection
	while ${Actor[npc,Kavis,radius,15](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers} && ${Target.ID}!=${Actor[npc,Kavis,radius,15].ID}
			Actor[npc,Kavis,radius,15]:DoTarget
		wait 1
	}
	echo ${Time}: reflection is dead moving to 149.47 -25.76
	call _MoveC 149.47 -25.76
	while !${Actor[Kavis,radius,3](exists)}
		wait 1
	call _MoveC 145.17 -30.13
	while ${Me.WaterDepth}==0
		wait 1
	while ${Math.Distance[${Me.Y},-10]}>5
	{
		press -hold space
		wait 1
	}
	press -release space
	call _MoveC 162.75 -18.50
	call _MoveC 164.67 -12.13
	wait 20
	while ${Actor[npc,Kavis,radius,15](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers} && ${Target.ID}!=${Actor[npc,Kavis,radius,15].ID}
			Actor[npc,Kavis,radius,15]:DoTarget
		wait 1
	}
	call _MoveC 184.66 -64.16
	while !${Actor[Kavis,radius,3](exists)}
		wait 1
	call _MoveC 183.23 -69.04
	while ${Me.WaterDepth}==0
		wait 1
	while ${Math.Distance[${Me.Y},-10]}>5
	{
		press -hold space
		wait 1
	}
	press -release space
	call _MoveC 195.52 -50.48
	call _MoveC 203.96 -47.74
	wait 20
	while ${Actor[npc,Kavis,radius,15](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers} && ${Target.ID}!=${Actor[npc,Kavis,radius,15].ID}
			Actor[npc,Kavis,radius,15]:DoTarget
		wait 1
	}
	call _MoveC 157.03 -29.95
	wait 20
	press -hold d
	wait 5
	press -release d
	while ${Actor[namednpc,"Kavis Set'Ra"](exists)} && !${Actor[namednpc,"Kavis Set'Ra"].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers} && ${Target.ID}!=${Actor[namednpc,"Kavis Set'Ra"].ID}
			Actor[namednpc,"Kavis Set'Ra"]:DoTarget
		wait 1
	}
}
function HuntRingEvent()
{
	if !${RI_Var_Bool_GlobalOthers}
		relay ${RI_Var_String_RelayGroup} RI_Atom_SetLockSpot ALL -3930.33 -87.27 95.71 1 100
	while !${Actor[Sharptooth](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor["a compsognathus",radius,25](exists)} && !${Actor["a compsognathus",radius,25].IsDead}
			{	
				if ${Target.ID}!=${Actor["a compsognathus",radius,25].ID}
					Actor["a compsognathus",radius,25]:DoTarget
			}
			elseif ${Actor["an elite Allu'thoa prowler",radius,50](exists)} && !${Actor["an elite Allu'thoa prowler",radius,50].IsDead}
			{	
				if ${Target.ID}!=${Actor["an elite Allu'thoa prowler",radius,50].ID}
					Actor["an elite Allu'thoa prowler",radius,50]:DoTarget
			}
			elseif ${Actor["an elite Allu'thoa tracker",radius,50](exists)} && !${Actor["an elite Allu'thoa tracker",radius,50].IsDead}
			{	
				if ${Target.ID}!=${Actor["an elite Allu'thoa tracker",radius,50].ID}
					Actor["an elite Allu'thoa tracker",radius,50]:DoTarget
			}
			elseif ${Actor["The Unnamed Hunter"](exists)} && !${Actor["The Unnamed Hunter"].IsDead}
			{	
				if ${Target.ID}!=${Actor["The Unnamed Hunter"].ID}
					Actor["The Unnamed Hunter"]:DoTarget
			}
			elseif ${Actor["a cowed stegoplatodon",radius,50](exists)} && !${Actor["a cowed stegoplatodon",radius,50].IsDead}
			{	
				if ${Target.ID}!=${Actor["a cowed stegoplatodon",radius,50].ID}
					Actor["a cowed stegoplatodon",radius,50]:DoTarget
			}
			elseif ${Actor["a subjugated pterrorsaur",radius,50](exists)} && !${Actor["a subjugated pterrorsaur",radius,50].IsDead}
			{	
				if ${Target.ID}!=${Actor["a subjugated pterrorsaur",radius,50].ID}
					Actor["a subjugated pterrorsaur",radius,50]:DoTarget
			}
			elseif ${Actor["a fearful ipsumodon",radius,50](exists)} && !${Actor["a fearful ipsumodon",radius,50].IsDead}
			{	
				if ${Target.ID}!=${Actor["a fearful ipsumodon",radius,50].ID}
					Actor["a fearful ipsumodon",radius,50]:DoTarget
			}
			elseif ${Actor["an Allu'thoa deino-tyrant",radius,50](exists)} && !${Actor["an Allu'thoa deino-tyrant",radius,50].IsDead}
			{	
				if ${Target.ID}!=${Actor["an Allu'thoa deino-tyrant",radius,50].ID}
					Actor["an Allu'thoa deino-tyrant",radius,50]:DoTarget
			}
			elseif ${Actor[Scytheclaw](exists)} && !${Actor[Scytheclaw].IsDead}
			{	
				if ${Target.ID}!=${Actor[Scytheclaw].ID}
					Actor[Scytheclaw]:DoTarget
			}
			elseif ${Actor[Boneskull](exists)} && !${Actor[Boneskull].IsDead}
			{	
				if ${Target.ID}!=${Actor[Boneskull].ID}
					Actor[Boneskull]:DoTarget
			}
			elseif ${Actor[namednpc,Littlefoot](exists)} && !${Actor[namednpc,Littlefoot].IsDead}
			{	
				if ${Target.ID}!=${Actor[namednpc,Littlefoot].ID}
					Actor[namednpc,Littlefoot]:DoTarget
			}
			elseif ${Actor[Petri](exists)} && !${Actor[Petri].IsDead}
			{	
				if ${Target.ID}!=${Actor[Petri].ID}
					Actor[Petri]:DoTarget
			}
		}
		wait 5
	}
	while ${Actor[Sharptooth](exists)} || ${Actor[Maw](exists)}
	{
		if ${Actor[Sharptooth].Health}>80 && !${Actor[Sharptooth].IsDead}
		{	
			if ${Target.ID}!=${Actor[Sharptooth].ID}
				Actor[Sharptooth]:DoTarget
		}
		elseif ${Actor[Maw].Health}>80 && !${Actor[Maw].IsDead}
		{	
			if ${Target.ID}!=${Actor[Maw].ID}
				Actor[Maw]:DoTarget
		}
		elseif ${Actor[Sharptooth].Health}>60 && !${Actor[Sharptooth].IsDead}
		{	
			if ${Target.ID}!=${Actor[Sharptooth].ID}
				Actor[Sharptooth]:DoTarget
		}
		elseif ${Actor[Maw].Health}>60 && !${Actor[Maw].IsDead}
		{	
			if ${Target.ID}!=${Actor[Maw].ID}
				Actor[Maw]:DoTarget
		}
		elseif ${Actor[Sharptooth].Health}>40 && !${Actor[Sharptooth].IsDead}
		{	
			if ${Target.ID}!=${Actor[Sharptooth].ID}
				Actor[Sharptooth]:DoTarget
		}
		elseif ${Actor[Maw].Health}>40 && !${Actor[Maw].IsDead}
		{	
			if ${Target.ID}!=${Actor[Maw].ID}
				Actor[Maw]:DoTarget
		}
		elseif ${Actor[Sharptooth].Health}>20 && !${Actor[Sharptooth].IsDead}
		{	
			if ${Target.ID}!=${Actor[Sharptooth].ID}
				Actor[Sharptooth]:DoTarget
		}
		elseif ${Actor[Maw].Health}>20 && !${Actor[Maw].IsDead}
		{	
			if ${Target.ID}!=${Actor[Maw].ID}
				Actor[Maw]:DoTarget
		}
		elseif ${Actor[Sharptooth].Health}>10 && !${Actor[Sharptooth].IsDead}
		{	
			if ${Target.ID}!=${Actor[Sharptooth].ID}
				Actor[Sharptooth]:DoTarget
		}
		elseif ${Actor[Maw].Health}>10 && !${Actor[Maw].IsDead}
		{	
			if ${Target.ID}!=${Actor[Maw].ID}
				Actor[Maw]:DoTarget
		}
		elseif ${Actor[Sharptooth](exists)} && !${Actor[Sharptooth].IsDead}
		{	
			if ${Target.ID}!=${Actor[Sharptooth].ID}
				Actor[Sharptooth]:DoTarget
		}
		elseif !${Actor[Maw].IsDead}
		{	
			if ${Target.ID}!=${Actor[Maw].ID}
				Actor[Maw]:DoTarget
		}
		elseif ${Actor[Maw].IsDead} || ${Actor[Sharptooth].IsDead}
		{
			Actor[Maw]:DoubleClick
			Actor[Sharptooth]:DoubleClick
			eq2ex apply_verb ${Actor[Maw].ID} Loot
			eq2ex apply_verb ${Actor[Sharptooth].ID} Loot
		}
		wait 2
	}
	if !${RI_Var_Bool_GlobalOthers}
		relay ${RI_Var_String_RelayGroup} RI_Atom_SetLockSpot ALL -3935.20 -88 101.25 1 100
}
function Qworux()
{
	;if namednpc qworox exists and is not dead
	if ${Actor[namednpc,Qworux](exists)} && !${Actor[namednpc,Qworux].IsDead}
	{
		;set lockspot
		RI_Atom_SetLockSpot ${Me.Name} 95.905545 -86.061654 -97.862258 1 100
		
		;set our NameID to the Correct Qworox
		NameID:Set[${Actor[namednpc,Qworux].ID}]
		
		;target the namednpc Qworux
		if !${RI_Var_Bool_GlobalOthers}
			Actor[namednpc,Qworux]:DoTarget
		wait 5
		
		;relay to everyone to cast SeverHate to pull Qworux
		relay ${RI_Var_String_RelayGroup} -noredirect Me.Ability["Sever Hate"]:Use
		
		;while the namednpc Qworux exists and is not dead
		while ${Actor[namednpc,Qworux](exists)} && !${Actor[namednpc,Qworux].IsDead}
		{
			;if i am a fighter, target a den guardarach if it exists within 25 raidus 
			;otherwise target Qworux if i am not targeting her
			if !${RI_Var_Bool_GlobalOthers}
			{
				if ${Actor["a den guardarach",radius,25](exists)}
					Actor["a den guardarach",radius,25]:DoTarget
				elseif ${Target.ID}!=${Actor[namednpc,Qworux].ID}
					Actor[namednpc,Qworux]:DoTarget
			}
			wait 5
		}
	}
}
function WaitForKladnog()
{
	echo ${Time}: Waiting for Kladnog Shralok to arrive
	wait 2000000 ${Actor["Kladnog Shralok"](exists)}
	while ${Actor["Kladnog Shralok"].Distance}>30
		wait 1
	echo ${Time}: Done Waiting for Kladnog Shralok
}

function Doof()
{
	echo ISXRI: Starting Doof 
	;first as long as Doof is more than 55 away from us pull dockers, there are 6 sets that need pulled
	
	;turn on lockspot to -239 -62 98
	RI_Atom_SetLockSpot ${Me.Name} -239 -62 98 1 100
	
	while ${Actor[docker](exists)} && !${Actor["Oofgoof Doof"].InCombatMode}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if !${Target.Name.Find[docker](exists)}
				Actor[docker]:DoTarget
			elseif !${Target.Target(exists)}
			{
				relay ${RI_Var_String_RelayGroup} -noredirect Me.Ability["Sever Hate"]:Use
				wait 20
			}
		}
		wait 2
	}
	AnnounceText:Clear
	AnnounceText:Insert["You've been targeted by Oofgoof!"]
	
	;if i am a priest, turn off curse
	if ${Me.Archetype.Equal[priest]}
		RI_CMD_AbilityEnableDisable "Cure Curse" 0
	
	;turn on lockspot to -232 -61 97
	RI_Atom_SetLockSpot ${Me.Name} -232 -61 97 1 100
	
	if !${RI_Var_Bool_GlobalOthers}
		Actor["Oofgoof Doof"]:DoTarget

	wait 5
		
	;while Oofgoof Doof is not targeting someone, cast severhate
	while !${Actor["Oofgoof Doof"].Target(exists)}
	{
		relay ${RI_Var_String_RelayGroup} -noredirect Me.Ability["Sever Hate"]:Use
		wait 5
	}
	
	while ${Actor["Oofgoof Doof"](exists)} && !${Actor["Oofgoof Doof"].IsDead}
	{
		;if Trigger is true, move to joust spot, wait 15s then move back behind
		if ${Trigger}
		{
			;turn on lockspot to -251 -61 92
			RI_Atom_SetLockSpot ${Me.Name} -251 -61 92 1 100
			
			wait 170
				
			;turn on lockspot to -232 -61 97
			RI_Atom_SetLockSpot ${Me.Name} -232 -61 97 1 100
			
			;set Trigger False
			Trigger:Set[FALSE]
		}
		if !${RI_Var_Bool_GlobalOthers}
		{	
			if ${Target.ID}!=${Actor["Oofgoof Doof"].ID}
				Actor["Oofgoof Doof"]:DoTarget
		}
		wait 2
	}
	if ${Me.Archetype.Equal[priest]}
		RI_CMD_AbilityEnableDisable "Cure Curse" 1
	
	echo Ending Doof
}
variable bool TriggerWharfie=FALSE
function Wharfie()
{
	if !${RI_Var_Bool_GlobalOthers}
		RI_AggroControl
	declare DRCount int 0
	declare Crate int
	declare ArmoredSpikesMainIconID int 965

	;events
	Event[EQ2_onIncomingText]:AttachAtom[EQ2_onIncomingTextWharfie]

	;turn off walk the plank
	RI_CMD_AbilityEnableDisable "Walk the Plank" 0
	
	wait 10
	Actor["Sir Wharfie"]:DoTarget
	
	;lock fighter to -205 -49 168
	RI_Atom_SetLockSpot ALL -205 -49 168
	wait 200 ${Actor["Sir Wharfie"].Distance}<10
	
	;lock fighter to -225 -49 185
	RI_Atom_SetLockSpot ALL -225 -49 185
	wait 200 ${Math.Distance[${Me.Loc},-225,-49,185]}<3
	wait 200 ${Actor["Sir Wharfie"].Distance}<9
	
	;lock fighter to -223 -49 191
	RI_Atom_SetLockSpot ALL -223 -49 191
	wait 200 ${Math.Distance[${Me.Loc},-223,-49,191]}<3
	wait 200 ${Actor["Sir Wharfie"].Distance}<9
	
	;lock fighter to -208 -49 182
	RI_Atom_SetLockSpot FIGHTER -208 -49 182
	
	;if i am a bard lock to -227 -49 186
	if ${Me.Class.Equal[bard]}
		RI_Atom_SetLockSpot ${Me.Name} -216 -49 186
		
	;if i am an enchanter lock to -206 -49 165
	elseif ${Me.Class.Equal[enchanter]}
		RI_Atom_SetLockSpot ${Me.Name} -237 -48.88 192.81
	
	;if i am a scout
	elseif ${Me.Archetype.Equal[scout]}
	{
		;count our scouts first(ignoring bards), then decide where i go
		declare count int 0
		declare AnotherScout bool FALSE
		declare OtherScout string
		
		for(count:Set[1];${count}<${Me.Group};count:Inc)
		{
			if ${Me.Group[${count}].Class.Equal[swashbuckler]} || ${Me.Group[${count}].Class.Equal[brigand]} || ${Me.Group[${count}].Class.Equal[assassin]} || ${Me.Group[${count}].Class.Equal[ranger]} || ${Me.Group[${count}].Class.Equal[beastlord]}
			{
				AnotherScout:Set[TRUE]
				OtherScout:Set[${Me.Group[${count}]}]
			}
			wait 1
		}
		
		;if we have another scout, compare our names and decide who goes where
		if ${AnotherScout}
		{
			if ${OtherScout.Compare[${Me.Name}]}>0
				RI_Atom_SetLockSpot ${Me.Name} -226 -49 190
			else
				RI_Atom_SetLockSpot ${Me.Name} -236 -49 195
		}
		else
			RI_Atom_SetLockSpot ${Me.Name} -226 -49 190
	}
	
	;if i am a mage
	elseif ${Me.Archetype.Equal[mage]}
	{
		;count our magess first(ignoring chanters), then decide where i go
		declare count int 0
		declare AnotherMage bool FALSE
		declare OtherMage string
		
		for(count:Set[1];${count}<${Me.Group};count:Inc)
		{
			if ${Me.Group[${count}].Class.Equal[warlock]} || ${Me.Group[${count}].Class.Equal[wizard]} || ${Me.Group[${count}].Class.Equal[necromancer]} || ${Me.Group[${count}].Class.Equal[conjuror]}
			{
				AnotherMage:Set[TRUE]
				OtherMage:Set[${Me.Group[${count}]}]
			}
			wait 1
		}
		
		;if we have another scout, compare our names and decide who goes where
		if ${AnotherMage}
		{
			if ${OtherMage.Compare[${Me.Name}]}>0
				RI_Atom_SetLockSpot ${Me.Name} -246 -49 183
			else
			{
				RI_Atom_SetLockSpot ${Me.Name} -246 -49 183
				wait 200 ${Math.Distance[${Me.Loc},-246,-49,183}]}<2
				RI_Atom_SetLockSpot ${Me.Name} -250 -49 169
			}
		}
		else
			RI_Atom_SetLockSpot ${Me.Name} -246 -49 183
	}
	;if i am a healer
	elseif ${Me.Archetype.Equal[priest]}
	{
		;count our priests first, then decide where i go
		declare count int 0
		declare AnotherPriest bool FALSE
		declare OtherPriest string
		
		for(count:Set[1];${count}<${Me.Group};count:Inc)
		{
			if ${Me.Group[${count}].Class.Equal[inquisitor]} || ${Me.Group[${count}].Class.Equal[templar]} ||${Me.Group[${count}].Class.Equal[defiler]} || ${Me.Group[${count}].Class.Equal[mystic]} || ${Me.Group[${count}].Class.Equal[fury]} || ${Me.Group[${count}].Class.Equal[warden]} || ${Me.Group[${count}].Class.Equal[channeler]}
			{
				AnotherPriest:Set[TRUE]
				OtherPriest:Set[${Me.Group[${count}]}]
			}
			wait 1
		}
		
		;if we have another scout, compare our names and decide who goes where
		if ${AnotherPriest}
		{
			if ${OtherPriest.Compare[${Me.Name}]}>0
				RI_Atom_SetLockSpot ${Me.Name} -228.19 -48.88 180.29
			else
				RI_Atom_SetLockSpot ${Me.Name} -213.52 -48.87 184.90
		}
		else
			RI_Atom_SetLockSpot ${Me.Name} -228.19 -48.88 180.29
	}
	
	;while wharfie exists, isnot dead and RI is started.
	while ${Actor["Sir Wharfie"](exists)} && !${Actor["Sir Wharfie"].IsDead}
	{
		if !${RI_Var_Bool_Start}
		{
			wait 2
			continue
		}
		
		;Armored Spikes MainIconID is 965
		if !${RI_Var_Bool_GlobalOthers}
		{
			; Actor["Sir Wharfie"]:InitializeEffects - REMOVED MAY NOT BE NEEDED
			; ;wait 2 while we are initializing effects
			; while ${ISXEQ2.InitializingActorEffects}
			; {
				; wait 2
				; if ${TriggerWharfie}
				; {
					; wait 15
					; RI_Atom_SetLockSpot off
					; RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[TRUE]
					; wait 2
					; RI_Atom_MoveBehind ALL ${Actor["Wharfie"].ID} 30 100
					; echo ${Time}: Moving Behind ${Actor["Wharfie"]} / ${Actor["Wharfie"].ID} 
					; wait 25
					; RI_Atom_MoveBehind ALL OFF
					; RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[FALSE]
					; wait 10
					; RI_Atom_SetLockSpot FIGHTER -208 -49 182
					; TriggerWharfie:Set[FALSE]
				; }
			; }
			if ${Trigger}
			{
				Actor[${Me.ID}]:DoTarget
				relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
				relay ${RI_Var_String_RelayGroup} eq2ex clearabilityqueue
				while ${Actor["Sir Wharfie"].Effect[1].MainIconID}!=${ArmoredSpikesMainIconID} && ${Actor["Sir Wharfie"].Effect[2].MainIconID}!=${ArmoredSpikesMainIconID} && ${Actor["Sir Wharfie"].Effect[3].MainIconID}!=${ArmoredSpikesMainIconID} && ${Actor["Sir Wharfie"].Effect[4].MainIconID}!=${ArmoredSpikesMainIconID} && ${Actor["Sir Wharfie"].Effect[5].MainIconID}!=${ArmoredSpikesMainIconID}
				{
					Actor[${Me.ID}]:DoTarget
					relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
					relay ${RI_Var_String_RelayGroup} eq2ex clearabilityqueue
					if ${TriggerWharfie}
					{
						wait 15
						RI_Atom_SetLockSpot off
						RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[TRUE]
						wait 2
						RI_Atom_MoveBehind ALL ${Actor["Wharfie"].ID} 30 100
						echo ${Time}: Moving Behind ${Actor["Wharfie"]} / ${Actor["Wharfie"].ID} 
						wait 25
						RI_Atom_MoveBehind ALL OFF
						RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[FALSE]
						wait 10
						RI_Atom_SetLockSpot FIGHTER -208 -49 182
						TriggerWharfie:Set[FALSE]
					}
					; Actor["Sir Wharfie"]:InitializeEffects - REMOVED MAY NOT BE NEEDED
					; ;wait 2 while we are initializing effects
					; while ${ISXEQ2.InitializingActorEffects}
					; {
						; wait 2
						; if ${TriggerWharfie}
						; {
							; wait 15
							; RI_Atom_SetLockSpot off
							; RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[TRUE]
							; wait 2
							; RI_Atom_MoveBehind ALL ${Actor["Wharfie"].ID} 30 100
							; echo ${Time}: Moving Behind ${Actor["Wharfie"]} / ${Actor["Wharfie"].ID} 
							; wait 25
							; RI_Atom_MoveBehind ALL OFF
							; RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[FALSE]
							; wait 10
							; RI_Atom_SetLockSpot FIGHTER -208 -49 182
							; TriggerWharfie:Set[FALSE]
						; }
					; }
					wait 2
				}
				Trigger:Set[FALSE]
			}
			if ${Actor["Sir Wharfie"].Effect[1].MainIconID}==${ArmoredSpikesMainIconID} || ${Actor["Sir Wharfie"].Effect[2].MainIconID}==${ArmoredSpikesMainIconID} || ${Actor["Sir Wharfie"].Effect[3].MainIconID}==${ArmoredSpikesMainIconID} || ${Actor["Sir Wharfie"].Effect[4].MainIconID}==${ArmoredSpikesMainIconID} || ${Actor["Sir Wharfie"].Effect[5].MainIconID}==${ArmoredSpikesMainIconID}
			{
				if ${RI_Var_Bool_Debug}
					echo ${Time}: ${Actor["Sir Wharfie"].Effect[1].MainIconID}==${ArmoredSpikesMainIconID} || ${Actor["Sir Wharfie"].Effect[2].MainIconID}==${ArmoredSpikesMainIconID} || ${Actor["Sir Wharfie"].Effect[3].MainIconID}==${ArmoredSpikesMainIconID} || ${Actor["Sir Wharfie"].Effect[4].MainIconID}==${ArmoredSpikesMainIconID} || ${Actor["Sir Wharfie"].Effect[5].MainIconID}==${ArmoredSpikesMainIconID}
				Actor[${Me.ID}]:DoTarget
			}
			elseif ${Actor["Sir Wharfie"].Effect[1].MainIconID}!=${ArmoredSpikesMainIconID} && ${Actor["Sir Wharfie"].Effect[2].MainIconID}!=${ArmoredSpikesMainIconID} && ${Actor["Sir Wharfie"].Effect[3].MainIconID}!=${ArmoredSpikesMainIconID} && ${Actor["Sir Wharfie"].Effect[4].MainIconID}!=${ArmoredSpikesMainIconID} && ${Actor["Sir Wharfie"].Effect[5].MainIconID}!=${ArmoredSpikesMainIconID}
			{
				if ${RI_Var_Bool_Debug}
					echo ${Time}: ${Actor["Sir Wharfie"].Effect[1].MainIconID}!=${ArmoredSpikesMainIconID} && ${Actor["Sir Wharfie"].Effect[2].MainIconID}!=${ArmoredSpikesMainIconID} && ${Actor["Sir Wharfie"].Effect[3].MainIconID}!=${ArmoredSpikesMainIconID} && ${Actor["Sir Wharfie"].Effect[4].MainIconID}!=${ArmoredSpikesMainIconID} && ${Actor["Sir Wharfie"].Effect[5].MainIconID}!=${ArmoredSpikesMainIconID}
				Trigger:Set[FALSE]
				if ${Target.ID}!=${Actor["Sir Wharfie"].ID}
					Actor["Sir Wharfie"]:DoTarget
			}
			if ${TriggerWharfie}
			{
				wait 15
				RI_Atom_SetLockSpot off
				RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[TRUE]
				wait 2
				RI_Atom_MoveBehind ALL ${Actor["Wharfie"].ID} 30 100
				echo ${Time}: Moving Behind ${Actor["Wharfie"]} / ${Actor["Wharfie"].ID} 
				wait 25
				RI_Atom_MoveBehind ALL OFF
				RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[FALSE]
				wait 10
				RI_Atom_SetLockSpot FIGHTER -208 -49 182
				TriggerWharfie:Set[FALSE]
			}
		}
		if ${Trigger} && ${Me.Archetype.NotEqual[fighter]}
		{
			if ${RI_Var_Bool_Debug}
				echo ${Time}: Package delivered, starting keg routine
			wait 60
			DRCount:Inc
			if ${DRCount}==1 && ${Me.Class.Equal[enchanter]}
			{
				if ${RI_Var_Bool_Debug}
					echo ${Time}: Enchanter
				;move to first barrel
				;call _MoveC -232 192 FALSE TRUE
				
				;turn off assisting
				RI_CMD_Assisting 0
				
				;set first crate's ID
				Crate:Set[${Actor["a heavy crate"].ID}]
				
				;target crate
				;relay ${RI_Var_String_RelayGroup} 
				Actor[id,${Crate}]:DoTarget
				
				;while the crate exists target it
				while ${Actor[id,${Crate}](exists)}
				{
					;relay ${RI_Var_String_RelayGroup} 
					Actor[id,${Crate}]:DoTarget
					wait 1
				}
				
				;target self and wait 1s 
				;relay ${RI_Var_String_RelayGroup} 
				Actor[${Me.ID}]:DoTarget
				wait 10
				
				;change camera, pick up keg
				Press -hold ${RI_Var_String_LookDownKey}
				wait 5
				Actor[keg]:DoubleClick
				
				;move to wharfiespot and wait until we are there
				call _MoveC -216 184 FALSE TRUE
				wait 5
				
				;move mouse to center of screen aka on top of you
				Mouse:SetPosition[${Math.Calc[${Display.Width}/2]},${Math.Calc[${Display.Height}/2]}]
				wait 2
				
				;click to place
				Mouse:LeftClick
				
				wait 5
				Press -release ${RI_Var_String_LookDownKey}
				Press -hold ${RI_Var_String_LookUpKey}
				wait 2
				Press -release ${RI_Var_String_LookUpKey}
				
				;move back to our position and turn on assisting
				call _MoveC -236 195 FALSE TRUE
				;relay ${RI_Var_String_RelayGroup} 
				RI_CMD_Assisting 1
			}
			if ${DRCount}==2 && ${Me.Class.Equal[enchanter]}
			{
				if ${RI_Var_Bool_Debug}
					echo ${Time}: Enchanter
				;move to 2nd barrel
				call _MoveC -240 183 FALSE TRUE
				wait 5
				call _MoveC -256 187 FALSE TRUE
				
				
				;turn off assisting
				RI_CMD_Assisting 0
				
				;set second crate's ID
				Crate:Set[${Actor["a heavy crate"].ID}]
				
				;target crate
				;relay ${RI_Var_String_RelayGroup} 
				Actor[id,${Crate}]:DoTarget
				
				;while the crate exists target it
				while ${Actor[id,${Crate}](exists)}
				{
					;relay ${RI_Var_String_RelayGroup} 
					Actor[id,${Crate}]:DoTarget
					wait 1
				}
								
				;target self and wait 1s
				;relay ${RI_Var_String_RelayGroup} 
				Actor[${Me.ID}]:DoTarget
				wait 10
				
				;change camera, pick up keg
				Press -hold ${RI_Var_String_LookDownKey}
				wait 5
				Actor[keg]:DoubleClick
				
				;move to wharfiespot and wait until we are there
				call _MoveC -216 184 FALSE TRUE
				wait 5
				
				;move mouse to center of screen aka on top of you
				Mouse:SetPosition[${Math.Calc[${Display.Width}/2]},${Math.Calc[${Display.Height}/2]}]
				wait 2
				
				;click to place
				Mouse:LeftClick
				
				wait 5
				Press -release ${RI_Var_String_LookDownKey}
				Press -hold ${RI_Var_String_LookUpKey}
				wait 2
				Press -release ${RI_Var_String_LookUpKey}
				
				;move back to our position
				call _MoveC -236 195 FALSE TRUE
				
				;turn on assisting
				RI_CMD_Assisting 1
			}
			if ${DRCount}==3 && ${Me.Class.Equal[enchanter]}
			{
				if ${RI_Var_Bool_Debug}
					echo ${Time}: Enchanter
				;move to 3rd barrel
				call _MoveC -240 183 FALSE TRUE
				wait 5
				call _MoveC -271 155 FALSE TRUE
				
				
				;turn off assisting
				RI_CMD_Assisting 0
				
				;set third crate's ID
				Crate:Set[${Actor["a heavy crate"].ID}]
				
				;target crate
				;relay ${RI_Var_String_RelayGroup} 
				Actor[id,${Crate}]:DoTarget
				
				;while the crate exists target it
				while ${Actor[id,${Crate}](exists)}
				{
					;relay ${RI_Var_String_RelayGroup} 
					Actor[id,${Crate}]:DoTarget
					wait 1
				}
								
				;target self and wait 1s
				;relay ${RI_Var_String_RelayGroup} 
				Actor[${Me.ID}]:DoTarget
				wait 10
				
				;change camera, pick up keg
				Press -hold ${RI_Var_String_LookDownKey}
				wait 2
				Actor[keg]:DoubleClick
				
				;move to ourspot then wharfiespot and wait until we are there
				call _MoveC -240 183 FALSE TRUE
				wait 5
				call _MoveC -216 184 FALSE TRUE
				wait 5
				
				;move mouse to center of screen aka on top of you
				Mouse:SetPosition[${Math.Calc[${Display.Width}/2]},${Math.Calc[${Display.Height}/2]}]
				wait 2
				
				;click to place
				Mouse:LeftClick
				
				wait 5
				Press -release ${RI_Var_String_LookDownKey}
				Press -hold ${RI_Var_String_LookUpKey}
				wait 2
				Press -release ${RI_Var_String_LookUpKey}
				
				;move back to our position
				call _MoveC -236 195 FALSE TRUE
				
				;turn on assisting
				RI_CMD_Assisting 1
			}
			Trigger:Set[FALSE]
		}
		wait 2
	}
	;move mages to -246 -49 183
	if ${Me.Archetype.Equal[mage]} && ${Me.Class.NotEqual[enchanter]}
		RI_Atom_SetLockSpot ${Me.Name} -246 -49 183
	wait 20
	
	;detach atom
	Event[EQ2_onIncomingText]:DetachAtom[EQ2_onIncomingTextWharfie]
	
	;turn walk the plank back on
	RI_CMD_AbilityEnableDisable "Walk the Plank" 1
	if !${RI_Var_Bool_GlobalOthers}
		endscript Buffer:AggroControl
}
;atom triggered when incommingtext is detected
atom EQ2_onIncomingTextWharfie(string Text)
{
	
   	if ${Text.Find["Deliver the package!"](exists)}
	{
		echo ${Time}:IncomingText: ${Text}
		Trigger:Set[TRUE]
		relay ${RI_Var_String_RelayGroup} Actor[${Me.ID}]:DoTarget
		relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
		relay ${RI_Var_String_RelayGroup} eq2ex clearabilityqueue
	}
	if ${Text.Find["stops to attack everyone in front of him"](exists)}
	{
		echo ${Time}:IncomingText: ${Text}
		TriggerWharfie:Set[TRUE]
	}
}

variable(global) bool Jousted=FALSE
function Zaxfalump()
{
	echo ISXRI: Starting Zaxfalump 
	
	declare ReleasedTank bool FALSE
	declare FwumpSpawned bool FALSE
	declare Stowaway1 int
	declare Stowaway2 int
	
	;turn on lockspot to -251 -61 92
	RI_Atom_SetLockSpot ALL -217 -49 134 1 100
	RI_Atom_SetLockSpot FIGHTER -214 -49 141 1 100
	
	while ${Actor["Zaxfalump"](exists)} && !${Actor["Zaxfalump"].IsDead}
	{
		;if Trigger is true, move to joust spot, wait 15s then move back behind
		if !${Jousted} && ${Actor["AE Warning Area"](exists)} && ${Actor["AE Warning Area"].Distance}<2
		{
			;if we are at -217,-49,134 move to -222 -49 122
			if ${Math.Distance[${Me.Loc},-217,-49,134]}<2 || ${Math.Distance[${Me.Loc},-214,-49,141]}<2
			{
				RI_Atom_SetLockSpot ALL -222 -49 122 1 100
				RI_Atom_SetLockSpot FIGHTER -224 -49 115 1 100
			}
			;elseif we are at -222,-49,122 move to -217 -49 134
			elseif ${Math.Distance[${Me.Loc},-222,-49,122]}<2 || ${Math.Distance[${Me.Loc},-224,-49,115]}<2
			{
				RI_Atom_SetLockSpot ALL -217 -49 134 1 100
				RI_Atom_SetLockSpot FIGHTER -214 -49 141 1 100
			}
			
			Jousted:Set[TRUE]
			TimedCommand 20 Jousted:Set[FALSE]
		}
		
		;if i am a tank and not targeting sepcific targets and they exists target them
		if !${RI_Var_Bool_GlobalOthers}
		{

			if ${Actor[namednpc,Fwump](exists)} && !${Actor[namednpc,Fwump].IsDead}
			{
				Stowaway1:Set[${Actor["a stowaway stalker"].ID}]
				Stowaway2:Set[${Actor["a stowaway stalker",notid,${Stowaway1}].ID}]
				if ${Actor[${Stowaway1}].Health}>95
					Actor[${Stowaway1}]:DoTarget
				elseif ${Actor[${Stowaway2}].Health}>95
					Actor[${Stowaway2}]:DoTarget	
				elseif ${Target.ID}!=${Actor[namednpc,Fwump].ID}
					Actor[namednpc,Fwump]:DoTarget
				FwumpSpawned:Set[TRUE]
			}
			else
			{
				if ${FwumpSpawned} && !${ReleasedTank}
				{
					;echo ${Time}: releasing tank
					relay ${RI_Var_String_RelayGroup} RI_Atom_SetLockSpot ALL -217 -49 134
					call _MoveC -217 134
					wait 5
					RI_Atom_SetLockSpot ${Me.Name} -210 -49 133 1 100

					wait 30
					; echo ${Time}: Waiting for Zaxfalump to be within 7
					; wait 50 ${Actor["Zaxfalump"].Distance}<7
					; if ${Math.Distance[${Me.Loc},-222,-49,122]}<2
						; RI_Atom_SetLockSpot ${Me.Name} -218 -49 120 1 100
					; if ${Math.Distance[${Me.Loc},-217,-49,134]}<2
						; RI_Atom_SetLockSpot ${Me.Name} -212 -49 132 1 100
					; wait 50 ${Actor["Zaxfalump"].Distance}<7
					; if ${Math.Distance[${Me.Loc},-218,-49,120]}<2
						; RI_Atom_SetLockSpot ${Me.Name} -222 -49 122 1 100
					; if ${Math.Distance[${Me.Loc},-212,-49,132]}<2
						; RI_Atom_SetLockSpot ${Me.Name} -217 -49 134 1 100
					; wait 50 ${Actor["Zaxfalump"].Distance}<7
					; echo ${Time}: Zaxfalump is within 7
					; RI_Atom_SetLockSpot off
					; RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[TRUE]
					; RI_Atom_MoveBehind ALL ${Actor["Zaxfalump"].ID} 30 100
					; echo ${Time}: Moving Behind ${Actor["Zaxfalump"]} / ${Actor["Zaxfalump"].ID} 
					; wait 50
					; RI_Atom_MoveBehind ALL OFF
					; RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[FALSE]
					; ReleasedTank:Set[TRUE]
					; echo ${Time}: Done Moving Behind ${Actor["Zaxfalump"]} / ${Actor["Zaxfalump"].ID} 
					; RI_Atom_SetLockSpot ${Me.Name}
					if ${Me.GetGameData[Self.ZoneName].Label.Find[Challenge](exists)}
						RI_Atom_SetLockSpot off
					ReleasedTank:Set[TRUE]
				}
				if ${Target.ID}!=${Actor[Zaxfalump].ID}
					Actor[Zaxfalump]:DoTarget
			}
		}
		wait 2
	}
}

function Bull()
{
	echo ISXRI: Starting BullHeroic 
	
	declare BardDone string FALSE
	;lockspot to -30,-124,-76
	RI_Atom_SetLockSpot ${Me.Name} -30 -124 -76 1 100
	wait 10
	while ${Actor["Bull McCleran"](exists)} && !${Actor["Bull McCleran"].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor["a Brokenskull Pirate",radius,15](exists)}
			{
				if ${Target.ID}!=${Actor["a Brokenskull Pirate"].ID}
					Actor["a Brokenskull Pirate"]:DoTarget
			}
			else
			{
				if ${Target.ID}!=${Actor["Bull McCleran"].ID}
					Actor["Bull McCleran"]:DoTarget
			}
		}
		elseif ${Me.Class.Equal[bard]} && !${BardDone}
		{
			;need to add code in here to wait until you are casting both.
			wait 100
			
			;turn off assisting
			RI_CMD_Assisting 0
				
			;pause bots
			RI_CMD_PauseCombatBots 1
			
			press f1
			;move to brazier, click it, move to crate, click it
			call _MoveC -22.34 -74.97
			wait 10
			while ${Actor["Boss 1 Brazier"].Interactable}
			{
				Actor["Boss 1 Brazier"]:DoubleClick
				wait 2
			}
			wait 20
			call _MoveC -29.95 -80.29
			wait 10
			while ${Actor[Crate].Interactable}
			{
				Actor[Crate]:DoubleClick
				wait 2
			}
			wait 20
			
			;move to brazier, click it, move to crate, click it
			call _MoveC -22.34 -74.97
			wait 10
			while ${Actor["Boss 1 Brazier"].Interactable}
			{
				Actor["Boss 1 Brazier"]:DoubleClick
				wait 2
			}
			wait 20
			call _MoveC -35.15 -80.76
			wait 10
			while ${Actor[Crate].Interactable}
			{
				Actor[Crate]:DoubleClick
				wait 2
			}
			wait 20
			
			;move to brazier, click it, move to crate, click it
			call _MoveC -22.34 -74.97
			wait 10
			while ${Actor["Boss 1 Brazier"].Interactable}
			{
				Actor["Boss 1 Brazier"]:DoubleClick
				wait 2
			}
			wait 20
			call _MoveC -37.48 -72.40
			wait 10
			while ${Actor[Crate].Interactable}
			{
				Actor[Crate]:DoubleClick
				wait 2
			}
			wait 20
			
			;move to brazier, click it, move to crate, click it
			call _MoveC -22.34 -74.97
			wait 10
			while ${Actor["Boss 1 Brazier"].Interactable}
			{
				Actor["Boss 1 Brazier"]:DoubleClick
				wait 2
			}
			wait 20
			call _MoveC -41.58 -80.22
			wait 10
			while ${Actor[Crate].Interactable}
			{
				Actor[Crate]:DoubleClick
				wait 2
			}
			wait 20
			
			;move to brazier, click it, move to crate, click it
			call _MoveC -22.34 -74.97
			wait 10
			while ${Actor["Boss 1 Brazier"].Interactable}
			{
				Actor["Boss 1 Brazier"]:DoubleClick
				wait 2
			}
			wait 20
			call _MoveC -43.01 -72.27
			wait 10
			while ${Actor[Crate].Interactable}
			{
				Actor[Crate]:DoubleClick
				wait 2
			}
			wait 20
			
			;move to brazier, click it, move to crate, click it
			call _MoveC -22.34 -74.97
			wait 10
			while ${Actor["Boss 1 Brazier"].Interactable}
			{
				Actor["Boss 1 Brazier"]:DoubleClick
				wait 2
			}
			wait 20
			call _MoveC -44.56 -79.94
			wait 10
			while ${Actor[Crate].Interactable}
			{
				Actor[Crate]:DoubleClick
				wait 2
			}
			wait 20
			
			;move to brazier, click it, move to crate, click it
			call _MoveC -22.34 -74.97
			wait 10
			while ${Actor["Boss 1 Brazier"].Interactable}
			{
				Actor["Boss 1 Brazier"]:DoubleClick
				wait 2
			}
			wait 20
			call _MoveC -46.78 -72.74
			wait 10
			while ${Actor[Crate].Interactable}
			{
				Actor[Crate]:DoubleClick
				wait 2
			}
			wait 20
			
			;move to brazier, click it, move to crate, click it
			call _MoveC -22.34 -74.97
			wait 10
			while ${Actor["Boss 1 Brazier"].Interactable}
			{
				Actor["Boss 1 Brazier"]:DoubleClick
				wait 2
			}
			wait 20
			call _MoveC -49.02 -79.23
			wait 10
			while ${Actor[Crate].Interactable}
			{
				Actor[Crate]:DoubleClick
				wait 2
			}
			wait 20
			
			;move to brazier, click it, move to crate, click it
			call _MoveC -22.34 -74.97
			wait 10
			while ${Actor["Boss 1 Brazier"].Interactable}
			{
				Actor["Boss 1 Brazier"]:DoubleClick
				wait 2
			}
			wait 20
			call _MoveC -51.72 -73.33
			wait 10
			while ${Actor[Crate].Interactable}
			{
				Actor[Crate]:DoubleClick
				wait 2
			}
			wait 20
			
			;move to brazier, click it, move to crate, click it
			call _MoveC -22.34 -74.97
			wait 10
			while ${Actor["Boss 1 Brazier"].Interactable}
			{
				Actor["Boss 1 Brazier"]:DoubleClick
				wait 2
			}
			wait 20
			call _MoveC -52.35 -80.09
			wait 10
			while ${Actor[Crate].Interactable}
			{
				Actor[Crate]:DoubleClick
				wait 2
			}
			wait 20
			
			;move to brazier, click it, move to crate, click it
			call _MoveC -22.34 -74.97
			wait 10
			while ${Actor["Boss 1 Brazier"].Interactable}
			{
				Actor["Boss 1 Brazier"]:DoubleClick
				wait 2
			}
			wait 20
			call _MoveC -54.94 -80.59
			wait 10
			while ${Actor[Crate].Interactable}
			{
				Actor[Crate]:DoubleClick
				wait 2
			}
			wait 20
			BardDone:Set[TRUE]
			
			;turn on assisting
			RI_CMD_Assisting 1
				
			;unpause bots
			RI_CMD_PauseCombatBots 0
			
			;move back to camp
			call _MoveC -30 -76
		}
	}
	echo Ending BullHeroic
}
function Yipnik()
{
	echo ISXRI: Starting Yipnik 
	
	;turn on lockspot to 11.78 -101.06 -5.20
	RI_Atom_SetLockSpot ${Me.Name} 11.78 -101.06 -5.20 1 100
	wait 10
	;code here to move behind / or not
	while ${Actor[Yipnik](exists)} && !${Actor[Yipnik].IsDead}
	{
		;if i am a fighter
		if !${RI_Var_Bool_GlobalOthers}
		{
			;if thick molasses exists and i am not targeting, target
			if ${Actor["thick molasses"](exists)}
			{
				if ${Target.ID}!=${Actor["thick molasses"].ID}
					Actor["thick molasses"]:DoTarget
			}
			
			;else, if i am not targeting yipnik target him
			else
			{
				if ${Target.ID}!=${Actor[Yipnik].ID}
					Actor[Yipnik]:DoTarget
			}
		}
		if ${Me.Class.Equal[bard]} || ${Me.Class.Equal[enchanter]}
		{
			if ${Actor["Boss 8 Press Click Area"].Interactable}
			{
				;pause bots
				RI_CMD_PauseCombatBots 1
				
				;move to 4.31 0.81
				call _MoveC 4.31 0.81
								
				;while the clicky is clickable keep clicking
				while ${Actor["Boss 8 Press Click Area"].Interactable}
				{
					Actor["Boss 8 Press Click Area"]:DoubleClick
					wait 2
				}
				
				;move back to camp
				call _MoveC 11.78 -5.20
				
				;unpause bots
				RI_CMD_PauseCombatBots 0
			}
		}
		wait 2
	}
	echo Ending Yipnik
}
function Grogmogo()
{
	echo ISXRI: Starting Grogmogo 
	
	;turn onm lockspot to 149.99,-23.99,119.10
	RI_Atom_SetLockSpot ${Me.Name} 149.99 -23.99 119.10 1 100
	wait 10
	
	if ${Me.Class.Equal[bard]}
	{
		;move to keg
		call _MoveC 136.77 115.04
		
		;change camera, pick up keg
		Press -hold ${RI_Var_String_LookDownKey}
		wait 5
		Actor[keg]:DoubleClick
		wait 5
		
		;move to position
		call _MoveC 156.86 112.55
		wait 10
		
		;move mouse to center of screen aka on top of you
		Mouse:SetPosition[${Math.Calc[${Display.Width}/2]},${Math.Calc[${Display.Height}/2]}]
		wait 2
		
		;click to place
		Mouse:LeftClick
		
		wait 5
		Press -release ${RI_Var_String_LookDownKey}
		Press -hold ${RI_Var_String_LookUpKey}
		wait 2
		Press -release ${RI_Var_String_LookUpKey}
		
		;move back to camp
		call _MoveC 149.99 119.10
	}
	
	wait 300 ${Actor[Grogmogo].IsAggro}
	
	while ${Actor[Grogmogo](exists)} && !${Actor[Grogmogo].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor[Grogmogo].ID}
				Actor[Grogmogo]:DoTarget
		}
		if ${Me.Class.Equal[bard]} && !${Actor[Grogmogo].IsAggro}
		{
			;check if rum bottle is interactable (clickable) and if so move to it and click it
			if ${Actor[loc,130.382996,117.239197].Interactable}
			{
				call _MoveC 131 118
				wait 2
				while ${Actor[loc,130.382996,117.239197].Interactable}
				{
					Actor[loc,130.382996,117.239197]:DoubleClick
					Actor["Boss 7 Rum Bottle"]:DoubleClick
					wait 2
				}
			}
			;check if rum bottle is interactable (clickable) and if so move to it and click it
			elseif ${Actor[loc,133.386200,108.503899].Interactable}
			{
				call _MoveC 134.37 109.82
				wait 2
				while ${Actor[loc,133.386200,108.503899].Interactable}
				{
					Actor[loc,133.386200,108.503899]:DoubleClick
					Actor["Boss 7 Rum Bottle"]:DoubleClick
					wait 2
				}
			}
			;check if rum bottle is interactable (clickable) and if so move to it and click it
			elseif ${Actor[loc,141.726395,110.440498].Interactable}
			{
				call _MoveC 142.90 111.60
				wait 2
				while ${Actor[loc,141.726395,110.440498].Interactable}
				{
					Actor[loc,141.726395,110.440498]:DoubleClick
					Actor["Boss 7 Rum Bottle"]:DoubleClick
					wait 2
				}
			}
			;check if rum bottle is interactable (clickable) and if so move to it and click it
			elseif ${Actor[loc,142.751602,100.730904].Interactable}
			{
				call _MoveC 142.88 101.80
				wait 2
				while ${Actor[loc,142.751602,100.730904].Interactable}
				{
					Actor[loc,142.751602,100.730904]:DoubleClick
					Actor["Boss 7 Rum Bottle"]:DoubleClick
					wait 2
				}
			}
			;check if rum bottle is interactable (clickable) and if so move to it and click it
			elseif ${Actor[loc,150.384399,99.167526].Interactable}
			{
				call _MoveC 150.05 100.63
				wait 2
				while ${Actor[loc,150.384399,99.167526].Interactable}
				{
					Actor[loc,150.384399,99.167526]:DoubleClick
					Actor["Boss 7 Rum Bottle"]:DoubleClick
					wait 2
				}
			}
			;check if rum bottle is interactable (clickable) and if so move to it and click it
			elseif ${Actor[loc,159.124893,105.567299].Interactable}
			{
				call _MoveC 157.57 107.10
				wait 2
				while ${Actor[loc,159.124893,105.567299].Interactable}
				{
					Actor[loc,159.124893,105.567299]:DoubleClick
					Actor["Boss 7 Rum Bottle"]:DoubleClick
					wait 2
				}
			}
			;check if rum bottle is interactable (clickable) and if so move to it and click it
			elseif ${Actor[loc,164.136395,107.803497].Interactable}
			{
				call _MoveC 162.64 108.51
				wait 2
				while ${Actor[loc,164.136395,107.803497].Interactable}
				{
					Actor[loc,164.136395,107.803497]:DoubleClick
					Actor["Boss 7 Rum Bottle"]:DoubleClick
					wait 2
				}
			}
			;check if rum bottle is interactable (clickable) and if so move to it and click it
			elseif ${Actor[loc,165.475693,117.599602].Interactable}
			{
				call _MoveC 163.67 117.46
				wait 2
				while ${Actor[loc,165.475693,117.599602].Interactable}
				{
					Actor[loc,165.475693,117.599602]:DoubleClick
					Actor["Boss 7 Rum Bottle"]:DoubleClick
					wait 2
				}
			}
			;check if rum bottle is interactable (clickable) and if so move to it and click it
			elseif ${Actor[loc,164.914902,123.747597].Interactable}
			{
				call _MoveC 163.74 123.90
				wait 2
				while ${Actor[loc,164.914902,123.747597].Interactable}
				{
					Actor[loc,164.914902,123.747597]:DoubleClick
					Actor["Boss 7 Rum Bottle"]:DoubleClick
					wait 2
				}
			}
			;check if rum bottle is interactable (clickable) and if so move to it and click it
			elseif ${Actor[loc,163.712204,128.786606].Interactable}
			{
				call _MoveC 162.26 127.58
				wait 2
				while ${Actor[loc,163.712204,128.786606].Interactable}
				{
					Actor[loc,163.712204,128.786606]:DoubleClick
					Actor["Boss 7 Rum Bottle"]:DoubleClick
					wait 2
				}
			}
			;check if rum bottle is interactable (clickable) and if so move to it and click it
			elseif ${Actor[loc,160.756104,133.981506].Interactable}
			{
				call _MoveC 159.87 132.40
				wait 2
				while ${Actor[loc,160.756104,133.981506].Interactable}
				{
					Actor[loc,160.756104,133.981506]:DoubleClick
					Actor["Boss 7 Rum Bottle"]:DoubleClick
					wait 2
				}
			}
			;check if rum bottle is interactable (clickable) and if so move to it and click it
			elseif ${Actor[loc,152.699600,136.929504].Interactable}
			{
				call _MoveC 152.46 135.66
				wait 2
				while ${Actor[loc,152.699600,136.929504].Interactable}
				{
					Actor[loc,152.699600,136.929504]:DoubleClick
					Actor["Boss 7 Rum Bottle"]:DoubleClick
					wait 2
				}
			}
			;check if rum bottle is interactable (clickable) and if so move to it and click it
			elseif ${Actor[loc,145.878098,138.649796].Interactable}
			{
				call _MoveC 146.03 137.89
				wait 2
				while ${Actor[loc,145.878098,138.649796].Interactable}
				{
					Actor[loc,145.878098,138.649796]:DoubleClick
					Actor["Boss 7 Rum Bottle"]:DoubleClick
					wait 2
				}
			}
			;check if rum bottle is interactable (clickable) and if so move to it and click it
			elseif ${Actor[loc,143.169495,134.121994].Interactable}
			{
				call _MoveC 144.01 132.37
				wait 2
				while ${Actor[loc,143.169495,134.121994].Interactable}
				{
					Actor[loc,143.169495,134.121994]:DoubleClick
					Actor["Boss 7 Rum Bottle"]:DoubleClick
					wait 2
				}
			}
			;check if rum bottle is interactable (clickable) and if so move to it and click it
			elseif ${Actor[loc,139.131805,131.914093].Interactable}
			{
				call _MoveC 140.22 130.58
				wait 2
				while ${Actor[loc,139.131805,131.914093].Interactable}
				{
					Actor[loc,139.131805,131.914093]:DoubleClick
					Actor["Boss 7 Rum Bottle"]:DoubleClick
					wait 2
				}
			}
			wait 20
			
			;move back to camp
			call _MoveC 149.99 119.10
		}
		wait 2
	}
	echo Ending Grogmogo
}
function Charanda()
{
	echo ISXRI: Starting CharandaHeroic 
	
	;turn on lockspot to -46.66,-97.14,81.65
	RI_Atom_SetLockSpot ${Me.Name} -46.66 -97.14 81.65
	wait 10
	;code here to move behind
	while ${Actor[Charanda](exists)} && !${Actor[Charanda].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor["Portia Rumuffin's Corpse"](exists)} && ${Actor["Portia Rumuffin's Corpse"].IsAggro}
			{
				if ${Target.ID}!=${Actor["Portia Rumuffin's Corpse"].ID}
					Actor["Portia Rumuffin's Corpse"]:DoTarget
			}
			else
			{
				if ${Target.ID}!=${Actor[Charanda].ID}
					Actor[Charanda]:DoTarget
			}
		}
		if ${Actor["Curse"](exists)}
		{
			RI_Atom_SetLockSpot ${Me.Name} -41.15 -97.44 99.51
			wait 110 !${Actor["Curse"](exists)}
			RI_Atom_SetLockSpot ${Me.Name} -46.66 -97.14 81.65
			wait 20
		}
		wait 2
	}
	echo Ending CharandaHeroic
	RI_Atom_SetLockSpot ${Me.Name} -45.15 -97.44 86.51
}

function Corsair()
{
	;events
	Event[EQ2_onIncomingText]:AttachAtom[EQ2_onIncomingTextCorsair]
	;RI_Var_Bool_Loot:Set[FALSE]
	;RI_Var_Bool_CorpseLoot:Set[FALSE]
	echo ISXRI: Starting "The Red Corsair" v2
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert[The Red Corsair/a says, FIRE!]
	;turn on lockspot too -112.53 190.01
	RI_Atom_SetLockSpot ${Me.Name} -111.53 -101.08 190.01
	
	wait 10
	;tank run to cannon, grab it, place it
	if !${RI_Var_Bool_GlobalOthers}
	{
		;move to cannon
		call _MoveC -72.13 217.45
		call _MoveC -33.07 210.90
		
		;change camera, pick up Cannon
		Press -hold ${RI_Var_String_LookDownKey}
		wait 5
		Actor[Cannon]:DoubleClick
		wait 5
		
		;move to position
		call _MoveC -33.07 210.90
		call _MoveC -72.13 217.45
		call _MoveC -110.53 193.01
		call _MoveC -117.38 185.46
		call _MoveC -105.01 170.01
		wait 10
		
		;move mouse to just above center of screen aka on top of you and up
		Mouse:SetPosition[${Math.Calc[${Display.Width}/2]},${Math.Calc[(${Display.Height}/2)-((${Display.Height}/2)*.1)]}]
		wait 2
		
		;click to place
		Mouse:LeftClick
		
		wait 10
		
		;code to point cannon.
		while ${Actor[Cannon Placement 1](exists)}
		{
			;pickup the cannon again
			eq2ex apply_verb ${Actor["Movable Cannon"].ID} Move
			wait 5
			
			;scroll the mouse wheel
			MouseWheel -500
			wait 5
			
			;move mouse to just above center of screen aka on top of you and up
			Mouse:SetPosition[${Math.Calc[${Display.Width}/2]},${Math.Calc[(${Display.Height}/2)-((${Display.Height}/2)*.1)]}]
			wait 5
			
			;click to place
			Mouse:LeftClick
		}
		Press -release ${RI_Var_String_LookDownKey}
		wait 5
		Press -hold ${RI_Var_String_LookUpKey}
		wait 2
		Press -release ${RI_Var_String_LookUpKey}
		call _MoveC -105.01 170.91
		call _MoveC -117.38 185.46
		call _MoveC -111.53 190.01
	}
	while ${Actor[Cannon Placement 1](exists)}
		wait 2
	;AnnounceText:Clear
	;AnnounceText:Insert[FIRE!]
	
	declare ActorIndex index:actor
	
	while ${Actor["The Red Corsair"](exists)} && !${Actor["The Red Corsair"].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor["a corsair cannoneer"](exists)}
			{
				EQ2:GetActors[ActorIndex,"a corsair cannoneer"]
				if ${Target.ID}!=${ActorIndex[1].ID} && !${ActorIndex[1].IsDead}
					ActorIndex[1]:DoTarget
			}
			else
			{
				if ${Target.ID}!=${Actor["The Red Corsair"].ID}
					Actor["The Red Corsair"]:DoTarget
			}
		}
		if ${Me.Archetype.NotEqual[fighter]}
		{
			if ${Actor[cannoneer,radius,7](exists)}
			{
				if ${RI_Var_Bool_Debug}
					echo ${Time}: Looting ${Actor[cannoneer,radius,10]}
				eq2ex apply_verb ${Actor[cannoneer,radius,10].ID} Loot
				wait 5
				LootWindow:LootAll
			}
			;if she begins firing move back to camp
			;if ${Trigger} 
			;&& ${Math.Distance[${Me.X},${Me.Z},-110.53,193.01]}>5
			;{
				;call _MoveC -112.53 190.01
				;wait 60
				;Trigger:Set[FALSE]
			;}
			;bard when we have a cannonball, move to cannon when not ${Trigger}, and fire
			if ${Trigger}
			{
				wait 70
				Trigger:Set[FALSE]
			}
			if ${Me.Inventory["a cannonball"](exists)} && !${Trigger}
			{
				;turn off assisting
				RI_CMD_Assisting 0
				
				;pause bots
				RI_CMD_PauseCombatBots 1
				
				Actor["The Red Corsair"]:DoTarget
				if ${Math.Distance[${Me.X},${Me.Z},-105.01,170.91]}>5
					call _MoveC -105.01 170.91
				wait 10 ${Trigger}
				Actor["Cannon 1"]:DoubleClick
				wait 15 ${Trigger}
				Actor["Cannon 1"]:DoubleClick
				wait 15 ${Trigger}
				press f1
				wait 2 ${Trigger}
				Actor["The Red Corsair"]:DoubleClick
				wait 1 ${Trigger}
				Actor["The Red Corsair"]:DoTarget
				eq2ex apply_verb ${Actor["The Red Corsair"].ID} Fire
				wait 35 ${Trigger}
				
				;unpause bots
				RI_CMD_PauseCombatBots 0
				
				;turn on assisting
				RI_CMD_Assisting 1
				
			}
			if ${Math.Distance[${Me.X},${Me.Z},-112.53,190.01]}>5
				RI_Atom_ChangeLockSpot ALL -111.53 0 190.01
		}
		wait 2
	}
	;change lootoptions to roundrobin,turn looting back on, 
	;reenable caststack
	;call LootOptions RoundRobin
	wait 5
	;RI_Var_Bool_CorpseLoot:Set[TRUE]
	;RI_Var_Bool_Loot:Set[TRUE]
	
	;unpause bots
	RI_CMD_PauseCombatBots 0
	
	;turn on assisting
	RI_CMD_Assisting 1
	
	;detach atom
	Event[EQ2_onIncomingText]:DetachAtom[EQ2_onIncomingTextCorsair]
	
	echo Ending "The Red Corsair"
}
;atom triggered when incommingtext is detected
atom EQ2_onIncomingTextCorsair(string Text)
{
	
   	if ${Text.Find["The Red Corsair"](exists)} && ${Text.Find["says"](exists)} && ${Text.Find["FIRE!"](exists)}
	{
		echo ${Time}:IncomingText: ${Text}
		Trigger:Set[TRUE]
	}
}
function Grogmaga()
{
	echo ISXRI: Starting Grogmaga 
	
	;turn on lockspot to -170.655060 -70.852097 89.121651
	RI_Atom_SetLockSpot ${Me.Name} -170.655060 -70.852097 89.121651
	wait 10
	;code here to move behind
	while ${Actor[Grogmaga](exists)} && !${Actor[Grogmaga].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor[Grogmaga].ID}
				Actor[Grogmaga]:DoTarget
		}
		if ${Actor["Bed 11"].Interactable}
		{
			;pause bots
			RI_CMD_PauseCombatBots 1
				
			;click bed 11 until its no longer clickable
			while ${Actor["Bed 11"].Interactable}
			{
				Actor["Bed 11"]:DoubleClick
				wait 2
			}
			
			;unpause bots
			RI_CMD_PauseCombatBots 0
		}
		wait 1
	}
	echo Ending Grogmaga
	;RI_Atom_SetLockSpot ${Me.Name} -45.15 -97.44 86.51
}

function D'Vinn()
{
	echo ISXRI: Starting D'Vinn 
	
	;turn on lockspot to -166.672516 11.480156 -8.964397
	RI_Atom_SetLockSpot ${Me.Name} -166.672516 11.480156 -8.964397
	wait 10
	if ${Me.Archetype.NotEqual[fighter]}
	{
		RI_Atom_SetLockSpot OFF
		RI_Atom_MoveBehind ALL ${Actor["Emperor D'Vinn"].ID} 30 100
	}
	while ${Actor["Emperor D'Vinn"](exists)} || ${Actor["Shadow of D'Vinn"](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor["Shadow of D'Vinn"](exists)}
				Actor["Shadow of D'Vinn"]:DoTarget
			elseif ${Target.ID}!=${Actor["Emperor D'Vinn"].ID}
				Actor["Emperor D'Vinn"]:DoTarget
		}
		wait 1
	}
	echo Ending D'Vinn
}
function CourtPowerCells()
{	
	;Script[Buffer:AggroControl].Variable[TrashTargeting]:Set[FALSE]
	if !${RI_Var_Bool_GlobalOthers}
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call CourtPowerCells"]
	RI_Atom_SetLockSpot ALL -6.453318 14.054948 309.695282
	AnnounceText:Clear
	AnnounceText:Insert["Force shield for Power Cell D has been deactivated"]
	declare CourtFighterDone bool FALSE
	declare CourtBardDone bool FALSE
	while !${Trigger} 
	{
		;echo ${Time}: in first loop
		if !${RI_Var_Bool_GlobalOthers} && !${CourtFighterDone}
		{
			call _MoveC 13.21 310.44
			wait 10
			call _MoveC 11.48 257.18
			wait 10
			call _MoveC 5.39 256.77
			wait 10
			call _MoveC 4.49 269.57
			wait 5
			call _MoveC 8.43 270.42
			wait 5
			call _MoveC 8.75 278.51
			call _MoveC -6.26 279.96
			call _MoveC -6.453318 309.695282
			CourtFighterDone:Set[TRUE]
		}
		wait 50
		if ${Me.Class.Equal[bard]} && !${CourtBardDone}
		{
			;pause bots
			RI_CMD_PauseCombatBots 1
				
			;turn off assisting
			RI_CMD_Assisting 0
			
			Actor[${Me.ID}]:DoTarget
			call _MoveC 13.21 310.44 FALSE TRUE
			wait 10
			call _MoveC 11.48 257.18 FALSE TRUE
			wait 10
			call _MoveC 5.39 256.77 FALSE TRUE
			wait 10
			call _MoveC 4.49 269.57 FALSE TRUE
			wait 5
			call _MoveC 8.43 270.42 FALSE TRUE
			wait 5
			call _MoveC 8.75 278.51 FALSE TRUE
			wait 10
			;activate PCD
			;lever1
			Actor[loc,10.226260,279.910187]:DoubleClick
			wait 20
			;lever2
			Actor[loc,9.127361,279.860901]:DoubleClick
			wait 20
			;lever1
			Actor[loc,10.226260,279.910187]:DoubleClick
			wait 20
			;lever2
			Actor[loc,9.127361,279.860901]:DoubleClick
			wait 20
			;activate PCA
			;lever3
			Actor[loc,8.028465,279.811493]:DoubleClick
			wait 20
			;lever4
			Actor[loc,6.929599,279.762085]:DoubleClick
			wait 20
			;lever3
			Actor[loc,8.028465,279.811493]:DoubleClick
			wait 20
			;lever4
			Actor[loc,6.929599,279.762085]:DoubleClick
			wait 20
			;activate PCB
			;lever1
			Actor[loc,10.226260,279.910187]:DoubleClick
			wait 20
			;lever3
			Actor[loc,8.028465,279.811493]:DoubleClick
			wait 20
			;lever1
			Actor[loc,10.226260,279.910187]:DoubleClick
			wait 20
			;lever3
			Actor[loc,8.028465,279.811493]:DoubleClick
			wait 20
			;activate PCC
			;lever2
			Actor[loc,9.127361,279.860901]:DoubleClick
			wait 20
			;lever4
			Actor[loc,6.929599,279.762085]:DoubleClick
			wait 20
			call _MoveC -6.26 279.96 FALSE TRUE
			call _MoveC -6.453318 309.695282
			CourtBardDone:Set[TRUE]
			;unpause bots
			RI_CMD_PauseCombatBots 0
				
			;turn on assisting
			RI_CMD_Assisting 1
		}
		wait 1
	}
	while ${Actor[npc,"Power Cell D"](exists)}
	{
		;echo ${Time}: in d loop
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor[npc,"Power Cell D"].ID}
				Actor[npc,"Power Cell D"]:DoTarget
		}
		wait 1
	}
	wait 600 ${Actor[npc,"Power Cell A"](exists)}
	while ${Actor[npc,"Power Cell A"](exists)}
	{
		;echo ${Time}: in a loop
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor[npc,"Power Cell A"].ID}
				Actor[npc,"Power Cell A"]:DoTarget
		}
		wait 1
	}
	wait 600 ${Actor[npc,"Power Cell C"](exists)} 
	while ${Actor[npc,"Power Cell C"](exists)} 
	{
		;echo ${Time}: in c loop
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor[npc,"Power Cell C"].ID}
				Actor[npc,"Power Cell C"]:DoTarget
		}
		wait 1
	}
	wait 600 ${Actor[npc,"Power Cell B"](exists)} 
	while ${Actor[npc,"Power Cell B"](exists)}
	{
		;echo ${Time}: in b loop
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor[npc,"Power Cell B"].ID}
				Actor[npc,"Power Cell B"]:DoTarget
		}
		wait 1
	}
	;Script[Buffer:AggroControl].Variable[TrashTargeting]:Set[TRUE]
}
function KingOLD()
{
	echo ISXRI: Starting King 
	
	;turn on lockspot to -166.672516 11.480156 -8.964397
	if !${RI_Var_Bool_GlobalOthers}
	{
		RI_Atom_SetLockSpot ${Me.Name} -31.312376 58.702354 -60.230434
	}
	else
	{
		RI_Atom_SetLockSpot ${Me.Name} -37.171376 58.702354 -51.880434
	}
	;king1 section
	if !${RI_Var_Bool_GlobalOthers}
	{
		RI_Atom_SetLockSpot ${Me.Name} -39.88 58.69 -30.51
		wait 100 ${Math.Distance[${Me.Loc},-39.88,58.69,-30.51]}<3
		wait 10
		Actor[King]:DoTarget
		wait 50 ${Actor[King].Distance}<10
		RI_Atom_SetLockSpot ${Me.Name} -31.312376 58.702354 -60.230434
	}
	while ${Actor[King](exists)} && !${Actor[King].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor["King"].ID}
				Actor["King"]:DoTarget
		}
	}
	wait 50
	relay ${RI_Var_String_RelayGroup} Actor[special]:DoubleClick
	relay ${RI_Var_String_RelayGroup} Actor[special]:DoubleClick
	wait 500 ${Actor["Master Clockwork Protocol"](exists)}
	relay ${RI_Var_String_RelayGroup} Actor[special]:DoubleClick
	relay ${RI_Var_String_RelayGroup} Actor[special]:DoubleClick
	declare MCPID int ${Actor["Master Clockwork Protocol"].ID}
	while ${Actor[${MCPID}](exists)} && !${Actor[${MCPID}].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor["a mechnamagica seeker-destroyer",radius,20](exists)}
				Actor["a mechnamagica seeker-destroyer",radius,20]:DoTarget
			elseif ${Actor["a klakdyne omega magus",radius,20](exists)}
				Actor["a klakdyne omega magus",radius,20]:DoTarget
			elseif ${Target.ID}!=${Actor["Master Clockwork Protocol"].ID}
				Actor["Master Clockwork Protocol"]:DoTarget
		}
		if ${Actor["Master Clockwork Protocol"].Health}<=16 && ${Me.Inventory["Energized Clockwork Gear"](exists)}
			Me.Inventory["Energized Clockwork Gear"]:Use
		wait 1
	}
	wait 600 ${Actor["Master Clockwork Protocol",notid,${MCPID}](exists)}
	if ${Me.Archetype.NotEqual[fighter]}
	{
		RI_Atom_MoveBehind ALL ${Actor["Master Clockwork Protocol",notid,${MCPID}].ID} 30 100
	}
	while ${Actor["Master Clockwork Protocol",notid,${MCPID}](exists)} && !${Actor["Master Clockwork Protocol",notid,${MCPID}].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor["Master Clockwork Protocol",notid,${MCPID}].ID}
				Actor["Master Clockwork Protocol",notid,${MCPID}]:DoTarget
		}
		wait 1
	}
	echo Ending Protocol
}
function War()
{
	echo ISXRI: Starting War 
	
	if !${RI_Var_Bool_GlobalOthers}
	{
		;turn on lockspot to -52.12 -0.42 -11.60
		RI_Atom_SetLockSpot ${Me.Name} -52.12 -0.42 -11.60
		wait 20
		Actor["The War Ancient of Zek"]:DoTarget
		while !${Me.RangedAutoAttackOn}
		{
			eq2ex togglerangedattack
			wait 2
		}
		wait 50 ${Math.Distance[${Me.Loc},-52.12,-0.42,-11.60}]}<2
		wait 20
	}
	else
	{
		;turn off assisting
		RI_CMD_Assisting 0
		
		wait 1
		;target self
		Actor[${Me.ID}]:DoTarget
		RI_Atom_SetLockSpot ${Me.Name} -1.615160 -0.661638 -11.359447
		wait 50
		RI_Atom_SetLockSpot OFF
		wait 1
		RI_Atom_MoveBehind ALL ${Actor["The War Ancient of Zek"].ID} 60 100
		
		;turn on assisting
		RI_CMD_Assisting 1
	}
	Actor[Mission]:DoubleClick
	while ${Actor["The War Ancient of Zek"](exists)} && !${Actor["The War Ancient of Zek"].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor["Crushbone",radius,10](exists)} && !${Actor["Crushbone",radius,10].IsDead}
				Actor["Crushbone",radius,10]:DoTarget
			elseif ${Target.ID}!=${Actor["The War Ancient of Zek"].ID}
				Actor["The War Ancient of Zek"]:DoTarget
		}
		wait 1
	}
	echo Ending War
}
function ValdoonRing()
{
	echo ISXRI: Starting ValdoonRing 
	
	;turn on lockspot to 175.551132 -3.739999 -51.235317
	RI_Atom_SetLockSpot ${Me.Name} 175.551132 -3.739999 -51.235317
	
	wait 50 ${Math.Distance[${Me.Loc},-52.12,-0.42,-11.60]}<2
	
	wait 10
	
	Actor[Valdoon]:DoubleClick
	wait 2
	Actor[Valdoon]:DoubleClick
	wait 2
	Actor[Valdoon]:DoubleClick
	wait 2
	Actor[Valdoon]:DoubleClick
	wait 2
	
	wait 1200 ${Actor["crypt guardian",radius,50](exists)}
	
	while ${Actor["crypt guardian",radius,50](exists)}
	{
		Actor["crypt guardian",radius,50]:DoTarget
		wait 5
	}
	
	;turn on lockspot to 178.247620 -3.779751 -48.961185
	RI_Atom_SetLockSpot ${Me.Name} 178.247620 -3.779751 -48.961185
	
	while ${Actor[Valdoon](exists)} && !${Actor[Valdoon].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor[Valdoon].ID}
				Actor[Valdoon]:DoTarget
		}
		wait 1
	}
	echo Ending ValdoonRing
}
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; END OF AOM NAMED CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; START OF TOT NAMED CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;


function InkLurkerFN()
{
	;AnnounceText:Clear
	;AnnounceText:Insert["Force shield for Power Cell D has been deactivated"]
	;declare GotAll6 bool FALSE
	declare cnt int 0
	declare MobWithFurthestDistance int 0
	
	variable index:actor ActorIndex
	
	;while !${GotAll6}
	while ${Actor["The Ink Walker"].Type.NotEqual[NamedNPC]}
	{
		;populate actors to our ActorIndex that are NPC and within distance 8
		EQ2:GetActors[ActorIndex,NoKillNPC,"an ink lurker"]
		
		;echo ${Time}: ActorIndexSize: ${ActorIndex.Used}
			
		;for loop to iterate through all actors in our index
		for(cnt:Set[1];${cnt}<=${ActorIndex.Used};cnt:Inc)
		{
			;echo Checking ${ActorIndex[${cnt}].Name}
			
			if ${Math.Distance[${ActorIndex[${cnt}].Loc},-136.33,3.84,128.67]}>${Math.Distance[${Actor[${MobWithFurthestDistance}].Loc},-136.33,3.84,128.67]}
				MobWithFurthestDistance:Set[${ActorIndex[${cnt}].ID}]
			
			;echo checking ${cnt}
		}
		;turn on lockspot to ${MobWithFurthestDistance}
		if ${MobWithFurthestDistance}>0
			RI_Atom_SetLockSpot ${Me.Name} ${Actor[${MobWithFurthestDistance}].X} ${Actor[${MobWithFurthestDistance}].Y} ${Actor[${MobWithFurthestDistance}].Z}
			
		;check if we are incombat
		call RIMObj.CheckCombat TRUE

		wait 5
	}
}
function Nocturna()
{
	echo ISXRI: Starting Nocturna 
	
	declare ElementalConfinementMainIconID int 755
	
	RI_Atom_SetLockSpot FIGHTER 127.60 87.86 279.65

	while ${Actor["Nocturna"](exists)} && !${Actor["Nocturna"].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor["Diurna"](exists)} && !${Actor["Diurna"].IsDead}
			{
				if ${Target.ID}!=${Actor["Diurna"].ID}
					Actor["Diurna"]:DoTarget
			}
			else
			{
				if ${Target.ID}!=${Actor["Nocturna"].ID}
					Actor["Nocturna"]:DoTarget
			}
		}

		if ${Actor["Diurna"].Effect[1].MainIconID}==${ElementalConfinementMainIconID} || ${Actor["Diurna"].Effect[2].MainIconID}==${ElementalConfinementMainIconID} || ${Actor["Diurna"].Effect[3].MainIconID}==${ElementalConfinementMainIconID} || ${Actor["Diurna"].Effect[4].MainIconID}==${ElementalConfinementMainIconID} || ${Actor["Diurna"].Effect[5].MainIconID}==${ElementalConfinementMainIconID} 
		{
			RI_Atom_SetLockSpot ALL ${Actor["Diurna"].X} ${Actor["Diurna"].Y} ${Actor["Diurna"].Z}
			wait 300 ${Actor["Diurna"].Distance}<10
			RI_CMD_Cast "Absorb Magic" 1
			wait 30
		}
		else
		{
			RI_Atom_SetLockSpot ALL 204.44 31.45 -514.38
			wait 30
		}

		wait 1
	}
	
	echo Ending Nocturna
}
function Heracyne()
{
	echo ISXRI: Starting Heracyne 
	
	;turn on lockspot to -319.170471 51.213074 -60.860703
	RI_Atom_SetLockSpot ${Me.Name} -319.170471 51.213074 -60.860703
	
	wait 50 ${Math.Distance[${Me.Loc},-319.170471,51.213074,-60.860703]}<2
	
	while ${Actor[Heracyne](exists)} && !${Actor[Heracyne].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor[Heracyne].ID}
				Actor[Heracyne]:DoTarget
		}
		wait 1
		if ${Me.IsFD}
			press x
	}
	echo Ending Heracyne
}
function Mawz()
{
	echo ISXRI: Starting Mawz 
	
	declare BardDone string FALSE
	declare FervorOfTheUnderfootMainIconID int 485
	
	RI_Atom_SetLockSpot ALL 53.84 87.86 234.10
	
	;target mawz, wait until he is aggro on us.
	if !${RI_Var_Bool_GlobalOthers}
	{
		if ${Target.ID}!=${Actor["Mawz Harak"].ID}
			Actor["Mawz Harak"]:DoTarget
	}
	
	wait 300 ${Actor["Mawz Harak"].Distance}<15
	
	RI_Atom_SetLockSpot ALL 47.132492 87.863281 219.655853
	wait 300 ${Actor["Mawz Harak"].Distance}<12
	RI_Atom_SetLockSpot FIGHTER 46.50 87.86 210.11

	while ${Actor["Mawz Harak"](exists)} && !${Actor["Mawz Harak"].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor["Mawz Harak"].ID}
				Actor["Mawz Harak"]:DoTarget
		}
		elseif ${Me.Class.Equal[bard]}
		{
			if ${Actor["Mawz Harak"].Effect[1].MainIconID}==${FervorOfTheUnderfootMainIconID} && ${Actor["Mawz Harak"].Effect[1].CurrentIncrements}>50
				call ClearFervor
			elseif ${Actor["Mawz Harak"].Effect[2].MainIconID}==${FervorOfTheUnderfootMainIconID} && ${Actor["Mawz Harak"].Effect[2].CurrentIncrements}>50
				call ClearFervor
			elseif ${Actor["Mawz Harak"].Effect[3].MainIconID}==${FervorOfTheUnderfootMainIconID} && ${Actor["Mawz Harak"].Effect[3].CurrentIncrements}>50
				call ClearFervor
			elseif ${Actor["Mawz Harak"].Effect[4].MainIconID}==${FervorOfTheUnderfootMainIconID} && ${Actor["Mawz Harak"].Effect[4].CurrentIncrements}>50 
				call ClearFervor
			elseif ${Actor["Mawz Harak"].Effect[5].MainIconID}==${FervorOfTheUnderfootMainIconID} && ${Actor["Mawz Harak"].Effect[5].CurrentIncrements}>50
				call ClearFervor
			else
				wait 50
		}
		wait 1
	}
	echo Ending Mawz
}

function ClearFervor()
{
	;declare actor index
	variable index:actor ActorIndex
	;pause bots
	RI_CMD_PauseCombatBots 1
	call _MoveC 62.95 228.54 FALSE TRUE
	call _MoveC 94.72 209.26 FALSE TRUE
	call _MoveC 74.73 189.84 FALSE TRUE
	call _MoveC 61.07 183.44 FALSE TRUE
	call _MoveC 53.81 190.52 FALSE TRUE
	call _MoveC 61.64 220.99 FALSE TRUE
	Actor[Crystal]:DoubleClick
	wait 2
	Actor[Crystal]:DoubleClick
	wait 30
	call _MoveC 53.81 190.52 FALSE TRUE
	call _MoveC 59.55 184.39 FALSE TRUE
	call _MoveC 86.29 191.10 FALSE TRUE
	call _MoveC 92.18 211.79 FALSE TRUE
	call _MoveC 67.07 246.26 FALSE TRUE
	
	wait 10
	;populate actors to our ActorIndex that are a snarling spirit
	EQ2:GetActors[ActorIndex,"a snarling spirit"]
	
	call _MoveC ${ActorIndex[1].X} ${ActorIndex[1].Z}
	wait 10
	Actor["a snarling spirit"]:DoubleClick
	wait 2
	Actor["a snarling spirit"]:DoubleClick
	wait 50
	;wait 100 !${Actor["a snarling spirit"].IsIdle}
	call _MoveC ${ActorIndex[2].X} ${ActorIndex[2].Z}
	wait 10
	Actor["a snarling spirit"]:DoubleClick
	wait 2
	Actor["a snarling spirit"]:DoubleClick
	wait 50
	;wait 100 !${Actor["a snarling spirit"].IsIdle}
	call _MoveC ${ActorIndex[3].X} ${ActorIndex[3].Z}
	wait 10
	Actor["a snarling spirit"]:DoubleClick
	wait 2
	Actor["a snarling spirit"]:DoubleClick
	wait 50
	call _MoveC 47.132492 219.655853
	;unpause bots
	RI_CMD_PauseCombatBots 0
	eq2ex target_none
}

function Bailey()
{
	echo ISXRI: Starting Bailey 

	declare YellowBackDropIconID int 485
	declare RedBackDropIconID int 485
	declare BlueBackDropIconID int 485
	declare MainIconID int 357
	
	RI_Atom_SetLockSpot ALL 1.62 -9.56 15.22
	
	;target Bailey, wait until he is aggro on us.
	if !${RI_Var_Bool_GlobalOthers}
	{
		if ${Target.ID}!=${Actor[NamedNPC,"Barnum Bingling"].ID}
			Actor["Barnum Bingling"]:DoTarget
	}

	while ${Actor[NamedNPC,"Bailey Bingling"](exists)} && !${Actor[NamedNPC,"Bailey Bingling"].IsDead}
	{
		if ${Actor[NamedNPC,"Barnum Bingling"](exists)} && !${Actor[NamedNPC,"Barnum Bingling"].IsDead}
		{
			if !${RI_Var_Bool_GlobalOthers}
			{
				if ${Target.ID}!=${Actor[NamedNPC,"Barnum Bingling"].ID}
					Actor["Barnum Bingling"]:DoTarget
			}
			if ${Actor[NamedNPC,"Barnum Bingling"].Effect[1].MainIconID}==${MainIconID}
			{
				switch ${Actor[NamedNPC,"Barnum Bingling"].Effect[1].BackDropIconID}
				{
					;yellow
					case 33085
					{
						if ${Math.Distance[${Me.Loc},-43.544041,-10.345064,17.085676]}>5
						{
							call _MoveC -43.54 17.09 TRUE
						}
						break
					}
					;red
					case 33083
					{
						if ${Math.Distance[${Me.Loc},-10.018149,-10.345072,-5.996769]}>5
						{
							call _MoveC -10.02 -6 FALSE TRUE
						}
						break
					}
					;blue
					case 33081
					{
						if ${Math.Distance[${Me.Loc},17.392654,-6.107872,23.880922]}>5
						{
							call _MoveC 19.52 15.78 FALSE TRUE
							call _MoveC 17.39 23.88 FALSE TRUE
						}
						break
					}
				}
			}
			elseif ${Actor[NamedNPC,"Barnum Bingling"].Effect[2].MainIconID}==${MainIconID}
			{
				switch ${Actor[NamedNPC,"Barnum Bingling"].Effect[2].BackDropIconID}
				{
					;yellow
					case 33085
					{
						if ${Math.Distance[${Me.Loc},-43.544041,-10.345064,17.085676]}>5
						{
							call _MoveC -43.54 17.09 TRUE
						}
						break
					}
					;red
					case 33083
					{
						if ${Math.Distance[${Me.Loc},-10.018149,-10.345072,-5.996769]}>5
						{
							call _MoveC -10.02 -6 FALSE TRUE
						}
						break
					}
					;blue
					case 33081
					{
						if ${Math.Distance[${Me.Loc},17.392654,-6.107872,23.880922]}>5
						{
							call _MoveC 19.52 15.78 FALSE TRUE
							call _MoveC 17.39 23.88 FALSE TRUE
						}
						break
					}
				}
			}
			elseif ${Actor[NamedNPC,"Barnum Bingling"].Effect[3].MainIconID}==${MainIconID}
			{
				switch ${Actor[NamedNPC,"Barnum Bingling"].Effect[3].BackDropIconID}
				{
					;yellow
					case 33085
					{
						if ${Math.Distance[${Me.Loc},-43.544041,-10.345064,17.085676]}>5
						{
							call _MoveC -43.54 17.09 TRUE
						}
						break
					}
					;red
					case 33083
					{
						if ${Math.Distance[${Me.Loc},-10.018149,-10.345072,-5.996769]}>5
						{
							call _MoveC -10.02 -6 FALSE TRUE
						}
						break
					}
					;blue
					case 33081
					{
						if ${Math.Distance[${Me.Loc},17.392654,-6.107872,23.880922]}>5
						{
							call _MoveC 19.52 15.78 FALSE TRUE
							call _MoveC 17.39 23.88 FALSE TRUE
						}
						break
					}
				}
			}
			elseif ${Actor[NamedNPC,"Barnum Bingling"].Effect[4].MainIconID}==${MainIconID}
			{
				switch ${Actor[NamedNPC,"Barnum Bingling"].Effect[4].BackDropIconID}
				{
					;yellow
					case 33085
					{
						if ${Math.Distance[${Me.Loc},-43.544041,-10.345064,17.085676]}>5
						{
							call _MoveC -43.54 17.09 TRUE
						}
						break
					}
					;red
					case 33083
					{
						if ${Math.Distance[${Me.Loc},-10.018149,-10.345072,-5.996769]}>5
						{
							call _MoveC -10.02 -6 FALSE TRUE
						}
						break
					}
					;blue
					case 33081
					{
						if ${Math.Distance[${Me.Loc},17.392654,-6.107872,23.880922]}>5
						{
							call _MoveC 19.52 15.78 FALSE TRUE
							call _MoveC 17.39 23.88 FALSE TRUE
						}
						break
					}
				}
			}
			elseif ${Actor[NamedNPC,"Barnum Bingling"].Effect[5].MainIconID}==${MainIconID}
			{
				switch ${Actor[NamedNPC,"Barnum Bingling"].Effect[5].BackDropIconID}
				{
					;yellow
					case 33085
					{
						if ${Math.Distance[${Me.Loc},-43.544041,-10.345064,17.085676]}>5
						{
							call _MoveC -43.54 17.09 TRUE
						}
						break
					}
					;red
					case 33083
					{
						if ${Math.Distance[${Me.Loc},-10.018149,-10.345072,-5.996769]}>5
						{
							call _MoveC -10.02 -6 FALSE TRUE
						}
						break
					}
					;blue
					case 33081
					{
						if ${Math.Distance[${Me.Loc},17.392654,-6.107872,23.880922]}>5
						{
							call _MoveC 19.52 15.78 FALSE TRUE
							call _MoveC 17.39 23.88 FALSE TRUE
						}
						break
					}
				}
			}
		}
		else
		{
			if !${RI_Var_Bool_GlobalOthers}
			{
				if ${Target.ID}!=${Actor[NamedNPC,"Bailey Bingling"].ID}
					Actor["Bailey Bingling"]:DoTarget
			}
			if ${Actor[NamedNPC,"Bailey Bingling"].Effect[1].MainIconID}==${MainIconID}
			{
				switch ${Actor[NamedNPC,"Bailey Bingling"].Effect[1].BackDropIconID}
				{
					;yellow
					case 33085
					{
						if ${Math.Distance[${Me.Loc},-43.544041,-10.345064,17.085676]}>5
						{
							call _MoveC -43.54 17.09 TRUE
						}
						break
					}
					;red
					case 33083
					{
						if ${Math.Distance[${Me.Loc},-10.018149,-10.345072,-5.996769]}>5
						{
							call _MoveC -10.02 -6 FALSE TRUE
						}
						break
					}
					;blue
					case 33081
					{
						if ${Math.Distance[${Me.Loc},17.392654,-6.107872,23.880922]}>5
						{
							call _MoveC 19.52 15.78 FALSE TRUE
							call _MoveC 17.39 23.88 FALSE TRUE
						}
						break
					}
				}
			}
			elseif ${Actor[NamedNPC,"Bailey Bingling"].Effect[2].MainIconID}==${MainIconID}
			{
				switch ${Actor[NamedNPC,"Bailey Bingling"].Effect[2].BackDropIconID}
				{
					;yellow
					case 33085
					{
						if ${Math.Distance[${Me.Loc},-43.544041,-10.345064,17.085676]}>5
						{
							call _MoveC -43.54 17.09 TRUE
						}
						break
					}
					;red
					case 33083
					{
						if ${Math.Distance[${Me.Loc},-10.018149,-10.345072,-5.996769]}>5
						{
							call _MoveC -10.02 -6 FALSE TRUE
						}
						break
					}
					;blue
					case 33081
					{
						if ${Math.Distance[${Me.Loc},17.392654,-6.107872,23.880922]}>5
						{
							call _MoveC 19.52 15.78 FALSE TRUE
							call _MoveC 17.39 23.88 FALSE TRUE
						}
						break
					}
				}
			}
			elseif ${Actor[NamedNPC,"Bailey Bingling"].Effect[3].MainIconID}==${MainIconID}
			{
				switch ${Actor[NamedNPC,"Bailey Bingling"].Effect[3].BackDropIconID}
				{
					;yellow
					case 33085
					{
						if ${Math.Distance[${Me.Loc},-43.544041,-10.345064,17.085676]}>5
						{
							call _MoveC -43.54 17.09 TRUE
						}
						break
					}
					;red
					case 33083
					{
						if ${Math.Distance[${Me.Loc},-10.018149,-10.345072,-5.996769]}>5
						{
							call _MoveC -10.02 -6 FALSE TRUE
						}
						break
					}
					;blue
					case 33081
					{
						if ${Math.Distance[${Me.Loc},17.392654,-6.107872,23.880922]}>5
						{
							call _MoveC 19.52 15.78 FALSE TRUE
							call _MoveC 17.39 23.88 FALSE TRUE
						}
						break
					}
				}
			}
			elseif ${Actor[NamedNPC,"Bailey Bingling"].Effect[4].MainIconID}==${MainIconID}
			{
				switch ${Actor[NamedNPC,"Bailey Bingling"].Effect[4].BackDropIconID}
				{
					;yellow
					case 33085
					{
						if ${Math.Distance[${Me.Loc},-43.544041,-10.345064,17.085676]}>5
						{
							call _MoveC -43.54 17.09 TRUE
						}
						break
					}
					;red
					case 33083
					{
						if ${Math.Distance[${Me.Loc},-10.018149,-10.345072,-5.996769]}>5
						{
							call _MoveC -10.02 -6 FALSE TRUE
						}
						break
					}
					;blue
					case 33081
					{
						if ${Math.Distance[${Me.Loc},17.392654,-6.107872,23.880922]}>5
						{
							call _MoveC 19.52 15.78 FALSE TRUE
							call _MoveC 17.39 23.88 FALSE TRUE
						}
						break
					}
				}
			}
			elseif ${Actor[NamedNPC,"Bailey Bingling"].Effect[5].MainIconID}==${MainIconID}
			{
				switch ${Actor[NamedNPC,"Bailey Bingling"].Effect[5].BackDropIconID}
				{
					;yellow
					case 33085
					{
						if ${Math.Distance[${Me.Loc},-43.544041,-10.345064,17.085676]}>5
						{
							call _MoveC -43.54 17.09 TRUE
						}
						break
					}
					;red
					case 33083
					{
						if ${Math.Distance[${Me.Loc},-10.018149,-10.345072,-5.996769]}>5
						{
							call _MoveC -10.02 -6 FALSE TRUE
						}
						break
					}
					;blue
					case 33081
					{
						if ${Math.Distance[${Me.Loc},17.392654,-6.107872,23.880922]}>5
						{
							call _MoveC 19.52 15.78 FALSE TRUE
							call _MoveC 17.39 23.88 FALSE TRUE
						}
						break
					}
				}
			}
		}
		wait 1
	}
	call _MoveC 2.51 15.64 FALSE FALSE
	;Actor[fungal]:DoTarget
	echo Ending Bailey
}
function Tothrak()
{
	echo ISXRI: Starting Tothrak 
	
	RI_Atom_SetLockSpot ALL 71.158806 34.857967 -172.700897
	Actor[Tothrak]:DoTarget
	
	call _MoveC 71.158806 -172.700897
	wait 50
	while ${Actor[armorsmith,radius,5](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			Actor[armorsmith,radius,5]:DoTarget
		}
		wait 5
	}
	call _MoveC 72 -183
	while ${Actor[armorsmith,radius,5](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			Actor[armorsmith,radius,5]:DoTarget
		}
		wait 5
	}
	call _MoveC 77 -168
	while ${Actor[armorsmith,radius,5](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			Actor[armorsmith,radius,5]:DoTarget
		}
		wait 5
	}
	call _MoveC 71 -173
	while ${Actor[Tothrak](exists)} && !${Actor[Tothrak].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!= ${Actor[Tothrak].ID}
				Actor[Tothrak]:DoTarget
		}
		wait 1
	}
	echo Ending Tothrak
}
function Gavitzle()
{
	echo ISXRI: Starting Gavitzle 
	Actor[animated,radius,20]:DoTarget
	RI_Atom_SetLockSpot ALL -164.219162 -2.514840 -143.597137
	
	while ${Actor[Gavitzle](exists)} && !${Actor[Gavitzle].IsDead}
	{
		while ${Actor[animated,radius,20](exists)}
		{
			Actor[animated,radius,20]:DoTarget
			wait 1
		}
		if ${Actor[Gavitzle].Distance}>10
			call GavitzleFinder
		wait 1
	}
	echo Ending Gavitzle
	;we are at top
	if ${Math.Distance[${Me.Loc},-202.007523,4.663108,-137.058838]}<5
	{
		call GavitzleMoveFromTop
	}
	;we are at front
	if ${Math.Distance[${Me.Loc},-159.020706,-2.961447,-105.893440]}<5
	{
		call GavitzleMoveFromFront
	}
	call GavitzleMoveCenter
}
function GavitzleFinder()
{
	;first lets move if we are at top or front
	;we are at top
	if ${Math.Distance[${Me.Loc},-202.007523,4.663108,-137.058838]}<5
	{
		call GavitzleMoveFromTop
		call GavitzleMoveCenter
	}
	;we are at front
	elseif ${Math.Distance[${Me.Loc},-159.020706,-2.961447,-105.893440]}<5
	{
		call GavitzleMoveFromFront
		call GavitzleMoveCenter
	}
	else
		call GavitzleMoveCenter
	;gavitzle is at the center
	if ${Math.Distance[${Actor[Gavitzle].Loc},-171.729034,-2.832729,-127.309723]}<5
	{
		call GavitzleMoveCenter
	}
	;gavitzle is at the spawn
	if ${Math.Distance[${Actor[Gavitzle].Loc},-164.219162,-2.514840,-143.597137]}<5
	{
		call GavitzleMoveSpawn
	}
	;gavitzle is at the front
	if ${Math.Distance[${Actor[Gavitzle].Loc},-159.020706,-2.961447,-105.893440]}<5
	{
		call GavitzleMoveFront
	}
	;gavitzle is at the top
	if ${Math.Distance[${Actor[Gavitzle].Loc},-202.007523,4.663108,-137.058838]}<5
	{
		call GavitzleMoveTop
	}
}
function GavitzleMoveCenter()
{
	call _MoveC -171.729034 -127.309723
}
function GavitzleMoveFront()
{
	call _MoveC -158.635156 -115.427090
	call _MoveC -159.020706 -105.893440
}
function GavitzleMoveFromFront()
{
	call _MoveC -158.635156 -115.427090
}
function GavitzleMoveSpawn()
{
	call _MoveC -164.219162 -143.597137
}
function GavitzleMoveTop()
{
	call _MoveC -185.549162 -126.467137
	call _MoveC -192.991478 -121.954142
	call _MoveC -202.007523 -137.058838
}
function GavitzleMoveFromTop()
{
	call _MoveC -198.761252 -132.431245
	wait 10
	call _MoveC -192.991478 -121.954142
	call _MoveC -185.549162 -126.467137
}
function Cugdava()
{
	echo ISXRI: Starting Cugdava 
	
	RI_Atom_SetLockSpot ALL -164.219162 -2.514840 -143.597137
	
	while ${Actor[Cugdava](exists)} && !${Actor[Cugdava].IsDead}
	{
		Actor[Cugdava]:DoTarget
		wait 750 ${Actor[Cugdava].IsDead}
		if ${Actor[Cugdava](exists)} && !${Actor[Cugdava].IsDead}
		{
			call _MoveC 58.87 -144.53
			wait 750 ${Actor[Cugdava].IsDead}
		}
		if ${Actor[Cugdava](exists)} && !${Actor[Cugdava].IsDead}
		{
			call _MoveC 42.97 -160.57
			wait 750 ${Actor[Cugdava].IsDead}
		}
		if ${Actor[Cugdava](exists)} && !${Actor[Cugdava].IsDead}
		{
			call _MoveC 37.87 -171.57
			wait 750 ${Actor[Cugdava].IsDead}
		}
		if ${Actor[Cugdava](exists)} && !${Actor[Cugdava].IsDead}
		{
			call _MoveC 25.47 -186.33
			wait 750 ${Actor[Cugdava].IsDead}
		}
		call _MoveC 26.17 -164.33
		while ${Actor["Gavitzle the Charbroiled"](exists)} && !${Actor["Gavitzle the Charbroiled"].IsDead}
		{
			if !${RI_Var_Bool_GlobalOthers}
			{
				if ${Target.ID}!=${Actor["Gavitzle the Charbroiled"].ID}
					Actor["Gavitzle the Charbroiled"]:DoTarget
			}
			wait 1
		}
		return
	}
	echo Ending Cugdava
}
function SpawnDreadtusk()
{
	if !${RI_Var_Bool_GlobalOthers}
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call SpawnDreadtusk"]
	press f1
	RI_CMD_PauseCombatBots 1
	RI_Atom_SetRIFollow OFF
	
	variable int _Counter
	_Counter:Set[1]
	variable int _PullTime
	_PullTime:Set[${Time.SecondsSinceMidnight}]
	variable bool _Moved
	_Moved:Set[FALSE]
	variable int _MyNum
	variable int P2G
	declare GroupArray[${Me.Group}] string
	declare Group string
	variable int count=0
	for(count:Set[1];${count}<=${Me.Group};count:Inc)
		GroupArray[${count}]:Set[${Me.Group[${Math.Calc[${count}-1]}]}]
	variable int count2=0
	declare temp string
	for(count:Set[1];${count}<=${GroupArray.Size};count:Inc)
	{
		for(count2:Set[1];${count2}<=${GroupArray.Size};count2:Inc)
		{
			if ${GroupArray[${count2}].Compare[${GroupArray[${count}]}]}>0
			{
				temp:Set[${GroupArray[${count}]}]
				GroupArray[${count}]:Set[${GroupArray[${count2}]}]
				GroupArray[${count2}]:Set[${temp}]
			}
		}
    }
	for(count:Set[1];${count}<=${GroupArray.Size};count:Inc)
	{
		if ${Me.Name.Equal[${GroupArray[${count}]}]}
			_MyNum:Set[${count}]
	}
	if ${Actor[Query, Name == "${GroupArray[1]}" && Type == "PC"].Archetype.Equal[fighter]}
		P2G:Set[2]
	else
		P2G:Set[1]
	
	while !${Actor[NamedNPC,Dreadtusk](exists)}
	{	
		if ${Me.Class.Equal[bard]}
		{
			press shift+r
			RI_Atom_SetLockSpot ${Me.Name} 309.662445 69.212280 -90.328735 1 100
			call _MoveC 308.587830 -91.312325
			wait 10
			press shift+r
			Actor[aggressive]:DoTarget
			wait 4
			Me.Inventory[a boar horn]:Use
			wait 5
			wait 100 !${Me.CastingSpell}
			call _MoveC 292.764008 -106.594910
			wait 10
			RI_Atom_SetLockSpot OFF
			Actor["a primordial shackler"]:DoTarget
			wait 2
			Me.Ability[id,201991618]:Use
						wait 50
			RI_Atom_SetLockSpot ${Me.Name} 317.851013 0 -68.816887
			call _MoveC 317.851013 -68.816887
			wait 150 ${Actor["A primordial shackler"].Distance}<10
			relay ${RI_Var_String_RelayGroup} -noredirect Actor["A primordial shackler"]:DoTarget
			relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 0
			while ${Actor["A primordial shackler",radius,10](exists)} && !${Actor["A primordial shackler",radius,10].IsDead}
			{
				wait 1
			}
			while ${Actor["aggressive",radius,10](exists)}
			{
				wait 1
			}
			wait 50
			relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
			relay ${RI_Var_String_RelayGroup} -noredirect press f1
			press shift+r
			call _MoveC 308.587830 -91.312325
			wait 10
			press shift+r
			Actor[aggressive]:DoTarget
			wait 4
			Me.Inventory[a boar horn]:Use
			wait 5
			wait 100 !${Me.CastingSpell}
			call _MoveC 284.765503 -115.217926
			wait 10
			RI_Atom_SetLockSpot OFF
			Actor["a primordial shackler"]:DoTarget
			wait 2
			Me.Ability[id,201991618]:Use
			wait 50
			RI_Atom_SetLockSpot ${Me.Name} 317.851013 0 -68.816887
			call _MoveC 317.851013 -68.816887
			wait 150 ${Actor["A primordial shackler"].Distance}<10
			relay ${RI_Var_String_RelayGroup} -noredirect Actor["A primordial shackler"]:DoTarget
			relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 0
			while ${Actor["A primordial shackler",radius,10](exists)} && !${Actor["A primordial shackler",radius,10].IsDead}
			{
				wait 1
			}
			while ${Actor["aggressive",radius,10](exists)}
			{
				wait 1
			}
			wait 50
			relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
			relay ${RI_Var_String_RelayGroup} -noredirect press f1
			press shift+r
			call _MoveC 308.587830 -91.312325
			wait 10
			press shift+r
			Actor[aggressive]:DoTarget
			wait 4
			Me.Inventory[a boar horn]:Use
			wait 5
			wait 100 !${Me.CastingSpell}
			call _MoveC 280.233276 -106.611359
			wait 10
			RI_Atom_SetLockSpot OFF
			Actor["a primordial shackler"]:DoTarget
			wait 2
			Me.Ability[id,201991618]:Use
			wait 50
			RI_Atom_SetLockSpot ${Me.Name} 317.851013 69.127251 -68.816887 1 100
			call _MoveC 317.851013 -68.816887
			wait 150 ${Actor["A primordial shackler"].Distance}<10
			relay ${RI_Var_String_RelayGroup} -noredirect Actor["A primordial shackler"]:DoTarget
			relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 0
			while ${Actor["A primordial shackler",radius,10](exists)} && !${Actor["A primordial shackler",radius,10].IsDead}
			{
				wait 1
			}
			RI_Atom_SetLockSpot OFF
			return
		}
		while ${Actor["A primordial shackler",radius,10](exists)} && !${Actor["A primordial shackler",radius,10].IsDead}
		{
			if !${RI_Var_Bool_GlobalOthers}
			{
				if ${Target.Name.NotEqual["A primordial shackler"]}
					Actor["A primordial shackler",radius,10]:DoTarget
			}
			wait 1
		}
		while ${Actor["aggressive",radius,10](exists)}
		{
			if !${RI_Var_Bool_GlobalOthers}
			{
				Actor["aggressive",radius,10]:DoTarget
			}
			wait 1
		}
		wait 1
	}
	relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 0
	while ${Actor["aggressive",radius,40](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			Actor["aggressive",radius,40]:DoTarget
		}
		wait 1
	}
}
function Dreadtusk()
{
	echo ISXRI: Starting Dreadtusk 
	if !${RI_Var_Bool_GlobalOthers}
	{
		if ${Target.ID}!=${Actor[Dreadtusk].ID}
			Actor[Dreadtusk]:DoTarget
	}

	wait 200 ${Actor[Dreadtusk].Distance}<10
	wait 50
	
	RI_Atom_MoveBehind NONFIGHTER ${Actor[Dreadtusk].ID} 30 99
	
	while ${Actor[Dreadtusk](exists)} && !${Actor[Dreadtusk].IsDead}
	{
		if ${Me.Cursed}==-1
		{
			RI_CMD_PauseCombatBots 1
			eq2ex cancel_spellcast
			eq2ex clearabilityqueue
			wait 2
			Me.Inventory["a boar horn"]:Use
			wait 1
			Me.Inventory["a boar horn"]:Use
			wait 1
			Me.Inventory["a boar horn"]:Use
			wait 5
			wait 100 !${Me.CastingSpell}
			RI_CMD_PauseCombatBots 0
		}
		wait 1
	}
	echo Ending Dreadtusk
}
function SpawnDreadmaw()
{
	if !${RI_Var_Bool_GlobalOthers}
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call SpawnDreadmaw"]
	press f1
	RI_CMD_PauseCombatBots 1
	RI_Atom_SetRIFollow OFF
	variable int _Counter
	_Counter:Set[1]
	variable int _PullTime
	_PullTime:Set[${Time.SecondsSinceMidnight}]
	variable bool _Moved
	_Moved:Set[FALSE]
	variable int _MyNum
	variable int P2G
	declare GroupArray[${Me.Group}] string
	declare Group string
	variable int count=0
	for(count:Set[1];${count}<=${Me.Group};count:Inc)
		GroupArray[${count}]:Set[${Me.Group[${Math.Calc[${count}-1]}]}]
	variable int count2=0
	declare temp string
	for(count:Set[1];${count}<=${GroupArray.Size};count:Inc)
	{
		for(count2:Set[1];${count2}<=${GroupArray.Size};count2:Inc)
		{
			if ${GroupArray[${count2}].Compare[${GroupArray[${count}]}]}>0
			{
				temp:Set[${GroupArray[${count}]}]
				GroupArray[${count}]:Set[${GroupArray[${count2}]}]
				GroupArray[${count2}]:Set[${temp}]
			}
		}
    }
	for(count:Set[1];${count}<=${GroupArray.Size};count:Inc)
	{
		if ${Me.Name.Equal[${GroupArray[${count}]}]}
			_MyNum:Set[${count}]
	}
	if ${Actor[Query, Name == "${GroupArray[1]}" && Type == "PC"].Archetype.Equal[fighter]}
		P2G:Set[2]
	else
		P2G:Set[1]
	
	while !${Actor[NamedNPC,Dreadmaw](exists)}
	{	
		if ${_MyNum}==${P2G}
		{
			press shift+r
			RI_Atom_SetLockSpot ${Me.Name} 306.469269 69.342041 85.171989 1 100
			call _MoveC 305.615021 86.921913
			wait 10
			press shift+r
			Actor[aggressive]:DoTarget
			wait 4
			Me.Inventory[a wolf whistle]:Use
			wait 5
			wait 100 !${Me.CastingSpell}
			call _MoveC 291.515289 103.210007
			wait 10
			RI_Atom_SetLockSpot OFF
			Actor["a primordial shackler"]:DoTarget
			wait 2
			Me.Ability[id,1353985953]:Use
			wait 2
			RI_Atom_SetLockSpot ALL 299.721375 69.122292 94.175537 1 100
			call _MoveC 299.721375 94.175537
			wait 5
			RI_Atom_SetLockSpot OFF
			wait 40
			RI_Atom_SetLockSpot ALL 318.002350 0 67.266739 1 100
			call _MoveC 318.002350 67.266739
			wait 150 ${Actor["A primordial shackler"].Distance}<10
			relay ${RI_Var_String_RelayGroup} -noredirect Actor["A primordial shackler"]:DoTarget
			relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 0
			while ${Actor["A primordial shackler",radius,10](exists)} && !${Actor["A primordial shackler",radius,10].IsDead}
			{
				wait 1
			}
			while ${Actor["aggressive",radius,10](exists)}
			{
				wait 1
			}
			relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
			relay ${RI_Var_String_RelayGroup} -noredirect press f1
			press shift+r
			call _MoveC 305.615021 86.921913
			wait 10
			press shift+r
			Actor[aggressive]:DoTarget
			wait 4
			Me.Inventory[a wolf whistle]:Use
			wait 5
			wait 100 !${Me.CastingSpell}
			call _MoveC 281.610474 105.429169
			wait 10
			RI_Atom_SetLockSpot OFF
			Actor["a primordial shackler"]:DoTarget
			wait 2
			Me.Ability[id,1353985953]:Use
			wait 2
			RI_Atom_SetLockSpot ALL 299.721375 69.122292 94.175537 1 100
			call _MoveC 299.721375 94.175537
			wait 5
			RI_Atom_SetLockSpot OFF
			wait 40
			RI_Atom_SetLockSpot ALL 318.002350 0 67.266739 1 100
			call _MoveC 318.002350 67.266739
			wait 150 ${Actor["A primordial shackler"].Distance}<10
			relay ${RI_Var_String_RelayGroup} -noredirect Actor["A primordial shackler"]:DoTarget
			relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 0
			while ${Actor["A primordial shackler",radius,10](exists)} && !${Actor["A primordial shackler",radius,10].IsDead}
			{
				wait 1
			}
			while ${Actor["aggressive",radius,10](exists)}
			{
				wait 1
			}
			relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
			relay ${RI_Var_String_RelayGroup} -noredirect press f1
			press shift+r
			call _MoveC 305.615021 86.921913
			wait 10
			press shift+r
			Actor[aggressive]:DoTarget
			wait 4
			Me.Inventory[a wolf whistle]:Use
			wait 5
			wait 100 !${Me.CastingSpell}
			call _MoveC 285.824677 112.243462
			wait 10
			RI_Atom_SetLockSpot OFF
			Actor["a primordial shackler"]:DoTarget
			wait 2
			Me.Ability[id,1353985953]:Use
			wait 2
			RI_Atom_SetLockSpot ALL 299.721375 69.122292 94.175537 1 100
			call _MoveC 299.721375 94.175537
			wait 5
			RI_Atom_SetLockSpot OFF
			wait 40
			RI_Atom_SetLockSpot ALL 318.002350 0 67.266739 1 100
			call _MoveC 318.002350 67.266739
			wait 150 ${Actor["A primordial shackler"].Distance}<10
			relay ${RI_Var_String_RelayGroup} -noredirect Actor["A primordial shackler"]:DoTarget
			relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 0
			while ${Actor["A primordial shackler",radius,10](exists)} && !${Actor["A primordial shackler",radius,10].IsDead}
			{
				wait 1
			}
			RI_Atom_SetLockSpot OFF
			return
		}
		while ${Actor["A primordial shackler",radius,10](exists)} && !${Actor["A primordial shackler",radius,10].IsDead}
		{
			if !${RI_Var_Bool_GlobalOthers}
			{
				if ${Target.Name.NotEqual["A primordial shackler"]}
					Actor["A primordial shackler",radius,10]:DoTarget
			}
			wait 1
		}
		while ${Actor["aggressive",radius,10](exists)}
		{
			if !${RI_Var_Bool_GlobalOthers}
			{
				Actor["aggressive",radius,10]:DoTarget
			}
			wait 1
		}
		wait 1
	}
	relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 0
	while ${Actor["aggressive",radius,40](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			Actor["aggressive",radius,40]:DoTarget
		}
		wait 1
	}

}
function Dreadmaw()
{
	AnnounceText:Clear
	AnnounceText:Insert["You reach for your wolf whistle as Dreadmaw stares in your direction"]
	echo ISXRI: Starting Dreadmaw 
	if !${RI_Var_Bool_GlobalOthers}
	{
		if ${Target.ID}!=${Actor[Dreadmaw].ID}
			Actor[Dreadmaw]:DoTarget
	}
	wait 200 ${Actor[Dreadmaw].Distance}<10
	wait 50
	RI_Atom_MoveBehind NONFIGHTER ${Actor[Dreadmaw].ID} 30 99
	while ${Actor[Dreadmaw](exists)} && !${Actor[Dreadmaw].IsDead}
	{
		if ${Trigger}
		{
			wait 40
			RI_CMD_PauseCombatBots 1
			eq2ex cancel_spellcast
			eq2ex clearabilityqueue
			wait 2
			Me.Inventory["a wolf whistle"]:Use
			wait 1
			Me.Inventory["a wolf whistle"]:Use
			wait 1
			Me.Inventory["a wolf whistle"]:Use
			wait 5
			wait 100 !${Me.CastingSpell}
			RI_CMD_PauseCombatBots 0
			Trigger:Set[FALSE]
		}
		wait 1
	}
	echo Ending Dreadmaw
}
function Hagrash()
{
	;AnnounceText:Clear
	;AnnounceText:Insert["combat abilities will soon be purged"]
	echo ISXRI: Starting Hagrash 
	if !${RI_Var_Bool_GlobalOthers}
	{
		if ${Target.ID}!=${Actor[NamedNPC,Hagrash].ID}
			Actor[NamedNPC,Hagrash]:DoTarget
	}
	wait 200 ${Actor[NamedNPC,Hagrash].Distance}<10
	;RI_Atom_MoveBehind NONFIGHTER ${Actor[NamedNPC,Hagrash].ID} 30 99
	while ${Actor[NamedNPC,Hagrash](exists)} && !${Actor[NamedNPC,Hagrash].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor[NamedNPC,Hagrash].ID}
				Actor[NamedNPC,Hagrash]:DoTarget
			if ${Me.Group[1].Cursed}==-1 && ${Me.Ability[id,101378472].IsReady}
				RI_Obj_CB:CastOn[Intercept III,${Me.Group[1].Name},TRUE]
			elseif ${Me.Group[2].Cursed}==-1 && ${Me.Ability[id,101378472].IsReady}
				RI_Obj_CB:CastOn[Intercept III,${Me.Group[2].Name},TRUE]
			elseif ${Me.Group[3].Cursed}==-1 && ${Me.Ability[id,101378472].IsReady}
				RI_Obj_CB:CastOn[Intercept III,${Me.Group[3].Name},TRUE]
			elseif ${Me.Group[4].Cursed}==-1 && ${Me.Ability[id,101378472].IsReady}
				RI_Obj_CB:CastOn[Intercept III,${Me.Group[4].Name},TRUE]
			elseif ${Me.Group[5].Cursed}==-1 && ${Me.Ability[id,101378472].IsReady}
				RI_Obj_CB:CastOn[Intercept III,${Me.Group[5].Name},TRUE]
			if ${Me.Maintained[Intercept III](exists)}
				Me.Maintained[Intercept III]:Cancel
		}
		else
		{
			if ${Me.Cursed}==-1
			{
				RI_CMD_PauseCombatBots 1
				while ${Me.Cursed}==-1
					wait 1
				RI_CMD_PauseCombatBots 0
			}
		}
		; if ${Trigger}
		; {
			; if !${RI_Var_Bool_GlobalOthers}
			; {
				; wait 30
				; if ${TriggerMessage.Find[${Me.Group[1].Name}](exists)}
					; RI_Obj_CB:CastOn[Intercept III,${Me.Group[1].Name},TRUE]
				; elseif ${TriggerMessage.Find[${Me.Group[2].Name}](exists)}
					; RI_Obj_CB:CastOn[Intercept III,${Me.Group[2].Name},TRUE]
				; elseif ${TriggerMessage.Find[${Me.Group[3].Name}](exists)}
					; RI_Obj_CB:CastOn[Intercept III,${Me.Group[3].Name},TRUE]
				; elseif ${TriggerMessage.Find[${Me.Group[4].Name}](exists)}
					; RI_Obj_CB:CastOn[Intercept III,${Me.Group[4].Name},TRUE]
				; elseif ${TriggerMessage.Find[${Me.Group[5].Name}](exists)}
					; RI_Obj_CB:CastOn[Intercept III,${Me.Group[5].Name},TRUE]
			; }
			; elseif ${TriggerMessage.Find[${Me.Name}](exists)}
			; {
				; RI_CMD_PauseCombatBots 1
				; eq2ex cancel_spellcast
				; eq2ex clearabilityqueue
				; wait 50
				; RI_CMD_PauseCombatBots 0
			; }
			; Trigger:Set[FALSE]
		; }
		wait 1
	}
	echo Ending Hagrash
}
function Gagrash()
{
	;AnnounceText:Clear
	;AnnounceText:Insert["spells will soon be purged"]
	echo ISXRI: Starting Gagrash 
	if !${RI_Var_Bool_GlobalOthers}
	{
		if ${Target.ID}!=${Actor[NamedNPC,Gagrash].ID}
			Actor[NamedNPC,Gagrash]:DoTarget
	}
	wait 200 ${Actor[NamedNPC,Gagrash].Distance}<10
	;RI_Atom_MoveBehind NONFIGHTER ${Actor[NamedNPC,Gagrash].ID} 30 99
	while ${Actor[NamedNPC,Gagrash](exists)} && !${Actor[NamedNPC,Gagrash].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor[NamedNPC,Gagrash].ID}
				Actor[NamedNPC,Gagrash]:DoTarget
			if ${Me.Group[1].Cursed}==-1 && ${Me.Ability[id,101378472].IsReady}
				RI_Obj_CB:CastOn[Intercept III,${Me.Group[1].Name},TRUE]
			elseif ${Me.Group[2].Cursed}==-1 && ${Me.Ability[id,101378472].IsReady}
				RI_Obj_CB:CastOn[Intercept III,${Me.Group[2].Name},TRUE]
			elseif ${Me.Group[3].Cursed}==-1 && ${Me.Ability[id,101378472].IsReady}
				RI_Obj_CB:CastOn[Intercept III,${Me.Group[3].Name},TRUE]
			elseif ${Me.Group[4].Cursed}==-1 && ${Me.Ability[id,101378472].IsReady}
				RI_Obj_CB:CastOn[Intercept III,${Me.Group[4].Name},TRUE]
			elseif ${Me.Group[5].Cursed}==-1 && ${Me.Ability[id,101378472].IsReady}
				RI_Obj_CB:CastOn[Intercept III,${Me.Group[5].Name},TRUE]
			if ${Me.Maintained[Intercept III](exists)}
				Me.Maintained[Intercept III]:Cancel
		}
		else
		{
			if ${Me.Cursed}==-1
			{
				RI_CMD_PauseCombatBots 1
				while ${Me.Cursed}==-1
					wait 1
				RI_CMD_PauseCombatBots 0
			}
		}
		; if ${Trigger}
		; {
			; if !${RI_Var_Bool_GlobalOthers}
			; {
				; wait 40
				; if ${TriggerMessage.Find[${Me.Group[1].Name}](exists)}
					; RI_Obj_CB:CastOn[Intercept III,${Me.Group[1].Name},TRUE]
				; elseif ${TriggerMessage.Find[${Me.Group[2].Name}](exists)}
					; RI_Obj_CB:CastOn[Intercept III,${Me.Group[2].Name},TRUE]
				; elseif ${TriggerMessage.Find[${Me.Group[3].Name}](exists)}
					; RI_Obj_CB:CastOn[Intercept III,${Me.Group[3].Name},TRUE]
				; elseif ${TriggerMessage.Find[${Me.Group[4].Name}](exists)}
					; RI_Obj_CB:CastOn[Intercept III,${Me.Group[4].Name},TRUE]
				; elseif ${TriggerMessage.Find[${Me.Group[5].Name}](exists)}
					; RI_Obj_CB:CastOn[Intercept III,${Me.Group[5].Name},TRUE]
			; }
			; elseif ${TriggerMessage.Find[${Me.Name}](exists)}
			; {
				; RI_CMD_PauseCombatBots 1
				; eq2ex cancel_spellcast
				; eq2ex clearabilityqueue
				; wait 100
				; RI_CMD_PauseCombatBots 0
			; }
			; Trigger:Set[FALSE]
		; }
		wait 1
	}
	echo Ending Gagrash
}
function HowlingClickDoors()
{
	relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot Fighters 45.214859 80.415894 188.262909
	relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot Scouts 45.214859 80.415894 188.262909
	relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot Mages 62.237350 80.415894 184.549194
	relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetLockSpot Priests 62.237350 80.415894 184.549194
	wait 100
	relay ${RI_Var_String_RelayGroup} -noredirect Actor["Hunter's Door"]:DoubleClick;relay ${RI_Var_String_RelayGroup} -noredirect Actor["Gatherer's Door"]:DoubleClick
	wait 2
	relay ${RI_Var_String_RelayGroup} -noredirect Actor["Hunter's Door"]:DoubleClick;relay ${RI_Var_String_RelayGroup} -noredirect Actor["Gatherer's Door"]:DoubleClick
	wait 50
}
function Bagarash()
{
	echo ISXRI: Starting Bagarash 
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["takes on the Form of the"]
	RI_Atom_SetLockSpot ${Me.Name} 66.657990 87.863281 243.086624
	if !${RI_Var_Bool_GlobalOthers}
	{
		if ${Target.ID}!=${Actor[NamedNPC,Bagarash].ID}
			Actor[NamedNPC,Bagarash]:DoTarget
	}
	wait 200 ${Actor[NamedNPC,Bagarash].Distance}<15
	;RI_Atom_MoveBehind NONFIGHTER ${Actor[NamedNPC,Bagarash].ID} 30 99
	while ${Actor[NamedNPC,Bagarash](exists)} && !${Actor[NamedNPC,Bagarash].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor["a stalking hunt master"](exists)}
				Actor["a stalking hunt master"]:DoTarget
			elseif ${Target.ID}!=${Actor[NamedNPC,Bagarash].ID}
				Actor[NamedNPC,Bagarash]:DoTarget
		}
		if ${Trigger}
		{
			;echo TRIGGER: TriggerMessage: ${TriggerMessage} / Gatherer: ${TriggerMessage.Find[Gatherer](exists)} / Hunter: ${TriggerMessage.Find[Hunter](exists)}
			if ${Me.Class.Equal[bard]}
			{
				wait 50
				if ${TriggerMessage.Find[Gatherer](exists)}
				{
					;echo gatherer
					RI_CMD_PauseCombatBots 1
					eq2ex cancel_spellcast
					eq2ex clearabilityqueue
					wait 5
					Actor["a dead Barkgut Gatherer"]:DoubleClick
					wait 1
					Actor["a dead Barkgut Gatherer"]:DoubleClick
					wait 1
					Actor["a dead Barkgut Gatherer"]:DoubleClick
					wait 50
					Me.Inventory["gatherer's trinket"]:Use
					wait 1
					Me.Inventory["gatherer's trinket"]:Use
					wait 1
					Me.Inventory["gatherer's trinket"]:Use
					wait 5
					RI_CMD_PauseCombatBots 0
				}
				if ${TriggerMessage.Find[Hunter](exists)}
				{
					;echo hunter
					RI_CMD_PauseCombatBots 1
					eq2ex cancel_spellcast
					eq2ex clearabilityqueue
					wait 5
					Actor["a dead Barkgut Hunter"]:DoubleClick
					wait 1
					Actor["a dead Barkgut Hunter"]:DoubleClick
					wait 1
					Actor["a dead Barkgut Hunter"]:DoubleClick
					wait 50
					Me.Inventory["hunter's trinket"]:Use
					wait 1
					Me.Inventory["hunter's trinket"]:Use
					wait 1
					Me.Inventory["hunter's trinket"]:Use
					wait 50
					;relay ${RI_Var_String_RelayGroup} -noredirect RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem["Ancient Shroud",0]
					;relay ${RI_Var_String_RelayGroup} -noredirect RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem["Vital Intercession",0]
					;relay ${RI_Var_String_RelayGroup} -noredirect RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem["Ancestral Ward",0]
					;relay ${RI_Var_String_RelayGroup} -noredirect RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem["Penance",0]
					;relay ${RI_Var_String_RelayGroup} -noredirect RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem["Photosynthesis",0]
					;relay ${RI_Var_String_RelayGroup} -noredirect RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem["Regrowth",0]
					;wait 30
					relay ${RI_Var_String_RelayGroup} -noredirect RI_Obj_CB:CastOn["Ancient Shroud",${Me.Name},TRUE]
					relay ${RI_Var_String_RelayGroup} -noredirect RI_Obj_CB:CastOn["Vital Intercession",${Me.Name},TRUE]
					relay ${RI_Var_String_RelayGroup} -noredirect RI_Obj_CB:CastOn["Ancestral Ward",${Me.Name},TRUE]
					relay ${RI_Var_String_RelayGroup} -noredirect RI_Obj_CB:CastOn["Penance",${Me.Name},TRUE]
					relay ${RI_Var_String_RelayGroup} -noredirect RI_Obj_CB:CastOn["Photosynthesis",${Me.Name},TRUE]
					relay ${RI_Var_String_RelayGroup} -noredirect RI_Obj_CB:CastOn["Regrowth",${Me.Name},TRUE]
					wait 20
					;relay ${RI_Var_String_RelayGroup} -noredirect RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem["Ancient Shroud",1]
					;relay ${RI_Var_String_RelayGroup} -noredirect RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem["Vital Intercession",1]
					;relay ${RI_Var_String_RelayGroup} -noredirect RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem["Ancestral Ward",1]
					;relay ${RI_Var_String_RelayGroup} -noredirect RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem["Penance",1]
					;relay ${RI_Var_String_RelayGroup} -noredirect RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem["Photosynthesis",1]
					;relay ${RI_Var_String_RelayGroup} -noredirect RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem["Regrowth",1]
					;find then goto the mob and hit it then come back.
					if ${Math.Distance[${Actor["a stalking hunt master"].Loc},69.416451,80.415901,197.044250]}<5
					{
						;echo west
						RI_Atom_SetLockSpot ${Me.Name}
						call _MoveC 93.750549 202.269318
						call _MoveC 92.018515 185.248505
						wait 5
						Actor["a stalking hunt master"]:DoTarget
						Actor["a stalking hunt master"]:DoFace
						if !${Me.RangedAutoAttackOn}
						{
							;echo turning on ranged
							eq2execute setautoattackmode 2
							eq2execute togglerangedattack
						}
						wait 10
						call _MoveC 93.750549 202.269318
						call _MoveC 66.657990 243.086624
					}
					elseif ${Math.Distance[${Actor["a stalking hunt master"].Loc},43.858452,80.415901,201.793488]}<5
					{
						;echo east
						RI_Atom_SetLockSpot ${Me.Name}
						call _MoveC 22.119884 220.012970
						call _MoveC 21.994549 198.313599
						wait 5
						Actor["a stalking hunt master"]:DoTarget
						Actor["a stalking hunt master"]:DoFace
						if !${Me.RangedAutoAttackOn}
						{
							;echo turning on ranged
							eq2execute setautoattackmode 2
							eq2execute togglerangedattack
						}
						wait 10
						call _MoveC 22.119884 220.012970
						call _MoveC 66.657990 243.086624
					}
					else
					{
						RI_Atom_SetLockSpot ${Me.Name} ${Actor["a stalking hunt master"].X} 0 ${Actor["a stalking hunt master"].Z} 30 100
						wait 5
						Actor["a stalking hunt master"]:DoTarget
						Actor["a stalking hunt master"]:DoFace
						if !${Me.AutoAttackOn}
						{
							;echo turning on melee
							eq2execute setautoattackmode 1
							eq2execute toggleautoattack
						}
						wait 10
						call _MoveC 66.657990 243.086624
					}
					RI_CMD_PauseCombatBots 0
				}
			}
			Trigger:Set[FALSE]
		}
		wait 1
	}
	echo Ending Bagarash
}
function Xacx-Kahda()
{
	AnnounceText:Clear
	AnnounceText:Insert["As if from your very mind, a spout of mental power begins to erupt!"]
	RI_Atom_SetLockSpot ALL -14.243855 54.840542 -133.589493
	echo ISXRI: Starting Xacx-Kahda 
	while ${Actor[NamedNPC,Xacx-Kahda](exists)} && !${Actor[NamedNPC,Xacx-Kahda].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor[NamedNPC,Xacx-Kahda].ID}
				Actor[NamedNPC,Xacx-Kahda]:DoTarget
		}
		if ${Trigger}
		{
			wait 30
			if ${Math.Distance[${Me.Loc},-14.243855,54.840542,-133.589493]}<5
				call _MoveC 16.662451 -133.136246
			else
				call _MoveC -14.243855 -133.589493
			Trigger:Set[FALSE]
		}
		wait 1
	}
	echo Ending Xacx-Kahda
}
function Z'Koz()
{
	AnnounceText:Clear
	AnnounceText:Insert["Run! Get beyond 80 meters of your allies!"]
	RI_Atom_SetLockSpot ALL 326.238098 67.772087 -0.761757
	echo ISXRI: Starting Z'Koz 
	if ${Target.ID}!=${Actor[NamedNPC,Z'Koz].ID}
		Actor[NamedNPC,Z'Koz]:DoTarget
	while ${Actor[NamedNPC,Z'Koz](exists)} && !${Actor[NamedNPC,Z'Koz].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor["Hound of Malice",radius,15](exists)}
			{
				if ${Target.ID}!=${Actor["Hound of Malice"].ID}
					Actor["Hound of Malice"]:DoTarget		
			}
			else
			{
				if ${Target.ID}!=${Actor[NamedNPC,Z'Koz].ID}
					Actor[NamedNPC,Z'Koz]:DoTarget
			}
		}
		if ${Trigger}
		{
			wait 30
			if ${Me.Cursed}!=0
			{
				RI_Atom_SetLockSpot ${Me.Name} 236.456039 0 -1.102375 1 100
				wait 300 ( ${Math.Distance[${Me.X},${Me.Z},236.456039,-1.102375]}<2 || ${Me.Cursed}==0 )
				wait 100 ${Me.Cursed}==0
				call _MoveC 326.238098 -0.761757
			}	
			Trigger:Set[FALSE]
		}
		wait 1
	}
	echo Ending Z'Koz
}
;;;;;;;;;;;;

;You have drawn the ire of the queen of dawn!
;You have drawn the ire of the queen of dusk! (NEED TO CHECK)
;The queens of dawn and dusk await you!
;;;;;;;;;;;;;

atom SFITAtom(string Text)
{
	if ${Text.Find["a bundle of treant branches"](exists)}
	{
		treecnt:Inc
		echo Looted a branch at ${treecnt}
	}
}
function StygianForest()
{
	;echo StygianForestFN
	RI_Atom_SetLockSpot ${Me.Name}
	relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetRIFollow ALL ${Me.ID} 1 100
	AnnounceText:Clear
	AnnounceText:Insert["The queens of dawn and dusk await you!"]
	Event[EQ2_onIncomingText]:AttachAtom[SFITAtom]
	DeclareVariable treecnt int script 0

	while !${Trigger}
	{
		;echo ${Time}: StygianForestLOOP
		call _MoveSF 164.942093 28.733509 -253.051163
		;call _MoveSF 174.786926 30.167599 -254.699890
		;call _MoveSF 184.039291 31.379860 -258.383820
		call _MoveSF 193.351440 32.142834 -262.346130
		;call _MoveSF 202.779984 32.600147 -266.531403
		;call _MoveSF 211.947769 33.028885 -270.888367
		call _MoveSF 221.317764 33.642918 -274.726593
		;call _MoveSF 225.462616 35.058964 -265.651398
		;call _MoveSF 228.245209 36.376114 -256.058685
		call _MoveSF 230.961258 37.082279 -246.310669
		;call _MoveSF 233.471924 38.166523 -236.584991
		;call _MoveSF 235.986359 39.449902 -226.844696
		call _MoveSF 238.416992 41.097103 -217.054047
		;call _MoveSF 239.765732 42.425522 -207.100845
		;call _MoveSF 241.252106 44.127377 -197.046082
		call _MoveSF 250.278687 44.371017 -201.343216
		;call _MoveSF 257.906036 43.916672 -208.007797
		;call _MoveSF 265.549530 43.726280 -214.686523
		call _MoveSF 273.261627 43.132748 -221.425186
		;call _MoveSF 281.336243 42.810818 -227.598068
		;call _MoveSF 291.021423 43.233448 -230.429489
		call _MoveSF 301.103516 43.149364 -230.792282
		;call _MoveSF 311.147797 43.075035 -230.840759
		;call _MoveSF 321.389221 42.994251 -230.865479
		call _MoveSF 331.554840 43.225471 -230.920761
		;call _MoveSF 341.720581 43.485088 -230.940643
		;call _MoveSF 351.901337 43.732925 -230.960556
		call _MoveSF 361.990723 43.965694 -230.893951
		;call _MoveSF 371.988647 44.316833 -229.160431
		;call _MoveSF 381.127991 44.576302 -224.731506
		call _MoveSF 389.164093 45.027222 -218.461075
		;call _MoveSF 399.133331 45.088264 -219.832901
		;call _MoveSF 409.442108 45.211559 -219.584946
		call _MoveSF 419.402771 45.293278 -218.417160
		;call _MoveSF 429.464508 44.970055 -217.199646
		;call _MoveSF 439.766846 44.441383 -215.953033
		call _MoveSF 449.768494 44.211712 -214.742813
		;call _MoveSF 459.845245 43.824341 -213.523468
		;call _MoveSF 469.486145 43.837608 -216.195602
		call _MoveSF 472.473938 44.693855 -225.796463
		;call _MoveSF 471.900543 45.572330 -235.972641
		;call _MoveSF 471.041534 45.483429 -246.025589
		call _MoveSF 471.109497 45.634861 -256.154144
		;call _MoveSF 471.686096 46.362869 -266.257874
		;call _MoveSF 473.607635 47.375607 -276.032318
		call _MoveSF 476.171417 49.565174 -285.586975
		;call _MoveSF 475.721008 50.952450 -295.741608
		;call _MoveSF 467.277496 50.398205 -301.676971
		call _MoveSF 457.356598 49.215527 -303.629486
		;call _MoveSF 447.323669 47.605572 -303.150421
		;call _MoveSF 439.480438 46.079723 -296.785248
		call _MoveSF 434.413910 45.230663 -288.182281
		;call _MoveSF 428.922913 44.636837 -279.773743
		;call _MoveSF 423.150726 44.018333 -271.332916
		call _MoveSF 416.371796 43.896904 -263.981628
		;call _MoveSF 406.437378 43.886002 -262.282166
		;call _MoveSF 398.934509 44.345169 -269.087952
		call _MoveSF 393.200623 44.434746 -277.630707
		;call _MoveSF 388.131531 44.056900 -286.442383
		;call _MoveSF 383.047424 43.676617 -295.280334
		call _MoveSF 378.001038 42.981270 -304.052643
		;call _MoveSF 373.043488 41.957493 -312.683807
		;call _MoveSF 367.333496 41.655724 -321.173584
		call _MoveSF 358.995087 41.272217 -327.416504
		;call _MoveSF 348.939209 40.623058 -328.857208
		;call _MoveSF 339.248352 39.758919 -326.459320
		call _MoveSF 331.553436 38.807953 -319.772034
		;call _MoveSF 326.223572 38.694782 -311.189117
		;call _MoveSF 322.977905 38.927807 -301.592346
		call _MoveSF 320.450134 39.232658 -291.698883
		;call _MoveSF 318.147980 39.643803 -281.751251
		;call _MoveSF 317.001862 39.969177 -271.569366
		call _MoveSF 316.393982 40.661251 -261.588898
		;call _MoveSF 315.738312 41.448357 -251.444931
		;call _MoveSF 311.415741 40.760880 -260.575775
		call _MoveSF 307.470947 40.041977 -269.871063
		call _MoveSF 303.541016 39.327839 -279.131470
		;call _MoveSF 299.594452 37.972397 -288.334900
		;call _MoveSF 293.710632 37.242249 -296.419464
		call _MoveSF 284.813507 36.636822 -301.253845
		;call _MoveSF 274.561096 35.724350 -302.092651
		;call _MoveSF 264.517273 34.743843 -302.855621
		call _MoveSF 254.382843 34.109329 -304.045990
		;call _MoveSF 244.346558 33.306236 -305.561066
		;call _MoveSF 234.487717 32.856606 -307.229065
		call _MoveSF 227.386032 32.690083 -314.336914
		;call _MoveSF 227.207870 32.670143 -324.375671
		;call _MoveSF 227.537750 32.458374 -334.585541
		call _MoveSF 229.360687 32.280506 -344.421753
		;call _MoveSF 232.187592 32.300671 -354.085480
		;call _MoveSF 236.454102 32.770187 -363.221924
		call _MoveSF 242.471329 33.479561 -371.405853
		;call _MoveSF 249.991943 34.369083 -378.058533
		;call _MoveSF 256.105316 35.476261 -385.965912
		call _MoveSF 248.394653 34.806396 -392.395111
		;call _MoveSF 238.233063 33.969810 -392.449005
		;call _MoveSF 228.174362 33.005905 -390.732635
		call _MoveSF 218.473694 32.236961 -388.371490
		;call _MoveSF 208.822296 31.564415 -385.780273
		;call _MoveSF 199.292801 31.220263 -381.879395
		call _MoveSF 190.069519 31.030638 -377.713959
		;call _MoveSF 180.956635 31.174498 -373.598450
		;call _MoveSF 171.841599 31.508018 -369.487854
		call _MoveSF 162.125824 31.536377 -366.254211
		;call _MoveSF 152.432388 31.234886 -363.230072
		;call _MoveSF 142.143250 31.598885 -364.437653
		call _MoveSF 132.756302 32.813091 -368.048218
		;call _MoveSF 124.673042 34.664261 -373.980011
		;call _MoveSF 115.495506 36.283283 -378.259491
		call _MoveSF 107.922295 36.312225 -371.290222
		;call _MoveSF 106.350601 35.258675 -361.341583
		;call _MoveSF 106.675591 33.951397 -351.246094
		call _MoveSF 107.486084 32.226032 -341.204315
		;call _MoveSF 108.134811 30.460272 -331.303375
		;call _MoveSF 106.607635 29.163507 -321.205139
		call _MoveSF 101.479942 28.076540 -312.538269
		;call _MoveSF 93.344612 27.305920 -306.183960
		;call _MoveSF 84.621101 26.576220 -300.671173
		call _MoveSF 75.471497 26.040712 -296.320099
		;call _MoveSF 65.290985 26.298632 -295.874786
		;call _MoveSF 56.406281 27.663876 -300.415619
		call _MoveSF 46.282360 28.136585 -300.268341
		;call _MoveSF 41.990398 25.883179 -291.497192
		;call _MoveSF 42.688236 23.234257 -281.712280
		call _MoveSF 44.419079 20.813883 -271.955688
		;call _MoveSF 49.528709 18.652727 -263.632294
		;call _MoveSF 58.205929 18.071201 -258.376099
		call _MoveSF 67.807602 17.970163 -255.083588
		;call _MoveSF 77.901138 19.145428 -256.327698
		;call _MoveSF 87.873833 20.159639 -258.049347
		call _MoveSF 97.712143 21.150074 -259.747803
		;call _MoveSF 107.578102 22.318644 -261.464294
		;call _MoveSF 117.527504 23.582079 -262.034454
		call _MoveSF 127.465012 24.745640 -260.157837
		;call _MoveSF 136.304047 25.557760 -255.212692
		;call _MoveSF 144.562515 26.267101 -249.418335
		call _MoveSF 153.291168 27.180939 -243.949066
		wait 1
	}
	Trigger:Set[FALSE]
	call _MoveSF 155.827209 27.795170 -242.797562
	;call _MoveSF 150.888489 27.045366 -251.703369
	;call _MoveSF 146.262146 26.874533 -260.570984
	call _MoveSF 142.705811 27.042294 -270.091461
	;call _MoveSF 139.291672 27.396313 -279.730713
	;call _MoveSF 136.196350 27.881411 -289.333313
	call _MoveSF 133.889542 28.304192 -299.104858
	;call _MoveSF 132.759460 28.982281 -309.127625
	;call _MoveSF 132.165344 29.851683 -319.123016
	call _MoveSF 132.072128 30.010572 -329.333527
	;call _MoveSF 133.075287 30.636055 -339.427338
	;call _MoveSF 137.129074 30.990072 -348.698517
	call _MoveSF 144.783463 31.066422 -355.465149
	;call _MoveSF 152.824631 31.118851 -361.505707
	;call _MoveSF 161.450211 31.456791 -366.708313
	call _MoveSF 170.141724 31.417252 -371.803345
	
	DeleteVariable treecnt
}
function _MoveSF(float X1, float Y1, float Z1)
{
	variable float _X
	variable float _Z
	variable int _ID
	;echo ${Time}: MoveSFFN  ${X1} ${Y1} ${Z1}
	RI_Atom_SetLockSpot ${Me.Name}
	wait 1
	RI_Atom_ChangeLockSpot ALL ${X1} ${Y1} ${Z1}
	while ${Math.Distance[${Me.X},${Me.Z},${X1},${Z1}]}>2
	{
		;echo ${Time}: MoveSFLOOP ${Math.Distance[${Me.X},${Me.Z},${X1},${Z1}]}
		call RIMObj.checktoons
		call RIMObj.CheckPause
		if !${RI_Var_Bool_SkipLoot}
			call RIMObj.LootChest
		;check for a Shiny if set
		if ${RI_Var_Bool_GrabShinys} && !${RI_Var_Bool_GlobalOthers} && ${Actor[?,radius,${ShinyScanDistance}](exists)}
		{
			if ( !${Actor[NamedNPC,radius,50](exists)} || ${RI_Var_Bool_IgnoreNamedForShiny} || ${Math.Distance[${Actor[?,radius,${ShinyScanDistance}].Y},${Actor[NamedNPC,radius,50].Y}]}>10 ) && ${Math.Distance[${Actor[?,radius,${ShinyScanDistance}].Y},${Me.Y}]}<3
			{
				RI_Var_Int_ShinyID:Set[${Actor[?,radius,${ShinyScanDistance}].ID}]
				if ${RI_Var_Bool_Debug}
					echo ${Time}: Closest Shiny ID: ${RI_Var_Int_ShinyID} @ ${Actor[${RI_Var_Int_ShinyID}].X} ${Actor[${RI_Var_Int_ShinyID}].Y} ${Actor[${RI_Var_Int_ShinyID}].Z} Which is ${Actor[${RI_Var_Int_ShinyID}].Distance} Away
				;press -release ${RI_Var_String_ForwardKey}
				call RIMObj.CheckShiny
			}
		}
		RI_Atom_SetLockSpot ${Me.Name} ${X1} ${Y1} ${Z1}
		;echo ${Time}: MoveSFLOOP After Checks
		;if treecnt is less than 5 and the actor exists, and there is no collision between us, move to and kill them
		_ID:Set[${Actor["a wanderer amongst the detritus"].ID}]
		if ${_ID}!=0 && ${treecnt}<5 && ${Actor[id,${_ID}].Distance}<80 && ${Actor[id,${_ID}](exists)} && !${Actor[id,${_ID}].IsDead} && !${EQ2.CheckCollision[${Me.X},${Math.Calc[${Me.Y}+2]},${Me.Z},${Actor[id,${_ID}].X},${Math.Calc[${Actor[id,${_ID}].Y}+2]},${Actor[id,${_ID}].Z}]}
		{
			_X:Set[${Me.X}]
			_Z:Set[${Me.Z}]
			while ${Actor[id,${_ID}](exists)} && !${EQ2.CheckCollision[${Me.X},${Math.Calc[${Me.Y}+2]},${Me.Z},${Actor[id,${_ID}].X},${Math.Calc[${Actor[id,${_ID}].Y}+2]},${Actor[id,${_ID}].Z}]}
			{
				;echo ${Time}: Tree LOOP
				if ${Math.Distance[${Me.Loc},${Actor[id,${_ID}].Loc}]}<8
				{
					if ${Actor[id,${_ID}](exists)} && !${Actor[id,${_ID}].IsDead} && ${Target.ID}!=${_ID} && !${RI_Var_Bool_GlobalOthers}
						Actor[id,${_ID}]:DoTarget
				}
				call _MoveC ${Actor[id,${_ID}].X} ${Actor[id,${_ID}].Z}
				wait 2
			}
			wait 20
			;echo ${Time}: MoveSFLOOP TREE Before CombatCheck
			call RIMObj.CheckCombat
			;echo ${Time}: MoveSFLOOP TREE After CombatCheck / Before LS/RIFL
			RI_Atom_SetLockSpot ${Me.Name}
			relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetRIFollow ALL ${Me.ID} 1 100
			;echo ${Time}: MoveSFLOOP TREE AFTER LS/RIFL / Before First MOVEC
			call _MoveC ${_X} ${_Z}
			;echo ${Time}: MoveSFLOOP TREE AFTER First MOVEC / Before Second MOVEC
			call _MoveC ${X1} ${Z1}
			;echo ${Time}: MoveSFLOOP TREE AFTER Second MOVEC
		}
		;if the sphere of actor exists, and there is no collision between us, move to and kill them
		_ID:Set[${Actor["sphere of"].ID}]
		if ${_ID}!=0 && ${Actor[id,${_ID}].Distance}<80 && ${Actor[id,${_ID}](exists)} && !${EQ2.CheckCollision[${Me.X},${Math.Calc[${Me.Y}+2]},${Me.Z},${Actor[id,${_ID}].X},${Math.Calc[${Actor[id,${_ID}].Y}+2]},${Actor[id,${_ID}].Z}]}
		{
			_X:Set[${Me.X}]
			_Z:Set[${Me.Z}]
			while ${Actor[id,${_ID}](exists)} && !${EQ2.CheckCollision[${Me.X},${Math.Calc[${Me.Y}+2]},${Me.Z},${Actor[id,${_ID}].X},${Math.Calc[${Actor[id,${_ID}].Y}+2]},${Actor[id,${_ID}].Z}]}
			{
				;echo ${Time}: Sphere loop
				call _MoveC ${Actor[id,${_ID}].X} ${Actor[id,${_ID}].Z}
				wait 2
			}
			wait 50
			;echo ${Time}: MoveSFLOOP TREE Before CombatCheck
			call RIMObj.CheckCombat
			;echo ${Time}: MoveSFLOOP TREE After CombatCheck / Before LS/RIFL
			RI_Atom_SetLockSpot ${Me.Name}
			relay ${RI_Var_String_RelayGroup} -noredirect RI_Atom_SetRIFollow ALL ${Me.ID} 1 100
			;echo ${Time}: MoveSFLOOP TREE AFTER LS/RIFL / Before First MOVEC
			call _MoveC ${_X} ${_Z}
			;echo ${Time}: MoveSFLOOP TREE AFTER First MOVEC / Before Second MOVEC
			call _MoveC ${X1} ${Z1}
			;echo ${Time}: MoveSFLOOP TREE AFTER Second MOVEC
		}
		waitframe
	}
}
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; End OF TOT NAMED CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; START OF KA NAMED CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;; START Kaesora: Xalgozian Stronghold

function Vhankmin()
{
	echo ISXRI: Starting Vhankmin 
	
	if !${RI_Var_Bool_GlobalOthers}
		RI_Atom_SetLockSpot ${Me.Name} -180.570053 49.220165 422.158478
	else
		RI_Atom_SetLockSpot ALL -179.618195 48.901855 427.573242
	
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Vhankmin]:DoTarget
		wait 100 ${Actor[Vhankmin].Distance}<8
		RI_Atom_SetLockSpot ${Me.Name} -185.950378 48.913849 427.578949
	}
	
	while ${Actor[Query, Name=-"Vhankmin" && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[crocodile,radius,50](exists)}
			{
				if ${Target.ID}!=${Actor[crocodile,radius,50].ID}
					Actor[crocodile,radius,50]:DoTarget		
			}
			elseif ${Actor[fallen,radius,20](exists)}
			{
				if ${Target.ID}!=${Actor[fallen,radius,20].ID}
					Actor[fallen,radius,20]:DoTarget		
			}
			elseif ${Actor[spectral,radius,20](exists)}
			{
				if ${Target.ID}!=${Actor[spectral,radius,20].ID}
					Actor[spectral,radius,20]:DoTarget		
			}
			else
			{
				if ${Target.ID}!=${Actor[Query, Name=-"Vhankmin" && IsDead=FALSE].ID}
					Actor[Query, Name=-"Vhankmin" && IsDead=FALSE]:DoTarget
			}
		}
		wait 1
	}
	echo Ending Vhankmin
}

function Eghonz()
{
	AnnounceText:Clear
	AnnounceText:Insert[bulwark]
	echo ISXRI: Starting Eghonz 
	
	RI_Atom_SetLockSpot ALL -350.053131 -17.721470 510.971222
	
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Eghonz]:DoTarget
		wait 100 ${Actor[Eghonz].Distance}<8
		RI_Atom_SetLockSpot ${Me.Name} -343.833862 -17.118542 518.056519
	}
	
	while ${Actor[Query, Name=-"Eghonz" && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor[Query, Name=-"Eghonz" && IsDead=FALSE].ID}
				Actor[Query, Name=-"Eghonz" && IsDead=FALSE]:DoTarget
		}
		if ${Trigger}
		{
			;turn off assisting
			RI_CMD_Assisting 0
			
			wait 1
			;target self
			Actor[${Me.ID}]:DoTarget
			;back pet off
			eq2ex pet backoff
			eq2ex pet backoff
			
			Trigger:Set[FALSE]
			
			while !${Trigger} && ${Actor[Query, Name=-"Eghonz" && IsDead=FALSE](exists)}
				wait 1
				
			;turn on assisting
			RI_CMD_Assisting 1
			
			Trigger:Set[FALSE]
		}
		wait 1
	}
	echo Ending Eghonz
}

function Janosz()
{
	AnnounceText:Clear
	AnnounceText:Insert[bulwark]
	echo ISXRI: Starting Janosz 
	
	RI_Atom_SetLockSpot ALL -554.776917 -2.819610 258.928375
	
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, Name=-"Janosz" && IsDead=FALSE]:DoTarget
		wait 100 ${Actor[Query, Name=-"Janosz" && IsDead=FALSE].Distance}<10
		RI_Atom_SetLockSpot ${Me.Name} -561.612244 -2.201538 265.963348
	}
	
	while ${Actor[Query, Name=-"Janosz" && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor["General's Reaver",radius,50](exists)}
			{
				if ${Target.ID}!=${Actor["General's Reaver",radius,50].ID}
					Actor["General's Reaver",radius,50]:DoTarget		
			}
			else
			{
				if ${Target.ID}!=${Actor[Query, Name=-"Janosz" && IsDead=FALSE].ID}
					Actor[Query, Name=-"Janosz" && IsDead=FALSE]:DoTarget
			}
		}
		if ${Trigger}
		{
			;turn off assisting
			RI_CMD_Assisting 0
			
			wait 1
			;target self
			Actor[${Me.ID}]:DoTarget
			;back pet off
			eq2ex pet backoff
			eq2ex pet backoff
			
			Trigger:Set[FALSE]
			
			while !${Trigger} && ${Actor[Query, Name=-"Janosz" && IsDead=FALSE](exists)}
				wait 1
				
			;turn on assisting
			RI_CMD_Assisting 1
			
			Trigger:Set[FALSE]
		}
		wait 1
	}
	echo Ending Janosz
}
function Vihgoh()
{
	declare VihgohID int ${Actor[Query, Name=="Over-General Vihgoh"].ID}
	echo ISXRI: Starting Vihgoh 
	;turn on Singular Focus 4026518400  or if guardian Focused Offensive 1432018334
	if ${Me.SubClass.Equal[guardian]} && ${Me.Ability[id,1432018334].IsReady}
	{
		while !${Me.Maintained[Focused Offensive](exists)}
		{
			while ${Me.Ability[id,1432018334].IsReady}
			{
				Me.Ability[id,1432018334]:Use
				wait 5 ${Me.Maintained[Focused Offensive](exists)}
			}
			wait 5 ${Me.Maintained[Focused Offensive](exists)}
		}
	}
	elseif ${Me.Ability[id,4026518400].IsReady}
	{
		
		while !${Me.Maintained[Singular Focus](exists)}
		{
			while ${Me.Ability[id,4026518400].IsReady}
			{
				Me.Ability[id,4026518400]:Use
				wait 5 ${Me.Maintained[Singular Focus](exists)}
			}
			wait 5 ${Me.Maintained[Singular Focus](exists)}
		}
	}

	wait 10
	
	;turn off ae's in CB
	;if ${Me.Archetype.NotEqual[fighter]}
	;{
		RI_Obj_CB:DoNotCastEncounter[TRUE]
		RI_Obj_CB:DoNotCastAE[TRUE]
	;}
	Actor[${VihgohID}]:DoTarget
	
	;move to position
	RI_Atom_SetLockSpot ALL -540.560303 11.131656 -39.861198 
	wait 50
	;if ${Me.Archetype.NotEqual[fighter]}
	;	relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_MoveBehind ALL ${VihgohID} 30 99 ${Me.Name}
	
	while ${Actor[Query, ID=${VihgohID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${VihgohID}
				Actor[${VihgohID}]:DoTarget
		}
		wait 2
	}
	
	;turn on ae's in CB
	RI_Obj_CB:DoNotCastEncounter[FALSE]
	RI_Obj_CB:DoNotCastAE[FALSE]
	
	if ${Me.SubClass.Equal[guardian]}
		Me.Maintained[Focused Offensive]:Cancel
	else
		Me.Maintained[Singular Focus]:Cancel
		
	wait 10
	echo Ending Vihgoh
}
function XalgozianWrit()
{
	if ${RIObj.QuestExists["Kunark Ascending: Reading Assignment"]}
	{
		RI_Atom_SetLockSpot ALL ${Actor[Writ].X} ${Actor[Writ].Y} ${Actor[Writ].Z} 5 100
		while ${Actor[Query, Name =="Writ of War" && IsDead = FALSE](exists)}
		{
			if ${Target.ID}!=${Actor[Query, Name =="Writ of War"].ID}
				Actor[Query, Name =="Writ of War"]:DoTarget
			wait 1
		}
	}
}
;;;;;;;; END Kaesora: Xalgozian Stronghold


function Queshaun()
{
	AnnounceText:Clear
	AnnounceText:Insert[en]
	echo ISXRI: Starting Queshaun 
	
	RI_Atom_SetLockSpot ALL -549.282593 9.066755 -81.277527
	
	Actor[Query, Name=-"Queshaun" && IsDead=FALSE]:DoTarget
	
	while ${Actor[Query, Name=-"Queshaun" && IsDead=FALSE].Distance}>9
		wait 2
	
	if !${RI_Var_Bool_GlobalOthers}
		RI_Atom_SetLockSpot ${Me.Name} -559.911865 9.464098 -79.087914
	;else
	;	RI_Atom_SetLockSpot ALL -549.282593 9.066755 -81.277527
	
	while ${Actor[Query, Name=-"Queshaun" && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor[Query, Name=-"Queshaun" && IsDead=FALSE].ID}
				Actor[Query, Name=-"Queshaun" && IsDead=FALSE]:DoTarget
		}
		if ${Trigger} && ${TriggerMessage.Find[plagues](exists)}
		{
			;turn off assisting
			RI_CMD_Assisting 0
			
			wait 1
			;target self
			Actor[${Me.ID}]:DoTarget
			;back pet off
			eq2ex pet backoff
			eq2ex pet backoff
			
			Trigger:Set[FALSE]
			
			while !${Trigger} && ${Actor[Query, Name=-"Queshaun" && IsDead=FALSE](exists)}
				wait 1
				
			;turn on assisting
			RI_CMD_Assisting 1
			
			Trigger:Set[FALSE]
			
		}
		wait 1
	}
	echo Ending Qeushaun
}

function Caelan'Gael()
{
	echo ISXRI: Starting Caelan'Gael 
	
	;press shift+r
	if !${Me.IsCrouching}
		press ${RI_Var_String_CrouchKey}
		
	if !${RI_Var_Bool_GlobalOthers}
		RI_Atom_SetLockSpot ${Me.Name} -602.302917 -8.299364 13.011220
	else
		RI_Atom_SetLockSpot ALL -606.482300 -8.309934 12.990896
	
	while ${Actor[Query, Name=-"Caelan'Gael" && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=="vile prison" && Distance<=50 && IsDead=FALSE && ( Type=="NPC" || Type=="NamedNPC" )](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=="vile prison" && Distance<=50 && IsDead=FALSE && ( Type=="NPC" || Type=="NamedNPC" )].ID}
					Actor[Query, Name=="vile prison" && Distance<=50 && IsDead=FALSE && ( Type=="NPC" || Type=="NamedNPC" )]:DoTarget		
			}
			elseif ${Actor[Query, Name=="Elite Protector" && Distance<=20 && IsDead=FALSE && ( Type=="NPC" || Type=="NamedNPC" )](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=="Elite Protector" && Distance<=20 && IsDead=FALSE && ( Type=="NPC" || Type=="NamedNPC" )].ID}
					Actor[Query, Name=="Elite Protector" && Distance<=20 && IsDead=FALSE && ( Type=="NPC" || Type=="NamedNPC" )]:DoTarget		
			}
			else
			{
				if ${Target.ID}!=${Actor[Query, Name=-"Caelan'Gael" && IsDead=FALSE].ID}
					Actor[Query, Name=-"Caelan'Gael" && IsDead=FALSE]:DoTarget
			}
		}
		wait 1
	}
	
	;press shift+r
	if ${Me.IsCrouching}
		press ${RI_Var_String_CrouchKey}
	press ${RI_Var_String_JumpKey}
	echo Ending Caelan'Gael
}
function Lachina()
{
	AnnounceText:Clear
	AnnounceText:Insert["Lachina envelopes herself in a 1,000 plagues!"]
	AnnounceText:Insert["Endemic Redoubt fades!"]
	echo ISXRI: Starting Lachina 
	
	if !${RI_Var_Bool_GlobalOthers}
	{
		RI_Atom_SetLockSpot ${Me.Name} -346.727081 -8.355633 14.342555
		Actor[Lachina]:DoTarget
		wait 50
		RI_Atom_SetLockSpot ${Me.Name} -347.559875 -8.278683 11.910580
	}
	else
	{
		RI_Atom_SetLockSpot ALL -352.526703 -8.355646 17.103048
		;turn off assisting
		RI_CMD_Assisting 0
		
		wait 1
		;target self
		Actor[${Me.ID}]:DoTarget
		
		wait 50
		;turn on assisting
		RI_CMD_Assisting 1
		
		RI_Atom_SetLockSpot ALL -344.327759 -8.355633 17.309353
	}
	while ${Actor[Query, Name=-"Lachina" && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=-"Protector" && Distance <=20 && IsDead=FALSE && Type!="Pet"](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"Protector" && Distance <=20 && IsDead=FALSE && Type!="Pet"].ID}
					RIObj:BalanceMobs["Protector"]	
			}
			else
			{
				if ${Target.ID}!=${Actor[Query, Name=-"Lachina" && IsDead=FALSE].ID}
					Actor[Query, Name=-"Lachina" && IsDead=FALSE]:DoTarget
			}
		}
		if ${Trigger} && ${TriggerMessage.Find[plagues](exists)}
		{
			;turn off assisting
			RI_CMD_Assisting 0
			
			wait 1
			;target self
			Actor[${Me.ID}]:DoTarget
			;back pet off
			eq2ex pet backoff
			eq2ex pet backoff
			
			Trigger:Set[FALSE]

			while !${Trigger} && ${Actor[Query, Name=-"Lachina" && IsDead=FALSE](exists)}
				wait 1
				
			eq2ex target_none
			
			;turn on assisting
			RI_CMD_Assisting 1
			
			Trigger:Set[FALSE]
		}
		wait 1
	}
	while ${Actor[Query, Name=="an ancient familiar" && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor[Query, Name=="an ancient familiar" && IsDead=FALSE].ID}
				Actor[Query, Name=="an ancient familiar" && IsDead=FALSE]:DoTarget
		}
		wait 1
	}
	echo Ending Lachina
}
function Tabor'zaai()
{
	call Tabor'Zaai
}
function Tabor'Zaai()
{
	AnnounceText:Clear
	AnnounceText:Insert[glyphs]
	echo ISXRI: Starting Tabor'Zaai 
	
	;turn off assisting
	RI_CMD_Assisting 0
	
	if !${RI_Var_Bool_GlobalOthers}
	{
		RI_Atom_SetLockSpot ${Me.Name} -14.001640 8.738635 -166.310944
	}
	else
	{
		RI_Atom_SetLockSpot ALL -13.980902 8.654903 -162.166992
	}
	while ${Actor[Query, Name=-"Tabor'Zaai" && IsDead=FALSE](exists)}
	{
		;if !${RI_Var_Bool_GlobalOthers}
		;{
			if ${Target.ID}!=${Actor[Query, Name=-"Tabor'Zaai" && IsDead=FALSE].ID}
				Actor[Query, Name=-"Tabor'Zaai" && IsDead=FALSE]:DoTarget
		;}
		if ${Trigger}
		{
			;target remnant
			Actor[remnant]:DoTarget
						
			Trigger:Set[FALSE]
			while !${Trigger} && ${Actor[Query, Name=-"Tabor'Zaai" && IsDead=FALSE](exists)}
				wait 1
			
			Trigger:Set[FALSE]
		}
		wait 1
	}
					
	;turn on assisting
	RI_CMD_Assisting 1
	
	echo Ending Tabor'Zaai
}
;;;;;;;; Start Arcanna'se Spire: Vessel of the Sorceress

function VesselSentry()
{
	while !${Actor[Query, Name=="an Arcanna'se sentry" && IsAggro=TRUE && Distance < 100](exists)}
		waitframe
		
	relay "${RI_Var_String_RelayGroup}" RI_Atom_SetLockSpot ALL ${Me.X} ${Me.Y} ${Me.Z}
	
	while ${Actor[Query, Name=="an Arcanna'se sentry" && Distance < 100](exists)} && !${Actor[Query, Name=="The Crystallized Construct" && IsAggro=TRUE && Distance < 100](exists)}
	{
		if ${Actor[Query, Name=="an Arcanna'se sentry" && IsAggro=TRUE && IsDead=FALSE && Distance < 100](exists)}
		{
			if ${Target.ID}!=${Actor[Query, Name=="an Arcanna'se sentry" && IsAggro=TRUE && IsDead=FALSE && Distance < 100].ID}
				Actor[Query, Name=="an Arcanna'se sentry" && IsAggro=TRUE && IsDead=FALSE && Distance < 100]:DoTarget
		}
		wait 2
	}
	;relay "${RI_Var_String_RelayGroup}" RI_Atom_SetLockSpot OFF
}

function VesselSulite()
{
	while !${Actor[Query, Name=="an animated Sulite" && IsAggro=TRUE && Distance < 100](exists)}
		waitframe
		
	relay "${RI_Var_String_RelayGroup}" RI_Atom_SetLockSpot ALL ${Me.X} ${Me.Y} ${Me.Z}
	
	while ${Actor[Query, Name=="an animated Sulite" && IsAggro=TRUE && IsDead=FALSE && Distance < 100](exists)}
	{
		if ${Target.ID}!=${Actor[Query, Name=="an animated Sulite" && IsAggro=TRUE && IsDead=FALSE && Distance < 100].ID}
			Actor[Query, Name=="an animated Sulite" && IsAggro=TRUE && IsDead=FALSE && Distance < 100]:DoTarget
		wait 2
	}
	
	relay "${RI_Var_String_RelayGroup}" RI_Atom_SetLockSpot OFF
}
function Armor()
{
	echo ISXRI: Starting Armor 
	
	RI_Atom_SetLockSpot ALL -470.887695 35.104889 5.288488 1 100
	wait 50
	RI_Atom_SetLockSpot ALL -470.898621 35.104885 7.664916 1 100
	
	variable int _ArmorID
	_ArmorID:Set[${Actor["The Armor of Sul"].ID}]
	; while ${Actor[Query, ID=${_ArmorID} && IsDead=FALSE](exists)} && !${RIObj.MainIconIDExists[${_ArmorID},25]}
	; {
		; if !${RI_Var_Bool_GlobalOthers}
		; {
			; if ${Target.ID}!=${_ArmorID}
				; Actor[Query, ID=${_ArmorID}]:DoTarget
		; }
		; wait 2
	; }
	
	; while ${Actor[Query, ID=${_ArmorID} && IsDead=FALSE](exists)} && ${RIObj.MainIconIDExists[${_ArmorID},25]}
	; {
		; if !${RI_Var_Bool_GlobalOthers}
		; {
			; if ${Target.ID}!=${_ArmorID}
				; Actor[Query, ID=${_ArmorID}]:DoTarget
		; }
		; wait 2
	; }
	;RI_Atom_SetLockSpot ALL -470.684479 35.104889 18.014343 1 100
	while ${Actor[Query, ID=${_ArmorID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${_ArmorID}
				Actor[Query, ID=${_ArmorID}]:DoTarget
		}
		wait 2
	}
}
function Sorceress()
{
	echo ISXRI: Starting Sorceress 
	
	RIMUIObj:SetLockSpot[ALL,-458.240021,30.551283,-34.363510]
	variable int _MoveTime=0
	variable int _SorceressID
	_SorceressID:Set[${Actor["Sorceress Gwen'vae"].ID}]
	
	while ${Actor[Query, ID=${_SorceressID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[id,${_SorceressID},radius,30](exists)}
			{
				if ${Target.ID}!=${_SorceressID}
					Actor[id,${_SorceressID}]:DoTarget
			}
			else
			{
				if ${Target.ID}!=${Actor[vestigial,radius,30].ID}
					Actor[vestigial,radius,30]:DoTarget
			}
			if ${Actor[Query, Name=="Gwen'vae's whirlwind" && Distance <5](exists)} && ${Script.RunningTime}>${Math.Calc[${_MoveTime}+5000]}
			{
				_MoveTime:Set[${Script.RunningTime}]
				if ${Math.Distance[${Me.Loc},-458.240021,30.551283,-34.363510]}<5
				{
					relay "${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,-483.319397,30.502533,-76.777069]
					wait 50 ${Math.Distance[${Me.Loc},-483.319397,30.502533,-76.777069]}<5
				}
				elseif ${Math.Distance[${Me.Loc},-483.319397,30.502533,-76.777069]}<5
				{
					relay "${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,-484.295990,30.551153,-34.123516]
					relay ${RI_Var_String RelayGroup} wait 50 ${Math.Distance[${Me.Loc},-484.295990,30.551153,-34.123516]}<5
				}
				elseif ${Math.Distance[${Me.Loc},-484.295990,30.551153,-34.123516]}<5
				{
					relay "${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,-458.502533,30.492809,-77.323051]
					relay ${RI_Var_String RelayGroup} wait 50 ${Math.Distance[${Me.Loc},-458.502533,30.492809,-77.323051]}<5
				}
				elseif ${Math.Distance[${Me.Loc},-458.502533,30.492809,-77.323051]}<5
				{
					relay "${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,-458.240021,30.551283,-34.363510]
					relay ${RI_Var_String RelayGroup} wait 50 ${Math.Distance[${Me.Loc},-458.240021,30.551283,-34.363510]}<5
				}
			}
		}
		;need to add in code for mages to dispell with absorb magic, need to get named and id's of det
		;if we are a mage watch for spell's MainIconID and cast absorb magic
		if ${Me.Archetype.Equal[mage]}
		{
			echo ${RIMUIObj.MainIconIDExists[${_SorceressID},22]} && ${Me.Ability[id,1812025739].IsReady}
			;if we see "Astral Dominion" (MainIconID=22) on "Sorceress Gwen'vae", pause bot, stop casting and cast Absorb Magic
			if ${RIMUIObj.MainIconIDExists[${_SorceressID},22]} && ${Me.Ability[id,1812025739].IsReady}
			{
				;echo ${Time}: Astral Dominion Found
				
				;turn off assisting
				RI_CMD_Assisting 0
				
				;pause bots
				RI_CMD_PauseCombatBots 1
				
				;target "Sorceress Gwen'vae"
				Actor[Query, ID=${_SorceressID}]:DoTarget
				
				;cancel spellcast and clear ability queue
				eq2ex cancel_spellcast
				eq2ex clearabilityqueue 
				
				;wait until we are not casting
				wait 200 !${Me.CastingSpell}
				
				;keep attempting to cast absorb magic (ID=1812025739) until it is no longer ready (aka casted)
				do
				{
					if ${Target.ID}==${_SorceressID}
						Me.Ability[id,1812025739]:Use
					else
						Actor[Query, ID=${_SorceressID}]:DoTarget
					wait 1
				}
				while ${Me.Ability[id,1812025739].IsReady}
				
				;wait until we are not casting
				wait 200 !${Me.CastingSpell}
				
				;turn on assisting
				RI_CMD_Assisting 1
				
				;unpause bots
				RI_CMD_PauseCombatBots 0
			}
		}
		wait 1
	}
	echo Ending Sorceress
}

;;;;;;;; END Arcanna'se Spire: Vessel of the Sorceress


function Xerxes'kade()
{
	call Xerxes'Kade
}
function Xerxes'Kade()
{
	echo ISXRI: Starting Xerxes'Kade 
	if !${RI_Var_Bool_GlobalOthers}
		RI_Atom_SetLockSpot ALL -5.626295 5.593339 -101.020767
	else
		RI_Atom_SetLockSpot ALL -0.011539 5.593339 -92.666107
	while ${Actor[Query, Name=-"Xerxes'Kade" && IsDead=FALSE](exists)}
	{
		if ${Actor[Protector of Xerxes,radius,30](exists)}
		{
			if !${RI_Var_Bool_GlobalOthers}
			{
				if ${Target.ID}!=${Actor[Protector of Xerxes,radius,30].ID}
					Actor[Protector of Xerxes,radius,30]:DoTarget
			}
			relay ${RI_Var_String_RelayGroup} "RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Item:Bottled Endless Courage,TRUE]"
		}
		else
		{
			if !${RI_Var_Bool_GlobalOthers}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"Xerxes'Kade" && IsDead=FALSE].ID}
					Actor[Query, Name=-"Xerxes'Kade" && IsDead=FALSE]:DoTarget
			}
			relay ${RI_Var_String_RelayGroup} "RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Item:Bottled Endless Courage,FALSE]"
		}
		wait 1
	}
	relay ${RI_Var_String_RelayGroup} "RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Item:Bottled Endless Courage,TRUE]"
	echo Ending Xerxes'Kade
}

function RevealedFindArcaneSpell()
{
	if ${Math.Distance[${Actor[Unseal].Loc},123.540756,1.947796,0.800853]}<40
	{
		;WEST
		call RIMObj.Move 77.482826 1.717356 -26.178192 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 86.197166 1.638179 -21.221401 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 94.981010 1.638179 -16.297430 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 103.808449 1.638178 -11.353998 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 112.489334 1.638181 -6.124079 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 121.018738 1.947796 -0.839703 2 0 TRUE FALSE FALSE TRUE
		;find and move to Actor[Unseal].Loc
		if ${Actor[Unseal](exists)}
		{
			call RIMObj.Move ${Actor[Unseal].X} ${Actor[Unseal].Y} ${Actor[Unseal].Z} 2 0 TRUE FALSE FALSE FALSE
			wait 5
			Actor[Unseal]:DoubleClick
			wait 50
		}
		call RIMObj.Move 123.484497 1.947796 0.663286 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 132.204590 1.947796 5.729712 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 140.788422 2.527645 10.918268 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 144.479919 2.928718 13.130285 2 0 TRUE FALSE FALSE FALSE
		wait 5
		;click Actor[podium] twice
		Actor[podium]:DoubleClick
		wait 50
		Actor[podium]:DoubleClick
		wait 50
		call RIMObj.Move 135.732285 1.638182 8.366315 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 127.119965 1.947796 3.278051 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 118.382446 1.947796 -1.884159 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 109.707520 1.638178 -7.009406 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 101.005760 1.638178 -12.150508 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 92.348701 1.638179 -17.265188 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 83.715500 1.638180 -22.379244 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 75.027573 1.646889 -27.473829 2 0 TRUE FALSE FALSE TRUE
	}
	else
	{
		;NORTH
		call RIMObj.Move 76.252930 3.402782 -30.794004 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 76.952385 3.561481 -31.880140 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 82.134666 3.522867 -40.513153 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 87.309296 3.522867 -49.133415 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 92.130203 3.522867 -57.928806 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 102.062469 3.522870 -59.966686 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 112.082451 2.324602 -59.150764 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 122.194351 2.324602 -58.433834 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 131.987000 2.324602 -60.561306 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 139.905151 3.555652 -66.618797 2 0 TRUE FALSE FALSE TRUE
		;find and move to Actor[Unseal].Loc
		if ${Actor[Unseal](exists)}
		{
			call RIMObj.Move ${Actor[Unseal].X} ${Actor[Unseal].Y} ${Actor[Unseal].Z} 2 0 TRUE FALSE FALSE FALSE
			wait 5
			Actor[Unseal]:DoubleClick
			wait 50
		}
		call RIMObj.Move 145.551605 3.760696 -70.976471 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 138.719864 3.041158 -63.690674 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 130.200073 2.324602 -58.402435 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 120.062363 2.324602 -57.908882 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 109.989723 2.324602 -58.741211 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 99.948135 3.522869 -59.570980 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 89.830872 3.522867 -60.030056 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 84.258102 3.522867 -51.635406 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 80.737923 3.522867 -42.155495 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 77.850090 3.552786 -32.529354 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 74.546089 1.638181 -23.495798 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 83.778847 1.638180 -19.301407 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 93.072083 1.638179 -15.098880 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 102.048218 1.638178 -10.615721 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 111.027519 1.638179 -6.005989 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 119.848701 1.947796 -1.180086 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 128.572372 1.947796 3.736161 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 137.374527 1.638182 8.639326 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 145.907043 2.928718 13.471667 2 0 TRUE FALSE FALSE FALSE
		wait 5
		;click Actor[podium] twice
		Actor[podium]:DoubleClick
		wait 50
		Actor[podium]:DoubleClick
		wait 50
		call RIMObj.Move 137.198853 1.638182 8.718538 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 128.396057 1.947796 3.904975 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 119.498909 1.947796 -0.911943 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 110.648750 1.638181 -5.832401 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 101.900375 1.638178 -10.975382 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 93.349808 1.638179 -16.245651 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 84.707489 1.638179 -21.523640 2 0 TRUE FALSE FALSE TRUE
		call RIMObj.Move 76.085960 1.638180 -26.796047 2 0 TRUE FALSE FALSE TRUE
	}
}
function RevealedFindOrb()
{
	if ${Actor[crystal](exists)}
	{
		variable string LeftRight=NO
		if ${Math.Distance[${Actor[crystal].Loc},-63.366535,4.268709,46.043556]}<5
		{
			if ${Math.Distance[${Actor[crystal].Loc},-67.985870,4.102995,42.497650]}>6
			{
				LeftRight:Set[Right]
				call _Move3 -52.537910 4.324533 30.953112 FALSE FALSE
			}
			else
			{
				LeftRight:Set[Left]
				call _Move3 -63.451752 4.383376 33.048817 FALSE FALSE
			}
		}
		call _Move3 ${Actor[crystal].X} ${Actor[crystal].Y} ${Actor[crystal].Z} FALSE FALSE
		wait 5
		Actor[crystal]:DoubleClick
		wait 50
		if ${LeftRight.Equal[Right]}
		{
			call _Move3 -52.537910 4.324533 30.953112 FALSE FALSE
		}
		elseif ${LeftRight.Equal[Left]}
		{
			call _Move3 -63.451752 4.383376 33.048817 FALSE FALSE
		}
	}
}
function RevealedQueenInteract()
{
	Actor["Queen Alwenielle"]:DoTarget
	wait 5
	eq2ex Hail
	wait 5
	EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
	wait 5
	EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
	wait 5
	EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
	wait 5
	RewardWindow:AcceptReward
	wait 5
	RewardWindow:AcceptReward
}
function Gooblin()
{
	echo ISXRI: Starting Gooblin 
	
	variable int _GooblinID
	_GooblinID:Set[${Actor[Query, Name=-"The Gooblin King"].ID}]
	variable int _Counter
	_Counter:Set[1]
	variable int _PullTime
	_PullTime:Set[${Time.SecondsSinceMidnight}]
	variable bool _Moved
	_Moved:Set[FALSE]
	variable int _MyNum

	declare GroupArray[${Me.Group}] string
	declare Group string
	variable int count=0
	for(count:Set[1];${count}<=${Me.Group};count:Inc)
		GroupArray[${count}]:Set[${Me.Group[${Math.Calc[${count}-1]}]}]
	variable int count2=0
	declare temp string
	for(count:Set[1];${count}<=${GroupArray.Size};count:Inc)
	{
		for(count2:Set[1];${count2}<=${GroupArray.Size};count2:Inc)
		{
			if ${GroupArray[${count2}].Compare[${GroupArray[${count}]}]}>0
			{
				temp:Set[${GroupArray[${count}]}]
				GroupArray[${count}]:Set[${GroupArray[${count2}]}]
				GroupArray[${count2}]:Set[${temp}]
			}
		}
    }
	for(count:Set[1];${count}<=${GroupArray.Size};count:Inc)
	{
		if ${Me.Name.Equal[${GroupArray[${count}]}]}
			_MyNum:Set[${count}]
	}
	
	RI_Atom_SetLockSpot ALL 514.938843 -59.220978 79.529190
	
	while ${Actor[Query, ID="${_GooblinID}"](exists)} && !${Actor[Query, ID="${_GooblinID}"].IsDead}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${_GooblinID}
				Actor[Query, ID="${_GooblinID}"]:DoTarget
						
			;echo ( ${Math.Distance[${_PullTime}-30]}>${Time.SecondsSinceMidnight} || ${Actor[Query, ID="${_GooblinID}"].Distance}<10 ) && !${_Moved}
			if  !${_Moved}
			{
				if ( ${Math.Distance[${_PullTime}-30]}>${Time.SecondsSinceMidnight} || ${Actor[Query, ID="${_GooblinID}"].Distance}<10 )
				{
					RI_Atom_SetLockSpot ALL 527.659973 -59.227776 74.717911
					_Moved:Set[TRUE]
				}
			}
		}
		if ${RIObj.MainIconIDExists[${_GooblinID},897]}
		{
			if  ${_Counter}==${_MyNum}
			{
			;turn off assisting
			RI_CMD_Assisting 0
			
			;pause bots
			RI_CMD_PauseCombatBots 1
			
			;target
			Actor[Query, ID="${_GooblinID}"]:DoTarget
			
			;cancel spellcast and clear ability queue
			eq2ex cancel_spellcast
			eq2ex clearabilityqueue 
			
			;wait until we are not casting
			wait 200 !${Me.CastingSpell}
			
			;keep attempting to cast/use until no longer ready (aka casted/used)
			do
			{
				if ${Target.ID}==${_GooblinID}
					Me.Inventory[Query, Name="Soothsayer's Bomb Dispenser"]:Use
				else
					Actor[Query, ID="${_GooblinID}"]:DoTarget
				wait 3
			}
			while ${Me.Inventory[Query, Name="Soothsayer's Bomb Dispenser"].IsReady}
			
			;wait until we are not casting
			wait 200 !${Me.CastingSpell}
			
			;turn on assisting
			RI_CMD_Assisting 1
			
			;unpause bots
			RI_CMD_PauseCombatBots 0
			
			if ${_Counter}==6
				_Counter:Set[1]
			else
			_Counter:Inc
			
			wait 10
			}
			else
			{
				if ${_Counter}==6
					_Counter:Set[1]
				else
				_Counter:Inc
				wait 300 !${RIObj.MainIconIDExists[${_GooblinID},897]}
			}
		}

		wait 1
	}
	echo Ending Gooblin
}
function UseItem(string _ItemName, int _Repeats=2, bool _WaitTillReady=FALSE)
{
	if !${RI_Var_Bool_GlobalOthers}
		relay "other ${RI_Var_String_RelayGroup}" Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call UseItem \"${_ItemName}\" ${_Repeats}"]
	;pause bots
	variable bool _Botwaspaused=0
	if ${CombatBotPaused}
		_Botwaspaused:Set[1]
	if !${_Botwaspaused}
		RI_CMD_PauseCombatBots 1
	eq2ex cancel_spellcast
	wait 2
	if ${_WaitTillReady}
	{
		echo ISXRI: Waiting (${Me.Inventory[Query, Name=-"${_ItemName}" && Location=="Inventory"].TimeUntilReady}) for ${Me.Inventory[Query, Name=-"${_ItemName}" && Location=="Inventory"].Name} to be ready
		while !${Me.Inventory[Query, Name=-"${_ItemName}" && Location=="Inventory"].IsReady}
			wait 2
	}
	Me.Inventory[Query, Name=-"${_ItemName}" && Location=="Inventory"]:Use
	wait 5
	if ${_Repeats}>1
		Me.Inventory[Query, Name=-"${_ItemName}" && Location=="Inventory"]:Use
	wait 20
	;unpause bots
	if !${_Botwaspaused}
		RI_CMD_PauseCombatBots 0
}
function UseRenfry(int _Which=2)
{
	;pause bots
	RI_CMD_PauseCombatBots 1
	eq2ex cancel_spellcast
	wait 2
	Me.Inventory[Query, Name=-"Renfry's Basement Bauble" && Location=="Inventory"]:Examine
	wait 2
	Me.Inventory[Query, Name=-"Renfry's Basement Bauble" && Location=="Inventory"]:Examine
	wait 2
	Me.Inventory[Query, Name=-"Renfry's Basement Bauble" && Location=="Inventory"]:Examine
	wait 2
	ReplyDialog:Choose[${_Which}]
	wait 2
	ReplyDialog:Choose[${_Which}]
	wait 2
	ReplyDialog:Choose[${_Which}]
	;unpause bots
	RI_CMD_PauseCombatBots 0
}
function UseItemRenfry(int _ZoneSelect=1)
{
	if !${RI_Var_Bool_GlobalOthers}
		relay "other ${RI_Var_String_RelayGroup}" Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call UseItem \"${_ItemName}\" ${_Repeats}"]
	;pause bots
	variable bool _Botwaspaused=0
	if ${CombatBotPaused}
		_Botwaspaused:Set[1]
	if !${_Botwaspaused}
		RI_CMD_PauseCombatBots 1
	eq2ex cancel_spellcast
	wait 2
	Me.Inventory[Query, Name=-"${_ItemName}" && Location=="Inventory"]:Use
	wait 5
	if ${_Repeats}>1
		Me.Inventory[Query, Name=-"${_ItemName}" && Location=="Inventory"]:Use
	wait 20
	;unpause bots
	if !${_Botwaspaused}
		RI_CMD_PauseCombatBots 0
}
function UseItemVdl(string _ItemName, int _Repeats=2)
{
	if !${RI_Var_Bool_GlobalOthers}
		relay "other ${RI_Var_String_RelayGroup}" Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call UseItemVdl \"${_ItemName}\" ${_Repeats}"]
	;pause bots
	variable bool _Botwaspaused=0
	if ${CombatBotPaused}
		_Botwaspaused:Set[1]
	if !${_Botwaspaused}
		RI_CMD_PauseCombatBots 1
	eq2ex cancel_spellcast
	wait 2
	eq2ex /use_itemvdl ${Me.Inventory[${_ItemName}].LinkID}
	wait 5
	if ${_Repeats}>1
		eq2ex /use_itemvdl ${Me.Inventory[${_ItemName}].LinkID}
	wait 20
	;unpause bots
	if !${_Botwaspaused}
		RI_CMD_PauseCombatBots 0
}
;;;;;;;;;;;;;;;; Start Crypt of Dalnir: Ritual Chamber [Heroic] ;;;;;;;;;;;;;;;;;;;;;;
function Rector()
{
	echo Starting Rector v1
	variable int _RectorID=${Actor[Query, Name=-"Rector Droz'Kzar" && IsDead=FALSE].ID}
	RI_Atom_SetLockSpot ALL -37.306847 -38.695023 -342.903687
	
	if !${RI_Var_Bool_GlobalOthers}
		Actor[Query, ID=${_RectorID} && IsDead=FALSE]:DoTarget

	while ${Actor[Query, ID=${_RectorID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=-"a Kly believer" && Distance<=40 && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"a Kly believer" && Distance<=40 && IsDead=FALSE].ID}
					Actor[Query, Name=-"a Kly believer" && Distance<=40 && IsDead=FALSE]:DoTarget
			}
			elseif ${Actor[Query, Name=-"a Kly" && Distance<=10 && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"a Kly" && Distance<=10 && IsDead=FALSE].ID}
					Actor[Query, Name=-"a Kly" && Distance<=10 && IsDead=FALSE]:DoTarget
			}
			else
			{
				if ${Target.ID}!=${_RectorID}
					Actor[Query, ID=${_RectorID} && IsDead=FALSE]:DoTarget
			}
		}
		if ${Actor[Query, Name=-"Droz'kar's totem" && Distance<=20](exists)}
		{
			if ${Math.Distance[${Me.Loc},-37.306847,-38.695023,-342.903687]}<25
			{
				RI_Atom_SetLockSpot ALL 39.722591 -38.682175 -342.767426
				wait 100 ${Math.Distance[${Me.Loc},39.722591,-38.682175,-342.767426]}<3
			}
			elseif ${Math.Distance[${Me.Loc},39.722591,-38.682175,-342.767426]}<25
			{
				RI_Atom_SetLockSpot ALL 39.284538 -38.676414 -407.823883
				wait 100 ${Math.Distance[${Me.Loc},39.284538,-38.676414,-407.823883]}<3
			}
			elseif ${Math.Distance[${Me.Loc},39.284538,-38.676414,-407.823883]}<25
			{
				RI_Atom_SetLockSpot ALL -38.440502 -38.672028 -408.496338
				wait 100 ${Math.Distance[${Me.Loc},-38.440502,-38.672028,-408.496338]}<3
			}
		}
		wait 2
	}
	
	echo Ending Rector v1
}
function Izzak()
{
	echo Starting Izzak v1

	declare Rune3Color string global
	declare Rune2Color string global
	declare Rune1Color string global
	variable string RCColor
	variable int CurrentRune
	variable int CurrentRuneToMoveFrom
	RIMUIObj:SetLockSpot[ALL,-120.142761,-38.725399,-404.647614]
	if !${RI_Var_Bool_GlobalOthers}
	{
		while ${Actor[Rune Base 3].HighlightOnMouseHover} || !${Actor[Query, Name=-"Ritual Rune" && Distance<=25](exists)}
			Actor[Rune Base 3]:DoubleClick
		
		wait 25
		if ${Actor[Query, Name=-"Purple Ritual Rune" && Distance<=25](exists)}
			Rune3Color:Set[purple];echo ISXRI: Rune 3 Color is purple
		elseif ${Actor[Query, Name=-"Yellow Ritual Rune" && Distance<=25](exists)}
			Rune3Color:Set[yellow];echo ISXRI: Rune 3 Color is yellow
		elseif ${Actor[Query, Name=-"Green Ritual Rune" && Distance<=25](exists)}
			Rune3Color:Set[green];echo ISXRI: Rune 3 Color is green
		elseif ${Actor[Query, Name=-"Red Ritual Rune" && Distance<=25](exists)}
			Rune3Color:Set[red];echo ISXRI: Rune 3 Color is red
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,OFF]
		;relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetRIFollow[ALL,${Me.Name},2,100]
		call RIMObj.Move -59.003780 -38.732059 -398.872070 1 0 0 0 1 1 1 1
		call RIMObj.Move -49.839794 -38.821129 -309.264923 1 0 0 0 1 1 1 1
		call RIMObj.Move -87.385818 -38.950321 -271.605042 1 0 0 0 1 0 1 1
		call RIMObj.CheckCombat
		if ${Actor[Query, Name=-"a rune keeper" && Distance<=75](exists)}
			Actor[Query, Name=-"a rune keeper" && Distance<=75]:DoTarget
		wait 50
		call RIMObj.CheckCombat
		wait 10
		while ${Actor[Rune Base 2].HighlightOnMouseHover} || !${Actor[Query, Name=-"Ritual Rune" && Distance<=25](exists)}
			Actor[Rune Base 2]:DoubleClick
		wait 25
		if ${Actor[Query, Name=-"Purple Ritual Rune" && Distance<=25](exists)}
			Rune2Color:Set[purple];echo ISXRI: Rune 2 Color is purple
		elseif ${Actor[Query, Name=-"Yellow Ritual Rune" && Distance<=25](exists)}
			Rune2Color:Set[yellow];echo ISXRI: Rune 2 Color is yellow
		elseif ${Actor[Query, Name=-"Green Ritual Rune" && Distance<=25](exists)}
			Rune2Color:Set[green];echo ISXRI: Rune 2 Color is green
		elseif ${Actor[Query, Name=-"Red Ritual Rune" && Distance<=25](exists)}
			Rune2Color:Set[red];echo ISXRI: Rune 2 Color is red
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,OFF]
		;relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetRIFollow[ALL,${Me.Name},2,100]	
		call RIMObj.Move -43.327141 -38.723545 -315.968689 1 0 0 0 1 1 1 1
		call RIMObj.Move 52.124790 -38.850292 -307.441772 1 0 0 0 1 1 1 1
		call RIMObj.Move 86.053574 -38.950344 -273.199799 1 0 0 0 1 0 1 1
		call RIMObj.CheckCombat
		if ${Actor[Query, Name=-"a rune keeper" && Distance<=75](exists)}
			Actor[Query, Name=-"a rune keeper" && Distance<=75]:DoTarget
		wait 50
		call RIMObj.CheckCombat
		wait 10
		while ${Actor[Rune Base 1].HighlightOnMouseHover} || !${Actor[Query, Name=-"Ritual Rune" && Distance<=25](exists)}
			Actor[Rune Base 1]:DoubleClick
		wait 25
		if ${Actor[Query, Name=-"Purple Ritual Rune" && Distance<=25](exists)}
			Rune1Color:Set[purple];echo ISXRI: Rune 1 Color is purple
		elseif ${Actor[Query, Name=-"Yellow Ritual Rune" && Distance<=25](exists)}
			Rune1Color:Set[yellow];echo ISXRI: Rune 1 Color is yellow
		elseif ${Actor[Query, Name=-"Green Ritual Rune" && Distance<=25](exists)}
			Rune1Color:Set[green];echo ISXRI: Rune 1 Color is green
		elseif ${Actor[Query, Name=-"Red Ritual Rune" && Distance<=25](exists)}
			Rune1Color:Set[red];echo ISXRI: Rune 1 Color is red
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,OFF]
		;relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetRIFollow[ALL,${Me.Name},2,100]	
		call RIMObj.Move 49.130096 -38.768909 -312.693054 1 0 0 0 1 1 1 1
		call RIMObj.Move 61.758938 -38.729225 -399.447205 1 0 0 0 1 1 1 1
		call RIMObj.Move 124.083481 -38.726044 -406.049316 1 0 0 0 1 1 1 1
		call RIMObj.Move 147.064316 -38.725487 -401.148499 1 0 0 0 1 0 1 1
		if ${Actor[Query, Name=-"a gooblin" && Distance<=35](exists)}
			Actor[Query, Name=-"a gooblin" && Distance<=75]:DoTarget
		wait 50
		call RIMObj.CheckCombat
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,OFF]
		;relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetRIFollow[ALL,${Me.Name},2,100]	
		call RIMObj.Move 267.796814 -38.724056 -400.933228 1 0 0 0 1 1 1 1
		call RIMObj.Move 267.342682 -38.723660 -333.526550 1 0 0 0 1 0 1 1
		wait 50
		call RIMObj.CheckCombat
		call RIMObj.Move 267.618073 -38.574669 -300.583923 1 0 0 0 1 0 1 1
		wait 50
		call RIMObj.CheckCombat
		while !${Actor[Query, Name=-"Izzak Sira" && IsDead=FALSE && Distance<=50](exists)}
			wait 2
		relay ${RI_Var_String_RelayGroup} RI_Obj_CB:CastWhileMoving[1]
		
		if !${RI_Var_Bool_GlobalOthers}
		{
			while ${Target.ID}!=${Actor[Query, Name=-"Izzak Sira" && IsDead=FALSE && Distance<=50].ID}
				Actor[Query, Name=-"Izzak Sira" && Type=="NamedNPC" && IsDead=FALSE && Distance<=50]:DoTarget
		}
		while ${Actor[Query, Name=-"Rune Circle" && Distance<=50].Overlay.Right[-19].Equal[""]}
			wait 2
		
		;Rune Circle
		;Purple Overlay=design_ring_dragon_purple
		;Red Overlay=design_ring_dragon_red
		;Green Overlay=design_ring_dragon_green
		
		call RIMObj.Move 267.494659 -38.723606 -330.392670 1 0 0 0 1 0 1 1
		wait 50
		if ${Actor[Query, Name=-"Rune Circle" && Distance<=50](exists)}
			RCColor:Set[${Actor[Query, Name=-"Rune Circle" && Distance<=50].Overlay.Right[-19]}]
		else
			RCColor:Set[NONE]
		echo ISXRI: Rune Circle Color is ${RCColor}
		call RIMObj.Move 262.068939 -38.724697 -396.927765 1 0 0 0 1 0 1 1
		wait 50;call IzzakCheckAdds
		call RIMObj.Move 199.829590 -38.725895 -400.151184 1 0 0 0 1 0 1 1
		wait 50;call IzzakCheckAdds
		call RIMObj.Move 135.818924 -38.730408 -414.746277 1 0 0 0 1 0 1 1
		wait 50;call IzzakCheckAdds
		call RIMObj.Move 103.001060 -38.723740 -400.356812 1 0 0 0 1 0 1 1
		wait 50;call IzzakCheckAdds
		call RIMObj.Move 53.915699 -38.724609 -400.820740 1 0 0 0 1 0 1 1
		wait 50;call IzzakCheckAdds
		
		;now need to determine which room to move too
		if ${RCColor.Equal[${Rune3Color}]}
			CurrentRune:Set[3];call Rune4ToRune3
		elseif ${RCColor.Equal[${Rune2Color}]}
			CurrentRune:Set[2];call Rune4ToRune2
		elseif ${RCColor.Equal[${Rune1Color}]}
			CurrentRune:Set[1];call Rune4ToRune1
	}
	while ${Actor[Query, Name=-"Izzak Sira" && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor[Query, Name=-"Izzak Sira" && IsDead=FALSE].ID}
				Actor[Query, Name=-"Izzak Sira" && IsDead=FALSE]:DoTarget
			
			;check current Rune Circle Overlay against Stored if it changes, check which room we in and which to move too
			if ${Actor[Query, Name=-"Rune Circle"].Overlay.Right[-19].NotEqual[${RCColor}]} && ${Actor[Query, Name=-"Rune Circle"].Overlay.Right[-19].NotEqual[""]} && ${Actor[Query, Name=-"Rune Circle"](exists)}
			{
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,OFF]
				;relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetRIFollow[ALL,${Me.Name},2,100]
				RCColor:Set[${Actor[Query, Name=-"Rune Circle"].Overlay.Right[-19]}]
				echo ISXRI: Rune Circle Color is ${RCColor}
				;now need to determine which room to move too
				CurrentRuneToMoveFrom:Set[${CurrentRune}]
				if ${RCColor.Equal[${Rune3Color}]}
					CurrentRune:Set[3];call Rune${CurrentRuneToMoveFrom}ToRune3
				elseif ${RCColor.Equal[${Rune2Color}]}
					CurrentRune:Set[2];call Rune${CurrentRuneToMoveFrom}ToRune2
				elseif ${RCColor.Equal[${Rune1Color}]}
					CurrentRune:Set[1];call Rune${CurrentRuneToMoveFrom}ToRune1
			}
		}
		
		wait 2
	}
	if ${RCColor.NotEqual[NONE]}
		call Rune${CurrentRune}ToRune4
	relay ${RI_Var_String_RelayGroup} RI_Obj_CB:CastWhileMoving[0]
	DeleteVariable Rune1Color
	DeleteVariable Rune2Color
	DeleteVariable Rune3Color
	echo Ending Izzak v1
}
function Rune1Spread()
{
	;spread to runes
	RIMUIObj:SetLockSpot[${Me.Name},83.342293,-38.952065,-273.159302]
	wait 30
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[1].Name},92.858215,-38.956055,-276.594238]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[2].Name},81.786659,-38.956318,-265.158997]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[3].Name},89.641335,-38.954987,-256.695709]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[4].Name},97.177101,-38.951221,-259.603577]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5].Name},100.382172,-38.954205,-270.127838]
	wait 50
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,83.342293,-38.952065,-273.159302]
}
function Rune4ToRune1()
{
	echo ISXRI: Moving from Rune 4 to Rune 1
	call RIMObj.Move 56.835205 -38.723545 -359.974792 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move 44.137169 -38.723545 -316.960724 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move 84.067093 -38.950638 -274.708374 5 0 0 0 1 0 1 1
	call Rune1Spread
}

function Rune3ToRune1()
{	
	echo ISXRI: Moving from Rune 3 to Rune 1
	call RIMObj.Move -56.210438 -38.728661 -399.561615 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move -59.454144 -38.723545 -357.618683 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move -41.744484 -38.723545 -316.415833 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move 0.394581 -38.723545 -305.481354 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move 44.137169 -38.723545 -316.960724 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move 84.067093 -38.950638 -274.708374 5 0 0 0 1 0 1 1
	call Rune1Spread
}
function Rune2ToRune1()
{
	echo ISXRI: Moving from Rune 2 to Rune 1
	call RIMObj.Move -41.744484 -38.723545 -316.415833 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move 0.394581 -38.723545 -305.481354 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move 44.137169 -38.723545 -316.960724 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move 84.067093 -38.950638 -274.708374 5 0 0 0 1 0 1 1
	call Rune1Spread
}
function Rune2Spread()
{
	;spread to runes
	RIMUIObj:SetLockSpot[${Me.Name},-82.972740,-38.955830,-267.231079]
	wait 30
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[1].Name},-89.250496,-38.953705,-275.331909]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[2].Name},-84.984138,-38.955116,-259.173828]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[3].Name},-98.785721,-38.954678,-273.920685]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[4].Name},-94.920250,-38.952499,-257.920319]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5].Name},-100.295395,-38.951611,-262.473602]
	wait 50
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-82.972740,-38.955830,-267.231079]
}
function Rune4ToRune2()
{
	echo ISXRI: Moving from Rune 4 to Rune 2
	call RIMObj.Move 56.835205 -38.723545 -359.974792 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move 44.137169 -38.723545 -316.960724 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move 0.394581 -38.723545 -305.481354 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move -41.744484 -38.723545 -316.415833 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move -82.274704 -38.955997 -267.662262 5 0 0 0 1 0 1 1
	call Rune2Spread
}
function Rune1ToRune2()
{
	echo ISXRI: Moving from Rune 1 to Rune 2
	call RIMObj.Move 44.137169 -38.723545 -316.960724 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move 0.394581 -38.723545 -305.481354 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move -41.744484 -38.723545 -316.415833 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move -82.274704 -38.955997 -267.662262 5 0 0 0 1 0 1 1
	call Rune2Spread
}
function Rune3ToRune2()
{
	echo ISXRI: Moving from Rune 3 to Rune 2
	call RIMObj.Move -56.210438 -38.728661 -399.561615 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move -59.454144 -38.723545 -357.618683 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move -41.949459 -38.723545 -317.303955 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move -82.274704 -38.955997 -267.662262 5 0 0 0 1 0 1 1
	call Rune2Spread
}
function Rune3Spread()
{
	;spread to runes
	RIMUIObj:SetLockSpot[${Me.Name},-113.591309,-38.725742,-404.902100]
	wait 30
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[1].Name},-120.864731,-38.729694,-414.016785]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[2].Name},-116.989716,-38.725212,-396.962585]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[3].Name},-129.951187,-38.732758,-410.980804]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[4].Name},-125.213203,-38.728214,-395.339355]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5].Name},-131.445450,-38.724316,-399.597443]
	wait 50
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-113.591309,-38.725742,-404.902100]
}
function Rune4ToRune3()
{
	echo ISXRI: Moving from Rune 4 to Rune 3
	call RIMObj.Move -0.850155 -38.668236 -411.436340 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move -56.216011 -38.729515 -401.816833 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move -113.591309 -38.725742 -404.902100 5 0 0 0 1 0 1 1
	call Rune3Spread
}
function Rune2ToRune3()
{
	echo ISXRI: Moving from Rune 2 to Rune 3
	call RIMObj.Move -41.949459 -38.723545 -317.303955 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move -59.454144 -38.723545 -357.618683 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move -56.210438 -38.728661 -399.561615 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move -113.591309 -38.725742 -404.902100 5 0 0 0 1 0 1 1
	call Rune3Spread
}
function Rune1ToRune3()
{
	echo ISXRI: Moving from Rune 1 to Rune 3
	call RIMObj.Move 44.137169 -38.723545 -316.960724 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move 0.394581 -38.723545 -305.481354 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move -41.744484 -38.723545 -316.415833 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move -59.454144 -38.723545 -357.618683 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move -56.210438 -38.728661 -399.561615 1 0 0 0 1 0 1 1
	wait 50;call IzzakCheckAdds
	call RIMObj.Move -113.591309 -38.725742 -404.902100 5 0 0 0 1 0 1 1
	call Rune3Spread
}
function Rune3ToRune4()
{
	echo ISXRI: Moving from Rune 3 to Rune 4
	call RIMObj.Move -55.197220 -38.725742 -400.153961 1 0 0 0 1 0 1 1
	call RIMObj.Move -0.737747 -38.658245 -411.872620 1 0 0 0 1 0 1 1
	call RIMObj.Move 60.601391 -38.724205 -400.739014 1 0 0 0 1 0 1 1
}
function Rune1ToRune4()
{
	echo ISXRI: Moving from Rune 1 to Rune 4
	call RIMObj.Move 49.050411 -38.804855 -310.460358 1 0 0 0 1 0 1 1
	call RIMObj.Move 60.601391 -38.724205 -400.739014 1 0 0 0 1 0 1 1
}
function Rune2ToRune4()
{
	echo ISXRI: Moving from Rune 2 to Rune 4
	call RIMObj.Move -47.204666 -38.780640 -311.168488 1 0 0 0 1 0 1 1
	call RIMObj.Move 49.050411 -38.804855 -310.460358 1 0 0 0 1 0 1 1
	call RIMObj.Move 60.601391 -38.724205 -400.739014 1 0 0 0 1 0 1 1
}
function IzzakCheckAdds()
{
	while ${Actor[Query, ( Name=-"a Kly" || Name=-"an exhumed" ) && IsDead=FALSE && Distance<=10](exists)}
	{
		if ${Target.ID}!=${Actor[Query, ( Name=-"a Kly" || Name=-"an exhumed" ) && IsDead=FALSE && Distance<=10].ID}	
			Actor[Query, ( Name=-"a Kly" || Name=-"an exhumed" ) && IsDead=FALSE && Distance<=10]:DoTarget
		wait 2
	}
}
function Amalgam()
{
	echo Starting Amalgam v1
	
	if !${RI_Var_Bool_GlobalOthers}
	{
		variable string Rune1Color=${Actor[Query,Name=-"Displayed Rune" && X=18 && Y=-26 && Z=-485].Name.Left[-14]}
		variable string Rune2Color=${Actor[Query,Name=-"Displayed Rune" && X=9.5 && Y=-26 && Z=-485].Name.Left[-14]}
		variable string Rune3Color=${Actor[Query,Name=-"Displayed Rune" && X<-9 && Y=-26 && Z=-485].Name.Left[-14]}
		
		echo Rune 1 Color: ${Rune1Color}
		echo Rune 2 Color: ${Rune2Color}
		echo Rune 3 Color: ${Rune3Color}
		
		call RIMObj.Move -0.094713 -13.985909 -535.933411 1 0 0 0 1 0 1 1
		call PreHeal
		call Target Gooblin 1 50
		call RIMObj.Move -0.074848 -13.985765 -575.803528 1 0 0 0 1 0 1 1
		call RIMObj.Move -0.094722 -13.985959 -591.789978 1 0 0 0 1 0 1 1
		call PreHeal
		call Target Gooblin 1 50
		variable string Triad1Color=${Actor[Query,Name=-"Triad Rune" && X=45.930000 && Y=-7.360000 && Z=-606.150024].Name.Left[-10]}
		variable string Triad2Color=${Actor[Query,Name=-"Triad Rune" && X=0.220000 && Y=-7.350000 && Z=-679.210022].Name.Left[-10]}
		variable string Triad3Color=${Actor[Query,Name=-"Triad Rune" && X=-48.869999 && Y=-7.350000 && Z=-604.599976].Name.Left[-10]}
		
		echo Triad 1 Color: ${Triad1Color}
		echo Triad 2 Color: ${Triad2Color}
		echo Triad 3 Color: ${Triad3Color}
		
		if ${Actor[Query, Name=-"Amalgam" && IsDead=FALSE](exists)}
		{
			variable string CurrentRune
			if ${Rune1Color.Equal[${Triad1Color}]}
			{
				call RIMObj.Move 52.391975 -13.992254 -602.711731 1 0 0 0 1 0 1 1
				CurrentRune:Set[1]
			}
			elseif ${Rune1Color.Equal[${Triad2Color}]}
			{
				call RIMObj.Move 43.095505 -13.996938 -604.894897 1 0 0 0 1 0 1 1
				call RIMObj.Move -0.007319 -13.985608 -676.263977 1 0 0 0 1 0 1 1
				CurrentRune:Set[2]
			}
			elseif ${Rune1Color.Equal[${Triad3Color}]}
			{
				call RIMObj.Move -53.491779 -13.994169 -601.748352 1 0 0 0 1 0 1 1
				CurrentRune:Set[3]
			}
			call RIMObj.Move ${String["${Actor[Query, Name=="Triad Rune Base ${CurrentRune}"].Loc}"].Replace[","," "]} 5 0 0 0 1 0 1 1
			wait 20
			while ${Actor[Query, Name=="Triad Rune Base ${CurrentRune}"].HighlightOnMouseHover}
				Actor[Query, Name=="Triad Rune Base ${CurrentRune}"]:DoubleClick
			
			if ${Rune2Color.Equal[${Triad1Color}]}
			{
				call RIMObj.Move 52.391975 -13.992254 -602.711731 1 0 0 0 1 0 1 1
				CurrentRune:Set[1]
			}
			elseif ${Rune2Color.Equal[${Triad2Color}]}
			{
				call RIMObj.Move -0.007319 -13.985608 -676.263977 1 0 0 0 1 0 1 1
				CurrentRune:Set[2]
			}
			elseif ${Rune2Color.Equal[${Triad3Color}]}
			{
				call RIMObj.Move -53.491779 -13.994169 -601.748352 1 0 0 0 1 0 1 1
				CurrentRune:Set[3]
			}
			
			call RIMObj.Move ${String["${Actor[Query, Name=="Triad Rune Base ${CurrentRune}"].Loc}"].Replace[","," "]} 5 0 0 0 1 0 1 1
			wait 20
			while ${Actor[Query, Name=="Triad Rune Base ${CurrentRune}"].HighlightOnMouseHover}
				Actor[Query, Name=="Triad Rune Base ${CurrentRune}"]:DoubleClick
			
			if ${Rune3Color.Equal[${Triad1Color}]}
			{
				call RIMObj.Move 52.391975 -13.992254 -602.711731 1 0 0 0 1 0 1 1
				CurrentRune:Set[1]
			}
			elseif ${Rune3Color.Equal[${Triad2Color}]}
			{
				call RIMObj.Move -0.007319 -13.985608 -676.263977 1 0 0 0 1 0 1 1
				CurrentRune:Set[2]
			}
			elseif ${Rune3Color.Equal[${Triad3Color}]}
			{
				call RIMObj.Move -53.491779 -13.994169 -601.748352 1 0 0 0 1 0 1 1
				CurrentRune:Set[3]
			}
				
			call RIMObj.Move ${String["${Actor[Query, Name=="Triad Rune Base ${CurrentRune}"].Loc}"].Replace[","," "]} 5 0 0 0 1 0 1 1
			wait 20
			while ${Actor[Query, Name=="Triad Rune Base ${CurrentRune}"].HighlightOnMouseHover}
				Actor[Query, Name=="Triad Rune Base ${CurrentRune}"]:DoubleClick
			
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Amalgam].Loc},7,200]
			
			while ${Actor[Query, Name=-"Amalgam" && IsDead=FALSE](exists)}
			{
				if !${RI_Var_Bool_GlobalOthers}
					Actor[Query, Name=-"Amalgam" && IsDead=FALSE]:DoTarget
					
				wait 2
			}
			
			call RIMObj.Move ${String["${Actor[Query, Name=="Triad Rune Base ${CurrentRune}"].Loc}"].Replace[","," "]} 5 0 0 0 1 0 1 1
			
			if ${CurrentRune.Find[2](exists)}
				call RIMObj.Move 43.095505 -13.996938 -604.894897 1 0 0 0 1 0 1 1
			call RIMObj.Move 0.089615 -13.985756 -592.022827 1 0 0 0 1 0 1 1
		}
		else
			echo Amalgam Dead
	}
	else
	{
		while ${Actor[Query, Name=-"Amalgam" && IsDead=FALSE](exists)}
		{
			if !${RI_Var_Bool_GlobalOthers}
				Actor[Query, Name=-"Amalgam" && IsDead=FALSE]:DoTarget
				
			wait 2
		}
	}
	
	echo Ending Amalgam v1
}
function Kly()
{
	echo ISXRI: Starting Kly

	variable string EastColor=${Actor[Ritual Power Source Main 2].Overlay.Right[-14]}
	variable string WestColor=${Actor[Ritual Power Source Main 1].Overlay.Right[-14]}
	
	RIMUIObj:SetRIFollow[ALL,OFF]
	RIMUIObj:SetLockSpot[ALL,-0.000502,-163.572433,-505.355042]
	
	while ${Actor[Query, Name=-"Kly"](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			Actor[Kly]:DoTarget
		}
		if ${Me.Class.Equal[bard]} || ${Zone.Name.Find["[Solo]"](exists)}
		{
			if ${Actor[Ritual Power Source Main 2].Overlay.Right[-14].NotEqual[white]}
			{
				;green orange purple blue red yellow(gold)
				EastColor:Set[${Actor[Ritual Power Source Main 2].Overlay.Right[-14]}]
				WestColor:Set[${Actor[Ritual Power Source Main 1].Overlay.Right[-14]}]
				
				if ${EastColor.Find[gold](exists)}
					EastColor:Set[yellow]
				if ${WestColor.Find[gold](exists)}
					WestColor:Set[yellow]
					
				;west first
				call RIMObj.Move -0.153097 -163.779053 -526.361816 1 0 0 0 1 1 1 1
				call RIMObj.Move 58.701519 -163.776749 -532.941345 1 0 0 0 1 1 1 1
				call RIMObj.Move ${String["${Actor[Query, Name=="Power Switch - ${WestColor}"].Loc}"].Replace[","," "]} 7 0 0 0 1 0 1 1
				
				while ${Actor[Query, Name=="Power Switch - ${WestColor}"].HighlightOnMouseHover}
					Actor[Query, Name=="Power Switch - ${WestColor}"]:DoubleClick
				
				call RIMObj.Move 58.701519 -163.776749 -532.941345 1 0 0 0 1 1 1 1
				
				;now east
				call RIMObj.Move -0.153097 -163.779053 -526.361816 1 0 0 0 1 1 1 1
				call RIMObj.Move -58.938683 -163.777100 -532.165955 1 0 0 0 1 1 1 1
				call RIMObj.Move ${String["${Actor[Query, Name=="Power Switch - ${EastColor}"].Loc}"].Replace[","," "]} 7 0 0 0 1 0 1 1
				
				while ${Actor[Query, Name=="Power Switch - ${EastColor}"].HighlightOnMouseHover}
					Actor[Query, Name=="Power Switch - ${EastColor}"]:DoubleClick
				
				call RIMObj.Move -58.938683 -163.777100 -532.165955 1 0 0 0 1 1 1 1
				call RIMObj.Move -0.153097 -163.779053 -526.361816 1 0 0 0 1 1 1 1
				RIMUIObj:SetLockSpot[ALL,-0.000502,-163.572433,-505.355042]
			}
		}
	}
	echo ISXRI: Ending Kly
}

function Klyhud()
{

	
	squelch HUD -add east 500,400 East: ${Actor[Ritual Power Source Main 2].Overlay.Right[-14]}
	squelch HUD -add west 500,420 West: ${Actor[Ritual Power Source Main 1].Overlay.Right[-14]}
	
	while ${Zone.Name.Find["Crypt of Dalnir: Ritual Chamber"](exists)}
		wait 5
		
	squelch HUD -remove east
	squelch HUD -remove west
}
;;;;;;;;;;;;;;;; End Crypt of Dalnir: Ritual Chamber [Heroic] ;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;; Start Crypt of Dalnir: Baron's Workshop [Heroic] ;;;;;;;;;;;;;;;;;;;;;;
function Frenzied()
{
	echo ISXRI: Starting Frenzied 
	
	RI_Atom_SetLockSpot ${Me.Name} -600.047791 0.769289 -282.796021
	
	while ${Actor[Query, Name=-"Frenzied" && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[ravenous,radius,50](exists)}
			{
				if ${Target.ID}!=${Actor[ravenous,radius,50].ID}
					Actor[ravenous,radius,50]:DoTarget		
			}
			elseif ${Actor[devourer,radius,20](exists)}
			{
				if ${Target.ID}!=${Actor[devourer,radius,20].ID}
					Actor[devourer,radius,20]:DoTarget		
			}
			else
			{
				if ${Target.ID}!=${Actor[Query, Name=-"Frenzied" && IsDead=FALSE].ID}
					Actor[Query, Name=-"Frenzied" && IsDead=FALSE]:DoTarget
			}
		}
		wait 1
	}
	echo Ending Frenzied
}

variable index:string blamed
variable bool AlreadyAddedMe=FALSE
function Tootooz()
{
	variable int _TootoozID=${Actor[Query, Name=-"Tootooz" && IsDead=FALSE].ID}
	Event[EQ2_onAnnouncement]:AttachAtom[EQ2_onAnnouncementTootooz]
	RIMUIObj:SetLockSpot[ALL,-242.036407,26.464846,-0.067954]
	if ${RI_Var_Bool_GlobalOthers}
	{
		wait 50 !${Me.IsMoving}
		RIMUIObj:SetLockSpot[ALL,-232.236496,26.495329,11.387039]
		;RIMUIObj:SetLockSpot[OFF]
		;RIMUIObj:SetRIFollow[OFF]
		;RI_Atom_MoveBehind ALL ${_TootoozID} 15 99 ${Me.Name}
	}
	else
		Actor[id,${_TootoozID}]:DoTarget
		
	while ${Actor[Query, Name=-"Tootooz" && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${_TootoozID}
				Actor[id,${_TootoozID}]:DoTarget
		}
		wait 1
	}
}
;atom triggered when an announcement is detected
atom EQ2_onAnnouncementTootooz(string Message, string SoundType, float Timer)
{
	;if ${RI_Var_Bool_Debug}
	;	echo ${Time}:AnnounceText: ${Message}
	;if ${AnnounceText} exists in the announce, execute
	if ${Message.Find["Tootooz thinks"](exists)}
	{
		variable string Temp
		variable bool alreadyinindex
		alreadyinindex:Set[FALSE]
		Temp:Set[${Message.Right[-15]}]
		Temp:Set[${Temp.Left[-16]}]
		if ${Message.Find["You"](exists)} && !${AlreadyAddedMe}
		{
			blamed:Insert[${Me.Name}]
			AlreadyAddedMe:Set[TRUE]
		}	
		else
		{
			;check if they are in the index
			variable int count
			for(count:Set[1];${count}<=${blamed.Used};count:Inc)
			{
				;echo checking ${blamed.Get[${count}]} against ${Temp}
				if ${blamed.Get[${count}].Equal[${Temp}]}
					alreadyinindex:Set[TRUE]
			}
			if !${alreadyinindex}
			{
				;echo adding ${Temp} to index
				blamed:Insert[${Temp}]
			}
		}		
	}
	if ${Message.Find["point at someone else to blame"](exists)}
	{
		;check if group 1 is in the index and so on and so forth
		variable int gcount
		variable bool gtg
		gtg:Set[FALSE]
		gcount:Set[1]
		while ${gcount}<=5 && !${gtg}
		{
			variable int count2
			for(count2:Set[1];${count2}<=${blamed.Used};count2:Inc)
			{
				;echo 2: checking ${blamed.Get[${count2}]} against ${Me.Group[${gcount}]}
				if ${blamed.Get[${count2}].Equal[${Me.Group[${gcount}]}]}
				{
					gtg:Set[TRUE]
					continue
				}
			}
			gcount:Inc
		}
		;turn off assisting
		RI_CMD_Assisting 0
		
		;pause bots
		RI_CMD_PauseCombatBots 1
		
		;target
		TimedCommand 3 Target ${Me.Group[${gcount}]}
		;wait 2
		TimedCommand 6 eq2ex point
		;wait 1
				
		;unpause bots
		TimedCommand 10 RI_CMD_PauseCombatBots 0
		
		;turn on assisting
		TimedCommand 10 RI_CMD_Assisting 1
	}
}
function Googantuan()
{
	variable int _GoogantuanID=${Actor[Query, && Name=-"Googantuan" && IsDead=FALSE].ID}
	variable bool _GotValves=FALSE
	RIMUIObj:SetLockSpot[OFF]
	echo ISXRI: Starting Googantuan 
	relay "other ${RI_Var_String_RelayGroup}" -noredirect RIMUIObj:SetRIFollow[ALL,${Me.Name},1,100]
	call RIMObj.Move -423.743500 1.228983 -195.665985 1 0 0 0 1 0 1 1
	RI_CMD_PauseCombatBots 1
	while ${Actor[Query, Name=-"Valve" && Distance<=5].HighlightOnMouseHover}
	{
		Actor[Query, Name=-"Valve" && Distance<=5]:DoubleClick
		wait 2
	}
	RI_CMD_PauseCombatBots 0
	wait 20
	_GoogantuanID:Set[${Actor[Query, && Name=-"Googantuan" && IsDead=FALSE].ID}]
	while ${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if !${_GotValves} && !${Zone.Name.Find["[Solo]"](exists)}
			{
				relay "other ${RI_Var_String_RelayGroup}" -noredirect RIMUIObj:SetRIFollow[ALL,${Me.Name},1,100]
				RIMUIObj:SetLockSpot[OFF]
				RIMUIObj:SetRIFollow[OFF]
				call RIMObj.Move -423.743500 1.228983 -195.665985 1 0 0 0 1 0 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				RI_CMD_PauseCombatBots 1
				while ${Actor[Query, Name=-"Valve" && Distance<=5].HighlightOnMouseHover}
				{
					Actor[Query, Name=-"Valve" && Distance<=5]:DoubleClick
					wait 2
				}
				RI_CMD_PauseCombatBots 0
				wait 20
				Press f8
				call RIMObj.Move -422.953339 1.228984 -183.556915 1 0 0 0 1 0 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				RI_CMD_PauseCombatBots 1
				while ${Actor[Query, Name=-"Valve" && Distance<=5].HighlightOnMouseHover}
				{
					Actor[Query, Name=-"Valve" && Distance<=5]:DoubleClick
					wait 2
				}
				RI_CMD_PauseCombatBots 0
				wait 20
				Press f8
				call RIMObj.Move -412.846069 1.229390 -183.372772 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -402.701874 1.229717 -183.358627 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -393.441742 1.229717 -183.718185 1 0 0 0 1 0 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				RI_CMD_PauseCombatBots 1
				while ${Actor[Query, Name=-"Valve" && Distance<=5].HighlightOnMouseHover}
				{
					Actor[Query, Name=-"Valve" && Distance<=5]:DoubleClick
					wait 2
				}
				RI_CMD_PauseCombatBots 0
				wait 20
				Press f8
				call RIMObj.Move -393.496704 1.229717 -193.839325 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -393.629456 1.229717 -196.658813 1 0 0 0 1 0 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				RI_CMD_PauseCombatBots 1
				while ${Actor[Query, Name=-"Valve" && Distance<=5].HighlightOnMouseHover}
				{
					Actor[Query, Name=-"Valve" && Distance<=5]:DoubleClick
					wait 2
				}
				RI_CMD_PauseCombatBots 0
				wait 20
				Press f8
				call RIMObj.Move -383.286285 1.229717 -196.326172 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -373.043243 1.229717 -196.168442 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -362.852203 1.229717 -196.050262 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -352.644623 1.229811 -196.082504 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -342.643768 1.230334 -196.139282 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -340.355316 1.230443 -196.459000 1 0 0 0 1 0 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				RI_CMD_PauseCombatBots 1
				while ${Actor[Query, Name=-"Valve" && Distance<=5].HighlightOnMouseHover}
				{
					Actor[Query, Name=-"Valve" && Distance<=5]:DoubleClick
					wait 2
				}
				RI_CMD_PauseCombatBots 0
				wait 20
				Press f8
				call RIMObj.Move -340.457672 1.230448 -186.440872 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -340.345917 1.230441 -183.257614 1 0 0 0 1 0 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				RI_CMD_PauseCombatBots 1
				while ${Actor[Query, Name=-"Valve" && Distance<=5].HighlightOnMouseHover}
				{
					Actor[Query, Name=-"Valve" && Distance<=5]:DoubleClick
					wait 2
				}
				RI_CMD_PauseCombatBots 0
				wait 20
				Press f8
				call RIMObj.Move -330.252472 1.229717 -181.858521 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -320.326233 1.230079 -178.762466 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -312.260742 1.229631 -172.687546 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -305.106598 1.229717 -165.296753 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -298.174286 1.229716 -158.044174 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -291.125854 1.229717 -150.815231 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -284.169891 1.229714 -142.937469 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -283.301636 1.229610 -142.100891 1 0 0 0 1 0 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				RI_CMD_PauseCombatBots 1
				while ${Actor[Query, Name=-"Valve" && Distance<=5].HighlightOnMouseHover}
				{
					Actor[Query, Name=-"Valve" && Distance<=5]:DoubleClick
					wait 2
				}
				RI_CMD_PauseCombatBots 0
				wait 20
				Press f8
				call RIMObj.Move -283.668152 1.229717 -152.392914 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -284.025452 1.229716 -162.424133 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -284.384338 1.229716 -172.498154 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -284.744293 1.229653 -182.604156 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -285.033722 1.229619 -192.696228 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -285.053345 1.229618 -202.712906 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -284.992554 1.229716 -212.761093 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -284.597961 1.229716 -223.072601 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -284.006287 1.229717 -233.119827 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -283.861542 1.229676 -239.032883 1 0 0 0 1 0 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				RI_CMD_PauseCombatBots 1
				while ${Actor[Query, Name=-"Valve" && Distance<=5].HighlightOnMouseHover}
				{
					Actor[Query, Name=-"Valve" && Distance<=5]:DoubleClick
					wait 2
				}
				RI_CMD_PauseCombatBots 0
				wait 20
				Press f8
				call RIMObj.Move -277.544037 1.229716 -231.255127 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -271.144104 1.229716 -223.462326 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -264.372650 1.229717 -215.803024 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -257.164825 1.229537 -208.509537 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -249.776520 1.229981 -201.606079 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -242.232407 1.229745 -194.968262 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -234.805359 1.229717 -188.271347 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -229.634811 1.230220 -184.578461 1 0 0 0 1 0 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				RI_CMD_PauseCombatBots 1
				while ${Actor[Query, Name=-"Valve" && Distance<=5].HighlightOnMouseHover}
				{
					Actor[Query, Name=-"Valve" && Distance<=5]:DoubleClick
					wait 2
				}
				RI_CMD_PauseCombatBots 0
				wait 20
				Press f8
				call RIMObj.Move -230.145538 1.230185 -194.872375 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -230.248947 1.227926 -195.544739 1 0 0 0 1 0 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				RI_CMD_PauseCombatBots 1
				while ${Actor[Query, Name=-"Valve" && Distance<=5].HighlightOnMouseHover}
				{
					Actor[Query, Name=-"Valve" && Distance<=5]:DoubleClick
					wait 2
				}
				RI_CMD_PauseCombatBots 0
				wait 20
				Press f8
				call RIMObj.Move -222.110184 1.229717 -189.563309 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -214.028488 1.229863 -183.348450 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -206.193359 1.229835 -176.710144 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -198.886627 1.229429 -169.628479 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -191.817810 1.229716 -162.531219 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -184.499435 1.229716 -154.966736 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -177.612579 1.229716 -147.453629 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -171.501846 1.229422 -141.083725 1 0 0 0 1 0 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				RI_CMD_PauseCombatBots 1
				while ${Actor[Query, Name=-"Valve" && Distance<=5].HighlightOnMouseHover}
				{
					Actor[Query, Name=-"Valve" && Distance<=5]:DoubleClick
					wait 2
				}
				RI_CMD_PauseCombatBots 0
				wait 20
				Press f8
				call RIMObj.Move -172.856415 1.229717 -151.151566 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -173.393265 1.229716 -161.381409 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -173.795288 1.229716 -171.374298 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -174.084488 1.229714 -181.512985 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -174.033096 1.229709 -191.720596 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -174.132584 1.229714 -201.816315 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -174.236847 1.229716 -211.943909 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -174.294785 1.229716 -222.183289 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -174.352386 1.229718 -232.359070 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -174.334351 1.229690 -239.372330 1 0 0 0 1 0 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				RI_CMD_PauseCombatBots 1
				while ${Actor[Query, Name=-"Valve" && Distance<=5].HighlightOnMouseHover}
				{
					Actor[Query, Name=-"Valve" && Distance<=5]:DoubleClick
					wait 2
				}
				RI_CMD_PauseCombatBots 0
				wait 20
				Press f8
				call RIMObj.Move -168.503983 1.229716 -231.012238 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -162.210754 1.229716 -223.200546 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -155.094604 1.229717 -216.151230 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -147.439682 1.229513 -209.648254 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -139.590363 1.229989 -203.373978 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -131.658188 1.229718 -197.284454 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -123.560265 1.229717 -191.307831 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -115.542801 1.229717 -185.241348 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -114.752487 1.229717 -184.764374 1 0 0 0 1 0 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				RI_CMD_PauseCombatBots 1
				while ${Actor[Query, Name=-"Valve" && Distance<=5].HighlightOnMouseHover}
				{
					Actor[Query, Name=-"Valve" && Distance<=5]:DoubleClick
					wait 2
				}
				RI_CMD_PauseCombatBots 0
				wait 20
				Press f8
				call RIMObj.Move -114.885887 1.229717 -194.986008 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -114.891426 1.229717 -195.405701 1 0 0 0 1 0 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				RI_CMD_PauseCombatBots 1
				while ${Actor[Query, Name=-"Valve" && Distance<=5].HighlightOnMouseHover}
				{
					Actor[Query, Name=-"Valve" && Distance<=5]:DoubleClick
					wait 2
				}
				RI_CMD_PauseCombatBots 0
				wait 20
				Press f8
				call RIMObj.Move -124.886337 1.229717 -193.252991 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -134.834396 1.229899 -191.915985 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -144.994232 1.229716 -190.776840 1 0 0 0 1 1 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				call RIMObj.Move -151.129150 1.229716 -190.127319 1 0 0 0 1 0 1 1
				if !${Actor[Query, Name=-"Googantuan" && IsDead=FALSE](exists)}
					return
				_GotValves:Set[TRUE]
				RIMUIObj:SetLockSpot[ALL,-151.129150,1.229716,-190.127319]
				relay "other ${RI_Var_String_RelayGroup}" -noredirect RI_Atom_MoveBehind ALL ${_GoogantuanID} 30 100 ${Me.Name}
				
			}
			; if ${Actor[Query, Name=-"" && Distance<=15](exists)}
			; {
				; if ${Target.ID}!=${Actor[Query, Name=-"" && Distance<=15].ID}
					; Actor[Query, Name=-"" && Distance<=15]:DoTarget
			; }
			; else 
			; {
			_GoogantuanID:Set[${Actor[Query, && Name=-"Googantuan" && IsDead=FALSE].ID}]
			if ${Target.ID}!=${_GoogantuanID} && ${_GoogantuanID}!=0
				Actor[id,${_GoogantuanID}]:DoTarget
			; }
		}
		wait 5
	}
	echo Ending Googantuan
}
function BaronHuntForKey()
{
	if ${Zone.Name.Find["[Solo]"](exists)}
	{
		call RIMObj.Move -409.615448 1.229717 -195.947357 1 0 0 0 1 1 1 1
		call RIMObj.Move -386.737213 1.229717 -190.916397 1 0 0 0 1 1 1 1
		call RIMObj.Move -348.310181 1.230038 -188.412079 1 0 0 0 1 1 1 1
		call RIMObj.Move -320.265015 1.230082 -182.446259 1 0 0 0 1 1 1 1
		call RIMObj.Move -297.468872 1.229716 -152.824005 1 0 0 0 1 0 1 1
		wait 20
		call UseItem slimeskin
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call UseItem slimeskin"]
		wait 20
		call RIMObj.Move -301.104828 2.097103 -143.956879 1 0 0 0 1 1 1 1
		call RIMObj.Move -306.350800 -4.749633 -128.618073 1 0 0 0 1 1 1 1
		call RIMObj.Move -307.698425 -4.572316 -130.183746 1 0 0 0 1 0 1 1
		wait 20
		relay ${RI_Var_String_RelayGroup} Actor[special]:DoubleClick
		wait 2
		relay ${RI_Var_String_RelayGroup} Actor[special]:DoubleClick
		wait 2
		relay ${RI_Var_String_RelayGroup} Actor[special]:DoubleClick
		wait 20
		call RIMObj.Move -300.445709 -4.521551 -129.519836 1 0 0 0 1 1 1 1
		call RIMObj.Move -279.833649 -4.577335 -133.163544 1 0 0 0 1 1 1 1
		call RIMObj.Move -260.664642 -4.458849 -136.322083 1 0 0 0 1 1 1 1
		call RIMObj.Move -247.069443 -4.473476 -165.692169 1 0 0 0 1 1 1 1
		call RIMObj.Move -229.735809 -4.537671 -169.130798 1 0 0 0 1 1 1 1
		call RIMObj.Move -229.363480 -0.599283 -173.984924 1 0 0 0 1 1 1 1
		call RIMObj.Move -229.098022 2.096683 -179.941284 1 0 0 0 1 1 1 1
		call RIMObj.Move -207.819443 1.229930 -191.406036 1 0 0 0 1 1 1 1
		call RIMObj.Move -173.949326 1.229701 -190.505600 1 0 0 0 1 1 1 1
		call RIMObj.Move -152.905701 1.229716 -190.025620 1 0 0 0 1 1 1 1
	}
	else
	{
		Actor["Key Spotlight"]:WaypointTo
		call MessageBox "Go find the key, hit resume once done near the foremans door"
	}
}
function Baron()
{
	StopForCombat:Set[0]
	echo ISXRI: Starting Baron
	variable int _BaronID=${Actor[Query, Name=="Haggle Baron Dalnir" && IsDead=FALSE].ID}
	if ${Zone.Name.Find["[Solo]"](exists)}
	{
		if ${QuestJournalWindow.ActiveQuest[Kunark Ascending: A Chosen Weapon](exists)}
		{
			CustomLoc:Set[0 0 0]
			call HailActor Baron 2
			wait 100
			call HailActor Baron 8
			wait 50
			_BaronID:Set[${Actor[Query, Name=="Haggle Baron Dalnir" && IsDead=FALSE].ID}]
			while ${Actor[Query, Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_BaronID}
					Actor[id,${_BaronID}]:DoTarget
				wait 5
			}
			;gograb resources and craft
			call RIMObj.Move -229.486160 26.307547 -488.759766 1 0 0 0 1 1 1 1
			call RIMObj.Move -229.028534 26.950857 -464.146454 1 0 0 0 1 1 1 1
			call RIMObj.Move -258.085724 27.090219 -448.304535 1 0 0 0 1 0 1 1
			wait 20
			call ClickActor "Forge Door 2 - Right"
			wait 20
			call RIMObj.Move -280.575745 26.937538 -441.575165 1 0 0 0 1 0 1 1
			wait 20
			call ClickActor "Dalnir's work chest"
			wait 20
			call ScribeBook "Greenmist Design Pattern"
			relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call ScribeBook \"Greenmist Design Pattern\""]
			wait 20
			call RIMObj.Move -281.516937 26.942476 -462.364258 1 0 0 0 1 0 1 1
			wait 20
			call MoveToActor "khukri blade mold" 10 1
			wait 20
			call ClickActor "khukri blade mold"
			wait 20
			call RIMObj.Move -280.575745 26.937538 -441.575165 1 0 0 0 1 1 1 1
			call RIMObj.Move -229.607101 26.950447 -458.346405 1 0 0 0 1 1 1 1
			call RIMObj.Move -197.857803 27.122066 -449.059906 1 0 0 0 1 1 1 1
			call RIMObj.Move -168.722046 26.945513 -444.427368 1 0 0 0 1 0 1 1
			wait 20
			call ClickActor "Coal Bin 1"
			wait 20
			call RIMObj.Move -168.736649 26.948915 -455.388245 1 0 0 0 1 0 1 1
			wait 20
			call MoveToActor "imbued tynnonium" 8 1
			wait 20
			call ClickActor "imbued tynnonium"
			wait 20
			call RIMObj.Move -168.736649 26.948915 -455.388245 1 0 0 0 1 0 1 1
			wait 20
			call MoveToActor "imbued tynnonium" 8 1
			wait 20
			call ClickActor "imbued tynnonium"
			wait 20
			call RIMObj.Move -168.736649 26.948915 -455.388245 1 0 0 0 1 0 1 1
			wait 20
			call MoveToActor "imbued tynnonium" 8 1
			wait 20
			call ClickActor "imbued tynnonium"
			wait 20
			call RIMObj.Move -168.736649 26.948915 -455.388245 1 0 0 0 1 0 1 1
			wait 20
			call MoveToActor "fear-soaked leather" 8 1
			wait 20
			call ClickActor "fear-soaked leather"
			wait 20
			call RIMObj.Move -168.736649 26.948915 -455.388245 1 0 0 0 1 1 1 1
			call RIMObj.Move -183.176331 26.950291 -448.932922 1 0 0 0 1 1 1 1
			call RIMObj.Move -217.260590 26.941422 -453.835602 1 0 0 0 1 1 1 1
			call RIMObj.Move -227.800613 26.911406 -473.455170 1 0 0 0 1 1 1 1
			call RIMObj.Move -226.124969 25.181273 -503.485443 1 0 0 0 1 1 1 1
			call RIMObj.Move -221.105560 25.181273 -525.897339 1 0 0 0 1 1 1 1
			call RIMObj.Move -215.866608 25.181273 -526.432373 1 0 0 0 1 0 1 1
			wait 20
			call CraftIt "Greenmist Design Pattern"
			relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call CraftIt \"Greenmist Design Pattern\""]
			wait 50
			call RIMObj.Move -229.251068 25.181273 -525.721619 1 0 0 0 1 0 1 1
		}
		else 
		{
			call HailActor Baron 2 1 1 0
			wait 50
			_BaronID:Set[${Actor[Query, Name=="Haggle Baron Dalnir" && IsDead=FALSE].ID}]
			while ${Actor[Query, Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_BaronID}
					Actor[id,${_BaronID}]:DoTarget
				wait 5
			}
		}
	}
	else
	{
		;if !${RI_Var_Bool_GlobalOthers}
		;echo test 1
		call HailActor Baron 2 1 1 0
				;echo test 2
	;	RIMUIObj:LootOptions[ALL,FFA]
		variable bool SettingsAssistingCheckBox=${RI_Obj_CB.GetUISetting[SettingsAssistingCheckBox]}
;echo test 3
		RIMUIObj:SetLockSpot[ALL,-229.639999,25.181273,-521.262268]
		
		RI_Var_Bool_SkipLoot:Set[TRUE]
		RIMUIObj:SetRIFollow[OFF]
		wait 50
		;echo test 4
		_BaronID:Set[${Actor[Query, Name=="Haggle Baron Dalnir" && IsDead=FALSE].ID}]
		while ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
		{
			if !${RI_Var_Bool_GlobalOthers}
			{
				if ${Actor[Query, Name=="an extrusive rock golem" && IsDead=FALSE](exists)}
				{
					if ${Target.ID}!=${Actor[Query, Name=="an extrusive rock golem" && IsDead=FALSE].ID}
						Actor[Query, Name=="an extrusive rock golem" && IsDead=FALSE]:DoTarget
				}
				else 
				{
					if ${Target.ID}!=${_BaronID}
						Actor[id,${_BaronID}]:DoTarget
				}
			}
			;if we are a bard, do crafting stuffs
			if ${Me.Class.Equal[bard]} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
			{
				;echo check the levers
				if ${Actor[Query, Name=-"Broken Forge Lever 1"].HighlightOnMouseHover}
				{
					RI_Obj_CB:SetUISetting[SettingsCastAbilitiesCheckBox,FALSE]
					if ${SettingsAssistingCheckBox}
						RI_Obj_CB:SetUISetting[SettingsAssistingCheckBox,FALSE]
					RIMUIObj:SetLockSpot[OFF]
					Actor[${Me.ID}]:DoTarget
					eq2ex cancel_spellcast
								
					;move to resources
					wait 2 !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					if !${Me.Maintained[Sprint](exists)}
						Me.Ability[Sprint]:Use
					call RIMObj.Move -229.254974 26.960962 -472.571930 1 0 0 1 1 1 1 1
					call RIMObj.Move -207.236526 26.942169 -451.216156 1 0 0 1 1 1 1 1
					call RIMObj.Move -191.574722 26.950871 -448.685089 1 0 0 1 1 0 1 1
					RIMUIObj:SetLockSpot[${Me.Name},-157.140182,26.946106,-446.409851]
					while ${Actor[Query, Name=="Coal Bin 1"].HighlightOnMouseHover} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					{
						Actor[Query, Name=="Coal Bin 1"]:DoubleClick
						wait 2
					}
					while ${Actor[Query, Name=="pail of water"].HighlightOnMouseHover} && !${Me.Inventory[a pail of water](exists)} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					{
						Actor[Query, Name=="pail of water"]:DoubleClick
						wait 5
					}
					RIMUIObj:SetLockSpot[OFF]
					call RIMObj.Move -191.574722 26.950871 -448.685089 1 0 0 1 1 1 1 1
					call RIMObj.Move -207.236526 26.942169 -451.216156 1 0 0 1 1 1 1 1
					call RIMObj.Move -229.254974 26.960962 -472.571930 1 0 0 1 1 1 1 1
					call RIMObj.Move -229.254974 26.960962 -472.571930 1 0 0 1 1 1 1 1
					call RIMObj.Move -229.639999 25.181273 -521.262268 1 0 0 0 1 1 1 1
					
					RI_Obj_CB:SetUISetting[SettingsCastAbilitiesCheckBox,TRUE]
					if ${SettingsAssistingCheckBox}
						RI_Obj_CB:SetUISetting[SettingsAssistingCheckBox,TRUE]
					call RIMObj.Move -229.639999 25.181273 -521.262268 1 0 0 0 1 0 1 1
					while !${Me.Inventory[Query, Name=="molten Obulus ore"](exists)} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					{
						if ${LootWindow(exists)}
							LootWindow:RequestAll
						if ${Actor[Query, Name=="an extrusive rock golem" && IsDead=TRUE](exists)}
							Actor[Query, Name=="an extrusive rock golem" && IsDead=TRUE]:DoubleClick
						wait 2
						;echo waiting for dead golem
					}
					RI_Obj_CB:SetUISetting[SettingsCastAbilitiesCheckBox,FALSE]
					if ${SettingsAssistingCheckBox}
						RI_Obj_CB:SetUISetting[SettingsAssistingCheckBox,FALSE]
					Actor[${Me.ID}]:DoTarget
					eq2ex cancel_spellcast
					call RIMObj.Move -215.293152 25.181273 -526.250610 2 0 0 0 1 0 1 1
					wait 10
					while ${Actor[Query, Name=-"Broken Forge Lever 1"].HighlightOnMouseHover} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					{
						Actor[Query, Name=-"Broken Forge Lever 1"]:DoubleClick
						wait 5
						;echo clicking lever
					}
					wait 5 ${Me.CastingSpell} || !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					wait 50 !${Me.CastingSpell} || !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
				
					if ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
						Actor[Query, Name=="Dalnir's Forge" && Distance<=15]:DoTarget
					;wait 5
					if ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
						call CraftIt "Repair Forge Maw Control Lever"
					
					wait 5
					
					while ${Actor[Query, Name=="Forge Lever Base 1"].HighlightOnMouseHover} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					{
						Actor[Query, Name=="Forge Lever Base 1"]:DoubleClick
						wait 2
					}
					wait 5 ${Me.CastingSpell} || !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					wait 50 !${Me.CastingSpell} || !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					while ${Actor[Query, Name=="Forge Lever 1"].HighlightOnMouseHover} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					{
						Actor[Query, Name=="Forge Lever 1"]:DoubleClick
						wait 2
					}
					wait 5 ${Me.CastingSpell} || !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					wait 50 !${Me.CastingSpell} || !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					
					call RIMObj.Move -229.639999 25.181273 -521.262268 1 0 0 0 1 0 1 1
					RIMUIObj:SetLockSpot[ALL,-229.639999,25.181273,-521.262268]
									
					RI_Obj_CB:SetUISetting[SettingsCastAbilitiesCheckBox,TRUE]
					if ${SettingsAssistingCheckBox}
						RI_Obj_CB:SetUISetting[SettingsAssistingCheckBox,TRUE]

				}
				;call RIMObj.Move -220.733398 25.181273 -555.388245 1 0 0 0 1 0 1 1
				elseif ${Actor[Query, Name=-"Broken Forge Lever 2"].HighlightOnMouseHover}
				{
					RI_Obj_CB:SetUISetting[SettingsCastAbilitiesCheckBox,FALSE]
					if ${SettingsAssistingCheckBox}
						RI_Obj_CB:SetUISetting[SettingsAssistingCheckBox,FALSE]
					RIMUIObj:SetLockSpot[OFF]
					Actor[${Me.ID}]:DoTarget
					eq2ex cancel_spellcast
									
					;move to resources
					wait 2 !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					if !${Me.Maintained[Sprint](exists)}
						Me.Ability[Sprint]:Use
					call RIMObj.Move -229.254974 26.960962 -472.571930 1 0 0 1 1 1 1 1
					call RIMObj.Move -207.236526 26.942169 -451.216156 1 0 0 1 1 1 1 1
					call RIMObj.Move -191.574722 26.950871 -448.685089 1 0 0 1 1 0 1 1
					RIMUIObj:SetLockSpot[${Me.Name},-157.140182,26.946106,-446.409851]
					while ${Actor[Query, Name=="Coal Bin 1"].HighlightOnMouseHover} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					{
						Actor[Query, Name=="Coal Bin 1"]:DoubleClick
						wait 2
					}
					while ${Actor[Query, Name=="pail of water"].HighlightOnMouseHover} && !${Me.Inventory[a pail of water](exists)} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					{
						Actor[Query, Name=="pail of water"]:DoubleClick
						wait 5
					}
					RIMUIObj:SetLockSpot[OFF]
					call RIMObj.Move -191.574722 26.950871 -448.685089 1 0 0 1 1 1 1 1
					call RIMObj.Move -207.236526 26.942169 -451.216156 1 0 0 1 1 1 1 1
					call RIMObj.Move -229.254974 26.960962 -472.571930 1 0 0 1 1 1 1 1
					call RIMObj.Move -229.254974 26.960962 -472.571930 1 0 0 1 1 1 1 1
					call RIMObj.Move -229.639999 25.181273 -521.262268 1 0 0 0 1 1 1 1
					
					RI_Obj_CB:SetUISetting[SettingsCastAbilitiesCheckBox,TRUE]
					if ${SettingsAssistingCheckBox}
						RI_Obj_CB:SetUISetting[SettingsAssistingCheckBox,TRUE]
					call RIMObj.Move -229.639999 25.181273 -521.262268 1 0 0 0 1 0 1 1
					while !${Me.Inventory[Query, Name=="molten Obulus ore"](exists)} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					{
						if ${Actor[Query, Name=="an extrusive rock golem" && IsDead=TRUE](exists)}
							Actor[Query, Name=="an extrusive rock golem" && IsDead=TRUE]:DoubleClick
						wait 2
						;echo waiting for dead golem
					}
					RI_Obj_CB:SetUISetting[SettingsCastAbilitiesCheckBox,FALSE]
					if ${SettingsAssistingCheckBox}
						RI_Obj_CB:SetUISetting[SettingsAssistingCheckBox,FALSE]
					Actor[${Me.ID}]:DoTarget
					eq2ex cancel_spellcast
					call RIMObj.Move -220.733398 25.181273 -555.388245 1 0 0 0 1 0 1 1
					wait 10
					while ${Actor[Query, Name=-"Broken Forge Lever 2"].HighlightOnMouseHover} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					{
						Actor[Query, Name=-"Broken Forge Lever 2"]:DoubleClick
						wait 5
						;echo clicking lever
					}
					wait 5 ${Me.CastingSpell} || !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					wait 50 !${Me.CastingSpell} || !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}

					if ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
						Actor[Query, Name=="Dalnir's Forge" && Distance<=15]:DoTarget
					;wait 5
					if ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
						call CraftIt "Repair Forge Maw Control Lever"
					
					wait 5
					
					while ${Actor[Query, Name=="Forge Lever Base 2"].HighlightOnMouseHover} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					{
						Actor[Query, Name=="Forge Lever Base 2"]:DoubleClick
						wait 2
					}
					wait 5 ${Me.CastingSpell} || !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					wait 50 !${Me.CastingSpell} || !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					while ${Actor[Query, Name=="Forge Lever 2"].HighlightOnMouseHover} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					{
						Actor[Query, Name=="Forge Lever 2"]:DoubleClick
						wait 2
					}
					wait 5 ${Me.CastingSpell} || !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					wait 50 !${Me.CastingSpell} || !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					
					call RIMObj.Move -229.639999 25.181273 -521.262268 1 0 0 0 1 0 1 1
					RIMUIObj:SetLockSpot[ALL,-229.639999,25.181273,-521.262268]
									
					RI_Obj_CB:SetUISetting[SettingsCastAbilitiesCheckBox,TRUE]
					if ${SettingsAssistingCheckBox}
						RI_Obj_CB:SetUISetting[SettingsAssistingCheckBox,TRUE]
				}
				;call RIMObj.Move -243.049377 25.181273 -526.469727 2 0 0 0 1 0 1 1
				elseif ${Actor[Query, Name=-"Broken Forge Lever 3"].HighlightOnMouseHover}
				{
					RI_Obj_CB:SetUISetting[SettingsCastAbilitiesCheckBox,FALSE]
					if ${SettingsAssistingCheckBox}
						RI_Obj_CB:SetUISetting[SettingsAssistingCheckBox,FALSE]
					RIMUIObj:SetLockSpot[OFF]
					Actor[${Me.ID}]:DoTarget
					eq2ex cancel_spellcast
					
					;move to resources
					wait 2 !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					if !${Me.Maintained[Sprint](exists)}
						Me.Ability[Sprint]:Use
					call RIMObj.Move -229.254974 26.960962 -472.571930 1 0 0 1 1 1 1 1
					call RIMObj.Move -207.236526 26.942169 -451.216156 1 0 0 1 1 1 1 1
					call RIMObj.Move -191.574722 26.950871 -448.685089 1 0 0 1 1 0 1 1
					RIMUIObj:SetLockSpot[${Me.Name},-157.140182,26.946106,-446.409851]
									while ${Actor[Query, Name=="Coal Bin 1"].HighlightOnMouseHover} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					{
						Actor[Query, Name=="Coal Bin 1"]:DoubleClick
						wait 2
					}
					while ${Actor[Query, Name=="pail of water"].HighlightOnMouseHover} && !${Me.Inventory[a pail of water](exists)} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					{
						Actor[Query, Name=="pail of water"]:DoubleClick
						wait 5
					}
					RIMUIObj:SetLockSpot[OFF]
					call RIMObj.Move -191.574722 26.950871 -448.685089 1 0 0 1 1 1 1 1
					call RIMObj.Move -207.236526 26.942169 -451.216156 1 0 0 1 1 1 1 1
					call RIMObj.Move -229.254974 26.960962 -472.571930 1 0 0 1 1 1 1 1
					call RIMObj.Move -229.254974 26.960962 -472.571930 1 0 0 1 1 1 1 1
					call RIMObj.Move -229.639999 25.181273 -521.262268 1 0 0 0 1 1 1 1
					
					RI_Obj_CB:SetUISetting[SettingsCastAbilitiesCheckBox,TRUE]
					if ${SettingsAssistingCheckBox}
						RI_Obj_CB:SetUISetting[SettingsAssistingCheckBox,TRUE]
					call RIMObj.Move -229.639999 25.181273 -521.262268 1 0 0 0 1 0 1 1
					while !${Me.Inventory[Query, Name=="molten Obulus ore"](exists)} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					{
						if ${Actor[Query, Name=="an extrusive rock golem" && IsDead=TRUE](exists)}
							Actor[Query, Name=="an extrusive rock golem" && IsDead=TRUE]:DoubleClick
						wait 2
						;echo waiting for dead golem
					}
					RI_Obj_CB:SetUISetting[SettingsCastAbilitiesCheckBox,FALSE]
					if ${SettingsAssistingCheckBox}
						RI_Obj_CB:SetUISetting[SettingsAssistingCheckBox,FALSE]
					Actor[${Me.ID}]:DoTarget
					eq2ex cancel_spellcast
					call RIMObj.Move -243.049377 25.181273 -526.469727 2 0 0 0 1 0 1 1
					wait 10
					while ${Actor[Query, Name=-"Broken Forge Lever 3"].HighlightOnMouseHover} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					{
						Actor[Query, Name=-"Broken Forge Lever 3"]:DoubleClick
						wait 5
						;echo clicking lever
					}
					wait 5 ${Me.CastingSpell} || !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					wait 50 !${Me.CastingSpell} || !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					
					if ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
						Actor[Query, Name=="Dalnir's Forge" && Distance<=15]:DoTarget
					;wait 5
					if ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
						call CraftIt "Repair Forge Maw Control Lever"
					
					wait 5
					
					while ${Actor[Query, Name=="Forge Lever Base 3"].HighlightOnMouseHover} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					{
						Actor[Query, Name=="Forge Lever Base 3"]:DoubleClick
						wait 2
					}
					wait 5 ${Me.CastingSpell} || !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					wait 50 !${Me.CastingSpell} || !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					while ${Actor[Query, Name=="Forge Lever 3"].HighlightOnMouseHover} && ${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					{
						Actor[Query, Name=="Forge Lever 3"]:DoubleClick
						wait 2
					}
					wait 5 ${Me.CastingSpell} || !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					wait 50 !${Me.CastingSpell} || !${Actor[Query, Type=="NamedNPC" && Name=="Haggle Baron Dalnir" && IsDead=FALSE](exists)}
					
					call RIMObj.Move -229.639999 25.181273 -521.262268 1 0 0 0 1 0 1 1
					RIMUIObj:SetLockSpot[ALL,-229.639999,25.181273,-521.262268]
									
					RI_Obj_CB:SetUISetting[SettingsCastAbilitiesCheckBox,TRUE]
					if ${SettingsAssistingCheckBox}
						RI_Obj_CB:SetUISetting[SettingsAssistingCheckBox,TRUE]
				}
			}
			wait 1
		}
		RIMUIObj:LootOptions[ALL,RR]
		RI_Var_Bool_SkipLoot:Set[FALSE]
	}
	echo Ending Baron
	StopForCombat:Set[1]
}
function Enchanted()
{
	variable int _ShieldID=${Actor[Query, Name=="Enchanted Shield" && IsDead=FALSE].ID}
	variable int _SwordID=${Actor[Query, Name=="Enchanted Sword" && IsDead=FALSE].ID}
	;Event[EQ2_onIncomingText]:AttachAtom[EQ2_onIncomingText]
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["prepares to flurry with arcanic energy!"]
	RIMUIObj:SetLockSpot[ALL,-266.234802,26.919926,-382.241852]

	echo ISXRI: Starting Enchanted 
	while ${Actor[Query, Name=-"Enchanted" && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_ShieldID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_ShieldID}
					Actor[Query, ID=${_ShieldID} && IsDead=FALSE]:DoTarget
			}
			else 
			{
				if ${Target.ID}!=${_SwordID}
					Actor[Query, ID=${_SwordID} && IsDead=FALSE]:DoTarget
			}
		}
		if ${Trigger}
;		&& ${Actor[id,${_SwordID}].Distance}<30
		{
			if ${Math.Distance[${Me.Loc},-276.715881,26.919044,-412.841095]}<5
				RIMUIObj:SetLockSpot[ALL,-266.234802,26.919926,-382.241852]
			else
				RIMUIObj:SetLockSpot[ALL,-276.715881,26.919044,-412.841095]
			Trigger:Set[FALSE]
		}
		;if we are a mage watch for spell's MainIconID and cast absorb magic
		if ${Me.Archetype.Equal[mage]}
		{
			if ${Actor[id,${_ShieldID}](exists)}
			{
				;if we see "Defensive Infusion" (MainIconID=846) on "Enchanted Shield", pause bot, stop casting and cast Absorb Magic
				if ${RIObj.MainIconIDExists[${_ShieldID},846]} && ${Me.Ability[id,1812025739].IsReady} && ${Actor[id,${_ShieldID}].Distance}<25
				{
					;turn off assisting
					RI_CMD_Assisting 0
					
					;pause bots
					RI_CMD_PauseCombatBots 1
					
					;target
					Actor[Query, ID=${_ShieldID}]:DoTarget
					
					;cancel spellcast and clear ability queue
					eq2ex cancel_spellcast
					eq2ex clearabilityqueue 
					
					;wait until we are not casting
					wait 200 !${Me.CastingSpell}
					
					;keep attempting to cast absorb magic (ID=1812025739) until it is no longer ready (aka casted)
					do
					{
						if ${Target.ID}==${_ShieldID}
							Me.Ability[id,1812025739]:Use
						else
							Actor[Query, ID=${_ShieldID}]:DoTarget
						wait 1
					}
					while ${Me.Ability[id,1812025739].IsReady}
					
					;wait until we are not casting
					wait 200 !${Me.CastingSpell}
					
					;turn on assisting
					RI_CMD_Assisting 1
					
					;unpause bots
					RI_CMD_PauseCombatBots 0
				}
			}
			else
			{
				;if we see "Offensive Infusion" (MainIconID=264) on "Enchanted Sword", pause bot, stop casting and cast Absorb Magic
				if ${RIObj.MainIconIDExists[${_SwordID},264]} && ${Me.Ability[id,1812025739].IsReady} && ${Actor[id,${_SwordID}].Distance}<25
				{
					;turn off assisting
					RI_CMD_Assisting 0
					
					;pause bots
					RI_CMD_PauseCombatBots 1
					
					;target
					Actor[Query, ID=${_SwordID}]:DoTarget
					
					;cancel spellcast and clear ability queue
					eq2ex cancel_spellcast
					eq2ex clearabilityqueue 
					
					;wait until we are not casting
					wait 200 !${Me.CastingSpell}
					
					;keep attempting to cast absorb magic (ID=1812025739) until it is no longer ready (aka casted)
					do
					{
						if ${Target.ID}==${_SwordID}
							Me.Ability[id,1812025739]:Use
						else
							Actor[Query, ID=${_SwordID}]:DoTarget
						wait 1
					}
					while ${Me.Ability[id,1812025739].IsReady}
					
					;wait until we are not casting
					wait 200 !${Me.CastingSpell}
					
					;turn on assisting
					RI_CMD_Assisting 1
					
					;unpause bots
					RI_CMD_PauseCombatBots 0
				}
			}
		}
		wait 1
	}
	echo Ending Enchanted
	IncomingText:Clear
	IncomingText2:Clear
}


function Baronwall()
{
	declare BWRDone bool global FALSE
	declare BWLDone bool global FALSE
	if !${RI_Var_Bool_GlobalOthers}
	{
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Baronwall"]
		wait 5
	}
	RI_Var_Bool_Follow:Set[FALSE]
	ShinyScanDistance:Set[2]
	eq2execute stopfollow
	RI_Atom_SetRIFollow OFF
	RI_Atom_SetLockSpot OFF
	squelch hud -add BWRDone 300,400 Right Wall Done: ${BWRDone}  InCombat: ${Me.InCombat}
	squelch hud -add BWLDone 300,420 Left Wall Done: ${BWLDone}  InCombat: ${Me.InCombat}
	call RIMObj.CheckCombat
	while ${Me.Y}<31
	{
		while ${Me.Y}<28
		{
			if ${Math.Distance[${Me.Loc},-145.118179,26.472359,18.922091]}>3
				call RIMObj.Move -145.118179 26.472359 18.922091 1 0 1 1 1 0 1 1
			Face 180
			wait 2
			;jump part
			press space
			wait 5 ${Me.Y}>27
			press -hold w
			wait 5 
			;${Me.Z}<30
			press -release w
			wait 10
		}
		while ${Me.Y}<30
		{
			if ${Math.Distance[${Me.Loc},-145.255798,28.823061,22.496674]}>3
				call RIMObj.Move -145.255798 28.823061 22.496674 1 0 1 1 1 0 1 1
			Face 180
			wait 2
			;jump part
			press space
			wait 5 ${Me.Y}>28
			press -hold w
			wait 5 
			;${Me.Z}<30
			press -release w
			wait 2
		}
		wait 1
	}
	if !${Me.IsCrouching}
		press z
	call RIMObj.Move -145.198410 31.587963 27.682356 1 0 1 1 1 0 1 1
	;wait for group members
	if ${Me.Group}>1 && ${Me.Group[1].Type.Equal[PC]}
	{
		while !${RIMObj.AllGroupWithinRange[3]}
			wait 5
	}
	;echo we are all here
	
	wait 2
	variable int WallID
	WallID:Set[${Actor[Query, Name=="a cracked wall" && IsDead=FALSE && Distance<10].ID}]
	while ${Actor[Query, ID=${WallID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${WallID}
				Actor[Query, ID=${WallID}]:DoTarget
		}
		waitframe
	}
	
	wait 20
	call RIMObj.Move -145.174988 31.587963 36.560928 1 0 1 1 1 0 1 1
	wait 5
	if ${RI_Var_Bool_GlobalOthers}
	{
		while !${BWRDone} || ${Me.InCombat}
			wait 5
	}
	else
	{
		variable index:actor VasesIndex
		variable iterator VasesIterator
		EQ2:QueryActors[VasesIndex, Name=="an obulus vase"]
		;echo ${VasesIndex.Used}
		VasesIndex:GetIterator[VasesIterator]
		variable int VasesIndexCounter
		VasesIndexCounter:Set[1]
		if ${VasesIterator:First(exists)}
		{
			do
			{
				;echo ${Math.Distance[${VasesIterator.Value.Loc},-144.996704,26.496861,53.632210]}
				if ${Math.Distance[${VasesIterator.Value.Loc},-144.996704,26.496861,53.632210]}>=21
				{
					;echo removing ${VasesIterator.Value.ID} because its ${Math.Distance[${VasesIterator.Value.Loc},-144.996704,26.496861,53.632210]}
					VasesIndex:Remove[${VasesIndexCounter}]
				}
				VasesIndexCounter:Inc
			}
			while ${VasesIterator:Next(exists)}
		}
		VasesIndex:Collapse
		;echo ${VasesIndex.Used}
		
		while ${VasesIndex.Used}>0
		{
			;first remove all non existing actors from the index and collapse it
			VasesIndex:GetIterator[VasesIterator]
			
			VasesIndexCounter:Set[1]
			if ${VasesIterator:First(exists)}
			{
				do
				{
					;echo ${Math.Distance[${VasesIterator.Value.Loc},-144.996704,26.496861,53.632210]}
					if ${VasesIterator.Value.IsDead} || !${VasesIterator.Value(exists)}
					{
						;echo removing ${VasesIterator.Value.ID} because its either gone or dead
						VasesIndex:Remove[${VasesIndexCounter}]
					}
					VasesIndexCounter:Inc
				}
				while ${VasesIterator:Next(exists)}
			}
			VasesIndex:Collapse
			
			;now target the first in the index
			VasesIndex.Get[1]:DoTarget
			
			wait 5
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-145.171860,31.587963,28.740166]
		wait 50 !${Me.InCombat}
		wait 100 ( ${Me.InCombat} || ${Me.IsHated} )
		while ( ${Me.InCombat} || ${Me.IsHated} )
			wait 10
		relay ${RI_Var_String_RelayGroup} BWRDone:Set[TRUE]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[OFF]
	}
	
	if ${QuestJournalWindow.ActiveQuest[Kunark Ascending: A Chosen Weapon](exists)}
	{
		call RIMObj.Move -145.174988 31.587963 36.560928 1 0 1 1 1 1 1 1
		call RIMObj.Move -141.244858 26.488461 51.834408 1 0 1 1 1 0 1 1
		wait 20
		call RIMObj.CheckCombat
		relay ${RI_Var_String_RelayGroup} Actor["Caszire the Dark"]:DoubleClick
		wait 2
		relay ${RI_Var_String_RelayGroup} Actor["Caszire the Dark"]:DoubleClick
		wait 2
		relay ${RI_Var_String_RelayGroup} Actor["Caszire the Dark"]:DoubleClick
		wait 20
		call RIMObj.CheckCombat
		relay ${RI_Var_String_RelayGroup} Actor[Mirror]:DoubleClick
		wait 2
		relay ${RI_Var_String_RelayGroup} Actor[Mirror]:DoubleClick
		wait 2
		relay ${RI_Var_String_RelayGroup} Actor[Mirror]:DoubleClick
		wait 20
		call RIMObj.Move -145.153519 26.499077 43.594463 1 0 1 1 1 0 1 1
		;function JumpUp(float _X, float _Y, float _Z, float _YTarget, int _FaceDegree, int _GiveUpCNT=10)
		call JumpUp -145.153519 26.499077 43.594463 27 0
		call RIMObj.Move -145.035965 28.907936 41.006645 1 0 1 1 1 0 1 1
		call JumpUp -145.035965 28.907936 41.006645 30 0
		call RIMObj.Move -145.126526 31.558907 37.396252 1 0 1 1 1 1 1 1
		call RIMObj.Move -145.228027 31.587963 33.517056 1 0 1 1 1 0 1 1
	}
	; call RIMObj.Move -137.719009 30.427376 38.753876 1 0 1 1 1 1 1 1
	; call RIMObj.Move -132.712616 30.469751 54.015369 1 0 1 1 1 1 1 1
	; call RIMObj.Move -136.557693 30.539661 69.682091 1 0 1 1 1 1 1 1
	; call RIMObj.Move -153.262985 30.529211 69.709412 1 0 1 1 1 1 1 1
	; call RIMObj.Move -157.574280 31.407291 54.851101 1 0 1 1 1 1 1 1
	; call RIMObj.Move -153.409042 31.640842 37.751358 1 0 1 1 1 1 1 1
	; call RIMObj.Move -148.499649 32.630344 37.621799 1 0 1 1 1 1 1 1
	; call RIMObj.Move -144.186783 31.492989 37.558567 1 0 1 1 1 1 1 1
	call RIMObj.Move -145.270111 31.587963 26.126577 1 0 1 1 1 1 1 1
	call RIMObj.Move -153.792191 26.492765 16.001835 1 0 1 1 1 1 1 1
	call RIMObj.Move -176.571930 26.471821 19.243248 1 0 1 1 1 0 1 1
	call RIMObj.CheckCombat
	while ${Me.Y}<31
	{
		while ${Me.Y}<28
		{
			if ${Math.Distance[${Me.Loc},-176.571930,26.471821,19.243248]}>3
				call RIMObj.Move -176.571930 26.471821 19.243248 1 0 1 1 1 0 1 1
			Face 180
			wait 2
			;jump part
			press space
			wait 5 ${Me.Y}>27
			press -hold w
			wait 5 
			;${Me.Z}<30
			press -release w
			wait 10
		}
		while ${Me.Y}<30
		{
			if ${Math.Distance[${Me.Loc},-176.042984,28.828899,22.569334]}>3
				call RIMObj.Move -176.042984 28.828899 22.569334 1 0 1 1 1 0 1 1
			Face 180
			wait 2
			;jump part
			press space
			wait 5 ${Me.Y}>28
			press -hold w
			wait 5 
			;${Me.Z}<30
			press -release w
			wait 2
		}
	}
	if !${Me.IsCrouching}
		press z
	call RIMObj.Move -176.492737 31.587963 28.741343 1 0 1 1 1 0 1 1
	;wait for group members
		;wait for group members
	if ${Me.Group}>1 && ${Me.Group[1].Type.Equal[PC]}
	{
		while !${RIMObj.AllGroupWithinRange[3]}
			wait 5
	}
	;echo we are all here
	
	wait 2
	
	WallID:Set[${Actor[Query, Name=="a cracked wall" && IsDead=FALSE && Distance<10].ID}]
	while ${Actor[Query, ID=${WallID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${WallID}
				Actor[Query, ID=${WallID}]:DoTarget
		}
		waitframe
	}
	wait 20
	call RIMObj.Move -176.480270 31.587963 36.729984 1 0 1 1 1 0 1 1
	wait 5
	if ${RI_Var_Bool_GlobalOthers}
	{
		while !${BWLDone} || ${Me.InCombat}
			wait 5
	}
	else
	{
		VasesIndex:Clear

		EQ2:QueryActors[VasesIndex, Name=="an obulus vase"]
		;echo ${VasesIndex.Used}
		VasesIndex:GetIterator[VasesIterator]

		VasesIndexCounter:Set[1]
		if ${VasesIterator:First(exists)}
		{
			do
			{
				;echo ${Math.Distance[${VasesIterator.Value.Loc},-144.996704,26.496861,53.632210]}
				if ${Math.Distance[${VasesIterator.Value.Loc},-176.332199,26.496981,54.435680]}>=21
				{
					;echo removing ${VasesIterator.Value.ID} because its ${Math.Distance[${VasesIterator.Value.Loc},-144.996704,26.496861,53.632210]}
					VasesIndex:Remove[${VasesIndexCounter}]
				}
				VasesIndexCounter:Inc
			}
			while ${VasesIterator:Next(exists)}
		}
		VasesIndex:Collapse
		;echo ${VasesIndex.Used}
		
		while ${VasesIndex.Used}>0
		{
			;first remove all non existing actors from the index and collapse it
			VasesIndex:GetIterator[VasesIterator]
			
			VasesIndexCounter:Set[1]
			if ${VasesIterator:First(exists)}
			{
				do
				{
					;echo ${Math.Distance[${VasesIterator.Value.Loc},-144.996704,26.496861,53.632210]}
					if ${VasesIterator.Value.IsDead} || !${VasesIterator.Value(exists)}
					{
						;echo removing ${VasesIterator.Value.ID} because its either gone or dead
						VasesIndex:Remove[${VasesIndexCounter}]
					}
					VasesIndexCounter:Inc
				}
				while ${VasesIterator:Next(exists)}
			}
			VasesIndex:Collapse
			
			;now target the first in the index
			VasesIndex.Get[1]:DoTarget
			
			wait 5
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-176.674576,31.587963,28.945089]
		wait 50 !${Me.InCombat}
		wait 100 ( ${Me.InCombat} || ${Me.IsHated} )
		while ( ${Me.InCombat} || ${Me.IsHated} )
			wait 5
		relay ${RI_Var_String_RelayGroup} BWLDone:Set[TRUE]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[OFF]
	}
	; call RIMObj.Move -173.128159 30.471457 39.199783 1 0 1 1 1 1 1 1
	; call RIMObj.Move -167.412735 30.632805 38.296242 1 0 1 1 1 1 1 1
	; call RIMObj.Move -163.289764 32.311440 54.203190 1 0 1 1 1 1 1 1
	; call RIMObj.Move -166.744644 31.306763 69.268204 1 0 1 1 1 1 1 1
	; call RIMObj.Move -185.523605 31.176176 69.935356 1 0 1 1 1 1 1 1
	; call RIMObj.Move -188.900085 32.329926 56.012989 1 0 1 1 1 1 1 1
	; call RIMObj.Move -184.613403 31.601589 37.851025 1 0 1 1 1 1 1 1
	; call RIMObj.Move -175.966354 31.587963 37.028351 1 0 1 1 1 1 1 1
	call RIMObj.Move -176.602280 31.587963 26.228256 1 0 1 1 1 1 1 1
	call RIMObj.Move -175.679520 26.475712 18.188866 1 0 1 1 1 0 1 1
	
	if ${Me.IsCrouching}
		press z
	
	ShinyScanDistance:Set[50]
	RI_Var_Bool_Follow:Set[TRUE]
	squelch hud -remove BWRDone
	squelch hud -remove BWLDone
	deletevariable BWRDone
	deletevariable BWLDone
}
; function BaronRightWall()
; {
	; echo ISXRI: Starting Right Wall, This has not been coded yet, for now do this manually then return to this position and say IM DONE and RI will continue
	; ;this script gets all toons into the right room to get mirror, but only if on the quest
	;IncomingText:Clear
	;IncomingText2:Clear
	; IncomingText:Insert[IM DONE]
	; while !${Trigger}
		; wait 2
	; Trigger:Set[FALSE]
	; echo Ending Right Wall
; }
function BaronGetResources()
{
	echo ISXRI: Starting Get Resources, This has not been coded yet, for now do this manually then return to this position and say IM DONE and RI will continue
	;this script goes and gets the resources, but only if on the quest
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert[IM DONE]
	while !${Trigger}
		wait 2
	Trigger:Set[FALSE]
	echo Ending Get Resources
}

function BaronHaggleActivator()
{
	echo ISXRI: Starting Haggle Activator, This has not been coded yet, for now do this manually then return to this position and say IM DONE and RI will continue
	;this script show haggle the mirror and then hail and go through dialog, but only if on the quest, else just kill
	
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert[IM DONE]
	while !${Trigger}
		wait 2
	Trigger:Set[FALSE]
	echo Ending Haggle Activator
}

function BaronGetBookandCraft()
{
	echo ISXRI: Starting Grab Book and Craft, This has not been coded yet, for now do this manually then return to this position and say IM DONE and RI will continue
	;this script will go into the other room grab the book and run back and craft the weapon then move back to teleporter, but only if on the quest
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert[IM DONE]
	while !${Trigger}
		wait 2
	Trigger:Set[FALSE]
	echo Ending Grab Book and Craft
}

;;;;;;;;;;;;;;;; End Crypt of Dalnir: Baron's Workshop [Heroic] ;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;; Start Crypt of Dalnir: Wizard's Den [Event Heroic] ;;;;;;;;;;;;;;;;;;;;;;
function WizardsDenSigCheck1()
{
	CustomLoc:Set[0 0 0]
	RI_Atom_SetLockSpot OFF
	if ${QuestJournalWindow.ActiveQuest[Ghosts and Gooblins](exists)}
	{
		call ToggleWalkRun 1
		call RIMObj.Move 405.418365 -50.445290 -16.195228 1 0 1 1 1 0 1 1
		wait 20
		call ClickActor "Cage Door 1"
		wait 20
		call ToggleWalkRun 1
		call RIMObj.Move 396.187073 -47.662983 -56.322746 1 0 1 1 1 0 1 1
		call ToggleWalkRun 1
		call RIMObj.Move 400.479736 -45.592010 -57.835278 1 0 1 1 1 1 1 1
		call RIMObj.Move 402.696686 -45.314312 -58.115300 1 0 1 1 1 0 1 1
		wait 20
		call ClickActor "Cage Door 2"
		wait 20
		call ToggleWalkRun 1
		call RIMObj.Move 390.497681 -47.229462 -130.442154 1 0 1 1 1 1 1 1
		call RIMObj.Move 427.011505 -46.429970 -147.428574 1 0 1 1 1 0 1 1
		call ToggleWalkRun 1
		call RIMObj.Move 435.081238 -45.326229 -149.611069 1 0 1 1 1 0 1 1
		wait 20
		call ClickActor "Cage Door 4"
		wait 20
		call ToggleWalkRun 1
		call RIMObj.Move 375.328461 -46.766254 -134.036346 1 0 1 1 1 1 1 1
	}
}

function WizardsDenSigCheck2()
{
	CustomLoc:Set[0 0 0]
	if ${QuestJournalWindow.ActiveQuest[Ghosts and Gooblins](exists)}
	{
		call RIMObj.Move 345.072144 -38.727089 -214.231476 1 0 1 1 1 0 1 1
		wait 20
		call RIMObj.Move 343.478241 -38.729622 -217.265320 1 0 1 1 1 0 1 1
		wait 20
		call HailActor Wreek 5
		call RIMObj.Move 349.550568 -38.731476 -163.174728 1 0 1 1 1 1 1 1
		call RIMObj.Move 371.893860 -46.969345 -131.764709 1 0 1 1 1 1 1 1
		call RIMObj.Move 384.455536 -48.833115 -93.887444 1 0 1 1 1 1 1 1
		call RIMObj.Move 388.928284 -48.713097 -61.081169 1 0 1 1 1 1 1 1
		call RIMObj.Move 392.626129 -52.607872 -15.824572 1 0 1 1 1 1 1 1
		call RIMObj.Move 385.840668 -54.144047 -1.462285 1 0 1 1 1 1 1 1
		call RIMObj.Move 360.779266 -53.860722 3.782473 1 0 1 1 1 1 1 1
		call RIMObj.Move 329.591309 -54.586620 -1.278129 1 0 1 1 1 1 1 1
		call RIMObj.Move 302.613251 -52.982571 -4.778679 1 0 1 1 1 1 1 1
		call RIMObj.Move 279.020111 -46.419823 -22.439344 1 0 1 1 1 1 1 1
		call RIMObj.Move 249.563690 -45.372128 -19.639872 1 0 1 1 1 1 1 1
		call RIMObj.Move 251.667923 -45.166569 -11.163614 1 0 1 1 1 0 1 1
		wait 20
		call RIMObj.Move 248.429993 -44.830002 -4.530000 1 0 1 1 1 1 1 1
		call RIMObj.Move 247.872055 -44.784355 -3.562286 1 0 1 1 1 0 1 1
		wait 20
		call RIMObj.Move 78.324219 26.479950 -55.841972 1 0 1 1 1 0 1 1
		wait 20
		call RIMObj.Move 77.871758 26.471060 -60.555004 1 0 1 1 1 0 1 1
		call JumpUp 77.871758 26.471060 -60.555004 27 360 
		;function JumpUp(float _X, float _Y, float _Z, float _YTarget, int _FaceDegree, int _GiveUpCNT=10)
		call RIMObj.Move 78.126015 28.826199 -63.095081 1 0 1 1 1 0 1 1
		call JumpUp 78.126015 28.826199 -63.095081 29 360
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call JumpUp 78.126015 28.826199 -63.095081 29 360"]
		relay ${RI_Var_String_RelayGroup} TimedCommand 20 Press ${RI_Var_String_JumpKey}
		relay ${RI_Var_String_RelayGroup} TimedCommand 22 Press ${RI_Var_String_JumpKey}
		relay ${RI_Var_String_RelayGroup} TimedCommand 24 Press ${RI_Var_String_JumpKey}
		call RIMObj.Move 78.232033 31.048355 -65.420967 1 0 1 1 1 1 1 1
		call RIMObj.Move 78.397430 31.587963 -69.462357 1 0 1 1 1 0 1 1
		Actor["a cracked wall"]:DoTarget
		wait 50
		call RIMObj.Move 79.778320 31.587963 -77.451225 1 0 1 1 1 1 1 1
		call RIMObj.Move 68.833588 30.669708 -80.494041 1 0 1 1 1 1 1 1
		call RIMObj.Move 78.009811 31.582218 -77.897171 1 0 1 1 1 1 1 1
		call RIMObj.Move 78.486794 31.587967 -66.593536 1 0 1 1 1 1 1 1
		call RIMObj.Move 77.922188 26.493315 -51.594086 1 0 1 1 1 1 1 1
		call RIMObj.Move 140.638443 26.493362 -49.953506 1 0 1 1 1 0 1 1
		wait 20
		call RIMObj.Move 146.278610 26.779022 -50.040245 1 0 1 1 1 1 1 1
		call RIMObj.Move 259.987274 -45.435520 -32.814690 1 0 1 1 1 1 1 1
		call RIMObj.Move 296.764069 -50.512154 -14.226505 1 0 1 1 1 1 1 1
		call RIMObj.Move 330.622101 -53.892300 -3.625979 1 0 1 1 1 1 1 1
		call RIMObj.Move 367.933228 -53.832020 2.380923 1 0 1 1 1 1 1 1
		call RIMObj.Move 389.365356 -53.973129 -4.171980 1 0 1 1 1 1 1 1
		call RIMObj.Move 395.504608 -50.822731 -34.257175 1 0 1 1 1 1 1 1
		call RIMObj.Move 378.372589 -47.922321 -109.895523 1 0 1 1 1 1 1 1
		call RIMObj.Move 369.708130 -43.562149 -145.827637 1 0 1 1 1 1 1 1
		call RIMObj.Move 348.123413 -38.724445 -169.363342 1 0 1 1 1 1 1 1
		call RIMObj.Move 343.350616 -38.729244 -216.870789 1 0 1 1 1 0 1 1
		wait 20
		call HailActor Wreek 5
		call RIMObj.Move 347.204926 -38.724422 -201.745361 1 0 1 1 1 1 1 1
	}
}
function WizardsDenSigCheck3()
{
	CustomLoc:Set[0 0 0]
	if ${QuestJournalWindow.ActiveQuest[Ghosts and Gooblins](exists)}
	{
		call RIMObj.Move 77.871758 26.471060 -60.555004 1 0 1 1 1 0 1 1
		call JumpUp 77.871758 26.471060 -60.555004 27 360 
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call JumpUp 77.871758 26.471060 -60.555004 27 360 "]
		relay ${RI_Var_String_RelayGroup} TimedCommand 20 Press ${RI_Var_String_JumpKey}
		relay ${RI_Var_String_RelayGroup} TimedCommand 22 Press ${RI_Var_String_JumpKey}
		relay ${RI_Var_String_RelayGroup} TimedCommand 24 Press ${RI_Var_String_JumpKey}
		;function JumpUp(float _X, float _Y, float _Z, float _YTarget, int _FaceDegree, int _GiveUpCNT=10)
		call RIMObj.Move 78.126015 28.826199 -63.095081 1 0 1 1 1 0 1 1
		call JumpUp 78.126015 28.826199 -63.095081 29 360
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call JumpUp 78.126015 28.826199 -63.095081 29 360"]
		relay ${RI_Var_String_RelayGroup} TimedCommand 20 Press ${RI_Var_String_JumpKey}
		relay ${RI_Var_String_RelayGroup} TimedCommand 22 Press ${RI_Var_String_JumpKey}
		relay ${RI_Var_String_RelayGroup} TimedCommand 24 Press ${RI_Var_String_JumpKey}
		call RIMObj.Move 78.232033 31.048355 -65.420967 1 0 1 1 1 1 1 1
		call RIMObj.Move 78.397430 31.587963 -69.462357 1 0 1 1 1 0 1 1
		Actor["a cracked wall"]:DoTarget
		wait 50
		call RIMObj.Move 79.778320 31.587963 -77.451225 1 0 1 1 1 1 1 1
		call RIMObj.Move 68.833588 30.669708 -80.494041 1 0 1 1 1 1 1 1
		call RIMObj.Move 73.796402 26.483061 -95.183884 1 0 1 1 1 0 1 1
		wait 20
		call HailActor Wreek 5
		call RIMObj.Move 77.992607 26.496368 -84.157974 1 0 1 1 1 0 1 1
		call JumpUp 77.992607 26.496368 -84.157974 27 180
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call JumpUp 77.992607 26.496368 -84.157974 27 180"]
		call RIMObj.Move 77.992126 28.902409 -81.510399 1 0 1 1 1 0 1 1
		call JumpUp 77.992126 28.902409 -81.510399 29 180
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call JumpUp 77.992126 28.902409 -81.510399 29 180"]
		relay ${RI_Var_String_RelayGroup} TimedCommand 20 Press ${RI_Var_String_JumpKey}
		relay ${RI_Var_String_RelayGroup} TimedCommand 22 Press ${RI_Var_String_JumpKey}
		relay ${RI_Var_String_RelayGroup} TimedCommand 24 Press ${RI_Var_String_JumpKey}
		call RIMObj.Move 77.989189 30.592825 -79.153793 1 0 1 1 1 1 1 1
		call RIMObj.Move 77.989189 31.587875 -77.815720 1 0 1 1 1 1 1 1
		call RIMObj.Move 77.998444 31.587963 -66.562157 1 0 1 1 1 0 1 1
	}
}
function Nazkra()
{
; Custom
; Target Nazkra
; 357.543213 -38.445255 -190.009628
; Custom
; WaitForMob Nazkra 9 0 1
; 357.543213 -38.445255 -190.009628
; Wait
; 50
; 357.543213 -38.445255 -190.009628
	declare NazkraID int ${Actor[Query, Name=-"Nazkra"].ID}
	echo ISXRI: Starting Nazkra 
	if ${Zone.Name.Find["[Advanced Solo]"](exists)}
	{
		;move to position
		RI_Atom_SetLockSpot ALL 352.365875 -38.576962 -239.860672
		wait 20
		Actor[${NazkraID}]:DoTarget
		while ${Actor[Query, ID=${NazkraID} && IsDead=FALSE](exists)} && ${Actor[Query, ID=${NazkraID} && IsDead=FALSE].Distance}>9
		{
			if !${RI_Var_Bool_GlobalOthers}
			{
				if ${Actor[Query, Name=-"vicar" && Distance<=20 && IsDead=FALSE](exists)}
				{
					if ${Target.ID}!=${Actor[Query, Name=-"vicar" && Distance<=20 && IsDead=FALSE].ID}
						Actor[Query, Name=-"vicar" && Distance<=20 && IsDead=FALSE]:DoTarget
				}
				else
				{
					if ${Target.ID}!=${NazkraID}
						Actor[${NazkraID}]:DoTarget
				}
			}
			wait 2
		}
	}
	else
	{
		;turn off assisting
		RI_CMD_Assisting 0
		;turn on Singular Focus 4026518400  or if guardian Focused Offensive 1432018334
		if ${Me.SubClass.Equal[guardian]} && ${Me.Ability[id,1432018334].IsReady}
		{
			while !${Me.Maintained[Focused Offensive](exists)}
			{
				while ${Me.Ability[id,1432018334].IsReady}
				{
					Me.Ability[id,1432018334]:Use
					wait 5 ${Me.Maintained[Focused Offensive](exists)}
				}
				wait 5 ${Me.Maintained[Focused Offensive](exists)}
			}
		}
		elseif ${Me.Ability[id,4026518400].IsReady}
		{
			while !${Me.Maintained[Singular Focus](exists)}
			{
				while ${Me.Ability[id,4026518400].IsReady}
				{
					Me.Ability[id,4026518400]:Use
					wait 5 ${Me.Maintained[Singular Focus](exists)}
				}
				wait 5 ${Me.Maintained[Singular Focus](exists)}
			}
		}

		wait 10
		
		;turn off ae's in CB
		;if ${Me.Archetype.NotEqual[fighter]}
		;{
			RI_Obj_CB:DoNotCastEncounter[TRUE]
			RI_Obj_CB:DoNotCastAE[TRUE]
		;}
		Actor[${NazkraID}]:DoTarget
		
		;move to position
		RI_Atom_SetLockSpot ALL 357.946594 -38.758297 -190.028015 
		wait 50
		while ${Actor[Query, ID=${NazkraID} && IsDead=FALSE](exists)} && ${Actor[Query, ID=${NazkraID} && IsDead=FALSE].Distance}>9
		{
			;if !${RI_Var_Bool_GlobalOthers}
			;{
				if ${Actor[Query, Name=-"vicar" && Distance<=30 && IsDead=FALSE](exists)}
				{
					if ${Target.ID}!=${Actor[Query, Name=-"vicar" && Distance<=30 && IsDead=FALSE].ID}
						Actor[Query, Name=-"vicar" && Distance<=30 && IsDead=FALSE]:DoTarget
				}
				elseif ${Actor[Query, Name=-"centurion" && Distance<=30 && IsDead=FALSE && Target.ID!=${Me.ID}](exists)} && !${RI_Var_Bool_GlobalOthers}
				{
					if ${Target.ID}!=${Actor[Query, Name=-"centurion" && Distance<=30 && IsDead=FALSE && Target.ID!=${Me.ID}].ID}
						Actor[Query, Name=-"centurion" && Distance<=30 && IsDead=FALSE && Target.ID!=${Me.ID}]:DoTarget
				}
				else
				{
					if ${Target.ID}!=${NazkraID}
						Actor[${NazkraID}]:DoTarget
				}
			;}
			wait 2
		}
		wait 20
		
		if ${RI_Var_Bool_GlobalOthers}
			RI_Atom_SetLockSpot ALL 357.946594 -38.758297 -200.028015 
		else
			RI_Atom_SetLockSpot ALL 352.231354 -38.734402 -196.402695
		while ${Actor[Query, ID=${NazkraID} && IsDead=FALSE](exists)}
		{
			;if !${RI_Var_Bool_GlobalOthers}
			;{
				if ${Actor[Query, Name=-"vicar" && Distance<=30 && IsDead=FALSE](exists)}
				{
					if ${Target.ID}!=${Actor[Query, Name=-"vicar" && Distance<=30 && IsDead=FALSE].ID}
						Actor[Query, Name=-"vicar" && Distance<=30 && IsDead=FALSE]:DoTarget
				}
				elseif ${Actor[Query, Name=-"centurion" && Distance<=30 && IsDead=FALSE && Target.ID!=${Me.ID}](exists)} && !${RI_Var_Bool_GlobalOthers}
				{
					if ${Target.ID}!=${Actor[Query, Name=-"centurion" && Distance<=30 && IsDead=FALSE && Target.ID!=${Me.ID}].ID}
						Actor[Query, Name=-"centurion" && Distance<=30 && IsDead=FALSE && Target.ID!=${Me.ID}]:DoTarget
				}
				else
				{
					if ${Target.ID}!=${NazkraID}
						Actor[${NazkraID}]:DoTarget
				}
			;}
			wait 2
		}
		;turn on assisting
		RI_CMD_Assisting 1
		
		;turn on ae's in CB
		RI_Obj_CB:DoNotCastEncounter[FALSE]
		RI_Obj_CB:DoNotCastAE[FALSE]
		
		if ${Me.SubClass.Equal[guardian]}
			Me.Maintained[Focused Offensive]:Cancel
		else
			Me.Maintained[Singular Focus]:Cancel
			
		wait 10
	}
	echo Ending Nazkra
}
function WizardsDenShinyHunt1()
{
	return
	; SpecialShiny:Set[TRUE]
	; 351.922852 -38.728672 -209.882217
	; 349.468994 -38.728992 -219.808487
	; 347.821747 -38.723907 -229.809692
	; 346.519562 -38.560799 -240.055252
	; 345.550842 -38.725292 -250.121704
	; 347.149567 -38.725346 -260.182556
	; 349.280182 -38.725346 -270.154144
	; 341.903992 -38.725346 -277.075409
	; 332.650269 -38.725346 -272.818268
	; 324.930603 -38.729382 -266.188904
	; 315.458191 -38.728542 -261.927521
	; 305.201355 -38.730652 -261.379211
	; 295.356628 -38.723869 -263.322906
	; 287.221588 -38.725346 -269.516937
	; 278.891449 -38.725346 -275.267700
	; 268.642334 -38.725346 -273.935425
	; 259.682587 -38.736847 -269.200104
	; 250.887314 -38.727840 -264.441467
	; 241.207458 -38.731339 -261.527649
	; 231.128860 -38.725922 -259.907074
	; 223.490326 -38.725346 -266.388367
	; 213.345795 -38.725346 -267.837799
	; 204.459137 -38.725349 -262.966766
	; 199.887711 -38.725346 -253.936111
	; 207.527649 -38.725346 -247.044022
	; 217.371582 -38.725346 -249.442856
	; 225.441116 -38.725346 -255.528778
	; 233.728333 -38.724895 -261.345032
	; 243.749298 -38.555614 -263.681702
	; 254.002884 -38.724598 -262.936646
	; 264.341675 -38.725346 -262.844086
	; 274.582031 -38.725346 -262.609802
	; 284.619873 -38.725346 -262.393494
	; 294.642120 -38.727383 -262.499298
	; 304.645294 -38.725277 -262.747375
	; 314.943390 -38.724361 -263.261719
	; 325.151276 -38.725571 -264.474274
	; 334.713593 -38.725346 -268.129883
	; 344.660614 -38.725346 -266.012665
	; 349.908264 -38.725632 -257.335449
	; 350.249542 -38.732006 -247.258759
	; 350.078613 -38.733665 -237.220657
	; 350.242584 -38.731750 -227.215622
	; 350.238953 -38.726738 -217.125305
	; 349.969269 -38.726086 -207.020920
	; SpecialShiny:Set[FALSE]
}
function WizardsDenShinyHunt2()
{
	return
	; SpecialShiny:Set[TRUE]
	
; 518.995056 -59.215076 68.350739
; 509.187622 -59.217205 65.879791
; 499.186340 -59.218754 64.651016
; 492.748993 -59.216049 72.338463
; 492.426849 -59.216454 82.504105
; 491.249176 -59.224277 92.620132
; 489.934113 -59.231094 102.556747
; 489.417267 -59.239655 112.664330
; 489.035858 -59.217377 122.765076
; 488.654449 -58.645226 132.865829
; 488.276855 -56.375469 142.865097
; 488.129089 -56.375702 153.025681
; 490.798370 -53.877270 162.368652
; 492.915222 -52.737579 172.225830
; 493.993774 -52.722889 182.429291
; 494.446960 -52.722408 192.482803
; 494.405182 -52.724064 202.556885
; 494.493988 -52.723282 212.643387
; 502.323273 -52.725826 219.392944
; 512.382019 -52.724632 218.299149
; 522.687561 -52.700672 217.976608
; 532.876770 -52.583160 217.714890
; 543.116943 -52.737518 217.451950
; 552.882935 -50.376930 217.201126
; 563.106140 -49.534718 216.938583
; 573.261597 -48.991333 216.677811
; 583.163147 -46.289463 216.423553
; 593.352356 -46.112881 216.161850
; 603.457092 -46.258362 215.902344
; 613.629639 -46.274933 215.641113
; 623.869690 -46.270802 215.378159
; 633.906738 -46.270855 215.120361
; 643.926636 -46.270939 214.863052
; 654.032166 -46.272484 214.659180
; 664.036499 -46.277706 214.864151
; 674.260498 -46.264233 215.102554
; 684.382874 -46.290379 215.338593
; 694.521973 -46.289463 215.574997
; 704.339539 -49.313522 215.803955
; 714.444946 -49.535843 216.039597
; 724.397827 -50.576248 216.271805
; 734.332825 -52.740669 216.542801
; 744.556641 -52.580280 216.741959
; 754.697144 -52.697170 216.624237
; 764.729980 -52.716297 216.987686
; 774.807739 -52.722870 216.575516
; 784.729492 -52.726368 216.414276
; 784.387878 -52.725941 206.414383
; 784.043701 -52.729988 196.340576
; 783.699341 -52.726604 186.258881
; 783.354919 -52.742527 176.175690
; 783.013062 -52.741913 166.175323
; 782.686279 -56.289383 156.614899
; 782.338745 -56.367737 146.445313
; 781.997559 -57.463676 136.461838
; 781.654114 -59.212368 126.410660
; 781.118469 -59.047813 116.200287
; 780.957886 -59.216454 106.092773
; 781.557739 -59.214317 96.104393
; 782.174744 -59.214565 85.981316
; 782.093628 -59.213680 75.757507
; 776.340027 -59.215305 67.346115
; 766.425964 -59.218483 65.284798
; 756.210327 -59.222763 65.743629
; 745.921509 -59.225235 66.422256
; 735.738159 -59.221638 67.152763
; 725.453430 -59.045368 67.890556
; 715.270081 -59.196159 68.621063
; 705.472351 -59.198841 71.426353
; 701.672424 -59.227306 80.829155
; 700.769287 -59.213535 90.877953
; 699.869873 -59.187313 100.894783
; 698.862549 -59.207531 110.968887
; 697.081909 -59.210377 120.981133
; 693.376404 -57.794491 130.382629
; 687.888367 -54.299633 138.261032
; 681.013489 -51.163147 144.835602
; 672.990784 -47.670475 149.832138
; 663.202209 -46.295914 152.592133
; 653.072693 -46.305714 154.035446
; 642.824524 -46.306347 154.237793
; 632.813660 -46.306290 153.731934
; 622.650574 -46.305653 153.218384
; 612.584717 -46.295868 152.544281
; 602.944092 -47.847122 149.784134
; 594.618103 -51.448761 144.945541
; 585.259583 -54.272930 142.430359
; 577.653809 -57.608715 136.820724
; 575.680237 -58.707428 126.806313
; 575.689697 -59.228016 116.579948
; 575.678711 -59.182770 106.573601
; 575.742798 -59.209637 96.347603
; 577.599365 -59.218494 86.269913
; 585.242249 -59.214882 79.571754
; 595.049805 -59.197170 77.220459
; 605.077087 -59.118927 78.289856
; 614.872192 -59.037266 81.276878
; 618.698730 -58.890812 90.539948
; 620.000244 -58.300869 100.620255
; 619.596008 -57.451672 108.819618
; 621.463745 -59.206203 98.929077
; 625.054199 -58.902714 89.447517
; 633.974548 -58.956150 84.530807
; 644.194519 -58.952744 84.841988
; 653.772705 -58.919590 87.888588
; 659.773743 -59.379204 95.977219
; 657.415588 -57.532619 105.671051
; 656.477905 -57.447906 108.947052
; 657.059509 -59.012569 99.067406
; 657.027283 -58.909008 88.863800
; 656.667725 -59.018265 78.796165
; 656.374756 -59.139217 68.607811
; 656.207947 -59.014725 58.552425
; 656.224060 -58.905212 48.461407
; 656.240784 -58.884075 38.184151
; 656.256409 -57.472633 29.362982
; 655.602600 -59.623020 39.171227
; 650.023804 -58.896282 47.629082
; 640.608337 -58.934402 51.127838
; 630.301636 -58.937508 51.430382
; 621.712708 -58.881191 46.246609
; 619.254517 -57.817863 36.387157
; 619.987854 -57.458462 28.803160
; 618.872192 -59.410690 38.860699
; 616.109802 -58.929523 48.717464
; 608.572021 -59.094391 55.532673
; 599.425354 -59.159851 59.744305
; 589.153198 -59.212921 59.791107
; 579.802734 -59.221966 56.167366
; 574.338013 -59.218475 47.693489
; 572.592407 -59.193104 37.483456
; 573.223511 -59.193985 27.336035
; 575.180908 -59.196190 17.353924
; 579.375916 -58.132309 8.163203
; 585.751221 -55.458309 0.486182
; 592.777283 -52.285122 -6.018360
; 600.354736 -48.793468 -11.815230
; 609.546326 -46.296127 -15.296391
; 619.639893 -46.305462 -16.941912
; 629.752563 -46.306107 -18.318483
; 639.830872 -46.306526 -18.763004
; 650.036377 -46.305912 -18.494934
; 660.073059 -46.303047 -16.828587
; 669.657898 -46.595642 -13.529822
; 678.211426 -49.848034 -9.270086
; 685.729858 -53.117016 -3.391882

	; SpecialShiny:Set[FALSE]
}
function WizardsDenChasm()
{
	echo ISXRI: Starting Chasm, This has not been coded yet, for now do this manually then return to this position and say IM DONE and RI will continue
	;do this if the Quest Ghosts and Gooblins exists
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert[IM DONE]
	while !${Trigger}
		wait 2
	Trigger:Set[FALSE]
	echo Ending Chasm
}
function WizardsDenCrypt()
{
	echo ISXRI: Starting Crypt, This has not been coded yet, for now do this manually then return to this position and say IM DONE and RI will continue
	;do this if the Quest Ghosts and Gooblins exists
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert[IM DONE]
	while !${Trigger}
		wait 2
	Trigger:Set[FALSE]
	echo Ending Crypt
}
function WizardsDenMutationHall()
{
	echo ISXRI: Starting MutationHall, This has not been coded yet, for now do this manually then return to this position and say IM DONE and RI will continue
	;do this if the Quest Ghosts and Gooblins exists
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert[IM DONE]
	while !${Trigger}
		wait 2
	Trigger:Set[FALSE]
	echo Ending MutationHall
}
function WizardsDenMutationHallEND()
{
	;on this one evac and then go talk to wreek if quest exists otherwise just evac
	wait 20
	call Evac TRUE
	echo ISXRI: Starting MutationHallEND, This has not been coded yet, for now do this manually then return to this position and say IM DONE and RI will continue
	;do this if the Quest Ghosts and Gooblins exists
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert[IM DONE]
	while !${Trigger}
		wait 2
	Trigger:Set[FALSE]
	echo Ending MutationHallEND
}

;;;;;;;;;;;;;;;; End Crypt of Dalnir: Wizard's Den [Event Heroic] ;;;;;;;;;;;;;;;;;;;;;;
	
;;;;;;;;;;;;;;;; Start Frillik Tide ;;;;;;;;;;;;;;;;;;;;;;

variable bool CaptainDoneTrigger=FALSE
variable bool RatTrigger=FALSE
variable int ScriptStartTime
variable bool NoFire=TRUE
variable int GoodSlaver
variable(global) bool NotPastFirstSlaver=FALSE
variable int ropecount=0



function Frillik(bool caughtstart=FALSE, bool Fire=FALSE)
{
	if !${Me.Inventory["Totem of the Deadly Sabertooth"](exists)} && ${Me.Speed}<75
	{
		echo ISXRI: Frillik Tide script requires Totem of the Deadly Sabertooth, please get and rerun
		Script:End
	}
	wait 20
	;pause bots
	RI_CMD_PauseCombatBots 1
	ScriptStartTime:Set[${Time.SecondsSinceMidnight}]
	Event[EQ2_onAnnouncement]:AttachAtom[EQ2_onAnnouncementFrillik]
	if ${Fire}
	{
		NoFire:Set[FALSE]
	}
	else
		Event[EQ2_onIncomingText]:AttachAtom[EQ2_onIncomingTextFrillik]
	press x
	if !${caughtstart}
	{
		;target slave and hail him and go through his dialog
		Actor[iksar slave]:DoTarget
		Actor[iksar slave]:DoFace
		wait 3
		eq2ex hail
		wait 3
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 3
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 3
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 3
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		call RIMObj.Move 4.199240 13.058523 65.906937 1 0 TRUE FALSE TRUE FALSE TRUE
		
		while !${CaptainDoneTrigger}
			waitframe
		; while !${Actor[Query, Name="Captain Zythox" && X=4.220000 && Y=12.823201 && Z=62.090000](exists)}
		; {
			; waitframe
			;;echo ${Time}: waiting for captain to be in position
		; }
		; while ${Actor[Query, Name="Captain Zythox" && X=4.220000 && Y=12.823201 && Z=62.090000](exists)}
		; {
			; waitframe
			;;echo ${Time}: waiting for captain to be out of position aka done talking
		; }
		
		call RIMObj.Move -0.356917 12.978796 71.040215 1 0 TRUE FALSE TRUE FALSE TRUE
		;waitfor rat
		while !${RatTrigger}
			waitframe
		; while !${Actor[Query, Name="a hungry bilge rat" && X=-1.370000 && ( Y=12.978795 || Y=12.978796 ) && Z=70.919998](exists)}
		; {
			; waitframe
			;;echo ${Time}: waiting for Killten to be in position 1
		; }
		;;waitfor slave
		; while !${Actor[Query, Name="iksar slave" && X=-2.390000 && Y=12.978795 && Z=71.940002](exists)}
		; {
			; waitframe
			;;echo ${Time}: waiting for slave to be in position by rat
		; }
		wait 20
		;hail slave
		Actor[iksar slave]:DoTarget
		Actor[iksar slave]:DoFace
		wait 3
		eq2ex hail
		wait 3
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 4
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 4
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 4	
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		;hail Killten
		Actor[Killten]:DoTarget
		Actor[Killten]:DoFace
		wait 3
		;hail Killten
		Actor[Killten]:DoTarget
		Actor[Killten]:DoFace
		eq2ex hail
		wait 3
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 4
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 4
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 4
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 4
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 4
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 4
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 4
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 5
		if ${Me.Speed}<75
		{
			if ${Me.Inventory["Totem of the Deadly Sabertooth"].AutoConsumeOn}
				Me.Inventory["Totem of the Deadly Sabertooth"]:ToggleAutoConsume
			wait 5
			if !${Me.Maintained["Totem of the Deadly Sabertooth"](exists)}
				Me.Inventory["Totem of the Deadly Sabertooth"]:Use
			wait 5 ${Me.CastingSpell}
			wait 50 !${Me.CastingSpell}
		}
		; if !${Me.Maintained["Mystic Moppet Disguise"](exists)}
			; Me.Inventory["Mystic Moppet Billy"]:Use
		; wait 5 ${Me.CastingSpell}
		; wait 50 !${Me.CastingSpell}
		call RIMObj.Move -0.361686 12.978795 69.112900 1 0 TRUE FALSE TRUE FALSE TRUE
		while !${Actor[Query, Name="Killten" && X=-1.180000 && Y=12.978796 && Z=67.480003](exists)}
		{
			waitframe
			;echo ${Time}: waiting for Killten to be in position 2
		}
		
		;hail Killten
		Actor[Killten]:DoTarget
		wait 3
		eq2ex hail
		wait 10 (${Actor["Keys"](exists)} && ${Actor["Keys"].HighlightOnMouseHover})
		Actor["Keys"]:DoubleClick
		wait 5 ${Me.CastingSpell}
		wait 50 !${Me.CastingSpell}
	}
	
	call RIMObj.Move -4.229080 13.075517 65.861664 1 0 TRUE FALSE TRUE FALSE TRUE
	
	;wait until the a slaver thats within 20 that is not at loc, 1.760000,12.823201,58.520000 and -1.940000,12.823201,58.520000 is at either -7.900000,12.775447,53.450001 or 8.140000,12.775640,53.459999
	variable int BadSlaver1
	variable int BadSlaver2
	
	BadSlaver1:Set[${Actor[Query, X=1.760000 && Y=12.823201 && Z=58.520000].ID}]
	BadSlaver2:Set[${Actor[Query, X=-1.940000 && Y=12.823201 && Z=58.520000].ID}]
	GoodSlaver:Set[${Actor[Query, Type =="NoKill NPC" && Name =="a slaver" && Distance <= 20 && ID != ${BadSlaver1} && ID != ${BadSlaver2}].ID}]
	variable string WaitLoc
	;Actor[Query, Type =="NoKill NPC" && Name =="a slaver" && Distance <= 20 && ID != ${BadSlaver1} && ID != ${BadSlaver2}]
	; while ${Math.Distance[${Actor[${GoodSlaver}].Loc},-7.900000,12.775447,53.450001]}<1 || ${Math.Distance[${Actor[${GoodSlaver}].Loc},8.140000,12.775640,53.459999]}<1
	; {
		; waitframe
		; echo ${Time}: waiting while she is not moving
	; }
    ; while ${Math.Distance[${Actor[${GoodSlaver}].Loc},-7.900000,12.775447,53.450001]}>1 && ${Math.Distance[${Actor[${GoodSlaver}].Loc},8.140000,12.775640,53.459999]}>1
	; {
		; waitframe
		; echo ${Time}: Waiting till she is in loc
	; }
	;ok now move to the pick
	while ${Actor[${GoodSlaver}].Distance}<10
		waitframe
	NotPastFirstSlaver:Set[TRUE]
	;crouch
	if !${Me.IsCrouching}
		press ${RI_Var_String_CrouchKey}
	;click door
	Actor["Jail Door 2"]:DoubleClick
	wait 10
	call RIMObj.Move -4.329436 12.823201 62.133392 1 0 TRUE FALSE TRUE FALSE TRUE
	Actor["Jail Door 2"]:DoubleClick
	if !${caughtstart}
	{
		call RIMObj.Move -15.784875 13.046762 61.256355 1 0 TRUE FALSE TRUE TRUE TRUE
		call RIMObj.Move -15.737808 12.801471 54.083921 1 0 TRUE FALSE TRUE FALSE TRUE
		;click pick
		while ${Actor["Hook 1"].HighlightOnMouseHover}
		{
			Actor["Hook 1"]:DoubleClick
			wait 2
		}
		NotPastFirstSlaver:Set[TRUE]
		;now wait for her to start moving if she isnt then wait to be stopped again, if she is more than 10 away
		if ${Actor[${GoodSlaver}].Distance}>10
		{
			while ${Math.Distance[${Actor[${GoodSlaver}].Loc},-7.900000,12.775447,53.450001]}<1 || ${Math.Distance[${Actor[${GoodSlaver}].Loc},8.140000,12.775640,53.459999]}<1
			{
				waitframe
				;echo ${Time}: waiting while she is not moving
			}
			while ${Math.Distance[${Actor[${GoodSlaver}].Loc},-7.900000,12.775447,53.450001]}>1 && ${Math.Distance[${Actor[${GoodSlaver}].Loc},8.140000,12.775640,53.459999]}>1
			{
				waitframe
				;echo ${Time}: waiting while she is moving
			}
		}
		else
		{
			;wait while she is closer than 15
			while ${Actor[${GoodSlaver}].Distance}<=10
			{
				waitframe
				;echo ${Time}: Waiting while she is closer than 10
			}
		}
		call RIMObj.Move -14.784875 13.046762 61.256355 1 0 TRUE FALSE TRUE TRUE TRUE
	}
	call RIMObj.Move 15.784875 13.046762 61.256355 1 0 TRUE FALSE TRUE TRUE TRUE
	call RIMObj.Move 14.784875 13.046762 55.256355 1 0 TRUE FALSE TRUE FALSE TRUE
	;wait while she is closer than 10
	while ${Actor[${GoodSlaver}].Distance}<=8
	{
		waitframe
		;echo ${Time}: Waiting while she is closer than 8
	}
	NotPastFirstSlaver:Set[FALSE]
	RI_Var_Bool_PauseMovement:Set[FALSE]
	call RIMObj.Move 14.322284 12.728871 51.427574 1 0 TRUE FALSE TRUE TRUE TRUE
	call RIMObj.Move 13.239384 13.657516 53.919724 1 0 TRUE FALSE TRUE TRUE TRUE
	call RIMObj.Move 12.179470 16.077772 61.031151 1 0 TRUE FALSE TRUE TRUE TRUE
	call RIMObj.Move 3.072405 20.715483 62.643726 1 0 TRUE FALSE TRUE TRUE TRUE
	call RIMObj.Move 3.031507 21.914351 69.082947 1 0 TRUE FALSE TRUE TRUE TRUE
	;;here
	if !${caughtstart}
	{
		call RIMObj.Move -5.369265 21.715471 68.350357 1 0 TRUE FALSE TRUE FALSE TRUE
		wait 2
		while ${Actor["Coiled Rope 1"].HighlightOnMouseHover}
		{
			Actor["Coiled Rope 1"]:DoubleClick
			wait 2
		}
		wait 5 ${Me.CastingSpell}
		wait 50 !${Me.CastingSpell}
		call RIMObj.Move 5.967175 23.853840 76.227226 1 0 TRUE FALSE TRUE FALSE TRUE
		Me.Inventory["a pick"]:Examine
		wait 20 ${ReplyDialog(exists)}
		if ${ReplyDialog(exists)}
			ReplyDialog:Choose[1]
	}
	;tohere
	call RIMObj.Move 5.967175 23.853840 76.227226 1 0 TRUE FALSE TRUE FALSE TRUE
	call RIMObj.Move 3.527576 24.891460 81.401016 1 0 TRUE FALSE TRUE FALSE TRUE
	wait 1
	while ${Actor["Grappling Hook Loc 1"].HighlightOnMouseHover}
	{
		Actor["Grappling Hook Loc 1"]:DoubleClick
		wait 2
	}
	wait 5 ${Me.CastingSpell}
	wait 50 !${Me.CastingSpell}
	wait 10 ${Actor["Rope Lead 1"](exists)}
	Actor["Rope Lead 1"]:DoubleClick
	wait 5 ${Me.CastingSpell}
	wait 50 !${Me.CastingSpell}
	Actor["Hook 2"]:DoubleClick
	while ${Actor["Hook 2"].HighlightOnMouseHover}
	{
		Actor["Hook 2"]:DoubleClick
		wait 2
	}
	wait 5 ${Me.CastingSpell}
	wait 50 !${Me.CastingSpell}
	if !${Me.IsCrouching}
		press ${RI_Var_String_CrouchKey}
	call RIMObj.Move 0.515797 30.161861 72.118927 1 0 TRUE FALSE TRUE TRUE TRUE
	call RIMObj.Move 0.563775 23.810001 47.881618 1 0 TRUE FALSE TRUE TRUE TRUE
	call RIMObj.Move 0.024945 19.774984 31.972771 1 0 TRUE FALSE TRUE FALSE TRUE
	variable int SlaverID
	SlaverID:Set[${Actor[Query,Name=="a slaver" && Y>20.806990].ID}]
	;wait for the slaver to be more than 7 away
	while ${Actor[${SlaverID}].Distance}<=9
;	|| ${Math.Distance[${Actor[${SlaverID}].Loc},-17.423025 21.378036 20.832853]}<20 || ( ${Actor[${SlaverID}].Heading}>90 && ${Actor[${SlaverID}].Heading}<175 )
	{
		waitframe
		;echo ${Time}: waiting for slaver to be more than 7 away, and be more than 20 away from the right side or not be heading in that direction
	}
	press ${RI_Var_String_JumpKey}
	wait 5 ${Me.Y}>21
	press -hold ${RI_Var_String_ForwardKey}
	wait 20 ${Me.Z}<30
	press -release ${RI_Var_String_ForwardKey}
	
	;if her x is less than 0 she is on the right side, greater than 0 she is on the left side
	;90-145 facing right
	;235-320 facing right
	variable bool RightSide
	if ${Actor[${SlaverID}].X}<0
		RightSide:Set[FALSE]
	else
		RightSide:Set[TRUE]
	
	;right side
	if ${RightSide}
	{
		call RIMObj.Move 0.016925 21.482214 25.802683 1 0 TRUE FALSE TRUE FALSE TRUE
		call RIMObj.Move -20.404013 21.286058 25.802683 1 0 TRUE FALSE TRUE FALSE TRUE
		call RIMObj.Move -20.002357 21.285793 14.430608 1 0 TRUE FALSE TRUE TRUE TRUE
		call RIMObj.Move -19.373775 17.781965 7.233285 1 0 TRUE FALSE TRUE TRUE TRUE
		call RIMObj.Move -19.025507 15.425480 0.922158 1 0 TRUE FALSE TRUE TRUE TRUE
		;crouch
		if !${Me.IsCrouching}
			press ${RI_Var_String_CrouchKey}
		call RIMObj.Move -7.268117 11.841710 3.067219 1 0 TRUE FALSE TRUE FALSE TRUE
		wait 50 
		;uncrouch
		if ${Me.IsCrouching}
			press ${RI_Var_String_CrouchKey}
		call RIMObj.Move -4.142550 11.861944 0.408315 1 0 TRUE FALSE TRUE FALSE TRUE
	}
	else
	{
		;left side
		call RIMObj.Move 0.016925 21.482214 25.802683 1 0 TRUE FALSE TRUE FALSE TRUE
		call RIMObj.Move 20.529879 21.140528 25.802683 1 0 TRUE FALSE TRUE FALSE TRUE
		call RIMObj.Move 19.963270 21.313950 14.258084 1 0 TRUE FALSE TRUE TRUE TRUE
		call RIMObj.Move 20.006660 17.782124 8.088594 1 0 TRUE FALSE TRUE TRUE TRUE
		call RIMObj.Move 18.787842 15.304472 1.495919 1 0 TRUE FALSE TRUE TRUE TRUE
		;crouch
		if !${Me.IsCrouching}
			press ${RI_Var_String_CrouchKey}
		call RIMObj.Move 7.900301 11.841710 3.569994 1 0 TRUE FALSE TRUE FALSE TRUE
		wait 50
		;uncrouch
		if ${Me.IsCrouching}
			press ${RI_Var_String_CrouchKey}
		call RIMObj.Move 5.194847 11.850047 0.472899 1 0 TRUE FALSE TRUE TRUE TRUE
		call RIMObj.Move -1.345220 11.863390 0.294330 1 0 TRUE FALSE TRUE FALSE TRUE
	}
	if ${NoFire}
	{
		wait 5
		while ${Actor["Empty Crate 1"].HighlightOnMouseHover} && !${Me.GetGameData[Spells.Casting].Label.Equal["Get in the crate"]}
		{
			Actor["Empty Crate 1"]:DoubleClick
			wait 2
		}
		wait 5 ${Me.CastingSpell}
		wait 50 !${Me.CastingSpell}
		call RIMObj.Move 0.851901 11.005648 1.946329 1 0 TRUE FALSE TRUE TRUE TRUE
		call RIMObj.Move -11.219849 12.749181 16.340488 1 0 TRUE FALSE TRUE TRUE TRUE
		call RIMObj.Move -13.417069 12.749181 20.641178 1 0 TRUE FALSE TRUE TRUE TRUE
		call RIMObj.Move -13.897795 12.749181 26.209665 1 0 TRUE FALSE TRUE TRUE TRUE
		Me.Maintained[Crate Disguise]:Cancel
		call RIMObj.Move 3.109101 12.713674 26.397009 1 0 TRUE FALSE TRUE FALSE TRUE
		call RIMObj.Move 3.109101 12.713674 26.397009 1 0 TRUE FALSE TRUE FALSE TRUE
		wait 5 !${Me.IsMoving}
		wait 2
		while ${Actor["Brew Barrel Strike 1"].HighlightOnMouseHover}
		{
			Actor["Brew Barrel Strike 1"]:DoubleClick
			wait 2
		}
		wait 5 ${Me.CastingSpell}
		wait 50 !${Me.CastingSpell}
		;call RIMObj.Move 4.960749 12.713675 26.364101 1 0 TRUE FALSE TRUE FALSE TRUE
		;wait 5 !${Me.IsMoving}
		wait 20 ${Actor["Brewery Lantern 1"].HighlightOnMouseHover}
		while ${Actor["Brewery Lantern 1"].HighlightOnMouseHover}
		{
			Actor["Brewery Lantern 1"]:DoubleClick
			wait 2
		}
		wait 5 ${Me.CastingSpell}
		wait 50 !${Me.CastingSpell}
		call RIMObj.Move -13.848736 12.749181 26.095110 1 0 TRUE FALSE TRUE FALSE TRUE
		wait 5 !${Me.IsMoving}
		wait 2
		while ${Actor["Empty Crate 1"].HighlightOnMouseHover} && !${Me.GetGameData[Spells.Casting].Label.Equal["Get in the crate"]}
		{
			Actor["Empty Crate 1"]:DoubleClick
			wait 2
		}
		wait 5 ${Me.CastingSpell}
		wait 50 !${Me.CastingSpell}
		;wait 100
		call RIMObj.Move -11.250031 12.749182 15.083492 1 0 TRUE FALSE TRUE TRUE TRUE
		call RIMObj.Move 0.027929 12.089749 5.387205 1 0 TRUE FALSE TRUE TRUE TRUE
	}
	
	call RIMObj.Move -4.642479 12.232176 -26.550085 1 0 TRUE FALSE TRUE TRUE TRUE
	call RIMObj.Move -0.357533 12.170499 -41.523327 1 0 TRUE FALSE TRUE FALSE TRUE
	if !${Me.IsCrouching}
		press ${RI_Var_String_CrouchKey}
	;set movebehind a slaver
	variable int HeadSlaverID
	HeadSlaverID:Set[${Actor["a slaver"].ID}]
	
	while !${Me.GetGameData[Spells.Casting].Label.Equal["Take head gear"]}
	{
		while ${Math.Distance[${Actor[${HeadSlaverID}].Loc},8.070000,12.108114,-46.770000]}>3 && ${Math.Distance[${Actor[${HeadSlaverID}].Loc},-7.410000,12.108114,-53.660000]}>3 && ${Math.Distance[${Actor[${HeadSlaverID}].Loc},-5.390000,12.108114,-64.260002]}>3 && ${Math.Distance[${Actor[${HeadSlaverID}].Loc},4.640000,12.108114,-64.790001]}>3
		{
			waitframe
			;echo ${Time}: waiting while the slaver is not in position
		}
		;he's at SW
		if ${Math.Distance[${Actor[${HeadSlaverID}].Loc},8.070000,12.108114,-46.770000]}<3
		{
			call RIMObj.Move 7.070000 12.108114 -46.770000 1 0 TRUE FALSE TRUE FALSE TRUE
		}
		;he's at SE
		if ${Math.Distance[${Actor[${HeadSlaverID}].Loc},-7.410000,12.108114,-53.660000]}<3
		{
			call RIMObj.Move -7.410000 12.108114 -51.660000 1 0 TRUE FALSE TRUE FALSE TRUE
		}
		;he's at NE
		if ${Math.Distance[${Actor[${HeadSlaverID}].Loc},-5.390000,12.108114,-64.260002]}<3
		{
			call RIMObj.Move -5.390000 12.108114 -62.260002 1 0 TRUE FALSE TRUE FALSE TRUE
		}
		;he's at NW
		if ${Math.Distance[${Actor[${HeadSlaverID}].Loc},-5.390000,12.108114,-64.260002]}<3
		{
			call RIMObj.Move 6.070000 12.108114 -46.770000 1 0 TRUE FALSE TRUE FALSE TRUE
			call RIMObj.Move -5.390000 12.108114 -62.260002 1 0 TRUE FALSE TRUE FALSE TRUE
		}
		; while ${Actor[${HeadSlaverID}].Distance}>5 || ${Actor[${HeadSlaverID}].IsMoving}
		; {
			; waitframe
			; echo ${Time}: waiting until we are closer than 5
		; }
		while !${Me.GetGameData[Spells.Casting].Label.Equal["Knock out the slaver"]}
		{	
			if ${Actor[${HeadSlaverID}].Distance}<10 && !${Me.GetGameData[Spells.Casting].Label.Equal["Knock out the slaver"]}
				eq2ex apply_verb ${HeadSlaverID} "Knock out the slaver"
			wait 5 ${Me.GetGameData[Spells.Casting].Label.Equal["Knock out the slaver"]}
		}
		wait 5 ${Me.CastingSpell}
		wait 50 !${Me.CastingSpell}
		wait 50 ( ${Actor["Player Head Gear"](exists)} && ${Actor["Player Head Gear"].HighlightOnMouseHover} )
		call RIMObj.Move ${Actor["Player Head Gear"].X} ${Actor["Player Head Gear"].Y} ${Actor["Player Head Gear"].Z} 2 0 TRUE FALSE TRUE FALSE TRUE
		wait 50 ${Actor["Player Head Gear"].HighlightOnMouseHover}
		while ${Actor["Player Head Gear"].HighlightOnMouseHover} && !${Me.GetGameData[Spells.Casting].Label.Equal["Take head gear"]}
		{
			Actor["Player Head Gear"]:DoubleClick
			wait 2
		}
		wait 5 ${Me.CastingSpell}
		wait 50 !${Me.CastingSpell}
	}
	if ${Me.IsCrouching}
		press ${RI_Var_String_CrouchKey}
	if ${Math.Distance[${Me.Loc},-6.812572,12.108113,-62.804375]}<5
		call RIMObj.Move -5.723879 12.108114 -49.875088 1 0 TRUE FALSE TRUE TRUE TRUE
	if ${Math.Distance[${Me.Loc},6.049448,12.108114,-63.603703]}<5
		call RIMObj.Move 5.917499 12.108114 -50.097019 1 0 TRUE FALSE TRUE TRUE TRUE
	call RIMObj.Move -0.357533 12.170499 -41.523327 1 0 TRUE FALSE TRUE TRUE TRUE
	;;;;;
	
	call RIMObj.Move 9.667832 11.845428 1.366835 1 0 TRUE FALSE TRUE TRUE TRUE
	call RIMObj.Move 19.379438 15.353472 1.437072 1 0 TRUE FALSE TRUE TRUE TRUE
	call RIMObj.Move 19.024715 17.781967 11.507267 1 0 TRUE FALSE TRUE TRUE TRUE
	call RIMObj.Move 5.839572 21.017689 11.064613 1 0 TRUE FALSE TRUE TRUE TRUE
	call RIMObj.Move 9.604992 21.346867 19.345922 1 0 TRUE FALSE TRUE TRUE TRUE
	call RIMObj.Move 21.881687 21.341799 19.104168 1 0 TRUE FALSE TRUE FALSE TRUE
	wait 5 !${Me.IsMoving}
	wait 2
	Actor["Rigging"]:DoubleClick
	wait 5 ${Me.CastingSpell}
	wait 50 !${Me.CastingSpell}
	wait 10
	Actor["Crows Nest Tight Rope"]:DoubleClick
	wait 5 ${Me.CastingSpell}
	wait 50 !${Me.CastingSpell}
	wait 10
	Me.Ability[Sprint]:Use
	Me.Ability[Sprint]:Use
	call RIMObj.Move -0.053792 101.689331 -18.892773 1 0 TRUE FALSE TRUE FALSE TRUE
	Me.Maintained[Sprint]:Cancel
	; jump part
	; press ${RI_Var_String_JumpKey}
	; wait 5 
	;;;${Me.Y}>21
	; press -hold ${RI_Var_String_ForwardKey}
	; wait 5 
	;;;${Me.Z}<30
	; press -release ${RI_Var_String_ForwardKey}
	wait 5 !${Me.IsMoving}
	wait 5
	Actor["Zipline Start 1"]:DoubleClick
	wait 5 ${Me.CastingSpell}
	wait 50 !${Me.CastingSpell}
	wait 50
	;wait 30
	Actor["Zipline Start 2"]:DoubleClick
	wait 5 ${Me.CastingSpell}
	wait 50 !${Me.CastingSpell}
	wait 50
	;wait 2
	while !${Actor["Cannonball sign"].HighlightOnMouseHover}
		waitframe
	Actor["Cannonball sign"]:DoubleClick
	wait 5 ${Me.CastingSpell}
	wait 50 !${Me.CastingSpell}

	call RIMObj.Move 2.586564 48.929527 -103.580338 1 0 TRUE FALSE TRUE FALSE TRUE
	while !${Actor["Cannonball drop"](exists)}
	{
		waitframe
		;echo ${Time}: waiting for Cannonball drop
	}
	Actor["Cannonball drop"]:DoubleClick
	wait 5 ${Me.CastingSpell}
	wait 50 !${Me.CastingSpell}
	wait 5
	;jump part
	press ${RI_Var_String_JumpKey}
	wait 5 ${Me.Y}>49
	press -hold ${RI_Var_String_ForwardKey}
	wait 5 
	;${Me.Z}<30
	press -release ${RI_Var_String_ForwardKey}
	wait 2
	call RIMObj.Move 2.379748 50.103252 -100.839066 1 0 TRUE FALSE TRUE TRUE TRUE
	call RIMObj.Move 1.407784 34.368313 -95.783409 1 0 TRUE FALSE TRUE FALSE TRUE
	if ${Me.Y}>40
		call RIMObj.Move 1.407784 34.368313 -95.783409 1 0 TRUE FALSE TRUE FALSE TRUE
	wait 50 ${Actor["a K.O.d Captain Zythox"](exists)}
	echo moving to zythox
	call RIMObj.Move ${Actor["a K.O.d Captain Zythox"].X} ${Actor["a K.O.d Captain Zythox"].Y} ${Actor["a K.O.d Captain Zythox"].Z} 1 0 TRUE FALSE TRUE FALSE TRUE
	Actor["a K.O.d Captain Zythox"]:DoubleClick
	wait 5 ${Me.CastingSpell}
	wait 50 !${Me.CastingSpell}
	wait 10 ${Actor["Grappling Hook Loc 2"](exists)}
	Actor["Grappling Hook Loc 2"]:DoubleClick
	wait 5 ${Me.CastingSpell}
	wait 50 !${Me.CastingSpell}
	wait 10 ${Actor["Rope Lead 2"](exists)}
	Actor["Rope Lead 2"]:DoubleClick
	wait 5 ${Me.CastingSpell}
	wait 50 !${Me.CastingSpell}
	wait 10 ${Me.Y}>50

	call RIMObj.Move 14.407750 51.040039 -113.536392 1 0 TRUE FALSE TRUE FALSE TRUE
	wait 2
	Actor["Barrel"]:DoubleClick
	wait 5 ${Me.CastingSpell}
	wait 50 !${Me.CastingSpell}
	wait 50 ${Actor["cannon"](exists)} && ${Actor["cannon"].HighlightOnMouseHover}
	while ${Actor["cannon"].HighlightOnMouseHover} && !${Me.GetGameData[Spells.Casting].Label.Equal["Light the cannon's fuse"]}
	{
		Actor["cannon"]:DoubleClick
		wait 2
	}
	wait 5 ${Me.CastingSpell}
	wait 50 !${Me.CastingSpell}	
	;unpause bots
	RI_CMD_PauseCombatBots 0
	Script:End
}

;atom triggered when an announcement is detected
atom EQ2_onAnnouncementFrillik(string Message, string SoundType, float Timer)
{
	if ${RI_Var_Bool_Debug}
		echo ${Time}:AnnounceText: ${Message}
	;if ${AnnounceText} exists in the announce, execute
	if ${Message.Find["Hold still!"](exists)}
	{
		RI_Var_Bool_PauseMovement:Set[TRUE]
		TimedCommand 125 RI_Var_Bool_PauseMovement:Set[FALSE]
	}
	if ${Message.Find["The winds pick up!"](exists)}
	{
		ropecount:Inc
		if ${ropecount}>1
		{
			RI_Var_Bool_PauseMovement:Set[TRUE]
			Actor["Tight Rope"]:DoubleClick
			TimedCommand 5 Actor["Tight Rope"]:DoubleClick
			TimedCommand 10 Actor["Tight Rope"]:DoubleClick
			TimedCommand 15 Actor["Tight Rope"]:DoubleClick
			TimedCommand 30 RI_Var_Bool_PauseMovement:Set[FALSE]
		}
	}
}
;atom triggered when incommingtext is detected
atom EQ2_onIncomingTextFrillik(string Text)
{
	
   	if ${Text.Find["Can just run across this now"](exists)}
	{	
		if ${RI_Var_Bool_Debug}
			echo ${Time}:IncomingText: ${Text}
		NoFire:Set[FALSE]
	}
	if ${Text.Find["Welcome to The Frillik Tide."](exists)}
		CaptainDoneTrigger:Set[TRUE]
	if ${Text.Find["orry little guy, I've got no leftovers for you. They haven't fed us yet."](exists)}
		RatTrigger:Set[TRUE]
}

;;;;;;;;;;;;;;;; End Frillik Tide ;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;; Start The Lost City of Torsis: The Shrouded Temple ;;;;;;;;;;;;;;;;;;;;;;

function Haze()
{
	echo ISXRI: Starting Haze
	"RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Open Wounds,0]"
	variable int MirageID
	variable string FORKEAST
	variable string FORKWEST
	variable string TEMPFORKEAST
	variable string TEMPFORKWEST
	variable int LowestIndexEAST
	variable float LowestDistanceEAST
	variable float LowestDistanceEASTY
	variable int EastCount
	variable int LowestIndexWEST
	variable float LowestDistanceWEST
	variable float LowestDistanceWESTY
	variable int WestCount
	variable bool InFork
	variable bool Skip100NotChecked
	variable index:string EAST
	variable index:string WEST
	variable int MirageTime
	variable index:actor Mirages
	variable int count
	variable int ClosestMirageIndex
	variable float ClosestMirageDistance
	variable float FurthestAwayGroupMemberDistance
	AnnounceText:Clear
	AnnounceText:Insert["A mirage of yourself has appeared somewhere within the fog. Find and destroy it!"]
	
	if !${UIElement[SettingsSkipMobAttackHealthCheckBox@SettingsFrame@CombatBotUI].Checked}
	{
		Skip100NotChecked:Set[TRUE]
		UIElement[SettingsSkipMobAttackHealthCheckBox@SettingsFrame@CombatBotUI]:SetChecked
	}

	;build our indexs
	
	EAST:Insert[-184.900620 3.612629 -364.686615]
	EAST:Insert[-194.956909 3.306251 -364.575867]
	EAST:Insert[-205.104218 3.306251 -364.647430]
	EAST:Insert[-215.199051 3.306250 -364.718536]
	EAST:Insert[-220.535233 3.306250 -364.756134]
	EAST:Insert[FORK-EASTBEFOREGAZEBO]
	EAST:Insert[-219.030350 3.306250 -374.856537]
	EAST:Insert[-218.281342 3.306251 -381.889343]
	;EAST:Insert[FORK-EASTGAZEBO]
	;EAST:Insert[-207.951309 4.135114 -381.914734]
	;EAST:Insert[-198.013779 4.518423 -382.002441]
	;EAST:Insert[-208.215393 4.135114 -381.602966]
	;EAST:Insert[-218.766663 3.306250 -381.189087]
	;EAST:Insert[FORK-EASTGAZEBO]
	EAST:Insert[-212.670303 3.306251 -392.940247]
	EAST:Insert[-207.310638 3.306251 -398.006958]
	EAST:Insert[-197.309418 3.306251 -397.697906]
	EAST:Insert[-187.114639 3.306251 -397.737091]
	EAST:Insert[-183.444656 3.306251 -397.751190]
	EAST:Insert[-193.575775 3.306251 -397.669739]
	EAST:Insert[-203.534485 3.306251 -396.301025]
	EAST:Insert[-212.897644 3.306251 -392.735840]
	EAST:Insert[-213.567032 3.306251 -392.369232]
	EAST:Insert[-219.926682 3.306251 -384.641052]
	EAST:Insert[-220.418381 3.306249 -374.929169]
	EAST:Insert[-220.908432 3.306250 -364.141113]
	EAST:Insert[FORK-EASTBEFOREGAZEBO]
	EAST:Insert[-220.810730 3.306250 -364.678741]
	EAST:Insert[-223.708649 3.306250 -354.998505]
	EAST:Insert[-226.596115 3.306249 -345.353363]
	EAST:Insert[-229.457214 3.306249 -335.427063]
	EAST:Insert[-231.543060 3.306249 -325.390289]
	EAST:Insert[-233.033386 3.306249 -315.072266]
	EAST:Insert[-233.943161 3.306249 -305.034271]
	EAST:Insert[-234.601501 3.306250 -294.865417]
	EAST:Insert[FORK-EASTLAKE]
	EAST:Insert[-234.692596 3.306250 -293.419312]
	EAST:Insert[-243.206284 3.306248 -288.051788]
	EAST:Insert[-251.709930 3.306247 -282.690765]
	EAST:Insert[-260.288147 3.534184 -277.468079]
	EAST:Insert[-269.453064 2.750447 -273.214722]
	EAST:Insert[-276.199860 2.190441 -265.812927]
	EAST:Insert[-279.262634 2.189841 -260.235016]
	EAST:Insert[-272.360413 2.190678 -267.973755]
	EAST:Insert[-265.548828 3.534047 -275.413086]
	EAST:Insert[-258.253906 3.306247 -282.418152]
	EAST:Insert[-249.842148 3.306248 -288.136597]
	EAST:Insert[-240.274551 3.306249 -291.741608]
	EAST:Insert[FORK-EASTLAKE]
	EAST:Insert[-234.691788 3.306250 -293.591156]
	EAST:Insert[-229.991470 3.306250 -284.473785]
	EAST:Insert[-225.003906 3.306250 -275.527679]
	EAST:Insert[-219.350845 3.306250 -267.029358]
	EAST:Insert[FORK-EASTAFTERSTAIRS]
	EAST:Insert[-219.018509 3.306250 -266.534241]
	EAST:Insert[-218.741196 3.306250 -256.338409]
	EAST:Insert[-218.461853 3.306249 -246.068954]
	EAST:Insert[-218.168900 3.306249 -235.804337]
	EAST:Insert[-216.751068 3.306248 -226.197784]
	EAST:Insert[-215.776993 3.306249 -230.267578]
	EAST:Insert[-217.884109 3.306249 -240.197372]
	EAST:Insert[-219.270035 3.306249 -250.178574]
	EAST:Insert[-220.034683 3.306250 -260.353088]
	EAST:Insert[FORK-EASTAFTERSTAIRS]
	EAST:Insert[-219.699127 3.306250 -266.466675]
	EAST:Insert[-210.141830 3.306251 -269.480713]
	EAST:Insert[-200.599487 4.895166 -272.781799]
	EAST:Insert[-193.621719 4.895164 -276.037079]
	EAST:Insert[-194.216873 9.137593 -285.146606]
	EAST:Insert[-194.439011 9.857175 -290.442902]
	EAST:Insert[-184.820724 13.664171 -289.187836]
	EAST:Insert[-177.427414 14.870481 -288.808838]
	EAST:Insert[-178.150162 18.968010 -298.267059]
	EAST:Insert[-178.195328 23.724838 -307.433624]
	EAST:Insert[-178.169800 28.305532 -316.362366]
	EAST:Insert[-178.379135 29.526823 -326.497223]
	EAST:Insert[-178.573776 29.526823 -329.877899]
	EAST:Insert[-188.569244 29.526823 -330.187866]
	EAST:Insert[-197.800659 25.591040 -330.006805]
	EAST:Insert[-206.620316 20.555073 -330.032135]
	EAST:Insert[-214.841553 16.681242 -329.867188]
	EAST:Insert[-214.656174 16.195103 -323.303619]
	EAST:Insert[-218.415298 16.194664 -323.364746]

	WEST:Insert[-169.494110 3.306249 -362.992065]
	WEST:Insert[-159.638275 3.306249 -364.886169]
	WEST:Insert[-149.686508 3.306247 -366.368561]
	WEST:Insert[-142.328522 3.306248 -362.892944]
	WEST:Insert[FORK-WESTBEFOREGAZEBO]
	WEST:Insert[-142.539566 3.306247 -373.065643]
	WEST:Insert[-142.776260 3.306249 -382.577484]
	;WEST:Insert[FORK-WESTGAZEBO]
	;WEST:Insert[-151.396988 4.516153 -382.186340]
	;WEST:Insert[-157.731186 4.518423 -381.839630]
	;WEST:Insert[-147.649902 3.698921 -381.663879]
	;WEST:Insert[-143.074890 3.306248 -382.388855]
	;WEST:Insert[FORK-WESTGAZEBO]
	WEST:Insert[-144.985733 3.306250 -392.557098]
	WEST:Insert[-146.842133 3.306251 -401.334991]
	WEST:Insert[-157.074463 3.306251 -400.599487]
	WEST:Insert[-167.082352 3.306251 -399.934357]
	WEST:Insert[-169.450470 3.306251 -399.795288]
	WEST:Insert[-159.281952 3.306251 -399.257324]
	WEST:Insert[-149.013321 3.306251 -398.261169]
	WEST:Insert[-142.251404 3.306249 -390.666626]
	WEST:Insert[-140.859482 3.306248 -380.708313]
	WEST:Insert[-140.537918 3.306247 -370.634827]
	WEST:Insert[-142.776917 3.306248 -362.662964]
	WEST:Insert[FORK-WESTBEFOREGAZEBO]
	WEST:Insert[-143.223312 3.306248 -362.513214]
	WEST:Insert[-139.090698 3.306251 -353.196198]
	WEST:Insert[-135.052887 3.306251 -343.736481]
	WEST:Insert[-130.665024 3.306251 -334.597076]
	WEST:Insert[-125.287148 3.306251 -326.165680]
	WEST:Insert[-121.943123 3.306249 -316.383789]
	WEST:Insert[-124.056190 3.306248 -306.368164]
	WEST:Insert[-127.781219 3.306250 -296.742828]
	WEST:Insert[-133.032715 3.306251 -287.774536]
	WEST:Insert[-138.080887 3.306251 -279.141296]
	WEST:Insert[-142.635818 3.306251 -270.238739]
	WEST:Insert[FORK-WESTAFTERSTAIRS]
	WEST:Insert[-145.002197 3.306251 -265.312347]
	WEST:Insert[-144.940002 3.306250 -255.027435]
	WEST:Insert[-145.346848 3.306249 -244.824814]
	WEST:Insert[-145.680786 3.306249 -234.782166]
	WEST:Insert[-145.817612 3.306248 -224.656219]
	WEST:Insert[-145.840042 3.306248 -221.159790]
	WEST:Insert[-145.046371 3.306248 -231.367981]
	WEST:Insert[-144.899597 3.306249 -241.373047]
	WEST:Insert[-144.958694 3.306250 -251.562958]
	WEST:Insert[-145.071259 3.306250 -261.689575]
	WEST:Insert[FORK-WESTAFTERSTAIRS]
	WEST:Insert[-145.090805 3.306251 -265.271820]
	WEST:Insert[-154.602722 4.210486 -268.871307]
	WEST:Insert[-162.428482 4.895164 -275.095703]
	WEST:Insert[-162.662796 4.893470 -275.669159]
	WEST:Insert[-162.085052 9.113820 -285.017639]
	WEST:Insert[-162.005096 9.857175 -289.881775]
	WEST:Insert[-171.278732 13.723725 -289.502808]
	WEST:Insert[-178.669159 14.870481 -289.474213]
	WEST:Insert[-178.061279 19.126575 -298.607574]
	WEST:Insert[-177.964798 24.003613 -307.975311]
	WEST:Insert[-177.991364 28.604815 -316.936676]
	WEST:Insert[-178.010315 29.526823 -327.126953]
	WEST:Insert[-178.002167 29.526823 -330.293213]
	WEST:Insert[-167.825531 29.526823 -330.135284]
	WEST:Insert[-158.279587 25.681774 -329.912537]
	WEST:Insert[-149.511292 20.555073 -329.668304]
	WEST:Insert[-141.315063 16.681242 -329.419006]
	WEST:Insert[-141.583588 16.194313 -322.180115]
	WEST:Insert[-137.334915 16.194410 -323.101532]
	
	RI_Atom_SetLockSpot ${Me.Name} -177.866241 3.306249 -359.220947
			
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, Name=="The Meld of Haze" && IsDead=FALSE]:DoTarget
	
		while ${Actor[Query, Name="The Meld of Haze"].Distance}>9
			wait 2
		wait 5
		RI_Atom_SetLockSpot ${Me.Name} -178.779922 3.612629 -369.184631
	}
	
	while ( ${Actor[Query, Name="The Meld of Haze" && IsDead=FALSE](exists)} || ${Me.InCombat} || ${Me.IsDead} )
	{
		waitframe
		FORKEAST:Set[NONE]
		TEMPFORKEAST:Set[NONE]
		FORKWEST:Set[NONE]
		TEMPFORKWEST:Set[NONE]
		InFork:Set[FALSE]
		
		while !${Actor[Query,Name=="${Me.Name}'s mirage"](exists)} && !${Trigger} && ${Actor[Query, Name="The Meld of Haze" && IsDead=FALSE](exists)}
		{
			if !${RI_Var_Bool_GlobalOthers}
			{
				if ${Actor[Query, Name=="a haze hunter" && IsDead=FALSE](exists)}
				{
					if ${Target.ID}!=${Actor[Query, Name=="a haze hunter" && IsDead=FALSE].ID}
						Actor[Query, Name=="a haze hunter" && IsDead=FALSE]:DoTarget
				}
				else
				{
					if ${Target.ID}!=${Actor[Query, Name=="The Meld of Haze" && IsDead=FALSE].ID}
						Actor[Query, Name=="The Meld of Haze" && IsDead=FALSE]:DoTarget
				}
			}
			if ${Me.Maintained[Sprint](exists)}
				Me.Maintained[Sprint]:Cancel
			waitframe
		}
		MirageTime:Set[${Script.RunningTime}]

		wait 100 ${Trigger}
		Trigger:Set[FALSE]
		wait 10
		
		;get ID of our Mirage, if we cant find, return
		MirageID:Set[${Actor[Query,Name=="${Me.Name}'s mirage"].ID}]
		if ${MirageID}==0
		{
			;echo ISXRI: We are unable to find our Mirage, Please ensure your redering distance in game is set to at least 200 (recommend 1000)
			;wait ${Math.Calc[(${Math.Calc[${MirageTime}+41000]}-${Script.RunningTime})/100]} ${Actor[Query, Name="The Meld of Haze" && IsDead=FALSE](exists)}
			wait 50
			continue
		}

		;put all mirage's into an index
		EQ2:QueryActors[Mirages, Name=-"mirage"]
		;echo MirageCount: ${Mirages.Used}
		;find the closest mirage
		ClosestMirageDistance:Set[1000]
		ClosestMirageIndex:Set[0]
		for(count:Set[1];${count}<=${Mirages.Used};count:Inc)
		{
			if ${Math.Distance[${Mirages.Get[${count}].Loc},-177.866241,3.306249,-359.220947]}<${ClosestMirageDistance}
			{
				ClosestMirageDistance:Set[${Math.Distance[${Mirages.Get[${count}].Loc},-177.866241,3.306249,-359.220947]}]
				ClosestMirageIndex:Set[${count}]
			}
		}
		
		;echo my Mirage is AT: ${Actor[Query, ID=${MirageID}].Loc}
			
		;turn off assisting
		RI_CMD_Assisting 0
		
		RI_Atom_SetLockSpot OFF
		RI_Atom_SetRIFollow OFF
		
		;target self
		Actor[${Me.ID}]:DoTarget
		
		;check for ${Math.Distance[${Actor[${Me}Mirage].Loc},${EAST.Get[${EastCount}]}]} to find the lowest
		LowestIndexEAST:Set[0]
		LowestDistanceEAST:Set[500]
		LowestDistanceEASTY:Set[3]
		
		for(EastCount:Set[1];${EastCount}<=${EAST.Used};EastCount:Inc)
		{
			if ${EAST.Get[${EastCount}].Find[FORK-](exists)}
			{
				if ${TEMPFORKEAST.NotEqual[${EAST.Get[${EastCount}]}]}
					TEMPFORKEAST:Set[${EAST.Get[${EastCount}]}]
				else
					TEMPFORKEAST:Set[NONE]
				continue
			}
			;echo ${LowestDistanceEASTY} // ${Math.Distance[${Actor[Query, ID=${MirageID}].Y},${EAST.Get[${EASTCount}].Replace[" ",","].Token[2,","]}]}<5
			;echo checking if ${Math.Distance[${Actor[Query, ID=${MirageID}].Loc},${EAST.Get[${EastCount}].Replace[" ",","]}]}<${LowestDistanceEAST}
			if ${Math.Distance[${Actor[Query, ID=${MirageID}].Loc},${EAST.Get[${EastCount}].Replace[" ",","]}]}<${LowestDistanceEAST}
			{
				 ; if ${Math.Distance[${Actor[Query, ID=${MirageID}].Y},16]}<3 && ${Math.Distance[16,${EAST.Get[${EASTCount}].Replace[" ",","].Token[2,","]}]}>3
					; return
				 
				;echo it is lower
				LowestDistanceEAST:Set[${Math.Distance[${Actor[Query, ID=${MirageID}].Loc},${EAST.Get[${EastCount}].Replace[" ",","]}]}]
				LowestDistanceEASTY:Set[${EAST.Get[${EastCount}].Replace[" ",","].Token[2,","]}]
				LowestIndexEAST:Set[${EastCount}]
				if ${TEMPFORKEAST.NotEqual[NONE]}
					FORKEAST:Set[${TEMPFORKEAST}]
				else
					FORKEAST:Set[NONE]
			}
		}
		
		;check for ${Math.Distance[${Actor[${Me}Mirage].Loc},${WEST.Get[${WestCount}]}]} to find the lowest
		LowestIndexWEST:Set[0]
		LowestDistanceWEST:Set[500]
		LowestDistanceWESTY:Set[3]
		
		for(WestCount:Set[1];${WestCount}<=${WEST.Used};WestCount:Inc)
		{
			if ${WEST.Get[${WestCount}].Find[FORK-](exists)}
			{
				if ${TEMPFORKWEST.NotEqual[${WEST.Get[${WestCount}]}]}
					TEMPFORKWEST:Set[${WEST.Get[${WestCount}]}]
				else
					TEMPFORKWEST:Set[NONE]
				continue
			}
			;echo ${LowestDistanceWESTY} // ${Math.Distance[${Actor[Query, ID=${MirageID}].Y},${WEST.Get[${WestCount}].Replace[" ",","].Token[2,","]}]}<5
			;echo checking if ${Math.Distance[${Actor[Query, ID=${MirageID}].Loc},${WEST.Get[${WestCount}].Replace[" ",","]}]}<${LowestDistanceWEST}
			if ${Math.Distance[${Actor[Query, ID=${MirageID}].Loc},${WEST.Get[${WestCount}].Replace[" ",","]}]}<${LowestDistanceWEST}
			{
				; if ${Math.Distance[${Actor[Query, ID=${MirageID}].Y},16]}<3 && ${Math.Distance[16,${WEST.Get[${WESTCount}].Replace[" ",","].Token[2,","]}]}>3
					; return
				;echo it is lower
				LowestDistanceWEST:Set[${Math.Distance[${Actor[Query, ID=${MirageID}].Loc},${WEST.Get[${WestCount}].Replace[" ",","]}]}]
				LowestDistanceWESTY:Set[${WEST.Get[${WestCount}].Replace[" ",","].Token[2,","]}]
				LowestIndexWEST:Set[${WestCount}]
				if ${TEMPFORKWEST.NotEqual[NONE]}
					FORKWEST:Set[${TEMPFORKWEST}]
				else
					FORKWEST:Set[NONE]
			}
		}
		
		;see if we should be going east
		if ${LowestDistanceEAST}<${LowestDistanceWEST}
		{
			;go east up to LowestIndexEAST
			for(EastCount:Set[1];${EastCount}<=${LowestIndexEAST};EastCount:Inc)
			{
				if ${EAST.Get[${EastCount}].Find[FORK-](exists)}
				{
					if ${TEMPFORKEAST.NotEqual[${EAST.Get[${EastCount}]}]}
					{
						TEMPFORKEAST:Set[${EAST.Get[${EastCount}]}]
						InFork:Set[TRUE]
					}
					else
					{
						TEMPFORKEAST:Set[NONE]
						InFork:Set[FALSE]
					}
					continue
				}

				if ${InFork} && ${FORKEAST.NotEqual[${TEMPFORKEAST}]}
					continue

				call RIMObj.Move ${EAST.Get[${EastCount}]} 1 0 FALSE FALSE TRUE TRUE
				waitframe
			}
			;goto our mirage and kill
			
			call RIMObj.Move ${Actor[Query, ID=${MirageID}].X} ${Actor[Query, ID=${MirageID}].Y} ${Actor[Query, ID=${MirageID}].Z} 1 0 FALSE FALSE TRUE FALSE

			;if my mirage is the closest, wait until everyone else is done killing
			if ${Mirages.Get[${ClosestMirageIndex}].Name.Find[${Me.Name}](exists)}
			{
				if ${Target.ID}!=${Me.ID}
					Actor[id,${Me.ID}]:DoTarget
				FurthestAwayGroupMemberDistance:Set[${Math.Distance[${Actor[id,${MirageID}].Loc},-177.866241,3.306249,-359.220947]}]
				;echo ISXRI: MyMirage is the closest waiting
				while ${Mirages.Used}>1
				{
					if ${Target.ID}!=${Me.ID}
						Actor[id,${Me.ID}]:DoTarget
					wait 10
					EQ2:QueryActors[Mirages, Name=-"mirage"]
				}
				;now wait until the furthest away groupmember is closer than my mirage
				while ${FurthestAwayGroupMemberDistance}>=${Math.Distance[${Actor[id,${MirageID}].Loc},-177.866241,3.306249,-359.220947]} && ${Math.Calc[(${Script.RunningTime}-${MirageTime})/100]}<400
				{
					FurthestAwayGroupMemberDistance:Set[0]
					;now get and set the furthest away groupmembers distance
					for(count:Set[1];${count}<${Me.Group};count:Inc)
					{
						;echo ${count}: ${Me.Group[${count}].Name}: ${Math.Distance[${Me.Group[${count}].Loc},-177.866241,3.306249,-359.220947]}
						if ${Math.Distance[${Me.Group[${count}].Loc},-177.866241,3.306249,-359.220947]}>${FurthestAwayGroupMemberDistance}
							FurthestAwayGroupMemberDistance:Set[${Math.Distance[${Me.Group[${count}].Loc},-177.866241,3.306249,-359.220947]}]
					}
					wait 1
					if ${Target.ID}!=${Me.ID}
						Actor[id,${Me.ID}]:DoTarget
					;echo ${FurthestAwayGroupMemberDistance}>=${Math.Distance[${Actor[id,${MirageID}].Loc},-177.866241,3.306249,-359.220947]}
					;echo ${Math.Calc[(${Script.RunningTime}-${MirageTime})/100]}
				}
			}
			
			while ${Actor[Query, ID=${MirageID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${MirageID}
					Actor[Query, ID=${MirageID} && IsDead=FALSE]:DoTarget
				waitframe
			}
			if !${Me.Maintained[Sprint](exists)}
				Me.Ability[Sprint]:Use
			;go backwards east to 1 from LowestIndexEAST
			;go east down to LowestIndexEAST
			for(EastCount:Set[${LowestIndexEAST}];${EastCount}>=1;EastCount:Dec)
			{
				if ${EAST.Get[${EastCount}].Find[FORK-](exists)}
				{
					if ${TEMPFORKEAST.NotEqual[${EAST.Get[${EastCount}]}]}
					{
						TEMPFORKEAST:Set[${EAST.Get[${EastCount}]}]
						InFork:Set[TRUE]
					}
					else
					{
						TEMPFORKEAST:Set[NONE]
						InFork:Set[FALSE]
					}
					continue
				}
				if ${InFork} && ${FORKEAST.NotEqual[${TEMPFORKEAST}]}
					continue
				call RIMObj.Move ${EAST.Get[${EastCount}]} 1 0 FALSE FALSE TRUE TRUE
				if !${Me.Maintained[Sprint](exists)}
					Me.Ability[Sprint]:Use
				waitframe
			}
			
			RI_Atom_SetLockSpot ${Me.Name} -177.866241 3.306249 -359.220947
			
			if !${RI_Var_Bool_GlobalOthers}
			{
				while ${Actor[Query, Name="The Meld of Haze"].Distance}>9
					wait 2
				wait 5
				RI_Atom_SetLockSpot ${Me.Name} -178.729904 3.612629 -369.953461
			}
		}
		;else west
		else
		{
			;go west up to LowestIndexWEST
			for(WestCount:Set[1];${WestCount}<=${LowestIndexWEST};WestCount:Inc)
			{
				if ${WEST.Get[${WestCount}].Find[FORK-](exists)}
				{
					if ${TEMPFORKWEST.NotEqual[${WEST.Get[${WestCount}]}]}
					{
						TEMPFORKWEST:Set[${WEST.Get[${WestCount}]}]
						InFork:Set[TRUE]
					}
					else
					{
						InFork:Set[FALSE]
						TEMPFORKWEST:Set[NONE]
					}
					continue
				}
				if ${InFork} && ${FORKWEST.NotEqual[${TEMPFORKWEST}]}
					continue
				call RIMObj.Move ${WEST.Get[${WestCount}]} 1 0 FALSE FALSE TRUE TRUE
				waitframe
			}
			;goto our mirage and kill
			
			call RIMObj.Move ${Actor[Query, ID=${MirageID}].X} ${Actor[Query, ID=${MirageID}].Y} ${Actor[Query, ID=${MirageID}].Z} 1 0 FALSE FALSE TRUE FALSE
			
			;if my mirage is the closest, wait until everyone else is done killing
			if ${Mirages.Get[${ClosestMirageIndex}].Name.Find[${Me.Name}](exists)}
			{
				if ${Target.ID}!=${Me.ID}
					Actor[id,${Me.ID}]:DoTarget
				FurthestAwayGroupMemberDistance:Set[${Math.Distance[${Actor[id,${MirageID}].Loc},-177.866241,3.306249,-359.220947]}]
				;echo ISXRI: MyMirage is the closest waiting
				while ${Mirages.Used}>1
				{
					if ${Target.ID}!=${Me.ID}
						Actor[id,${Me.ID}]:DoTarget
					wait 10
					EQ2:QueryActors[Mirages, Name=-"mirage"]
				}
				;now wait until the furthest away groupmember is closer than my mirage
				while ${FurthestAwayGroupMemberDistance}>=${Math.Distance[${Actor[id,${MirageID}].Loc},-177.866241,3.306249,-359.220947]} && ${Math.Calc[(${Script.RunningTime}-${MirageTime})/100]}<400
				{
					FurthestAwayGroupMemberDistance:Set[0]
					;now get and set the furthest away groupmembers distance
					for(count:Set[1];${count}<${Me.Group};count:Inc)
					{
						echo ${count}: ${Me.Group[${count}].Name}: ${Math.Distance[${Me.Group[${count}].Loc},-177.866241,3.306249,-359.220947]}
						if ${Math.Distance[${Me.Group[${count}].Loc},-177.866241,3.306249,-359.220947]}>${FurthestAwayGroupMemberDistance}
							FurthestAwayGroupMemberDistance:Set[${Math.Distance[${Me.Group[${count}].Loc},-177.866241,3.306249,-359.220947]}]
					}
					wait 1
					if ${Target.ID}!=${Me.ID}
						Actor[id,${Me.ID}]:DoTarget
					;echo ${FurthestAwayGroupMemberDistance}>=${Math.Distance[${Actor[id,${MirageID}].Loc},-177.866241,3.306249,-359.220947]}
					;echo ${Math.Calc[(${Script.RunningTime}-${MirageTime})/100]}
				}
			}
			
			while ${Actor[Query, ID=${MirageID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${MirageID}
					Actor[Query, ID=${MirageID} && IsDead=FALSE]:DoTarget
				waitframe
			}
			if !${Me.Maintained[Sprint](exists)}
				Me.Ability[Sprint]:Use
			;go backwards west to 1 from LowestIndexWEST
			;go west down to LowestIndexWEST
			for(WestCount:Set[${LowestIndexWEST}];${WestCount}>=1;WestCount:Dec)
			{
				if ${WEST.Get[${WestCount}].Find[FORK-](exists)}
				{
					if ${TEMPFORKWEST.NotEqual[${WEST.Get[${WestCount}]}]}
					{
						TEMPFORKWEST:Set[${WEST.Get[${WestCount}]}]
						InFork:Set[TRUE]
					}
					else
					{
						InFork:Set[FALSE]
						TEMPFORKWEST:Set[NONE]
					}
					continue
				}
				if ${InFork} && ${FORKWEST.NotEqual[${TEMPFORKWEST}]}
					continue
				call RIMObj.Move ${WEST.Get[${WestCount}]} 1 0 FALSE FALSE TRUE TRUE
				if !${Me.Maintained[Sprint](exists)}
					Me.Ability[Sprint]:Use
				waitframe
			}
			
			RI_Atom_SetLockSpot ${Me.Name} -177.866241 3.306249 -359.220947
			
			if !${RI_Var_Bool_GlobalOthers}
			{
				while ${Actor[Query, Name="The Meld of Haze"].Distance}>9
					wait 2
				wait 5
				RI_Atom_SetLockSpot ${Me.Name} -178.729904 3.612629 -369.953461
			}
		}
		;turn on assisting
		RI_CMD_Assisting 1
		;echo waiting ${Math.Calc[(${Math.Calc[${MirageTime}+41000]}-${Script.RunningTime})/100]}
		;wait ${Math.Calc[(${Math.Calc[${MirageTime}+41000]}-${Script.RunningTime})/100]} ${Actor[Query, Name="The Meld of Haze" && IsDead=FALSE](exists)}
		wait 1
	}
	if ${Skip100NotChecked}
		UIElement[SettingsSkipMobAttackHealthCheckBox@SettingsFrame@CombatBotUI]:UnsetChecked
	"RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Open Wounds,1]"
	echo ISXRI: Ending Haze
}

function Reaver()
{
	variable int ReaverID
	ReaverID:Set[${Actor[Query, Name=="The Mist Reaver" && IsDead=FALSE].ID}]
	"RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Absorb Magic,TRUE]"
	;#2FE83C - Noxious
	;#943BFF - Arcane
	;#FF930C - Elemental
	;#E8E31D - Physical
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["The Mist Reaver alters its defense!"]
	AnnounceText:Clear
	AnnounceText:Insert["A lantern alights nearby while the reaver's defense to all damage but"]
	RI_Obj_CB:CastWhileMoving[1]
	if !${RI_Var_Bool_GlobalOthers}
		Actor[Query, ID=${ReaverID} && IsDead=FALSE]:DoTarget
	
	call RIMObj.Move -178.000427 29.526823 -330.363922 1 0 FALSE FALSE TRUE FALSE
	RI_Atom_SetLockSpot ${Me.Name} -178.027634 14.870481 -288.785919 1 100
	
	if !${RI_Var_Bool_GlobalOthers}
		RI_Atom_SetLockSpot ${Me.Name} -178.101105 14.874979 -277.427063 1 100
	
	if !${UIElement[SettingsSkipMobAttackHealthCheckBox@SettingsFrame@CombatBotUI].Checked}
	{
		Skip100NotChecked:Set[TRUE]
		UIElement[SettingsSkipMobAttackHealthCheckBox@SettingsFrame@CombatBotUI]:SetChecked
	}
	
	while ${Actor[Query, ID=${ReaverID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor[Query, ID=${ReaverID} && IsDead=FALSE].ID}
				Actor[Query, ID=${ReaverID} && IsDead=FALSE]:DoTarget
		}

		if ${RIObj.MainIconIDExists[${Me.ID},822]}
		{
			RI_Atom_SetLockSpot OFF
			RI_Atom_SetRIFollow OFF
			;turn off assist and target self
			RI_CMD_Assisting 0
			wait 2
			Actor[${Me.ID}]:DoTarget
			wait 2
			
			switch ${Me.Archetype}
			{
				case fighter
				{
					while ${Actor[Query, Name=="smothering mist" && IsDead=FALSE](exists)}
					{
						if ${Target.ID}!=${Actor[Query, Name=="smothering mist" && IsDead=FALSE].ID}
							Actor[Query, Name=="smothering mist" && IsDead=FALSE]:DoTarget
						wait 2
					}
					break
				}
				case mage
				{
					call RIMObj.Move -177.825836 15.086945 -290.888245 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					call RIMObj.Move -178.000427 29.526823 -330.363922 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					;crouch
					if !${Me.IsCrouching}
						press z
					call RIMObj.Move -214.374695 16.681242 -330.082001 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -214.430405 16.195002 -323.426300 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					while ${Actor[Query, Name=="smothering mist" && IsDead=FALSE](exists)}
					{
						if ${Target.ID}!=${Actor[Query, Name=="smothering mist" && IsDead=FALSE].ID}
							Actor[Query, Name=="smothering mist" && IsDead=FALSE]:DoTarget
						wait 2
					}
					wait 2
					;crouch
					press ${RI_Var_String_JumpKey}
					Actor[${Me.ID}]:DoTarget
					call RIMObj.Move -214.374695 16.681242 -330.082001 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -178.000427 29.526823 -330.363922 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					call RIMObj.Move -178.027634 14.870481 -288.785919 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					RI_Atom_SetLockSpot ${Me.Name} -178.027634 14.870481 -288.785919 1 100
					break
				}
				case scout
				{
					call RIMObj.Move -177.825836 15.086945 -290.888245 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					call RIMObj.Move -178.000427 29.526823 -330.363922 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					;crouch
					if !${Me.IsCrouching}
						press z
					call RIMObj.Move -141.842484 16.681242 -329.691162 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -141.959213 16.194778 -322.741150 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					while ${Actor[Query, Name=="smothering mist" && IsDead=FALSE](exists)}
					{
						if ${Target.ID}!=${Actor[Query, Name=="smothering mist" && IsDead=FALSE].ID}
							Actor[Query, Name=="smothering mist" && IsDead=FALSE]:DoTarget
						wait 2
					}
					wait 2
					;crouch
					press ${RI_Var_String_JumpKey}
					Actor[${Me.ID}]:DoTarget
					call RIMObj.Move -141.842484 16.681242 -329.691162 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -178.000427 29.526823 -330.363922 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -178.027634 14.870481 -288.785919 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					RI_Atom_SetLockSpot ${Me.Name} -178.027634 14.870481 -288.785919 1 100
					break
				}
				case priest
				{
					call RIMObj.Move -177.825836 15.086945 -290.888245 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					call RIMObj.Move -178.000427 29.526823 -330.363922 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					wait 5
					;crouch
					if !${Me.IsCrouching}
						press z
					call RIMObj.Move -178.092209 29.253181 -354.290558 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					while ${Actor[Query, Name=="smothering mist" && IsDead=FALSE](exists)}
					{
						if ${Target.ID}!=${Actor[Query, Name=="smothering mist" && IsDead=FALSE].ID}
							Actor[Query, Name=="smothering mist" && IsDead=FALSE]:DoTarget
						wait 2
					}
					wait 5
					;crouch
					press ${RI_Var_String_JumpKey}
					Actor[${Me.ID}]:DoTarget
					call RIMObj.Move -178.000427 29.526823 -330.363922 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					call RIMObj.Move -178.027634 14.870481 -288.785919 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					RI_Atom_SetLockSpot ${Me.Name} -178.027634 14.870481 -288.785919 1 100
					break
				}
			}
			wait 2
			;turn on assist
			RI_CMD_Assisting 1

		}
		if ${Trigger}
		{
			if ${RI_Var_Bool_GlobalOthers} && ${Me.Archetype.NotEqual[priest]}
			{
				RI_Atom_SetLockSpot OFF
				RI_Atom_SetRIFollow OFF
				;turn off assist and target self
				RI_CMD_Assisting 0
				wait 2
				Actor[${Me.ID}]:DoTarget
								
				;#2FE83C - Noxious
				if ${TriggerMessage.Find["#2FE83C"](exists)} || ${TriggerMessage.Find["noxious"](exists)}
				{
					call RIMObj.Move -180.556152 14.870481 -289.069733 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					call RIMObj.Move -195.793991 9.857199 -290.183380 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -194.741547 4.295166 -269.713654 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -211.196976 3.306250 -242.338394 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -198.641052 4.518423 -241.238815 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					;;;;click lantern
					wait 5
					wait 50 !${Me.CastingSpell}
					while ${Actor["Noxious Lantern"].HighlightOnMouseHover} && !${Me.GetGameData[Spells.Casting].Label.Equal["Harness the power"]}
					{
						Actor["Noxious Lantern"]:DoubleClick
						wait 2
					}
					wait 5 ${Me.CastingSpell}
					wait 50 !${Me.CastingSpell}
					Actor[${Me.ID}]:DoTarget
					;;;
					call RIMObj.Move -211.196976 3.306250 -242.338394 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -194.741547 4.295166 -269.713654 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -195.793991 9.857199 -290.183380 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					call RIMObj.Move -177.973831 14.870481 -288.75830 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
				}
				;#943BFF - Arcane
				if ${TriggerMessage.Find["#943BFF"](exists)} || ${TriggerMessage.Find["arcane"](exists)}
				{
					call RIMObj.Move -175.892654 14.870481 -289.195099 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					call RIMObj.Move -161.362015 9.857175 -290.102911 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -161.010803 3.995815 -268.542023 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -133.532089 3.490905 -308.118652 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -150.434357 4.135114 -381.931427 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -159.073273 4.518423 -381.956451 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					;;;;click lantern
					wait 5
					wait 50 !${Me.CastingSpell}
					while ${Actor["Arcane Lantern"].HighlightOnMouseHover} && !${Me.GetGameData[Spells.Casting].Label.Equal["Harness the power"]}
					{
						Actor["Arcane Lantern"]:DoubleClick
						wait 2
					}
					wait 5 ${Me.CastingSpell}
					wait 50 !${Me.CastingSpell}
					Actor[${Me.ID}]:DoTarget
					;;;;
					call RIMObj.Move -150.434357 4.135114 -381.931427 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -133.532089 3.490905 -308.118652 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -161.010803 3.995815 -268.542023 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -161.362015 9.857175 -290.102911 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					call RIMObj.Move -177.973831 14.870481 -288.75830 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
				}
				;#FF930C - Elemental
				if ${TriggerMessage.Find["#FF930C"](exists)} || ${TriggerMessage.Find["elemental"](exists)}
				{
					call RIMObj.Move -175.892654 14.870481 -289.195099 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					call RIMObj.Move -161.362015 9.857175 -290.102911 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -161.010803 3.995815 -268.542023 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -146.769302 3.542819 -241.710602 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -158.963928 4.518423 -240.829620 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					;;;;click lantern
					wait 5
					wait 50 !${Me.CastingSpell}
					while ${Actor["Elemental Lantern"].HighlightOnMouseHover} && !${Me.GetGameData[Spells.Casting].Label.Equal["Harness the power"]}
					{
						Actor["Elemental Lantern"]:DoubleClick
						wait 2
					}
					wait 5 ${Me.CastingSpell}
					wait 50 !${Me.CastingSpell}
					Actor[${Me.ID}]:DoTarget
					;;;;
					call RIMObj.Move -146.769302 3.542819 -241.710602 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -161.010803 3.995815 -268.542023 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -161.362015 9.857175 -290.102911 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					call RIMObj.Move -177.973831 14.870481 -288.75830 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
				}
				;#E8E31D - Physical
				if ${TriggerMessage.Find["#E8E31D"](exists)} || ${TriggerMessage.Find["physical"](exists)}
				{
					call RIMObj.Move -180.556152 14.870481 -289.069733 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					call RIMObj.Move -195.793991 9.857199 -290.183380 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -194.741547 4.295166 -269.713654 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -228.827774 3.306250 -313.161041 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -207.220673 4.135114 -381.874481 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -197.607407 4.518423 -381.870697 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					;;;;click lantern
					wait 5
					wait 50 !${Me.CastingSpell}
					while ${Actor["Physical Lantern"].HighlightOnMouseHover} && !${Me.GetGameData[Spells.Casting].Label.Equal["Harness the power"]}
					{
						Actor["Physical Lantern"]:DoubleClick
						wait 2
					}
					wait 5 ${Me.CastingSpell}
					wait 50 !${Me.CastingSpell}
					Actor[${Me.ID}]:DoTarget
					;;;;
					call RIMObj.Move -207.220673 4.135114 -381.874481 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -228.827774 3.306250 -313.161041 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -194.741547 4.295166 -269.713654 1 0 FALSE FALSE TRUE TRUE TRUE TRUE
					call RIMObj.Move -195.793991 9.857199 -290.183380 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
					call RIMObj.Move  -177.973831 14.870481 -288.75830 1 0 FALSE FALSE TRUE FALSE TRUE TRUE
				}
				RI_Atom_SetLockSpot ${Me.Name} -178.027634 14.870481 -288.785919 1 100
			}
			Trigger:Set[FALSE]
			;turn on assist
			RI_CMD_Assisting 1
		}
		wait 2
			
	}
	if ${Skip100NotChecked}
		UIElement[SettingsSkipMobAttackHealthCheckBox@SettingsFrame@CombatBotUI]:UnsetChecked
	"RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Absorb Magic,FALSE]"
	RI_Obj_CB:CastWhileMoving[0]
}
;;;;;;;;;;;;;;;; End The Lost City of Torsis: The Shrouded Temple ;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;; Start The Lost City of Torsis: The Spectral Market ;;;;;;;;;;;;;;;;;;;;;;
function Champion()
{
	echo Starting Champion v1
	variable int Championcounter=0
	IncomingText:Clear
	IncomingText2:Clear
	variable int _ChampionID=${Actor[Query, Name=-"Champion" && IsDead=FALSE].ID}
	IncomingText:Insert["The Torsis Champion eyes"]
	Trigger:Set[FALSE]
	if ${Me.Archetype.Equal[fighter]}
		RI_Atom_SetLockSpot ALL -58.031300 5.120734 -103.061249
	else
		RI_Atom_SetLockSpot ALL -54.041054 4.150457 -104.316826
	while ${Actor[Query, ID=${_ChampionID} && IsDead=FALSE](exists)}
	{
		if ${Me.Archetype.Equal[fighter]}
		{
			if ${Target.ID}!=${_ChampionID}
				Actor[Query, ID=${_ChampionID} && IsDead=FALSE]:DoTarget
		}
		if ${Trigger}
		{
			wait 20
			Trigger:Set[FALSE]
			Championcounter:Inc
			if ${Championcounter}==1
			{
				if ${Me.Archetype.Equal[fighter]}
					RI_Atom_SetLockSpot ALL -4.821387 5.125111 -102.906876
				else
					RI_Atom_SetLockSpot ALL -8.195525 4.150457 -105.909523
			}
			elseif ${Championcounter}==2
			{
				if ${Me.Archetype.Equal[fighter]}
					RI_Atom_SetLockSpot ALL -58.028660 5.114992 -131.063004
				else
					RI_Atom_SetLockSpot ALL -53.093727 4.150457 -128.019821
			}
			elseif ${Championcounter}==3
			{
				if ${Me.Archetype.Equal[fighter]}
					RI_Atom_SetLockSpot ALL -4.821387 5.125111 -131.906876
				else
					RI_Atom_SetLockSpot ALL -8.195525 4.150457 -128.909523
			}
		}
		wait 2
	}
	
	echo Ending Champion v1
}
function Ongnissim()
{
	echo Starting Ongnissim v1
	IncomingText:Clear
	IncomingText2:Clear
	variable int _OngnissimID=${Actor[Query, Name=-"Ongnissim" && IsDead=FALSE].ID}
	IncomingText:Insert["Ongnissim the Unseen prepares to unleash a massive crashing fist on the ground near him!"]
	Trigger:Set[FALSE]
	RI_Atom_SetLockSpot ALL -10.128205 16.373989 -289.764923
	if !${RI_Var_Bool_GlobalOthers}
		Actor[Query, ID=${_OngnissimID} && IsDead=FALSE]:DoTarget
	wait 100 ${Actor[Query, ID=${_OngnissimID} && IsDead=FALSE].Distance}<9
	wait 5
	if ${RI_Var_Bool_GlobalOthers}
		RI_Atom_SetLockSpot ALL 3.287242 16.841909 -289.514893
	while ${Actor[Query, ID=${_OngnissimID} && IsDead=FALSE](exists)}
	{
		if ${Me.Archetype.Equal[fighter]}
		{
			if ${Target.ID}!=${_OngnissimID}
				Actor[Query, ID=${_OngnissimID} && IsDead=FALSE]:DoTarget
		}
		if ${Trigger}
		{
			Trigger:Set[FALSE]
			if ${Math.Distance[${Me.Loc},-10.128205,16.373989,-289.764923]}<25
			{
				RI_Atom_SetLockSpot ALL 38.233021 16.389023 -289.664032
				if !${RI_Var_Bool_GlobalOthers}
				{
					wait 50
					wait 50 !${Me.IsMoving}
					wait 100 ${Actor[Query, ID=${_OngnissimID} && IsDead=FALSE].Distance}<9
					;wait 5
					RI_Atom_SetLockSpot ALL 49.687565 16.374567 -289.614075
				}
			}
			else
			{
				RI_Atom_SetLockSpot ALL 3.287242 16.841909 -289.514893
				if !${RI_Var_Bool_GlobalOthers}
				{
					wait 50
					wait 50 !${Me.IsMoving}
					wait 100 ${Actor[Query, ID=${_OngnissimID} && IsDead=FALSE].Distance}<9
					;wait 5
					RI_Atom_SetLockSpot ALL -10.128205 16.373989 -289.764923
				}
			}
		}
		wait 2
	}
	
	echo Ending Ongnissim v1
}
;;;;;;;;;;;;;;;; End The Lost City of Torsis: The Spectral Market ;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;; Start The Lost City of Torsis: Reaver's Remnants ;;;;;;;;;;;;;;;;;;;;;;

function Beguiler()
{
	echo Starting Beguiler
	
	;turn off absorb magic in combatbot
	RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Absorb Magic,0]
	
	variable int _BeguilerID=${Actor[Query, Name="A Spectral Beguiler"].ID}
	variable int _SlowReactionsMainIconID=171
	;main loop until A Spectral Beguiler DNE (if we are a mage)
	do
	{
		if ${Me.Archetype.Equal[mage]}
		{
			;if Absorb Magic is ready and we see "Slow Reactions" on "A Spectral Beguiler", pause bot, stop casting and cast Absorb Magic (ID=1812025739)
			if ${RIMUIObj.MainIconIDExists[${_BeguilerID},${_SlowReactionsMainIconID}]} && ${Me.Ability[id,1812025739].IsReady} && (${Me.Arcane}>0 || ${Me.Group[1].Arcane}>0 || ${Me.Group[2].Arcane} || ${Me.Group[3].Arcane} || ${Me.Group[4].Arcane} || ${Me.Group[5].Arcane})
			{
				;echo ${Time}: Slow Reactions Found
				
				;turn off assisting
				RI_CMD_Assisting 0
				
				;pause bots
				RI_CMD_PauseCombatBots 1
				
				;target "A Spectral Beguiler"
				Actor[Query, ID="${_BeguilerID}"]:DoTarget
				
				;cancel spellcast and clear ability queue
				eq2ex cancel_spellcast
				eq2ex clearabilityqueue 
				
				;wait until we are not casting
				wait 200 !${Me.CastingSpell}
				
				;keep attempting to cast absorb magic (ID=1812025739) until it is no longer ready (aka casted)
				do
				{
					if ${Target.ID}==${_BeguilerID}
						Me.Ability[id,1812025739]:Use
					else
						Actor[Query, ID="${_BeguilerID}"]:DoTarget
					wait 1
				}
				while ${Me.Ability[id,1812025739].IsReady}
				
				;wait until we are not casting
				wait 200 !${Me.CastingSpell}
				
				;turn on assisting
				RI_CMD_Assisting 1
				
				;unpause bots
				RI_CMD_PauseCombatBots 0
			}
			if !${RI_Var_Bool_GlobalOthers}
			{
				if ${Actor[id,${_BeguilerID},radius,30](exists)}
				{
					if ${Target.ID}!=${_BeguilerID}
						Actor[id,${_BeguilerID}]:DoTarget
				}
			}
		}
		wait 2
	}
	while ${Actor[id,${_BeguilerID}](exists)}
}
function Residual()
{
	echo Starting Residual
	
	while ${Actor[Query, Name=-"A Residual Slime" && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=-"a Torsis scrubber" && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"a Torsis scrubber" && IsDead=FALSE].ID}
					Actor[Query, Name=-"a Torsis scrubber" && IsDead=FALSE]:DoTarget
			}
			else
			{
				if ${Target.ID}!=${Actor[Query, Name=-"A Residual Slime" && IsDead=FALSE].ID}
					Actor[Query, Name=-"A Residual Slime" && IsDead=FALSE]:DoTarget
			}
		}
	}
}
function Tzirathk()
{
	IncomingText:Clear
	IncomingText:Insert[The brazier increases in heat!]
	
	RIMUIObj:SetLockSpot[${Me.Name},5.09,-5.37,-698.66]
	
	echo Starting Tzirathk
	
	while ${Actor[Query, Name=-"Tzirathk" && IsDead=FALSE](exists)}
	{
		if ${Trigger}
		{
			if ${Math.Distance[${Me.Loc},5.169329,-5.374262,-698.659912]}>12     
				RIMUIObj:SetLockSpot[${Me.Name},5.169329,-5.374262,-698.659912]		    
			elseif ${Math.Distance[${Me.Loc},28.662748,-5.374262,-698.636475]}>12
				RIMUIObj:SetLockSpot[${Me.Name},28.662748,-5.374262,-698.636475]
			Trigger:Set[0]
		}
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=-"a Reflection of Tzirathk" && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"a Reflection of Tzirathk" && IsDead=FALSE].ID}
					Actor[Query, Name=-"a Reflection of Tzirathk" && IsDead=FALSE]:DoTarget
			}
			else
			{
				if ${Target.ID}!=${Actor[Query, Name=-"Tzirathk" && IsDead=FALSE].ID}
					Actor[Query, Name=-"Tzirathk" && IsDead=FALSE]:DoTarget
			}
		}
	}
	echo Ending Tzirathk
}
function Wraith()
{
	echo Starting Wraith
	
	IncomingText:Clear
	IncomingText:Insert[eyes begin to burn into your soul]
	AnnounceText:Clear
	AnnounceText:Insert[eyes begin to burn into your soul]
	
	variable index:string _Locs
	variable int _cnt=0
	_Locs:Insert["-6.958926,-6.117686,-839.407227"]
	_Locs:Insert["-19.859524,-6.117686,-839.922180"]
	_Locs:Insert["-31.926943,-6.117686,-839.876404"]
	_Locs:Insert["-44.186760,-6.117686,-839.925842"]
	_Locs:Insert["-56.527271,-6.117686,-839.757690"]
	_Locs:Insert["-69.011292,-6.117686,-839.844788"]
	_Locs:Insert["-82.784027,-5.803309,-839.643188"]
	_Locs:Insert["-98.194130,-5.169047,-839.658691"]
	_Locs:Insert["-99.000206,-5.521029,-825.362244"]
	_Locs:Insert["-98.810120,-6.117686,-809.697632"]
	_Locs:Insert["-98.851677,-6.117686,-797.874817"]
	_Locs:Insert["-98.685219,-6.117686,-785.632568"]
	_Locs:Insert["-98.761787,-5.584048,-770.861023"]
	_Locs:Insert["-98.851974,-5.169047,-756.256958"]
	_Locs:Insert["-85.716125,-5.257937,-756.300110"]
	_Locs:Insert["-73.734222,-6.117686,-756.253052"]
	_Locs:Insert["-60.192242,-5.960313,-756.646790"]
	_Locs:Insert["-45.851540,-4.488030,-756.833313"]
	_Locs:Insert["-25.844765,-4.168133,-756.751404"]
	_Locs:Insert["-24.912683,-4.423313,-735.742737"]
	_Locs:Insert["-24.972208,-4.423321,-717.648438"]
	_Locs:Insert["-24.865658,-4.174296,-696.309387"]
	_Locs:Insert["-41.010700,-4.182609,-695.898376"]
	_Locs:Insert["-42.345108,-4.423136,-674.846497"]
	_Locs:Insert["-42.026604,-4.423135,-656.919189"]
	_Locs:Insert["-41.902122,-4.423136,-640.170166"]
	_Locs:Insert["-41.614822,-4.188455,-618.963745"]
	
	RIMUIObj:SetLockSpot[${Me.Name},16.888502,-5.169047,-839.361877]
	
	while ${Actor[Query, Name=-"Dread Wraith" && IsDead=FALSE](exists)}
	{
		if ${Trigger}
		{
			RIMUIObj:SetLockSpot[${Me.Name},${_Locs.Get[${_cnt:Inc}]}]
			Trigger:Set[0]
		}
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Target.ID}!=${Actor[Query, Name=-"Dread Wraith" && IsDead=FALSE].ID}
				Actor[Query, Name=-"Dread Wraith" && IsDead=FALSE]:DoTarget
		}
	}
	if !${RI_Var_Bool_GlobalOthers}
	{
		;start group follow
		call RIMObj.follow
		
		for(;${_cnt}>0;_cnt:Dec)
		{
			call RIMObj.Move ${_Locs.Get[${_cnt}].Replace[","," "]}
		}
	}
	echo Ending Wraith
}
function Neh'Ashiir()
{
	call Neh'ashiir
}
function Neh'ashiir()
{
	echo Starting Neh'Ashiir
	variable int _cnt
	Actor[Query, Name=-"Neh'Ashiir" && IsDead=FALSE]:DoTarget
	wait 100 ${Actor[Query, Name=-"Neh'Ashiir" && IsDead=FALSE].Distance}<10
	RIMUIObj:SetLockSpot[${Me.Name},16.651793,-4.743321,-1076.422729]
	while ${Actor[Query, Name=-"Neh'Ashiir" && IsDead=FALSE](exists)}
	{
		if ${RIMUIObj.MainIconIDExists[${Me.ID},291]}
		{
			for(_cnt:Set[1];${_cnt}<${Me.Group};_cnt:Inc)
			{
				if ${Me.Group[${_cnt}].Cursed}==-1 && ${Me.Group[${_cnt}].Name.Compare[${Me.Name}]}>0
				{
					RIMUIObj:SetLockSpot[${Me.Name},17.050190,-4.743229,-1054.201050]
					_cnt:Set[7]
				}
				elseif ${Me.Group[${_cnt}].Cursed}==-1 && ${Me.Group[${_cnt}].Name.Compare[${Me.Name}]}<0
				{
					RIMUIObj:SetLockSpot[${Me.Name},16.566122,-4.743642,-1098.454712]
					_cnt:Set[7]
				}
				elseif ${_cnt}==5
					RIMUIObj:SetLockSpot[${Me.Name},16.640079,-4.743278,-1052.199463]
			}
			while ${RIMUIObj.MainIconIDExists[${Me.ID},291]}
			{
				wait 1
			}
			RIMUIObj:SetLockSpot[${Me.Name},16.651793,-4.743321,-1076.422729]
		}
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=-"A Black Reaver" && IsDead=FALSE && Distance<15](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"A Black Reaver" && IsDead=FALSE && Distance<15].ID}
					Actor[Query, Name=-"A Black Reaver" && IsDead=FALSE && Distance<15]:DoTarget
			}
			else
			{
				if ${Target.ID}!=${Actor[Query, Name=-"Neh'Ashiir" && IsDead=FALSE].ID}
					Actor[Query, Name=-"Neh'Ashiir" && IsDead=FALSE]:DoTarget
			}
		}
		wait 1
	}
	echo Ending Neh'Ashiir
}
;;;;;;;;;;;;;;;; End The Lost City of Torsis: Reaver's Remnants ;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;; Start The Ruins of Cabilis ;;;;;;;;;;;;;;;;;;;;;;
function Smithy()
{
	echo Starting Smithy v1
	AnnounceText:Clear
	AnnounceText:Insert["Time seems to stop and stand still around"]
	Trigger:Set[FALSE]
	if !${RI_Var_Bool_GlobalOthers}
		RI_Atom_SetLockSpot ALL 213.440582 95.755623 249.844040
	else
		RI_Atom_SetLockSpot ALL 214.999786 96.036880 242.236938
	while ${Actor[Query, Name=-"Smithy" && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			; if ${Actor["a fallen apprentice",radius,50](exists)}
			; {
				; if ${Target.ID}!=${Actor["a fallen apprentice",radius,50].ID}
					; Actor["a fallen apprentice",radius,50]:DoTarget
			; }
			if ${Target.ID}!=${Actor[Query, Name=-"Smithy" && IsDead=FALSE].ID}
				Actor[Query, Name=-"Smithy" && IsDead=FALSE]:DoTarget
		}
		if ${Trigger}
		{
			Trigger:Set[FALSE]
			if ${Math.Distance[${Me.X},${Me.Z},213,250]}<10
			{
				if !${RI_Var_Bool_GlobalOthers}
					RI_Atom_ChangeLockSpot ALL 220.344635 95.754509 214.686325
				else
					RI_Atom_ChangeLockSpot ALL 218.647171 96.036858 221.176727
			}
			if ${Math.Distance[${Me.X},${Me.Z},220,215]}<10
			{
				if !${RI_Var_Bool_GlobalOthers}
					RI_Atom_ChangeLockSpot ALL 213.440582 95.755623 249.844040
				else
					RI_Atom_ChangeLockSpot ALL 214.999786 96.036880 242.236938
			}
		}
		wait 2
	}
	
	echo Ending Smithy v1
}
;;;;;;;;;;;;;;;; End The Ruins of Cabilis ;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;; Start Kaesora: Tomb of the Venerated ;;;;;;;;;;;;;;;;;;;;;;
function Chatizad()
{
	echo Starting Chatizad v1
	variable int _ChatizadID=${Actor[Query, Name=-"Chatizad" && IsDead=FALSE].ID}
	RIMUIObj:SetLockSpot[ALL,-518.479980,89.105713,-531.070007]
	
	if !${RI_Var_Bool_GlobalOthers}
		Actor[Query, ID=${_ChatizadID} && IsDead=FALSE]:DoTarget

	while ${Actor[Query, ID=${_ChatizadID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=-"guardian" && Distance<=10 && IsAggro=TRUE && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"guardian" && Distance<=10 && IsDead=FALSE].ID}
					Actor[Query, Name=-"guardian" && Distance<=10 && IsDead=FALSE]:DoTarget
			}
			else
			{
				if ${Target.ID}!=${_ChatizadID}
					Actor[Query, ID=${_ChatizadID} && IsDead=FALSE]:DoTarget
			}
		}
		if ${Actor[Query, ID=${_ChatizadID} && IsDead=FALSE && Distance>=7](exists)}
		{
			RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ChatizadID} && IsDead=FALSE].Loc}]
			wait 20
		}
		wait 2
	}
	
	echo Ending Chatizad v1
}
function Zannaska()
{
	echo Starting Zannaska v1
	variable int _ZannaskaID=${Actor[Query, Name=-"Zannaska" && IsDead=FALSE].ID}
	RIMUIObj:SetLockSpot[ALL,-416.278992,100.679871,-603.322815]
	relay ${RI_Var_String_RelayGroup} RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Absorb Magic,1]
	if !${RI_Var_Bool_GlobalOthers}
		Actor[Query, ID=${_ZannaskaID} && IsDead=FALSE]:DoTarget

	while ${Actor[Query, ID=${_ZannaskaID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=-"warden" && Distance<=10 && IsAggro=TRUE && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"warden" && Distance<=10 && IsDead=FALSE].ID}
					Actor[Query, Name=-"warden" && Distance<=10 && IsDead=FALSE]:DoTarget
			}
			else
			{
				if ${Target.ID}!=${_ZannaskaID}
					Actor[Query, ID=${_ZannaskaID} && IsDead=FALSE]:DoTarget
			}
		}
		if ${Actor[Query, ID=${_ZannaskaID} && IsDead=FALSE && Distance>=7](exists)}
		{
			RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ZannaskaID} && IsDead=FALSE].Loc}]
			wait 20
		}
		wait 2
	}
	relay ${RI_Var_String_RelayGroup} RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Absorb Magic,0]
	echo Ending Zannaska v1
}
function Zann()
{
	echo Starting Zann v1
	variable int _ZannID=${Actor[Query, Name=-"Zannaska" && IsDead=FALSE].ID}
	RIMUIObj:SetLockSpot[ALL,-419.499969,111.456451,-355.859009]
	if !${RI_Var_Bool_GlobalOthers}
		Actor[Query, ID=${_ZannID} && IsDead=FALSE]:DoTarget

	while ${Actor[Query, ID=${_ZannID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=-"spectral" && Distance<=100 && IsAggro=TRUE && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"spectral" && Distance<=100 && IsAggro=TRUE && IsDead=FALSE].ID}
					Actor[Query, Name=-"spectral" && Distance<=100 && IsAggro=TRUE && IsDead=FALSE]:DoTarget
				if ${Actor[Query, Name=-"spectral" && Distance<=100 && IsAggro=TRUE && IsDead=FALSE].Distance}>30
					RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=-"spectral" && Distance<=100 && IsAggro=TRUE && IsDead=FALSE].Loc},30,500]
			}
			elseif ${Actor[Query, Name=-"Chatizad" && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"Chatizad" && IsDead=FALSE].ID}
					Actor[Query, Name=-"Chatizad" && IsDead=FALSE]:DoTarget
				RIMUIObj:SetLockSpot[ALL,-419.499969,111.456451,-355.859009]
			}
			else
			{
				if ${Target.ID}!=${_ZannID}
					Actor[Query, ID=${_ZannID} && IsDead=FALSE]:DoTarget
				RIMUIObj:SetLockSpot[ALL,-419.499969,111.456451,-355.859009]
			}
		}
		wait 2
	}
	echo Ending Zann v1
}
;;;;;;;;;;;;;;;; End Kaesora: Tomb of the Venerated ;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; End OF KA NAMED CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; Start OF Quest CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
function QuestY(string _QN)
{
	if ${QuestJournalWindow.CompletedQuest[${_QN}](exists)}
	{
		echo ISXRI: ${_QN} already Completed moving on
		wait 10
	}
	else
		call Quest "${_QN}"
}
function Yunzi2017Timeline()
{
	call QuestY "The \"Travels\" of Yun Zi - An Oasis For Your Thoughts"
	call QuestY "The \"Travels\" of Yun Zi - In a Kingdom Far Away"
	call QuestY "The \"Travels\" of Yun Zi - Echoes of the Past"
	call QuestY "The \"Travels\" of Yun Zi - Kunark or Bust"
	call QuestY "The \"Travels\" of Yun Zi - I Need to See Moors Places"`
	call QuestY "The \"Travels\" of Yun Zi - Ice to See Velious"
	call QuestY "The \"Travels\" of Yun Zi - An Eternity Without You"
	call QuestY "The \"Travels\" of Yun Zi - Tears for Fears"
	call QuestY "The \"Travels\" of Yun Zi - An Altar-Nate Malice"
}
function Yunzi2018Timeline()
{
	call QuestY "The new \"Travels\" of Yun Zi - Antonica or Bust"
	call QuestY "The new \"Travels\" of Yun Zi - Commonlands, Uncommon Heart"
	call QuestY "The new \"Travels\" of Yun Zi - Run Nektulos Forest Run"
	call QuestY "The new \"Travels\" of Yun Zi - Thundering Steppes By Steppes"
	call QuestY "The new \"Travels\" of Yun Zi - Disenchanting the Enchanted"
	call QuestY "The new \"Travels\" of Yun Zi - To Zek With It"
	call QuestY "The new \"Travels\" of Yun Zi - Feerrott Not, I Shall Find You"
	call QuestY "The new \"Travels\" of Yun Zi - Defrosting Everfrost"
	call QuestY "The new \"Travels\" of Yun Zi - Having Fun Storming Lavastorm"
}
function Yunzi2019Timeline()
{
	call QuestY "Yet more \"Travels\" of Yun Zi - Once Again in the Desert"
	call QuestY "Yet more \"Travels\" of Yun Zi - Skies the Limit"
	call QuestY "Yet more \"Travels\" of Yun Zi - ECHO ECHo ECho Echo echo"
	call QuestY "Yet more \"Travels\" of Yun Zi - Rising to the Occasion"
	call QuestY "Yet more \"Travels\" of Yun Zi - More Moors"
	call QuestY "Yet more \"Travels\" of Yun Zi - Destined for Destiny"
	call QuestY "Yet more \"Travels\" of Yun Zi - Eternally Eternity"
	call QuestY "Yet more \"Travels\" of Yun Zi - Returning to Tears"
	call QuestY "Yet more \"Travels\" of Yun Zi - Altering the Altar"
}
function Yunzi2020Timeline()
{
	call QuestY "Traveler's Feast - Coldwind Clam Chowder"
	call QuestY "Traveler's Feast - Darklight Beetle Omelets"
	call QuestY "Traveler's Feast - Rivervale Ratatouille"
	call QuestY "Traveler's Feast - Butcherblock Pumpkin Bread"
	call QuestY "Traveler's Feast - Dervish Squash Curry"
	call QuestY "Traveler's Feast - Sky Cake"
	call QuestY "Traveler's Feast - Mara Mandaikon Kakiage"
	call QuestY "Traveler's Feast - Kylong Bean Casserole"
	call QuestY "Traveler's Feast - Othmir Pepper Pasta"
}
function Yunzi2021Timeline()
{
	call QuestY "Traveler's Holidays - Getting a Feel For Frostfell"
	call QuestY "Traveler's Holidays - Evoking Love"
	call QuestY "Traveler's Holidays - More than Beer?"
	call QuestY "Traveler's Holidays - The Meaning of Mischief"
	call QuestY "Traveler's Holidays - Oceans for the Oceanless"
	call QuestY "Traveler's Holidays - Under a Burning Sky"
	call QuestY "Traveler's Holidays - Gears and Gadgets"
	call QuestY "Traveler's Holidays - Deadly Nights"
	call QuestY "Traveler's Holidays - We Need a Hero!"
}
function Yunzi2022Timeline()
{
	call QuestY "Traveler's Kunark Catalog: Around the Landing"
	call QuestY "Traveler's Kunark Catalog: Central Kylong"
	call QuestY "Traveler's Kunark Catalog: Deeper into Kylong"
	call QuestY "Traveler's Kunark Catalog: Focusing on Fens"
	call QuestY "Traveler's Kunark Catalog: Not the Panda!"
	call QuestY "Traveler's Kunark Catalog: Still not a Panda!"
	call QuestY "Traveler's Kunark Catalog: Killers in Kunzar"
	call QuestY "Traveler's Kunark Catalog: Scouting Skyfire"
	call QuestY "Traveler's Kunark Catalog: Angry, Angry, Angry"
}
function YunziTimeline()
{
	echo ISXRI: ${Time} Starting Yunzi 2017 Timeline
	call Yunzi2017Timeline
	echo ISXRI: ${Time} Starting Yunzi 2018 Timeline
	call Yunzi2018Timeline
	echo ISXRI: ${Time} Starting Yunzi 2019 Timeline
	call Yunzi2019Timeline
	echo ISXRI: ${Time} Starting Yunzi 2020 Timeline
	call Yunzi2020Timeline
	echo ISXRI: ${Time} Starting Yunzi 2021 Timeline
	call Yunzi2021Timeline
	echo ISXRI: ${Time} Starting Yunzi 2022 Timeline
	call Yunzi2022Timeline
}

function ResetZone(string _ZoneName)
{
	relay ${RG_Var_String_RelayGroup} RIMUIObj:ResetZone[ALL,"${_ZoneName}"]
}
function QuestM(string QuestOrTimeLineName=~NONE~)
{
	MainQuestName:Clear
	variable bool _Skip100NotChecked=FALSE
	if !${UIElement[SettingsSkipMobAttackHealthCheckBox@SettingsFrame@CombatBotUI].Checked}
	{
		_Skip100NotChecked:Set[TRUE]
		UIElement[SettingsSkipMobAttackHealthCheckBox@SettingsFrame@CombatBotUI]:SetChecked
	}
	
	if ${QuestOrTimeLineName.Equal[~NONE~]}
	{
		echo ISXRI: You must specify a quest name or timeline name, USAGE: RI Quest "Quest or Timeline Name", Example RI Quest \"Sokokar Timeline Crafting\" 
		; echo ISXRI: Available Quests or Timelines:
		; echo ISXRI: Sokokar Timeline Crafting
		; echo ISXRI: Fangs Away!
		; echo ISXRI: An Eye in the Sky
		; echo ISXRI: Sticking My Ore In
		; echo ISXRI: Preparations for the Rescue
		; echo ISXRI: Is It Good News?
		; echo ISXRI: Artisan Epic Timeline
		; echo ISXRI: New Lands New Profits
		Script:End
	}
	else
	{
		if ${QuestOrTimeLineName.Replace[" ",""].Find[SokokarTimelineCrafting]} || ${QuestOrTimeLineName.Replace[" ",""].Find[SokokarCraftingTimeline]}
			call SokokarTimelineCrafting
		;if ${QuestOrTimeLineName.Replace["'",""].Replace[" ",""].Find[BathezidsWatchFactionCrafting]}
			;call BathezidsWatchFactionCrafting
		else
			call QuestDefault "${QuestOrTimeLineName}"
		; switch "${QuestOrTimeLineName}"
		; {
			; case Sokokar Timeline Crafting
			; {
				; call SokokarTimelineCrafting
				; break
			; }
			; case Fangs Away!
			; {
				; call FangsAway
				; break
			; }
			; case An Eye in the Sky
			; {
				; call AnEyeInTheSky
				; break
			; }
			; case Sticking My Ore In
			; {
				; call StickingMyOreIn
				; break
			; }
			; case Preparations for the Rescue
			; {
				; call PreparationsForTheRescue
				; break
			; }
			; case Is It Good News?
			; {
				; call IsItGoodNews
				; break
			; }
			; case Artisan Epic Timeline
			; {
				; call ArtisanEpicTimeline
				; break
			; }
		; }
	}
	if ${UIElement[SettingsSkipMobAttackHealthCheckBox@SettingsFrame@CombatBotUI].Checked} && !${_Skip100NotChecked}
		UIElement[SettingsSkipMobAttackHealthCheckBox@SettingsFrame@CombatBotUI]:SetChecked
	Script:End
}
function ExecuteCommand(string CommandName)
{
	;echo ${CommandName}
	if ${CommandName.Left[5].Upper.Equal[RELAY]}
	{
		variable int leftnum
		leftnum:Set[${Math.Calc[6+${CommandName.Right[-6].Find[" "]}]}]
		noop ${Execute[${CommandName.Left[${leftnum}]} "${CommandName.Right[${Math.Calc[-1*${leftnum}]}]}"]}
	}
	else
		noop ${Execute["${CommandName}"]}
}
function Zone(float _X, float _Z,int _Wait=600)
{
	if !${RI_Var_Bool_GlobalOthers}
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Zone ${_X} ${_Z} ${_Wait}"]
	wait 5
	Face ${_X} ${_Z}
	wait 2
	press -hold ${RI_Var_String_ForwardKey}
	timedcommand 150 press -release ${RI_Var_String_ForwardKey}
	
	variable int _Counter
	_Counter:Set[0]
	while ${EQ2.Zoning}==0 && ${_Counter:Inc}<${_Wait}
	{
		if ${EQ2UIPage[popup,ZoneTeleporter].IsVisible}
		{
			press -release ${RI_Var_String_ForwardKey}
			RIMUIObj:Door[ALL,0]
		}
		wait 1
	}
	press -release ${RI_Var_String_ForwardKey}
	wait ${_Wait} ${EQ2.Zoning}==0
	press -release ${RI_Var_String_ForwardKey}
}
function ZoneFly(float _X, float _Z,int _Wait=600)
{
	if !${RI_Var_Bool_GlobalOthers}
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Zone ${_X} ${_Z} ${_Wait}"]
	wait 5
	Face ${_X} ${_Z}
	wait 2
	press ${RI_Var_String_AutoRunKey}
	timedcommand 150 press -release s
	
	variable int _Counter
	_Counter:Set[0]
	while ${EQ2.Zoning}==0 && ${_Counter:Inc}<${_Wait}
	{
		if ${EQ2UIPage[popup,ZoneTeleporter].IsVisible}
		{
			press s
			waitframe
			press s
			RIMUIObj:Door[ALL,0]
		}
		wait 1
	}
	press s
	wait ${_Wait} ${EQ2.Zoning}==0
	press s
}
function OpenDoor(string _DoorName, float _ClosedHeading, bool _WaitTilClosed=FALSE, int _WaitTimeOut=15)
{
	;echo OpenDoor(string _DoorName=${_DoorName}, float _ClosedHeading=${_ClosedHeading}, bool _WaitTilClosed=${_WaitTilClosed}, int _WaitTimeOut=${_WaitTilClosed})
	if ${_WaitTilClosed}
	{
		;echo waiting till closed
		variable int _WaitCount=0
		while ${Actor[Query, Name=-"${_DoorName}"].Heading}!=${_ClosedHeading} && ${_WaitCount:Inc}<=${_WaitTimeOut}
			wait 10
			;echo ${Actor[Query, Name=-"${_DoorName}"].Heading}!=${_ClosedHeading} && ${_WaitCount}<=${_WaitTimeOut}
		echo done waiting
	}
	_WaitCount:Set[0]
	if ${Actor[Query, Name=-"${_DoorName}"].Heading}==${_ClosedHeading}
	{
		;echo door is closed opening
		while ${Actor[Query, Name=-"${_DoorName}"].Heading}==${_ClosedHeading} && ${_WaitCount:Inc}<=${_WaitTimeOut}
		{
			;echo ${Actor[Query, Name=-"${_DoorName}"].Heading}==${_ClosedHeading} && ${_WaitCount:Inc}<=${_WaitTimeOut}
			Actor[Query, Name=-"${_DoorName}"]:DoubleClick
			wait 10
		}
	}
}
function UnpackItem(string _ItemName)
{
	wait 5
	eq2ex inventory unpack ${Me.Inventory[Query, Name=-"${_ItemName}" && Location=="Inventory"].Index}
	wait 10
}
function ExamineItem(string _ItemName, ... args)
{
	wait 5
	Me.Inventory[Query, Name=-"${_ItemName}" && Location=="Inventory"]:Examine
	wait 10
	; if ${Int[${_ReplyOption}]}!=-1
	; {
		; wait 20 ${ReplyDialog(exists)}
		; if ${ReplyDialog(exists)}
			; ReplyDialog:Choose[${_ReplyOption}]
		; wait 5
		; if ${ReplyDialog(exists)}
			; ReplyDialog:Choose[${_ReplyOption}]
	; }
	
	
	if (!${ReplyDialog.Replies(exists)} || ${args.Used}<1)
		return
    
	variable index:collection:string Options
    variable iterator OptionsIterator
    variable int OptionCounter = 0
	variable int _CNT
	for(_CNT:Set[1];${_CNT}<=${args.Used};_CNT:Inc)
	{
		if ${Int[${args[${_CNT}]}]}>0
			ReplyDialog:Choose[${Int[${args[${_CNT}]}]}]
		else
		{
			ReplyDialog.Replies:GetOptions[Options]
			Options:GetIterator[OptionsIterator]
			
			;echo "The current reply dialog window has ${Options.Used} reply options available"
			
			if (${OptionsIterator:First(exists)})
			{
				do
				{
					if (${OptionsIterator.Value.FirstKey(exists)})
					{
						do
						{
							if ${OptionsIterator.Value.CurrentValue.Find["${args[${_CNT}]}"]}
								ReplyDialog:Choose[${OptionCounter}]
							 ;echo "Option #${OptionCounter}::  '${OptionsIterator.Value.CurrentKey}' => '${OptionsIterator.Value.CurrentValue}'"
						}
						while ${OptionsIterator.Value.NextKey(exists)}
						;echo "------"
					}
					OptionCounter:Inc
				}
				while ${OptionsIterator:Next(exists)}
			}
		}
		wait 5
	}
}
function ExecuteRIMUIObjMethod(... args)
{
	if ${args.Used}>0
	{
		variable bool _RelayToGroup=FALSE
		variable int _acnt=0
		variable int _Cnt=1
		
		for(_acnt:Set[1];${_acnt}<=${args.Used};_acnt:Inc)
		{
			switch ${args[${_acnt}]}
			{
				case -RelayToGroup
				{
					_RelayToGroup:Set[1]
					_Cnt:Inc
					break
				}
			}
		}
		variable int _StartingCnt=${_Cnt}
		variable string _Executor=RIMUIObj:
		for(;${_Cnt}<=${args.Used};_Cnt:Inc)
		{
			if ${_Cnt}==${_StartingCnt}
				_Executor:Concat["${args[${_Cnt}]}["]
			elseif ${_Cnt}==${args.Used}
				_Executor:Concat["${args[${_Cnt}]}]"]
			else
				_Executor:Concat["${args[${_Cnt}]},"]
		}
		Execute ${_Executor}
	}
}
function TravelMap(string _ZoneToZoneName, int _ZoneOption=0, int _BellWizardDruid=0)
{
	if !${RI_Var_Bool_GlobalOthers}
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call RIMObj.TravelMap \"${_ZoneToZoneName}\" ${_ZoneOption} ${_BellWizardDruid}"]
	call RIMObj.TravelMap "${_ZoneToZoneName}" ${_ZoneOption} ${_BellWizardDruid}	
}
function DoorOption(string _Door)
{
	;echo DoorOption(string _Door=${_Door})
	if ${Int[${_Door}]}==0 && ${_Door.NotEqual[0]} && ${EQ2.Zoning}==0
	{
		;echo Name
		RIObj:GetZoneLists
		wait 5
		if ${RIObj.RowByName["${_Door}"]}==0
		{
			echo ISXRI: Can't find that zone in the Destination list
			return
		}
		wait 5
		relay ${RI_Var_String_RelayGroup} -noredirect RIMUIObj:Door[ALL,${RIObj.RowByName["${_Door}"]}]
		wait 5
	}
	else
	{
		;echo Number
		relay "${RI_Var_String_RelayGroup}" RIMUIObj:Door[ALL,${Int[${_Door}]}]
		wait 5
		relay "${RI_Var_String_RelayGroup}" RIMUIObj:Door[ALL,${Int[${_Door}]}]
		;EQ2UIPage[popup,ZoneTeleporter].Child[list,Destinations.DestinationList]:HighlightRow[${Int[${_Door}]}]
		wait 5
		;TimedCommand 5 EQ2UIPage[popup,ZoneTeleporter].Child[button,ZoneButton]:LeftClick
		;wait 5
	}
}
function CallToGuildHall(bool _WaitTillReady=TRUE, bool _RelayToGroup=TRUE)
{
	if !${RI_Var_Bool_GlobalOthers} && ${_RelayToGroup}
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call RIMObj.CallToGuildHall ${_WaitTillReady}"]
	call RIMObj.CallToGuildHall ${_WaitTillReady}
}
function FlyUp(float _HoldTime=1, bool HoldTimeIsYLoc=FALSE)
{
	if !${Me.FlyingUsingMount}
	{
		press -hold ${RI_Var_String_FlyUpKey}
		if ${HoldTimeIsYLoc}
			wait 1200 ${Math.Distance[${Me.Y},${_HoldTime}]}<5
		else
			wait ${_HoldTime}
		press -release ${RI_Var_String_FlyUpKey}
	}
}
function Harvest(string _Node, string _ItemNeeded, int _Amount=1)
{
	while ${Me.Inventory[Query, Location=="Inventory" && Name=-"${_ItemNeeded}"].Quantity}<${_Amount}
	{
		Actor[Query, Name=-"${_Node}"]:DoTarget
		wait 10
		Actor[Query, Name=-"${_Node}"]:DoubleClick
		wait 50
	}
}
function WaitForZoning(int _Wait=600)
{
	;echo waitforzoning
	if ${IJustZonedLessThan10SecondsAgo}
		return
	wait ${_Wait} ${EQ2.Zoning}==1
	wait ${_Wait} ${EQ2.Zoning}==0
}
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
variable int CurrentQuality=0
variable int CurrentProgress=0
variable int CurrentDurability=0
variable int TotalDurability=0
variable string CurrentReactive=""
variable string CurrentReactiveMID=""
variable int ChangeinDur=0
variable index:string ReactionAbility
variable index:string DurabilitySkills
variable index:string ProgressSkills
variable string TSSpell[4,3]
variable int Durability[2,4]
variable RICraftObject RICraft
variable bool Round=FALSE
variable bool chktotdur=FALSE
variable int counter
variable int tempdur
variable int tempkey
variable bool complete=FALSE
variable bool cancel=FALSE
variable bool craftingready=FALSE
function Farseas()
{
	call CraftIt "Far Seas Crafting Station" 1
}

function RICraftIt(string _Recipe, int _Amount=1, bool _CheckQTY=FALSE, string _ItemName=!SAME!, int _ItemQTY=-1)
{
	if ${_CheckQTY}
	{
		if ${_ItemQTY}==-1
			_ItemQTY:Set[${_Amount}]
		if ${_ItemName.Equal["!SAME!"]}
			_ItemName:Set["${_Recipe}"]
		while ${RIMUIObj.InventoryQuantity[${_ItemName}]}<${_ItemQTY}
		{
			call CraftIt "${_Recipe}" ${_Amount}
			wait 5
		}
	}
	else
		call CraftIt "${_Recipe}" ${_Amount}
}
function Justreact()
{
	call CraftIt 0 0 1 0 1
}
function Justreacte()
{
	call CraftIt 0 0 1 1 1
}
function RICraftSkills(string _Technique)
{
	switch ${_Technique}
	{
		case Experimentation
		{
			;echo exp
			_Experimentation:Set[1]
			;Focus (These have 6 different reactives as the dur and prog abilities are not matching icons)
			ReactionAbility:Insert[Scattered Method|11|410]
			ReactionAbility:Insert[Bad Habit|12|415]
			ReactionAbility:Insert[Fixed Clasp|13|421]
			ReactionAbility:Insert[Mental Rut|21|422]
			ReactionAbility:Insert[Deranged Measurements|22|404]
			ReactionAbility:Insert[Debased Material|23|424]
			ProgressSkills:Insert[Experimentation|1|Edit|410|2951775897]
			ProgressSkills:Insert[Experimentation|2|Tweak|415|2952886293]
			ProgressSkills:Insert[Experimentation|3|Enhance|421|3704970367]
			DurabilitySkills:Insert[Experimentation|1|Revise|422|688400815]
			DurabilitySkills:Insert[Experimentation|2|Calibrate|404|922343203]
			DurabilitySkills:Insert[Experimentation|3|Augment|424|1172049349]
			break
		}
		case Focus
		{
			_6Reactives:Set[1]
			;Focus (These have 6 different reactives as the dur and prog abilities are not matching icons)
			ReactionAbility:Insert[Sudden Spark|11]
			ReactionAbility:Insert[Butter Fingers|12]
			ReactionAbility:Insert[Brain Flatulence|13]
			ReactionAbility:Insert[Thermal Accident|21]
			ReactionAbility:Insert[Caught Sleeping|22]
			ReactionAbility:Insert[Squirrel!|23]
			ProgressSkills:Insert[Focus|1|Grounded]
			ProgressSkills:Insert[Focus|2|Pop Knuckles]
			ProgressSkills:Insert[Focus|3|Hold It]
			DurabilitySkills:Insert[Focus|1|Extinguish]
			DurabilitySkills:Insert[Focus|2|Awaken]
			DurabilitySkills:Insert[Focus|3|Concentrate Hard]
			break
		}
		case Geocraft
		{
			ReactionAbility:Insert[Dense Material|1]
			ReactionAbility:Insert[Major Dense Material|1]
			ReactionAbility:Insert[Minor Dense Material|1]
			ReactionAbility:Insert[Rough Edges|2]
			ReactionAbility:Insert[Minor Rough Edges|2]
			ReactionAbility:Insert[Major Rough Edges|2]
			ReactionAbility:Insert[Dull Luster|3]
			ReactionAbility:Insert[Minor Dull Luster|3]
			ReactionAbility:Insert[Major Dull Luster|3]
			ReactionAbility:Insert[Critical Channelling Instability|2]
			ReactionAbility:Insert[Lethal Flaws|2]
			ReactionAbility:Insert[Lethal Meltdown|3]
			ReactionAbility:Insert[Major Power Overload|3]
			ReactionAbility:Insert[Critical Channelling|2]
			ReactionAbility:Insert[Dark Matter|2]
			ReactionAbility:Insert[Chronoseal Spillage|1]
			ReactionAbility:Insert[Temporal Paradox|3]
			ProgressSkills:Insert[Geomancy|1|Fabricate|41|1159210129]
			ProgressSkills:Insert[Geomancy|2|Mold|416|445791132]
			ProgressSkills:Insert[Geomancy|3|Infuse|425|889428983]
			DurabilitySkills:Insert[Geomancy|1|Contrive|411|3692131627]
			DurabilitySkills:Insert[Geomancy|2|Shape|416|2208000550]
			DurabilitySkills:Insert[Geomancy|3|Permeate|425|2886388301]
			break
		}
		case Geomancy
		{
			ReactionAbility:Insert[Dense Material|1]
			ReactionAbility:Insert[Major Dense Material|1]
			ReactionAbility:Insert[Minor Dense Material|1]
			ReactionAbility:Insert[Rough Edges|2]
			ReactionAbility:Insert[Minor Rough Edges|2]
			ReactionAbility:Insert[Major Rough Edges|2]
			ReactionAbility:Insert[Dull Luster|3]
			ReactionAbility:Insert[Minor Dull Luster|3]
			ReactionAbility:Insert[Major Dull Luster|3]
			ReactionAbility:Insert[Critical Channelling Instability|2]
			ReactionAbility:Insert[Lethal Flaws|2]
			ReactionAbility:Insert[Lethal Meltdown|3]
			ReactionAbility:Insert[Major Power Overload|3]
			ReactionAbility:Insert[Critical Channelling|2]
			ReactionAbility:Insert[Dark Matter|2]
			ReactionAbility:Insert[Chronoseal Spillage|1]
			ReactionAbility:Insert[Temporal Paradox|3]
			ProgressSkills:Insert[Geomancy|1|Fabricate|41|1159210129]
			ProgressSkills:Insert[Geomancy|2|Mold|416|445791132]
			ProgressSkills:Insert[Geomancy|3|Infuse|425|889428983]
			DurabilitySkills:Insert[Geomancy|1|Contrive|411|3692131627]
			DurabilitySkills:Insert[Geomancy|2|Shape|416|2208000550]
			DurabilitySkills:Insert[Geomancy|3|Permeate|425|2886388301]
			break
		}
		case Weaponry
		{
			ReactionAbility:Insert[Water Quench|1|427]
			ReactionAbility:Insert[Saltwater Quench|1|427]
			ReactionAbility:Insert[Oil Quench|1|427]
			ReactionAbility:Insert[Minor Soft Metal|1|427]
			ReactionAbility:Insert[Soft Metal|1|427]
			ReactionAbility:Insert[Extensive Soft Metal|1|427]
			ReactionAbility:Insert[Brittle hardening|1|427]
			ReactionAbility:Insert[Severe brittle hardening|1|427]
			ReactionAbility:Insert[Red Hot Material|2|404]
			ReactionAbility:Insert[Red Hot Metal|2|404]
			ReactionAbility:Insert[Orange Hot Material|2|404]
			ReactionAbility:Insert[Orange Hot Metal|2|404]
			ReactionAbility:Insert[White Hot Material|2|404]
			ReactionAbility:Insert[White Hot Metal|2|404]
			ReactionAbility:Insert[Hasty tempering|2|404]
			ReactionAbility:Insert[Severe hasty tempering|2|404]
			ReactionAbility:Insert[Minor Hardened Metal|3|426]
			ReactionAbility:Insert[Hardened Metal|3|426]
			ReactionAbility:Insert[Extensive Hardened Metal|3|426]
			ReactionAbility:Insert[Weak annealling|3|426]
			ReactionAbility:Insert[Severe weak annealing|3|426]
			ReactionAbility:Insert[Weaponsmith's Insight|3|426]
			ReactionAbility:Insert[Flawless Hardening|1|427]
			ReactionAbility:Insert[Favor of Innovation|2|404]
			ReactionAbility:Insert[Far Seas Innovation|2|404]
			ProgressSkills:Insert[Weaponry|1|Hardening|427]
			ProgressSkills:Insert[Weaponry|2|Tempering|428]
			ProgressSkills:Insert[Weaponry|3|Anneal|426]
			DurabilitySkills:Insert[Weaponry|1|Set|427]
			DurabilitySkills:Insert[Weaponry|2|Strengthening|428]
			DurabilitySkills:Insert[Weaponry|3|Compress|426]
			break
		}
		case Runecraft
		{
			;echo rune
			ReactionAbility:Insert[Water Quench|1|427]
			ReactionAbility:Insert[Minor Magical Anomaly|1|]
			ReactionAbility:Insert[Magical Anomaly|1|]
			ReactionAbility:Insert[Major Magical Anomaly|1|]
			ReactionAbility:Insert[Minor Magical Influx|1|]
			ReactionAbility:Insert[Magical Influx|1|]
			ReactionAbility:Insert[Major Magical Influx|1|]
			ReactionAbility:Insert[Bad instinct|1|]
			ReactionAbility:Insert[Severe bad instinct|1|]
			ReactionAbility:Insert[Minor Paradigm Shift|2|]
			ReactionAbility:Insert[Paradigm Shift|2|]
			ReactionAbility:Insert[Major Paradigm Shift|2|]
			ReactionAbility:Insert[Loss of focus|2|]
			ReactionAbility:Insert[Severe loss of focus|2|]
			ReactionAbility:Insert[Small Impurities|3|]
			ReactionAbility:Insert[Impurities|3|]
			ReactionAbility:Insert[Major Impurities|3|]
			ReactionAbility:Insert[Uneven cut|3|]
			ReactionAbility:Insert[Severe uneven cut|3|]
			ReactionAbility:Insert[Jeweler's Insight|2|]
			ReactionAbility:Insert[Flawless Faceting|3|]
			ReactionAbility:Insert[Far Seas Innovation|1|]
			ProgressSkills:Insert[Runecraft|1|Mind Over Matter|419|376467363]
			ProgressSkills:Insert[Runecraft|2|Focus of Spirit|422|3469213844]
			ProgressSkills:Insert[Runecraft|3|Faceting|421|779566264]
			DurabilitySkills:Insert[Runecraft|1|Sixth Sense|419|2407087641]
			DurabilitySkills:Insert[Runecraft|2|Center of Spirit|422|1472287022]
			DurabilitySkills:Insert[Runecraft|3|Round Cut|421|3078515970]
			break
		}
		
	}
}
function CraftIt(string _Recipe, int _Amount=1, bool _KeepWindow=FALSE, bool _Experimentation=FALSE, bool _JustReact=FALSE)
{
	variable bool _6Reactives=FALSE
	variable string _Technique
	CurrentQuality:Set[4]
	complete:Set[FALSE]
	cancel:Set[FALSE]
	Round:Set[FALSE]
	chktotdur:Set[FALSE]
	craftingready:Set[FALSE]
	CurrentProgress:Set[0]
	CurrentDurability:Set[0]
	TotalDurability:Set[0]
	CurrentReactive:Set[""]
	CurrentReactiveMID:Set[""]
	ChangeinDur:Set[0]
	ReactionAbility:Clear
	DurabilitySkills:Clear
	ProgressSkills:Clear
	if ${Script[Buffer:Craft](exists)} 
		endscript buffer:craft
	if ${Script[EQ2Craft](exists)}
		endscript eq2craft
    echo ISXRI: Starting RI Craft, Crafting ${_Amount} of ${_Recipe}
	
    Durability[1,1]:Set[110]
    Durability[1,2]:Set[90]
    Durability[1,3]:Set[30]
    Durability[1,4]:Set[0]
    Durability[2,1]:Set[110]
    Durability[2,2]:Set[90]
    Durability[2,3]:Set[30]
    Durability[2,4]:Set[0]

    AddTrigger RICraft:Completed "You created @*@:@itemcreated@\\/a."
    AddTrigger RICraft:Canceled "Item creation cancelled.  However, fuel components were still consumed."
	; while !${Actor[Query,(Type=="Tradeskill Unit" && Distance<=4) || (Name=-"Dalnir's Forge" && Distance <15)](exists)}
	; {
		; MessageBox -skin eq2 "You must be within 4 of a tradeskill device, please move closer and unpause"
		; MainArrayCounter:Set[${Math.Calc[${MainArrayCount}-2]}]
		; RI_Var_Bool_Paused:Set[TRUE]
		; UIElement[Start@RI]:SetText[Resume]
		; while ${RI_Var_Bool_Paused}
		; {
			; wait 1
		; }
		; wait 5
	; }

	variable int _counter
	_counter:Set[1]
	while ${_JustReact}
	{
		waitframe
		Event[EQ2_onCraftRoundResult]:AttachAtom[EQ2_onCraftRoundResult]

		if ${complete}
		{
			Debug:Echo["CRAFT DETECTED COMPLETE -- clearing."]
			wait 10
			complete:Set[FALSE]
			Round:Set[FALSE]
		}
		if ${Round} && !${craftingready}
		{
		; Need to initialize our variables here.
		; Knowledge var, TSSpell var
			Debug:Echo[Round started, but we're not ready.]
			if ${EQ2UIPage[Tradeskills,Tradeskills].Child[text,Tradeskills.TabPages.Craft.Create.RecipeName](exists)}
			{
				if !${_Experimentation}
				{
					_Recipe:Set[${EQ2UIPage[Tradeskills,Tradeskills].Child[text,Tradeskills.TabPages.Craft.Create.RecipeName].GetProperty[LocalText]}]
					_Technique:Set[${Me.Recipe[${_Recipe}].Knowledge}]
				}
				else
					_Technique:Set[Experimentation]
				wait 2
				echo ${_Technique}

				call RICraftSkills ${_Technique}
				
				craftingready:Set[TRUE]
				CurrentQuality:Set[0]
				chktotdur:Set[TRUE]
				RICraft:InitCraftSkills[${_Technique}]
				echo RICraft:InitCraftSkills[${_Technique}]
				TotalDurability:Set[${Math.Calc[${CurrentDurability}-${ChangeinDur}]}]
			}
		}
		if ${Round} && ${craftingready}
		{
			Debug:Echo[CraftLite Starting to craft!]
			while ${CurrentQuality}<4 && !${complete} && !${cancel}
			{
				if ${Round}
				{
					Round:Set[FALSE]
					if ${chktotdur}
					{
						TotalDurability:Set[${Math.Calc[${CurrentDurability}-${ChangeinDur}]}]
						chktotdur:Set[FALSE]
						;echo setting TotalDurability to ${TotalDurability}
					}
					tempdur:Set[((${CurrentDurability}/${TotalDurability}*100)-80)/20*100]
					if ${_Experimentation}
						counter:Set[${RICraft.ReactionAbilityMID[${CurrentReactiveMID}]}]
					else
						counter:Set[${RICraft.ReactionAbility[${CurrentReactive}]}]
					if ${RI_Var_Bool_CraftDebug}
						echo Counter1:${counter}
					waitframe
					if ${RI_Var_Bool_CraftDebug}
						echo Counter2:${counter}
					call CastReactions ${counter} ${_Experimentation}
					CurrentReactive:Set[""]
				}
				waitframe
			}
		}
		
	}
	if !${Me.Recipe["${_Recipe}"](exists)} && !${Me.Recipe[1](exists)}
	{
		EQ2Execute /toggletradeskills
		wait 50 ${Me.Recipe["${_Recipe}"](exists)}
		EQ2Execute /toggletradeskills
	}
	wait 5
	
	while !${Me.Recipe["${_Recipe}"](exists)} && ${_counter:Inc}<=6
	{
		;echo recipe dne
		EQ2Execute /toggletradeskills
		wait 50 ${Me.Recipe["${_Recipe}"](exists)}
		EQ2Execute /toggletradeskills
	}
	;first check our resources
	if ${Me.Recipe[${_Recipe}](exists)}
	{
		;make sure we have the components needed
		
		do
		{
			wait 50 ${Me.Recipe[${_Recipe}].IsRecipeInfoAvailable}
			if ${Me.Recipe[${_Recipe}].IsRecipeInfoAvailable}
			{
				if ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent1.Name.NotEqual[N/A]}
				{
					while ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent1.QuantityOnHand} < ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent1.Quantity}
					{
						MessageBox -skin eq2 "You need ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent1.Quantity} of ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent1.Name} and only have ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent1.QuantityOnHand}"
						eq2ex start_broker
						wait 10
					}
				}
				if ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent2.Name.NotEqual[N/A]}
				{
					while ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent2.QuantityOnHand} < ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent2.Quantity}
					{
						MessageBox -skin eq2 "You need ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent2.Quantity} of ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent2.Name} and only have ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent2.QuantityOnHand}"
						eq2ex start_broker
						wait 10
					}
				}
				if ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent3.Name.NotEqual[N/A]}
				{
					while ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent3.QuantityOnHand} < ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent3.Quantity}
					{
						MessageBox -skin eq2 "You need ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent3.Quantity} of ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent3.Name} and only have ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent3.QuantityOnHand}"
						eq2ex start_broker
						wait 10
					}
				}
				if ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent4.Name.NotEqual[N/A]}
				{
					while ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent4.QuantityOnHand} < ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent4.Quantity}
					{
						MessageBox -skin eq2 "You need ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent4.Quantity} of ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent4.Name} and only have ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent4.QuantityOnHand}"
						eq2ex start_broker
						wait 10
					}
				}
				while ${Me.Recipe[${_Recipe}].ToRecipeInfo.Fuel.QuantityOnHand} < ${Me.Recipe[${_Recipe}].ToRecipeInfo.Fuel.Quantity}
				{
					MessageBox -skin eq2 "You need ${Me.Recipe[${_Recipe}].ToRecipeInfo.Fuel.Quantity} of ${Me.Recipe[${_Recipe}].ToRecipeInfo.Fuel.Name} and only have ${Me.Recipe[${_Recipe}].ToRecipeInfo.Fuel.QuantityOnHand}"
					eq2ex start_broker
					wait 10
				}
			}
		}
		while !${Me.Recipe[${_Recipe}].IsRecipeInfoAvailable} && ${_counter:Inc}<=6
		if !${Me.Recipe[${_Recipe}].IsRecipeInfoAvailable}
		{
			call MessageBox "We were unable to retrieve recipe info Open your tradeskill window to the recipe and resume"
		}
	}
	else
	{
		call MessageBox "Can not find Recipe: ${_Recipe} open your recipe book to the recipe and resume"
	}

	_Technique:Set[${Me.Recipe[${_Recipe}].Technique}]
	wait 2
	;echo ${_Technique}
	call RICraftSkills ${_Technique}
		
	if !${Me.Recipe[1](exists)}
		wait 60
	else
		wait 10

	wait 5

    ;craftingknowledge:Set[${Me.Recipe[${craftingrecipe}].Knowledge}]
    RICraft:InitCraftSkills[${Me.Recipe[${_Recipe}].Technique}]
    TotalDurability:Set[${Math.Calc[${CurrentDurability}-${ChangeinDur}]}]

	;create recipes
	variable int _count
	variable int _failcount
	for(_count:Set[1];${_count}<=${_Amount};_count:Inc)
	{
		wait 10
		Me.Recipe["${_Recipe}"]:Create
		wait 10
		;_failcnt:Set[1]
		;do
		;{
	;		;echo clicking Begin
;			EQ2UIPage[Tradeskills,Tradeskills].Child[button,Tradeskills.TabPages.Craft.Prepare.SummaryPage.BeginButton]:LeftClick;
			;wait 1
		;}
		;while !${EQ2UIPage[Tradeskills,Tradeskills].Child[button,Tradeskills.TabPages.Craft.Create.Stop](exists)} && ${_failcnt:Inc}<=50
		;wait 50 "${EQ2UIPage[Tradeskills,Tradeskills].Child[button,Tradeskills.TabPages.Craft.Create.Stop](exists)}"
        
		if ${_6Reactives}
			wait 50
		;echo before begin
		EQ2UIPage[Tradeskills,Tradeskills].Child[button,Tradeskills.TabPages.Craft.Prepare.SummaryPage.BeginButton]:LeftClick
		wait 2
		EQ2UIPage[Tradeskills,Tradeskills].Child[button,Tradeskills.TabPages.Craft.Prepare.SummaryPage.BeginButton]:LeftClick
		wait 2
		EQ2UIPage[Tradeskills,Tradeskills].Child[button,Tradeskills.TabPages.Craft.Prepare.SummaryPage.BeginButton]:LeftClick
		wait 15 "${EQ2UIPage[Tradeskills,Tradeskills].Child[button,Tradeskills.TabPages.Craft.Create.Stop](exists)}"
		wait 5
		;echo after begin

		Event[EQ2_onCraftRoundResult]:AttachAtom[EQ2_onCraftRoundResult]
		;if !${_6Reactives}
			call InitialRound
		;else
		;	wait 20

        chktotdur:Set[TRUE]
		wait 50 ${CurrentQuality}<4

        while ${CurrentQuality}<4 && !${complete} && !${cancel}
        {
            if ${Round}
            {
				Round:Set[FALSE]
                if ${chktotdur}
                {
                    TotalDurability:Set[${Math.Calc[${CurrentDurability}-${ChangeinDur}]}]
                    chktotdur:Set[FALSE]
                    ;echo setting TotalDurability to ${TotalDurability}
                }
                tempdur:Set[((${CurrentDurability}/${TotalDurability}*100)-80)/20*100]
				if ${_Experimentation}
                	counter:Set[${RICraft.ReactionAbilityMID[${CurrentReactiveMID}]}]
				else
					counter:Set[${RICraft.ReactionAbility[${CurrentReactive}]}]
				if ${RI_Var_Bool_CraftDebug}
					echo Counter1:${counter}
               	waitframe
				if ${RI_Var_Bool_CraftDebug}
					echo Counter2:${counter}
				call CastReactions ${counter} ${_Experimentation}
				CurrentReactive:Set[""]
            }
            waitframe
        }
        cancel:Set[FALSE]
        complete:Set[FALSE]
        wait 10
	}

	if !${_KeepWindow}
		relay "${RI_Var_String_RelayGroup}" eq2ex /hide_window TradeSkills.TradeSkills
    Event[EQ2_onCraftRoundResult]:DetachAtom[EQ2_onCraftRoundResult]
}

function ProcessArts()
{
	variable int tempvar

	tempkey:Set[1]
	tempdur:Set[((${CurrentDurability}/${TotalDurability}*100)-80)/20*100]

	if ${MakeRare}
	{
		tempvar:Set[2]
	}
	else
	{
		tempvar:Set[1]
	}

	if ${tempdur}>${Durability[${tempvar},2]}
	{
		call ProgressCombo
	}
	else
	{
		call DurabilityCombo
	}
}
function InitialRound()
{
	tempkey:Set[1]
	do
	{
		call CastReaction 1 ${tempkey}
	}
	while ${tempkey:Inc}<=3
}

function ProgressCombo()
{
	variable int tempvar
	if ${MakeRare}
	{
		tempvar:Set[2]
	}
	else
	{
		tempvar:Set[1]
	}

	do
	{
		call CastReaction 1 ${tempkey}
	}
	while ${tempkey:Inc}<=2

	if ${tempdur}<${Durability[${tempvar},1]} && ${Me.Power}/${Me.MaxPower}*100>${Durability[${tempvar},3]}
	{
		call CastReaction 2 3
	}
	elseif ${Me.Power}>${Durability[${tempvar},3]}
	{
		call CastReaction 1 3
	}
}
;gonna rewrite this to be a function that takes in the reaction and the time allowed (4s for experiment) 
;and will cast abilities based on those and durability and power
function CastReactions(int _ReactiveArt, bool _Exp=FALSE)
{
	variable uint skilltimer=${Script.RunningTime}
	variable int roundtimer=3750
	variable int _CastedReactions=0
	variable int _DurProg=1
	variable int _DurTarget=50
	variable string _CastOrder
	if ${_Exp}
	{
		if ${Math.Calc[(${CurrentDurability}*2)+${CurrentProgress}]}<2000
			_DurProg:Set[2]
		else
			_DurProg:Set[1]
	}
	else
	{
		if ${CurrentDurability}<50
			_DurProg:Set[2]
		else
			_DurProg:Set[1]
	}
	if ${_ReactiveArt}!=0
	{
		if ${_ReactiveArt}<=3
		{
			
			switch ${_ReactiveArt}
			{
				case 1
				{
					_CastOrder:Set[${_DurProg} 1|${_DurProg} 2|${_DurProg} 3]
					break
				}
				case 2
				{
					_CastOrder:Set[${_DurProg} 2|${_DurProg} 1|${_DurProg} 3]
					break
				}
				case 3
				{
					_CastOrder:Set[${_DurProg} 3|${_DurProg} 1|${_DurProg} 2]
					break
				}
			}
		}
		else
		{
			switch ${_ReactiveArt}
			{
				case 11
				{
					_CastOrder:Set[1 1|${_DurProg} 2|${_DurProg} 3]
					break
				}
				case 12
				{
					_CastOrder:Set[1 2|${_DurProg} 1|${_DurProg} 3]
					break
				}
				case 13
				{
					_CastOrder:Set[1 3|${_DurProg} 1|${_DurProg} 2]
					break
				}
				case 21
				{
					_CastOrder:Set[2 1|${_DurProg} 2|${_DurProg} 3]
					break
				}
				case 22
				{
					_CastOrder:Set[2 2|${_DurProg} 1|${_DurProg} 3]
					break
				}
				case 23
				{
					_CastOrder:Set[2 3|${_DurProg} 1|${_DurProg} 2]
					break
				}
			}
		}
	}
	else
	{
		_CastOrder:Set[${_DurProg} 1|${_DurProg} 2|${_DurProg} 3]
	}
	variable int _i
	for(_i:Set[1];${_i}<=3;_i:Inc)
	{
		if ${Script.RunningTime}>${Math.Calc[${skilltimer}+${roundtimer}]} || ${Round}
			return
		if ${_i}<3
			call CastReaction ${_CastOrder.Token[${_i},|]} ${Math.Calc[${skilltimer}+${roundtimer}]}
		else
		{
			if ${Me.Power}>30
				call CastReaction ${_CastOrder.Token[${_i},|]} ${Math.Calc[${skilltimer}+${roundtimer}]}
		}
	}
}
function CastReaction(int xability, int xtimer, int _timer=99999999999999999999999999999999999999999999999999999999999999999999)
{
	if ${RI_Var_Bool_CraftDebug}
		echo ISXRI: Casting Reaction: ${TSSpell[${xability},${xtimer}].Token[1,|]} // ${_timer}
	variable int _failcnt
	do
	{
		if ${Round}
		{
			eq2ex clearabilityqueue
			return
		}

		if ${Script.RunningTime}>${_timer}
		{
			eq2ex clearabilityqueue
			return
		}
	}
	while !${Me.Ability[id,${TSSpell[${xability},${xtimer}].Token[2,|]}].IsReady}
	_failcnt:Set[0]
	
	do
	{
		if ${Round}
		{
			eq2ex clearabilityqueue
			return
		}

		if ${Script.RunningTime}>${_timer}
		{
			eq2ex clearabilityqueue
			return
		}

		;if ( ${Me.CastingSpell} && ${Me.GetGameData[Spells.Casting].Label.Equal[${TSSpell[${xability},${xtimer}].Token[1,|]}]} ) || ${Me.Ability[id,${TSSpell[${xability},${xtimer}]}].TimeUntilReady}>0
		;	noop
		;else
			Me.Ability[id,${TSSpell[${xability},${xtimer}].Token[2,|]}]:Use
		wait 1
	}
	while ${Me.Ability[id,${TSSpell[${xability},${xtimer}].Token[2,|]}].TimeUntilReady}==0 && ${_failcnt:Inc}<=5
	
	eq2ex clearabilityqueue

	wait 5 ${Me.Maintained[${TSSpell[${xability},${xtimer}].Token[1,|]}](exists)} || ${Me.Ability[id,${TSSpell[${xability},${xtimer}]}].TimeUntilReady}>0 || ${Script.RunningTime}>${_timer}
	
	eq2ex clearabilityqueue
	if ${RI_Var_Bool_CraftDebug}
		echo ISXRI: Done Casting Reaction: ${TSSpell[${xability},${xtimer}].Token[1,|]}
}
function CastReactionOLD(int xability, int xtimer)
{
	variable uint skilltimer=${Script.RunningTime}

	do
	{
		if ${roundstart}
		{
			return
		}

		if ${Script.RunningTime}-${skilltimer}>${xtimer}*1900
		{
			return
		}
	}
	while !${Me.Ability[${TSSpell[${xability},${xtimer}]}].IsReady}

	Me.Ability[${TSSpell[${xability},${xtimer}]}]:Use

	wait 5 ${Me.Maintained[${TSSpell[${xability},${xtimer}]}](exists)}
}
function DurabilityCombo()
{
	variable int tempvar
	if ${MakeRare}
	{
		tempvar:Set[2]
	}
	else
	{
		tempvar:Set[1]
	}

	do
	{
		call CastReaction 2 ${tempkey}
	}
	while ${tempkey:Inc}<=2

	if ${tempdur}<${Durability[${tempvar},2]} && ${Me.Power}/${Me.MaxPower}*100>${Durability[${tempvar},3]}
	{
		call CastReaction 2 3
	}
}
atom(script) EQ2_onCraftRoundResult()
{
	CurrentReactive:Set[${Crafting.Message}]
	CurrentReactiveMID:Set[${Crafting.MainIconID}]
	CurrentQuality:Set[${Crafting.Quality}]
	CurrentProgress:Set[${Crafting.Progress}]
	CurrentDurability:Set[${Crafting.Durability}]
	ChangeinDur:Set[${Crafting.DurabilityMod}]
    Round:Set[TRUE]
}

objectdef RICraftObject
{
    member:int ReactionAbility(string _ReactionName)
    {
		;echo ReactionName: ${_ReactionName}
        variable int _i
        for(_i:Set[0];${_i}<=${ReactionAbility.Used};_i:Inc)
        {
            if ${ReactionAbility.Get[${_i}].Token[1,|].Equal[${_ReactionName}]}
                return ${Int[${ReactionAbility.Get[${_i}].Token[2,|]}]}
        }
        return 0
    }
	member:int ReactionAbilityMID(string _ReactionMID)
    {
		;echo ReactionMID: ${_ReactionMID}
        variable int _i
        for(_i:Set[0];${_i}<=${ReactionAbility.Used};_i:Inc)
        {
			;echo ${ReactionAbility.Get[${_i}]}
            if ${ReactionAbility.Get[${_i}].Token[3,|].Equal[${_ReactionMID}]}
                return ${Int[${ReactionAbility.Get[${_i}].Token[2,|]}]}
        }
        return 0
    }
    member:string SkillSpell(string _Skill, int _ProgDur, int _Type)
    {
        variable int _i
        if ${_ProgDur}==1
        {
            for(_i:Set[0];${_i}<=${ProgressSkills.Used};_i:Inc)
            {
                ;echo ${ProgressSkills.Get[${_i}].Token[1,|]} .Equal[${_Skill}]} && ${Int[${ProgressSkills.Get[${_i}].Token[2,|]}]}==${_Type} 
                if ${ProgressSkills.Get[${_i}].Token[1,|].Equal[${_Skill}]} && ${Int[${ProgressSkills.Get[${_i}].Token[2,|]}]}==${_Type}
                    return "${ProgressSkills.Get[${_i}].Token[3,|]}|${ProgressSkills.Get[${_i}].Token[5,|]}"
            }
        }
        else
        {
            for(_i:Set[0];${_i}<=${DurabilitySkills.Used};_i:Inc)
            {
                ;echo ${DurabilitySkills.Get[${_i}].Token[1,|]} .Equal[${_Skill}]} && ${Int[${DurabilitySkills.Get[${_i}].Token[2,|]}]}==${_Type} 
                if ${DurabilitySkills.Get[${_i}].Token[1,|].Equal[${_Skill}]} && ${Int[${DurabilitySkills.Get[${_i}].Token[2,|]}]}==${_Type}
                    return "${DurabilitySkills.Get[${_i}].Token[3,|]}|${DurabilitySkills.Get[${_i}].Token[5,|]}"
            }
        }
    }
    method InitCraftSkills(string _Skill)
	{
		; TSSpell[<1=Progress & 2=Durability>,<type>] Where type refers to
		; Type 1: 1=+Progress -Durability, 2=+Progress -Success, 3=+Progress -Power
		; Type 2: 1=+Durability -Progress, 2=+Durability -Success, 3=+Durability -Power
		if ${RI_Var_Bool_CraftDebug}
		{
			echo Skill: ${_Skill}
			echo TSSpell[1,1]:Set["${This.SkillSpell[${_Skill},1,1]}"]
			echo TSSpell[1,2]:Set["${This.SkillSpell[${_Skill},1,2]}"]
			echo TSSpell[1,3]:Set["${This.SkillSpell[${_Skill},1,3]}"]
			echo TSSpell[2,1]:Set["${This.SkillSpell[${_Skill},2,1]}"]
			echo TSSpell[2,2]:Set["${This.SkillSpell[${_Skill},2,2]}"]
			echo TSSpell[2,3]:Set["${This.SkillSpell[${_Skill},2,3]}"]
		}
		TSSpell[1,1]:Set["${This.SkillSpell[${_Skill},1,1]}"]
		TSSpell[1,2]:Set["${This.SkillSpell[${_Skill},1,2]}"]
		TSSpell[1,3]:Set["${This.SkillSpell[${_Skill},1,3]}"]
		TSSpell[2,1]:Set["${This.SkillSpell[${_Skill},2,1]}"]
		TSSpell[2,2]:Set["${This.SkillSpell[${_Skill},2,2]}"]
		TSSpell[2,3]:Set["${This.SkillSpell[${_Skill},2,3]}"]
		return
	}
    method Completed(string Line, string itemcreated)
	{
		complete:Set[TRUE]
		;chktotdur:Set[TRUE]
		;roundstart:Set[TRUE]
		;ItemsCreated:Insert[${itemcreated}]
	}
    method Canceled(string Line, string itemcreated)
	{
        echo ISXRI: RI Craft: You cancelled the combine! Was that intended?
		cancel:Set[TRUE]
		;chktotdur:Set[TRUE]
		;roundstart:Set[TRUE]
		;ItemsCreated:Insert[${itemcreated}]
	}
}
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  RI CRAFT  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

function OLDCraftItOLD(string _Recipe, int _Amount=1)
{
	; while !${Actor[Query,(Type=="Tradeskill Unit" && Distance<=4) || (Name=-"Dalnir's Forge" && Distance <15)](exists)}
	; {
		; MessageBox -skin eq2 "You must be within 4 of a tradeskill device, please move closer and unpause"
		; MainArrayCounter:Set[${Math.Calc[${MainArrayCount}-2]}]
		; RI_Var_Bool_Paused:Set[TRUE]
		; UIElement[Start@RI]:SetText[Resume]
		; while ${RI_Var_Bool_Paused}
		; {
			; wait 1
		; }
		; wait 5
	; }
	variable int _counter
	_counter:Set[1]
	if !${Me.Recipe["${_Recipe}"](exists)} && !${Me.Recipe[1](exists)}
	{
		EQ2Execute /toggletradeskills
		wait 50 ${Me.Recipe["${_Recipe}"](exists)}
		EQ2Execute /toggletradeskills
	}
	wait 5
	
	while !${Me.Recipe["${_Recipe}"](exists)} && ${_counter:Inc}<=6
	{
		EQ2Execute /toggletradeskills
		wait 50 ${Me.Recipe["${_Recipe}"](exists)}
		EQ2Execute /toggletradeskills
	}
	_counter:Set[1]
	;first check our resources
	if ${Me.Recipe[${_Recipe}](exists)}
	{
		;make sure we have the components needed
		
		do
		{
			wait 50 ${Me.Recipe[${_Recipe}].IsRecipeInfoAvailable}
			if ${Me.Recipe[${_Recipe}].IsRecipeInfoAvailable}
			{
				if ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent1.Name.NotEqual[N/A]}
				{
					while ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent1.QuantityOnHand} < ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent1.Quantity}
					{
						MessageBox -skin eq2 "You need ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent1.Quantity} of ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent1.Name} and only have ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent1.QuantityOnHand}"
						eq2ex start_broker
						wait 10
					}
				}
				if ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent2.Name.NotEqual[N/A]}
				{
					while ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent2.QuantityOnHand} < ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent2.Quantity}
					{
						MessageBox -skin eq2 "You need ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent2.Quantity} of ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent2.Name} and only have ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent2.QuantityOnHand}"
						eq2ex start_broker
						wait 10
					}
				}
				if ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent3.Name.NotEqual[N/A]}
				{
					while ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent3.QuantityOnHand} < ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent3.Quantity}
					{
						MessageBox -skin eq2 "You need ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent3.Quantity} of ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent3.Name} and only have ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent3.QuantityOnHand}"
						eq2ex start_broker
						wait 10
					}
				}
				if ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent4.Name.NotEqual[N/A]}
				{
					while ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent4.QuantityOnHand} < ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent4.Quantity}
					{
						MessageBox -skin eq2 "You need ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent4.Quantity} of ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent4.Name} and only have ${Me.Recipe[${_Recipe}].ToRecipeInfo.BuildComponent4.QuantityOnHand}"
						eq2ex start_broker
						wait 10
					}
				}
				while ${Me.Recipe[${_Recipe}].ToRecipeInfo.Fuel.QuantityOnHand} < ${Me.Recipe[${_Recipe}].ToRecipeInfo.Fuel.Quantity}
				{
					MessageBox -skin eq2 "You need ${Me.Recipe[${_Recipe}].ToRecipeInfo.Fuel.Quantity} of ${Me.Recipe[${_Recipe}].ToRecipeInfo.Fuel.Name} and only have ${Me.Recipe[${_Recipe}].ToRecipeInfo.Fuel.QuantityOnHand}"
					eq2ex start_broker
					wait 10
				}
			}
		}
		while !${Me.Recipe[${_Recipe}].IsRecipeInfoAvailable} && ${_counter:Inc}<=6
		if !${Me.Recipe[${_Recipe}].IsRecipeInfoAvailable}
		{
			call MessageBox "We were unable to retrieve recipe info Open your tradeskill window to the recipe and resume"
		}
	}
	else
	{
		call MessageBox "Can not find Recipe: ${_Recipe} open your recipe book to the recipe and resume"
	}
	
	;start craft lite no ui
	if !${Script[Buffer:Craft](exists)} && !${Script[EQ2Craft](exists)}
		run eq2craft -lite -hideui
	
	if !${Me.Recipe[1](exists)}
		wait 60
	else
		wait 10
	if ${MainQuestName.Get[${MainQuestName.Used}].NotEqual[Containing the Stone]} && ${MainQuestName.Get[${MainQuestName.Used}].NotEqual[Forging Onwards]}
	{
		Actor[Query,Type=="Tradeskill Unit"]:DoTarget
		Actor[Query,Type=="Tradeskill Unit"]:DoubleClick
	}
	wait 5
	;create recipes
	variable int _count
	for(_count:Set[1];${_count}<=${_Amount};_count:Inc)
	{
		Me.Recipe["${_Recipe}"]:Create
		wait 10
		EQ2UIPage[Tradeskills,Tradeskills].Child[button,Tradeskills.TabPages.Craft.Prepare.SummaryPage.BeginButton]:LeftClick
		wait 50 ${C.Q}<1
		wait 12000 ${C.Q}>3
		wait 10
	}

	relay "${RI_Var_String_RelayGroup}" eq2ex /hide_window TradeSkills.TradeSkills
}
function ScribeBook(string _BookName)
{
	wait 10
	relay "${RI_Var_String_RelayGroup}" RIMUIObj:ScribeBook[ALL,"${_BookName}"]
	wait 2
	relay "${RI_Var_String_RelayGroup}" RIMUIObj:ScribeBook[ALL,"${_BookName}"]
	wait 5
}
function SokokarTimelineCrafting()
{
	if ${QuestJournalWindow.CompletedQuest["Fangs Away!"](exists)} && ${QuestJournalWindow.CompletedQuest["An Eye in the Sky"](exists)} && ${QuestJournalWindow.CompletedQuest["Sticking My Ore In"](exists)} && ${QuestJournalWindow.CompletedQuest["Preparations for the Rescue"](exists)} && ${QuestJournalWindow.CompletedQuest["Is It Good News?"](exists)}
	{
		;show messagebox 
		MessageBox -skin eq2 "You have already completed the Sokokar Timeline Crafting"
		Script:End
	}
	if ${Me.TSLevel}<65
	{
		;show messagebox 
		MessageBox -skin eq2 "You must be Tradeskill Level 65 or higher to start this timeline"
		Script:End
	}
	if ${Me.Inventory[Query,Location=="Inventory" && Name=="ferrite cluster"].Quantity}<38
	{
		;show messagebox 
		MessageBox -skin eq2 "You must have at least 38 ferrite cluster in your inventory"
		eq2ex start_broker
		Script:End
	}
	if ${Me.Inventory[Query,Location=="Inventory" && Name=-"redwood lumber"].Quantity}<28
	{
		;show messagebox 
		MessageBox -skin eq2 "You must have at least 28 redwood lumber in your inventory"
		eq2ex start_broker
		Script:End
	}
	if ${Me.Inventory[Query,Location=="Inventory" && Name=-"smoldering coal"].Quantity}<28
	{
		;show messagebox 
		MessageBox -skin eq2 "You must have at least 70 Smoldering Coal in your inventory"
		eq2ex start_broker
		Script:End
	}
	
	;call SKTimelineStarter
	
	echo ISXRI: Starting Sokokar Timeline (Crafting)
	
	;call RIMObj.Move 836 12 252 1 0 FALSE FALSE TRUE FALSE
	
	wait 20
	
	;if not completed "Fangs Away!"
	if !${QuestJournalWindow.CompletedQuest["Fangs Away!"](exists)}
	{
		if ${QuestJournalWindow.ActiveQuest["Fangs Away!"](exists)}
		{
			QuestJournalWindow.ActiveQuest["Fangs Away!"]:Delete
			wait 5
		}
		call QuestDefault FangsAway
	}
	else
		echo ISXRI: Fangs Away! already Completed moving on
		
	;if not completed "An Eye in the Sky"
	if !${QuestJournalWindow.CompletedQuest["An Eye in the Sky"](exists)}
	{
		if ${QuestJournalWindow.ActiveQuest["An Eye in the Sky"](exists)}
		{
			QuestJournalWindow.ActiveQuest["An Eye in the Sky"]:Delete
			wait 5
		}
		call QuestDefault AnEyeintheSky
	}
	else
		echo ISXRI: An Eye in the Sky already Completed moving on
		
	;if not completed "Sticking My Ore In"
	if !${QuestJournalWindow.CompletedQuest["Sticking My Ore In"](exists)}
	{
		if ${QuestJournalWindow.ActiveQuest["Sticking My Ore In"](exists)}
		{
			QuestJournalWindow.ActiveQuest["Sticking My Ore In"]:Delete
			wait 5
		}
		call QuestDefault StickingMyOreIn
	}
	else
		echo ISXRI: Sticking My Ore In already Completed moving on
		
	;if not completed "Preperations for the Rescue"
	if !${QuestJournalWindow.CompletedQuest["Preparations for the Rescue"](exists)}
	{
		if ${QuestJournalWindow.ActiveQuest["Preparations for the Rescue"](exists)}
		{
			QuestJournalWindow.ActiveQuest["Preparations for the Rescue"]:Delete
			wait 5
		}
		
		call QuestDefault PreperationsfortheRescue
	}
	else
		echo ISXRI: Preperations for the Rescue already Completed moving on
		
	;if not completed "Is It Good News?"
	if !${QuestJournalWindow.CompletedQuest["Is It Good News?"](exists)}
	{
		if ${QuestJournalWindow.ActiveQuest["Is It Good News?"](exists)}
		{
			QuestJournalWindow.ActiveQuest["Is It Good News?"]:Delete
			wait 5
		}
		
		call QuestDefault IsItGoodNews
		
	}
	else
		echo ISXRI: Is It Good News? already Completed timeline done!
		
	echo ISXRI: Ending Sokokar Timeline (Crafting)
}
function Poismtsbutton()
{
	if !${QuestJournalWindow.ActiveQuest["A Restitch in Time: Security Measures"](exists)}
		return
	QuestJournalWindow.ActiveQuest["A Restitch in Time: Security Measures"]:MakeCurrentActiveQuest
	wait 2
	QuestJournalWindow.ActiveQuest["A Restitch in Time: Security Measures"]:MakeCurrentActiveQuest
	wait 2
	QuestJournalWindow.ActiveQuest["A Restitch in Time: Security Measures"]:MakeCurrentActiveQuest
	if ${RIObj.QuestStepExists[BLUE]}
	{
		RIMUIObj:SetLockSpot[ALL,${Actor["Blue Buzzer Button"].Loc}]
		wait 50
		Actor["Blue Buzzer Button"]:DoubleClick
		wait 2
		Actor["Blue Buzzer Button"]:DoubleClick
		wait 2
		Actor["Blue Buzzer Button"]:DoubleClick
		wait 50
		RIMUIObj:SetLockSpot[ALL,OFF]
	}
	elseif ${RIObj.QuestStepExists[RED]}
	{
		RIMUIObj:SetLockSpot[ALL,${Actor["Red Buzzer Button"].Loc}]
		wait 50
		Actor["Red Buzzer Button"]:DoubleClick
		wait 2
		Actor["Red Buzzer Button"]:DoubleClick
		wait 2
		Actor["Red Buzzer Button"]:DoubleClick
		wait 50
		RIMUIObj:SetLockSpot[ALL,OFF]
	}
	else
		call MessageBox "We were unable to determine the button to push. Push the correct button and resume"
	
}
function Quest(string _QuestName, int _ElementToJumpTo=0, bool _CheckQuestCompleted=TRUE)
{
	;echo Start of Quest: MainQuestName Size: ${MainQuestName.Used}
	press -release ${RI_Var_String_ForwardKey}
	variable string _ConvertedQuestName

	if ${_QuestName.Find["\""](exists)}
		_QuestName:Set["${_QuestName.Replace["\"",""]}"]
	;echo ${_QuestName} // ${_ElementToJumpTo}
	if ${_ElementToJumpTo}==0
		variable int _OriginalMAC=${MainArrayCounter}
	if ${_QuestName.Equal[101 Things to Do With a Dead Grindhoof]}
		_ConvertedQuestName:Set["ThingstoDoWithaDeadGrindhoof"]
	else
		_ConvertedQuestName:Set["${_QuestName.Replace[".",""].Replace["(",""].Replace[")",""].Replace["!",""].Replace["'",""].Replace["-",""].Replace[" ",""].Replace["?",""].Replace[",",""].Replace[":",""]}"]
	
	;relay ${RI_Var_String_RelayGroup} RI_CMD_Hidden_AddTLO ${_ConvertedQuestName.Upper}
	
	;wait 50 ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
	
	;if ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
	;	relay ${RI_Var_String_RelayGroup} -noredirect _PreGo_ "${_ConvertedQuestName.Upper}" 0 1
	;else
	;	relay ${RI_Var_String_RelayGroup} -noredirect ImportZoneFile "${_ConvertedQuestName}" 0

	declare FP filepath "${LavishScript.HomeDirectory}/Scripts/RI/ZoneFiles/"
	if ${FP.FileExists[${_QuestName}.dat]}
	{
		if ${Debug}
			ISXRI: File ${LavishScript.HomeDirectory}/Scripts/RI/ZoneFiles/${ZoneFileName}.dat found Importing
		relay ${RI_Var_String_RelayGroup} -noredirect ImportZoneFile ${_QuestName} 0
	}
	else
	{
		relay ${RI_Var_String_RelayGroup} RI_CMD_Hidden_AddTLO ${_ConvertedQuestName.Upper}
	
		wait 50 ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
		if ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
			relay ${RI_Var_String_RelayGroup} -noredirect _PreGo_ "${_ConvertedQuestName.Upper}" 0 1
	}

	wait 5
	wait 50 ${istrMain.Used}>0
	_QuestName:Set[${istrMain.Get[1]}]
	MainQuestName:Insert["${_QuestName}"]
	variable int _GiveUpCNT=0
	while ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual[${_QuestName}]} && ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual["${_QuestName}"]} && ( ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} || ${QuestJournalWindow.ActiveQuest[${_QuestName}](exists)} ) && ${_GiveUpCNT:Inc}<=10
	{
		squelch QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
		squelch QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
		squelch QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
		squelch QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
		Squelch wait 5 ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].Equal[${_QuestName}]} || ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].Equal["${_QuestName}"]}
	}
	_ConvertedQuestName:Set["${_QuestName.Replace["-",""].Replace[" ",""].Replace["?",""].Replace[",",""].Replace[":",""]}"]
	;echo ${_QuestName} // \${QuestJournalWindow.CompletedQuest["${_QuestName}"](exists)} // ${QuestJournalWindow.CompletedQuest["${_QuestName}"](exists)}
	variable bool _Repeatable
	if ${istrMain.Get[2].Equal[Repeatable]}
		_Repeatable:Set[TRUE]
	
	if ${_QuestName.Find["Brother Pang's Trial"](exists)}
		_QuestName:Concat[" "]
		
	if ${QuestJournalWindow.CompletedQuest["${_QuestName.Replace["\"",""]}"](exists)} && ( !${_Repeatable} || ${_ElementToJumpTo}>0 )
	{
		;MessageBox -skin eq2 "${_QuestName} is already completed"
		echo ISXRI: ${_QuestName.Replace["\"",""]} already Completed moving on
		;skip here
		_QuestName:Set["${MainQuestName.Get[${Math.Calc[${MainQuestName.Used}-1]}]}"]
		
		_GiveUpCNT:Set[0]
		while ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual["${_QuestName}"]} && ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} && ${_GiveUpCNT:Inc}<=10
		{
			QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
			wait 5 ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].Equal[${_QuestName}]}
		}
		_ConvertedQuestName:Set["${_QuestName.Replace[".",""].Replace["(",""].Replace[")",""].Replace["!",""].Replace["'",""].Replace["-",""].Replace[" ",""].Replace["?",""].Replace[",",""].Replace[":",""]}"]
		
		relay ${RI_Var_String_RelayGroup} RI_CMD_Hidden_AddTLO ${_ConvertedQuestName.Upper}
		
		wait 50 ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
		
		if ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
			relay ${RI_Var_String_RelayGroup} -noredirect _PreGo_ "${_ConvertedQuestName.Upper}" 0
		else
			relay ${RI_Var_String_RelayGroup} -noredirect ImportZoneFile "${_ConvertedQuestName}" 0
		wait 5
		wait 50 ${istrMain.Used}>0
		if ${_ElementToJumpTo}==0
			MainArrayCounter:Set[${_OriginalMAC}]
		else
			MainArrayCounter:Set[${_ElementToJumpTo}]
		
		;echo Setting ${_ElementToJumpTo} its now ${MainArrayCounter}
		MainQuestName:Remove[${MainQuestName.Used}]
		MainQuestName:Collapse
		;echo End of Quest: MainQuestName Size: ${MainQuestName.Used}
		return
	}
	else
	{
		echo ISXRI: ${Time} Starting ${_QuestName.Replace["\"",""]}
		
		call Go TRUE
		
		echo ISXRI: ${Time} Ending ${_QuestName.Replace["\"",""]}
		
		relay ${RI_Var_String_RelayGroup} RI_CMD_Hidden_RemoveTLO ${_ConvertedQuestName.Upper}
	}

	if ${_CheckQuestCompleted} && !${_QuestName.Find["Access to Tower of the Four Winds"](exists)} && !${_QuestName.Find["Yun Zi"](exists)} && !${_QuestName.Find[Timeline](exists)} && !${_QuestName.Find["Losers Weepers"](exists)} && !${_QuestName.Find["New Lands New Profits"](exists)}
	{
		waitframe
		if ${_QuestName.Find["Visions of Vetrovia: Wastes Not"](exists)}
		{
			squelch wait 100 ${QuestJournalWindow.CompletedQuest["Visions of Vetrovia: Wastes Not, Want Not"](exists)}
			if !${QuestJournalWindow.CompletedQuest["Visions of Vetrovia: Wastes Not, Want Not"](exists)}
				call MessageBox "Quest: Visions of Vetrovia: Wastes Not, Want Not not showing completed, check steps and finish manually and resume rq at ${Me.Loc}"
		}
		else
		{
			squelch wait 100 ${QuestJournalWindow.CompletedQuest[${_QuestName}](exists)}
			;echo \${QuestJournalWindow.CompletedQuest[${_QuestName}](exists)}  \\  ${QuestJournalWindow.CompletedQuest["${_QuestName}"](exists)}
			if !${QuestJournalWindow.CompletedQuest["${_QuestName}"](exists)}
				call MessageBox "Quest: ${_QuestName} not showing completed, check steps and finish manually and resume rq at ${Me.Loc}"
		}
	}
	_QuestName:Set["${MainQuestName.Get[${Math.Calc[${MainQuestName.Used}-1]}]}"]
	
	_GiveUpCNT:Set[0]
	while ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual["${_QuestName}"]} && ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} && ${_GiveUpCNT:Inc}<=10
	{
		squelch QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
		squelch QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
		Squelch wait 5 ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].Equal[${_QuestName}]}
	}
	_ConvertedQuestName:Set["${_QuestName.Replace[".",""].Replace["(",""].Replace[")",""].Replace["!",""].Replace["'",""].Replace["-",""].Replace[" ",""].Replace["?",""].Replace[",",""].Replace[":",""]}"]
	
	relay ${RI_Var_String_RelayGroup} RI_CMD_Hidden_AddTLO ${_ConvertedQuestName.Upper}
	
	wait 50 ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
	
	if ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
		relay ${RI_Var_String_RelayGroup} -noredirect _PreGo_ "${_ConvertedQuestName.Upper}" 0
	else
		relay ${RI_Var_String_RelayGroup} -noredirect ImportZoneFile "${_ConvertedQuestName}" 0
	wait 5	
	wait 50 ${istrMain.Used}>0
	;if ${_ElementToJumpTo}==0
		MainArrayCounter:Set[${_OriginalMAC}]
	;else
	;	MainArrayCounter:Set[${_ElementToJumpTo}]
	
	;echo Set MainArrayCounter back to ${MainArrayCounter}
	MainQuestName:Remove[${MainQuestName.Used}]
	MainQuestName:Collapse
	;echo End of Quest: MainQuestName Size: ${MainQuestName.Used}
	if ${Me.IsMoving}
	{
		press -release ${RI_Var_String_ForwardKey}
	}
	
}
function QuestRepeatFaction(string _QuestName, string _FactionName, int _Faction=0, int _ElementToJumpTo=0)
{
	MainQuestName:Insert["${_QuestName}"]
	if ${_ElementToJumpTo}==0
		variable int _OriginalMAC=${MainArrayCounter}

	if ${_QuestName.Find["\""](exists)}
		_QuestName:Set["${_QuestName.Replace["\"",""]}"]
		
	;MainQuestName:Insert["${_QuestName}"]
	if !${RIMUIObj.FactionsInitialized}
	{
		echo ISXRI: Initializing Faction Data
		wait 100 ${RIMUIObj.FactionsInitialized}
		echo ISXRI: Done Initializing Faction Data
	}
	wait 5
	if ${RIMUIObj.FactionAmount[${_FactionName}]}>=${_Faction}
	{
		;show messagebox 
		echo ISXRI: ${_QuestName}, Your faction with ${_FactionName} is ${RIMUIObj.FactionAmount[${_FactionName}]} which is already greater than or equal to ${_Faction} moving on
		;skip here
		_QuestName:Set["${MainQuestName.Get[${Math.Calc[${MainQuestName.Used}-1]}]}"]
		
		_GiveUpCNT:Set[0]
		while ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual["${_QuestName}"]} && ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} && ${_GiveUpCNT:Inc}<=10
		{
			QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
			wait 5 ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].Equal[${_QuestName}]}
		}
		_ConvertedQuestName:Set["${_QuestName.Replace[".",""].Replace["(",""].Replace[")",""].Replace["!",""].Replace["'",""].Replace["-",""].Replace[" ",""].Replace["?",""].Replace[",",""].Replace[":",""]}"]
		
		relay ${RI_Var_String_RelayGroup} RI_CMD_Hidden_AddTLO ${_ConvertedQuestName.Upper}
		
		wait 50 ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
		
		if ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
			relay ${RI_Var_String_RelayGroup} -noredirect _PreGo_ "${_ConvertedQuestName.Upper}" 0
		else
			relay ${RI_Var_String_RelayGroup} -noredirect ImportZoneFile "${_ConvertedQuestName}" 0
		wait 5
		wait 50 ${istrMain.Used}>0
		if ${_ElementToJumpTo}==0
			MainArrayCounter:Set[${_OriginalMAC}]
		else
			MainArrayCounter:Set[${_ElementToJumpTo}]
		
		;echo Setting ${_ElementToJumpTo} its now ${MainArrayCounter}
		MainQuestName:Remove[${MainQuestName.Used}]
		MainQuestName:Collapse
		;echo End of Quest: MainQuestName Size: ${MainQuestName.Used}
		return
	}
	elseif ${RIMUIObj.FactionAmount[${_FactionName}]}==-1 || ${RIMUIObj.FactionAmount[${_FactionName}]}==0
	{
		InputBox -skin eq2 "We were unable to read the faction amount for ${_FactionName} how many times would you like to run ${_QuestName}?"
		while ${UserInput.Equal[""]} || ${String[${UserInput}].Equal[NULL]} || ${String[${UserInput}].Equal[0]}
		{
			MessageBox -skin eq2 "You must enter a number of times (1 is ok)"
			InputBox -skin eq2 "How many times would you like to run the Repeatable quest: ${_QuestName}?"
			wait 1
		}
		call QuestRepeat "${_QuestName}" ${UserInput}
		return
	}
	variable int _qcount=0
	;for(_qcount:Set[1];${_qcount}<=${_NumRepeats};_qcount:Inc)
	while ${RIMUIObj.FactionAmount[${_FactionName}]}<${_Faction} || !${RIMUIObj.FactionsInitialized}
	{
		if !${RIMUIObj.FactionsInitialized}
		{
			echo ISXRI: Initializing Faction Data
			wait 100 ${RIMUIObj.FactionsInitialized}
			echo ISXRI: Done Initializing Faction Data
			continue
		}
		;echo Start of Quest: MainQuestName Size: ${MainQuestName.Used}
		press -release ${RI_Var_String_ForwardKey}
		variable string _ConvertedQuestName
		;echo ${_QuestName} // ${ElementToJumpTo}
		;if ${_ElementToJumpTo}==0
		;	_OriginalMAC:Set[${MainArrayCounter}]
		if ${_QuestName.Equal[101 Things to Do With a Dead Grindhoof]}
			_ConvertedQuestName:Set["ThingstoDoWithaDeadGrindhoof"]
		else
			_ConvertedQuestName:Set["${_QuestName.Replace[".",""].Replace["(",""].Replace[")",""].Replace["!",""].Replace["'",""].Replace["-",""].Replace[" ",""].Replace["?",""].Replace[",",""].Replace[":",""]}"]
		
		relay ${RI_Var_String_RelayGroup} RI_CMD_Hidden_AddTLO ${_ConvertedQuestName.Upper}
		
		wait 50 ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
		
		if ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
			relay ${RI_Var_String_RelayGroup} -noredirect _PreGo_ "${_ConvertedQuestName.Upper}" 0
		else
			relay ${RI_Var_String_RelayGroup} -noredirect ImportZoneFile "${_ConvertedQuestName}" 0
		wait 5
		wait 50 ${istrMain.Used}>0
		_QuestName:Set[${istrMain.Get[1]}]
		variable int _GiveUpCNT=0
		while ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual[${_QuestName}]} && ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} && ${_GiveUpCNT:Inc}<=10
		{
			squelch QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
			squelch QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
			squelch QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
			squelch QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
			squelch wait 5 ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].Equal[${_QuestName}]}
		}
		_ConvertedQuestName:Set["${_QuestName.Replace["-",""].Replace[" ",""].Replace["?",""].Replace[",",""].Replace[":",""]}"]
		;echo ${_QuestName} // \${QuestJournalWindow.CompletedQuest["${_QuestName}"](exists)} // ${QuestJournalWindow.CompletedQuest["${_QuestName}"](exists)}
		variable bool _Repeatable
		if ${istrMain.Get[2].Equal[Repeatable]}
			_Repeatable:Set[TRUE]
		
		echo ISXRI: ${Time} Starting ${_QuestName} #${_qcount:Inc} Faction: ${RIMUIObj.FactionAmount[${_FactionName}]} Needed: ${_Faction}
;		of ${_NumRepeats}
		
		call Go TRUE
		
		echo ISXRI: ${Time} Ending ${_QuestName}
		
		if ${Me.IsMoving}
		{
			press -release ${RI_Var_String_ForwardKey}
		}
	}
	
	relay ${RI_Var_String_RelayGroup} RI_CMD_Hidden_RemoveTLO ${_ConvertedQuestName.Upper}

	_QuestName:Set["${MainQuestName.Get[${Math.Calc[${MainQuestName.Used}-1]}]}"]
	
	_GiveUpCNT:Set[0]
	while ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual["${_QuestName}"]} && ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} && ${_GiveUpCNT:Inc}<=10
	{
		squelch QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
		squelch QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
		squelch QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
		squelch QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
		Squelch wait 5 ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].Equal[${_QuestName}]}
	}
	_ConvertedQuestName:Set["${_QuestName.Replace[".",""].Replace["(",""].Replace[")",""].Replace["!",""].Replace["'",""].Replace["-",""].Replace[" ",""].Replace["?",""].Replace[",",""].Replace[":",""]}"]
	
	relay ${RI_Var_String_RelayGroup} RI_CMD_Hidden_AddTLO ${_ConvertedQuestName.Upper}
	
	wait 50 ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
	
	if ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
		relay ${RI_Var_String_RelayGroup} -noredirect _PreGo_ "${_ConvertedQuestName.Upper}" 0
	else
		relay ${RI_Var_String_RelayGroup} -noredirect ImportZoneFile "${_ConvertedQuestName}" 0
	wait 5
	wait 50 ${istrMain.Used}>0	
	;if ${_ElementToJumpTo}==0
		MainArrayCounter:Set[${_OriginalMAC}]
	;else
	;	MainArrayCounter:Set[${_ElementToJumpTo}]
	
	;echo Set MainArrayCounter back to ${MainArrayCounter}
	MainQuestName:Remove[${MainQuestName.Used}]
	MainQuestName:Collapse
	;echo End of Quest: MainQuestName Size: ${MainQuestName.Used}
	
	if ${Me.IsMoving}
	{
		press -release ${RI_Var_String_ForwardKey}
	}
}
function MakeCurrentActiveQuest(string _QuestName=${MainQuestName.Get[${MainQuestName.Used}]})
{
	QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
	QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
	QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
	QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
	QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
	QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
}
function QuestRepeat(string _QuestName, int _NumRepeats=1, int _ElementToJumpTo=0)
{
	MainQuestName:Insert["${_QuestName}"]
	if ${_QuestName.Find["\""](exists)}
		_QuestName:Set["${_QuestName.Replace["\"",""]}"]
	if ${_ElementToJumpTo}==0
		variable int _OriginalMAC=${MainArrayCounter}
	variable int _qcount=1
	for(_qcount:Set[1];${_qcount}<=${_NumRepeats};_qcount:Inc)
	{
		;echo Start of Quest: MainQuestName Size: ${MainQuestName.Used}
		press -release ${RI_Var_String_ForwardKey}
		variable string _ConvertedQuestName
		;echo ${_QuestName} // ${_ElementToJumpTo}
		
		if ${_QuestName.Equal[101 Things to Do With a Dead Grindhoof]}
			_ConvertedQuestName:Set["ThingstoDoWithaDeadGrindhoof"]
		else
			_ConvertedQuestName:Set["${_QuestName.Replace[".",""].Replace["(",""].Replace[")",""].Replace["!",""].Replace["'",""].Replace["-",""].Replace[" ",""].Replace["?",""].Replace[",",""].Replace[":",""]}"]
		
		relay ${RI_Var_String_RelayGroup} RI_CMD_Hidden_AddTLO ${_ConvertedQuestName.Upper}
		
		wait 50 ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
		;echo ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)} // ${${_ConvertedQuestName.Upper}[3rtZdjv7,1]}
		if ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
			relay ${RI_Var_String_RelayGroup} -noredirect _PreGo_ "${_ConvertedQuestName.Upper}" 0
		else
			relay ${RI_Var_String_RelayGroup} -noredirect ImportZoneFile "${_ConvertedQuestName}" 0
		wait 5
		wait 50 ${istrMain.Used}>0
		_QuestName:Set[${istrMain.Get[1]}]
		variable int _GiveUpCNT=0
		while ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual[${_QuestName}]} && ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} && ${_GiveUpCNT:Inc}<=10
		{
			squelch QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
			squelch QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
			squelch QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
			squelch QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
			squelch wait 5 ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].Equal[${_QuestName}]}
		}
		_ConvertedQuestName:Set["${_QuestName.Replace["-",""].Replace[" ",""].Replace["?",""].Replace[",",""].Replace[":",""]}"]
		;echo ${_QuestName} // \${QuestJournalWindow.CompletedQuest["${_QuestName}"](exists)} // ${QuestJournalWindow.CompletedQuest["${_QuestName}"](exists)}
		variable bool _Repeatable
		if ${istrMain.Get[2].Equal[Repeatable]}
			_Repeatable:Set[TRUE]
		
		echo ISXRI: ${Time} Starting ${_QuestName} #${_qcount} of ${_NumRepeats}
		
		call Go TRUE
		
		echo ISXRI: ${Time} Ending ${_QuestName}
		
		if ${Me.IsMoving}
		{
			press -release ${RI_Var_String_ForwardKey}
		}
	}
	
	relay ${RI_Var_String_RelayGroup} RI_CMD_Hidden_RemoveTLO ${_ConvertedQuestName.Upper}

	_QuestName:Set["${MainQuestName.Get[${Math.Calc[${MainQuestName.Used}-1]}]}"]
	
	_GiveUpCNT:Set[0]
	while ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual["${_QuestName}"]} && ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} && ${_GiveUpCNT:Inc}<=10
	{
		squelch QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
		squelch QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
		squelch QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
		squelch QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
		Squelch wait 5 ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].Equal[${_QuestName}]}
	}
	_ConvertedQuestName:Set["${_QuestName.Replace[".",""].Replace["(",""].Replace[")",""].Replace["!",""].Replace["'",""].Replace["-",""].Replace[" ",""].Replace["?",""].Replace[",",""].Replace[":",""]}"]
	
	relay ${RI_Var_String_RelayGroup} RI_CMD_Hidden_AddTLO ${_ConvertedQuestName.Upper}
	
	wait 50 ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
	
	if ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
		relay ${RI_Var_String_RelayGroup} -noredirect _PreGo_ "${_ConvertedQuestName.Upper}" 0
	else
		relay ${RI_Var_String_RelayGroup} -noredirect ImportZoneFile "${_ConvertedQuestName}" 0
	wait 5
	wait 50 ${istrMain.Used}>0
	;if ${_ElementToJumpTo}==0
		MainArrayCounter:Set[${_OriginalMAC}]
	;else
	;	MainArrayCounter:Set[${_ElementToJumpTo}]
	
	;echo Set MainArrayCounter back to ${MainArrayCounter}
	MainQuestName:Remove[${MainQuestName.Used}]
	MainQuestName:Collapse
	;echo End of Quest: MainQuestName Size: ${MainQuestName.Used}
	
	if ${Me.IsMoving}
	{
		press -release ${RI_Var_String_ForwardKey}
	}
}
function SetActiveQuest(string _QuestName)
{
	variable int _GiveUpCNT=0
	if ${_QuestName.Find["\""](exists)}
		_QuestName:Set["${_QuestName.Replace["\"",""]}"]
	while ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual[${_QuestName}]} && ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} && ${_GiveUpCNT:Inc}<=10
	{
		squelch QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
		squelch QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
		squelch QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
		squelch QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
		wait 5 ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].Equal[${_QuestName}]}
	}
}
function QuestDefault(string _QuestName, int _ElementToJumpTo=0, bool _CheckQuestCompleted=TRUE)
{
	;echo QuestDefault(string _QuestName=${_QuestName}, int _ElementToJumpTo=0=${_ElementToJumpTo}, bool _CheckQuestCompleted=TRUE=${_CheckQuestCompleted})
	;echo ${_QuestName.Token[1,|]}
	;echo "${_QuestName.Token[2,|]}" ${_QuestName.Token[2,|].Find[Repeatable]}
	if ${_QuestName.Find["\""](exists)}
		_QuestName:Set["${_QuestName.Replace["\"",""]}"]
	if ${_QuestName.Find[|](exists)}
	{
		if ${_QuestName.Token[2,|].Find[Repeatable]}
		{
			InputBox -skin eq2 "How many times would you like to run the Repeatable quest: ${_QuestName.Token[1,|]}?"
			while ${UserInput.Equal[""]} 
			{
				MessageBox -skin eq2 "You must enter a number of times (1 is ok)"
				InputBox -skin eq2 "How many times would you like to run the Repeatable quest: ${_QuestName.Token[1,|]}?"
				wait 1
			}
			if ${String[${UserInput}].Equal[NULL]} || ${String[${UserInput}].Equal[0]}
				return
			else
				call QuestRepeat "${_QuestName.Token[1,|]}" ${UserInput}
			return
		}
		_QuestName:Set["${_QuestName.Token[1,|]}"]
	}
	variable string _ConvertedQuestName
	
	if ${_QuestName.Equal[101 Things to Do With a Dead Grindhoof]}
		_ConvertedQuestName:Set["ThingstoDoWithaDeadGrindhoof"]
	else
		_ConvertedQuestName:Set["${_QuestName.Replace[".",""].Replace["(",""].Replace[")",""].Replace["!",""].Replace["'",""].Replace["-",""].Replace[" ",""].Replace["?",""].Replace[",",""].Replace[":",""]}"]
	;open dat or var and do all of it
	;echo ${_QuestName}  //  ${_QuestName.Replace[" ",""].Replace["?",""]}
	
	relay ${RI_Var_String_RelayGroup} RI_CMD_Hidden_AddTLO ${_ConvertedQuestName.Upper}
	
	wait 50 ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
	
	if ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
		relay ${RI_Var_String_RelayGroup} -noredirect _PreGo_ "${_ConvertedQuestName.Upper}"
	else
		relay ${RI_Var_String_RelayGroup} -noredirect ImportZoneFile "${_ConvertedQuestName}"
	wait 5
	wait 50 ${istrMain.Used}>0

	;echo ${istrMain.Get[1]} // ${istrMain.Used}
	_QuestName:Set[${istrMain.Get[1]}]
	MainQuestName:Insert["${_QuestName}"]
	variable int _GiveUpCNT=0
	while ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual[${_QuestName}]} && ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual["${_QuestName}"]} && ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual["${_QuestName}"]} && ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual[${_QuestName}]} && ( ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} || ${QuestJournalWindow.ActiveQuest[${_QuestName}](exists)} || ${QuestJournalWindow.ActiveQuest[${_QuestName}](exists)} || ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} ) && ${_GiveUpCNT:Inc}<=10
	{
		squelch QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
		squelch QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
		squelch QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
		squelch QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
		Squelch wait 5 ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].Equal[${_QuestName}]} || ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].Equal["${_QuestName}"]} || ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].Equal["${_QuestName}"]} || ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].Equal[${_QuestName}]}
	}
	
	variable bool _Repeatable
	if ${istrMain.Get[2].Equal[Repeatable]}
		_Repeatable:Set[TRUE]
		
	if ${_QuestName.Find["Brother Pang's Trial"](exists)}
		_QuestName:Concat[" "]
		
	if ${QuestJournalWindow.CompletedQuest["${_QuestName}"](exists)} && ( !${_Repeatable} || ${_ElementToJumpTo}>0 )
	{
		;MessageBox -skin eq2 "${_QuestName} is already completed"
		echo ISXRI: ${_QuestName} already Completed moving on
		;skip here
		if ${_ElementToJumpTo}>0
			MainArrayCounter:Set[${_ElementToJumpTo}]
		return
	}
	echo ISXRI: ${Time} Starting ${_QuestName.Replace["\"",""]}
	
	call Go TRUE
	
	echo ISXRI: ${Time} Ending ${_QuestName.Replace["\"",""]}
	
	relay ${RI_Var_String_RelayGroup} RI_CMD_Hidden_RemoveTLO ${_ConvertedQuestName.Upper}
	
	MainQuestName:Clear	
	if ${Me.IsMoving}
	{
		press -release ${RI_Var_String_ForwardKey}
	}
	
	if ${_CheckQuestCompleted} && !${_QuestName.Find["Yun Zi"](exists)} && !${_QuestName.Find[Timeline](exists)} && !${_QuestName.Find[Tradeskill Mission](exists)} && !${_QuestName.Find["Losers Weepers"](exists)} && !${_QuestName.Find["New Lands New Profits"](exists)}
	{
		waitframe
		if ${_QuestName.Find["Visions of Vetrovia: Wastes Not"](exists)}
		{
			squelch wait 100 ${QuestJournalWindow.CompletedQuest["Visions of Vetrovia: Wastes Not, Want Not"](exists)}
			if !${QuestJournalWindow.CompletedQuest["Visions of Vetrovia: Wastes Not, Want Not"](exists)}
				call MessageBox "Quest: Visions of Vetrovia: Wastes Not, Want Not not showing completed, check steps and finish manually and resume rq at ${Me.Loc}"
		}
		else
		{
			squelch wait 100 ${QuestJournalWindow.CompletedQuest[${_QuestName}](exists)}
			;echo \${QuestJournalWindow.CompletedQuest[${_QuestName}](exists)}  \\  ${QuestJournalWindow.CompletedQuest["${_QuestName}"](exists)}
			if !${QuestJournalWindow.CompletedQuest["${_QuestName}"](exists)}
				call MessageBox "Quest: ${_QuestName} not showing completed, check steps and finish manually and resume rq at ${Me.Loc}"
		}
	}
}
function MakeActiveQuest(string _QuestName)
{
	variable int _GiveUpCNT=0
	;echo ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual[${_QuestName}]} && ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual["${_QuestName}"]} && ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual["${_QuestName}"]} && ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual[${_QuestName}]} && ( ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} || ${QuestJournalWindow.ActiveQuest[${_QuestName}](exists)} || ${QuestJournalWindow.ActiveQuest[${_QuestName}](exists)} || ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} ) && ${_GiveUpCNT:Inc}<=10
	while ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual[${_QuestName}]} && ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual["${_QuestName}"]} && ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual["${_QuestName}"]} && ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].NotEqual[${_QuestName}]} && ( ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} || ${QuestJournalWindow.ActiveQuest[${_QuestName}](exists)} || ${QuestJournalWindow.ActiveQuest[${_QuestName}](exists)} || ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} ) && ${_GiveUpCNT:Inc}<=10
	{
		QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
		QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
		QuestJournalWindow.ActiveQuest["${_QuestName}"]:MakeCurrentActiveQuest
		QuestJournalWindow.ActiveQuest[${_QuestName}]:MakeCurrentActiveQuest
		squelch wait 5 ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].Equal[${_QuestName}]} || ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].Equal["${_QuestName}"]} || ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].Equal["${_QuestName}"]} || ${QuestJournalWindow.CurrentQuest.Name.GetProperty[LocalText].Equal[${_QuestName}]}
	}
}
function GoFreeportQeynos(bool _RelayToGroup=TRUE)
{
	if ${_RelayToGroup} && !${RI_Var_Bool_GlobalOthers}
	{
		relay "other ${RI_Var_String_RelayGroup}" Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call GoFreeportQeynos"]
	}
	RIMUIObj:FastTravel[ALL,Freeport]
	wait 50 ${EQ2.Zoning}==1
	if ${EQ2.Zoning}==0
	{
		RIMUIObj:FastTravel[ALL,Qeynos,1]
		wait 50 ${EQ2.Zoning}==1
	}
	wait 6000 ${EQ2.Zoning}==0
}
function GoQeynosNeriak(bool _RelayToGroup=TRUE)
{
	if ${_RelayToGroup} && !${RI_Var_Bool_GlobalOthers}
	{
		relay "other ${RI_Var_String_RelayGroup}" Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call GoQeynosNeriak"]
	}
	RIMUIObj:FastTravel[ALL,Qeynos]
	wait 50 ${EQ2.Zoning}==1
	if ${EQ2.Zoning}==0
	{
		RIMUIObj:FastTravel[ALL,Neriak,1]
		wait 50 ${EQ2.Zoning}==1
	}
	wait 6000 ${EQ2.Zoning}==0
}
function CheckAndSet(... args)
{
	;currently this will goto the index of the highest index of all the found checks
	variable index:string _NamedNPC
	variable index:string _CompletedQuest
	variable index:string _ActiveQuest
	variable index:string _NotActiveQuest
	variable index:string _NearLocation
	variable index:string _NotNearLocation
	variable index:string _NearNPC
	variable index:string _QuestStepExistsStep
	variable index:int _NearDistance
	variable index:int _NotNearDistance
	variable index:int _Index
	variable index:string _InZoneName
	variable index:string _NotInZoneName
	variable int _HighestIndex=0
	variable bool _NoGrabShinys
	variable bool _Expert
	variable bool _Heroic
	variable bool _Solo
	variable bool _QuestStepExists
	variable int _acnt=0
	for(_acnt:Set[1];${_acnt}<=${args.Used};_acnt:Inc)
	{
		;echo args ${_acnt} : ${args[${_acnt}]}
		switch ${args[${_acnt}]}
		{
			case -QuestStepExists
			{
				_QuestStepExists:Set[1]
				_QuestStepExistsStep:Insert["${args[${Math.Calc[${_acnt}+1]}]}"]
				_Index:Insert[${Int[${args[${Math.Calc[${_acnt}+2]}]}]}]
				break
			}
			case -NoGrabShinys
			{
				_NoGrabShinys:Set[1]
				_Index:Insert[${Int[${args[${Math.Calc[${_acnt}+1]}]}]}]
				break
			}
			case -NamedNPC
			{
				_NamedNPC:Insert["${args[${Math.Calc[${_acnt}+1]}]}"]
				_Index:Insert[${Int[${args[${Math.Calc[${_acnt}+2]}]}]}]
				break
			}
			case -NamedNPCDNE
			{
				_NamedNPC:Insert["${args[${Math.Calc[${_acnt}+1]}]}-DNE"]
				_Index:Insert[${Int[${args[${Math.Calc[${_acnt}+2]}]}]}]
				break
			}
			case -Expert
			{
				_Expert:Set[1]
				_Index:Insert[${Int[${args[${Math.Calc[${_acnt}+1]}]}]}]
				break
			}
			case -Heroic
			{
				_Heroic:Set[1]
				_Index:Insert[${Int[${args[${Math.Calc[${_acnt}+1]}]}]}]
				break
			}
			case -Solo
			{
				_Solo:Set[1]
				_Index:Insert[${Int[${args[${Math.Calc[${_acnt}+1]}]}]}]
				break
			}
			case -CompletedQuest
			{
				_CompletedQuest:Insert["${args[${Math.Calc[${_acnt}+1]}]}"]
				_Index:Insert[${Int[${args[${Math.Calc[${_acnt}+2]}]}]}]
				break
			}
			case -ActiveQuest
			{
				_ActiveQuest:Insert["${args[${Math.Calc[${_acnt}+1]}]}"]
				_Index:Insert[${Int[${args[${Math.Calc[${_acnt}+2]}]}]}]
				break
			}
			case -NotActiveQuest
			{
				_NotActiveQuest:Insert["${args[${Math.Calc[${_acnt}+1]}]}"]
				_Index:Insert[${Int[${args[${Math.Calc[${_acnt}+2]}]}]}]
				break
			}
			case -NearNPC
			{
				_NearNPC:Insert["${args[${Math.Calc[${_acnt}+1]}]}"]
				_NearDistance:Insert["${args[${Math.Calc[${_acnt}+2]}]}"]
				_Index:Insert[${Int[${args[${Math.Calc[${_acnt}+3]}]}]}]
				break
			}
			case -NearLocation
			{
				_NearLocation:Insert["${args[${Math.Calc[${_acnt}+1]}]}"]
				_NearDistance:Insert["${args[${Math.Calc[${_acnt}+2]}]}"]
				_Index:Insert[${Int[${args[${Math.Calc[${_acnt}+3]}]}]}]
				break
			}
			case -NotNearLocation
			{
				_NotNearLocation:Insert["${args[${Math.Calc[${_acnt}+1]}]}"]
				_NotNearDistance:Insert["${args[${Math.Calc[${_acnt}+2]}]}"]
				_Index:Insert[${Int[${args[${Math.Calc[${_acnt}+3]}]}]}]
				break
			}
			case -InZone
			{
				_InZoneName:Insert["${args[${Math.Calc[${_acnt}+1]}]}"]
				_Index:Insert[${Int[${args[${Math.Calc[${_acnt}+2]}]}]}]
				break
			}
			case -NotInZone
			{
				_NotInZoneName:Insert["${args[${Math.Calc[${_acnt}+1]}]}"]
				_Index:Insert[${Int[${args[${Math.Calc[${_acnt}+2]}]}]}]
				break
			}
		}
	}
	if ${_Expert} && ${Zone.Name.Find["[Expert"](exists)}
	{
		;echo MainArrayCounter:Set[${Int[${_Index.Get[1]}]}]
		_HighestIndex:Set[${Int[${_Index.Get[1]}]}]
		;MainArrayCounter:Set[${Int[${_Index.Get[1]}]}]
	}
	if ${_Heroic} && ${Zone.Name.Find["Heroic]"](exists)}
	{
		;echo MainArrayCounter:Set[${Int[${_Index.Get[1]}]}]
		_HighestIndex:Set[${Int[${_Index.Get[1]}]}]
		;MainArrayCounter:Set[${Int[${_Index.Get[1]}]}]
	}
	if ${_Solo} && ${Zone.Name.Find["[Solo]"](exists)}
	{
		;echo MainArrayCounter:Set[${Int[${_Index.Get[1]}]}]
		_HighestIndex:Set[${Int[${_Index.Get[1]}]}]
		;MainArrayCounter:Set[${Int[${_Index.Get[1]}]}]
	}
	if ${_NoGrabShinys} && !${RI_Var_Bool_GrabShinys}
	{
		;echo MainArrayCounter:Set[${Int[${_Index.Get[1]}]}]
		_HighestIndex:Set[${Int[${_Index.Get[1]}]}]
		;MainArrayCounter:Set[${Int[${_Index.Get[1]}]}]
	}
	;echo ${_NamedNPC.Used}
	variable string _namedtmp
	for(_acnt:Set[1];${_acnt}<=${_NamedNPC.Used};_acnt:Inc)
	{
		if ${_NamedNPC.Get[${_acnt}].Find["-DNE"]}
		{
			_namedtmp:Set[${_NamedNPC.Get[${_acnt}].Left[-4]}]
			if !${Actor[NamedNPC,"${_namedtmp}"](exists)} && ${Int[${_Index.Get[${_acnt}]}]}>${_HighestIndex}
				_HighestIndex:Set[${Int[${_Index.Get[${_acnt}]}]}]
		}
		else
		{
			if ${Actor[NamedNPC,"${_NamedNPC.Get[${_acnt}]}"](exists)} && ${Int[${_Index.Get[${_acnt}]}]}>${_HighestIndex}
				_HighestIndex:Set[${Int[${_Index.Get[${_acnt}]}]}]
		}
	}
	for(_acnt:Set[1];${_acnt}<=${_NamedNPC.Used};_acnt:Inc)
	{
		if ${Actor[NamedNPC,"${_NamedNPC.Get[${_acnt}]}"](exists)} && ${Int[${_Index.Get[${_acnt}]}]}>${_HighestIndex}
			_HighestIndex:Set[${Int[${_Index.Get[${_acnt}]}]}]
	}
	;echo ${_HighestIndex}
	;echo ${_NearNPC.Used} // ${_NearDistance.Used}
	for(_acnt:Set[1];${_acnt}<=${_NearNPC.Used};_acnt:Inc)
	{
		;echo ${_NearNPC.Get[${_acnt}].Replace[" ",","]} // ${_NearDistance.Get[${_acnt}]}
		;echo \${Actor[${_NearNPC.Get[${_acnt}]}].Distance} ${Actor[${_NearNPC.Get[${_acnt}]}].Distance}<${_NearDistance.Get[${_acnt}]} && ${Int[${_Index.Get[${_acnt}]}]}>${_HighestIndex}
		if ${Actor[${_NearNPC.Get[${_acnt}]}].Distance}<${_NearDistance.Get[${_acnt}]} && ${Int[${_Index.Get[${_acnt}]}]}>${_HighestIndex}
			_HighestIndex:Set[${Int[${_Index.Get[${_acnt}]}]}]
	}
	;echo ${_NearLocation.Used} // ${_NearDistance.Used}
	for(_acnt:Set[1];${_acnt}<=${_NearLocation.Used};_acnt:Inc)
	{
		;echo ${_NearLocation.Get[${_acnt}].Replace[" ",","]} // ${_NearDistance.Get[${_acnt}]}
		;echo \${Me.Distance[${_NearLocation.Get[${_acnt}].Replace[" ",","]}]} ${Me.Distance[${_NearLocation.Get[${_acnt}].Replace[" ",","]}]}<${_NearDistance.Get[${_acnt}]} && ${Int[${_Index.Get[${_acnt}]}]}>${_HighestIndex}
		if ${Me.Distance[${_NearLocation.Get[${_acnt}].Replace[" ",","]}]}<${_NearDistance.Get[${_acnt}]} && ${Int[${_Index.Get[${_acnt}]}]}>${_HighestIndex}
			_HighestIndex:Set[${Int[${_Index.Get[${_acnt}]}]}]
	}
	;echo ${_NotNearLocation.Used} // ${_NotNearDistance.Used}
	for(_acnt:Set[1];${_acnt}<=${_NotNearLocation.Used};_acnt:Inc)
	{
		if ${Me.Distance[${_NotNearLocation.Get[${_acnt}].Replace[" ",","]}]}>${_NotNearDistance.Get[${_acnt}]} && ${Int[${_Index.Get[${_acnt}]}]}>${_HighestIndex}
			_HighestIndex:Set[${Int[${_Index.Get[${_acnt}]}]}]
	}
	;echo ${_InZoneName.Used} // ${_InZoneName.Used}
	for(_acnt:Set[1];${_acnt}<=${_InZoneName.Used};_acnt:Inc)
	{
		if ${Me.GetGameData[Self.ZoneName].Label.Find["${_InZoneName.Get[${_acnt}]}"](exists)} && ${Int[${_Index.Get[${_acnt}]}]}>${_HighestIndex}
			_HighestIndex:Set[${Int[${_Index.Get[${_acnt}]}]}]
	}
	;echo ${_NotInZoneName.Used} // ${_NotInZoneName.Used}
	for(_acnt:Set[1];${_acnt}<=${_NotInZoneName.Used};_acnt:Inc)
	{
		if !${Me.GetGameData[Self.ZoneName].Label.Find["${_NotInZoneName.Get[${_acnt}]}"](exists)} && ${Int[${_Index.Get[${_acnt}]}]}>${_HighestIndex}
			_HighestIndex:Set[${Int[${_Index.Get[${_acnt}]}]}]
	}
	;echo ${_QuestStepExistsStep.Used} // ${_QuestStepExistsStep.Used}
	for(_acnt:Set[1];${_acnt}<=${_QuestStepExistsStep.Used};_acnt:Inc)
	{
		if ${RIObj.QuestStepExists["${_QuestStepExistsStep.Get[${_acnt}]}"]} && ${Int[${_Index.Get[${_acnt}]}]}>${_HighestIndex}
			_HighestIndex:Set[${Int[${_Index.Get[${_acnt}]}]}]
	}
	;echo ${_CompletedQuest.Used} // ${_CompletedQuest.Used}
	for(_acnt:Set[1];${_acnt}<=${_CompletedQuest.Used};_acnt:Inc)
	{
		if ${QuestJournalWindow.CompletedQuest["${_CompletedQuest.Get[${_acnt}]}"](exists)} && ${Int[${_Index.Get[${_acnt}]}]}>${_HighestIndex}
			_HighestIndex:Set[${Int[${_Index.Get[${_acnt}]}]}]
	}
	;echo ${_ActiveQuest.Used} // ${_ActiveQuest.Used}
	for(_acnt:Set[1];${_acnt}<=${_ActiveQuest.Used};_acnt:Inc)
	{
		if ${QuestJournalWindow.ActiveQuest["${_ActiveQuest.Get[${_acnt}]}"](exists)} && ${Int[${_Index.Get[${_acnt}]}]}>${_HighestIndex}
			_HighestIndex:Set[${Int[${_Index.Get[${_acnt}]}]}]
	}
	;echo ${_NotActiveQuest.Used} // ${_NotActiveQuest.Used}
	for(_acnt:Set[1];${_acnt}<=${_NotActiveQuest.Used};_acnt:Inc)
	{
		if !${QuestJournalWindow.ActiveQuest["${_NotActiveQuest.Get[${_acnt}]}"](exists)} && ${Int[${_Index.Get[${_acnt}]}]}>${_HighestIndex}
			_HighestIndex:Set[${Int[${_Index.Get[${_acnt}]}]}]
	}
	;echo ${_HighestIndex}
	if ${_HighestIndex}>0
		MainArrayCounter:Set[${_HighestIndex}]
}
function Portal(string PortalName)
{
	variable string MyLoc="${Me.Loc}"
	;echo My Loc ${MyLoc}
	variable int NodeID=${Actor[Query, Name=-"${PortalName}" && Distance<10].ID}
	while ${Me.Distance[${MyLoc}]}<1
	{
		if ${NodeID}==0
			NodeID:Set[${Actor[Query, Name=-"${PortalName}" && Distance<10].ID}]
		if ${RI_Var_Bool_Debug}
			echo ISXRI: Distance From: ${MyLoc} = \${Me.Distance[${MyLoc}]} = ${Me.Distance[${MyLoc}]} // Im Clicking ${PortalName} = ${NodeID}
		Actor[id,${NodeID}]:DoubleClick
		wait 5 ${Me.CastingSpell}
		wait 50 !${Me.CastingSpell}
		wait 5
	}
	wait 20
}
function HarvestNode(string HarvestName, string ItemName, int Quantity=1)
{
	variable int NodeID=${Actor[Query, Name=-"${HarvestName}" && Distance<7].ID}
	while ${RIMUIObj.InventoryQuantity["${ItemName}"]}<${Quantity} && ${Actor[id, ${NodeID}](exists)} && ${NodeID}!=0
	{
		Actor[id, ${NodeID}]:DoubleClick
		wait 5 ${Me.CastingSpell}
		wait 50 !${Me.CastingSpell}
	}
	wait 20
}
function CheckQuest(... args)
{
	;currently this will goto the index of the highest index of all the found quests
	variable index:string _ActiveQuest
	variable index:int _ActiveIndex
	variable index:string _NotActiveQuest
	variable index:int _NotActiveIndex
	variable index:string _CompletedQuest
	variable index:int _CompletedIndex
	variable int _HighestIndex=0
	
	variable int _acnt=0
	for(_acnt:Set[1];${_acnt}<=${args.Used};_acnt:Inc)
	{
		;echo args ${_acnt} : ${args[${_acnt}]}
		switch ${args[${_acnt}]}
		{
			case -NotActive
			{
				_NotActiveQuest:Insert["${args[${Math.Calc[${_acnt}+1]}]}"]
				_NotActiveIndex:Insert[${Int[${args[${Math.Calc[${_acnt}+2]}]}]}]
				break
			}
			case -Active
			{
				_ActiveQuest:Insert["${args[${Math.Calc[${_acnt}+1]}]}"]
				_ActiveIndex:Insert[${Int[${args[${Math.Calc[${_acnt}+2]}]}]}]
				break
			}
			case -Completed
			{
				_CompletedQuest:Insert["${args[${Math.Calc[${_acnt}+1]}]}"]
				_CompletedIndex:Insert[${Int[${args[${Math.Calc[${_acnt}+2]}]}]}]
				break
			}
		}
	}
	;echo ${_ActiveQuest.Used} // ${_CompletedQuest.Used} // ${_NotActiveQuest.Used} 
	for(_acnt:Set[1];${_acnt}<=${_NotActiveQuest.Used};_acnt:Inc)
	{
		if !${QuestJournalWindow.ActiveQuest["${_NotActiveQuest.Get[${_acnt}]}"](exists)} && ${Int[${_NotActiveIndex.Get[${_acnt}]}]}>${_HighestIndex}
			_HighestIndex:Set[${Int[${_NotActiveIndex.Get[${_acnt}]}]}]
	}
	for(_acnt:Set[1];${_acnt}<=${_ActiveQuest.Used};_acnt:Inc)
	{
		if ${QuestJournalWindow.ActiveQuest["${_ActiveQuest.Get[${_acnt}]}"](exists)} && ${Int[${_ActiveIndex.Get[${_acnt}]}]}>${_HighestIndex}
			_HighestIndex:Set[${Int[${_ActiveIndex.Get[${_acnt}]}]}]
	}
	for(_acnt:Set[1];${_acnt}<=${_CompletedQuest.Used};_acnt:Inc)
	{
		if ${QuestJournalWindow.CompletedQuest["${_CompletedQuest.Get[${_acnt}]}"](exists)} && ${Int[${_CompletedIndex.Get[${_acnt}]}]}>${_HighestIndex}
			_HighestIndex:Set[${Int[${_CompletedIndex.Get[${_acnt}]}]}]
	}
	;echo ${_HighestIndex}
	if ${_HighestIndex}>0
		MainArrayCounter:Set[${_HighestIndex}]
}
function FlushQueued()
{
	FlushQueued
}
function CheckActiveQuest(string _QuestName, int _Element=0, bool _Pause=FALSE, string _Message="We were unable to get the quest. Get it and resume")
{
	;echo checking quest: ${_QuestName}: ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} and MAC: ${MainArrayCounter}
	if ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)}
	{
		if ${_Element}!=0 && !${_Pause}
			MainArrayCounter:Set[${_Element}]
	}
	else
	{
		if ${_Pause}
		{
			if ${_Element}!=0
				MainArrayCounter:Set[${_Element}]
			call MessageBox "${_Message}"
		}
	}
	;echo MAC: ${MainArrayCounter}
}
function CheckCompletedQuest(string _QuestName, int _Element=0, bool _Pause=FALSE, string _Message="Quest: ${_QuestName} not completed! Pausing")
{
	;echo checking quest: ${_QuestName}: ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} and MAC: ${MainArrayCounter}
	if ${QuestJournalWindow.CompletedQuest["${_QuestName}"](exists)}
	{
		if ${_Element}!=0 && !${_Pause}
			MainArrayCounter:Set[${_Element}]
	}
	else
	{
		if ${_Pause}
		{
			if ${_Element}!=0
				MainArrayCounter:Set[${_Element}]
			call MessageBox "${_Message}"
		}
	}
	;echo MAC: ${MainArrayCounter}
}
function RareShinyHunter(... args)
{
	if ${Zone.Name.Find["Solusek Ro's Tower: The Obsidian Core [Heroic]"]}
	{
		if ${Actor[Query, TintFlags=295 && HighlightOnMouseHover=TRUE](exists)}
		{
			Actor[Query, TintFlags=295 && HighlightOnMouseHover=TRUE]:WaypointTo
			call MessageBox "Solidified Magma Found. Waypointed. Go get and resume RI back at this location"
		}
	}
}
function RIMUIObj(... args)
{
	variable string argsin=""
	variable int _acnt
	for(_acnt:Set[2];${_acnt}<=${args.Used};_acnt:Inc)
	{
		if ${_acnt}<=${args.Used}
		{
			argsin:Concat["${args[${_acnt}]}"]
		}
		else
		{
			argsin:Concat["${args[${_acnt}]},"]
		}
	}
	relay ${RI_Var_String_RelayGroup} execute RIMUIObj:${args[1]}[${argsin}]
}
function AutoConsume(string _ItemName, bool _On, bool _RelayToGroup=TRUE)
{
	;echo AutoConsume(string _ItemName=${_ItemName}, bool _On=${_On}, bool _RelayToGroup=${_RelayToGroup})
	if ${_RelayToGroup} && !${RI_Var_Bool_GlobalOthers}
	{
		relay "other ${RI_Var_String_RelayGroup}" Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call AutoConsume \"${_ItemName}\" ${_On}"]
	}
	if !${Me.Inventory[Query, Name=-"${_ItemName}" && Location=="Inventory"](exists)}
		return
	variable int _cnt=0
	if ${_On}
	{
		;echo \${Me.Inventory[Query, Name=-"${_ItemName}" && Location=="Inventory"].AutoConsumeOn}:${Me.Inventory[Query, Name=-"${_ItemName}" && Location=="Inventory"].AutoConsumeOn}
		while !${Me.Inventory[Query, Name=-"${_ItemName}" && Location=="Inventory"].AutoConsumeOn} && ${_cnt:Inc}<60
		{
			Me.Inventory[Query, Name=-"${_ItemName}" && Location=="Inventory"]:ToggleAutoConsume
			wait 5
		}
	}
	else
	{
		while ${Me.Inventory[Query, Name=-"${_ItemName}" && Location=="Inventory"].AutoConsumeOn} && ${_cnt:Inc}<60
		{
			Me.Inventory[Query, Name=-"${_ItemName}" && Location=="Inventory"]:ToggleAutoConsume
			wait 5
		}
	}
}
function OpenMail(string _MailName, bool _OpenAttachment=TRUE ,bool _RelayToGroup=TRUE)
{
	variable int _i
	variable int _failcnt
	if !${RI_Var_Bool_GlobalOthers} && ${_RelayToGroup}
	{
		relay "other ${RI_Var_String_RelayGroup}" Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call OpenMail \"${_MailName}\""]
	}
	_failcnt:Set[0]
	while !${MailWindow.IsVisible} && ${_failcnt:Inc}<10
	{
		eq2ex start_mail
		wait 3
	}
	if !${MailWindow.IsVisible}
		call MessageBox "we were unable to open the Mail Window please do so and resume"
	
	for(_i:Set[0];${_i}<=${MailWindow.NumInbox};_i:Inc)
	{
		if ${MailWindow.Inbox[${_i}].Subject.Equal["${_MailName}"]}
		{
			MailWindow.Inbox[${_i}]:Open
			if ${_OpenAttachment}
			{
				wait 5
				MailWindow.Inbox[${_i}]:ReceiveAttachment
			}
		}
	}
	wait 5
	MailWindow:Close
}
function Path(... args)
{
	if ${RI_Var_Bool_PathDebug}
		echo ISXRI: Starting Path Function
	; if ${RI_Var_Bool_GlobalOthers}
	; {
		; relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[OFF]
		; relay ${RI_Var_String_RelayGroup} RIMUIObj:SetRIFollow[OFF]
		; relay ${RI_Var_String_RelayGroup} RI_Var_Bool_Follow:Set[0]
	; }
	;echo Path 
	variable int _PathLines=0
	variable int _ClosestPointScanPoints=0
	variable int _ClosestPointStart=0
	variable bool _RelayToGroup=0
	variable int _GroupWait=0
	variable int _acnt=0
	variable bool _StopForCombat=1
	variable bool _TargetSelf=0
	variable int _Precision=${Precision}
	variable bool _JumpAfterEachLoc=FALSE
	variable index:string _QueryActor
	;-ActorName|-Interactable|-QueryDistance|-MoveToDistance|-Trigger "Type:Text"|-Events
	;									DoubleClick&Hail&Kill&Harvest
	variable int _YINC=1
	variable bool _Interactable=FALSE
	variable bool _IsAggro=FALSE
	variable bool _UpdatesMyQuest=FALSE
	variable int _QueryDistance=50
	variable int _MoveToDistance=5
	variable string _ActorName
	variable index:string _QuestStep
	variable bool _QuestStepExists=FALSE
	variable bool _QuestStepChecked=FALSE
	variable bool _QuestExists=FALSE
	variable bool _QuestDNE=FALSE
	variable index:string _Quest
	variable string _Events
	variable bool _Done=FALSE
	variable bool _reversedone=FALSE
	variable bool _LoopPath=FALSE
	variable bool _ReversePath=FALSE
	variable bool _ReversePathLoopOnly=FALSE
	variable bool _IWasFlying=FALSE
	variable bool _CheckItemQty=FALSE
	variable int _ItemQty
	variable string _ItemName
	variable int _ID
	variable string _args=""
	variable string _tempName
	variable string _temp
	variable string _Actortemp
	variable bool _PauseBot=FALSE
	variable bool _PauseBotDuringEvent=FALSE
	variable string CommonTrigger=""
	variable int Wait=0
	variable bool _KeepMoving=TRUE
	variable bool _Found=FALSE
	variable bool _DontMove=FALSE
	variable bool _DifferentClosestPointScanPoints=FALSE
	variable bool _FightAtPathLoc=FALSE
	variable bool _CheckName=FALSE
	variable string _Name=""
	variable bool _DontFinishPathWhenDone=FALSE
	variable int _YDiff=99999999999999
	for(_acnt:Set[1];${_acnt}<=${args.Used};_acnt:Inc)
	{
		if ${RI_Var_Bool_PathDebug}
			echo Arguments ${_acnt} : ${args[${_acnt}]}
		if ${_acnt}==${args.Used}
		{
			if ${args[${_acnt}].Find[" "](exists)}
				_args:Concat["\"${args[${_acnt}]}\""]
			else
				_args:Concat["${args[${_acnt}]}"]
		}
		else
		{
			if ${args[${_acnt}].Find[" "](exists)}
				_args:Concat["\"${args[${_acnt}]}\" "]
			else
				_args:Concat["${args[${_acnt}]} "]
		}
		switch ${args[${_acnt}]}
		{
			case -DFPWD
			case -DontFinishPathWhenDone
			{
				_DontFinishPathWhenDone:Set[1]
				break
			}
			case -FAPL
			case -FightAtPathLoc
			{
				_FightAtPathLoc:Set[1]
				break
			}
			case -PL
			case -PathLines
			{
				_PathLines:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -YDifferential
			case -YDiff
			case -YD
			{
				_YDiff:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -YIncrease
			case -YINC
			case -YI
			{
				_YINC:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -P
			case -Precision
			{
				_Precision:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -L
			case -Loop
			{
				_LoopPath:Set[1]
				break
			}
			case -PB
			case -PauseBot
			{
				_PauseBot:Set[1]
				break
			}
			case -PBDE
			case -PauseBotDuringEvent
			{
				_PauseBotDuringEvent:Set[1]
				break
			}
			case -R
			case -Reverse
			{
				_ReversePath:Set[1]
				break
			}
			case -RLO
			case -ReverseLoopOnly
			{
				_ReversePathLoopOnly:Set[1]
				break
			}
			case -RTG
			case -RelayToGroup
			{
				_RelayToGroup:Set[1]
				break
			}
			case -GW
			case -GroupWait
			{
				_GroupWait:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -DSFC
			case -DontStopForCombat
			{
				_StopForCombat:Set[0]
				break
			}
			case -JAEL
			case -JumpAfterEachLoc
			{
				_JumpAfterEachLoc:Set[1]
				break
			}
			case -TS
			case -TargetSelf
			{
				_TargetSelf:Set[1]
				break
			}
			case -QA
			case -QueryActor
			{	
				_QueryActor:Insert["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -CT
			case -CommonTrigger
			{	
				CommonTrigger:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -W
			case -Wait
			{	
				Wait:Set["${Int[${args[${Math.Calc[${_acnt}+1]}]}]}"]
				break
			}
			case -CPSP
			case -ClosestPointScanPoints
			{
				_ClosestPointScanPoints:Set["${Int[${args[${Math.Calc[${_acnt}+1]}]}]}"]
				break
			}
		}
	}
	
	if ${RI_Var_Bool_GlobalOthers}
		wait ${_GroupWait}
	
	if ${_PauseBot}
		relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 1

	;echo ${_QueryActor.Get[1]}
	if !${RI_Var_Bool_GlobalOthers}
	{
		if ${_RelayToGroup}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[OFF]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetRIFollow[OFF]
			relay ${RI_Var_String_RelayGroup} RI_Var_Bool_Follow:Set[0]
			wait 1
			relay "other ${RI_Var_String_RelayGroup}" MainArrayCounter:Set[${MainArrayCounter}]
			; if ${_JumpAfterEachLoc}
				; relay "other ${RI_Var_String_RelayGroup}" Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Path -PathLines ${_PathLines} -Precision ${_Precision}"]
			; if ${_StopForCombat}
				; relay "other ${RI_Var_String_RelayGroup}" Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Path -PathLines ${_PathLines} -Precision ${_Precision}"]
			; else
				; relay "other ${RI_Var_String_RelayGroup}" Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Path -PathLines ${_PathLines} -Precision ${_Precision} -DontStopForCombat"]
			
			;might need to test this because timedcommand and screw up quotes at times
			;echo relay "other ${RI_Var_String_RelayGroup}" Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Path ${_args.EscapeQuotes}"]
			relay "other ${RI_Var_String_RelayGroup}" Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Path ${_args.EscapeQuotes}"]
		}
	}
	variable int _endpoint
	variable int _cnt
	variable int _i
	variable int _countor
	variable int _ecnt
	variable string _Query
	variable int _TriggeredCount=0
	variable int _start
	variable bool _whileCheck
	variable bool _goReverse=FALSE
	variable int _failcnt
	variable bool _Hailed=FALSE
	variable string _tempbtntxt
	variable bool _DontMoveActor=FALSE
	
	_start:Set[${MainArrayCounter}]
	if ${_TargetSelf}
		Actor[${Me.ID}]:DoTarget
	_endpoint:Set[${Math.Calc[${MainArrayCounter}+${_PathLines}]}]
	if ${RI_Var_Bool_PathDebug}
		Start: ${_start}  //  EndPoint: ${_endpoint}

	if ${_ClosestPointScanPoints}==0
	{
		_ClosestPointScanPoints:Set[${_PathLines}]
		_ClosestPointStart:Set[${_start}]
	}
	else
	{
		_DifferentClosestPointScanPoints:Set[1]
	}

	do
	{
		_whileCheck:Set[TRUE]
		while ${_whileCheck}
		{
			call ShinyCollection
			if ${_goReverse} 
			{
				if ${_Found}
					_Found:Set[FALSE]
				else
				{
					if ${MainArrayCounter:Dec}<=${_start}
					{
						if ${RI_Var_Bool_PathDebug}
							echo setting !_whileCheck because ${MainArrayCounter}<=${_start}
						_whileCheck:Set[0]
					}
				}
			}
			else
			{
				if ${_Found}
					_Found:Set[FALSE]
				else
				{
					if ${MainArrayCounter:Inc}>=${_endpoint}
					{
						if ${RI_Var_Bool_PathDebug}
							echo setting !_whileCheck because ${MainArrayCounter}>=${_endpoint}
						_whileCheck:Set[0]
					}
				}
			}
			if ${_DifferentClosestPointScanPoints}
			{
				if ${_goReverse}
				{
					if ${Math.Calc[${MainArrayCounter}-${Math.Calc[${_ClosestPointScanPoints}/2].Precision[0]}]}>${_end}
						_ClosestPointStart:Set[${_end}]
					else
						_ClosestPointStart:Set[${Math.Calc[${MainArrayCounter}+${Math.Calc[${_ClosestPointScanPoints}/2].Precision[0]}]}]
				}
				else
				{
					if ${Math.Calc[${MainArrayCounter}-${Math.Calc[${_ClosestPointScanPoints}/2].Precision[0]}]}<${_start}
						_ClosestPointStart:Set[${_start}]
					else
						_ClosestPointStart:Set[${Math.Calc[${MainArrayCounter}-${Math.Calc[${_ClosestPointScanPoints}/2].Precision[0]}]}]
				}
			}
			else
			{
				if ${_goReverse}
				{
					_ClosestPointScanPoints:Set[${_PathLines}]
					_ClosestPointStart:Set[${_end}]
				}
				else
				{
					_ClosestPointScanPoints:Set[${_PathLines}]
					_ClosestPointStart:Set[${_start}]
				}
			}
			if ${istrMain.Get[${MainArrayCounter}].Token[1,|].Equal[Wait]}
			{
				wait ${Int[${istrMain.Get[${MainArrayCounter}].Token[2,|]}]}
				continue
			}
			if ${istrMain.Get[${MainArrayCounter}].Token[1,|].Equal[ClickActor]}
			{
				CustomLoc:Set["0 0 0"]
				call ClickActor -Actor "${istrMain.Get[${MainArrayCounter}].Token[2,|]}"
				continue
			}
			if ${istrMain.Get[${MainArrayCounter}].Token[1,|].Equal[FlyUp]}
			{
				CustomLoc:Set["0 0 0"]
				call FlyUp "${istrMain.Get[${MainArrayCounter}].Token[2,|]}" "${istrMain.Get[${MainArrayCounter}].Token[3,|]}"
				continue
			}
			if ${istrMain.Get[${MainArrayCounter}].Token[1,|].Equal[FlyDown]}
			{
				CustomLoc:Set["0 0 0"]
				call FlyDown
				continue
			}
			if ${istrMain.Get[${MainArrayCounter}].Token[1,|].Equal[Target]}
			{
				CustomLoc:Set["0 0 0"]
				;echo call Target "${istrMain.Get[${MainArrayCounter}].Token[2,|]}" ${istrMain.Get[${MainArrayCounter}].Token[3,|]}
				call Target "${istrMain.Get[${MainArrayCounter}].Token[2,|]}" ${istrMain.Get[${MainArrayCounter}].Token[3,|]}
				continue
			}
			if ${_TriggeredCount}>=${_QueryActor.Used}
			{
				if ${RI_Var_Bool_PathDebug}
					echo TRIGGEREDCHECK: ${_TriggeredCount}>=${_QueryActor.Used} // ${MainArrayCounter}==${_start}
				if ${_ReversePath} && !${_goReverse}
				{
					if ${RI_Var_Bool_PathDebug}
						echo setting _goReverse && _reversedone && _whileCheck
					_goReverse:Set[1]
					_reversedone:Set[1]
					_whileCheck:Set[1]
				}
				if ${_DontFinishPathWhenDone} || ( ${MainArrayCounter}<=${_start} && ${_ReversePath} ) || ( !${_ReversePath} && ${MainArrayCounter}>=${_endpoint} )
				{
					if ${RI_Var_Bool_PathDebug}
						echo setting _done and !_goReverse and !_whileCheck
					_Done:Set[1]
					_goReverse:Set[0]
					_whileCheck:Set[0]
					if !${_StopForCombat}
						call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} ${_Precision} 0 1 0 1 0 1 1 0
					else
						call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} ${_Precision} 0 1 1 1 0 1 1 0
						
					;if ${_ReversePathLoopOnly} || !${_ReversePath}
						MainArrayCounter:Set[${_endpoint}]
					if ${RI_Var_Bool_PathDebug}
						echo setting _done and MAC to ${_endpoint}
					continue
				}
			}
			;;;;;; MOVE FUNCTIONS START
			if ${_goReverse}
			{
				if ${istrMain.Get[${Math.Calc[${MainArrayCounter}-1]}].Token[1,|].Equal[ClickActor]} || ${istrMain.Get[${Math.Calc[${MainArrayCounter}-1]}].Token[1,|].Equal[Wait]} || ${istrMain.Get[${Math.Calc[${MainArrayCounter}-1]}].Token[1,|].Equal[Target]}
					_KeepMoving:Set[FALSE]
				else
					_KeepMoving:Set[TRUE]
			}
			else
			{
				if ${istrMain.Get[${Math.Calc[${MainArrayCounter}+1]}].Token[1,|].Equal[ClickActor]} || ${istrMain.Get[${Math.Calc[${MainArrayCounter}+1]}].Token[1,|].Equal[Wait]} || ${istrMain.Get[${Math.Calc[${MainArrayCounter}+1]}].Token[1,|].Equal[Target]}
					_KeepMoving:Set[FALSE]
				else
					_KeepMoving:Set[TRUE]
			}
			;echo _KeepMoving: ${_KeepMoving}
			if ( ${MainArrayCounter}>=${_endpoint} || ${MainArrayCounter}<=${_start} || !${_KeepMoving} ) 
			{	
				if ${_DontMove}
				{
					_DontMove:Set[0]
				}
				else
				{
					;echo start move
					;echo Moving: call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} ${_Precision} 0 1 1 1 0 1 1 0
					;if !${_StopForCombat}
					;	call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} ${_Precision} 0 1 0 1 0 1 1 0
					;else
						call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} ${_Precision} 0 1 ${_StopForCombat} 1 0 1 1 0
				}
			}
			else
			{
				if ${_DontMove}
				{
					_DontMove:Set[0]
				}
				else
				{
					;echo not start move
					;echo Moving: call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} ${_Precision} 0
					;if !${_StopForCombat}
					;	call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} ${_Precision} 0 1 ${_StopForCombat} 1 1 1 1 0
					;else
						call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} ${_Precision} 0 1 ${_StopForCombat} 1 1 1 1 0
				}
			}
			if ${_JumpAfterEachLoc} && ${MainArrayCounter}!=${_endpoint} && ${MainArrayCounter}!=${_start}
				press ${RI_Var_String_JumpKey}
			;;;;;; MOVE FUNCTIONS END
			if !${_Done} && !${_reversedone}
			{
				_TriggeredCount:Set[0]
				for(_cnt:Set[1];${_cnt}<=${_QueryActor.Used};_cnt:Inc)
				{
					if ${RI_Var_Bool_PathDebug}
						echo Query Actor: ${_QueryActor.Get[${_cnt}]}
					if ${_QueryActor.Get[${_cnt}].NotEqual[*TRIGGERED*]}
					{
						IncomingText:Clear
						AnnounceText:Clear
						_QuestStep:Clear
						_Quest:Clear
						Trigger:Set[0]
						_Interactable:Set[FALSE]
						_IsAggro:Set[FALSE]
						_UpdatesMyQuest:Set[FALSE]
						_QueryDistance:Set[50]
						_MoveToDistance:Set[5]
						_ActorName:Set[""]
						_CheckItemQty:Set[FALSE]
						_ItemQty:Set[""]
						_ItemName:Set[""]
						_QuestStepExists:Set[FALSE]
						_IWasFlying:Set[0]
						_DontMoveActor:Set[FALSE]
						_CheckName:Set[FALSE]
						_Name:Set[""]
						if ${CommonTrigger.Token[1,:].Equal[IncomingText]}
							IncomingText:Insert["${CommonTrigger.Token[2,:]}"]
						if ${CommonTrigger.Token[1,:].Equal[AnnounceText]}
							AnnounceText:Insert["${CommonTrigger.Token[2,:]}"]
						for(_acnt:Set[1];${_acnt}<=${_QueryActor.Get[${_cnt}].Count[|]};_acnt:Inc)
						{
							if ${RI_Var_Bool_PathDebug}
								echo Query Actor Arguments: ${_acnt}: ${_QueryActor.Get[${_cnt}].Token[${_acnt},|]}
							switch ${_QueryActor.Get[${_cnt}].Token[${_acnt},|]}
							{
								case -CN
								case -CheckName
								{
									_CheckName:Set[1]
									break
								}
								case -DM
								case -DontMove
								{
									_DontMoveActor:Set[1]
									break
								}
								case -UMQ
								case -UpdatesMyQuest
								{
									_UpdatesMyQuest:Set[1]
									break
								}
								case -I
								case -Interactable
								{
									_Interactable:Set[1]
									break
								}
								case -IA
								case -IsAggro
								{
									_IsAggro:Set[1]
									break
								}
								case -A
								case -Actor
								case -ActorName
								{
									if ${RI_Var_Bool_PathDebug}
										echo Setting ActorName: ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|]}
									_ActorName:Set["${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|]}"]
									break
								}
								case -QD
								case -QueryDistance
								{
									_QueryDistance:Set[${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|]}]
									break
								}
								case -MTD
								case -MoveToDistance
								{
									_MoveToDistance:Set[${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|]}]
									break
								}
								case -T
								case -Trigger
								{
									;echo ${_QueryActor.Get[${_cnt}]} // ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[1,:]} // ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[1,:].Equal[AnnounceText]}
									;echo ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[1,:].Equal[QuestStepExists]}
									;echo 1
									if ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[1,:].Equal[AnnounceText]} || ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[1,:].Equal[AT]}
									{
										if ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Count["*"]}==0
											AnnounceText:Insert["${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:]}"]
										else
										{
											for(_countor:Set[1];${_countor}<=${Math.Calc[${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Count["*"]}+1]};_countor:Inc)
											{
												AnnounceText:Insert["${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Token[${_countor},*]}"]
											}
										}
									}
									;echo 2
									if ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[1,:].Equal[IncomingText]} || ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[1,:].Equal[IT]}
									{
										if ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Count["*"]}==0
											IncomingText:Insert["${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:]}"]
										else
										{
											for(_countor:Set[1];${_countor}<=${Math.Calc[${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Count["*"]}+1]};_countor:Inc)
											{
												IncomingText:Insert["${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Token[${_countor},*]}"]
											}
										}
									}
									;echo 3
									if ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[1,:].Equal[QuestStepExists]}
									{
										;echo QSE
										_QuestStepExists:Set[1]
										if ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Count["*"]}==0
											_QuestStep:Insert["${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:]}"]
										else
										{
											for(_countor:Set[1];${_countor}<=${Math.Calc[${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Count["*"]}+1]};_countor:Inc)
											{
												_QuestStep:Insert["${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Token[${_countor},*]}"]
											}
										}
									}
									;echo 4
									if ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[1,:].Equal[QuestExists]} || ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[1,:].Equal[QE]}
									{
										_QuestExists:Set[1]
										if ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Count["*"]}==0
											_Quest:Insert["${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:]}"]
										else
										{
											for(_countor:Set[1];${_countor}<=${Math.Calc[${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Count["*"]}+1]};_countor:Inc)
											{
												_Quest:Insert["${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Token[${_countor},*]}"]
											}
										}
									}
									;echo 5
									if ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[1,:].Equal[QuestDNE]} || ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[1,:].Equal[QDNE]}
									{
										_QuestDNE:Set[1]
										if ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Count["*"]}==0
											_Quest:Insert["${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:]}"]
										else
										{
											for(_countor:Set[1];${_countor}<=${Math.Calc[${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Count["*"]}+1]};_countor:Inc)
											{
												_Quest:Insert["${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Token[${_countor},*]}"]
											}
										}
									}
									;echo 6
									if ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[1,:].Equal[QuestStepChecked]} || ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[1,:].Equal[QSC]}
									{
										;echo in it baby
										_QuestStepChecked:Set[1]
										if ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Count["*"]}==0
										{
											;echo before insert
											_QuestStep:Insert["${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:]}"]
											;echo after insert
										}
										else
										{
											for(_countor:Set[1];${_countor}<=${Math.Calc[${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Count["*"]}+1]};_countor:Inc)
											{
												_QuestStep:Insert["${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Token[${_countor},*]}"]
											}
										}
									}
									;echo 7
									if ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[1,:].Equal[QuestStepDNE]} || ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[1,:].Equal[QSDNE]}
									{
										_QuestStepExists:Set[0]
										if ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Count["*"]}==0
											_QuestStep:Insert["${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:]}"]
										else
										{
											for(_countor:Set[1];${_countor}<=${Math.Calc[${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Count["*"]}+1]};_countor:Inc)
											{
												_QuestStep:Insert["${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Token[${_countor},*]}"]
											}
										}
									}
									;echo 8
									if ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[1,:].Equal[ItemQty]} || ${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[1,:].Equal[IQ]}
									{
										_CheckItemQty:Set[TRUE]
										_ItemName:Set["${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Token[1,-]}"]
										_ItemQty:Set["${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|].Token[2,:].Token[2,-]}"]
										;echo ${_CheckItemQty} // ${_ItemName} // ${_ItemQty}
									}
									;wait 50
									break
								}
								case -E
								case -Events
								{
									_Events:Set["${_QueryActor.Get[${_cnt}].Token[${Math.Calc[${_acnt}+1]},|]}"]
									break
								}
							}
						}
						if ${RI_Var_Bool_PathDebug}
							echo ActorName: ${_ActorName}
						if ${_ActorName.Find[:](exists)}
						{
							if ${RI_Var_Bool_PathDebug}
								echo MultipleActors: ${Math.Calc[${_ActorName.Count[:]}+1]}
							_Query:Set["( "]
							for(_countor:Set[1];${_countor}<=${Math.Calc[${_ActorName.Count[:]}+1]};_countor:Inc)
							{
								if ${RI_Var_Bool_PathDebug}
									echo Actor${_countor}: ${_ActorName.Token[${_countor},:]}
								if ${_ActorName.Token[${_countor},:].Left[3].Equal[TF-]}
								{
									if ${_countor}==${Math.Calc[${_ActorName.Count[:]}+1]}
										_Query:Concat["TintFlags=${_ActorName.Token[${_countor},:].Right[-3]} ) && Distance<=${_QueryDistance} && IsLocked=FALSE && IsDead=FALSE"]
									else
										_Query:Concat["TintFlags=${_ActorName.Token[${_countor},:].Right[-3]} || "]
								}
								else
								{
									if ${_countor}==${Math.Calc[${_ActorName.Count[:]}+1]}
										_Query:Concat["Name=-\"${_ActorName.Token[${_countor},:]}\" ) && Distance<=${_QueryDistance} && IsLocked=FALSE && IsDead=FALSE"]
									else
										_Query:Concat["Name=-\"${_ActorName.Token[${_countor},:]}\" || "]
								}
							}
						}
						elseif ${_IsAggro}
						{
							if ${_ActorName.Left[3].Equal[TF-]}
								_Query:Set["TintFlags=${_ActorName.Right[-3]} && Distance<=${_QueryDistance} && IsLocked=FALSE && IsDead=FALSE && IsAggro=TRUE"]
							elseif ${_ActorName.Left[3].Equal[OL+]}
								_Query:Set["Name=-\"${_ActorName.Token[2,+]}\" && Overlay==\"${_ActorName.Token[3,+]}\" && Distance<=${_QueryDistance} && IsLocked=FALSE && IsDead=FALSE"]
							else
								_Query:Set["Name=-\"${_ActorName}\" && Distance<=${_QueryDistance} && IsLocked=FALSE && IsDead=FALSE && IsAggro=TRUE"]
						}
						elseif ${_Interactable}
						{
							if ${_ActorName.Left[3].Equal[TF-]}
								_Query:Set["TintFlags=${_ActorName.Right[-3]} && Distance<=${_QueryDistance} && IsLocked=FALSE && IsDead=FALSE && Interactable=TRUE"]
							elseif ${_ActorName.Left[3].Equal[OL+]}
								_Query:Set["Name=-\"${_ActorName.Token[2,+]}\" && Overlay==\"${_ActorName.Token[3,+]}\" && Distance<=${_QueryDistance} && IsLocked=FALSE && IsDead=FALSE"]
							else
								_Query:Set["Name=-\"${_ActorName}\" && Distance<=${_QueryDistance} && IsLocked=FALSE && IsDead=FALSE && Interactable=TRUE"]
						}
						elseif ${_UpdatesMyQuest}
						{
							if ${_ActorName.Left[3].Equal[TF-]}
								_Query:Set["TintFlags=${_ActorName.Right[-3]} && Distance<=${_QueryDistance} && IsLocked=FALSE && IsDead=FALSE && UpdatesMyQuest=TRUE"]
							elseif ${_ActorName.Left[3].Equal[OL+]}
								_Query:Set["Name=-\"${_ActorName.Token[2,+]}\" && Overlay==\"${_ActorName.Token[3,+]}\" && Distance<=${_QueryDistance} && IsLocked=FALSE && IsDead=FALSE"]
							else
								_Query:Set["Name=-\"${_ActorName}\" && Distance<=${_QueryDistance} && IsLocked=FALSE && IsDead=FALSE && UpdatesMyQuest=TRUE"]
						}
						else
						{
							if ${_ActorName.Left[3].Equal[TF-]}
								_Query:Set["TintFlags=${_ActorName.Right[-3]} && Distance<=${_QueryDistance} && IsLocked=FALSE && IsDead=FALSE"]
							elseif ${_ActorName.Left[3].Equal[OL+]}
								_Query:Set["Name=-\"${_ActorName.Token[2,+]}\" && Overlay==\"${_ActorName.Token[3,+]}\" && Distance<=${_QueryDistance} && IsLocked=FALSE && IsDead=FALSE"]
							else
								_Query:Set["Name=-\"${_ActorName}\" && Distance<=${_QueryDistance} && IsLocked=FALSE && IsDead=FALSE"]
						}
						if ${RI_Var_Bool_PathDebug}
							echo ${_Query} // ${Actor[Query, ${_Query}](exists)} // ${Math.Distance[${Me.Y},${Actor[Query, ${_Query}].Y}]}<=${_YDiff}
						if ${Actor[Query, ${_Query}](exists)} && ${Math.Distance[${Me.Y},${Actor[Query, ${_Query}].Y}]}<=${_YDiff}
						{
							
							if ${RI_Var_Bool_PathDebug}
								echo _Interactable=${_Interactable} // ActorName=${_ActorName} // _QueryDistance=${_QueryDistance} // _MoveToDistance=${_MoveToDistance} // _Events=${_Events}
							_ID:Set[${Actor[Query, ${_Query}].ID}]
							if ${_CheckName}
								_Name:Set[${Actor[id,${_ID}].Name}]
							if ${RI_Var_Bool_PathDebug}
							{
								echo if ( ${Actor[id,${_ID}].Distance}<=${_MoveToDistance} || ${RIObj.ClosestPoint[${_ClosestPointStart},"${Actor[id,${_ID}].Loc}",${_ClosestPointScanPoints},${_goReverse}]}==${MainArrayCounter} ) && ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& \${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+${_YINC}]},${Actor[Query, ID=${_ID}].Z}]} = !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+${_YINC}]},${Actor[Query, ID=${_ID}].Z}]}
								;echo if ( ${Actor[id,${_ID}].Distance}<=${_MoveToDistance} || ${RIObj.ClosestPoint[${MainArrayCounter},"${Actor[id,${_ID}].Loc}",${Math.Calc[${_PathLines}-(${MainArrayCounter}-${_start})]},${_goReverse}]}==${MainArrayCounter} ) && ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& \${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+${_YINC}]},${Actor[Query, ID=${_ID}].Z}]} = !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+${_YINC}]},${Actor[Query, ID=${_ID}].Z}]}
								echo \${RIObj.ClosestPoint[${_ClosestPointStart},"${Actor[id,${_ID}].Loc}",${_ClosestPointScanPoints},${_goReverse}]}
							}
							;if ( ${Actor[id,${_ID}].Distance}<=${_MoveToDistance} || ${RIObj.ClosestPoint[${MainArrayCounter},"${Actor[id,${_ID}].Loc}",${Math.Calc[${_PathLines}-(${MainArrayCounter}-${_start})]},${_goReverse}]}==${MainArrayCounter} ) && ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+${_YINC}]},${Actor[Query, ID=${_ID}].Z}]}
							if ( ${Actor[id,${_ID}].Distance}<=${_MoveToDistance} || ${RIObj.ClosestPoint[${_ClosestPointStart},"${Actor[id,${_ID}].Loc}",${_ClosestPointScanPoints},${_goReverse}]}==${MainArrayCounter} ) && ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+${_YINC}]},${Actor[Query, ID=${_ID}].Z}]}
							{
								press -release ${RI_Var_String_ForwardKey}
								wait 2
								if ${Me.IsMoving}
								{
									press ${RI_Var_String_BackwardKey}
									press ${RI_Var_String_BackwardKey}
									press ${RI_Var_String_BackwardKey}
								}
								_Found:Set[TRUE]
								_Actortemp:Set["${Actor[id,${_ID}].X},${Actor[id,${_ID}].Y},${Actor[id,${_ID}].Z}"]
								_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
								_failcnt:Set[0]
								if ${Me.FlyingUsingMount} && !${_FightAtPathLoc}
								{
									if ${Me.FlyingUsingMount}
										_IWasFlying:Set[TRUE]
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_MoveToDistance} 0 FALSE ${_StopForCombat} TRUE FALSE TRUE TRUE
									if ${Actor[id,${_ID}].Distance[${_Actortemp}]}>${_MoveToDistance}
									{
										while ${_failcnt:Inc}<=150 && ${Actor[id,${_ID}].Distance}>${_MoveToDistance} && ( ${Math.Distance[${Me.X},${Me.Z},${Actor[id,${_ID}].X},${Actor[id,${_ID}].Z}]}>${_MoveToDistance} || ${Math.Distance[${Actor[id,${_ID}].Loc},${_Actortemp}]}>1)
										{
											;echo moving to mob
											if ${Math.Distance[${Actor[id,${_ID}].Loc},${_Actortemp}]}>${_QueryDistance}
											{
												RIMUIObj:SetLockSpot[ALL,OFF]
												continue
											}
											elseif ${Math.Distance[${Actor[id,${_ID}].Loc},${_Actortemp}]}>1
												RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ID}].Loc},${Math.Calc[${_MoveToDistance}-1]},1000]
											else
												RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ID}].X},${Me.Y},${Actor[Query, ID=${_ID}].Z},${Math.Calc[${_MoveToDistance}-1]},1000]
											wait 1
										}
										if ${_failcnt}>150
											continue
										RIMUIObj:SetLockSpot[ALL,OFF]
									}
									_failcnt:Set[0]
									while ${Me.FlyingUsingMount} && ${_failcnt:Inc}<10
									{
										;echo move down
										;&& ${Actor[Query, ID=${_ID}].Distance}>${_MoveToDistance}
										if ${RI_Var_Bool_PathDebug}
											echo We are flying, Flying down
										call RIMObj.FlyDown
										wait 5
									}
								}
								elseif ${Me.WaterDepth}>0 && ${Me.IsSwimming}
								{
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_MoveToDistance} 0 FALSE ${_StopForCombat} TRUE FALSE TRUE TRUE
								}
								else
								{
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_MoveToDistance} 0 FALSE ${_StopForCombat} TRUE FALSE TRUE TRUE
									if ${Actor[id,${_ID}].Distance[${_Actortemp}]}>${_MoveToDistance}
									{ 
										while ${_failcnt:Inc}<=150 && ${Actor[id,${_ID}].Distance}>${_MoveToDistance}
										{
											if ${Math.Distance[${Actor[id,${_ID}].Loc},${_Actortemp}]}>${_QueryDistance}
											{
												RIMUIObj:SetLockSpot[ALL,OFF]
												continue
											}
											else
												RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ID}].Loc},${Math.Calc[${_MoveToDistance}-1]},1000]
											wait 1
										}
										if ${_failcnt}>150
											continue
										RIMUIObj:SetLockSpot[ALL,OFF]
									}
								}
								if ${Math.Distance[${Actor[id,${_ID}].Loc},${_Actortemp}]}<1 && ${Actor[id,${_ID}](exists)} && ${_IWasFlying} && !${Me.FlyingUsingMount} && ${Math.Distance[${Actor[Query, ID=${_ID}].Y},${Me.Y}]}>${_MoveToDistance} && ${Me.Y}>${Actor[Query, ID=${_ID}].Y}
								{
									declarevariable _MEY float script ${Me.Y}
									if ${RI_Var_Bool_PathDebug}
										echo We are not flying but our Y is still more than ${_MoveToDistance} from ${Actor[Query, ID=${_ID}].Name} at ${Actor[Query, ID=${_ID}].Distance}>${_MoveToDistance} && ${Me.Y}>${Actor[Query, ID=${_ID}].Y}
									press -hold ${RI_Var_String_ForwardKey}
									press -hold ${RI_Var_String_FlyDownKey}
									wait 50 ${Math.Distance[${Me.Y},${_MEY}]}>${_MoveToDistance} || ${Me.FlyingUsingMount}
									Actor[Query, ID=${_ID}]:DoFace
									press -release ${RI_Var_String_ForwardKey}
									press -release ${RI_Var_String_FlyDownKey}
									deletevariable _MEY
								}
								_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
								if ${RI_Var_Bool_PathDebug}
									echo here we are at the actor lets determine our events
								if ${RI_Var_Bool_PathDebug}
									echo Events: ${_Events}
								for(_ecnt:Set[1];${_ecnt}<=${Math.Calc[${_Events.Count[&]}+1]};_ecnt:Inc)
								{
									if ${RI_Var_Bool_PathDebug}
										echo Event: ${_Events.Token[${_ecnt},&]}
									if ${_Events.Find["Call-"]} || ( ${_Events.Find["C-"]} && !${_Events.Find["KC-"]} )
									{
										call ${_Events.Token[2,-]} "${Me.Loc}"
										_QueryActor.Get[${_cnt}]:Set[*TRIGGERED*]
										continue
									}
									if ${_Events.Find["UseItem-"]} || ${_Events.Find["UI-"]}
									{
										if ${RI_Var_Bool_PathDebug}
											echo _PauseBotDuringEvent: ${_PauseBotDuringEvent}
										if ${RI_Var_Bool_PathDebug}
											echo ${_tempName}: while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ${_QueryActor.Get[${_cnt}].NotEqual[*TRIGGERED*]}
										if ${RI_Var_Bool_PathDebug}
											echo Locking AT ME: ${Actor[Query, ID=${_ID}].Distance}>${_MoveToDistance} // relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Loc},${_MoveToDistance},1000]
										relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Loc},1,1000]
										if ${_PauseBotDuringEvent}
										{
											relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 1
											wait 5
										}

										while ${Actor[Query, ID=${_ID} && IsDead=FALSE].Distance}<=${_QueryDistance} && ( ${Actor[Query, ID=${_ID} && IsDead=FALSE].Name.Equal[${_Name}]} || !${_CheckName} ) && ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ${_QueryActor.Get[${_cnt}].NotEqual[*TRIGGERED*]}
										{
											if ${RI_Var_Bool_BreakPathFunction}
											{
												RI_Var_Bool_BreakPathFunction:Set[0]
												return
											}
											if ${Me.FlyingUsingMount}
												call RIMObj.FlyDown
												
											if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
												Actor[Query, ID=${_ID}]:DoTarget
											wait 2
											Me.Inventory[Query, Name=="${_Events.Token[2,-]}" && Location=="Inventory"]:Use
											if ${RI_Var_Bool_PathDebug}
												echo Me.Inventory[Query, Name=="${_Events.Token[2,-]}" && Location=="Inventory"]:Use
											if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_MoveToDistance}+${_Precision}+1]} && !${_DontMoveActor}
											{
												;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_MoveToDistance} 0 0 0 1 0 1 1
												if ${RI_Var_Bool_PathDebug}
													echo Moving To ${Actor[Query, ID=${_ID}].Name}: ${Actor[Query, ID=${_ID}].Distance}>${_MoveToDistance} // relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ID}].Loc},${_MoveToDistance},1000]
												relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,OFF,1000]
												relay ${RI_Var_String_RelayGroup} RIMUIObj:SetRIFollow[ALL,${Me.ID}]
												if ${Actor[Query, ID=${_ID}].Distance}>=${_MoveToDistance}
													call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_MoveToDistance} 0 FALSE FALSE TRUE FALSE TRUE TRUE
												if ${RI_Var_Bool_PathDebug}
													echo Locking AT ME: ${Actor[Query, ID=${_ID}].Distance}>${_MoveToDistance} // relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Loc},${_MoveToDistance},1000]
												relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Loc},1,1000]
												wait 5
											}
											if ${Target.ID}==${Actor[Query, ID=${_ID}].ID} && ( !${Me.TargetLOS} || ${ICantSeeMyTarget} )
											{
												eq2ex target_none
												break
											}
											;member:bool PathTrigger(bool _CheckItemQty, bool _QuestStepExists, bool _QuestExists, bool _QuestDNE, bool _QuestStepChecked, string _tempName, weakref _QuestStep, weakref _Quest, string CommonTrigger)
											if ${RIObj.PathTrigger[${_CheckItemQty},${_ItemName},${_ItemQty},${_QuestStepExists},${_QuestExists},${_QuestDNE},${_QuestStepChecked},${_tempName},_QuestStep,_Quest,${CommonTrigger}]}
												_QueryActor.Get[${_cnt}]:Set[*TRIGGERED*]
										}
										wait ${Wait}
										if ${_PauseBotDuringEvent}
										{
											eq2ex target_none
											wait 3
											relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 0
											wait 2
										}
									}
									elseif ${_Events.Find["Hail-"]} || ${_Events.Find["H-"]}
									{
										;clickactor event
										_Hailed:Set[0]
										_tempbtntxt:Set[""]
										while ${Actor[Query, ID=${_ID} && IsDead=FALSE].Distance}<=${_QueryDistance} && ( ${Actor[Query, ID=${_ID} && IsDead=FALSE].Name.Equal[${_Name}]} || !${_CheckName} ) && ${Actor[Query, ID=${_ID}](exists)} && ${_QueryActor.Get[${_cnt}].NotEqual[*TRIGGERED*]}
										{
											if ${RI_Var_Bool_BreakPathFunction}
											{
												RI_Var_Bool_BreakPathFunction:Set[0]
												return
											}
											if ${Me.FlyingUsingMount}
												call RIMObj.FlyDown
											if ${_StopForCombat}
												call RIMObj.CheckCombat
											if !${_Hailed}
											{
												relay ${RI_Var_String_RelayGroup} Actor[${_ID}]:DoTarget
												wait 5
												relay ${RI_Var_String_RelayGroup} Actor[${_ID}]:DoubleClick
												wait 2
												relay ${RI_Var_String_RelayGroup} Actor[${_ID}]:DoubleClick
												wait 2
												relay ${RI_Var_String_RelayGroup} Actor[${_ID}]:DoubleClick
												_Hailed:Set[1]
											}
											for(_i:Set[1];${_i}<=${_Events.Token[2,-]};_i:Inc)
											{
												_tempbtntxt:Set["${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${_Events.Token[3,-]}].GetProperty[LocalText]}"]
												if ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1](exists)}
													relay ${RI_Var_String_RelayGroup} -noredirect EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${_Events.Token[3,-]}]:LeftClick
												wait 5
												wait 50 ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${_Events.Token[3,-]}].GetProperty[LocalText].NotEqual["${_tempbtntxt}"]}
											}

											if ${RIObj.PathTrigger[${_CheckItemQty},${_ItemName},${_ItemQty},${_QuestStepExists},${_QuestExists},${_QuestDNE},${_QuestStepChecked},${_tempName},_QuestStep,_Quest,${CommonTrigger}]}
												_QueryActor.Get[${_cnt}]:Set[*TRIGGERED*]
											
											if ${Actor[Query, ID=${_ID}].Distance}>=${_MoveToDistance} && !${_DontMoveActor}
												call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_MoveToDistance} 0 FALSE FALSE TRUE FALSE TRUE TRUE
										}
										break
									}
									elseif ${_Events.Find["KillClick-"]} || ${_Events.Find["KC-"]}
									{
										if ${RI_Var_Bool_PathDebug}
											echo ${_tempName}: while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ${_QueryActor.Get[${_cnt}].NotEqual[*TRIGGERED*]}
										if ${_FightAtPathLoc}
										{
											if ${RI_Var_Bool_PathDebug}
												echo Moving To ${Actor[Query, ID=${_ID}].Name}: ${Actor[Query, ID=${_ID}].Distance}>${_MoveToDistance}
											while ${Actor[Query, ID=${_ID}].Distance}>${_MoveToDistance} && !${Me.IsHated}
											{
												call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_MoveToDistance} 0 0 0 0 0
												waitframe
											}
											if ${RI_Var_Bool_PathDebug}
												echo Moving back to loc
											call RIMObj.Move ${_temp} ${_Precision} 0 0 0 0 0
										}
										else
										{
											if ${RI_Var_Bool_PathDebug}
												echo Locking AT ME: ${Actor[Query, ID=${_ID}].Distance}>${_MoveToDistance} // relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Loc},${_MoveToDistance},1000]
											relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Loc},1,1000]
										}
										while ${Actor[Query, ID=${_ID} && IsDead=FALSE].Distance}<=${_QueryDistance} && ( ${Actor[Query, ID=${_ID} && IsDead=FALSE].Name.Equal[${_Name}]} || !${_CheckName} ) && ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ${_QueryActor.Get[${_cnt}].NotEqual[*TRIGGERED*]}
										{
											if ${RI_Var_Bool_BreakPathFunction}
											{
												RI_Var_Bool_BreakPathFunction:Set[0]
												return
											}
											if ${Me.FlyingUsingMount}
												call RIMObj.FlyDown
											if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
												Actor[Query, ID=${_ID}]:DoTarget
											wait 2
											if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_MoveToDistance}+${_Precision}+1]} && !${_FightAtPathLoc} && !${_DontMoveActor}
											{
												;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_MoveToDistance} 0 0 0 1 0 1 1
												if ${RI_Var_Bool_PathDebug}
													echo Moving To ${Actor[Query, ID=${_ID}].Name}: ${Actor[Query, ID=${_ID}].Distance}>${_MoveToDistance} // relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ID}].Loc},${_MoveToDistance},1000]
												
												if ${Actor[Query, ID=${_ID}].Distance}>=${_MoveToDistance}
												{
													relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ID}].Loc},${_MoveToDistance},1000]
												}
												else
												{
													relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[~ALLBUT~${Me.Name},OFF,1000]
													relay ${RI_Var_String_RelayGroup} RIMUIObj:SetRIFollow[~ALLBUT~${Me.Name},${Me.ID}]
												}
												; && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<${_MoveToDistance}
												;	call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_MoveToDistance} 0 FALSE FALSE TRUE FALSE TRUE TRUE
												;if ${RI_Var_Bool_PathDebug}
												;	echo Locking AT ME: ${Actor[Query, ID=${_ID}].Distance}>${_MoveToDistance} // relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Loc},${_MoveToDistance},1000]
												
												wait 5
											}
											else
												relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[~ALLBUT~${Me.Name},${Me.Loc},1,1000]
											if ${Target.ID}==${Actor[Query, ID=${_ID}].ID} && ( !${Me.TargetLOS} || ${ICantSeeMyTarget} )
											{
												eq2ex target_none
												break
											}
											wait 20
											if ${Actor[Query, Name=-"${_Events.Token[2,-]}" && Distance<=${_QueryDistance}](exists)}
											{
												;clickactor event
												while ${Actor[Query, Name=-"${_Events.Token[2,-]}"].Distance}<=${_QueryDistance} && ${Actor[Query, Name=-"${_Events.Token[2,-]}"](exists)} && ${_QueryActor.Get[${_cnt}].NotEqual[*TRIGGERED*]} && ( ${Me.CastingSpell} || ${Actor[Query, Name=-"${_Events.Token[2,-]}"].Interactable} || !${_Interactable} )
												{
													if ${RI_Var_Bool_BreakPathFunction}
													{
														RI_Var_Bool_BreakPathFunction:Set[0]
														return
													}
													if ${Me.FlyingUsingMount}
														call RIMObj.FlyDown
													if ${_StopForCombat}
														call RIMObj.CheckCombat
													relay ${RI_Var_String_RelayGroup} Actor["${_Events.Token[2,-]}"]:DoTarget
													wait 5
													relay ${RI_Var_String_RelayGroup} Actor["${_Events.Token[2,-]}"]:DoubleClick
													wait 5 ${Me.CastingSpell}
													wait 50 !${Me.CastingSpell}
													wait 2
													if ${RIObj.PathTrigger[${_CheckItemQty},${_ItemName},${_ItemQty},${_QuestStepExists},${_QuestExists},${_QuestDNE},${_QuestStepChecked},${_tempName},_QuestStep,_Quest,${CommonTrigger}]}
														_QueryActor.Get[${_cnt}]:Set[*TRIGGERED*]
													if ${Actor["${_Events.Token[2,-]}"].Distance}>=${_MoveToDistance} && !${_DontMoveActor}
														call RIMObj.Move ${Actor["${_Events.Token[2,-]}"].X} ${Math.Calc[${Actor["${_Events.Token[2,-]}"].Y}+1]} ${Actor["${_Events.Token[2,-]}"].Z} ${_MoveToDistance} 0 FALSE FALSE TRUE FALSE TRUE TRUE
												}
											}
											if ${RIObj.PathTrigger[${_CheckItemQty},${_ItemName},${_ItemQty},${_QuestStepExists},${_QuestExists},${_QuestDNE},${_QuestStepChecked},${_tempName},_QuestStep,_Quest,${CommonTrigger}]}
												_QueryActor.Get[${_cnt}]:Set[*TRIGGERED*]
											
										}
										call RIMObj.LootChest
										break
									}
									else
									{
										switch ${_Events.Token[${_ecnt},&]}
										{
											case CC
											case CATALOGCREATURE
											{
												;clickactor event
												while !${Actor[Query, ID=${_ID}].IsDead} && ${Actor[Query, ID=${_ID} && IsDead=FALSE].Distance}<=${_QueryDistance} && ( ${Actor[Query, ID=${_ID} && IsDead=FALSE].Name.Equal[${_Name}]} || !${_CheckName} ) && ${Actor[Query, ID=${_ID}](exists)} && ${_QueryActor.Get[${_cnt}].NotEqual[*TRIGGERED*]} && ( ${Me.CastingSpell} || ${Actor[Query, ID=${_ID}].Interactable} || !${_Interactable} )
												{
													if ${RI_Var_Bool_BreakPathFunction}
													{
														RI_Var_Bool_BreakPathFunction:Set[0]
														return
													}
													if ${Me.FlyingUsingMount}
														call RIMObj.FlyDown
													if ${_StopForCombat}
														call RIMObj.CheckCombat
													;echo call CCID
													call CatalogCreatureID ${_ID}

													if ${RIObj.PathTrigger[${_CheckItemQty},${_ItemName},${_ItemQty},${_QuestStepExists},${_QuestExists},${_QuestDNE},${_QuestStepChecked},${_tempName},_QuestStep,_Quest,${CommonTrigger}]}
														_QueryActor.Get[${_cnt}]:Set[*TRIGGERED*]
													if ${Actor[Query, ID=${_ID}].Distance}>=${_MoveToDistance} && !${_DontMoveActor}
														call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_MoveToDistance} 0 FALSE FALSE TRUE FALSE TRUE TRUE
												}
												break
											}
											case DC
											case DoubleClick
											{
												;clickactor event
												while ${Actor[Query, ID=${_ID} && IsDead=FALSE].Distance}<=${_QueryDistance} && ( ${Actor[Query, ID=${_ID} && IsDead=FALSE].Name.Equal[${_Name}]} || !${_CheckName} ) && ${Actor[Query, ID=${_ID}](exists)} && ${_QueryActor.Get[${_cnt}].NotEqual[*TRIGGERED*]} && ( ${Me.CastingSpell} || ${Actor[Query, ID=${_ID}].Interactable} || !${_Interactable} )
												{
													if ${RI_Var_Bool_BreakPathFunction}
													{
														RI_Var_Bool_BreakPathFunction:Set[0]
														return
													}
													if ${Me.FlyingUsingMount}
														call RIMObj.FlyDown
													if ${_StopForCombat}
														call RIMObj.CheckCombat
													relay ${RI_Var_String_RelayGroup} Actor[${_ID}]:DoTarget
													wait 5
													relay ${RI_Var_String_RelayGroup} Actor[${_ID}]:DoubleClick
													wait 5 ${Me.CastingSpell}
													wait 50 !${Me.CastingSpell}
													wait 2
													if ${RIObj.PathTrigger[${_CheckItemQty},${_ItemName},${_ItemQty},${_QuestStepExists},${_QuestExists},${_QuestDNE},${_QuestStepChecked},${_tempName},_QuestStep,_Quest,${CommonTrigger}]}
														_QueryActor.Get[${_cnt}]:Set[*TRIGGERED*]
													if ${Actor[Query, ID=${_ID}].Distance}>=${_MoveToDistance} && !${_DontMoveActor}
														call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_MoveToDistance} 0 FALSE FALSE TRUE FALSE TRUE TRUE
												}
												break
											}
											case K
											case Kill
											{
												if ${RI_Var_Bool_PathDebug}
													echo ${_tempName}: while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ${_QueryActor.Get[${_cnt}].NotEqual[*TRIGGERED*]}
												if ${_FightAtPathLoc}
												{
													if ${RI_Var_Bool_PathDebug}
														echo Moving To ${Actor[Query, ID=${_ID}].Name}: ${Actor[Query, ID=${_ID}].Distance}>${_MoveToDistance}
													while ${Actor[Query, ID=${_ID}].Distance}>${_MoveToDistance} && !${Me.IsHated}
													{
														call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_MoveToDistance} 0 0 0 0 0
														waitframe
													}
													if ${RI_Var_Bool_PathDebug}
														echo Moving back to loc
													call RIMObj.Move ${_temp} ${_Precision} 0 0 0 0 0
												}
												else
												{
													if ${RI_Var_Bool_PathDebug}
														echo Locking AT ME: ${Actor[Query, ID=${_ID}].Distance}>${_MoveToDistance} // relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Loc},${_MoveToDistance},1000]
													relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Loc},1,1000]
												}
												while ${Actor[Query, ID=${_ID} && IsDead=FALSE].Distance}<=${_QueryDistance} && ( ${Actor[Query, ID=${_ID} && IsDead=FALSE].Name.Equal[${_Name}]} || !${_CheckName} ) && ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ${_QueryActor.Get[${_cnt}].NotEqual[*TRIGGERED*]}
												{
													if ${RI_Var_Bool_BreakPathFunction}
													{
														RI_Var_Bool_BreakPathFunction:Set[0]
														return
													}
													if ${Me.FlyingUsingMount}
														call RIMObj.FlyDown
													if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
														Actor[Query, ID=${_ID}]:DoTarget
													wait 2
													if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_MoveToDistance}+${_Precision}+1]} && !${_FightAtPathLoc} && !${_DontMoveActor}
													{
														;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_MoveToDistance} 0 0 0 1 0 1 1
														if ${RI_Var_Bool_PathDebug}
															echo Moving To ${Actor[Query, ID=${_ID}].Name}: ${Actor[Query, ID=${_ID}].Distance}>${_MoveToDistance} // relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ID}].Loc},${_MoveToDistance},1000]
														
														if ${Actor[Query, ID=${_ID}].Distance}>=${_MoveToDistance}
														{
															relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ID}].Loc},${_MoveToDistance},1000]
														}
														else
														{
															relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[~ALLBUT~${Me.Name},OFF,1000]
															relay ${RI_Var_String_RelayGroup} RIMUIObj:SetRIFollow[~ALLBUT~${Me.Name},${Me.ID}]
														}
														; && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<${_MoveToDistance}
														;	call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_MoveToDistance} 0 FALSE FALSE TRUE FALSE TRUE TRUE
														;if ${RI_Var_Bool_PathDebug}
														;	echo Locking AT ME: ${Actor[Query, ID=${_ID}].Distance}>${_MoveToDistance} // relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Loc},${_MoveToDistance},1000]
														
														wait 5
													}
													else
														relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[~ALLBUT~${Me.Name},${Me.Loc},1,1000]
													if ${Target.ID}==${Actor[Query, ID=${_ID}].ID} && ( !${Me.TargetLOS} || ${ICantSeeMyTarget} )
													{
														eq2ex target_none
														break
													}
													if ${RIObj.PathTrigger[${_CheckItemQty},${_ItemName},${_ItemQty},${_QuestStepExists},${_QuestExists},${_QuestDNE},${_QuestStepChecked},${_tempName},_QuestStep,_Quest,${CommonTrigger}]}
														_QueryActor.Get[${_cnt}]:Set[*TRIGGERED*]
												}
												call RIMObj.LootChest
												break
											}
											case H
											case Harvest
											{
												while ${Actor[Query, ID=${_ID} && IsDead=FALSE].Distance}<=${_QueryDistance} && ( ${Actor[Query, ID=${_ID} && IsDead=FALSE].Name.Equal[${_Name}]} || !${_CheckName} ) && ${Actor[Query, ID=${_ID}](exists)} && ${_QueryActor.Get[${_cnt}].NotEqual[*TRIGGERED*]} && ( ${Me.CastingSpell} || ${Actor[Query, ID=${_ID}].HighlightOnMouseHover} || !${_HighlightOnMouseHover} ) && !${_Done}
												{
													if ${_Query.Find["Overlay=="]}
													{
														if ${Actor[Query, ID=${_ID} && IsDead=FALSE].Overlay.NotEqual["${_ActorName.Token[3,+]}"]}
														{
															_ID:Set[99999999999999]
															continue
														}
													}
													if ${RI_Var_Bool_PathDebug}
														echo QA: ${_QueryActor.Get[${_cnt}]}
													if ${RI_Var_Bool_BreakPathFunction}
													{
														RI_Var_Bool_BreakPathFunction:Set[0]
														return
													}
													if ${_StopForCombat}
														call RIMObj.CheckCombat
													if ${Me.FlyingUsingMount}
														call RIMObj.FlyDown
													
													if ${Me.Target.ID}!=${_ID}
													{
														relay ${RI_Var_String_RelayGroup} Actor[id,${_ID}]:DoTarget
														wait 5
													}
													relay ${RI_Var_String_RelayGroup} Actor[id,${_ID}]:DoubleClick
													wait 5 ${Me.CastingSpell}
													wait 50 !${Me.CastingSpell}
													wait 2
													if ${ICantSeeMyTarget}
													{
														call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${Math.Calc[${_MoveToDistance}-1]} 0 FALSE FALSE TRUE FALSE TRUE TRUE
													}
													;echo ${Time}: Before: ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]}
													;echo ${Trigger} // ${TriggerMessage}
													;wait 15
													if ${Actor[Query, ID=${_ID}].Distance}>${_MoveToDistance} && !${_DontMoveActor}
														call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_MoveToDistance} 0 FALSE FALSE TRUE FALSE TRUE TRUE
													;echo ${Time}: After: ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]}
													if ${RI_Var_Bool_PathDebug}
														echo 1 ${_CheckItemQty} && ${RIMUIObj.InventoryQuantity["${_ItemName}"]}>=${_ItemQty}
													if ${RIObj.PathTrigger[${_CheckItemQty},${_ItemName},${_ItemQty},${_QuestStepExists},${_QuestExists},${_QuestDNE},${_QuestStepChecked},${_tempName},_QuestStep,_Quest,${CommonTrigger}]}
														_QueryActor.Get[${_cnt}]:Set[*TRIGGERED*]
												}
												break
											}
										}
										wait 1
									}
									;reducing this from 25 to see if we can speed it up
									wait 5
								}
								wait ${Wait}
								;removing this to see if we can speed it up
								;wait 25
																
								if ${Actor[Query, ${_Query}](exists)}
								{
									if ${RI_Var_Bool_PathDebug}
										echo _Interactable=${_Interactable} // ActorName=${_ActorName} // _QueryDistance=${_QueryDistance} // _MoveToDistance=${_MoveToDistance} // _Events=${_Events}
									_ID:Set[${Actor[Query, ${_Query}].ID}]
									if ${RI_Var_Bool_PathDebug}
										echo \${RIObj.ClosestPoint[${_ClosestPointStart},"${Actor[id,${_ID}].Loc}",${_ClosestPointScanPoints},${_goReverse}]} DMC if ( ${Actor[id,${_ID}].Distance}<=${_MoveToDistance} && ${RIObj.ClosestPoint[${MainArrayCounter},"${Actor[id,${_ID}].Loc}",${Math.Calc[${_PathLines}-(${MainArrayCounter}-${_start})]},${_goReverse}]}==${MainArrayCounter} ) && ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& \${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+${_YINC}]},${Actor[Query, ID=${_ID}].Z}]} = !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+${_YINC}]},${Actor[Query, ID=${_ID}].Z}]}
									if ( ${Actor[id,${_ID}].Distance}<=${_MoveToDistance} && ${RIObj.ClosestPoint[${_ClosestPointStart},"${Actor[id,${_ID}].Loc}",${_ClosestPointScanPoints},${_goReverse}]}==${MainArrayCounter} ) && ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+${_YINC}]},${Actor[Query, ID=${_ID}].Z}]}
									{
										if ${RI_Var_Bool_PathDebug}
											echo DontMove 
										_DontMove:Set[1]
									}
									else
										call RIMObj.Move ${_temp} 1 0 FALSE ${_StopForCombat} TRUE FALSE
								}
								if ${_StopForCombat}
									call RIMObj.CheckCombat
								if ${Me.WaterDepth}>2 && ${Me.IsSwimming} && !${_DontMove}
									call SwimUp
								if ${_IWasFlying} && !${_DontMove}
								{
									press -hold ${RI_Var_String_FlyUpKey}
									wait 1
									press -release ${RI_Var_String_FlyUpKey}
									_IWasFlying:Set[FALSE]
								
								}
							}
						}
						;;need to figure out how to handle this because we dont want a lagged trigger to trigger the next queryactor, 
						;should be ok since we are in the query actor itself we can have a wait here but that may be problematic so nm because it would slow down everything
						;and the problem is this is required for Harvest where the harvestables disappear after the trigger, this should technically work because of the 5s wait after each harvest/kill/whatever
						if ${RI_Var_Bool_PathDebug}
							echo 2 ${_QueryActor.Get[${_cnt}]} // ${_CheckItemQty} && \${RIMUIObj.InventoryQuantity["${_ItemName}"]}>=${_ItemQty}
						if ${RIObj.PathTrigger[${_CheckItemQty},${_ItemName},${_ItemQty},${_QuestStepExists},${_QuestExists},${_QuestDNE},${_QuestStepChecked},${_tempName},_QuestStep,_Quest,${CommonTrigger}]}
							_QueryActor.Get[${_cnt}]:Set[*TRIGGERED*]
					}
					else
						_TriggeredCount:Inc
				}
				;;;;; This is where i moved the move functions from in case it breaks shit
			}
		}
		if ( ${_ReversePath} && !${_goReverse} ) || ( ${_ReversePathLoopOnly} && !${_Done} && !${_goReverse} )
		{
			_goReverse:Set[1]
			if ${RI_Var_Bool_PathDebug}
				echo Setting _goReverse: ${_goReverse} because: ( ${_ReversePath} && !${_goReverse} ) || ( ${_ReversePathLoopOnly} && !${_Done} && !${_goReverse} )
		}
		elseif !${_Done} && ${_LoopPath}
		{
			if ${RI_Var_Bool_PathDebug}
				echo Loop: setting MAC to ${_start}
			_goReverse:Set[0]
			MainArrayCounter:Set[${_start}]
		}
		if ${RI_Var_Bool_PathDebug}
			echo do while ${_LoopPath} && !${_Done}
	}
	while ${_LoopPath} && !${_Done}
	wait 20
	if ${_TargetSelf}
		eq2ex target_none
	if !${RI_Var_Bool_GlobalOthers}
	{
		if ${_RelayToGroup}
		{
			wait 600 ${RIMObj.AllGroupWithinRange[${_Precision}]}
			relay ${RI_Var_String_RelayGroup} RI_Var_Bool_Follow:Set[1]
			call RIMObj.follow
		}
	}
	if ${_PauseBot}
		relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 0
	if ${RI_Var_Bool_PathDebug}
		echo ISXRI: Ending Path Function MAC: ${MainArrayCounter}
}

function SKTimelineStarter()
{
	call QuestStarter 835 12 253 25 "Kylong Plains" "Kylong Plains"

	if ${Math.Distance[${Me.Loc},1026.497314,2.487710,363.238342]}<50
	{
		call RIMObj.Move 1000.098389 2.487606 336.962097 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 992.919067 2.487540 329.848999 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 985.499207 2.487472 322.497101 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 978.056396 2.487402 315.122681 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 970.714478 2.487335 307.810211 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 963.571533 2.487268 300.672333 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 956.451965 5.243187 293.557831 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 949.448975 8.025568 286.559845 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 942.329285 8.490232 279.445343 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 935.209656 8.541517 272.330780 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 928.101624 10.597463 265.227844 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 920.958557 12.213704 258.089996 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 913.792358 12.213704 250.928864 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 905.560059 12.070804 245.095123 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 895.471375 12.070803 244.195068 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 885.174805 12.070807 244.981842 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 875.232056 12.070809 246.316345 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 865.170410 12.070811 247.864594 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 855.164246 12.070813 249.336899 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 845.270020 12.070813 250.885101 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 840.914307 12.070807 251.647583 1 0 FALSE FALSE TRUE TRUE
	}
	elseif ${Math.Distance[${Me.Loc},843.804749,2.524284,419.947662]}<50
	{
		call RIMObj.Move 843.817200 2.487676 393.542633 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 844.430481 2.487610 383.413635 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 844.934692 2.457964 373.229218 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 844.855103 2.476295 363.214691 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 844.662964 2.487411 353.135040 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 844.471985 2.487345 343.121460 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 844.275940 2.487278 332.843903 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 844.086426 4.795813 322.912750 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 843.905823 7.531281 313.179443 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 843.840271 8.490232 303.164063 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 843.777649 8.490232 292.868103 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 843.716309 10.281334 282.786743 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 843.655640 12.213704 272.787781 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 843.127686 12.213705 262.661926 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 841.796814 12.070813 252.741623 1 0 FALSE FALSE TRUE FALSE
	}
	else
	{
		MessageBox -skin eq2 "We are on neither Dock of Kylong Plains and unable to move to Jones (835, 12, 253), please move to Jones (835, 12, 253) and re run"
		Script:End
	}

	if ${Math.Distance[${Me.Loc},835,12,253]}>25
	{
		MessageBox -skin eq2 "We were unable to move to Jones (835, 12, 253), please move to Jones (835, 12, 253) and re run"
		Script:End
	}
}
function NewLandsNewProfitsStarter()
{
    call QuestStarter 2116 520 -912 25 "Kylong Plains" "Kylong Plains" 0
	if ${Math.Distance[${Me.Loc},1026.497314,2.487710,363.238342]}<50
	{
		call RIMObj.Move 1000.098389 2.487606 336.962097 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 992.919067 2.487540 329.848999 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 985.499207 2.487472 322.497101 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 978.056396 2.487402 315.122681 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 970.714478 2.487335 307.810211 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 963.571533 2.487268 300.672333 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 956.451965 5.243187 293.557831 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 949.448975 8.025568 286.559845 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 942.329285 8.490232 279.445343 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 935.209656 8.541517 272.330780 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 928.101624 10.597463 265.227844 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 920.958557 12.213704 258.089996 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 913.792358 12.213704 250.928864 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 905.560059 12.070804 245.095123 1 0 FALSE FALSE TRUE TRUE
	}
	elseif ${Math.Distance[${Me.Loc},843.804749,2.524284,419.947662]}<50
	{
		call RIMObj.Move 843.817200 2.487676 393.542633 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 844.430481 2.487610 383.413635 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 844.934692 2.457964 373.229218 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 844.855103 2.476295 363.214691 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 844.662964 2.487411 353.135040 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 844.471985 2.487345 343.121460 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 844.275940 2.487278 332.843903 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 844.086426 4.795813 322.912750 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 843.905823 7.531281 313.179443 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 843.840271 8.490232 303.164063 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 843.777649 8.490232 292.868103 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 843.716309 10.281334 282.786743 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 843.655640 12.213704 272.787781 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 843.127686 12.213705 262.661926 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 841.796814 12.070813 252.741623 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 873.479736 12.070809 245.388855 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 905.560059 12.070804 245.095123 1 0 FALSE FALSE TRUE TRUE
	}
	else
	{
		MessageBox -skin eq2 "We are on neither Dock of Kylong Plains and unable to move to Taskmaster Greeblentus (2115,520,-912), please move to Taskmaster Greeblentus (2115,520,-912) and re run"
		Script:End
	}
	;now move to SokoKar if 
	if ${QuestJournalWindow.CompletedQuest["Is It Good News?"](exists)} || ${QuestJournalWindow.CompletedQuest["Here in my Sokokar I Feel Safest of All"](exists)}
	{
		call RIMObj.Move 909.371582 12.070813 233.928955 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 909.673889 12.070813 223.827698 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 910.139526 12.070812 213.710434 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 910.957764 12.070813 203.552917 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 911.877502 12.070814 193.533051 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 912.815674 12.070812 183.352921 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 913.743591 10.952544 173.285172 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 913.768982 10.002501 163.203308 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 908.838928 10.002500 154.407532 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 901.575928 10.159660 147.190842 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 898.023926 10.239155 143.789261 1 0 FALSE FALSE TRUE FALSE
		wait 20
		Actor[a sokokar tamer]:DoFace
		Actor[a sokokar tamer]:DoTarget
		eq2ex apply_verb ${Actor[a sokokar tamer].ID} hail
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 5
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 5
		call TravelMap "Teren's Grasp Post" 0
		wait 600 ${Me.IsMoving}
		wait 1200 !${Me.IsMoving}
		wait 10
		
	}
	else
	{
		call RIMObj.Move 896.857422 89.991859 201.492645 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 899.051025 125.442322 173.892395 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 921.449829 161.002945 146.346146 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 948.308350 194.949692 120.974899 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 982.909546 212.605133 89.359772 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1009.422119 247.619980 65.122482 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1044.474854 263.499725 33.079937 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1075.263550 291.120148 4.934069 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1110.369629 307.024750 -27.158226 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1139.463623 338.190216 -53.755089 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1171.969604 362.031067 -83.470192 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1207.131592 377.960480 -115.612411 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1242.279541 393.883789 -147.742081 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1277.374023 409.782104 -179.821793 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1312.550537 424.027771 -212.561508 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1347.267700 432.372009 -247.778595 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1381.752563 439.349152 -283.718781 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1415.566040 445.112793 -320.205383 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1436.721680 447.579376 -365.718842 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1456.062134 450.509216 -411.922729 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1475.402222 453.439301 -458.126556 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1494.755127 456.372314 -504.365906 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1514.085938 459.301575 -550.551636 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1533.433716 462.232819 -596.773865 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1557.989746 465.173248 -640.301392 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1587.452881 468.104492 -680.831055 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1616.910156 469.963104 -721.345032 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1646.417603 469.963104 -761.919861 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1675.503662 469.963104 -803.009705 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1701.412109 469.963104 -846.112427 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1727.210205 469.963104 -889.031067 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1745.873169 470.103485 -919.990051 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1792.389160 488.883209 -920.436340 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1842.755493 488.883209 -920.919983 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1892.452515 494.453796 -920.275208 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1938.683472 494.453796 -900.265686 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1974.703979 494.552795 -881.582458 1 0 FALSE FALSE TRUE TRUE
	}
	call RIMObj.Move 1989.776855 494.081390 -884.589722 1 0 FALSE FALSE TRUE TRUE
	call RIMObj.Move 2016.781616 522.399109 -882.945251 1 0 FALSE FALSE TRUE TRUE
	call RIMObj.Move 2065.376221 534.184692 -881.833252 1 0 FALSE FALSE TRUE TRUE
	call RIMObj.Move 2107.165283 522.143860 -906.675232 1 0 FALSE FALSE TRUE FALSE
	wait 20
	call RIMObj.FlyDown
	wait 5
	call RIMObj.Move 2115.739990 520.002502 -911.474976 1 0 FALSE FALSE TRUE FALSE
	wait 20
}
function QuestStarter(float _X, float _Y, float _Z, int _Distance, string _ZoneName, string _ZoneToZoneName, int _ArrayCounterSetter, int _ZoneToDeviceOption=1, int _DoorOption=0, bool _CheckZone=TRUE)
{
	if ${Math.Distance[${Me.Loc},${_X},${_Y},${_Z}]}<${_Distance}
	{	
		MainArrayCounter:Set[${_ArrayCounterSetter}]
		;echo we are already at the loc setting our array counter to: ${_ArrayCounterSetter} its now: ${MainArrayCounter}
		return
	}
	if ( ${Math.Distance[${Me.Loc},${_X},${_Y},${_Z}]}>${_Distance} || !${Zone.Name.Find[${_ZoneName}](exists)} ) && !${Me.Ability[id,3266969222].IsReady} && !${Zone.ShortName.Find[guildhall](exists)}
	{
		;show messagebox 
		MessageBox -skin eq2 "We are not within ${_Distance} of ${_X},${_Y},${_Z} in ${_ZoneName}, waiting for Call to Guild Hall to be ready or for us to be in our guild hall"
		while !${Me.Ability[id,3266969222].IsReady} && !${Zone.ShortName.Find[guildhall](exists)} 
			wait 10
		while ${EQ2.Zoning}!=0 
			wait 10
		wait 20
	}
	if ( ${Math.Distance[${Me.Loc},${_X},${_Y},${_Z}]}>${_Distance} || !${Zone.Name.Find[${_ZoneName}](exists)} ) && ( ${Me.Ability[id,3266969222].IsReady} || ${Zone.ShortName.Find[guildhall](exists)} }
	{
		if !${Zone.ShortName.Find[guildhall](exists)}
		{
			while ${Me.Ability[id,3266969222].IsReady}
			{
				Me.Ability[id,3266969222]:Use
				wait 5
			}
		
			wait 600 ${EQ2.Zoning}==1
			wait 600 ${EQ2.Zoning}==0
			wait 600 ${Zone.ShortName.Find[guildhall](exists)}
			wait 10
			if !${Zone.ShortName.Find[guildhall](exists)}
			{
				MessageBox -skin eq2 "We attempted to Call to Guild Hall but did not end up in the Guild Hall"
				Script:End
			}
		}
		if !${Actor[Query, Name=="Ole Salt's Mariner Bell" && Distance<=13](exists)} && !${Actor[Query, Name=="Navigator's Globe of Norrath" && Distance<=13](exists)} && !${Actor[Query, Name=="Pirate Captain's Helmsman" && Distance<=13](exists)} && ${Zone.ShortName.Find[guildhall](exists)}
		{
			MessageBox -skin eq2 "We are at the guild hall to attempt to zone to ${_ZoneToZoneName} but can not find a Travel Bell within 13"
			Script:End
		}
		;echo call TravelMap "${_ZoneToZoneName}" ${_DoorOption} ${_ZoneToDeviceOption}

		call TravelMap "${_ZoneToZoneName}" ${_DoorOption} ${_ZoneToDeviceOption}

		if !${Zone.Name.Find[${_ZoneToZoneName}](exists)} && ${_CheckZone}
		{
			MessageBox -skin eq2 "We were unable to succesfully zone to ${_ZoneToZoneName}, please try again or zone there manually"
			Script:End
		}
	}
}
function FensBellToBathezidsWatchCraft()
{
	call QuestStarter 1197.725586 203.421692 1442.044189 35 "Fens of Nathsar" "Fens of Nathsar"
	if ${Math.Distance[${Me.Loc},182.752274,-118.825874,-158.184448]}<50
	{
		call RIMObj.Move 182.752274 -118.825874 -158.184448 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 189.500046 -76.626198 -131.689743 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 201.475876 -44.594776 -95.034386 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 213.361115 -9.151187 -61.774502 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 225.741119 26.334534 -28.653875 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 241.661316 59.083679 5.769442 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 266.695892 73.750237 46.835613 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 286.071259 107.386559 78.757782 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 311.839294 114.868080 121.213387 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 337.637878 122.358490 163.719391 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 363.396240 129.836670 206.158112 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 389.164886 137.317108 248.613571 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 414.934052 144.797546 291.070099 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 444.368988 147.208221 331.497040 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 479.681610 148.868683 367.087799 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 514.994446 150.529068 402.678467 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 550.088318 156.106216 438.048645 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 575.057129 191.577209 463.215088 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 609.232910 199.912796 499.051178 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 645.093872 201.669296 534.036072 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 684.437012 201.279160 565.148132 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 724.400818 200.810272 595.387268 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 764.501465 200.337875 625.660583 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 804.595459 200.015106 655.870300 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 844.628052 200.017410 686.002258 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 884.756226 200.019730 716.205627 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 924.741089 200.022034 746.301819 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 964.821350 200.024323 776.469604 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1004.809265 202.176712 806.567810 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1041.953979 221.539673 834.239075 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1085.791626 225.180954 858.682495 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1129.484619 226.892288 883.026978 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1173.125000 226.901123 907.566589 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1216.766357 226.909409 932.442261 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1247.772339 226.909409 971.841858 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1269.291870 226.909409 1017.175537 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1290.735107 226.909409 1062.345215 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1305.667236 226.909409 1110.092773 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1291.856689 232.418411 1158.177368 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1260.651733 232.418411 1197.477173 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1222.971558 232.418411 1230.553711 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1181.469482 232.418411 1258.689209 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1141.247925 230.068634 1288.561768 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1103.266724 222.742157 1320.639282 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1080.702148 217.886749 1339.476074 1 0 FALSE FALSE TRUE FALSE
		wait 20
		call RIMObj.FlyDown
		wait 5
		call RIMObj.Move 1068.066528 206.911804 1350.599976 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1053.230469 206.624649 1364.125366 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1056.158569 209.183655 1384.076416 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1064.725464 209.730896 1402.462891 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1073.445801 209.730896 1420.521729 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1081.434204 209.730896 1439.045166 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1094.479736 206.614563 1454.313354 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1111.055786 206.614563 1465.709473 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1124.023926 206.614563 1474.625244 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1142.513428 206.614563 1466.377441 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1160.938965 206.614563 1457.715454 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1179.347290 206.614563 1449.597534 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1191.312988 203.421692 1443.039429 1 0 FALSE FALSE TRUE TRUE
		call RIMObj.Move 1197.725586 203.421692 1442.044189 1 0 FALSE FALSE TRUE TRUE
	}
	elseif ${Math.Distance[${Me.Loc},1197.725586,203.421692,1442.044189]}<50
	{
		return
	}
	else
	{
		MessageBox -skin eq2 "We are unable to move to Quest Giver, please move to Quest Giver and re run"
		Script:End
	}
}
variable(global) string BWFactionRecipeName
function BathezidsWatchFactionCrafting()
{
	if !${RIMUIObj.FactionsInitialized}
	{
		echo ISXRI: Initializing Faction Data
		wait 100 ${RIMUIObj.FactionsInitialized}
		echo ISXRI: Done Initializing Faction Data
	}
	wait 50
	if ${RIMUIObj.FactionAmount[Bathezid's Watch]}>-20000
	{
		;show messagebox 
		MessageBox -skin eq2 "You have enough faction to start Artisan Epic Timeline"
		Script:End
	}
	if ${Me.TSLevel}<70
	{
		;show messagebox 
		MessageBox -skin eq2 "You must be Tradeskill Level 70 or higher to start this timeline"
		Script:End
	}
	;check Fuels and Resource Quantities for each TSClass, Fuel = 810 Resources = 648
	; Outiftters (Armorer, Weaponsmith, Tailor)
	; lichenclover root, bristled pelt, redwood lumber, ferrite cluster, rough kunzite
	; Fuel: smoldering filament and smoldering coal
	; Craftsman (Carpenter, Woodworker, Provisioner)
	; lichenclover root, raw succulent petal, raw cranberry, Torsis tea leaf, king prawn, Cabilis cocoa bean, redwood lumber, deklium cluster, ferrite cluster, bristled pelt
	; Fuel: Aerated mineral water, Dough, smoldering kindling, smoldering sandpaper and smoldering coal
	; Scholar (Alchemist, Jeweler, Sage)
	; lichenclover root, Mineral salt loam, Rough kunzite, Deklium cluster, redwood lumber, deklium cluster , ferrite cluster
	; Fuel: Smoldering candle, smoldering coal, smoldering incense
	RI_Var_Bool_SSSInScript:Set[TRUE]
	RI_Var_Bool_SSSGTG:Set[FALSE]
	switch ${Me.TSClass}
	{
		case outfitter
		{
			while !${RI_Var_Bool_SSSGTG}
			{
				call RemoveFromDepot "Harvesting Supply Depot" "lichenclover root" 648 "bristled pelt" 648 "redwood lumber" 648 "ferrite cluster" 648 "rough kunzite" 648
				call RemoveFromDepot "Fuel Depot" "smoldering filament" 810 "smoldering coal" 810
				call CheckPreReqs -itemqty "lichenclover root" 648 -itemqty "bristled pelt" 648 -itemqty "redwood lumber" 648 -itemqty "ferrite cluster" 648 -itemqty "rough kunzite" 648 -itemqty "smoldering filament" 810 -itemqty "smoldering coal" 810
				wait 5
			}
			break
		}
		case craftsman
		{
			while !${RI_Var_Bool_SSSGTG}
			{
				call RemoveFromDepot "Harvesting Supply Depot" "lichenclover root" 648 "raw succulent petal" 648 "raw cranberry" 648 "Torsis tea leaf" 648 "king prawn" 648 "Cabilis cocoa bean" 648 "redwood lumber" 648 "deklium cluster" 648 "ferrite cluster" 648 "bristled pelt" 648
				call RemoveFromDepot "Fuel Depot" "aerated mineral water" 810 "Dough" 810 "smoldering kindling" 810 "smoldering sandpaper" 810 "smoldering coal" 810
				call CheckPreReqs -itemqty "lichenclover root" 648 -itemqty "raw succulent petal" 648 -itemqty "raw cranberry" 648 -itemqty "Torsis tea leaf" 648 -itemqty "king prawn" 648 -itemqty "Cabilis cocoa bean" 648 -itemqty "redwood lumber" 648 -itemqty "deklium cluster" 648 -itemqty "ferrite cluster" 648 -itemqty "bristled pelt" 648 -itemqty "aerated mineral water" 810 -itemqty "Dough" 810 -itemqty "smoldering kindling" 810 -itemqty "smoldering sandpaper" 810 -itemqty "smoldering coal" 810
				wait 5
			}
			break
		}
		case scholar
		{
			while !${RI_Var_Bool_SSSGTG}
			{
				call RemoveFromDepot "Harvesting Supply Depot" "lichenclover root" 648 "mineral salt loam" 648 "rough kunzite" 648 "deklium cluster" 648 "redwood lumber" 648 "ferrite cluster" 648
				call RemoveFromDepot "Fuel Depot" "smoldering candle" 810 "smoldering coal" 810 "smoldering incense" 810
				call CheckPreReqs -itemqty "lichenclover root" 648 -itemqty "mineral salt loam" 648 -itemqty "rough kunzite" 648 -itemqty "deklium cluster" 648 -itemqty "redwood lumber" 648 -itemqty "ferrite cluster" 648 -itemqty "smoldering candle" 810 -itemqty "smoldering coal" 810 -itemqty "smoldering incense" 810
				wait 5
			}
			break
		}
	}
	call FensBellToBathezidsWatchCraft
	call RIMObj.Move 1202.758301 203.421692 1439.231201 1 0 FALSE FALSE TRUE TRUE
	call RIMObj.Move 1184.667358 203.421692 1426.231445 1 0 FALSE FALSE TRUE TRUE
	call RIMObj.Move 1174.555908 203.421692 1429.830811 1 0 FALSE FALSE TRUE FALSE
	
	Event[EQ2_onQuestUpdate]:AttachAtom[EQ2_BWFonQuestUpdate]
	
	variable int _count
	variable int _Reps
	variable string CraftingStation

	if !${RIMUIObj.FactionsInitialized}
	{
		echo ISXRI: Initializing Faction Data
		wait 100 ${RIMUIObj.FactionsInitialized}
		echo ISXRI: Done Initializing Faction Data
	}
	wait 50
	; if ${RIMUIObj.FactionAmount[Bathezid's Watch]}==0
		; echo ISXRI: Your Bathezid's Watch Faction is 0 (or your faction was not read open your faction window and goto each dropdown and scroll all the way down)
	; else
		; echo ISXRI: Your Bathezid's Watch Faction is ${RIMUIObj.FactionAmount[Bathezid's Watch]}
		
	if ${RIMUIObj.FactionAmount[Bathezid's Watch]}==0 && ${QuestJournalWindow.CompletedQuest["New Lands, New Profits"](exists)}
	{
		MessageBox -skin eq2 "You have already completed New Lands, New Profits and your Bathezid's Watch faction is reporting 0, which means we are not reading it, open your faction window and goto each dropdown and scroll all the way down the re run"
		Script:End
	}
	
	;_Reps:Set[${Int[${Math.Calc[(-20000-${RIMUIObj.FactionAmount[Bathezid's Watch]})/750]}]}]
	;_Reps:Inc
	
	;echo ISXRI: Repeating Bathezid's Watch Tradeskill Writs ${_Reps} Times
	
	;for(_count:Set[1];${_count}<${_Reps};_count:Inc)
	while ${RIMUIObj.FactionAmount[Bathezid's Watch]}<-20000
	{
		if ${QuestJournalWindow.ActiveQuest["Bathezid Apprentice ${Me.TSClass} Work Requisition"](exists)}
		{
			QuestJournalWindow.ActiveQuest["Bathezid Apprentice ${Me.TSClass} Work Requisition"]:Delete
			wait 5
		}
		if ${QuestJournalWindow.ActiveQuest["Bathezid Journeyman ${Me.TSClass} Work Requisition"](exists)}
		{
			QuestJournalWindow.ActiveQuest["Bathezid Journeyman ${Me.TSClass} Work Requisition"]:Delete
			wait 5
		}
		if ${QuestJournalWindow.ActiveQuest["Bathezid Senior ${Me.TSClass} Work Requisition"](exists)}
		{
			QuestJournalWindow.ActiveQuest["Bathezid Senior ${Me.TSClass} Work Requisition"]:Delete
			wait 5
		}
		if ${QuestJournalWindow.ActiveQuest["Bathezid Master ${Me.TSClass} Work Requisition"](exists)}
		{
			QuestJournalWindow.ActiveQuest["Bathezid Master ${Me.TSClass} Work Requisition"]:Delete
			wait 5
		}
		echo ISXRI: Starting Bathezid Master Scholar Work Requisition, Current Faction: ${RIMUIObj.FactionAmount[Bathezid's Watch]}, Faction Needed: -20000
		;(${_count} of ${_Reps})
		CustomLoc:Set["0 0 0"]
		call HailActor Anuhadux 2 4
		wait 20
		Actor[tradeskill_work_order_desk]:DoubleClick
		wait 35
		if !${Me.Recipe[${BWFactionRecipeName}](exists)} && !${Me.Recipe[1](exists)}
		{
			EQ2Execute /toggletradeskills
			wait 50 ${Me.Recipe[1](exists)}
			EQ2Execute /toggletradeskills
		}
		if !${Me.Recipe[${BWFactionRecipeName}](exists)} && ${Me.Inventory[Query, Location=="Inventory" && Name=-"bathezid master ${Me.TSClass} recipes"](exists)}
			Me.Inventory[Query, Location=="Inventory" && Name=-"bathezid master ${Me.TSClass} recipes"]:Scribe
		wait 5
		if ${Me.Recipe[${BWFactionRecipeName}](exists)}
		{
			;make sure we have the components needed
			wait 300 ${Me.Recipe[${BWFactionRecipeName}].IsRecipeInfoAvailable}
			if ${Me.Recipe[${BWFactionRecipeName}].IsRecipeInfoAvailable}
			{
				if ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent1.Name.NotEqual[N/A]}
				{
					if ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent1.QuantityOnHand} < ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent1.Quantity}
					{
						MessageBox -skin eq2 "You need ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent1.Quantity} of ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent1.Name} and only have ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent1.QuantityOnHand}"
						eq2ex start_broker
						Script:End
					}
				}
				if ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent2.Name.NotEqual[N/A]}
				{
					if ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent2.QuantityOnHand} < ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent2.Quantity}
					{
						MessageBox -skin eq2 "You need ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent2.Quantity} of ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent2.Name} and only have ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent2.QuantityOnHand}"
						eq2ex start_broker
						Script:End
					}
				}
				if ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent3.Name.NotEqual[N/A]}
				{
					if ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent3.QuantityOnHand} < ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent3.Quantity}
					{
						MessageBox -skin eq2 "You need ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent3.Quantity} of ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent3.Name} and only have ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent3.QuantityOnHand}"
						eq2ex start_broker
						Script:End
					}
				}
				if ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent4.Name.NotEqual[N/A]}
				{
					if ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent4.QuantityOnHand} < ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent4.Quantity}
					{
						MessageBox -skin eq2 "You need ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent4.Quantity} of ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent4.Name} and only have ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.BuildComponent4.QuantityOnHand}"
						eq2ex start_broker
						Script:End
					}
				}
				if ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.Fuel.QuantityOnHand} < ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.Fuel.Quantity}
				{
					MessageBox -skin eq2 "You need ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.Fuel.Quantity} of ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.Fuel.Name} and only have ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.Fuel.QuantityOnHand}"
					eq2ex start_broker
					Script:End
				}
			}
			else
			{
				MessageBox -skin eq2 "We were unable to retrieve recipe info"
				Script:End
			}
		}
		else
		{
			variable int _rbcount
			_rbcount:Set[0]
			while ${Me.Inventory[Query, Location=="Inventory" && Name=-"bathezid master ${Me.TSClass} recipes"](exists)} && ${_rbcount:Inc}<30
			{
				Me.Inventory[Query, Location=="Inventory" && Name=-"bathezid master ${Me.TSClass} recipes"]:Scribe
				wait 10
			}
			if !${Me.Recipe[${BWFactionRecipeName}](exists)}
			{
				MessageBox -skin eq2 "Can not find Recipe: ${BWFactionRecipeName}"
				Script:End
			}
		}
		wait 5
		;move to correct device
		if ${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.Device.Replace[" ",""].Replace["&",""].Equal[""]}
		{
			wait 30
		}
		CraftingStation:Set[${Me.Recipe[${BWFactionRecipeName}].ToRecipeInfo.Device.Replace[" ",""].Replace["&",""]}]
		wait 5
		call BWFMoveTo${CraftingStation}
		wait 5
		call CraftIt "${BWFactionRecipeName}" 6
		wait 5
		call BWFMoveBack${CraftingStation}
		wait 5
		call HailActor Anuhadux 1 1
		echo ISXRI: Ending Bathezid Master Scholar Work Requisition
		wait 10
	}
	Event[EQ2_onQuestUpdate]:DetachAtom[EQ2_BWFonQuestUpdate]
}
function BWFMoveToWorkBench()
{
	call RIMObj.Move 1207.273804 203.421692 1430.444580 1 0 FALSE FALSE TRUE FALSE
}
function BWFMoveBackWorkBench()
{
	call RIMObj.Move 1174.555908 203.421692 1429.830811 1 0 FALSE FALSE TRUE FALSE
}
function BWFMoveToChemistryTable()
{
	call RIMObj.Move 1175.273193 203.421692 1424.706177 1 0 FALSE FALSE TRUE FALSE
}
function BWFMoveBackChemistryTable()
{
	call RIMObj.Move 1174.555908 203.421692 1429.830811 1 0 FALSE FALSE TRUE FALSE
}
function BWFMoveToEngravedDesk()
{
	call RIMObj.Move 1180.608398 203.421692 1431.976929 1 0 FALSE FALSE TRUE FALSE
}
function BWFMoveBackEngravedDesk()
{
	call RIMObj.Move 1174.555908 203.421692 1429.830811 1 0 FALSE FALSE TRUE FALSE
}
function BWFMoveToStoveandKeg()
{
	call RIMObj.Move 1202.381470 203.421692 1416.117310 1 0 FALSE FALSE TRUE FALSE
}
function BWFMoveBackStoveandKeg()
{
	call RIMObj.Move 1174.555908 203.421692 1429.830811 1 0 FALSE FALSE TRUE FALSE
}
function BWFMoveToWoodworkingTable()
{
	call RIMObj.Move 1211.615845 203.421692 1442.128906 1 0 FALSE FALSE TRUE FALSE
}
function BWFMoveBackWoodworkingTable()
{
	call RIMObj.Move 1174.555908 203.421692 1429.830811 1 0 FALSE FALSE TRUE FALSE
}
function BWFMoveToLoom()
{
	call RIMObj.Move 1183.704834 203.421692 1427.211914 1 0 FALSE FALSE TRUE TRUE
	call RIMObj.Move 1217.168945 203.421692 1452.466919 1 0 FALSE FALSE TRUE FALSE
}
function BWFMoveBackLoom()
{
	call RIMObj.Move 1183.704834 203.421692 1427.211914 1 0 FALSE FALSE TRUE TRUE
	call RIMObj.Move 1174.555908 203.421692 1429.830811 1 0 FALSE FALSE TRUE FALSE
	
}
function BWFMoveToForge()
{
	call RIMObj.Move 1183.704834 203.421692 1427.211914 1 0 FALSE FALSE TRUE TRUE
	call RIMObj.Move 1198.801758 203.421692 1465.820313 1 0 FALSE FALSE TRUE FALSE
}
function BWFMoveBackForge()
{
	call RIMObj.Move 1183.704834 203.421692 1427.211914 1 0 FALSE FALSE TRUE TRUE
	call RIMObj.Move 1174.555908 203.421692 1429.830811 1 0 FALSE FALSE TRUE FALSE
}
function CheckResourceQuantityOnHand(string _ResourceName, int _Quantity)
{
	if ${Me.Inventory[Query, Location=="Inventory" && Name=="${_ResourceName}"].Quantity}<${_Quantity}
	{
		;show messagebox 
		MessageBox -skin eq2 "You must have at least ${_Quantity} ${_ResourceName} in your inventory"
		eq2ex start_broker
		Script:End
	}
}
variable(global) bool RI_Var_Bool_SSSInScript=FALSE
variable(global) bool RI_Var_Bool_SSSGTG=FALSE
function SarnakSupplyStocking()
{
	RI_Var_Bool_SSSInScript:Set[TRUE]
	RI_Var_Bool_SSSGTG:Set[FALSE]
	if ${Me.TSLevel}<80
	{
		;show messagebox 
		MessageBox -skin eq2 "You must be Tradeskill Level 80 or higher to start this timeline"
		Script:End
	}
	switch ${Me.TSSubClass}
	{
		case alchemist
		{
			;40 mineral salt loam, 20 rough kunzite, 10 deklium cluster, 20 smoldering candle
			;40 mineral salt loam, 20 rough kunzite, 10 deklium cluster, 50 smoldering candle
			while !${RI_Var_Bool_SSSGTG}
			{
				call RemoveFromDepot "Harvesting Supply Depot" "mineral salt loam" 80 "rough kunzite" 40 "deklium cluster" 20
				call RemoveFromDepot "Fuel Depot" "smoldering candle" 70
				call CheckPreReqs -itemqty "mineral salt loam" 80 -itemqty "rough kunzite" 40 -itemqty "deklium cluster" 20 -itemqty "smoldering candle" 70
				wait 5
			}
			break
		}
		case armorer
		{
			;40 ferrite cluster, 20 bristled pelt , 10 lichenclover root , 50 smoldering coal
			;40 ferrite cluster, 20 bristled pelt , 10 lichenclover root , 50 smoldering coal
			while !${RI_Var_Bool_SSSGTG}
			{
				call RemoveFromDepot "Harvesting Supply Depot" "ferrite cluster" 80 "bristled pelt" 40 "lichenclover root" 20
				call RemoveFromDepot "Fuel Depot" "smoldering coal" 100
				call CheckPreReqs -itemqty "ferrite cluster" 80 -itemqty "bristled pelt" 40 -itemqty "lichenclover root" 20 -itemqty "smoldering coal" 100
				wait 5
			}
			break
		}
		case carpenter
		{
			;40 redwood lumber, 20 bristled pelt, 10 ferrite cluster, 50 smoldering sandpaper
			;40 redwood lumber, 20 bristled pelt, 10 ferrite cluster, 50 smoldering sandpaper
			while !${RI_Var_Bool_SSSGTG}
			{
				call RemoveFromDepot "Harvesting Supply Depot" "redwood lumber" 80 "bristled pelt" 40 "ferrite cluster" 20
				call RemoveFromDepot "Fuel Depot" "smoldering sandpaper" 100
				call CheckPreReqs -itemqty "redwood lumber" 80 -itemqty "bristled pelt" 40 -itemqty "ferrite cluster" 20 -itemqty "smoldering sandpaper" 100
				wait 5
			}
			break
		}
		case jeweler
		{
			;40 mineral salt loam, 20 rough kunzite, 10 deklium cluster, 50 smoldering coal 
			;40 mineral salt loam, 20 rough kunzite, 10 deklium cluster, 50 smoldering coal 
			while !${RI_Var_Bool_SSSGTG}
			{
				call RemoveFromDepot "Harvesting Supply Depot" "mineral salt loam" 80 "rough kunzite" 40 "deklium cluster" 20
				call RemoveFromDepot "Fuel Depot" "smoldering coal" 100
				call CheckPreReqs -itemqty "mineral salt loam" 80 -itemqty "rough kunzite" 40 -itemqty "deklium cluster" 20 -itemqty "smoldering coal" 100
				wait 5
			}
			break
		}
		case provisioner
		{
			;uses 20 raw succulent petal, 50 lichenclover root, 10 raw cranberry, 60 king prawn, 10xLiquid, 10xDough, and 120 smoldering kindling.
			while !${RI_Var_Bool_SSSGTG}
			{
				call RemoveFromDepot "Harvesting Supply Depot" "raw succulent petal" 20 "lichenclover root" 50 "raw cranberry" 10 "king prawn" 60
				call RemoveFromDepot "Fuel Depot" "aerated mineral water" 10 "dough" 10 "smoldering kindling" 120
				call CheckPreReqs -itemqty "raw succulent petal" 20 -itemqty "lichenclover root" 50 -itemqty "raw cranberry" 10 -itemqty "king prawn" 60 -itemqty "aerated mineral water" 10 -itemqty "dough" 10 -itemqty "smoldering kindling" 120
				wait 5
			}
			break
		}
		case sage
		{
			;uses 60 redwood lumber, 40 lichenclover root, 20 deklium cluster and 100 smoldering incense.
			while !${RI_Var_Bool_SSSGTG}
			{
				call RemoveFromDepot "Harvesting Supply Depot" "redwood lumber" 60 "lichenclover root" 40 "deklium cluster" 20
				call RemoveFromDepot "Fuel Depot" "smoldering incense" 100
				call CheckPreReqs -itemqty "redwood lumber" 60 -itemqty "lichenclover root" 40 -itemqty "deklium cluster" 20 -itemqty "smoldering incense" 100
				wait 5
			}
			break
		}
		case tailor
		{
			;uses 50 lichenclover root, 80 bristled pelt, 10 redwood lumber, and 100 smoldering filament.
			while !${RI_Var_Bool_SSSGTG}
			{
				call RemoveFromDepot "Harvesting Supply Depot" "bristled pelt" 80 "lichenclover root" 50 "redwood lumber" 10
				call RemoveFromDepot "Fuel Depot" "smoldering filament" 100
				call CheckPreReqs -itemqty "bristled pelt" 80 -itemqty "lichenclover root" 50 -itemqty "redwood lumber" 10 -itemqty "smoldering filament" 100
				wait 5
			}
			break
		}
		case woodworker
		{
			;uses 80 redwood lumber, 40 deklium cluster, 20 bristled pelt and 100 smoldering sandpaper.
			while !${RI_Var_Bool_SSSGTG}
			{
				call RemoveFromDepot "Harvesting Supply Depot" "redwood lumber" 80 "deklium cluster" 40 "bristled pelt" 20
				call RemoveFromDepot "Fuel Depot" "smoldering sandpaper" 100
				call CheckPreReqs -itemqty "redwood lumber" 80 -itemqty "deklium cluster" 40 -itemqty "bristled pelt" 20 -itemqty "smoldering sandpaper" 100
				wait 5
			}
			break
		}
		case weaponsmith
		{
			;40 ferrite cluster, 20 bristled leather, 10 kunzite, 50 smoldering coal
			;40 ferrite cluster, 20 bristled leather, 10 kunzite, 50 smoldering coal
			while !${RI_Var_Bool_SSSGTG}
			{
				call RemoveFromDepot "Harvesting Supply Depot" "ferrite cluster" 80 "bristled pelt" 40 "rough kunzite" 20
				call RemoveFromDepot "Fuel Depot" "smoldering coal" 100
				call CheckPreReqs -itemqty "ferrite cluster" 80 -itemqty "bristled pelt" 40 -itemqty "rough kunzite" 20 -itemqty "smoldering coal" 100
				wait 5
			}
			break
		}
	}
	call FensBellToBathezidsWatchCraft
	call RIMObj.Move 1202.758301 203.421692 1439.231201 1 0 FALSE FALSE TRUE TRUE
	call RIMObj.Move 1196.660400 203.421692 1466.146973 1 0 FALSE FALSE TRUE FALSE
	;echo ISXRI: Starting Sarnak Supply Stocking
	CustomLoc:Set["0 0 0"]
	call HailActor Danelak 2 1
	wait 20
	switch ${Me.TSSubClass}
	{
		case alchemist
		{
			call SSSMoveToChemistryTable
			wait 20
			;40 mineral salt loam, 20 rouch kunzite, 10 deklium cluster, 20 smoldering candle
			call CraftIt "Dedicated Elixir of Intellect" 10
			;40 mineral salt loam, 20 rouch kunzite, 10 deklium cluster, 50 smoldering candle
			call CraftIt "Smoldering Fists VI (Journeyman)" 10
			wait 5
			call SSSMoveBackChemistryTable
			break
		}
		case armorer
		{
			call SSSMoveToForge
			wait 20
			;40 ferrite cluster, 20 bristled pelt , 10 lichenclover root , 50 smoldering coal
			call CraftIt "Pristine Ferrite Plate Spaulders" 10
			;40 ferrite cluster, 20 bristled pelt , 10 lichenclover root , 50 smoldering coal
			call CraftIt "Pristine Ferrite Melodic Mantle" 10
			wait 5
			call SSSMoveBackForge
			break
		}
		case carpenter
		{
			call SSSMoveToWoodworkingTable
			wait 20
			;40 redwood lumber, 20 bristled pelt, 10 ferrite cluster, 50 smoldering sandpaper
			call CraftIt "Redwood Stool" 10
			;40 redwood lumber, 20 bristled pelt, 10 ferrite cluster, 50 smoldering sandpaper
			call CraftIt "Redwood Strong Box" 10
			wait 5
			call SSSMoveBackWoodworkingTable
			break
		}
		case jeweler
		{
			call SSSMoveToWorkBench
			wait 20
			;40 mineral salt loam, 20 rough kunzite, 10 deklium cluster, 50 smoldering coal 
			call CraftIt "Rune of Torture VI (Journeyman)" 10
			;40 mineral salt loam, 20 rough kunzite, 10 deklium cluster, 50 smoldering coal 
			call CraftIt "Rune of Double-Cross VI (Journeyman)" 10
			wait 5
			call SSSMoveBackWorkBench
			break
		}
		case provisioner
		{
			call SSSMoveToStoveandKeg
			wait 20
			;uses 20 raw succulent petal, 50 lichenclover root, 10 raw cranberry, 60 king prawn, 10xLiquid, 10xDough, and 120 smoldering kindling.
			call CraftIt "Steamed King Prawn Dumplings" 10
			call CraftIt "Succulent Mead" 10
			wait 5
			call SSSMoveBackStoveandKeg
			break
		}
		case sage
		{
			call SSSMoveToEngravedDesk
			wait 20
			;uses 60 redwood lumber, 40 lichenclover root, 20 deklium cluster and 100 smoldering incense.
			;Craft 10 Grim Sorcerer V Journeyman
			;Craft 10 Synergism IV Journeyman
			call CraftIt "Grim Sorcerer V (Journeyman)" 10
			call CraftIt "Synergism IV (Journeyman)" 10
			wait 5
			call SSSMoveBackEngravedDesk
			break
		}
		case tailor
		{
			call SSSMoveToSewingTableMannequin
			wait 20
			;uses 50 lichenclover root, 80 bristled pelt, 10 redwood lumber, and 100 smoldering filament.
			;Craft 10 Pristine Tailored Dexterous Bristled Leather Shoulder Pads
			;Craft 10 Pristine Tranquil Damask Shawl
			call CraftIt "Pristine Tailored Dexterous Bristled Leather Shoulder Pads" 10
			call CraftIt "Pristine Tranquil Damask Shawl" 10
			wait 5
			call SSSMoveBackSewingTableMannequin
			break
		}
		case woodworker
		{
			call SSSMoveToWoodworkingTable
			wait 20
			;uses 80 redwood lumber, 40 deklium cluster, 20 bristled pelt and 100 smoldering sandpaper.
			;Craft 10 Redwood Sorcerer's Staffs
			;Craft 10 Redwood Wands
			call CraftIt "redwood sorcerer's staff" 10
			call CraftIt "redwood wand" 10
			wait 5
			call SSSMoveBackWoodworkingTable
			break
		}
		case weaponsmith
		{
			call SSSMoveToForge
			wait 20
			;40 ferrite cluster, 20 bristled leather, 10 kunzite, 50 smoldering coal
			call CraftIt "ferrite morning star" 10
			;40 ferrite cluster, 20 bristled leather, 10 kunzite, 50 smoldering coal
			call CraftIt "ferrite war maul" 10
			wait 5
			call SSSMoveBackForge
			break
		}
	}
	wait 20
	CustomLoc:Set["0 0 0"]
	call HailActor Danelak 2 1
	call HailActor Danelak 1 2 FALSE
	call HailActor Danelak 4 1 FALSE
	;echo ISXRI: Ending Sarnak Supply Stocking
	RI_Var_Bool_InScript:Set[FALSE]
}
function SSSMoveToForge()
{
	return
}
function SSSMoveBackForge()
{
	return
}
function SSSMoveToWorkBench()
{
	call RIMObj.Move 1207.828613 203.421692 1432.514526 1 0 FALSE FALSE TRUE FALSE
}
function SSSMoveBackWorkBench()
{
	call RIMObj.Move 1196.660400 203.421692 1466.146973 1 0 FALSE FALSE TRUE FALSE
}
function SSSMoveToChemistryTable()
{
	call RIMObj.Move 1197.451782 203.421692 1441.105713 1 0 FALSE FALSE TRUE TRUE
	call RIMObj.Move 1174.973633 203.421692 1424.090576 1 0 FALSE FALSE TRUE FALSE
}
function SSSMoveBackChemistryTable()
{
	call RIMObj.Move 1197.451782 203.421692 1441.105713 1 0 FALSE FALSE TRUE TRUE
	call RIMObj.Move 1196.660400 203.421692 1466.146973 1 0 FALSE FALSE TRUE FALSE
}
function SSSMoveToEngravedDesk()
{
	call RIMObj.Move 1197.451782 203.421692 1441.105713 1 0 FALSE FALSE TRUE TRUE
	call RIMObj.Move 1183.156982 203.421692 1432.790283 1 0 FALSE FALSE TRUE FALSE
}
function SSSMoveBackEngravedDesk()
{
	call RIMObj.Move 1197.451782 203.421692 1441.105713 1 0 FALSE FALSE TRUE TRUE
	call RIMObj.Move 1196.660400 203.421692 1466.146973 1 0 FALSE FALSE TRUE FALSE
}
function SSSMoveToStoveandKeg()
{
	call RIMObj.Move 1204.017822 203.421692 1418.705444 1 0 FALSE FALSE TRUE FALSE
}
function SSSMoveBackStoveandKeg()
{
	call RIMObj.Move 1196.660400 203.421692 1466.146973 1 0 FALSE FALSE TRUE FALSE
}
function SSSMoveToWoodworkingTable()
{
	call RIMObj.Move 1212.295410 203.421692 1444.353638 1 0 FALSE FALSE TRUE FALSE
}
function SSSMoveBackWoodworkingTable()
{
	call RIMObj.Move 1196.660400 203.421692 1466.146973 1 0 FALSE FALSE TRUE FALSE
}
function SSSMoveToSewingTableMannequin()
{
	call RIMObj.Move 1217.660400 203.421692 1455.146973 1 0 FALSE FALSE TRUE FALSE
}
function SSSMoveBackSewingTableMannequin()
{
	call RIMObj.Move 1196.660400 203.421692 1466.146973 1 0 FALSE FALSE TRUE FALSE
}

atom(script) EQ2_BWFonQuestUpdate(string ID, string Name, string CurrentZone, string Category, string Description, ... ProgressText)
{
	if ${ProgressText[3].NotEqual[""]}
	{
		;echo ISXRI: ${Time}: ${ProgressText[3]}
		if ${ProgressText[3].Find[I need to create some ](exists)}
		{
			;echo ${ProgressText[3].Left[20]}
			;echo ${ProgressText[3].Right[-20].Left[-1]}
			BWFactionRecipeName:Set[${ProgressText[3].Right[-22].Left[-1]}]
		}
		elseif ${ProgressText[3].Find[I need to create an ](exists)}
		{
			;echo ${ProgressText[3].Left[20]}
			;echo ${ProgressText[3].Right[-20].Left[-1]}
			BWFactionRecipeName:Set[${ProgressText[3].Right[-20].Left[-1]}]
		}
		elseif ${ProgressText[3].Find[I need to create a ](exists)}
		{
			;echo ${ProgressText[3].Left[19]}
			;echo ${ProgressText[3].Right[-19].Left[-1]}
			BWFactionRecipeName:Set[${ProgressText[3].Right[-19].Left[-1]}]
		}
		elseif ${ProgressText[3].Find[I need to create ](exists)}
		{
			;echo ${ProgressText[3].Left[17]}
			;echo ${ProgressText[3].Right[-17].Left[-1]}
			BWFactionRecipeName:Set[${ProgressText[3].Right[-17].Left[-1]}]
		}
		;echo ISXRI: ${Time}: ${BWFactionRecipeName}
	}
}
function ArtisanEpicTimeline()
{
	if !${QuestJournalWindow.CompletedQuest["Sarnak Supply Stocking"](exists)}
	{
		if !${RIMUIObj.FactionsInitialized}
		{
			echo ISXRI: Initializing Faction Data
			wait 100 ${RIMUIObj.FactionsInitialized}
			echo ISXRI: Done Initializing Faction Data
		}
		wait 50
		; if ${RIMUIObj.FactionAmount[Bathezid's Watch]}==0
			; echo ISXRI: Your Bathezid's Watch Faction is 0 (or your faction was not read open your faction window and goto each dropdown and scroll all the way down)
		; else
			; echo ISXRI: Your Bathezid's Watch Faction is ${RIMUIObj.FactionAmount[Bathezid's Watch]}
			
		if ${RIMUIObj.FactionAmount[Bathezid's Watch]}==0 && ${QuestJournalWindow.CompletedQuest["New Lands, New Profits"](exists)}
		{
			call MessageBox "You have already completed New Lands, New Profits and your Bathezid's Watch faction is reporting 0, which means we are not reading it, open your faction window and goto each dropdown and scroll all the way down the re run"
		}
		;change these to the correct quests
		if ${QuestJournalWindow.CompletedQuest["The Proof of the Pudding"](exists)} || ${QuestJournalWindow.ActiveQuest["The Proof of the Pudding"](exists)}
		{
			;show messagebox 
			MessageBox -skin eq2 "You have already completed the Artisan Epic Timeline or are on The Proof of the Pudding"
			Script:End
		}
		if ${Me.TSLevel}<80
		{
			;show messagebox 
			MessageBox -skin eq2 "You must be Tradeskill Level 80 or higher to start this timeline"
			Script:End
		}
		;if not completed "New Lands, New Profits"
		if !${QuestJournalWindow.CompletedQuest["New Lands, New Profits"](exists)}
;		&& ( ${RIMUIObj.FactionAmount[Bathezid's Watch]}==0 || ${RIMUIObj.FactionAmount[Bathezid's Watch]}<-39750 )
		{
			if ${QuestJournalWindow.ActiveQuest["New Lands, New Profits"](exists)}
			{
				QuestJournalWindow.ActiveQuest["New Lands, New Profits"]:Delete
				wait 5
			}
			call QuestDefault NewLandsNewProfits
		}
		else
			echo ISXRI: New Lands, New Profits already Completed, moving on
		;if BW FActions is <-20000
		
		if ${RIMUIObj.FactionAmount[Bathezid's Watch]}<-20000
		{
			if ${QuestJournalWindow.ActiveQuest["Bathezid Master Scholar Work Requisition"](exists)}
			{
				QuestJournalWindow.ActiveQuest["Bathezid Master Scholar Work Requisition"]:Delete
				wait 5
			}
			call BathezidsWatchFactionCrafting
		}
		else
			echo ISXRI: we already have -20000 or greater Bathezid's Watch Faction, moving on
		
		;if not completed "Sarnak Supply Stocking"
		if !${QuestJournalWindow.CompletedQuest["Sarnak Supply Stocking"](exists)}
		{
			if ${QuestJournalWindow.ActiveQuest["Sarnak Supply Stocking"](exists)}
			{
				QuestJournalWindow.ActiveQuest["Sarnak Supply Stocking"]:Delete
				wait 5
			}
			call QuestDefault SarnakSupplyStocking
		}
		else
			echo ISXRI: Sarnak Supply Stocking already Completed, moving on
	}
	else
		echo ISXRI: Sarnak Supply Stocking already Completed, moving on
	;if not completed "Bixie Distraction"
	if !${QuestJournalWindow.CompletedQuest["Bixie Distraction"](exists)}
	{
		if ${QuestJournalWindow.ActiveQuest["Bixie Distraction"](exists)}
		{
			QuestJournalWindow.ActiveQuest["Bixie Distraction"]:Delete
			wait 5
		}
		call QuestDefault BixieDistraction
	}
	else
		echo ISXRI: Bixie Distraction already Completed, moving on
	;if not completed "Anything for Jumjum"
	if !${QuestJournalWindow.CompletedQuest["Anything for Jumjum"](exists)}
	{
		if ${QuestJournalWindow.ActiveQuest["Anything for Jumjum"](exists)}
		{
			QuestJournalWindow.ActiveQuest["Anything for Jumjum"]:Delete
			wait 5
		}
		call QuestDefault AnythingforJumjum
	}
	else
		echo ISXRI: Anything for Jumjum already Completed, moving on
	;if not completed "${Me.TSClass.Left[1].Upper}${Me.TSClass.Right[-1]} Errands"
	if !${QuestJournalWindow.CompletedQuest["${Me.TSClass.Left[1].Upper}${Me.TSClass.Right[-1]} Errands"](exists)}
	{
		if ${QuestJournalWindow.ActiveQuest["${Me.TSClass.Left[1].Upper}${Me.TSClass.Right[-1]} Errands"](exists)}
		{
			QuestJournalWindow.ActiveQuest["${Me.TSClass.Left[1].Upper}${Me.TSClass.Right[-1]} Errands"]:Delete
			wait 5
		}
		call QuestDefault ${Me.TSClass.Left[1].Upper}${Me.TSClass.Right[-1]}Errands
	}
	else
		echo ISXRI: ${Me.TSClass.Left[1].Upper}${Me.TSClass.Right[-1]} Errands Completed, moving on
}
function BixieDistractionGatherItems()
{
	;load zonefile
	AnnounceText:Clear
	AnnounceText:Insert[Quest item found!]
	;now start running the path and check for the items 
	variable index:string _WayPoints
	_WayPoints:Insert[-49.662468 91.542755 894.094360]
	_WayPoints:Insert[-46.910034 91.931801 903.125061]
	_WayPoints:Insert[-56.830036 91.979240 904.553406]
	_WayPoints:Insert[-67.027771 92.491302 905.338135]
	_WayPoints:Insert[-77.173477 93.855072 905.404053]
	_WayPoints:Insert[-87.171974 94.072044 905.302734]
	_WayPoints:Insert[-97.201691 94.273682 905.359192]
	_WayPoints:Insert[-107.134979 93.384682 907.369202]
	_WayPoints:Insert[-115.615326 92.908913 913.147827]
	_WayPoints:Insert[-123.463387 92.265930 919.331543]
	_WayPoints:Insert[-132.673370 92.153206 923.977234]
	_WayPoints:Insert[-142.895966 92.154121 925.540955]
	_WayPoints:Insert[-152.988266 92.657417 925.740662]
	_WayPoints:Insert[-162.970795 94.087242 925.255676]
	_WayPoints:Insert[-172.862366 94.513023 923.609985]
	_WayPoints:Insert[-182.773788 94.551270 921.766418]
	_WayPoints:Insert[-192.722061 93.093224 922.841248]
	_WayPoints:Insert[-202.785889 92.211311 923.554504]
	_WayPoints:Insert[-212.167542 91.994621 927.022705]
	_WayPoints:Insert[-217.115402 92.009811 935.986450]
	_WayPoints:Insert[-224.906677 91.938187 942.810425]
	_WayPoints:Insert[-234.766052 91.628212 944.622559]
	_WayPoints:Insert[-244.845535 91.509651 943.546204]
	_WayPoints:Insert[-253.015625 91.002502 937.751160]
	_WayPoints:Insert[-259.882202 92.563507 928.546082]
	_WayPoints:Insert[-266.235565 92.601219 920.386108]
	_WayPoints:Insert[-272.920990 91.023926 913.065796]
	_WayPoints:Insert[-279.341461 91.047821 905.018433]
	_WayPoints:Insert[-289.327728 91.351646 904.223938]
	_WayPoints:Insert[-294.749390 91.208313 913.102539]
	_WayPoints:Insert[-300.312469 93.453285 921.661011]
	_WayPoints:Insert[-307.088715 94.010162 929.385437]
	_WayPoints:Insert[-314.623322 94.304474 936.109192]
	_WayPoints:Insert[-324.914948 93.814911 937.127319]
	_WayPoints:Insert[-335.312103 93.804604 936.813293]
	_WayPoints:Insert[-345.655853 94.406914 936.242310]
	_WayPoints:Insert[-355.904419 94.898270 935.443787]
	_WayPoints:Insert[-364.821228 94.816605 930.403748]
	_WayPoints:Insert[-373.132141 94.388542 924.340759]
	_WayPoints:Insert[-382.574371 96.259720 927.319519]
	_WayPoints:Insert[-392.222229 97.451286 930.580872]
	_WayPoints:Insert[-402.087921 97.068756 932.200928]
	_WayPoints:Insert[-412.005737 96.336830 933.911682]
	_WayPoints:Insert[-421.984375 95.405060 935.051270]
	_WayPoints:Insert[-431.678497 94.702728 931.536316]
	_WayPoints:Insert[-435.392944 94.694107 922.152161]
	_WayPoints:Insert[-443.763458 95.582527 916.524841]
	_WayPoints:Insert[-453.526581 97.341736 913.513123]
	_WayPoints:Insert[-462.930725 97.868904 909.797607]
	_WayPoints:Insert[-469.864349 98.374321 902.259949]
	_WayPoints:Insert[-478.826630 101.299500 898.360291]
	_WayPoints:Insert[-486.805969 103.587036 892.121216]
	_WayPoints:Insert[-494.738281 105.601151 886.291931]
	_WayPoints:Insert[-499.015839 105.948486 877.052673]
	_WayPoints:Insert[-494.311554 104.115440 868.249207]
	_WayPoints:Insert[-488.252563 102.222382 860.509216]
	_WayPoints:Insert[-481.964783 101.379204 852.692383]
	_WayPoints:Insert[-475.494873 101.590034 844.955566]
	_WayPoints:Insert[-466.091248 101.908813 841.189087]
	_WayPoints:Insert[-456.831604 100.954803 837.389038]
	_WayPoints:Insert[-466.705505 100.458611 835.123413]
	_WayPoints:Insert[-476.991913 99.931953 834.045776]
	_WayPoints:Insert[-487.149811 101.436584 832.981445]
	_WayPoints:Insert[-496.721191 103.756653 836.166687]
	_WayPoints:Insert[-504.791504 106.415184 842.248962]
	_WayPoints:Insert[-512.728577 109.358864 848.189941]
	_WayPoints:Insert[-520.468994 112.251320 853.872009]
	_WayPoints:Insert[-528.931946 116.206726 857.541870]
	_WayPoints:Insert[-538.170898 120.295265 859.460693]
	_WayPoints:Insert[-547.884033 124.106247 859.623779]
	_WayPoints:Insert[-550.500366 125.189590 856.166077]
	_WayPoints:Insert[-547.937195 124.154305 846.381226]
	_WayPoints:Insert[-552.046082 126.653503 837.484314]
	_WayPoints:Insert[-561.651123 129.619400 836.725342]
	_WayPoints:Insert[-571.012390 131.988068 839.412781]
	_WayPoints:Insert[-580.810059 133.948364 837.740784]
	_WayPoints:Insert[-590.899902 132.972672 836.424866]
	_WayPoints:Insert[-600.214966 131.735901 839.996765]
	_WayPoints:Insert[-607.010742 131.646744 847.345642]
	_WayPoints:Insert[-613.975830 132.730103 854.926270]
	_WayPoints:Insert[-620.975159 133.811844 862.544678]
	_WayPoints:Insert[-627.918701 134.386078 870.102356]
	_WayPoints:Insert[-634.572144 135.116852 877.718689]
	_WayPoints:Insert[-641.205811 134.942673 885.309265]
	_WayPoints:Insert[-647.546326 133.685852 893.313904]
	_WayPoints:Insert[-656.601746 132.213379 897.472229]
	_WayPoints:Insert[-665.393860 132.098663 892.257629]
	_WayPoints:Insert[-671.854065 132.095306 884.137451]
	_WayPoints:Insert[-673.503174 133.810196 874.284790]
	_WayPoints:Insert[-672.072449 135.180466 864.243530]
	_WayPoints:Insert[-670.845520 134.907562 854.063721]
	_WayPoints:Insert[-668.186035 133.915344 844.435852]
	_WayPoints:Insert[-663.815857 132.946854 835.357361]
	_WayPoints:Insert[-656.548889 132.607559 828.432739]
	_WayPoints:Insert[-646.305054 132.348801 829.173279]
	_WayPoints:Insert[-636.395935 130.850113 827.850464]
	_WayPoints:Insert[-627.033081 129.162231 824.690491]
	_WayPoints:Insert[-617.191772 129.155624 822.286072]
	_WayPoints:Insert[-608.783203 129.357254 816.830139]
	_WayPoints:Insert[-612.681458 133.112793 808.008667]
	_WayPoints:Insert[-617.717468 134.313797 799.433533]
	_WayPoints:Insert[-622.966003 133.639191 790.729858]
	_WayPoints:Insert[-627.808899 132.386093 782.059021]
	_WayPoints:Insert[-630.619995 130.777496 772.556091]
	_WayPoints:Insert[-639.380554 129.730743 767.592651]
	_WayPoints:Insert[-639.152344 129.944656 757.481812]
	_WayPoints:Insert[-634.901855 130.349747 748.034424]
	_WayPoints:Insert[-632.276245 130.067047 738.160156]
	_WayPoints:Insert[-630.235657 129.002502 728.175415]
	_WayPoints:Insert[-630.857483 129.876709 717.930908]
	_WayPoints:Insert[-633.158325 129.444489 707.884094]
	_WayPoints:Insert[-623.645203 130.554352 704.770081]
	_WayPoints:Insert[-613.348022 130.651596 704.891235]
	_WayPoints:Insert[-603.071106 130.983612 706.078064]
	_WayPoints:Insert[-592.970276 130.670120 706.965454]
	_WayPoints:Insert[-582.789856 130.487701 706.893921]
	_WayPoints:Insert[-572.914917 129.303146 708.593140]
	_WayPoints:Insert[-563.266724 128.695847 705.215820]
	_WayPoints:Insert[-556.246033 128.229401 697.972717]
	_WayPoints:Insert[-551.462891 128.129288 688.784363]
	_WayPoints:Insert[-546.783691 128.060684 679.804443]
	_WayPoints:Insert[-540.263062 128.015900 671.957764]
	_WayPoints:Insert[-533.582275 128.045212 664.280945]
	_WayPoints:Insert[-527.884766 127.884171 655.971252]
	_WayPoints:Insert[-522.376953 127.859161 647.354309]
	_WayPoints:Insert[-516.613708 127.701813 638.880554]
	_WayPoints:Insert[-510.778595 127.475769 630.607117]
	_WayPoints:Insert[-505.634003 127.059219 621.845520]
	_WayPoints:Insert[-503.428223 126.781990 612.077332]
	_WayPoints:Insert[-495.921326 126.161148 618.891907]
	_WayPoints:Insert[-494.847015 126.626099 629.100525]
	_WayPoints:Insert[-498.377502 127.116745 638.466675]
	_WayPoints:Insert[-504.400665 127.210266 646.565430]
	_WayPoints:Insert[-511.464783 127.052216 653.641846]
	_WayPoints:Insert[-518.456055 127.140656 661.086243]
	_WayPoints:Insert[-525.203430 127.143150 668.791077]
	_WayPoints:Insert[-530.648804 127.079132 677.463806]
	_WayPoints:Insert[-534.546936 127.296524 686.683716]
	_WayPoints:Insert[-537.647400 127.687637 696.362244]
	_WayPoints:Insert[-541.389282 127.195946 705.824036]
	_WayPoints:Insert[-545.654907 126.922989 715.085938]
	_WayPoints:Insert[-545.106873 124.886253 724.958740]
	_WayPoints:Insert[-544.288208 123.585152 735.034180]
	_WayPoints:Insert[-537.105957 122.581291 742.149597]
	_WayPoints:Insert[-528.284424 121.993355 746.965637]
	_WayPoints:Insert[-520.126831 119.449539 752.238159]
	_WayPoints:Insert[-511.899628 116.248871 756.942566]
	_WayPoints:Insert[-503.775024 113.668083 762.698730]
	_WayPoints:Insert[-495.614655 111.295929 768.478577]
	_WayPoints:Insert[-488.802460 110.129143 775.743713]
	_WayPoints:Insert[-481.956024 108.060493 782.871765]
	_WayPoints:Insert[-473.874237 104.756584 787.859436]
	_WayPoints:Insert[-465.319641 101.991928 792.885132]
	_WayPoints:Insert[-456.047974 100.040810 796.928711]
	_WayPoints:Insert[-445.977448 99.572296 797.585144]
	_WayPoints:Insert[-436.022644 101.389267 798.260925]
	_WayPoints:Insert[-427.956390 101.887344 804.564941]
	_WayPoints:Insert[-419.882599 102.314224 810.928894]
	_WayPoints:Insert[-413.428436 101.602394 818.792603]
	_WayPoints:Insert[-411.112518 98.873970 828.134460]
	_WayPoints:Insert[-413.336304 97.560783 837.928467]
	_WayPoints:Insert[-415.508850 97.217018 847.770874]
	_WayPoints:Insert[-411.522064 96.227829 856.898132]
	_WayPoints:Insert[-401.791290 95.808678 859.872803]
	_WayPoints:Insert[-391.680206 95.048668 859.967224]
	_WayPoints:Insert[-381.783752 93.517891 860.793335]
	_WayPoints:Insert[-371.348480 93.487732 862.139282]
	_WayPoints:Insert[-361.698364 93.137848 865.399170]
	_WayPoints:Insert[-352.103210 93.307915 869.040710]
	_WayPoints:Insert[-342.223663 93.651039 872.119812]
	_WayPoints:Insert[-332.604156 92.925262 875.303650]
	_WayPoints:Insert[-322.383514 93.598244 876.841736]
	_WayPoints:Insert[-312.509369 93.134613 873.884644]
	_WayPoints:Insert[-302.516907 92.890251 871.299133]
	_WayPoints:Insert[-292.451355 92.696136 869.295715]
	_WayPoints:Insert[-282.498810 92.548813 867.315796]
	_WayPoints:Insert[-272.457489 92.729485 864.851868]
	_WayPoints:Insert[-262.802094 92.777924 861.643860]
	_WayPoints:Insert[-253.666275 92.723770 857.038269]
	_WayPoints:Insert[-245.541809 92.623726 850.876709]
	_WayPoints:Insert[-237.666534 92.784103 844.423584]
	_WayPoints:Insert[-227.539063 92.922684 844.500610]
	_WayPoints:Insert[-222.519775 92.852676 853.399658]
	_WayPoints:Insert[-222.219864 93.047562 863.708801]
	_WayPoints:Insert[-221.067581 92.817001 873.822083]
	_WayPoints:Insert[-218.681137 92.928101 883.573853]
	_WayPoints:Insert[-215.405289 92.806091 893.259399]
	_WayPoints:Insert[-209.603149 92.893219 901.786255]
	_WayPoints:Insert[-200.079300 92.889221 905.928162]
	_WayPoints:Insert[-189.967148 92.928734 908.601074]
	_WayPoints:Insert[-180.809967 93.079269 913.092651]
	_WayPoints:Insert[-171.153473 93.190140 916.236755]
	_WayPoints:Insert[-161.309006 93.072548 913.741821]
	_WayPoints:Insert[-152.330017 92.721725 909.268311]
	_WayPoints:Insert[-142.959915 92.509903 905.513489]
	_WayPoints:Insert[-133.554611 92.570770 901.932556]
	_WayPoints:Insert[-124.759148 94.891350 897.554626]
	_WayPoints:Insert[-115.763779 95.971855 892.947449]
	_WayPoints:Insert[-110.536247 98.785645 884.740662]
	_WayPoints:Insert[-103.485954 99.253868 877.432617]
	_WayPoints:Insert[-97.564758 99.719749 869.081482]
	_WayPoints:Insert[-91.809029 99.248970 860.886108]
	_WayPoints:Insert[-85.588448 98.242111 852.744263]
	_WayPoints:Insert[-78.904411 97.294678 844.972534]
	_WayPoints:Insert[-71.984535 96.344910 837.687866]
	_WayPoints:Insert[-62.087696 94.681801 835.686401]
	_WayPoints:Insert[-52.467262 93.509628 838.709106]
	_WayPoints:Insert[-46.695778 92.436844 846.910278]
	_WayPoints:Insert[-48.361198 92.024956 856.993774]
	_WayPoints:Insert[-50.686729 91.824814 866.933777]
	_WayPoints:Insert[-54.312256 91.347206 876.565186]
	_WayPoints:Insert[-59.231129 91.325134 885.456482]
	_WayPoints:Insert[-60.043591 91.298309 884.257996]
	_WayPoints:Insert[-51.246338 91.159653 879.287842]
	_WayPoints:Insert[-41.819420 91.386887 882.755188]
	_WayPoints:Insert[-37.099842 91.753654 889.345154]
	
	variable int _count
	variable int _count2
	;gnomish bolt - 1580
	variable bool _BoltsDone
	_BoltsDone:Set[FALSE]
	;oil - 6946
	variable bool _GreaseDone
	_GreaseDone:Set[FALSE]
	;water pump - 8089
	variable bool _WPDone
	_WPDone:Set[FALSE]
	;power - 6333
	variable bool _PowerDone
	_PowerDone:Set[FALSE]
	variable int _WPCnt
	_WPCnt:Set[0]
	for(_count:Set[1];${_count}<=${_WayPoints.Used};_count:Inc)
	{
		if ${_BoltsDone} && ${_GreaseDone} && ${_WPDone} && ${_PowerDone}
		{
			_count2:Set[${_count}]
			_count:Set[${Math.Calc[${_WayPoints.Used}+1]}]
			continue
		}
		call RIMObj.Move ${_WayPoints.Get[${_count}]} 1 0 FALSE FALSE TRUE TRUE
		call BDCheckForItem ${_BoltsDone} ${_GreaseDone} ${_WPDone} ${_PowerDone}
		if ${Trigger}
		{
			if ${TriggerMessage.Find[gnomish bolt (20/20)](exists)}
				_BoltsDone:Set[TRUE]
			if ${TriggerMessage.Find[sample of used grease (10/10)](exists)}
				_GreaseDone:Set[TRUE]
			if ${TriggerMessage.Find[rusted water pump](exists)}
			{
				_WPCnt:Inc
				if ${_WPCnt}>1
					_WPDone:Set[TRUE]
			}
			if ${TriggerMessage.Find[rusted water pump (2/2)](exists)}
				_WPDone:Set[TRUE]
			if ${TriggerMessage.Find[used power source](exists)}
				_PowerDone:Set[TRUE]
			Trigger:Set[FALSE]
			TriggerMessage:Set[NA]
		}
		wait 1
	}
	for(;${_count2}>=1;_count2:Dec)
	{
		call RIMObj.Move ${_WayPoints.Get[${_count2}]} 1 0 FALSE FALSE TRUE TRUE
	}
	call RIMObj.Move ${_WayPoints.Get[${_WayPoints.Used}]} 1 0 FALSE FALSE TRUE FALSE
}
function BDCheckForItem(bool _BD, bool _GD, bool _WPD, bool _PD)
{
	variable int _ID
	variable string _temp
	_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
	variable string _Query
	_Query:Set["Name==\"scrap heap\" && Distance<=50 && ( "]
	if !${_BD}
		_Query:Concat["TintFlags=1580"]
	if !${_BD} && ( !${_GD} || !${_WPD} || !${_PD} )
		_Query:Concat["||"]
	if !${_GD}
		_Query:Concat["TintFlags=6946"]
	if !${_GD} && ( !${_WPD} || !${_PD} )
		_Query:Concat["||"]
	if !${_WPD}
		_Query:Concat["TintFlags=8089"]
	if !${_WPD} && !${_PD}
		_Query:Concat["||"]
	if !${_PD}
		_Query:Concat["TintFlags=6333"]
	_Query:Concat[" )"]
	;echo ${_Query}  //  ${_BD}  ${_GD}  ${_WPD}  ${_PD}
	if ${Actor[Query, ${_Query}](exists)}
	{
		_ID:Set[${Actor[Query, ${_Query}].ID}]
		if !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+2]},${Actor[Query, ID=${_ID}].Z}]}
		{
			call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+2]} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
			wait 5
			while ${Actor[Query, ID=${_ID}](exists)}
			{
				Actor[Query, ID=${_ID}]:DoTarget
				wait 1
				Actor[Query, ID=${_ID}]:DoubleClick
				wait 9
			}
			call RIMObj.Move ${_temp} 1 0 FALSE FALSE TRUE FALSE
		}
	}
}
function BixieDistractionGatherNightshade()
{
	;load zonefile
	AnnounceText:Clear
	AnnounceText:Insert[Quest item found!]
	;now start running the path and check for the items 
	variable index:string _WayPoints
	_WayPoints:Insert[-375.797546 17.600355 63.116295]
	_WayPoints:Insert[-380.549774 16.692076 53.740112]
	_WayPoints:Insert[-381.643005 16.703724 50.401638]
	_WayPoints:Insert[-391.184021 16.452175 47.399757]
	_WayPoints:Insert[-400.991730 16.172081 45.171528]
	_WayPoints:Insert[-411.027802 15.456699 44.240471]
	_WayPoints:Insert[-421.119110 14.804485 44.948818]
	_WayPoints:Insert[-431.071106 14.636902 46.417751]
	_WayPoints:Insert[-440.996521 14.365783 48.673439]
	_WayPoints:Insert[-450.643036 13.976727 51.515270]
	_WayPoints:Insert[-460.133698 14.051115 54.996773]
	_WayPoints:Insert[-462.106354 14.420191 64.872673]
	_WayPoints:Insert[-461.688080 14.879245 74.928009]
	_WayPoints:Insert[-452.495422 15.273214 79.019012]
	_WayPoints:Insert[-442.274231 15.812521 80.336906]
	_WayPoints:Insert[-432.267548 16.520985 81.000877]
	_WayPoints:Insert[-421.956970 17.009665 81.002716]
	_WayPoints:Insert[-411.887726 17.676796 80.854965]
	_WayPoints:Insert[-401.828888 17.941278 80.822540]
	_WayPoints:Insert[-393.139282 17.730619 75.564171]
	_WayPoints:Insert[-386.154358 17.440544 68.200356]
	_WayPoints:Insert[-379.965942 17.023417 61.020550]
	
	
	variable int _count
	variable int _count2
	variable bool _GoBW
	_GoBW:Set[FALSE]
	variable bool _NightshadeDone
	_NightshadeDone:Set[FALSE]
	for(_count:Set[1];${_count}<=${_WayPoints.Used};_count:Inc)
	{
		if ${_NightshadeDone} && ${_count}<11
		{
			_count2:Set[${_count}]
			_count:Set[${Math.Calc[${_WayPoints.Used}+1]}]
			_GoBW:Set[TRUE]
			continue
		}
		call RIMObj.Move ${_WayPoints.Get[${_count}]} 1 0 FALSE FALSE TRUE TRUE
		if !${_NightshadeDone}
			call BDCheckForShade
		if ${Trigger}
		{
			if ${TriggerMessage.Find[eternal nightshade (15/15)](exists)}
				_NightshadeDone:Set[TRUE]
			Trigger:Set[FALSE]
			TriggerMessage:Set[NA]
		}
		wait 1
	}
	if ${_GoBW}
	{
		for(;${_count2}>=1;_count2:Dec)
		{
			call RIMObj.Move ${_WayPoints.Get[${_count2}]} 1 0 FALSE FALSE TRUE TRUE
		}
		call RIMObj.Move ${_WayPoints.Get[${_WayPoints.Used}]} 1 0 FALSE FALSE TRUE FALSE
	}
}
function BDCheckForShade()
{
	variable int _ID
	variable string _temp
	_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
	variable string _Query
	_Query:Set["Name==\"eternal nightshade\" && Distance<=15"]

	;echo ${_Query}  //  ${_BD}  ${_GD}  ${_WPD}  ${_PD}
	if ${Actor[Query, ${_Query}](exists)}
	{
		_ID:Set[${Actor[Query, ${_Query}].ID}]
		if !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
		{
			call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
			wait 5
			while ${Actor[Query, ID=${_ID}](exists)}
			{
				Actor[Query, ID=${_ID}]:DoTarget
				wait 1
				Actor[Query, ID=${_ID}]:DoubleClick
				wait 9
			}
			call RIMObj.Move ${_temp} 1 0 FALSE FALSE TRUE FALSE
		}
	}
}
function Shatteredseastempleofdoom()
{
	call ShatteredSeasTempleofDoom
}
function ShatteredSeasTempleofDoom()
{
	variable int _cnt=0
	while !${Actor[Query, Name=-"a Shissar Invader" && IsDead=FALSE](exists)} && ${_cnt:Inc}<=36000
		wait 1
	while ${Actor[Query, Name=-"a Shissar Invader" && IsDead=FALSE](exists)}
	{
		if ${Target.ID}!=${Actor[Query, Name=-"a Shissar Invader" && IsDead=FALSE].ID}
			Actor[Query, Name=-"a Shissar Invader"]:DoTarget
		if ${Me.Ability[id,1850803929].IsReady}
			Me.Ability[id,1850803929]:Use
		elseif ${Me.Ability[id,425080399].IsReady}
			Me.Ability[id,425080399]:Use
		elseif ${Me.Ability[id,507245142].IsReady}
			Me.Ability[id,507245142]:Use
		elseif ${Me.Ability[id,4030043002].IsReady}
			Me.Ability[id,4030043002]:Use
		elseif ${Me.Ability[id,2268242924].IsReady}
			Me.Ability[id,2268242924]:Use
		wait 1
	}
	while ${Actor[Query, TintFlags=5987](exists)}
	{
		if ${Target.ID}!=${Actor[Query, TintFlags=5987].ID}
			Actor[Query, TintFlags=5987]:DoTarget
		if ${Me.Ability[id,2153736181].IsReady}
			Me.Ability[id,2153736181]:Use
		wait 1
	}
}
function GetCorrectQuest(string _Actor, string _QuestName, string _QuestStep, int _NumberofResponses)
{
	variable int _failcnt=0
	variable bool _noconvo=FALSE
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["${_Actor}"]
	IncomingText2:Insert["says to you"]
	CustomLoc:Set["0 0 0"]
	wait 2
	Trigger:Set[0]
	do
	{
		Actor["${_Actor}"]:DoFace
		Actor["${_Actor}"]:DoubleClick
		wait 10 ${Trigger}
	}
	while !${Trigger} && !${QuestJournalWindow.ActiveQuest[${_QuestName}](exists)} && !${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)}
	
	Trigger:Set[FALSE]
	_failcnt:Set[-1]
	while !${QuestJournalWindow.ActiveQuest[${_QuestName}](exists)} && !${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} && !${_noconvo}
	{
		if !${EQ2UIPage[ProxyActor,Conversation].IsVisible}
			_failcnt:Inc
		if ${_failcnt}>1
			_noconvo:Set[1]
		wait 50 ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1](exists)}
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
	}
	_noconvo:Set[0]
	do
	{
		wait 5
		if !${RIObj.QuestStepExists[${_QuestStep}]}
		{
			if ${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)}
				QuestJournalWindow.ActiveQuest["${_QuestName}"]:Delete
			wait 2
			Trigger:Set[0]
			do
			{
				Actor["${_Actor}"]:DoFace
				Actor["${_Actor}"]:DoubleClick
				wait 10 ${Trigger}
			}
			while !${Trigger} && !${QuestJournalWindow.ActiveQuest[${_QuestName}](exists)} && !${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)}
			Trigger:Set[FALSE]
			_failcnt:Set[-1]
			while !${QuestJournalWindow.ActiveQuest[${_QuestName}](exists)} && !${QuestJournalWindow.ActiveQuest["${_QuestName}"](exists)} && !${_noconvo}
			{
				if !${EQ2UIPage[ProxyActor,Conversation].IsVisible}
					_failcnt:Inc
				if ${_failcnt}>1
					_noconvo:Set[1]
				wait 50 ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1](exists)}
				EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
			}
			_noconvo:Set[0]
		}
	}
	while !${RIObj.QuestStepExists[${_QuestStep}]}

}
function PathHail(int _PathLines, int _Distance, bool _Loop, bool _GoReverseAfterAllQuantitiesMet, bool _GoReverseAtLoopOrEnd, ... args)
{	
	Trigger:Set[FALSE]
	;variable string echostr="int _PathLines=${_PathLines}, int _Distance=${_Distance}, bool _Loop=${_Loop}, bool _GoReverseAfterAllQuantitiesMet=${_GoReverseAfterAllQuantitiesMet}, bool _GoReverseAtLoopOrEnd=${_GoReverseAtLoopOrEnd}, ... args="
	;string _Node, int _Quantity,
	variable int _start
	variable int _end
	variable int _count
	variable int _Precision=2
	variable string _Query
	variable int _ID
	;variable string _tempName
	variable string _temp
	variable bool _IWasFlying=FALSE
	variable bool _Done
	AnnounceText:Clear
	IncomingText:Clear
	IncomingText2:Clear
	_start:Set[${MainArrayCounter}]

	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		;echostr:Concat[" ${_count}: ${args[${_count}]} ${Math.Calc[${_count}+1].Precision[0]}: ${args[${Math.Calc[${_count}+1]}]} ${Math.Calc[${_count}+2].Precision[0]}: ${args[${Math.Calc[${_count}+2]}]} ${Math.Calc[${_count}+3].Precision[0]}: ${args[${Math.Calc[${_count}+3]}]}"]
		; _AmountKilled:Insert[0]
		; _AmountKilled:Insert[0]
		; _AmountKilled:Insert[0]
		
		if ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
			AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
		elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[IT-]}
			IncomingText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
		else
			AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}]}]
			
		;echo inserted ${args[${Math.Calc[${_count}+1]}].Right[-3]} // ${AnnounceText.Get[1]} // ${IncomingText.Get[1]}
		_count:Inc
		_count:Inc
		_count:Inc
	}
	; for(_count:Set[1];${_count}<=${IncomingText.Used};_count:Inc)
	; {
		; echo ${IncomingText.Get[${_count}]}
	; }
	; for(_count:Set[1];${_count}<=${AnnounceText.Used};_count:Inc)
	; {
		; echo ${AnnounceText.Get[${_count}]}
	; }
	;echo ${echostr}
	_end:Set[${Math.Calc[${MainArrayCounter}+${_PathLines}]}]
	for(;${MainArrayCounter}<=${_end};MainArrayCounter:Inc)
	{
		call RIMObj.CheckCombat
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			if ${RI_Var_Bool_BreakPathFunction}
			{
				RI_Var_Bool_BreakPathFunction:Set[0]
				return
			}
			;check for our node and if we are
			if !${_Done}
			{
				; if ${_HighlightOnMouseHover}
					; _Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
				; else
					_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance}"]
				;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
				if ${Actor[Query, ${_Query}](exists)}
				{
					_ID:Set[${Actor[Query, ${_Query}].ID}]
					;echo if ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					if ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<20 && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )
					{
						_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
						if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
						{
							if ${Me.FlyingUsingMount}
								_IWasFlying:Set[TRUE]
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
							if ${Me.FlyingUsingMount}
								call RIMObj.FlyDown
						}
						else
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
						;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
						wait 5
						;_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
						while !${Trigger}
						{
							if ${RI_Var_Bool_BreakPathFunction}
							{
								RI_Var_Bool_BreakPathFunction:Set[0]
								return
							}
							if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
							{
								call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								continue
							}
							RI_CMD_PauseCombatBots 1
							wait 5
							Actor[Query, ID=${_ID}]:DoFace
							wait 5
							Actor[Query, ID=${_ID}]:DoTarget
							wait 5
							eq2execute hail
							wait 5
						
							variable int _counth
							for(_counth:Set[1];${_counth}<=${args[${Math.Calc[${_count}+2]}]};_counth:Inc)
							{
								if ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${Math.Calc[${_count}+3]}]}](exists)}
									EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${Math.Calc[${_count}+3]}]}]:LeftClick
								wait 5
							}
							;unpause bots
							RI_CMD_PauseCombatBots 0
						}
						wait 5
						_Done:Set[TRUE]
						; if ${Trigger}
						; {
							; _AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							; echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							; Trigger:Set[FALSE]
						; }
						if ${_IWasFlying}
						{
							press -hold ${RI_Var_String_FlyUpKey}
							wait 1
							press -release ${RI_Var_String_FlyUpKey}
							_IWasFlying:Set[FALSE]
						}
						call RIMObj.Move ${_temp} 1 0 FALSE FALSE TRUE FALSE
					}
				}
			}
			_count:Inc
			_count:Inc
		}
		call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1
		_AllQuantitiesMet:Set[TRUE]
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			_count:Inc
			_count:Inc
			;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
			if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
				_AllQuantitiesMet:Set[FALSE]
		}
		; if ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet}
		; {
			; MainArrayCounter:Set[${_end}]
			; echo TimeToEnd
		; }
		if ( ${MainArrayCounter}==${_end} && ${_GoReverseAtLoopOrEnd} ) || ( ${_GoReverseAfterAllQuantitiesMet} && ${_Done} )
		{
			MainArrayCounter:Dec
			for(;${MainArrayCounter}>=${_start};MainArrayCounter:Dec)
			{
				if ${RI_Var_Bool_BreakPathFunction}
				{
					RI_Var_Bool_BreakPathFunction:Set[0]
					return
				}
				call RIMObj.CheckCombat
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					;check for our node and if we are
					if !${_Done}
					{
						; if ${_HighlightOnMouseHover}
							; _Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
						; else
							_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance}"]

						;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
						if ${Actor[Query, ${_Query}](exists)}
						{
							_ID:Set[${Actor[Query, ${_Query}].ID}]
							;echo if ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							if ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<20 && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]} 
							;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							{
								_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
								if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
								{
									if ${Me.FlyingUsingMount}
										_IWasFlying:Set[TRUE]
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
									if ${Me.FlyingUsingMount}
										call RIMObj.FlyDown
								}
								else
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
								wait 5
								;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								;wait 5
								;_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
								while !${Trigger}
								{
									if ${RI_Var_Bool_BreakPathFunction}
									{
										RI_Var_Bool_BreakPathFunction:Set[0]
										return
									}
									if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
									{
										call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
										continue
									}
									RI_CMD_PauseCombatBots 1
									wait 5
									Actor[Query, ID=${_ID}]:DoFace
									wait 5
									Actor[Query, ID=${_ID}]:DoTarget
									wait 5
									eq2execute hail
									wait 5
								
									variable int count
									for(count:Set[1];${count}<=${args[${Math.Calc[${_count}+2]}]};count:Inc)
									{
										if ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${Math.Calc[${_count}+3]}]}](exists)}
											EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${Math.Calc[${_count}+3]}]}]:LeftClick
										wait 5
									}
									;unpause bots
									RI_CMD_PauseCombatBots 0
								}
								wait 5
								_Done:Set[TRUE]
								;if ${Trigger} 
								;|| ${args[${Math.Calc[${_count}+1]}].Equal[0]}
								; {
									; _AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
									; echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
									; Trigger:Set[FALSE]
								; }
								if ${_IWasFlying}
								{
									press -hold ${RI_Var_String_FlyUpKey}
									wait 1
									press -release ${RI_Var_String_FlyUpKey}
									_IWasFlying:Set[FALSE]
								}
								call RIMObj.Move ${_temp} 1 0 FALSE FALSE TRUE FALSE
							}
						}
					}
					_count:Inc
					_count:Inc
				}
				call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1
				_AllQuantitiesMet:Set[TRUE]
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					_count:Inc
					_count:Inc
					;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
					if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
						_AllQuantitiesMet:Set[FALSE]
				}
			}
			;if !${_Loop}
				MainArrayCounter:Set[${_end}]
		}
		if ${_Loop} && ${MainArrayCounter}==${_end} && !${_Done}
		{
			;echo looping because ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
			MainArrayCounter:Set[${_start}]
		}
	}
	press -release ${RI_Var_String_ForwardKey}
	AnnounceText:Clear
	Trigger:Set[FALSE]
}
function PathHailCast(int _PathLines, int _Distance, bool _Loop, bool _GoReverseAfterAllQuantitiesMet, bool _GoReverseAtLoopOrEnd, ... args)
{	
	Trigger:Set[FALSE]
	;variable string echostr="int _PathLines=${_PathLines}, int _Distance=${_Distance}, bool _Loop=${_Loop}, bool _GoReverseAfterAllQuantitiesMet=${_GoReverseAfterAllQuantitiesMet}, bool _GoReverseAtLoopOrEnd=${_GoReverseAtLoopOrEnd}, ... args="
	;string _Mob, string _Trigger, int _Quantity, string _CastID
	variable int _start
	variable int _end
	variable int _count
	variable int _Precision=2
	variable string _Query
	variable int _ID
	;variable string _tempName
	variable string _temp
	variable bool _IWasFlying=FALSE
	variable bool _Done
	variable int _endcnt=0
	AnnounceText:Clear
	IncomingText:Clear
	IncomingText2:Clear
	_start:Set[${MainArrayCounter}]

	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		;echostr:Concat[" ${_count}: ${args[${_count}]} ${Math.Calc[${_count}+1].Precision[0]}: ${args[${Math.Calc[${_count}+1]}]} ${Math.Calc[${_count}+2].Precision[0]}: ${args[${Math.Calc[${_count}+2]}]} ${Math.Calc[${_count}+3].Precision[0]}: ${args[${Math.Calc[${_count}+3]}]}"]
		; _AmountKilled:Insert[0]
		; _AmountKilled:Insert[0]
		; _AmountKilled:Insert[0]
		
		if ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
			AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
		elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[IT-]}
			IncomingText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
		else
			AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}]}]
			
		;echo inserted ${args[${Math.Calc[${_count}+1]}].Right[-3]} // ${AnnounceText.Get[1]} // ${IncomingText.Get[1]}
		_count:Inc
		_count:Inc
		_count:Inc
	}
	; for(_count:Set[1];${_count}<=${IncomingText.Used};_count:Inc)
	; {
		; echo ${IncomingText.Get[${_count}]}
	; }
	; for(_count:Set[1];${_count}<=${AnnounceText.Used};_count:Inc)
	; {
		; echo ${AnnounceText.Get[${_count}]}
	; }
	;echo ${echostr}
	_end:Set[${Math.Calc[${MainArrayCounter}+${_PathLines}]}]
	for(;${MainArrayCounter}<=${_end};MainArrayCounter:Inc)
	{
		call RIMObj.CheckCombat
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			;check for our node and if we are
			if !${_Done}
			{
				; if ${_HighlightOnMouseHover}
					; _Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
				; else
					_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance}"]
				;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
				if ${Actor[Query, ${_Query}](exists)}
				{
					_ID:Set[${Actor[Query, ${_Query}].ID}]
					;echo if ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					if ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<20 && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )
					{
						_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
						if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
						{
							if ${Me.FlyingUsingMount}
								_IWasFlying:Set[TRUE]
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
							if ${Me.FlyingUsingMount}
								call RIMObj.FlyDown
						}
						else
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
						;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
						wait 5
						;_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
						while !${Trigger}
						{
							if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
							{
								call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								continue
							}
							RI_CMD_PauseCombatBots 1
							wait 2
							Actor[Query, ID=${_ID}]:DoFace
							;wait 5
							Actor[Query, ID=${_ID}]:DoTarget
							wait 2
							eq2execute hail
							wait 5
						
							; variable int _counth
							; for(_counth:Set[1];${_counth}<=${args[${Math.Calc[${_count}+3]}]};_counth:Inc)
							; {
								; if ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${Math.Calc[${_count}+3]}]}](exists)}
									; EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${Math.Calc[${_count}+3]}]}]:LeftClick
								; wait 5
							; }
							; wait 5
							_endcnt:Set[0]
							while ${Me.Ability[id,${args[${Math.Calc[${_count}+3]}]}].IsReady} && ${_endcnt:Inc}<50
							{
								Me.Ability[id,${args[${Math.Calc[${_count}+3]}]}]:Use
								wait 1
							}
							wait 50 !${Me.CastingSpell}
							eq2ex target_none
							;unpause bots
							RI_CMD_PauseCombatBots 0
						}
						wait 5
						_Done:Set[TRUE]
						; if ${Trigger}
						; {
							; _AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							; echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							; Trigger:Set[FALSE]
						; }
						if ${_IWasFlying}
						{
							press -hold ${RI_Var_String_FlyUpKey}
							wait 1
							press -release ${RI_Var_String_FlyUpKey}
							_IWasFlying:Set[FALSE]
						}
						call RIMObj.Move ${_temp} 1 0 FALSE FALSE TRUE FALSE
					}
				}
			}
			_count:Inc
			_count:Inc
			_count:Inc
		}
		call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1
		_AllQuantitiesMet:Set[TRUE]
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			_count:Inc
			_count:Inc
			;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
			if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
				_AllQuantitiesMet:Set[FALSE]
			_count:Inc
		}
		; if ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet}
		; {
			; MainArrayCounter:Set[${_end}]
			; echo TimeToEnd
		; }
		if ( ${MainArrayCounter}==${_end} && ${_GoReverseAtLoopOrEnd} ) || ( ${_GoReverseAfterAllQuantitiesMet} && ${_Done} )
		{
			MainArrayCounter:Dec
			for(;${MainArrayCounter}>=${_start};MainArrayCounter:Dec)
			{
				call RIMObj.CheckCombat
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					;check for our node and if we are
					if !${_Done}
					{
						; if ${_HighlightOnMouseHover}
							; _Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
						; else
							_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance}"]

						;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
						if ${Actor[Query, ${_Query}](exists)}
						{
							_ID:Set[${Actor[Query, ${_Query}].ID}]
							;echo if ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							if ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<20 && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]} 
							;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							{
								_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
								if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
								{
									if ${Me.FlyingUsingMount}
										_IWasFlying:Set[TRUE]
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
									if ${Me.FlyingUsingMount}
										call RIMObj.FlyDown
								}
								else
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
								wait 5
								;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								;wait 5
								;_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
								while !${Trigger}
								{
									if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
									{
										call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
										continue
									}
									RI_CMD_PauseCombatBots 1
									wait 2
									Actor[Query, ID=${_ID}]:DoFace
									;wait 5
									Actor[Query, ID=${_ID}]:DoTarget
									wait 2
									eq2execute hail
									wait 5
								
									; variable int count
									; for(count:Set[1];${count}<=${args[${Math.Calc[${_count}+2]}]};count:Inc)
									; {
										; if ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${Math.Calc[${_count}+3]}]}](exists)}
											; EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${Math.Calc[${_count}+3]}]}]:LeftClick
										; wait 5
									; }
									
									_endcnt:Set[0]
									while ${Me.Ability[id,${args[${Math.Calc[${_count}+3]}]}].IsReady} && ${_endcnt:Inc}<50
									{
										Me.Ability[id,${args[${Math.Calc[${_count}+3]}]}]:Use
										wait 1
									}
									wait 50 !${Me.CastingSpell}
									eq2ex target_none
									;unpause bots
									RI_CMD_PauseCombatBots 0
								}
								wait 5
								_Done:Set[TRUE]
								;if ${Trigger} 
								;|| ${args[${Math.Calc[${_count}+1]}].Equal[0]}
								; {
									; _AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
									; echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
									; Trigger:Set[FALSE]
								; }
								if ${_IWasFlying}
								{
									press -hold ${RI_Var_String_FlyUpKey}
									wait 1
									press -release ${RI_Var_String_FlyUpKey}
									_IWasFlying:Set[FALSE]
								}
								call RIMObj.Move ${_temp} 1 0 FALSE FALSE TRUE FALSE
							}
						}
					}
					_count:Inc
					_count:Inc
					_count:Inc
				}
				call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1
				_AllQuantitiesMet:Set[TRUE]
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					_count:Inc
					_count:Inc
					;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
					if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
						_AllQuantitiesMet:Set[FALSE]
					_count:Inc
				}
			}
			;if !${_Loop}
				MainArrayCounter:Set[${_end}]
		}
		if ${_Loop} && ${MainArrayCounter}==${_end} && !${_Done}
		{
			;echo looping because ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
			MainArrayCounter:Set[${_start}]
		}
	}
	press -release ${RI_Var_String_ForwardKey}
	AnnounceText:Clear
	Trigger:Set[FALSE]
}
function PathHailExists(int _PathLines, int _Distance, bool _Loop, bool _GoReverseAfterAllQuantitiesMet, bool _GoReverseAtLoopOrEnd, ... args)
{	
	Trigger:Set[FALSE]
	;variable string echostr="int _PathLines=${_PathLines}, int _Distance=${_Distance}, bool _Loop=${_Loop}, bool _GoReverseAfterAllQuantitiesMet=${_GoReverseAfterAllQuantitiesMet}, bool _GoReverseAtLoopOrEnd=${_GoReverseAtLoopOrEnd}, ... args="
	;string _Node, int _Quantity,
	variable int _start
	variable int _end
	variable int _count
	variable int _Precision=2
	variable string _Query
	variable int _ID
	;variable string _tempName
	variable string _temp
	variable bool _IWasFlying=FALSE
	variable bool _Done
	
	AnnounceText:Clear
	IncomingText:Clear
	IncomingText2:Clear
	_start:Set[${MainArrayCounter}]

	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		;echostr:Concat[" ${_count}: ${args[${_count}]} ${Math.Calc[${_count}+1].Precision[0]}: ${args[${Math.Calc[${_count}+1]}]} ${Math.Calc[${_count}+2].Precision[0]}: ${args[${Math.Calc[${_count}+2]}]} ${Math.Calc[${_count}+3].Precision[0]}: ${args[${Math.Calc[${_count}+3]}]}"]
		; _AmountKilled:Insert[0]
		; _AmountKilled:Insert[0]
		; _AmountKilled:Insert[0]
		
		if ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
			AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
		elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[IT-]}
			IncomingText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
		else
			AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}]}]
			
		;echo inserted ${args[${Math.Calc[${_count}+1]}].Right[-3]} // ${AnnounceText.Get[1]} // ${IncomingText.Get[1]}
		_count:Inc
		_count:Inc
		_count:Inc
	}
	; for(_count:Set[1];${_count}<=${IncomingText.Used};_count:Inc)
	; {
		; echo ${IncomingText.Get[${_count}]}
	; }
	; for(_count:Set[1];${_count}<=${AnnounceText.Used};_count:Inc)
	; {
		; echo ${AnnounceText.Get[${_count}]}
	; }
	;echo ${echostr}
	_end:Set[${Math.Calc[${MainArrayCounter}+${_PathLines}]}]
	for(;${MainArrayCounter}<=${_end};MainArrayCounter:Inc)
	{
		call RIMObj.CheckCombat
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			;check for our node and if we are
			if !${_Done}
			{
				; if ${_HighlightOnMouseHover}
					; _Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
				; else
					_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance}"]
				;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
				if ${Actor[Query, ${_Query}](exists)}
				{
					_ID:Set[${Actor[Query, ${_Query}].ID}]
					;echo if ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					if ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<20 && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )
					{
						_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
						if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
						{
							if ${Me.FlyingUsingMount}
								_IWasFlying:Set[TRUE]
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
							if ${Me.FlyingUsingMount}
								call RIMObj.FlyDown
						}
						else
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
						;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
						wait 5
						;_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
						while ${Actor[Query, Name=-\"${args[${_count}]}\" && ID=${_ID}](exists)}
						{
							if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
							{
								call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								continue
							}
							if !${Me.InCombat}
							{
								RI_CMD_PauseCombatBots 1
								wait 5
								Actor[Query, ID=${_ID}]:DoFace
								wait 5
								Actor[Query, ID=${_ID}]:DoTarget
								wait 5
								eq2execute hail
								wait 25
								RI_CMD_PauseCombatBots 0
								wait 25
							}
							
							variable int _counth
							for(_counth:Set[1];${_counth}<=${args[${Math.Calc[${_count}+2]}]};_counth:Inc)
							{
								if ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${Math.Calc[${_count}+3]}]}](exists)}
									EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${Math.Calc[${_count}+3]}]}]:LeftClick
								wait 5
							}
						}
						wait 5
						if ${Trigger}
							_Done:Set[TRUE]
						; if ${Trigger}
						; {
							; _AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							; echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							; Trigger:Set[FALSE]
						; }
						if ${_IWasFlying}
						{
							press -hold ${RI_Var_String_FlyUpKey}
							wait 1
							press -release ${RI_Var_String_FlyUpKey}
							_IWasFlying:Set[FALSE]
						}
						call RIMObj.Move ${_temp} 1 0 FALSE FALSE TRUE FALSE
					}
				}
			}
			_count:Inc
			_count:Inc
		}
		call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1
		_AllQuantitiesMet:Set[TRUE]
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			_count:Inc
			_count:Inc
			;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
			if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
				_AllQuantitiesMet:Set[FALSE]
		}
		; if ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet}
		; {
			; MainArrayCounter:Set[${_end}]
			; echo TimeToEnd
		; }
		if ( ${MainArrayCounter}==${_end} && ${_GoReverseAtLoopOrEnd} ) || ( ${_GoReverseAfterAllQuantitiesMet} && ${_Done} )
		{
			MainArrayCounter:Dec
			for(;${MainArrayCounter}>=${_start};MainArrayCounter:Dec)
			{
				call RIMObj.CheckCombat
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					;check for our node and if we are
					if !${_Done}
					{
						; if ${_HighlightOnMouseHover}
							; _Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
						; else
							_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance}"]

						;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
						if ${Actor[Query, ${_Query}](exists)}
						{
							_ID:Set[${Actor[Query, ${_Query}].ID}]
							;echo if ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							if ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<20 && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]} 
							;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							{
								_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
								if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
								{
									if ${Me.FlyingUsingMount}
										_IWasFlying:Set[TRUE]
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
									if ${Me.FlyingUsingMount}
										call RIMObj.FlyDown
								}
								else
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
								wait 5
								;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								;wait 5
								;_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
								while ${Actor[Query, Name=-\"${args[${_count}]}\" && ID=${_ID}](exists)}
								{
									if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
									{
										call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
										continue
									}
									if !${Me.InCombat}
									{
										RI_CMD_PauseCombatBots 1
										wait 5
										Actor[Query, ID=${_ID}]:DoFace
										wait 5
										Actor[Query, ID=${_ID}]:DoTarget
										wait 5
										eq2execute hail
										wait 25
										RI_CMD_PauseCombatBots 0
										wait 25
									}
									; variable int count
									; for(count:Set[1];${count}<=${args[${Math.Calc[${_count}+2]}]};count:Inc)
									; {
										; if ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${Math.Calc[${_count}+3]}]}](exists)}
											; EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${Math.Calc[${_count}+3]}]}]:LeftClick
										; wait 5
									; }
								}
								wait 5
								if ${Trigger}
									_Done:Set[TRUE]
								;if ${Trigger} 
								;|| ${args[${Math.Calc[${_count}+1]}].Equal[0]}
								; {
									; _AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
									; echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
									; Trigger:Set[FALSE]
								; }
								if ${_IWasFlying}
								{
									press -hold ${RI_Var_String_FlyUpKey}
									wait 1
									press -release ${RI_Var_String_FlyUpKey}
									_IWasFlying:Set[FALSE]
								}
								call RIMObj.Move ${_temp} 1 0 FALSE FALSE TRUE FALSE
							}
						}
					}
					_count:Inc
					_count:Inc
				}
				call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1
				_AllQuantitiesMet:Set[TRUE]
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					_count:Inc
					_count:Inc
					;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
					if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
						_AllQuantitiesMet:Set[FALSE]
				}
			}
			;if !${_Loop}
				MainArrayCounter:Set[${_end}]
		}
		if ${_Loop} && ${MainArrayCounter}==${_end} && !${_Done}
		{
			;echo looping because ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
			MainArrayCounter:Set[${_start}]
		}
	}
	press -release ${RI_Var_String_ForwardKey}
	AnnounceText:Clear
	Trigger:Set[FALSE]
}
function PathHailDistance(int _PathLines, int _Distance, bool _Loop, bool _GoReverseAfterAllQuantitiesMet, bool _GoReverseAtLoopOrEnd, ... args)
{	
	Trigger:Set[FALSE]
	;variable string echostr="int _PathLines=${_PathLines}, int _Distance=${_Distance}, bool _Loop=${_Loop}, bool _GoReverseAfterAllQuantitiesMet=${_GoReverseAfterAllQuantitiesMet}, bool _GoReverseAtLoopOrEnd=${_GoReverseAtLoopOrEnd}, ... args="
	;string _Node, int _Quantity,
	variable int _start
	variable int _end
	variable int _count
	variable int _Precision=2
	variable string _Query
	variable int _ID
	;variable string _tempName
	variable string _temp
	variable bool _IWasFlying=FALSE
	variable bool _Done
	
	AnnounceText:Clear
	IncomingText:Clear
	IncomingText2:Clear
	_start:Set[${MainArrayCounter}]

	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		;echostr:Concat[" ${_count}: ${args[${_count}]} ${Math.Calc[${_count}+1].Precision[0]}: ${args[${Math.Calc[${_count}+1]}]} ${Math.Calc[${_count}+2].Precision[0]}: ${args[${Math.Calc[${_count}+2]}]} ${Math.Calc[${_count}+3].Precision[0]}: ${args[${Math.Calc[${_count}+3]}]}"]
		; _AmountKilled:Insert[0]
		; _AmountKilled:Insert[0]
		; _AmountKilled:Insert[0]
		
		if ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
			AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
		elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[IT-]}
			IncomingText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
		else
			AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}]}]
			
		;echo inserted ${args[${Math.Calc[${_count}+1]}].Right[-3]} // ${AnnounceText.Get[1]} // ${IncomingText.Get[1]}
		_count:Inc
		_count:Inc
		_count:Inc
	}
	; for(_count:Set[1];${_count}<=${IncomingText.Used};_count:Inc)
	; {
		; echo ${IncomingText.Get[${_count}]}
	; }
	; for(_count:Set[1];${_count}<=${AnnounceText.Used};_count:Inc)
	; {
		; echo ${AnnounceText.Get[${_count}]}
	; }
	;echo ${echostr}
	_end:Set[${Math.Calc[${MainArrayCounter}+${_PathLines}]}]
	for(;${MainArrayCounter}<=${_end};MainArrayCounter:Inc)
	{
		call RIMObj.CheckCombat
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			;check for our node and if we are
			if !${_Done}
			{
				; if ${_HighlightOnMouseHover}
					; _Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
				; else
					_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance}"]
				;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
				if ${Actor[Query, ${_Query}](exists)}
				{
					_ID:Set[${Actor[Query, ${_Query}].ID}]
					;echo if ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					if ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<20 && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )
					{
						_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
						if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
						{
							if ${Me.FlyingUsingMount}
								_IWasFlying:Set[TRUE]
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
							if ${Me.FlyingUsingMount}
								call RIMObj.FlyDown
						}
						else
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
						;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
						wait 5
						;_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
						while ${Actor[Query, Name=-\"${args[${_count}]}\" && ID=${_ID} && Distance<=10](exists)}
						{
							; if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
							; {
								; call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								; continue
							; }
							if !${Me.InCombat}
							{
								RI_CMD_PauseCombatBots 1
								wait 5
								Actor[Query, ID=${_ID}]:DoFace
								wait 5
								Actor[Query, ID=${_ID}]:DoTarget
								wait 5
								eq2execute hail
							}
							wait 25
						
							; variable int _counth
							; for(_counth:Set[1];${_counth}<=${args[${Math.Calc[${_count}+2]}]};_counth:Inc)
							; {
								; if ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${Math.Calc[${_count}+3]}]}](exists)}
									; EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${Math.Calc[${_count}+3]}]}]:LeftClick
								; wait 5
							; }
							;unpause bots
							RI_CMD_PauseCombatBots 0
						}
						wait 5
						if ${Trigger}
							_Done:Set[TRUE]
						; if ${Trigger}
						; {
							; _AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							; echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							; Trigger:Set[FALSE]
						; }
						if ${_IWasFlying}
						{
							press -hold ${RI_Var_String_FlyUpKey}
							wait 1
							press -release ${RI_Var_String_FlyUpKey}
							_IWasFlying:Set[FALSE]
						}
						call RIMObj.Move ${_temp} 1 0 FALSE FALSE TRUE FALSE
					}
				}
			}
			_count:Inc
			_count:Inc
		}
		call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1
		_AllQuantitiesMet:Set[TRUE]
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			_count:Inc
			_count:Inc
			;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
			if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
				_AllQuantitiesMet:Set[FALSE]
		}
		; if ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet}
		; {
			; MainArrayCounter:Set[${_end}]
			; echo TimeToEnd
		; }
		if ( ${MainArrayCounter}==${_end} && ${_GoReverseAtLoopOrEnd} ) || ( ${_GoReverseAfterAllQuantitiesMet} && ${_Done} )
		{
			MainArrayCounter:Dec
			for(;${MainArrayCounter}>=${_start};MainArrayCounter:Dec)
			{
				call RIMObj.CheckCombat
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					;check for our node and if we are
					if !${_Done}
					{
						; if ${_HighlightOnMouseHover}
							; _Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
						; else
							_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance}"]

						;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
						if ${Actor[Query, ${_Query}](exists)}
						{
							_ID:Set[${Actor[Query, ${_Query}].ID}]
							;echo if ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							if ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<20 && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]} 
							;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							{
								_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
								if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
								{
									if ${Me.FlyingUsingMount}
										_IWasFlying:Set[TRUE]
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
									if ${Me.FlyingUsingMount}
										call RIMObj.FlyDown
								}
								else
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
								wait 5
								;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								;wait 5
								;_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
								while ${Actor[Query, Name=-\"${args[${_count}]}\" && ID=${_ID} && Distance<=10](exists)}
								{
									if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
									{
										call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
										continue
									}
									if !${Me.InCombat}
									{
										RI_CMD_PauseCombatBots 1
										wait 5
										Actor[Query, ID=${_ID}]:DoFace
										wait 5
										Actor[Query, ID=${_ID}]:DoTarget
										wait 5
										eq2execute hail
										wait 25
									}
									; variable int count
									; for(count:Set[1];${count}<=${args[${Math.Calc[${_count}+2]}]};count:Inc)
									; {
										; if ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${Math.Calc[${_count}+3]}]}](exists)}
											; EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${args[${Math.Calc[${_count}+3]}]}]:LeftClick
										; wait 5
									; }
									;unpause bots
									RI_CMD_PauseCombatBots 0
								}
								wait 5
								if ${Trigger}
									_Done:Set[TRUE]
								;if ${Trigger} 
								;|| ${args[${Math.Calc[${_count}+1]}].Equal[0]}
								; {
									; _AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
									; echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
									; Trigger:Set[FALSE]
								; }
								if ${_IWasFlying}
								{
									press -hold ${RI_Var_String_FlyUpKey}
									wait 1
									press -release ${RI_Var_String_FlyUpKey}
									_IWasFlying:Set[FALSE]
								}
								call RIMObj.Move ${_temp} 1 0 FALSE FALSE TRUE FALSE
							}
						}
					}
					_count:Inc
					_count:Inc
				}
				call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1
				_AllQuantitiesMet:Set[TRUE]
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					_count:Inc
					_count:Inc
					;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
					if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
						_AllQuantitiesMet:Set[FALSE]
				}
			}
			;if !${_Loop}
				MainArrayCounter:Set[${_end}]
		}
		if ${_Loop} && ${MainArrayCounter}==${_end} && !${_Done}
		{
			;echo looping because ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
			MainArrayCounter:Set[${_start}]
		}
	}
	press -release ${RI_Var_String_ForwardKey}
	AnnounceText:Clear
	Trigger:Set[FALSE]
}
function PathKill(int _PathLines, int _Distance, int _Precision, bool _Loop, bool _GoReverseAfterAllQuantitiesMet, bool _GoReverseAtLoopOrEnd, ... args)
{	
	Trigger:Set[FALSE]
	;variable string echostr="int _PathLines=${_PathLines}, int _Distance=${_Distance}, int _Precision=${_Precision}, bool _Loop=${_Loop}, bool _GoReverseAfterAllQuantitiesMet=${_GoReverseAfterAllQuantitiesMet}, bool _GoReverseAtLoopOrEnd=${_GoReverseAtLoopOrEnd}, ... args="
	;string _MobName, string _TriggerText, int _Quantity,
	variable int _start
	variable int _end
	variable int _count
	variable string _Query
	variable int _ID
	variable string _tempName
	variable string _temp
	variable index:int _AmountKilled
	variable bool _AllQuantitiesMet
	variable bool _IWasFlying=FALSE
	variable bool _CheckQuestStep=FALSE
	variable string _QuestStep=""
	AnnounceText:Clear
	IncomingText:Clear
	IncomingText2:Clear
	variable int _countor=0
	_start:Set[${MainArrayCounter}]

	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		;echostr:Concat["${_count}: ${args[${_count}]} ${Math.Calc[${_count}+1].Precision[0]}: ${args[${Math.Calc[${_count}+1]}]} ${Math.Calc[${_count}+2].Precision[0]}: ${args[${Math.Calc[${_count}+2]}]}"]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		
		if ${args[${Math.Calc[${_count}+1]}].NotEqual[0]}
		{
			;echo ${args[${Math.Calc[${_count}+1]}].Left[3]}
			;echo ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
			if ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
				AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
			elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[IT-]}
				IncomingText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
			elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[QS-]}
			{
				_QuestStep:Set[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
				_CheckQuestStep:Set[1]
			}
			else
				AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}]}]
		}
		else
		{
			IncomingText:Insert["You have killed"]
			IncomingText2:Insert["${args[${_count}]}"]
		}
		_count:Inc
		_count:Inc
	}
	; for(_count:Set[1];${_count}<=${AnnounceText.Used};_count:Inc)
	; {
	;	 echo ${AnnounceText.Get[${_count}]}
	; }
	; echo ${echostr}
	_end:Set[${Math.Calc[${MainArrayCounter}+${_PathLines}]}]
	for(;${MainArrayCounter}<=${_end};MainArrayCounter:Inc)
	{
		if ${RI_Var_Bool_BreakPathFunction}
		{
			RI_Var_Bool_BreakPathFunction:Set[0]
			return
		}
		call RIMObj.CheckCombat
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			;check for our node and if we are
			if ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
			{
				if ${args[${_count}].Find[|](exists)}
				{
					_Query:Set["( "]
					for(_countor:Set[1];${_countor}<=${Math.Calc[${args[${_count}].Count[|]}+1]};_countor:Inc)
					{
						if ${_countor}==${Math.Calc[${args[${_count}].Count[|]}+1]}
							_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" ) && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]
						else
							_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" || "]
					}
				}
				else
					_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]
				;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
				if ${Actor[Query, ${_Query}](exists)}
				{
					_ID:Set[${Actor[Query, ${_Query}].ID}]
					;echo ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					if ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<${_Precision} || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )
					{
						_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
						if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
						{
							if ${Me.FlyingUsingMount}
								_IWasFlying:Set[TRUE]
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
							if ${Me.FlyingUsingMount}
								call RIMObj.FlyDown
						}
						else
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
						wait 5
						;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
						;wait 5
						_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
						while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
						{
							if ${RI_Var_Bool_BreakPathFunction}
							{
								RI_Var_Bool_BreakPathFunction:Set[0]
								return
							}
							if ${Me.FlyingUsingMount}
								call RIMObj.FlyDown
							if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
								Actor[Query, ID=${_ID}]:DoTarget
							wait 2
							if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
								call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
							if ${Target.ID}==${Actor[Query, ID=${_ID}].ID} && ( !${Me.TargetLOS} || ${ICantSeeMyTarget} )
							{
								eq2ex target_none
								break
							}
						}
						call RIMObj.CheckCombat
						wait 15
						if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
						{
							_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
							Trigger:Set[FALSE]
						}
						if ${Trigger}
						{
							_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
							Trigger:Set[FALSE]
							wait 1
						}
						if ${_IWasFlying}
						{
							press -hold ${RI_Var_String_FlyUpKey}
							wait 1
							press -release ${RI_Var_String_FlyUpKey}
							_IWasFlying:Set[FALSE]
						}
						call RIMObj.Move ${_temp} 1 0 0 0 1 0 1 1
					}
				}
				if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
				{
					_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
					;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
					echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
					Trigger:Set[FALSE]
				}
				if ${Trigger}
				{
					_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
					;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
					echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
					Trigger:Set[FALSE]
				}
			}
			_count:Inc
			_count:Inc
		}
		call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
		_AllQuantitiesMet:Set[TRUE]
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			_count:Inc
			_count:Inc
			;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
			if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
				_AllQuantitiesMet:Set[FALSE]
		}
		; if ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet}
		; {
			; MainArrayCounter:Set[${_end}]
			; echo TimeToEnd
		; }
		if ( ${MainArrayCounter}==${_end} && ${_GoReverseAtLoopOrEnd} ) || ( ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet} )
		{
			MainArrayCounter:Dec
			for(;${MainArrayCounter}>=${_start};MainArrayCounter:Dec)
			{
				if ${RI_Var_Bool_BreakPathFunction}
				{
					RI_Var_Bool_BreakPathFunction:Set[0]
					return
				}
				call RIMObj.CheckCombat
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					;check for our node and if we are
					if ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
					{
						if ${args[${_count}].Find[|](exists)}
						{
							_Query:Set["( "]
							for(_countor:Set[1];${_countor}<=${Math.Calc[${args[${_count}].Count[|]}+1]};_countor:Inc)
							{
								if ${_countor}==${Math.Calc[${args[${_count}].Count[|]}+1]}
									_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" ) && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]
								else
									_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" || "]
							}
						}
						else
							_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]

						;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
						if ${Actor[Query, ${_Query}](exists)}
						{
							_ID:Set[${Actor[Query, ${_Query}].ID}]
							;echo ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							if ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							{
								_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
								if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
								{
									if ${Me.FlyingUsingMount}
										_IWasFlying:Set[TRUE]
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
									if ${Me.FlyingUsingMount}
										call RIMObj.FlyDown
								}
								else
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
								;wait 5
								;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								wait 5
								_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
								while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ( ${Actor[Query, ID=${_ID}].HighlightOnMouseHover} || !${_HighlightOnMouseHover} ) && ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
								{
									if ${RI_Var_Bool_BreakPathFunction}
									{
										RI_Var_Bool_BreakPathFunction:Set[0]
										return
									}
									if ${Me.FlyingUsingMount}
										call RIMObj.FlyDown
									if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
										Actor[Query, ID=${_ID}]:DoTarget
									wait 2
									if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
										call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
									if ${Target.ID}==${Actor[Query, ID=${_ID}].ID} && ( !${Me.TargetLOS} || ${ICantSeeMyTarget} )
									{
										eq2ex target_none
										break
									}
								}
								call RIMObj.CheckCombat
								wait 15
								if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
								{
									_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
									;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
									echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
									Trigger:Set[FALSE]
								}
								if ${Trigger} 
								;|| ${args[${Math.Calc[${_count}+1]}].Equal[0]}
								{
									_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
									;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
									echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
									Trigger:Set[FALSE]
									wait 1
								}
								if ${_IWasFlying}
								{
									press -hold ${RI_Var_String_FlyUpKey}
									wait 1
									press -release ${RI_Var_String_FlyUpKey}
									_IWasFlying:Set[FALSE]
								}
								call RIMObj.Move ${_temp} 1 0 0 0 1 0 1 1
							}
						}
						if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
						{
							_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
							Trigger:Set[FALSE]
						}
						if ${Trigger}
						{
							_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
							Trigger:Set[FALSE]
						}
					}
					_count:Inc
					_count:Inc
				}
				call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
				_AllQuantitiesMet:Set[TRUE]
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					_count:Inc
					_count:Inc
					;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
					if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
						_AllQuantitiesMet:Set[FALSE]
				}
			}
			;if !${_Loop}
				MainArrayCounter:Set[${_end}]
		}
		if ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
		{
			;echo looping because ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
			MainArrayCounter:Set[${_start}]
		}
	}
	press -release ${RI_Var_String_ForwardKey}
	AnnounceText:Clear
	Trigger:Set[FALSE]
}
function PathApplyVerb(int _PathLines, int _Distance, int _Precision, bool _Loop, bool _GoReverseAfterAllQuantitiesMet, bool _GoReverseAtLoopOrEnd, ... args)
{	
	Trigger:Set[FALSE]
	;variable string echostr="int _PathLines=${_PathLines}, int _Distance=${_Distance}, int _Precision=${_Precision}, bool _Loop=${_Loop}, bool _GoReverseAfterAllQuantitiesMet=${_GoReverseAfterAllQuantitiesMet}, bool _GoReverseAtLoopOrEnd=${_GoReverseAtLoopOrEnd}, ... args="
	;string _ActorName, string _TriggerText, string _Verb, int _Quantity,
	variable int _start
	variable int _end
	variable int _count
	variable string _Query
	variable int _ID
	variable string _tempName
	variable string _temp
	variable index:int _AmountKilled
	variable bool _AllQuantitiesMet
	variable bool _IWasFlying=FALSE
	
	AnnounceText:Clear
	IncomingText:Clear
	IncomingText2:Clear
	_start:Set[${MainArrayCounter}]

	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		;echostr:Concat["${_count}: ${args[${_count}]} ${Math.Calc[${_count}+1].Precision[0]}: ${args[${Math.Calc[${_count}+1]}]} ${Math.Calc[${_count}+2].Precision[0]}: ${args[${Math.Calc[${_count}+2]}]} ${Math.Calc[${_count}+3].Precision[0]}: ${args[${Math.Calc[${_count}+3]}]}"]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		
		if ${args[${Math.Calc[${_count}+1]}].NotEqual[0]}
		{
			;echo ${args[${Math.Calc[${_count}+1]}].Left[3]}
			;echo ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
			if ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
				AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
			elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[IT-]}
				IncomingText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
			else
				AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}]}]
		}
		else
		{
			IncomingText:Insert["You have killed"]
			IncomingText2:Insert["${args[${_count}]}"]
		}
		_count:Inc
		_count:Inc
		_count:Inc
	}
	; for(_count:Set[1];${_count}<=${IncomingText.Used};_count:Inc)
	; {
		; echo ${IncomingText.Get[${_count}]}
	; }
	; for(_count:Set[1];${_count}<=${AnnounceText.Used};_count:Inc)
	; {
		; echo ${AnnounceText.Get[${_count}]}
	; }
	; echo ${echostr}
	_end:Set[${Math.Calc[${MainArrayCounter}+${_PathLines}]}]
	for(;${MainArrayCounter}<=${_end};MainArrayCounter:Inc)
	{
		call RIMObj.CheckCombat
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			;check for our node and if we are
			if ${_AmountKilled.Get[${Math.Calc[${_count}+3]}]}<${args[${Math.Calc[${_count}+3]}]}
			{
				; if ${_HighlightOnMouseHover}
					; _Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
				; else
					_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance}"]
				;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
				if ${Actor[Query, ${_Query}](exists)}
				{
					_ID:Set[${Actor[Query, ${_Query}].ID}]
					;echo ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					if ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<${_Precision} || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )
					{
						_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
						if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
						{
							if ${Me.FlyingUsingMount}
								_IWasFlying:Set[TRUE]
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
							if ${Me.FlyingUsingMount}
								call RIMObj.FlyDown
						}
						else
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
						wait 5
						;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
						;wait 5
						_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
						while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ${_AmountKilled.Get[${Math.Calc[${_count}+3]}]}<${args[${Math.Calc[${_count}+3]}]}
						{
							if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
								Actor[Query, ID=${_ID}]:DoTarget
							wait 2
							if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
								call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
							;echo eq2ex apply_verb ${_ID} "${args[${Math.Calc[${_count}+2]}]}"
							eq2ex apply_verb ${_ID} "${args[${Math.Calc[${_count}+2]}]}"
							wait 5
						}
						call RIMObj.CheckCombat
						wait 15
						if ${Trigger}
						{
							_AmountKilled.Get[${Math.Calc[${_count}+3]}]:Inc
							;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+3]}]} of ${_tempName}
							echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
							Trigger:Set[FALSE]
						}
						if ${_IWasFlying}
						{
							press -hold ${RI_Var_String_FlyUpKey}
							wait 1
							press -release ${RI_Var_String_FlyUpKey}
							_IWasFlying:Set[FALSE]
						}
						call RIMObj.Move ${_temp} 1 0 0 0 1 0 1 1
					}
				}
			}
			_count:Inc
			_count:Inc
			_count:Inc
		}
		call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
		_AllQuantitiesMet:Set[TRUE]
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			_count:Inc
			_count:Inc
			_count:Inc
			;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
			if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
				_AllQuantitiesMet:Set[FALSE]
		}
		; if ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet}
		; {
			; MainArrayCounter:Set[${_end}]
			; echo TimeToEnd
		; }
		if ( ${MainArrayCounter}==${_end} && ${_GoReverseAtLoopOrEnd} ) || ( ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet} )
		{
			MainArrayCounter:Dec
			for(;${MainArrayCounter}>=${_start};MainArrayCounter:Dec)
			{
				call RIMObj.CheckCombat
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					;check for our node and if we are
					if ${_AmountKilled.Get[${Math.Calc[${_count}+3]}]}<${args[${Math.Calc[${_count}+3]}]}
					{
						; if ${_HighlightOnMouseHover}
							; _Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
						; else
							_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance}"]

						;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
						if ${Actor[Query, ${_Query}](exists)}
						{
							_ID:Set[${Actor[Query, ${_Query}].ID}]
							;echo ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							if ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							{
								_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
								if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
								{
									if ${Me.FlyingUsingMount}
										_IWasFlying:Set[TRUE]
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
									if ${Me.FlyingUsingMount}
										call RIMObj.FlyDown
								}
								else
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
								;wait 5
								;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								wait 5
								_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
								while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ( ${Actor[Query, ID=${_ID}].HighlightOnMouseHover} || !${_HighlightOnMouseHover} ) && ${_AmountKilled.Get[${Math.Calc[${_count}+3]}]}<${args[${Math.Calc[${_count}+3]}]}
								{
									if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
										Actor[Query, ID=${_ID}]:DoTarget
									wait 2
									if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
										call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
									eq2ex apply_verb ${_ID} "${args[${Math.Calc[${_count}+2]}]}"
									wait 5
								}
								call RIMObj.CheckCombat
								wait 15
								if ${Trigger} 
								;|| ${args[${Math.Calc[${_count}+1]}].Equal[0]}
								{
									_AmountKilled.Get[${Math.Calc[${_count}+3]}]:Inc
									;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
									echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
									Trigger:Set[FALSE]
								}
								if ${_IWasFlying}
								{
									press -hold ${RI_Var_String_FlyUpKey}
									wait 1
									press -release ${RI_Var_String_FlyUpKey}
									_IWasFlying:Set[FALSE]
								}
								call RIMObj.Move ${_temp} 1 0 0 0 1 0 1 1
							}
						}
					}
					_count:Inc
					_count:Inc
					_count:Inc
				}
				call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
				_AllQuantitiesMet:Set[TRUE]
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					_count:Inc
					_count:Inc
					_count:Inc
					;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
					if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
						_AllQuantitiesMet:Set[FALSE]
				}
			}
			;if !${_Loop}
				MainArrayCounter:Set[${_end}]
		}
		if ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
		{
			;echo looping because ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
			MainArrayCounter:Set[${_start}]
		}
	}
	press -release ${RI_Var_String_ForwardKey}
	AnnounceText:Clear
	Trigger:Set[FALSE]
}
function PathKillClick(int _PathLines, int _Distance, int _Precision, bool _Loop, bool _GoReverseAfterAllQuantitiesMet, bool _GoReverseAtLoopOrEnd, ... args)
{	
	Trigger:Set[FALSE]
	variable string echostr="int _PathLines=${_PathLines}, int _Distance=${_Distance}, int _Precision=${_Precision}, bool _Loop=${_Loop}, bool _GoReverseAfterAllQuantitiesMet=${_GoReverseAfterAllQuantitiesMet}, bool _GoReverseAtLoopOrEnd=${_GoReverseAtLoopOrEnd}, ... args="
	;string _MobName, string _TriggerText, int _Quantity, string _ActorToClick
	variable int _start
	variable int _end
	variable int _count
	variable int _countor
	variable string _Query
	variable int _ID
	variable string _tempName
	variable string _temp
	variable index:int _AmountKilled
	variable bool _AllQuantitiesMet
	variable bool _IWasFlying=FALSE
	variable string _QuestStep=""
	variable bool _CheckQuestStep=0
	AnnounceText:Clear
	IncomingText:Clear
	IncomingText2:Clear
	_start:Set[${MainArrayCounter}]

	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		;echostr:Concat["${_count}: ${args[${_count}]} ${Math.Calc[${_count}+1].Precision[0]}: ${args[${Math.Calc[${_count}+1]}]} ${Math.Calc[${_count}+2].Precision[0]}: ${args[${Math.Calc[${_count}+2]}]}"]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		
		if ${args[${Math.Calc[${_count}+1]}].NotEqual[0]}
		{
			;echo ${args[${Math.Calc[${_count}+1]}].Left[3]}
			;echo ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
			if ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
				AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
			elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[IT-]}
				IncomingText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
			elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[QS-]}
			{
				_QuestStep:Set[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
				_CheckQuestStep:Set[1]
			}
			else
				AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}]}]
		}
		else
		{
			IncomingText:Insert["You have killed"]
			IncomingText2:Insert["${args[${_count}]}"]
		}
		_count:Inc
		_count:Inc
		_count:Inc
	}
	for(_count:Set[1];${_count}<=${AnnounceText.Used};_count:Inc)
	{
		;echo ${AnnounceText.Get[${_count}]}
	}
	;echo ${echostr}
	;echo ${_CheckQuestStep} // ${_QuestStep}
	_end:Set[${Math.Calc[${MainArrayCounter}+${_PathLines}]}]
	for(;${MainArrayCounter}<=${_end};MainArrayCounter:Inc)
	{
		call RIMObj.CheckCombat
		;echo outside for
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			;echo in for
			;check for our node and if we are
			echo ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
			if ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
			{
				;echo inside if
				if ${args[${_count}].Find[|](exists)}
				{
					_Query:Set["( "]
					for(_countor:Set[1];${_countor}<=${Math.Calc[${args[${_count}].Count[|]}+1]};_countor:Inc)
					{
						if ${_countor}==${Math.Calc[${args[${_count}].Count[|]}+1]}
							_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" ) && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]
						else
							_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" || "]
					}
				}
				else
					_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]
				;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
				if ${Actor[Query, ${_Query}](exists)}
				{
					_ID:Set[${Actor[Query, ${_Query}].ID}]
					echo ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					if ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<${_Precision} || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )
					{
						_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
						if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
						{
							if ${Me.FlyingUsingMount}
								_IWasFlying:Set[TRUE]
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
							if ${Me.FlyingUsingMount}
								call RIMObj.FlyDown
						}
						else
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
						wait 5
						;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
						;wait 5
						_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
						while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]} && ${Actor[Query, ID=${_ID} && IsDead=FALSE].Overlay.NotEqual[dead]}
						{
							if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
								Actor[Query, ID=${_ID}]:DoTarget
							wait 2
							if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
								call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
						}
						wait 50
						if ${args[${Math.Calc[${_count}+3]}].Find[TF-](exists)}
							_ID:Set[${Actor[Query, TintFlags=${args[${Math.Calc[${_count}+3]}].Right[-3]}].ID}]
						elseif ${args[${Math.Calc[${_count}+3]}].Find[IN-](exists)}
							_ID:Set[${Actor[Query, Name=-"${args[${Math.Calc[${_count}+3]}].Right[-3]}" && Interactable=TRUE].ID}]
						else
							_ID:Set[${Actor[Query, Name=-"${args[${Math.Calc[${_count}+3]}]}"].ID}]

						while ${Actor[id,${_ID}](exists)} && ${_ID}>0 && ( !${args[${Math.Calc[${_count}+3]}].Find[IN-](exists)} || ${Actor[id,${_ID}].Interactable} )
						{
							call RIMObj.CheckCombat
							if ${Actor[id,${_ID}].Distance}>4
								call RIMObj.Move ${Actor[id,${_ID}].X} ${Math.Calc[${Actor[id,${_ID}].Y}+1]} ${Actor[id,${_ID}].Z} 4 0 0 0 1 0 1 1
							Actor[id,${_ID}]:DoTarget
							wait 2
							Actor[id,${_ID}]:DoubleClick
							wait 5
							
						}
						wait 15
						if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
						{
							_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
							Trigger:Set[FALSE]
						}
						if ${Trigger}
						{
							_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
							Trigger:Set[FALSE]
						}
						if ${_IWasFlying}
						{
							press -hold ${RI_Var_String_FlyUpKey}
							wait 1
							press -release ${RI_Var_String_FlyUpKey}
							_IWasFlying:Set[FALSE]
						}
						call RIMObj.Move ${_temp} 1 0 0 0 1 0 1 1
					}
				}
				if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
				{
					_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
					;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
					echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
					Trigger:Set[FALSE]
				}
				if ${Trigger}
				{
					_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
					;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
					echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
					Trigger:Set[FALSE]
				}
			}
			_count:Inc
			_count:Inc
			_count:Inc
		}
		;echo after for
		call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
		_AllQuantitiesMet:Set[TRUE]
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			_count:Inc
			_count:Inc
			;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
			if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
				_AllQuantitiesMet:Set[FALSE]
			_count:Inc
		}
		; if ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet}
		; {
			; MainArrayCounter:Set[${_end}]
			; echo TimeToEnd
		; }
		if ( ${MainArrayCounter}==${_end} && ${_GoReverseAtLoopOrEnd} ) || ( ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet} )
		{
			MainArrayCounter:Dec
			for(;${MainArrayCounter}>=${_start};MainArrayCounter:Dec)
			{
				call RIMObj.CheckCombat
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					;check for our node and if we are
					if ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
					{
						if ${args[${_count}].Find[|](exists)}
						{
							_Query:Set["( "]
							for(_countor:Set[1];${_countor}<=${Math.Calc[${args[${_count}].Count[|]}+1]};_countor:Inc)
							{
								if ${_countor}==${Math.Calc[${args[${_count}].Count[|]}+1]}
									_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" ) && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]
								else
									_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" || "]
							}
						}
						else
							_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]

						;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
						if ${Actor[Query, ${_Query}](exists)}
						{
							_ID:Set[${Actor[Query, ${_Query}].ID}]
							;echo ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							if ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							{
								_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
								if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
								{
									if ${Me.FlyingUsingMount}
										_IWasFlying:Set[TRUE]
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
									if ${Me.FlyingUsingMount}
										call RIMObj.FlyDown
								}
								else
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
								;wait 5
								;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								wait 5
								_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
								while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ${Actor[Query, ID=${_ID} && IsDead=FALSE].Overlay.NotEqual[dead]} && ( ${Actor[Query, ID=${_ID}].HighlightOnMouseHover} || !${_HighlightOnMouseHover} ) && ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
								{
									if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
										Actor[Query, ID=${_ID}]:DoTarget
									wait 2
									if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
										call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								}
								wait 50
								if ${args[${Math.Calc[${_count}+3]}].Find[TF-](exists)}
									_ID:Set[${Actor[Query, TintFlags=${args[${Math.Calc[${_count}+3]}].Right[-3]}].ID}]
								elseif ${args[${Math.Calc[${_count}+3]}].Find[IN-](exists)}
									_ID:Set[${Actor[Query, Name=-"${args[${Math.Calc[${_count}+3]}].Right[-3]}" && Interactable=TRUE].ID}]
								else
									_ID:Set[${Actor[Query, Name=-"${args[${Math.Calc[${_count}+3]}]}"].ID}]

								while ${Actor[id,${_ID}](exists)} && ${_ID}>0 && ( !${args[${Math.Calc[${_count}+3]}].Find[IN-](exists)} || ${Actor[id,${_ID}].Interactable} )
								{
									call RIMObj.CheckCombat
									if ${Actor[id,${_ID}].Distance}>4
										call RIMObj.Move ${Actor[id,${_ID}].X} ${Math.Calc[${Actor[id,${_ID}].Y}+1]} ${Actor[id,${_ID}].Z} 4 0 0 0 1 0 1 1
									Actor[id,${_ID}]:DoTarget
									wait 2
									Actor[id,${_ID}]:DoubleClick
									wait 5
									
								}
								wait 15
								if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
								{
									_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
									;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
									echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
									Trigger:Set[FALSE]
								}
								if ${Trigger} 
								;|| ${args[${Math.Calc[${_count}+1]}].Equal[0]}
								{
									_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
									;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
									echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
									Trigger:Set[FALSE]
								}
								if ${_IWasFlying}
								{
									press -hold ${RI_Var_String_FlyUpKey}
									wait 1
									press -release ${RI_Var_String_FlyUpKey}
									_IWasFlying:Set[FALSE]
								}
								call RIMObj.Move ${_temp} 1 0 0 0 1 0 1 1
							}
						}
						if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
						{
							_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
							Trigger:Set[FALSE]
						}
						if ${Trigger}
						{
							_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
							Trigger:Set[FALSE]
						}
					}
					_count:Inc
					_count:Inc
					_count:Inc
				}
				call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
				_AllQuantitiesMet:Set[TRUE]
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					_count:Inc
					_count:Inc
					;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
					if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
						_AllQuantitiesMet:Set[FALSE]
					_count:Inc
				}
			}
			;if !${_Loop}
				MainArrayCounter:Set[${_end}]
		}
		if ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
		{
			;echo looping because ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
			MainArrayCounter:Set[${_start}]
		}
	}
	press -release ${RI_Var_String_ForwardKey}
	AnnounceText:Clear
	Trigger:Set[FALSE]
}

function PathItemHail(int _PathLines, int _Distance, int _Precision, bool _Loop, bool _GoReverseAfterAllQuantitiesMet, bool _GoReverseAtLoopOrEnd, ... args)
{	
	Trigger:Set[FALSE]
	;variable string echostr="int _PathLines=${_PathLines}, int _Distance=${_Distance}, int _Precision=${_Precision}, bool _Loop=${_Loop}, bool _GoReverseAfterAllQuantitiesMet=${_GoReverseAfterAllQuantitiesMet}, bool _GoReverseAtLoopOrEnd=${_GoReverseAtLoopOrEnd}, ... args="
	;string _MobName, string _TriggerText, int _Quantity, string _HailOption, string _ItemName
	variable int _start
	variable int _end
	variable int _count
	variable string _Query
	variable int _ID
	variable string _tempName
	variable string _temp
	variable index:int _AmountKilled
	variable bool _AllQuantitiesMet
	variable bool _IWasFlying=FALSE
	variable bool _ItemCast=FALSE
	variable int count
	variable string _tempbtntxt
	AnnounceText:Clear
	IncomingText:Clear
	IncomingText2:Clear
	_start:Set[${MainArrayCounter}]

	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		;echostr:Concat["${_count}-_MobName: ${args[${_count}]} ${Math.Calc[${_count}+1].Precision[0]}-_TriggerText: ${args[${Math.Calc[${_count}+1]}]} ${Math.Calc[${_count}+2].Precision[0]}-_Quantity: ${args[${Math.Calc[${_count}+2]}]} ${Math.Calc[${_count}+3].Precision[0]}-_HealthTrigger: ${args[${Math.Calc[${_count}+3]}]} ${Math.Calc[${_count}+4].Precision[0]}-_ItemName: ${args[${Math.Calc[${_count}+4]}]}"]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		
		if ${args[${Math.Calc[${_count}+1]}].NotEqual[0]}
		{
			;echo ${args[${Math.Calc[${_count}+1]}].Left[3]}
			;echo ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
			if ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
				AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
			elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[IT-]}
				IncomingText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
			else
				AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}]}]
		}
		else
		{
			IncomingText:Insert["You have killed"]
			IncomingText2:Insert["${args[${_count}]}"]
		}
		_count:Inc
		_count:Inc
		_count:Inc
		_count:Inc
	}
	; for(_count:Set[1];${_count}<=${AnnounceText.Used};_count:Inc)
	; {
		; echo ${AnnounceText.Get[${_count}]}
	; }
	; echo ${echostr}
	_end:Set[${Math.Calc[${MainArrayCounter}+${_PathLines}]}]
	for(;${MainArrayCounter}<=${_end};MainArrayCounter:Inc)
	{
		call RIMObj.CheckCombat
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			;check for our node and if we are
			if ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
			{
				; if ${_HighlightOnMouseHover}
					; _Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
				; else
					_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]
				;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
				if ${Actor[Query, ${_Query}](exists)}
				{
					;echo query exists
					_ID:Set[${Actor[Query, ${_Query}].ID}]
					;echo ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					if ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<${_Precision} || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )
					{
						_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
						if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
						{
							if ${Me.FlyingUsingMount}
								_IWasFlying:Set[TRUE]
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
							if ${Me.FlyingUsingMount}
								call RIMObj.FlyDown
						}
						else
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
						;wait 5
						;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
						wait 20
						_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
						while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
						{
							;echo start of while loop ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} // ${Actor[Query, ID=${_ID} && IsDead=FALSE]} // ${_ID}
							if !${_ItemCast}
								relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 1
							if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
								Actor[Query, ID=${_ID}]:DoTarget
							if !${_ItemCast}
								eq2ex pet backoff
							wait 5
							if !${_ItemCast}
								eq2ex pet backoff
							;echo ${Target.Health}<=${args[${Math.Calc[${_count}+3]}]} && !${_ItemCast} && ${Me.TargetLOS}
							if ${Target.Health}>0 && !${_ItemCast} && ${Me.TargetLOS}
							{
								eq2ex pet backoff
								relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 1
								relay "${RI_Var_String_RelayGroup}" eq2ex cancel_spellcast
								wait 2
								eq2ex pet backoff
								relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"]:Use
								wait 5
								eq2ex pet backoff
								relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"]:Use
								wait 5 ${Me.CastingSpell}
								wait 50 !${Me.CastingSpell}
								wait 50
								;unpause bots
								;relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 0
								_ItemCast:Set[TRUE]
							}
							if ${_ItemCast}
							{
								if ${Actor[Query, ID=${_ID}].Distance}>7
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 7 0 0 0 1 0 1 1
								wait 10
								relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
								;wait 5
								;change camera
								relay ${RI_Var_String_RelayGroup} -noredirect Press -hold ${RI_Var_String_LookDownKey}
								wait 15
								;change camera
								relay ${RI_Var_String_RelayGroup} -noredirect Press -release ${RI_Var_String_LookDownKey}
								relay ${RI_Var_String_RelayGroup} -noredirect Press -hold ${RI_Var_String_LookUpKey}
								wait 3
								relay ${RI_Var_String_RelayGroup} -noredirect Press -release ${RI_Var_String_LookUpKey}
								
								relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoFace
								relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoFace
								wait 5
								;scroll the mouse wheel
								relay ${RI_Var_String_RelayGroup} -noredirect MouseWheel -10000
								relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoTarget
								relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoTarget
								wait 5
								relay ${RI_Var_String_RelayGroup} -noredirect eq2execute hail
								wait 5
								for(count:Set[1];${count}<=${args[${Math.Calc[${_count}+3]}]};count:Inc)
								{
									_tempbtntxt:Set["${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[${_ResponseNumber}].GetProperty[LocalText]}"]
									if ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1](exists)}
										relay ${RI_Var_String_RelayGroup} -noredirect EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
									wait 5
									wait 20 ( ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1].GetProperty[LocalText].NotEqual["${_tempbtntxt}"]} || !${EQ2UIPage[ProxyActor,Conversation].IsVisible} )
								}
								;unpause bots
								relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 0
							}
							else
							{
								if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
							}
							;echo end of while loop
						}
						_ItemCast:Set[FALSE]
						call RIMObj.CheckCombat
						wait 15
						if ${Trigger} || ( ${args[${Math.Calc[${_count}+1]}].Equal[*ITEMGONE*]} && !${Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"](exists)} )
						{
							_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
							Trigger:Set[FALSE]
						}
						if ${_IWasFlying}
						{
							press -hold ${RI_Var_String_FlyUpKey}
							wait 1
							press -release ${RI_Var_String_FlyUpKey}
							_IWasFlying:Set[FALSE]
						}
						call RIMObj.Move ${_temp} 1 0 0 0 1 0 1 1
					}
				}
			}
			_count:Inc
			_count:Inc
			_count:Inc
			_count:Inc
		}
		call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
		_AllQuantitiesMet:Set[TRUE]
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			_count:Inc
			_count:Inc
			;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
			if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
				_AllQuantitiesMet:Set[FALSE]
			_count:Inc
			_count:Inc
		}
		; if ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet}
		; {
			; MainArrayCounter:Set[${_end}]
			; echo TimeToEnd
		; }
		if ( ${MainArrayCounter}==${_end} && ${_GoReverseAtLoopOrEnd} ) || ( ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet} )
		{
			MainArrayCounter:Dec
			for(;${MainArrayCounter}>=${_start};MainArrayCounter:Dec)
			{
				call RIMObj.CheckCombat
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					;check for our node and if we are
					if ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
					{
						; if ${_HighlightOnMouseHover}
							; _Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
						; else
							_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]

						;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
						if ${Actor[Query, ${_Query}](exists)}
						{
							_ID:Set[${Actor[Query, ${_Query}].ID}]
							;echo ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							if ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							{
								_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
								if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
								{
									if ${Me.FlyingUsingMount}
										_IWasFlying:Set[TRUE]
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
									if ${Me.FlyingUsingMount}
										call RIMObj.FlyDown
								}
								else
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
								;wait 5
								;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								wait 20
								_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
								while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
								{
									;echo start of while loop ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} // ${Actor[Query, ID=${_ID} && IsDead=FALSE]} // ${_ID}
									if !${_ItemCast}
										relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 1
									if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
										Actor[Query, ID=${_ID}]:DoTarget
									if !${_ItemCast}
										eq2ex pet backoff
									wait 5
									if !${_ItemCast}
										eq2ex pet backoff
									;echo ${Target.Health}<=${args[${Math.Calc[${_count}+3]}]} && !${_ItemCast} && ${Me.TargetLOS}
									if ${Target.Health}>0 && !${_ItemCast} && ${Me.TargetLOS}
									{
										eq2ex pet backoff
										relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 1
										relay "${RI_Var_String_RelayGroup}" eq2ex cancel_spellcast
										wait 2
										eq2ex pet backoff
										relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"]:Use
										wait 5
										eq2ex pet backoff
										relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"]:Use
										wait 5 ${Me.CastingSpell}
										wait 50 !${Me.CastingSpell}
										wait 50
										;unpause bots
										;relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 0
										_ItemCast:Set[TRUE]
									}
									if ${_ItemCast}
									{
										if ${Actor[Query, ID=${_ID}].Distance}>7
											call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 7 0 0 0 1 0 1 1
										wait 10
										relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
										;wait 5
										;change camera
										relay ${RI_Var_String_RelayGroup} -noredirect Press -hold ${RI_Var_String_LookDownKey}
										wait 15
										;change camera
										relay ${RI_Var_String_RelayGroup} -noredirect Press -release ${RI_Var_String_LookDownKey}
										relay ${RI_Var_String_RelayGroup} -noredirect Press -hold ${RI_Var_String_LookUpKey}
										wait 3
										relay ${RI_Var_String_RelayGroup} -noredirect Press -release ${RI_Var_String_LookUpKey}
										
										relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoFace
										relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoFace
										wait 5
										;scroll the mouse wheel
										relay ${RI_Var_String_RelayGroup} -noredirect MouseWheel -10000
										relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoTarget
										relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoTarget
										wait 5
										relay ${RI_Var_String_RelayGroup} -noredirect eq2execute hail
										wait 5
										for(count:Set[1];${count}<=${args[${Math.Calc[${_count}+3]}]};count:Inc)
										{
											_tempbtntxt:Set["${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[button,${_ResponseNumber}].GetProperty[LocalText]}"]
											if ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1](exists)}
												relay ${RI_Var_String_RelayGroup} -noredirect EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
											wait 5
											wait 20 ( ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1].GetProperty[LocalText].NotEqual["${_tempbtntxt}"]} || !${EQ2UIPage[ProxyActor,Conversation].IsVisible} )
										}
										;unpause bots
										relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 0
									}
									else
									{
										if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
											call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
									}
									;echo end of while loop
								}
								_ItemCast:Set[FALSE]
								call RIMObj.CheckCombat
								wait 15
								if ${Trigger} || ( ${args[${Math.Calc[${_count}+1]}].Equal[*ITEMGONE*]} && !${Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"](exists)} )
								;|| ${args[${Math.Calc[${_count}+1]}].Equal[0]}
								{
									_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
									;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
									echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
									Trigger:Set[FALSE]
								}
								if ${_IWasFlying}
								{
									press -hold ${RI_Var_String_FlyUpKey}
									wait 1
									press -release ${RI_Var_String_FlyUpKey}
									_IWasFlying:Set[FALSE]
								}
								call RIMObj.Move ${_temp} 1 0 0 0 1 0 1 1
							}
						}
					}
					_count:Inc
					_count:Inc
					_count:Inc
					_count:Inc
				}
				call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
				_AllQuantitiesMet:Set[TRUE]
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					_count:Inc
					_count:Inc
					;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
					if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
						_AllQuantitiesMet:Set[FALSE]
					_count:Inc
					_count:Inc
				}
			}
			;if !${_Loop}
				MainArrayCounter:Set[${_end}]
		}
		if ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
		{
			;echo looping because ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
			MainArrayCounter:Set[${_start}]
		}
	}
	press -release ${RI_Var_String_ForwardKey}
	AnnounceText:Clear
	Trigger:Set[FALSE]
}
function PathItemKillApplyVerb(int _PathLines, int _Distance, int _Precision, bool _Loop, bool _GoReverseAfterAllQuantitiesMet, bool _GoReverseAtLoopOrEnd, ... args)
{	
	Trigger:Set[FALSE]
	;variable string echostr="int _PathLines=${_PathLines}, int _Distance=${_Distance}, int _Precision=${_Precision}, bool _Loop=${_Loop}, bool _GoReverseAfterAllQuantitiesMet=${_GoReverseAfterAllQuantitiesMet}, bool _GoReverseAtLoopOrEnd=${_GoReverseAtLoopOrEnd}, ... args="
	;string _MobName, string _TriggerText, int _Quantity, int _HealthTrigger, string _ItemName, string _Verb
	variable int _start
	variable int _end
	variable int _count
	variable string _Query
	variable int _ID
	variable string _tempName
	variable string _temp
	variable index:int _AmountKilled
	variable bool _AllQuantitiesMet
	variable bool _IWasFlying=FALSE
	variable bool _ItemCast=FALSE
	variable bool _CheckQuestStep=FALSE
	variable string _QuestStep=""
	AnnounceText:Clear
	IncomingText:Clear
	IncomingText2:Clear
	_start:Set[${MainArrayCounter}]

	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		;echostr:Concat["${_count}-_MobName: ${args[${_count}]} ${Math.Calc[${_count}+1].Precision[0]}-_TriggerText: ${args[${Math.Calc[${_count}+1]}]} ${Math.Calc[${_count}+2].Precision[0]}-_Quantity: ${args[${Math.Calc[${_count}+2]}]} ${Math.Calc[${_count}+3].Precision[0]}-_HealthTrigger: ${args[${Math.Calc[${_count}+3]}]} ${Math.Calc[${_count}+4].Precision[0]}-_ItemName: ${args[${Math.Calc[${_count}+4]}]}"]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		
		if ${args[${Math.Calc[${_count}+1]}].NotEqual[0]}
		{
			;echo ${args[${Math.Calc[${_count}+1]}].Left[3]}
			;echo ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
			if ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
				AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
			elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[IT-]}
				IncomingText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
			elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[QS-]}
			{
				_QuestStep:Set[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
				_CheckQuestStep:Set[1]
			}
			else
				AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}]}]
		}
		else
		{
			IncomingText:Insert["You have killed"]
			IncomingText2:Insert["${args[${_count}]}"]
		}
		_count:Inc
		_count:Inc
		_count:Inc
		_count:Inc
		_count:Inc
	}
	; for(_count:Set[1];${_count}<=${AnnounceText.Used};_count:Inc)
	; {
		; echo ${AnnounceText.Get[${_count}]}
	; }
	; echo ${echostr}
	_end:Set[${Math.Calc[${MainArrayCounter}+${_PathLines}]}]
	for(;${MainArrayCounter}<=${_end};MainArrayCounter:Inc)
	{
		call RIMObj.CheckCombat
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			;check for our node and if we are
			if ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
			{
				; if ${_HighlightOnMouseHover}
					; _Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
				; else
					_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]
				;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
				if ${Actor[Query, ${_Query}](exists)}
				{
					;echo query exists
					_ID:Set[${Actor[Query, ${_Query}].ID}]
					;echo ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					if ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<${_Precision} || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )
					{
						_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
						if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
						{
							if ${Me.FlyingUsingMount}
								_IWasFlying:Set[TRUE]
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
							if ${Me.FlyingUsingMount}
								call RIMObj.FlyDown
						}
						else
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
						;wait 5
						;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
						wait 20
						_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
						while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
						{
							;echo start of while loop ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} // ${Actor[Query, ID=${_ID} && IsDead=FALSE]} // ${_ID}
							if ${args[${Math.Calc[${_count}+3]}]}==100 && !${_ItemCast}
								relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 1
							if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
								Actor[Query, ID=${_ID}]:DoTarget
							if ${args[${Math.Calc[${_count}+3]}]}==100 && !${_ItemCast}
								eq2ex pet backoff
							wait 5
							if ${args[${Math.Calc[${_count}+3]}]}==100 && !${_ItemCast}
								eq2ex pet backoff
							;echo ${Target.Health}<=${args[${Math.Calc[${_count}+3]}]} && !${_ItemCast} && ${Me.TargetLOS}
							if ${Target.Health}>0 && ${Target.Health}<=${args[${Math.Calc[${_count}+3]}]} && !${_ItemCast} && ${Me.TargetLOS}
							{
								eq2ex pet backoff
								relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 1
								relay "${RI_Var_String_RelayGroup}" eq2ex cancel_spellcast
								wait 2
								eq2ex pet backoff
								relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"]:Use
								wait 5
								eq2ex pet backoff
								relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"]:Use
								wait 5 ${Me.CastingSpell}
								wait 50 !${Me.CastingSpell}
								wait 50
								;unpause bots
								relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 0
								_ItemCast:Set[TRUE]
							}
							if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
								call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
							if !${Actor[Query, ID=${_ID}].IsAggro}
							{
								if ${Actor[Query, ID=${_ID}].Distance}>5
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 5 0 0 0 1 0 1 1
								eq2ex apply_verb ${_ID} "${args[${Math.Calc[${_count}+5]}]}"
								wait 10
							}
							;echo end of while loop
						}
						_ItemCast:Set[FALSE]
						call RIMObj.CheckCombat
						wait 15
						if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
						{
							_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
							Trigger:Set[FALSE]
						}
						if ${Trigger} || ( ${args[${Math.Calc[${_count}+1]}].Equal[*ITEMGONE*]} && !${Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"](exists)} )
						{
							_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
							Trigger:Set[FALSE]
						}
						if ${_IWasFlying}
						{
							press -hold ${RI_Var_String_FlyUpKey}
							wait 1
							press -release ${RI_Var_String_FlyUpKey}
							_IWasFlying:Set[FALSE]
						}
						call RIMObj.Move ${_temp} 1 0 0 0 1 0 1 1
					}
				}
			}
			_count:Inc
			_count:Inc
			_count:Inc
			_count:Inc
			_count:Inc
		}
		call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
		_AllQuantitiesMet:Set[TRUE]
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			_count:Inc
			_count:Inc
			;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
			if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
				_AllQuantitiesMet:Set[FALSE]
			_count:Inc
			_count:Inc
			_count:Inc
		}
		; if ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet}
		; {
			; MainArrayCounter:Set[${_end}]
			; echo TimeToEnd
		; }
		if ( ${MainArrayCounter}==${_end} && ${_GoReverseAtLoopOrEnd} ) || ( ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet} )
		{
			MainArrayCounter:Dec
			for(;${MainArrayCounter}>=${_start};MainArrayCounter:Dec)
			{
				call RIMObj.CheckCombat
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					;check for our node and if we are
					if ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
					{
						; if ${_HighlightOnMouseHover}
							; _Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
						; else
							_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]

						;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
						if ${Actor[Query, ${_Query}](exists)}
						{
							_ID:Set[${Actor[Query, ${_Query}].ID}]
							;echo ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							if ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							{
								_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
								if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
								{
									if ${Me.FlyingUsingMount}
										_IWasFlying:Set[TRUE]
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
									if ${Me.FlyingUsingMount}
										call RIMObj.FlyDown
								}
								else
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
								;wait 5
								;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								wait 20
								_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
								while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ( ${Actor[Query, ID=${_ID}].HighlightOnMouseHover} || !${_HighlightOnMouseHover} ) && ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
								{
									if ${args[${Math.Calc[${_count}+3]}]}==100 && !${_ItemCast}
										relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 1
									if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
										Actor[Query, ID=${_ID}]:DoTarget
									if ${args[${Math.Calc[${_count}+3]}]}==100 && !${_ItemCast}
										eq2ex pet backoff
									wait 5
									if ${args[${Math.Calc[${_count}+3]}]}==100 && !${_ItemCast}
										eq2ex pet backoff
									if ${Target.Health}>0 && ${Target.Health}<=${args[${Math.Calc[${_count}+3]}]} && !${_ItemCast} && ${Me.TargetLOS}
									{
										eq2ex pet backoff
										relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 1
										relay "${RI_Var_String_RelayGroup}" eq2ex cancel_spellcast
										wait 2
										eq2ex pet backoff
										relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"]:Use
										wait 5
										eq2ex pet backoff
										relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"]:Use
										wait 5 ${Me.CastingSpell}
										wait 50 !${Me.CastingSpell}
										wait 50
										;unpause bots
										relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 0
										_ItemCast:Set[TRUE]
									}
									if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
										call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
									if !${Actor[Query, ID=${_ID}].IsAggro}
									{
										if ${Actor[Query, ID=${_ID}].Distance}>5
											call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 5 0 0 0 1 0 1 1
										eq2ex apply_verb ${_ID} "${args[${Math.Calc[${_count}+5]}]}"
										wait 10
									}
								}
								_ItemCast:Set[FALSE]
								call RIMObj.CheckCombat
								wait 15
								if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
								{
									_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
									;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
									echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
									Trigger:Set[FALSE]
								}
								if ${Trigger} || ( ${args[${Math.Calc[${_count}+1]}].Equal[*ITEMGONE*]} && !${Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"](exists)} )
								;|| ${args[${Math.Calc[${_count}+1]}].Equal[0]}
								{
									_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
									;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
									echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
									Trigger:Set[FALSE]
								}
								if ${_IWasFlying}
								{
									press -hold ${RI_Var_String_FlyUpKey}
									wait 1
									press -release ${RI_Var_String_FlyUpKey}
									_IWasFlying:Set[FALSE]
								}
								call RIMObj.Move ${_temp} 1 0 0 0 1 0 1 1
							}
						}
					}
					_count:Inc
					_count:Inc
					_count:Inc
					_count:Inc
					_count:Inc
				}
				call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
				_AllQuantitiesMet:Set[TRUE]
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					_count:Inc
					_count:Inc
					;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
					if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
						_AllQuantitiesMet:Set[FALSE]
					_count:Inc
					_count:Inc
					_count:Inc
				}
			}
			;if !${_Loop}
				MainArrayCounter:Set[${_end}]
		}
		if ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
		{
			;echo looping because ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
			MainArrayCounter:Set[${_start}]
		}
	}
	press -release ${RI_Var_String_ForwardKey}
	AnnounceText:Clear
	Trigger:Set[FALSE]
}
function PathItemKillClick(int _PathLines, int _Distance, int _Precision, bool _Loop, bool _GoReverseAfterAllQuantitiesMet, bool _GoReverseAtLoopOrEnd, ... args)
{	
	Trigger:Set[FALSE]
	;variable string echostr="int _PathLines=${_PathLines}, int _Distance=${_Distance}, int _Precision=${_Precision}, bool _Loop=${_Loop}, bool _GoReverseAfterAllQuantitiesMet=${_GoReverseAfterAllQuantitiesMet}, bool _GoReverseAtLoopOrEnd=${_GoReverseAtLoopOrEnd}, ... args="
	;string _MobName, string _TriggerText, int _Quantity, int _HealthTrigger, string _ItemName
	variable int _start
	variable int _end
	variable int _count
	variable string _Query
	variable int _ID
	variable string _tempName
	variable string _temp
	variable index:int _AmountKilled
	variable bool _AllQuantitiesMet
	variable bool _IWasFlying=FALSE
	variable bool _ItemCast=FALSE
	variable bool _CheckQuestStep=FALSE
	variable string _QuestStep=""
	variable int _countor=0
	AnnounceText:Clear
	IncomingText:Clear
	IncomingText2:Clear
	_start:Set[${MainArrayCounter}]

	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		;echostr:Concat["${_count}-_MobName: ${args[${_count}]} ${Math.Calc[${_count}+1].Precision[0]}-_TriggerText: ${args[${Math.Calc[${_count}+1]}]} ${Math.Calc[${_count}+2].Precision[0]}-_Quantity: ${args[${Math.Calc[${_count}+2]}]} ${Math.Calc[${_count}+3].Precision[0]}-_HealthTrigger: ${args[${Math.Calc[${_count}+3]}]} ${Math.Calc[${_count}+4].Precision[0]}-_ItemName: ${args[${Math.Calc[${_count}+4]}]}"]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		
		if ${args[${Math.Calc[${_count}+1]}].NotEqual[0]}
		{
			;echo ${args[${Math.Calc[${_count}+1]}].Left[3]}
			;echo ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
			if ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
				AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
			elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[IT-]}
				IncomingText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
			elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[QS-]}
			{
				_QuestStep:Set[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
				_CheckQuestStep:Set[1]
			}
			else
				AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}]}]
		}
		else
		{
			IncomingText:Insert["You have killed"]
			IncomingText2:Insert["${args[${_count}]}"]
		}
		_count:Inc
		_count:Inc
		_count:Inc
		_count:Inc
	}
	; for(_count:Set[1];${_count}<=${AnnounceText.Used};_count:Inc)
	; {
		; echo ${AnnounceText.Get[${_count}]}
	; }
	; echo ${echostr}
	_end:Set[${Math.Calc[${MainArrayCounter}+${_PathLines}]}]
	for(;${MainArrayCounter}<=${_end};MainArrayCounter:Inc)
	{
		call RIMObj.CheckCombat
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			;check for our node and if we are
			if ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
			{
				if ${args[${_count}].Find[|](exists)}
				{
					_Query:Set["( "]
					for(_countor:Set[1];${_countor}<=${Math.Calc[${args[${_count}].Count[|]}+1]};_countor:Inc)
					{
						if ${_countor}==${Math.Calc[${args[${_count}].Count[|]}+1]}
							_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" ) && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]
						else
							_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" || "]
					}
				}
				else
					_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]
				;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
				if ${Actor[Query, ${_Query}](exists)}
				{
					;echo query exists
					_ID:Set[${Actor[Query, ${_Query}].ID}]
					;echo ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					if ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<${_Precision} || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )
					{
						_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
						if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
						{
							if ${Me.FlyingUsingMount}
								_IWasFlying:Set[TRUE]
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
							if ${Me.FlyingUsingMount}
								call RIMObj.FlyDown
						}
						else
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
						;wait 5
						;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
						wait 20
						_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
						while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
						{
							;echo start of while loop ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} // ${Actor[Query, ID=${_ID} && IsDead=FALSE]} // ${_ID}
							if ${args[${Math.Calc[${_count}+3]}]}==100 && !${_ItemCast}
								relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 1
							if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
								Actor[Query, ID=${_ID}]:DoTarget
							if ${args[${Math.Calc[${_count}+3]}]}==100 && !${_ItemCast}
								eq2ex pet backoff
							wait 5
							if ${args[${Math.Calc[${_count}+3]}]}==100 && !${_ItemCast}
								eq2ex pet backoff
							;echo ${Target.Health}<=${args[${Math.Calc[${_count}+3]}]} && !${_ItemCast} && ${Me.TargetLOS}
							if ${Target.Health}>0 && ${Target.Health}<=${args[${Math.Calc[${_count}+3]}]} && !${_ItemCast}
							{
								if !${Me.TargetLOS}
								{
									;we cant see the mob lets mob on its ass.
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 1 0 0 0 1 0 1 1
								}
								eq2ex pet backoff
								relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 1
								relay "${RI_Var_String_RelayGroup}" eq2ex cancel_spellcast
								wait 2
								eq2ex pet backoff
								relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+4]}].Token[1,|]}"]:Use
								wait 5
								eq2ex pet backoff
								relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+4]}].Token[1,|]}"]:Use
								wait 5 ${Me.CastingSpell}
								wait 50 !${Me.CastingSpell}
								wait 50
								;unpause bots
								relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 0
								_ItemCast:Set[TRUE]
							}
							if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
								call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
							wait 5
							while ${Me.InCombat}
								wait 1
							if ${args[${Math.Calc[${_count}+4]}].Token[2,|](exists)}
							{
								_ID:Set[${Actor[Query, Name=-"${args[${Math.Calc[${_count}+4]}].Token[2,|]}"].ID}]
								wait 2
							}
							if !${Actor[Query, ID=${_ID}].IsAggro}
							{
								if ${Actor[Query, ID=${_ID}].Distance}>5
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 5 0 0 0 1 0 1 1
								Actor[Query, ID=${_ID}]:DoubleClick
								wait 50
							}
							;echo end of while loop
						}
						_ItemCast:Set[FALSE]
						call RIMObj.CheckCombat
						wait 15
						if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
						{
							_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
							Trigger:Set[FALSE]
						}
						if ${Trigger} || ( ${args[${Math.Calc[${_count}+1]}].Equal[*ITEMGONE*]} && !${Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"](exists)} )
						{
							_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
							Trigger:Set[FALSE]
						}
						if ${_IWasFlying}
						{
							press -hold ${RI_Var_String_FlyUpKey}
							wait 1
							press -release ${RI_Var_String_FlyUpKey}
							_IWasFlying:Set[FALSE]
						}
						call RIMObj.Move ${_temp} 1 0 0 0 1 0 1 1
					}
				}
			}
			_count:Inc
			_count:Inc
			_count:Inc
			_count:Inc
		}
		call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
		_AllQuantitiesMet:Set[TRUE]
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			_count:Inc
			_count:Inc
			;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
			if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
				_AllQuantitiesMet:Set[FALSE]
			_count:Inc
			_count:Inc
		}
		; if ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet}
		; {
			; MainArrayCounter:Set[${_end}]
			; echo TimeToEnd
		; }
		if ( ${MainArrayCounter}==${_end} && ${_GoReverseAtLoopOrEnd} ) || ( ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet} )
		{
			MainArrayCounter:Dec
			for(;${MainArrayCounter}>=${_start};MainArrayCounter:Dec)
			{
				call RIMObj.CheckCombat
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					;check for our node and if we are
					if ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
					{
						if ${args[${_count}].Find[|](exists)}
						{
							_Query:Set["( "]
							for(_countor:Set[1];${_countor}<=${Math.Calc[${args[${_count}].Count[|]}+1]};_countor:Inc)
							{
								if ${_countor}==${Math.Calc[${args[${_count}].Count[|]}+1]}
									_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" ) && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]
								else
									_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" || "]
							}
						}
						else
							_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]

						;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
						if ${Actor[Query, ${_Query}](exists)}
						{
							_ID:Set[${Actor[Query, ${_Query}].ID}]
							;echo ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							if ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							{
								_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
								if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
								{
									if ${Me.FlyingUsingMount}
										_IWasFlying:Set[TRUE]
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
									if ${Me.FlyingUsingMount}
										call RIMObj.FlyDown
								}
								else
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
								;wait 5
								;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								wait 20
								_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
								while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ( ${Actor[Query, ID=${_ID}].HighlightOnMouseHover} || !${_HighlightOnMouseHover} ) && ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
								{
									if ${args[${Math.Calc[${_count}+3]}]}==100 && !${_ItemCast}
										relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 1
									if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
										Actor[Query, ID=${_ID}]:DoTarget
									if ${args[${Math.Calc[${_count}+3]}]}==100 && !${_ItemCast}
										eq2ex pet backoff
									wait 5
									if ${args[${Math.Calc[${_count}+3]}]}==100 && !${_ItemCast}
										eq2ex pet backoff
									if ${Target.Health}>0 && ${Target.Health}<=${args[${Math.Calc[${_count}+3]}]} && !${_ItemCast}
									{
										if !${Me.TargetLOS}
										{
											;we cant see the mob lets mob on its ass.
											call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 1 0 0 0 1 0 1 1
										}
										eq2ex pet backoff
										relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 1
										relay "${RI_Var_String_RelayGroup}" eq2ex cancel_spellcast
										wait 2
										eq2ex pet backoff
										relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+4]}].Token[1,|]}"]:Use
										wait 5
										eq2ex pet backoff
										relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+4]}].Token[1,|]}"]:Use
										wait 5 ${Me.CastingSpell}
										wait 50 !${Me.CastingSpell}
										wait 50
										;unpause bots
										relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 0
										_ItemCast:Set[TRUE]
									}
									if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
										call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
									wait 5
									while ${Me.InCombat}
										wait 1
									if ${args[${Math.Calc[${_count}+4]}].Token[2,|](exists)}
									{
										_ID:Set[${Actor[Query, Name=-"${args[${Math.Calc[${_count}+4]}].Token[2,|]}"].ID}]
										wait 2
									}
									if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+1]}
										call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
									if !${Actor[Query, ID=${_ID}].IsAggro}
									{
										if ${Actor[Query, ID=${_ID}].Distance}>5
											call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 5 0 0 0 1 0 1 1
										Actor[Query, ID=${_ID}]:DoubleClick
										wait 50
									}
								}
								_ItemCast:Set[FALSE]
								call RIMObj.CheckCombat
								wait 15
								if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
								{
									_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
									;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
									echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
									Trigger:Set[FALSE]
								}
								if ${Trigger} || ( ${args[${Math.Calc[${_count}+1]}].Equal[*ITEMGONE*]} && !${Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"](exists)} )
								;|| ${args[${Math.Calc[${_count}+1]}].Equal[0]}
								{
									_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
									;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
									echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
									Trigger:Set[FALSE]
								}
								if ${_IWasFlying}
								{
									press -hold ${RI_Var_String_FlyUpKey}
									wait 1
									press -release ${RI_Var_String_FlyUpKey}
									_IWasFlying:Set[FALSE]
								}
								call RIMObj.Move ${_temp} 1 0 0 0 1 0 1 1
							}
						}
					}
					_count:Inc
					_count:Inc
					_count:Inc
					_count:Inc
				}
				call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
				_AllQuantitiesMet:Set[TRUE]
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					_count:Inc
					_count:Inc
					;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
					if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
						_AllQuantitiesMet:Set[FALSE]
					_count:Inc
					_count:Inc
				}
			}
			;if !${_Loop}
				MainArrayCounter:Set[${_end}]
		}
		if ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
		{
			;echo looping because ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
			MainArrayCounter:Set[${_start}]
		}
	}
	press -release ${RI_Var_String_ForwardKey}
	AnnounceText:Clear
	Trigger:Set[FALSE]
}
function PathItemKill(int _PathLines, int _Distance, int _Precision, bool _Loop, bool _GoReverseAfterAllQuantitiesMet, bool _GoReverseAtLoopOrEnd, ... args)
{	
	Trigger:Set[FALSE]
	;variable string echostr="int _PathLines=${_PathLines}, int _Distance=${_Distance}, int _Precision=${_Precision}, bool _Loop=${_Loop}, bool _GoReverseAfterAllQuantitiesMet=${_GoReverseAfterAllQuantitiesMet}, bool _GoReverseAtLoopOrEnd=${_GoReverseAtLoopOrEnd}, ... args="
	;string _MobName, string _TriggerText, int _Quantity, int _HealthTrigger, string _ItemName
	variable int _start
	variable int _end
	variable int _count
	variable string _Query
	variable int _ID
	variable string _tempName
	variable string _temp
	variable index:int _AmountKilled
	variable bool _AllQuantitiesMet
	variable bool _IWasFlying=FALSE
	variable bool _ItemCast=FALSE
	variable bool _CheckQuestStep=FALSE
	variable string _QuestStep=""
	variable int _countor=0
	AnnounceText:Clear
	IncomingText:Clear
	IncomingText2:Clear
	variable int JTC
	_start:Set[${MainArrayCounter}]

	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		;echostr:Concat["${_count}-_MobName: ${args[${_count}]} ${Math.Calc[${_count}+1].Precision[0]}-_TriggerText: ${args[${Math.Calc[${_count}+1]}]} ${Math.Calc[${_count}+2].Precision[0]}-_Quantity: ${args[${Math.Calc[${_count}+2]}]} ${Math.Calc[${_count}+3].Precision[0]}-_HealthTrigger: ${args[${Math.Calc[${_count}+3]}]} ${Math.Calc[${_count}+4].Precision[0]}-_ItemName: ${args[${Math.Calc[${_count}+4]}]}"]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		
		if ${args[${Math.Calc[${_count}+1]}].NotEqual[0]}
		{
			;echo ${args[${Math.Calc[${_count}+1]}].Left[3]}
			;echo ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
			if ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
				AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
			elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[IT-]}
				IncomingText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
			elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[QS-]}
			{
				_QuestStep:Set[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
				_CheckQuestStep:Set[1]
			}
			else
				AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}]}]
		}
		else
		{
			IncomingText:Insert["You have killed"]
			IncomingText2:Insert["${args[${_count}]}"]
		}
		_count:Inc
		_count:Inc
		_count:Inc
		_count:Inc
	}
	; for(_count:Set[1];${_count}<=${AnnounceText.Used};_count:Inc)
	; {
		; echo ${AnnounceText.Get[${_count}]}
	; }
	; echo ${echostr}
	_end:Set[${Math.Calc[${MainArrayCounter}+${_PathLines}]}]
	for(;${MainArrayCounter}<=${_end};MainArrayCounter:Inc)
	{
		call RIMObj.CheckCombat
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			;check for our node and if we are
			if ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
			{
				if ${args[${_count}].Find[|](exists)}
				{
					_Query:Set["( "]
					for(_countor:Set[1];${_countor}<=${Math.Calc[${args[${_count}].Count[|]}+1]};_countor:Inc)
					{
						if ${_countor}==${Math.Calc[${args[${_count}].Count[|]}+1]}
							_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" ) && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]
						else
							_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" || "]
					}
				}
				else
					_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]
				;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
				if ${Actor[Query, ${_Query}](exists)}
				{
					;echo query exists
					_ID:Set[${Actor[Query, ${_Query}].ID}]
					;echo ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					if ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<${_Precision} || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )
					{
						_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
						if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
						{
							if ${Me.FlyingUsingMount}
								_IWasFlying:Set[TRUE]
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
							if ${Me.FlyingUsingMount}
								call RIMObj.FlyDown
						}
						else
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
						;wait 5
						;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
						wait 20
						_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
						while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
						{
							;echo start of while loop ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} // ${Actor[Query, ID=${_ID} && IsDead=FALSE]} // ${_ID}
							if ${args[${Math.Calc[${_count}+3]}]}==100 && !${_ItemCast}
								relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 1
							if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
								Actor[Query, ID=${_ID}]:DoTarget
							if ${args[${Math.Calc[${_count}+3]}]}==100 && !${_ItemCast}
								eq2ex pet backoff
							wait 5
							if ${args[${Math.Calc[${_count}+3]}]}==100 && !${_ItemCast}
								eq2ex pet backoff
							;echo ${Target.Health}<=${args[${Math.Calc[${_count}+3]}]} && !${_ItemCast} && ${Me.TargetLOS}
							if ${Target.Health}>0 && ${Target.Health}<=${args[${Math.Calc[${_count}+3]}]} && !${_ItemCast}
							{
								if !${Me.TargetLOS}
								{
									;we cant see the mob lets mob on its ass.
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 1 0 0 0 1 0 1 1
								}
								eq2ex pet backoff
								relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 1
								relay "${RI_Var_String_RelayGroup}" eq2ex cancel_spellcast
								wait 2
								eq2ex pet backoff
								relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"]:Use
								wait 5
								eq2ex pet backoff
								relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"]:Use
								wait 5 ${Me.CastingSpell}
								wait 50 !${Me.CastingSpell}
								wait 50
								;unpause bots
								relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 0
								_ItemCast:Set[TRUE]
							}
							if ${args[${Math.Calc[${_count}+4]}].Find["Jesinnal's Tablet"](exists)} && !${RIObj.MainIconIDExists[${Target.ID},698]}
							{
								;echo jes tab is not on mob
								JTC:Set[1]
								while !${RIObj.MainIconIDExists[${Target.ID},698]} && ${JTC:Inc}<1000 && ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]} && ${Actor[Query, ID=${_ID}].Distance}<17
								{
									relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"]:Use
									wait 1
								}
							}
							if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
								call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
							;echo end of while loop
						}
						_ItemCast:Set[FALSE]
						call RIMObj.CheckCombat
						wait 15
						if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
						{
							_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
							Trigger:Set[FALSE]
						}
						if ${Trigger} || ( ${args[${Math.Calc[${_count}+1]}].Equal[*ITEMGONE*]} && !${Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"](exists)} )
						{
							_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
							Trigger:Set[FALSE]
						}
						if ${_IWasFlying}
						{
							press -hold ${RI_Var_String_FlyUpKey}
							wait 1
							press -release ${RI_Var_String_FlyUpKey}
							_IWasFlying:Set[FALSE]
						}
						call RIMObj.Move ${_temp} 1 0 0 0 1 0 1 1
					}
				}
			}
			_count:Inc
			_count:Inc
			_count:Inc
			_count:Inc
		}
		call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
		_AllQuantitiesMet:Set[TRUE]
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			_count:Inc
			_count:Inc
			;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
			if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
				_AllQuantitiesMet:Set[FALSE]
			_count:Inc
			_count:Inc
		}
		; if ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet}
		; {
			; MainArrayCounter:Set[${_end}]
			; echo TimeToEnd
		; }
		if ( ${MainArrayCounter}==${_end} && ${_GoReverseAtLoopOrEnd} ) || ( ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet} )
		{
			MainArrayCounter:Dec
			for(;${MainArrayCounter}>=${_start};MainArrayCounter:Dec)
			{
				call RIMObj.CheckCombat
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					;check for our node and if we are
					if ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
					{
						if ${args[${_count}].Find[|](exists)}
						{
							_Query:Set["( "]
							for(_countor:Set[1];${_countor}<=${Math.Calc[${args[${_count}].Count[|]}+1]};_countor:Inc)
							{
								if ${_countor}==${Math.Calc[${args[${_count}].Count[|]}+1]}
									_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" ) && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]
								else
									_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" || "]
							}
						}
						else
							_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]

						;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
						if ${Actor[Query, ${_Query}](exists)}
						{
							_ID:Set[${Actor[Query, ${_Query}].ID}]
							;echo ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							if ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							{
								_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
								if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
								{
									if ${Me.FlyingUsingMount}
										_IWasFlying:Set[TRUE]
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
									if ${Me.FlyingUsingMount}
										call RIMObj.FlyDown
								}
								else
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
								;wait 5
								;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								wait 20
								_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
								while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ( ${Actor[Query, ID=${_ID}].HighlightOnMouseHover} || !${_HighlightOnMouseHover} ) && ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
								{
									if ${args[${Math.Calc[${_count}+3]}]}==100 && !${_ItemCast}
										relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 1
									if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
										Actor[Query, ID=${_ID}]:DoTarget
									if ${args[${Math.Calc[${_count}+3]}]}==100 && !${_ItemCast}
										eq2ex pet backoff
									wait 5
									if ${args[${Math.Calc[${_count}+3]}]}==100 && !${_ItemCast}
										eq2ex pet backoff
									if ${Target.Health}>0 && ${Target.Health}<=${args[${Math.Calc[${_count}+3]}]} && !${_ItemCast}
									{
										if !${Me.TargetLOS}
										{
											;we cant see the mob lets mob on its ass.
											call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 1 0 0 0 1 0 1 1
										}
										eq2ex pet backoff
										relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 1
										relay "${RI_Var_String_RelayGroup}" eq2ex cancel_spellcast
										wait 2
										eq2ex pet backoff
										relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"]:Use
										wait 5
										eq2ex pet backoff
										relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"]:Use
										wait 5 ${Me.CastingSpell}
										wait 50 !${Me.CastingSpell}
										wait 50
										;unpause bots
										relay "${RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 0
										_ItemCast:Set[TRUE]
									}
									if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
										call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								}
								_ItemCast:Set[FALSE]
								call RIMObj.CheckCombat
								wait 15
								if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
								{
									_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
									;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
									echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
									Trigger:Set[FALSE]
								}
								if ${Trigger} || ( ${args[${Math.Calc[${_count}+1]}].Equal[*ITEMGONE*]} && !${Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"](exists)} )
								;|| ${args[${Math.Calc[${_count}+1]}].Equal[0]}
								{
									_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
									;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
									echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
									Trigger:Set[FALSE]
								}
								if ${_IWasFlying}
								{
									press -hold ${RI_Var_String_FlyUpKey}
									wait 1
									press -release ${RI_Var_String_FlyUpKey}
									_IWasFlying:Set[FALSE]
								}
								call RIMObj.Move ${_temp} 1 0 0 0 1 0 1 1
							}
						}
					}
					_count:Inc
					_count:Inc
					_count:Inc
					_count:Inc
				}
				call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
				_AllQuantitiesMet:Set[TRUE]
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					_count:Inc
					_count:Inc
					;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
					if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
						_AllQuantitiesMet:Set[FALSE]
					_count:Inc
					_count:Inc
				}
			}
			;if !${_Loop}
				MainArrayCounter:Set[${_end}]
		}
		if ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
		{
			;echo looping because ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
			MainArrayCounter:Set[${_start}]
		}
	}
	press -release ${RI_Var_String_ForwardKey}
	AnnounceText:Clear
	Trigger:Set[FALSE]
}
function PathItem(int _PathLines, int _Distance, int _Precision, bool _Loop, bool _GoReverseAfterAllQuantitiesMet, bool _GoReverseAtLoopOrEnd, ... args)
{	
	Trigger:Set[FALSE]
	;variable string echostr="int _PathLines=${_PathLines}, int _Distance=${_Distance}, int _Precision=${_Precision}, bool _Loop=${_Loop}, bool _GoReverseAfterAllQuantitiesMet=${_GoReverseAfterAllQuantitiesMet}, bool _GoReverseAtLoopOrEnd=${_GoReverseAtLoopOrEnd}, ... args="
	;string _MobName, string _TriggerText, int _Quantity, int _HealthTrigger, string _ItemName
	variable int _start
	variable int _end
	variable int _count
	variable string _Query
	variable int _ID
	variable string _tempName
	variable string _temp
	variable index:int _AmountKilled
	variable bool _AllQuantitiesMet
	variable bool _IWasFlying=FALSE
	variable bool _ItemCast=FALSE
	variable bool _CheckQuestStep=FALSE
	variable string _QuestStep=""
	variable int _countor=0
	AnnounceText:Clear
	IncomingText:Clear
	IncomingText2:Clear
	_start:Set[${MainArrayCounter}]

	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		;echostr:Concat["${_count}-_MobName: ${args[${_count}]} ${Math.Calc[${_count}+1].Precision[0]}-_TriggerText: ${args[${Math.Calc[${_count}+1]}]} ${Math.Calc[${_count}+2].Precision[0]}-_Quantity: ${args[${Math.Calc[${_count}+2]}]} ${Math.Calc[${_count}+3].Precision[0]}-_HealthTrigger: ${args[${Math.Calc[${_count}+3]}]} ${Math.Calc[${_count}+4].Precision[0]}-_ItemName: ${args[${Math.Calc[${_count}+4]}]}"]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		_AmountKilled:Insert[0]
		
		if ${args[${Math.Calc[${_count}+1]}].NotEqual[0]}
		{
			;echo ${args[${Math.Calc[${_count}+1]}].Left[3]}
			;echo ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
			if ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
				AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
			elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[IT-]}
				IncomingText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
			elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[QS-]}
			{
				_QuestStep:Set[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
				_CheckQuestStep:Set[1]
			}
			else
				AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}]}]
		}
		else
		{
			IncomingText:Insert["You have killed"]
			IncomingText2:Insert["${args[${_count}]}"]
		}
		_count:Inc
		_count:Inc
		_count:Inc
		_count:Inc
	}
	; for(_count:Set[1];${_count}<=${AnnounceText.Used};_count:Inc)
	; {
		; echo ${AnnounceText.Get[${_count}]}
	; }
	;echo ${echostr}
	_end:Set[${Math.Calc[${MainArrayCounter}+${_PathLines}]}]
	for(;${MainArrayCounter}<=${_end};MainArrayCounter:Inc)
	{
		call RIMObj.CheckCombat
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			;check for our node and if we are
			if ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
			{
				if ${args[${_count}].Find[|](exists)}
				{
					_Query:Set["( "]
					for(_countor:Set[1];${_countor}<=${Math.Calc[${args[${_count}].Count[|]}+1]};_countor:Inc)
					{
						if ${_countor}==${Math.Calc[${args[${_count}].Count[|]}+1]}
							_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" ) && Distance<=${_Distance}"]
						else
							_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" || "]
					}
				}
				else
					_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance}"]
				;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
				if ${Actor[Query, ${_Query}](exists)}
				{
					;echo query exists
					_ID:Set[${Actor[Query, ${_Query}].ID}]
					;echo ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					if ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<${_Precision} || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )
					{
						_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
						if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
						{
							if ${Me.FlyingUsingMount}
								_IWasFlying:Set[TRUE]
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
							if ${Me.FlyingUsingMount}
								call RIMObj.FlyDown
						}
						else
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
						;wait 5
						;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
						wait 20
						_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
						while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
						{
							;echo start of while loop ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} // ${Actor[Query, ID=${_ID} && IsDead=FALSE]} // ${_ID}
							if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
								Actor[Query, ID=${_ID}]:DoTarget
							wait 5
							;echo ${Target.Health}<=${args[${Math.Calc[${_count}+3]}]} && !${_ItemCast} && ${Me.TargetLOS}
							if !${_ItemCast}
							{
								if !${Me.TargetLOS}
								{
									;we cant see the mob lets mob on its ass.
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 1 0 0 0 1 0 1 1
								}
								relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+3]}]}"]:Use
								wait 5
								relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+3]}]}"]:Use
								wait 5 ${Me.CastingSpell}
								wait 50 !${Me.CastingSpell}
								wait 50
								;unpause bots
								_ItemCast:Set[TRUE]
							}
							if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
								call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
							;echo end of while loop
						}
						_ItemCast:Set[FALSE]
						call RIMObj.CheckCombat
						wait 15
						if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
						{
							_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
							Trigger:Set[FALSE]
						}
						if ${Trigger} || ( ${args[${Math.Calc[${_count}+1]}].Equal[*ITEMGONE*]} && !${Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"](exists)} )
						{
							_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
							;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
							Trigger:Set[FALSE]
						}
						if ${_IWasFlying}
						{
							press -hold ${RI_Var_String_FlyUpKey}
							wait 1
							press -release ${RI_Var_String_FlyUpKey}
							_IWasFlying:Set[FALSE]
						}
						call RIMObj.Move ${_temp} 1 0 0 0 1 0 1 1
					}
				}
			}
			_count:Inc
			_count:Inc
			_count:Inc
			_count:Inc
		}
		call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
		_AllQuantitiesMet:Set[TRUE]
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			_count:Inc
			_count:Inc
			;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
			if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
				_AllQuantitiesMet:Set[FALSE]
			_count:Inc
			_count:Inc
		}
		; if ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet}
		; {
			; MainArrayCounter:Set[${_end}]
			; echo TimeToEnd
		; }
		if ( ${MainArrayCounter}==${_end} && ${_GoReverseAtLoopOrEnd} ) || ( ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet} )
		{
			MainArrayCounter:Dec
			for(;${MainArrayCounter}>=${_start};MainArrayCounter:Dec)
			{
				call RIMObj.CheckCombat
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					;check for our node and if we are
					if ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
					{
						if ${args[${_count}].Find[|](exists)}
						{
							_Query:Set["( "]
							for(_countor:Set[1];${_countor}<=${Math.Calc[${args[${_count}].Count[|]}+1]};_countor:Inc)
							{
								if ${_countor}==${Math.Calc[${args[${_count}].Count[|]}+1]}
									_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" ) && Distance<=${_Distance}"]
								else
									_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" || "]
							}
						}
						else
							_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance}"]

						;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
						if ${Actor[Query, ${_Query}](exists)}
						{
							_ID:Set[${Actor[Query, ${_Query}].ID}]
							;echo ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							if ( ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<15 || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) && !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							;( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							{
								_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
								if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
								{
									if ${Me.FlyingUsingMount}
										_IWasFlying:Set[TRUE]
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
									if ${Me.FlyingUsingMount}
										call RIMObj.FlyDown
								}
								else
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
								;wait 5
								;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								wait 20
								_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
								while ${Actor[Query, ID=${_ID} && IsDead=FALSE](exists)} && ( ${Actor[Query, ID=${_ID}].HighlightOnMouseHover} || !${_HighlightOnMouseHover} ) && ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
								{
									if ${Target.ID}!=${Actor[Query, ID=${_ID}].ID}
										Actor[Query, ID=${_ID}]:DoTarget
									if !${_ItemCast}
									{
										if !${Me.TargetLOS}
										{
											;we cant see the mob lets mob on its ass.
											call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 1 0 0 0 1 0 1 1
										}
										relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+3]}]}"]:Use
										wait 5
										relay "${RI_Var_String_RelayGroup}" Me.Inventory["${args[${Math.Calc[${_count}+3]}]}"]:Use
										wait 5 ${Me.CastingSpell}
										wait 50 !${Me.CastingSpell}
										wait 50
										_ItemCast:Set[TRUE]
									}
									if ${Actor[Query, ID=${_ID}].Distance}>${Math.Calc[${_Precision}+5]}
										call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 0 0 1 0 1 1
								}
								_ItemCast:Set[FALSE]
								call RIMObj.CheckCombat
								wait 15
								if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
								{
									_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
									;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
									echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
									Trigger:Set[FALSE]
								}
								if ${Trigger} || ( ${args[${Math.Calc[${_count}+1]}].Equal[*ITEMGONE*]} && !${Me.Inventory["${args[${Math.Calc[${_count}+4]}]}"](exists)} )
								;|| ${args[${Math.Calc[${_count}+1]}].Equal[0]}
								{
									_AmountKilled.Get[${Math.Calc[${_count}+2]}]:Inc
									;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
									echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
									Trigger:Set[FALSE]
								}
								if ${_IWasFlying}
								{
									press -hold ${RI_Var_String_FlyUpKey}
									wait 1
									press -release ${RI_Var_String_FlyUpKey}
									_IWasFlying:Set[FALSE]
								}
								call RIMObj.Move ${_temp} 1 0 0 0 1 0 1 1
							}
						}
					}
					_count:Inc
					_count:Inc
					_count:Inc
					_count:Inc
				}
				call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
				_AllQuantitiesMet:Set[TRUE]
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					_count:Inc
					_count:Inc
					;echo ${_count}: ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
					if ${_AmountKilled.Get[${_count}]}<${args[${_count}]}
						_AllQuantitiesMet:Set[FALSE]
					_count:Inc
					_count:Inc
				}
			}
			;if !${_Loop}
				MainArrayCounter:Set[${_end}]
		}
		if ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
		{
			;echo looping because ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
			MainArrayCounter:Set[${_start}]
		}
	}
	press -release ${RI_Var_String_ForwardKey}
	AnnounceText:Clear
	Trigger:Set[FALSE]
}
function PathHarvest(int _PathLines, string _DistanceIN, bool _Loop, bool _GoReverseAfterAllQuantitiesMet, bool _GoReverseAtLoopOrEnd, bool _HighlightOnMouseHover=FALSE, ... args)
{	
	variable int _Distance
	variable int _Precision=2
	variable int _YINC=2
	if ${_DistanceIN.Count[|]}>1
	{
		;echo Setting _Distance:Set[${Int[${_DistanceIN.Token[1,|]}]}] // _Precision:Set[${Int[${_DistanceIN.Token[2,|]}]}]
		_Distance:Set[${Int[${_DistanceIN.Token[1,|]}]}]
		_Precision:Set[${Int[${_DistanceIN.Token[2,|]}]}]
		_YINC:Set[${Int[${_DistanceIN.Token[3,|]}]}]
	}
	elseif ${_DistanceIN.Count[|]}>0
	{
		;echo Setting _Distance:Set[${Int[${_DistanceIN.Token[1,|]}]}] // _Precision:Set[${Int[${_DistanceIN.Token[2,|]}]}]
		_Distance:Set[${Int[${_DistanceIN.Token[1,|]}]}]
		_Precision:Set[${Int[${_DistanceIN.Token[2,|]}]}]
	}
	else
	{
		;echo Setting _Distance:Set[${Int[${_DistanceIN}]}]
		_Distance:Set[${Int[${_DistanceIN}]}]
	}
	if ${RI_Var_Bool_PathDebug}
		echo _Distance=${_Distance} // _Precision=${_Precision} // _YINC=${_YINC}
	Trigger:Set[FALSE]
	if ${RI_Var_Bool_PathDebug}
		variable string echostr="int _PathLines=${_PathLines}, int _Distance=${_Distance}, bool _Loop=${_Loop}, bool _GoReverseAfterAllQuantitiesMet=${_GoReverseAfterAllQuantitiesMet}, bool _GoReverseAtLoopOrEnd=${_GoReverseAtLoopOrEnd}, ... args="
	;string _Node, int _Quantity,
	variable int _start
	variable int _end
	variable int _count
	variable string _Query
	variable int _ID
	variable string _tempName
	variable string _temp
	variable index:int _AmountHarvested
	variable bool _AllQuantitiesMet
	variable bool _IWasFlying=FALSE
	
	variable bool _CheckQuestStep=FALSE
	variable bool _CheckNotQuestStep=FALSE
	variable bool _IgnoreCC=FALSE
	variable string _QuestStep=""
	variable bool _DontRelayClick=FALSE
	AnnounceText:Clear
	IncomingText:Clear
	IncomingText2:Clear
	
	if ${QuestJournalWindow.ActiveQuest["Borrowing From The Dead"](exists)}
		AnnounceText:Insert[I found some rusty armor scraps]
	if ${QuestJournalWindow.ActiveQuest["Dying of Bore-dom"](exists)}
	{
		AnnounceText:Insert["You notice larvae in the soil!"]
		AnnounceText:Insert["I didn't find any adult beetles, but I did find larvae"]
	}
	if ${QuestJournalWindow.ActiveQuest["Process of Elimination"](exists)}
		AnnounceText:Insert["fungal samples"]
	if ${QuestJournalWindow.ActiveQuest["The Final Blow"](exists)}	
		AnnounceText:Insert["arcanna'se precious metal"]
	if ${QuestJournalWindow.ActiveQuest["Kunark Ascending: History in Stone"](exists)}
	{
		if ${args[1].Equal[stolen pylon]}
			_YINC:Set[5]
	}
	;;; Gonna replace below, with a customfunction that will run a SET LockSpot path, via code and clicks all the required ones, then continues until all are gotten, then runs path backwards
	if ${QuestJournalWindow.ActiveQuest["A Stitch in Time, Part III: From Birth to Tombs"](exists)}
	{
		if ${args[1].Equal[minigame flesh cube blocker]}
			_IgnoreCC:Set[1]
	}
	_start:Set[${MainArrayCounter}]
	
	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		if ${RI_Var_Bool_PathDebug}
			echostr:Concat["${_count}: ${args[${_count}]} ${Math.Calc[${_count}+1].Precision[0]}: ${args[${Math.Calc[${_count}+1]}]} ${Math.Calc[${_count}+2].Precision[0]}: ${args[${Math.Calc[${_count}+2]}]}"]
		_AmountHarvested:Insert[0]
		_AmountHarvested:Insert[0]
		_AmountHarvested:Insert[0]
		;echo ${args[${Math.Calc[${_count}+1]}]} // ${args[${Math.Calc[${_count}+1]}].Find[AT-](exists)}
		if ${args[${Math.Calc[${_count}+1]}].Equal[0]}
		{
			AnnounceText:Insert[You have]
			AnnounceText:Insert[You receive]
		}
		elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
			AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
		elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[IT-]}
			IncomingText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
		elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[QS-]}
		{
			_QuestStep:Set[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
			_CheckQuestStep:Set[1]
		}
		elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[NQS-]}
		{
			_QuestStep:Set[${args[${Math.Calc[${_count}+1]}].Right[-4]}]
			_CheckNotQuestStep:Set[1]
		}
		elseif ${args[${Math.Calc[${_count}+1]}].Equal[-1]}
			noop
		else
			AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}]}]
		_count:Inc
		_count:Inc
	}
	if ${RI_Var_Bool_PathDebug}
		echo ${echostr}
	if ${RI_Var_Bool_PathDebug}
	{
		for(_count:Set[1];${_count}<=${AnnounceText.Used};_count:Inc)
		{
			echo Announce: ${AnnounceText.Get[${_count}]}
		}
		for(_count:Set[1];${_count}<=${IncomingText.Used};_count:Inc)
		{
			echo IncomingText: ${IncomingText.Get[${_count}]}
		}
		echo Qty's:
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			_count:Inc
			_count:Inc
			echo ${args[${_count}]}
		}
	}
	_end:Set[${Math.Calc[${MainArrayCounter}+${_PathLines}]}]
	for(;${MainArrayCounter}<=${_end};MainArrayCounter:Inc)
	{
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			if ${RI_Var_Bool_BreakPathFunction}
			{
				RI_Var_Bool_BreakPathFunction:Set[0]
				return
			}
			call RIMObj.CheckCombat
			;check for our node and if we are
			;echo 1: ${args[${Math.Calc[${_count}+0]}]}
			;echo 2: ${args[${Math.Calc[${_count}+1]}]}
			;echo 3: ${args[${Math.Calc[${_count}+2]}]}
			if ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
			{
				;;;;;if ${args[${_count}].Find[|](exists)}   ---- this block is from path kill need to modify for path harvest to fix sphinx outside the box
				;{
				;	_Query:Set["( "]
				;	for(_countor:Set[1];${_countor}<=${Math.Calc[${args[${_count}].Count[|]}+1]};_countor:Inc)
				;	{
				;		if ${_countor}==${Math.Calc[${args[${_count}].Count[|]}+1]}
				;			_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" ) && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]
				;		else
				;			_Query:Concat["Name=-\"${args[${_count}].Token[${_countor},|]}\" || "]
				;	}
				;}
				;else
			;		_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]
				if ${args[${_count}].Find[|](exists)}
				{
					;eventually need to code it to .Count[|] and add 1 and concat the query with Each element until it has all of them
					;echo ${args[${_count}].Token[1,|].Left[10]} // ${args[${_count}].Token[1,|].Left[10].Equal[TintFlags-]}
					if ${args[${_count}].Token[1,|].Left[10].Equal[TintFlags-]} && ${_HighlightOnMouseHover}
						_Query:Set["( TintFlags=${args[${_count}].Token[1,|].Right[-10]} || TintFlags=${args[${_count}].Token[2,|].Right[-10]} ) && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
					elseif ${args[${_count}].Token[1,|].Left[10].Equal[TintFlags-]}
						_Query:Set["( TintFlags=${args[${_count}].Token[1,|].Right[-10]} || TintFlags=${args[${_count}].Token[2,|].Right[-10]} ) && Distance<=${_Distance}"]
					elseif ${_HighlightOnMouseHover}
						_Query:Set["( Name=-\"${args[${_count}].Token[1,|]}\" || Name=-\"${args[${_count}].Token[2,|]}\" ) && Distance<=${_Distance} && HighlightOnMouseHover=TRUE && Type!=\"NPC\" && Type!=\"NamedNPC\""]
					else
						_Query:Set["( Name=-\"${args[${_count}].Token[1,|]}\" || Name=-\"${args[${_count}].Token[2,|]}\" ) && Distance<=${_Distance} && Type!=\"NPC\" && Type!=\"NamedNPC\""]
				}
				else
				{
					if ${args[${_count}].Left[10].Equal[TintFlags-]} && ${_HighlightOnMouseHover}
						_Query:Set["TintFlags=${args[${_count}].Right[-10]} && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
					elseif ${args[${_count}].Left[10].Equal[TintFlags-]}
						_Query:Set["TintFlags=${args[${_count}].Right[-10]} && Distance<=${_Distance}"]
					elseif ${_HighlightOnMouseHover}
						_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && HighlightOnMouseHover=TRUE && Type!=\"NPC\" && Type!=\"NamedNPC\""]
					else
						_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && Type!=\"NPC\" && Type!=\"NamedNPC\""]
				}
				if ${RI_Var_Bool_PathDebug}
					echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
				if ${_Query.Find["Gaukr Sandstorm's Treasure"](exists)} || ${_Query.Find["Hreidar Lynhillig's Treasure"](exists)}
					_DontRelayClick:Set[1]
				_ID:Set[${Actor[Query, ${_Query}].ID}]
				if ${_ID}>0 && ( !${Zone.Name.Find["Plane of Innovation: Security Measures [Tradeskill]"](exists)} || ${Actor[id,${_ID}].Distance[${Actor[NPC,"an innovative guard"].Loc}]}>10 )
				{
					;_ID:Set[${Actor[Query, ${_Query}].ID}]
					if ${RI_Var_Bool_PathDebug}
						echo if ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& \${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+${_YINC}]},${Actor[Query, ID=${_ID}].Z}]} = !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+${_YINC}]},${Actor[Query, ID=${_ID}].Z}]} || ${_IgnoreCC} )
					if ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} ) && ( !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+${_YINC}]},${Actor[Query, ID=${_ID}].Z}]} || ${_IgnoreCC} )
					{
						_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
						if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
						{
							if ${Me.FlyingUsingMount}
								_IWasFlying:Set[TRUE]
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
							if ${Me.FlyingUsingMount}
								call RIMObj.FlyDown
						}
						else
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
						;wait 5
						;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
						wait 20
						_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
						while ${Actor[Query, ID=${_ID}](exists)} && ( ${Me.CastingSpell} ||${Actor[Query, ID=${_ID}].HighlightOnMouseHover} || !${_HighlightOnMouseHover} ) && ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
						{
							if ${RI_Var_Bool_BreakPathFunction}
							{
								RI_Var_Bool_BreakPathFunction:Set[0]
								return
							}
							call RIMObj.CheckCombat
							relay ${RI_Var_String_RelayGroup} Actor[${_ID}]:DoTarget
							wait 5
							if ${_DontRelayClick}
								Actor[${_ID}]:DoubleClick
							else
								relay ${RI_Var_String_RelayGroup} Actor[${_ID}]:DoubleClick
							wait 5 ${Me.CastingSpell}
							wait 50 !${Me.CastingSpell}
							wait 2
							;echo ${Time}: Before: ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]}
							;echo ${Trigger} // ${TriggerMessage}
							wait 15
							if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
							{
								_AmountHarvested.Get[${Math.Calc[${_count}+2]}]:Inc
								;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
								echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
								Trigger:Set[FALSE]
							}
							if ${_CheckNotQuestStep} && !${RIObj.QuestStepExists[${_QuestStep}]}
							{
								_AmountHarvested.Get[${Math.Calc[${_count}+2]}]:Inc
								;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
								echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
								Trigger:Set[FALSE]
							}
							
							if ${Trigger}
							{
								_AmountHarvested.Get[${Math.Calc[${_count}+2]}]:Inc
								echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
								Trigger:Set[FALSE]
								wait 1
							}
							if ${Actor[Query, ID=${_ID}].Distance}>${_Precision}
								call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
							;echo ${Time}: After: ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]}
						}
						wait 5
						if ${Me.WaterDepth}>0
							call SwimUp
						if ${_IWasFlying}
						{
							press -hold ${RI_Var_String_FlyUpKey}
							wait 1
							press -release ${RI_Var_String_FlyUpKey}
							_IWasFlying:Set[FALSE]
						}
						call RIMObj.CheckCombat
						call RIMObj.Move ${_temp} 1 0 FALSE TRUE TRUE FALSE
					}
				}
				if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
				{
					_AmountHarvested.Get[${Math.Calc[${_count}+2]}]:Inc
					;echo ISXRI: Killed ${_AmountKilled.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
					echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
					Trigger:Set[FALSE]
				}
				if ${Trigger}
				{
					_AmountHarvested.Get[${Math.Calc[${_count}+2]}]:Inc
					echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
					Trigger:Set[FALSE]
				}
			}
			_count:Inc
			_count:Inc
		}
		call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
		_AllQuantitiesMet:Set[TRUE]
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			_count:Inc
			_count:Inc
			;echo ${_count}: ${_AmountHarvested.Get[${_count}]}<${args[${_count}]}
			if ${_AmountHarvested.Get[${_count}]}<${args[${_count}]}
				_AllQuantitiesMet:Set[FALSE]
		}
		; if ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet}
		; {
			; MainArrayCounter:Set[${_end}]
			; echo TimeToEnd
		; }
		if ( ${MainArrayCounter}==${_end} && ${_GoReverseAtLoopOrEnd} ) || ( ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet} )
		{
			MainArrayCounter:Dec
			for(;${MainArrayCounter}>=${_start};MainArrayCounter:Dec)
			{
				if ${RI_Var_Bool_BreakPathFunction}
				{
					RI_Var_Bool_BreakPathFunction:Set[0]
					return
				}
				call RIMObj.CheckCombat
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					;check for our node and if we are
					if ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
					{
						if ${args[${_count}].Left[10].Equal[TintFlags-]} && ${_HighlightOnMouseHover}
							_Query:Set["TintFlags=${args[${_count}].Right[-10]} && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
						elseif ${args[${_count}].Left[10].Equal[TintFlags-]}
							_Query:Set["TintFlags=${args[${_count}].Right[-10]} && Distance<=${_Distance}"]
						elseif ${_HighlightOnMouseHover}
							_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && HighlightOnMouseHover=TRUE && Type!=\"NPC\" && Type!=\"NamedNPC\""]
						else
							_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && Type!=\"NPC\" && Type!=\"NamedNPC\""]

						;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
						if ${_Query.Find["Gaukr Sandstorm's Treasure"](exists)} || ${_Query.Find["Hreidar Lynhillig's Treasure"](exists)}
							_DontRelayClick:Set[1]
						_ID:Set[${Actor[Query, ${_Query}].ID}]
						if ${_ID}>0 && ( !${Zone.Name.Find["Plane of Innovation: Security Measures [Tradeskill]"](exists)} || ${Actor[id,${_ID}].Distance[${Actor[NPC,"an innovative guard"].Loc}]}>10 )
						{
							;_ID:Set[${Actor[Query, ${_Query}].ID}]
							;echo if ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							if ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+${_YINC}]},${Actor[Query, ID=${_ID}].Z}]}
							{
								_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
								if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
								{
									if ${Me.FlyingUsingMount}
										_IWasFlying:Set[TRUE]
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
									if ${Me.FlyingUsingMount}
										call RIMObj.FlyDown
								}
								else
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
								wait 20
								_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
								while ${Actor[Query, ID=${_ID}](exists)} && ( ${Me.CastingSpell} || ${Actor[Query, ID=${_ID}].HighlightOnMouseHover} || !${_HighlightOnMouseHover} ) && ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
								{
									if ${RI_Var_Bool_BreakPathFunction}
									{
										RI_Var_Bool_BreakPathFunction:Set[0]
										return
									}
									call RIMObj.CheckCombat
									relay ${RI_Var_String_RelayGroup} Actor[${_ID}]:DoTarget
									wait 5
									if ${_DontRelayClick}
										Actor[${_ID}]:DoubleClick
									else
										relay ${RI_Var_String_RelayGroup} Actor[${_ID}]:DoubleClick
									wait 5 ${Me.CastingSpell}
									wait 50 !${Me.CastingSpell}
									wait 2
									;echo ${Time}: Before: ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]}
									;echo ${Trigger} // ${TriggerMessage}
									wait 15
									if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
									{
										_AmountHarvested.Get[${Math.Calc[${_count}+2]}]:Inc
										;echo ISXRI: Killed ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
										echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
										Trigger:Set[FALSE]
									}
									if ${Trigger}
									{
										_AmountHarvested.Get[${Math.Calc[${_count}+2]}]:Inc
										;echo ISXRI: Harvested ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
										echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
										Trigger:Set[FALSE]
										wait 1
									}
									;echo ${Time}: After: ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]}
									if ${Actor[Query, ID=${_ID}].Distance}>${_Precision}
										call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} ${_Precision} 0 FALSE FALSE TRUE FALSE TRUE TRUE
								}
								wait 5
								if ${Me.WaterDepth}>0
									call SwimUp
								if ${_IWasFlying}
								{
									press -hold ${RI_Var_String_FlyUpKey}
									wait 1
									press -release ${RI_Var_String_FlyUpKey}
									_IWasFlying:Set[FALSE]
								}
								call RIMObj.CheckCombat
								call RIMObj.Move ${_temp} 1 0 FALSE TRUE TRUE FALSE
							}
						}
						if ${_CheckQuestStep} && ${RIObj.QuestStepExists[${_QuestStep}]}
						{
							_AmountHarvested.Get[${Math.Calc[${_count}+2]}]:Inc
							;echo ISXRI: Killed ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
							echo ISXRI: Triggered: ${_QuestStep} from ${_tempName}
							Trigger:Set[FALSE]
						}
						if ${Trigger}
						{
							_AmountHarvested.Get[${Math.Calc[${_count}+2]}]:Inc
							echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
							Trigger:Set[FALSE]
						}
					}
					_count:Inc
					_count:Inc
				}
				call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
				_AllQuantitiesMet:Set[TRUE]
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					_count:Inc
					_count:Inc
					;echo ${_count}: ${_AmountHarvested.Get[${_count}]}<${args[${_count}]}
					if ${_AmountHarvested.Get[${_count}]}<${args[${_count}]}
						_AllQuantitiesMet:Set[FALSE]
				}
			}
			;if !${_Loop}
				MainArrayCounter:Set[${_end}]
		}
		if ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
		{
			;echo looping because ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
			MainArrayCounter:Set[${_start}]
		}
	}
	press -release ${RI_Var_String_ForwardKey}
	AnnounceText:Clear
	Trigger:Set[FALSE]
}
function PathFlyHarvest(int _PathLines, int _Distance, bool _Loop, bool _GoReverseAfterAllQuantitiesMet, bool _GoReverseAtLoopOrEnd, bool _HighlightOnMouseHover=FALSE, ... args)
{	
	Trigger:Set[FALSE]
	if ${RI_Var_Bool_PathDebug}
		variable string echostr="int _PathLines=${_PathLines}, int _Distance=${_Distance}, bool _Loop=${_Loop}, bool _GoReverseAfterAllQuantitiesMet=${_GoReverseAfterAllQuantitiesMet}, bool _GoReverseAtLoopOrEnd=${_GoReverseAtLoopOrEnd}, ... args="
	;string _Node, int _Quantity,
	variable int _start
	variable int _end
	variable int _count
	variable string _Query
	variable int _ID
	variable string _tempName
	variable string _temp
	variable index:int _AmountHarvested
	variable bool _AllQuantitiesMet
	variable bool _IWasFlying=FALSE
	variable int _YINC=2
	AnnounceText:Clear
	IncomingText:Clear
	IncomingText2:Clear
		
	if ${QuestJournalWindow.ActiveQuest["Borrowing From The Dead"](exists)}
		AnnounceText:Insert[I found some rusty armor scraps]
	if ${QuestJournalWindow.ActiveQuest["Dying of Bore-dom"](exists)}
	{
		AnnounceText:Insert["You notice larvae in the soil!"]
		AnnounceText:Insert["I didn't find any adult beetles, but I did find larvae"]
	}
	if ${QuestJournalWindow.ActiveQuest["Process of Elimination"](exists)}
		AnnounceText:Insert["fungal samples"]
	if ${QuestJournalWindow.ActiveQuest["The Final Blow"](exists)}	
		AnnounceText:Insert["arcanna'se precious metal"]
	if ${QuestJournalWindow.ActiveQuest["Kunark Ascending: History in Stone"](exists)}
	{
		if ${args[1].Equal[stolen pylon]}
			_YINC:Set[5]
	}
	_start:Set[${MainArrayCounter}]
	
	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		if ${RI_Var_Bool_PathDebug}
			echostr:Concat["${_count}: ${args[${_count}]} ${Math.Calc[${_count}+1].Precision[0]}: ${args[${Math.Calc[${_count}+1]}]} ${Math.Calc[${_count}+2].Precision[0]}: ${args[${Math.Calc[${_count}+2]}]}"]
		_AmountHarvested:Insert[0]
		_AmountHarvested:Insert[0]
		_AmountHarvested:Insert[0]
		;echo ${args[${Math.Calc[${_count}+1]}]} // ${args[${Math.Calc[${_count}+1]}].Find[AT-](exists)}
		if ${args[${Math.Calc[${_count}+1]}].Equal[0]}
		{
			AnnounceText:Insert[You have]
			AnnounceText:Insert[You receive]
		}
		elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[AT-]}
			AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
		elseif ${args[${Math.Calc[${_count}+1]}].Left[3].Equal[IT-]}
			IncomingText:Insert[${args[${Math.Calc[${_count}+1]}].Right[-3]}]
		else
			AnnounceText:Insert[${args[${Math.Calc[${_count}+1]}]}]
		_count:Inc
		_count:Inc
	}
	if ${RI_Var_Bool_PathDebug}
		echo ${echostr}
	if ${RI_Var_Bool_PathDebug}
	{
		for(_count:Set[1];${_count}<=${AnnounceText.Used};_count:Inc)
		{
			echo Announce: ${AnnounceText.Get[${_count}]}
		}
		for(_count:Set[1];${_count}<=${IncomingText.Used};_count:Inc)
		{
			echo IncomingText: ${IncomingText.Get[${_count}]}
		}
		echo Qty's:
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			_count:Inc
			_count:Inc
			echo ${args[${_count}]}
		}
	}
	_end:Set[${Math.Calc[${MainArrayCounter}+${_PathLines}]}]
	for(;${MainArrayCounter}<=${_end};MainArrayCounter:Inc)
	{
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			call RIMObj.CheckCombat
			;check for our node and if we are
			;echo 1: ${args[${Math.Calc[${_count}+0]}]}
			;echo 2: ${args[${Math.Calc[${_count}+1]}]}
			;echo 3: ${args[${Math.Calc[${_count}+2]}]}
			if ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
			{
				if ${args[${_count}].Left[10].Equal[TintFlags-]} && ${_HighlightOnMouseHover}
					_Query:Set["TintFlags=${args[${_count}].Right[-10]} && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
				elseif ${args[${_count}].Left[10].Equal[TintFlags-]}
					_Query:Set["TintFlags=${args[${_count}].Right[-10]} && Distance<=${_Distance}"]
				elseif ${_HighlightOnMouseHover}
					_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && HighlightOnMouseHover=TRUE && Type!=\"NPC\" && Type!=\"NamedNPC\""]
				else
					_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && Type!=\"NPC\" && Type!=\"NamedNPC\""]
				;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
				if ${Actor[Query, ${_Query}](exists)}
				{
					_ID:Set[${Actor[Query, ${_Query}].ID}]
					;echo if ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
					if !${Actor[Query, ID=${_ID}].CheckCollision}
					{
						_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
						; if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
						; {
							; if ${Me.FlyingUsingMount}
								; _IWasFlying:Set[TRUE]
							; call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
							; if ${Me.FlyingUsingMount}
								; call RIMObj.FlyDown
						; }
						; else
							call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
						;wait 5
						;call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
						wait 20
						_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
						while ${Actor[Query, ID=${_ID}](exists)} && ( ${Actor[Query, ID=${_ID}].HighlightOnMouseHover} || !${_HighlightOnMouseHover} ) && ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
						{
							call RIMObj.CheckCombat
							relay ${RI_Var_String_RelayGroup} Actor[${_ID}]:DoTarget
							wait 5
							relay ${RI_Var_String_RelayGroup} Actor[${_ID}]:DoubleClick
							wait 5 ${Me.CastingSpell}
							wait 50 !${Me.CastingSpell}
							wait 2
							;echo ${Time}: Before: ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]}
							;echo ${Trigger} // ${TriggerMessage}
							if ${Trigger}
							{
								_AmountHarvested.Get[${Math.Calc[${_count}+2]}]:Inc
								echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
								Trigger:Set[FALSE]
							}
							if ${Actor[Query, ID=${_ID}].Distance}>2
								call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
							;echo ${Time}: After: ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]}
						}
						wait 5
						if ${Trigger}
						{
							_AmountHarvested.Get[${Math.Calc[${_count}+2]}]:Inc
							echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
							Trigger:Set[FALSE]
						}
						; if ${_IWasFlying}
						; {
							; press -hold ${RI_Var_String_FlyUpKey}
							; wait 1
							; press -release ${RI_Var_String_FlyUpKey}
							; _IWasFlying:Set[FALSE]
						; }
						call RIMObj.Move ${_temp} 1 0 FALSE FALSE TRUE FALSE
					}
				}
			}
			_count:Inc
			_count:Inc
		}
		call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
		_AllQuantitiesMet:Set[TRUE]
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			_count:Inc
			_count:Inc
			;echo ${_count}: ${_AmountHarvested.Get[${_count}]}<${args[${_count}]}
			if ${_AmountHarvested.Get[${_count}]}<${args[${_count}]}
				_AllQuantitiesMet:Set[FALSE]
		}
		; if ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet}
		; {
			; MainArrayCounter:Set[${_end}]
			; echo TimeToEnd
		; }
		if ( ${MainArrayCounter}==${_end} && ${_GoReverseAtLoopOrEnd} ) || ( ${_GoReverseAfterAllQuantitiesMet} && ${_AllQuantitiesMet} )
		{
			MainArrayCounter:Dec
			for(;${MainArrayCounter}>=${_start};MainArrayCounter:Dec)
			{
				call RIMObj.CheckCombat
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					;check for our node and if we are
					if ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
					{
						if ${args[${_count}].Left[10].Equal[TintFlags-]} && ${_HighlightOnMouseHover}
							_Query:Set["TintFlags=${args[${_count}].Right[-10]} && Distance<=${_Distance} && HighlightOnMouseHover=TRUE"]
						elseif ${args[${_count}].Left[10].Equal[TintFlags-]}
							_Query:Set["TintFlags=${args[${_count}].Right[-10]} && Distance<=${_Distance}"]
						elseif ${_HighlightOnMouseHover}
							_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && HighlightOnMouseHover=TRUE && Type!=\"NPC\" && Type!=\"NamedNPC\""]
						else
							_Query:Set["Name=-\"${args[${_count}]}\" && Distance<=${_Distance} && Type!=\"NPC\" && Type!=\"NamedNPC\""]

						;echo ${_Query} // ${Actor[Query, ${_Query}](exists)}
						if ${Actor[Query, ${_Query}](exists)}
						{
							_ID:Set[${Actor[Query, ${_Query}].ID}]
							;echo if ( ( ${Me.FlyingUsingMount} && (${Me.Y}<${Actor[Query, ID=${_ID}].Y} && ${Math.Distance[${Me.Y},${Actor[Query, ID=${_ID}].Y}]}<5 ) || ${Me.Y}>${Actor[Query, ID=${_ID}].Y} ) || !${Me.FlyingUsingMount} )&& !${EQ2.CheckCollision[${Me.Loc},${Actor[Query, ID=${_ID}].X},${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]},${Actor[Query, ID=${_ID}].Z}]}
							if !${Actor[Query, ID=${_ID}].CheckCollision}
							{
								_temp:Set["${Me.X} ${Me.Y} ${Me.Z}"]
								; if ( ${Me.FlyingUsingMount} || ${Me.WaterDepth}>0 )
								; {
									; if ${Me.FlyingUsingMount}
										; _IWasFlying:Set[TRUE]
									; call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Me.Y} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
									; if ${Me.FlyingUsingMount}
										; call RIMObj.FlyDown
								; }
								; else
									call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
								wait 20
								_tempName:Set[${Actor[Query, ID=${_ID}].Name}]
								while ${Actor[Query, ID=${_ID}](exists)} && ( ${Actor[Query, ID=${_ID}].HighlightOnMouseHover} || !${_HighlightOnMouseHover} ) && ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]}<${args[${Math.Calc[${_count}+2]}]}
								{
									call RIMObj.CheckCombat
									relay ${RI_Var_String_RelayGroup} Actor[${_ID}]:DoTarget
									wait 5
									relay ${RI_Var_String_RelayGroup} Actor[${_ID}]:DoubleClick
									wait 5 ${Me.CastingSpell}
									wait 50 !${Me.CastingSpell}
									wait 2
									;echo ${Time}: Before: ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]}
									;echo ${Trigger} // ${TriggerMessage}
									if ${Trigger}
									{
										_AmountHarvested.Get[${Math.Calc[${_count}+2]}]:Inc
										;echo ISXRI: Harvested ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]} of ${_tempName}
										echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
										Trigger:Set[FALSE]
									}
									;echo ${Time}: After: ${_AmountHarvested.Get[${Math.Calc[${_count}+2]}]}
									if ${Actor[Query, ID=${_ID}].Distance}>2
										call RIMObj.Move ${Actor[Query, ID=${_ID}].X} ${Math.Calc[${Actor[Query, ID=${_ID}].Y}+1]} ${Actor[Query, ID=${_ID}].Z} 2 0 FALSE FALSE TRUE FALSE TRUE TRUE
								}
								wait 5
								if ${Trigger}
								{
									_AmountHarvested.Get[${Math.Calc[${_count}+2]}]:Inc
									echo ISXRI: Triggered: ${TriggerMessage} from ${_tempName}
									Trigger:Set[FALSE]
								}
								; if ${_IWasFlying}
								; {
									; press -hold ${RI_Var_String_FlyUpKey}
									; wait 1
									; press -release ${RI_Var_String_FlyUpKey}
									; _IWasFlying:Set[FALSE]
								; }
								call RIMObj.Move ${_temp} 1 0 FALSE FALSE TRUE FALSE
							}
						}
					}
					_count:Inc
					_count:Inc
				}
				call RIMObj.Move ${istrMain.Get[${MainArrayCounter}]} 1 0 0 0 1 1 1 1
				_AllQuantitiesMet:Set[TRUE]
				for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
				{
					_count:Inc
					_count:Inc
					;echo ${_count}: ${_AmountHarvested.Get[${_count}]}<${args[${_count}]}
					if ${_AmountHarvested.Get[${_count}]}<${args[${_count}]}
						_AllQuantitiesMet:Set[FALSE]
				}
			}
			;if !${_Loop}
				MainArrayCounter:Set[${_end}]
		}
		if ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
		{
			;echo looping because ${_Loop} && ${MainArrayCounter}==${_end} && !${_AllQuantitiesMet}
			MainArrayCounter:Set[${_start}]
		}
	}
	press -release ${RI_Var_String_ForwardKey}
	AnnounceText:Clear
	Trigger:Set[FALSE]
}
function CastAbility(... args)
{
	variable string _AbilityName
	variable string _AbilityID=1

	variable int _acnt=0
	for(_acnt:Set[1];${_acnt}<=${args.Used};_acnt:Inc)
	{
		;echo args ${_acnt} : ${args[${_acnt}]}
		switch ${args[${_acnt}]}
		{
			case -ID
			{
				_AbilityID:Set[${args[${Math.Calc[${_acnt}+1]}]}]
				break
			}
			case -Name
			{
				_AbilityName:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
		}
	}
	;echo ${_AbilityID} // ${_AbilityName}
	do
	{
		;echo eq2execute useability ${_AbilityName}
		;echo Me.Ability[id,${_AbilityID}]:Use
		;eq2execute useability ${_AbilityName}
		if !${Me.CastingSpell}
		{
			Me.Ability[id,${_AbilityID}]:Use
			eq2execute clearabilityqueue
		}
		wait 2 ${Me.CastingSpell} || !${Me.Ability[id,${_AbilityID}].IsReady}

		if ${Me.CastingSpell} && ${Me.GetGameData[Spells.Casting].Label.Equal["${_AbilityName}"]}
			break
		wait 3
	}
	while ${Me.Ability[id,${_AbilityID}].IsReady} && !${Me.CastingSpell} && ${GiveUpCnt:Inc}<=5 && ${Me.GetGameData[Spells.Casting].Label.NotEqual[${_AbilityName}]}
}
function SwimUp(float YLoc=0)
{
	if !${RI_Var_Bool_GlobalOthers} && ${YLoc}==0
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call SwimUp"]
	relay ${RI_Var_String_RelayGroup} press -hold ${RI_Var_String_FlyUpKey}
	if ${YLoc}==0
	{
		while ${Me.WaterDepth}>=3
		{
			relay ${RI_Var_String_RelayGroup} press -hold ${RI_Var_String_FlyUpKey}
			wait 2
		}
		wait 50
	}
	else
	{
		while ${Math.Distance[${Me.Y},${YLoc}]}>5
		{
			relay ${RI_Var_String_RelayGroup} press -hold ${RI_Var_String_FlyUpKey}
			wait 2
		}
	}
	relay ${RI_Var_String_RelayGroup} press -release ${RI_Var_String_FlyUpKey}
	wait 50
}
function SwimDown(int _Wait)
{
	press -hold ${RI_Var_String_FlyDownKey}
	wait ${_Wait}
	press -release ${RI_Var_String_FlyDownKey}
}
function MoveToActor(string _ActorName, int _Precision=2, bool _SkipCollisionCheck=FALSE)
{
	if ${_ActorName.Find[TintFlags-](exists)}
	{
		if ${Actor[Query, "${_ActorName.Replace[-,=]}"](exists)}
			call RIMObj.Move ${Actor[Query, "${_ActorName.Replace[-,=]}"].X} ${Math.Calc[${Actor[Query, "${_ActorName.Replace[-,=]}"].Y}+2]} ${Actor[Query, "${_ActorName.Replace[-,=]}"].Z} ${_Precision} 0 0 0 1 0 1 ${_SkipCollisionCheck}
	}
	else
	{
		if ${Actor[Query, Name=-"${_ActorName}"](exists)}
			call RIMObj.Move ${Actor[Query, Name=-"${_ActorName}"].X} ${Math.Calc[${Actor[Query, Name=-"${_ActorName}"].Y}+2]} ${Actor[Query, Name=-"${_ActorName}"].Z} ${_Precision} 0 0 0 1 0 1 ${_SkipCollisionCheck}
	}
}
function MoveToActorHail(string _ActorName, int _Precision=2, bool _SkipCollisionCheck=FALSE)
{
	if ${Actor[Query, Name=-"${_ActorName}"](exists)}
		call RIMObj.Move ${Actor[Query, Name=-"${_ActorName}"].X} ${Math.Calc[${Actor[Query, Name=-"${_ActorName}"].Y}+2]} ${Actor[Query, Name=-"${_ActorName}"].Z} ${_Precision} 0 0 0 1 0 1 ${_SkipCollisionCheck}
	Actor[${_ActorName}]:DoTarget
	wait 1
	Actor[${_ActorName}]:DoTarget
	wait 2
	eq2ex hail
	wait 2
	eq2ex hail
}
function JumpUp(float _X, float _Y, float _Z, float _YTarget, int _FaceDegree, int _GiveUpCNT=10, bool _RelayToGroup=TRUE)
{
	;echo JumpUp(float _X=${_X}, float _Y=${_Y}, float _Z=${_Z}, float _YTarget=${_YTarget}, int _FaceDegree=${_FaceDegree}, int _GiveUpCNT=10==${_GiveUpCNT}, bool _RelayToGroup=TRUE==${_RelayToGroup})
	RIMUIObj:SetLockSpot[OFF]
	RIMUIObj:SetRIFollow[OFF]
	if ${_RelayToGroup} && !${RI_Var_Bool_GlobalOthers}
	{
		relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[OFF]
		relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetRIFollow[OFF]
		relay "other ${RI_Var_String_RelayGroup}" Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call RIMObj.JumpUp ${_X} ${_Y} ${_Z} ${_YTarget} ${_FaceDegree} ${_GiveUpCNT}"]
	}
	wait 5
	call RIMObj.JumpUp ${_X} ${_Y} ${_Z} ${_YTarget} ${_FaceDegree} ${_GiveUpCNT}
	if ${_RelayToGroup}
	{
		wait 150 ${RIMObj.AllGroupWithinRange[5]}
	}
	wait 20
}
function LongJumpOver(float _X, float _Y, float _Z, int _FaceDegree)
	{	
		;variable int _Cnt=0
		;while ${Me.Y}<${_YTarget} && ${_Cnt:Inc}<=${_GiveUpCNT}
		;{
			if ${Math.Distance[${Me.Loc},${_X},${_Y},${_Z}]}>3
				call This.Move ${_X} ${_Y} ${_Z} 1 0 1 1 1 0 1 1
			press -hold ${RI_Var_String_BackwardKey}
			waitframe
			waitframe
			press -release ${RI_Var_String_BackwardKey}
			Face ${_FaceDegree}
			wait 2
			;jump part
			press ${RI_Var_String_JumpKey}
			wait 2
			;${Me.Y}>${_YTarget}
			press -hold ${RI_Var_String_ForwardKey}
			wait 5
			press -release ${RI_Var_String_ForwardKey}
			;wait 10
		;}
	}
function JumpOver(float _X, float _Y, float _Z, int _FaceDegree, bool _RelayToGroup=TRUE)
{	
	RIMUIObj:SetLockSpot[OFF]
	RIMUIObj:SetRIFollow[OFF]
	if ${_RelayToGroup} && !${RI_Var_Bool_GlobalOthers}
	{
		relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[OFF]
		relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetRIFollow[OFF]
		relay "other ${RI_Var_String_RelayGroup}" Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call RIMObj.JumpOver ${_X} ${_Y} ${_Z} ${_FaceDegree}"]
	}
	wait 5
	call RIMObj.JumpOver ${_X} ${_Y} ${_Z} ${_FaceDegree}
	if ${_RelayToGroup}
	{
		wait 150 ${RIMObj.AllGroupWithinRange[5]}
	}
	wait 20
}
function WaitUntilAllGroupWithinRange(... args)
{
	
	variable int _Range=3
	variable int _WaitTime=150
	
	variable int _acnt=0
	for(_acnt:Set[1];${_acnt}<=${args.Used};_acnt:Inc)
	{
		;echo args ${_acnt} : ${args[${_acnt}]}
		switch ${args[${_acnt}]}
		{
			case -Range
			{
				_Range:Set[${args[${Math.Calc[${_acnt}+1]}]}]
				break
			}
			case -WaitTime
			{
				_WaitTime:Set[${args[${Math.Calc[${_acnt}+1]}]}]
				break
			}
		}
	}
	echo ISXRI: Waiting Until All Group Within ${_Range}
	wait ${_WaitTime} ${RIMObj.AllGroupWithinRange[${_Range}]}
	echo ISXRI: Done Waiting
}
function CheckPreReqs(... args)
{
	;echo start
	variable int _count
	variable int _count2
	variable index:string _Fails
	variable index:item _Items
	variable bool _Failed
	variable int _ItemCount=0
	variable string _FailMessage
	for(_count:Set[1];${_count}<=${args.Size};_count:Inc)
	{
		;echo ${_count}
		if ${args[${_count}].Upper.Equal[-COMPLETED]}
		{
			;echo ${args[${_count}]} // ${args[${Math.Calc[${_count}+1]}]}
			if !${QuestJournalWindow.CompletedQuest["${args[${Math.Calc[${_count}+1]}]}"](exists)}
			{
				_Failed:Set[TRUE]
				_Fails:Insert["You need to have completed ${args[${Math.Calc[${_count}+1]}]}"]
			}
			_count:Inc
		}
		if ${args[${_count}].Upper.Equal[-ACTIVE]}
		{
			;echo ${args[${_count}]} // ${args[${Math.Calc[${_count}+1]}]}
			if !${QuestJournalWindow.ActiveQuest["${args[${Math.Calc[${_count}+1]}]}"](exists)} && !${QuestJournalWindow.CompletedQuest["${args[${Math.Calc[${_count}+1]}]}"](exists)}
			{
				_Failed:Set[TRUE]
				_Fails:Insert["You need to have started or completed ${args[${Math.Calc[${_count}+1]}]}"]
			}
			_count:Inc
		}
		if ${args[${_count}].Upper.Equal[-ITEMQTY]}
		{
			;echo ${args[${_count}]} // ${args[${Math.Calc[${_count}+1]}]} // ${args[${Math.Calc[${_count}+2]}]}
			;echo ${RIMUIObj.InventoryQuantity["${args[${Math.Calc[${_count}+1]}]}"]}<${Int[${args[${Math.Calc[${_count}+2]}]}]}
			_ItemCount:Set[${RIMUIObj.InventoryQuantity["${args[${Math.Calc[${_count}+1]}]}"]}]
			if ${_ItemCount}<${Int[${args[${Math.Calc[${_count}+2]}]}]}
			{
				_Failed:Set[TRUE]
				_Fails:Insert["You must have at least ${args[${Math.Calc[${_count}+2]}]} of ${args[${Math.Calc[${_count}+1]}]} and you have ${_ItemCount}"]
			}
			_count:Inc
			_count:Inc
		}
		if ${args[${_count}].Upper.Equal[-EQUIPPED]}
		{
			;echo ${args[${_count}]} // ${args[${Math.Calc[${_count}+1]}]} // ${args[${Math.Calc[${_count}+2]}]}
			if !${Me.Equipment["${args[${Math.Calc[${_count}+1]}]}"](exists)}
			{
				_Failed:Set[TRUE]
				_Fails:Insert["You must be wearing ${args[${Math.Calc[${_count}+2]}]} get them and put them on then resume"]
			}
			_count:Inc
			_count:Inc
		}
		;echo end loop
	}
	if ${_Failed}
	{
		RI_Var_Bool_SSSGTG:Set[FALSE]
		for(_count:Set[1];${_count}<=${_Fails.Used};_count:Inc)
		{
			if ${_count}<${_Fails.Used}
				_FailMessage:Concat["${_Fails.Get[${_count}]}\n"]
			else
				_FailMessage:Concat["${_Fails.Get[${_count}]}"]
		}
		MessageBox -skin eq2 "${_FailMessage}"
		if !${RI_Var_Bool_SSSInScript}
			MainArrayCounter:Set[${Math.Calc[${MainArrayCounter}-2]}]
		RI_Var_Bool_Paused:Set[TRUE]
		UIElement[Start@RI]:SetText[Resume]
		while ${RI_Var_Bool_Paused}
		{
			wait 1
		}
	}
	elseif ${RI_Var_Bool_SSSInScript}
		RI_Var_Bool_SSSGTG:Set[TRUE]
}
function TFB(string _What)
{
	if ${_What.Upper.Equal[COLLECTION]}
		MessageBox -skin eq2 "This has not been coded yet, finish the collection, when done unpause RQ and it will resume the quest."
	elseif ${_What.Upper.Equal[CRAFTING]}
		MessageBox -skin eq2 "You are at the stage where you need other crafters to make you items (or you can buy from broker), do this, and resume RI and it will continue the quest"
	elseif ${_What.Upper.Equal[DALNIR]}
		MessageBox -skin eq2 "You are at the stage where you need finish Crypt of Dalnir, do this, and resume RI and it will continue the quest"
	RI_Var_Bool_Paused:Set[TRUE]
	UIElement[Start@RI]:SetText[Resume]
	while ${RI_Var_Bool_Paused}
	{
		wait 1
	}
	wait 5
}
function RemoveFromDepot(string _DepotName,... args)
{
	; echo RemoveFromDepot(string _DepotName=${_DepotName},... args)
	; echo ${args.Size}
	; for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	; {
		; echo ${args[${_count}]}
	; }
	if ${Actor[Query, Name=-"${_DepotName}" && Distance<=12](exists)} && ${Zone.ShortName.Find[guildhall](exists)}
	{
		Actor[Query, Name=-"${_DepotName}" && Distance<=12]:DoubleClick
		wait 20
		variable int _count
		variable int _qty
		
		for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
		{
			if ${ContainerWindow.Item["${args[${_count}]}"].Quantity}>=${args[${Math.Calc[${_count}+1]}]}
			{
				_qty:Set[${args[${Math.Calc[${_count}+1]}]}]
				do
				{
					ContainerWindow:RemoveItem["${ContainerWindow.Item["${args[${_count}]}"].ID}",${_qty}]
					wait 5
					
				}
				while ${_qty:Dec[200]}>0
				echo ISXRI: Removing ${args[${Math.Calc[${_count}+1]}]} of ${args[${_count}]}
			}
			else
				echo ISXRI: You only have ${Int[${ContainerWindow.Item["${args[${_count}]}"].Quantity}]} of ${args[${_count}]} and you wanted ${args[${Math.Calc[${_count}+1]}]}, skipping
			wait 5
			_count:Inc
		}
		ContainerWindow:Close
	}
	elseif ${Zone.ShortName.Find[guildhall](exists)}
	{
		MessageBox -skin eq2 "You are more than 12 away from the ${_DepotName} depot, please move closer and unpause RQ"
		RI_Var_Bool_Paused:Set[TRUE]
		MainArrayCounter:Dec
		MainArrayCounter:Dec
		UIElement[Start@RI]:SetText[Resume]
		while ${RI_Var_Bool_Paused}
		{
			wait 1
		}
		wait 5
	}
	else
		echo ISXRI: We are not in a guild hall, skipping Remove From Depot
}
function CheckZoneVersion(string _ActorName)
{
	;echo CheckZoneVersion(string _ActorName=${_ActorName})
	variable int _ID 
	_ID:Set[${Actor[Query, Name=-"${_ActorName}"].ID}]
	wait 2
	if ${Actor[id,${_ID}](exists)}
	{
		;echo exists: ${_ID}
		;wait until we are out of combat
		if ${StopForCombat}
			call RIMObj.CheckCombat
		wait 10
		;pause bots
		RI_CMD_PauseCombatBots 1
		wait 5
		Actor[${_ID}]:DoubleClick
		wait 5
		Actor[${_ID}]:DoubleClick
		wait 5
		Actor[${_ID}]:DoubleClick
		wait 5 ${Me.CastingSpell}
		wait 50 !${Me.CastingSpell}
	}
	wait 5
	RI_CMD_PauseCombatBots 0

	call RIMObj.follow
	
	if ${Zone.Name.Find["[Solo]"](exists)}
		return
	
	if ${Script[Buffer:RZ](exists)}
	{
		;echo RZ Exists // ${RZ_Var_String_ZoneVersion}
		switch ${RZ_Var_String_ZoneVersion}
		{
			case Expert
			{	
				;echo exprt
				RIMUIObj:ReplyDialog[ALL,Expert]
				break
			}
			case Heroic
			{
				;echo heroic
				RIMUIObj:ReplyDialog[ALL,Normal]
				break
			}
			case Challenge
			{
				;echo chlg
				RIMUIObj:ReplyDialog[ALL,Challenge]
				break
			}
		}
	}
	else
	{
		RIMUIObj:ReplyDialog[ALL,Normal]
	}
	wait 10
	relay ${RI_Var_String_RelayGroup} RIMUIObj:ZoneVersion[ALL]
}
function ReplyDialog(... args)
{
	if (!${ReplyDialog.Replies(exists)}	|| ${args.Used}<1)
		return
    
	variable index:collection:string Options
    variable iterator OptionsIterator
    variable int OptionCounter = 0
	variable int _CNT
	variable bool _OnlyMain=FALSE
	for(_CNT:Set[1];${_CNT}<=${args.Used};_CNT:Inc)
	{
		if ${args[${_CNT}].Equal[-OnlyMain]}
		{
			_OnlyMain:Set[1]
		}
	}
	for(_CNT:Set[1];${_CNT}<=${args.Used};_CNT:Inc)
	{
		if ${args[${_CNT}].Equal[-OnlyMain]}
		{
			continue
		}
		OptionCounter:Set[0]
		if ${Int[${args[${_CNT}]}]}>0
		{
			if ${_OnlyMain}
				ReplyDialog:Choose[${Int[${args[${_CNT}]}]}]
			else
				relay ${RI_Var_String_RelayGroup} ReplyDialog:Choose[${Int[${args[${_CNT}]}]}]
		}
		else
		{
			ReplyDialog.Replies:GetOptions[Options]
			Options:GetIterator[OptionsIterator]
			
			;echo "The current reply dialog window has ${Options.Used} reply options available"
			
			if (${OptionsIterator:First(exists)})
			{
				do
				{
					if (${OptionsIterator.Value.FirstKey(exists)})
					{
						do
						{
							if ${OptionsIterator.Value.CurrentValue.Find["${args[${_CNT}]}"]}
							{
								if ${_OnlyMain}
									ReplyDialog:Choose[${Math.Calc[${OptionCounter}+1]}]
								else
									relay ${RI_Var_String_RelayGroup} ReplyDialog:Choose[${Math.Calc[${OptionCounter}+1]}]
							}
							;echo "Option #${OptionCounter}::  '${OptionsIterator.Value.CurrentKey}' // '${OptionsIterator.Value.CurrentValue}' // ${args[${_CNT}]} // ${OptionsIterator.Value.CurrentValue.Find["${args[${_CNT}]}"]}"
						}
						while ${OptionsIterator.Value.NextKey(exists)}
						;echo "------"
					}
					OptionCounter:Inc
				}
				while ${OptionsIterator:Next(exists)}
			}
		}
		wait 5
	}
}
function ZoomCamera(bool _In)
{
	if ${_In}
	{
		;zoomin
		MouseWheel -10000
		wait 5
		MouseWheel 10000
	}
	else
	{
		;zoomout
		MouseWheel -10000
	}
}
function PlaceHouseItem(int _FaceDegree=${Me.Heading})
{
	Face ${_FaceDegree}
	wait 2
	;change camera
	Press -hold ${RI_Var_String_LookDownKey}
	wait 10
	
	;move mouse to just above center of screen aka on top of you and up
	Mouse:SetPosition[${Math.Calc[${Display.Width}/2]},${Math.Calc[(${Display.Height}/2)-((${Display.Height}/2)*.1)]}]
	wait 1
	Mouse:SetPosition[${Math.Calc[${Display.Width}/2]},${Math.Calc[(${Display.Height}/2)-((${Display.Height}/2)*.1)]}]
	wait 1
	;click to place
	Mouse:LeftClick
	wait 1
	Mouse:LeftClick
	wait 1
	wait 5
	
	;change camera
	Press -release ${RI_Var_String_LookDownKey}
	Press -hold ${RI_Var_String_LookUpKey}
	wait 3
	Press -release ${RI_Var_String_LookUpKey}
}
function MessageBox(string _Message, bool _Pause=1)
{
	RIConsole:Echo["${_Message}"]
	MessageBox -skin eq2 "${_Message}"
	if ${_Pause}
	{
		RI_Var_Bool_Paused:Set[TRUE]
		UIElement[Start@RI]:SetText[Resume]
		while ${RI_Var_Bool_Paused}
		{
			wait 1
		}
	}
	wait 5
}
function ApplyVerb(... args)
{
	variable bool _TintFlags=FALSE
	variable bool _RelayToGroup=FALSE
	variable string _Actor
	variable string _Verb
	variable int _acnt
	for(_acnt:Set[1];${_acnt}<=${args.Used};_acnt:Inc)
	{
		;backwards compatibility
		if ${_acnt}<3 && ${args[1].Left[1].NotEqual[-]}
		{
			_Actor:Set["${args[1]}"]
			if ${args[2].Left[1].NotEqual[-]}
			{
				_Verb:Set["${args[2]}"]
			}
		}
		
		;echo args ${_acnt} : ${args[${_acnt}]}
		switch ${args[${_acnt}]}
		{
			case -Actor
			{
				_Actor:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -Verb
			{
				_Verb:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -TintFlags
			{
				_TintFlags:Set[1]
				break
			}
			case -RelayToGroup
			{
				_RelayToGroup:Set[1]
				break
			}
		}
	}
	if ${_TintFlags}
	{
		;echo \${Actor[Query, TintFlags=${_Actor}](exists)} // ${Actor[Query, TintFlags=${_Actor}](exists)}
		if ${Actor[Query, TintFlags=${_Actor}](exists)}
		{
			if ${_RelayToGroup}
			{
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[OFF]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetRIFollow[OFF]
				relay ${RI_Var_String_RelayGroup} eq2ex apply_verb ${Actor[Query, TintFlags=${_Actor}].ID} "${_Verb}"
			}
			else
			{
				RIMUIObj:SetLockSpot[OFF]
				RIMUIObj:SetRIFollow[OFF]
				eq2ex apply_verb ${Actor[Query, TintFlags=${_Actor}].ID} "${_Verb}"
			}
		}
	}
	else
	{
		if ${Actor[Query, Name=-"${_Actor}"](exists)}
		{
			if ${_RelayToGroup}
			{
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[OFF]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetRIFollow[OFF]
				relay ${RI_Var_String_RelayGroup} eq2ex apply_verb ${Actor[Query, Name=-"${_Actor}"].ID} "${_Verb}"
			}
			else
			{
				RIMUIObj:SetLockSpot[OFF]
				RIMUIObj:SetRIFollow[OFF]
				eq2ex apply_verb ${Actor[Query, Name=-"${_Actor}"].ID} "${_Verb}"
			}
		}
	}
}
function ReaversSigCheck()
{
	if ${QuestJournalWindow.ActiveQuest[Kunark Ascending: Seeking Reassurance](exists)}
	{
		;go to the guy and hail him then go back to the spot
		call RIMObj.Move -0.384015 -1.754801 -1115.690796 1 0 0 0 1 1 1 1
		call RIMObj.Move -17.538403 -4.995497 -1135.468994 1 0 0 0 1 1 1 1
		call RIMObj.Move -17.917027 -5.219389 -1158.058960 1 0 0 0 1 1 1 1
		call RIMObj.Move -16.785690 -4.971283 -1177.287109 1 0 0 0 1 1 1 1
		call RIMObj.Move -0.729423 -4.971283 -1178.138306 1 0 0 0 1 1 1 1
		call RIMObj.Move -0.321138 -5.149948 -1207.141235 1 0 0 0 1 1 1 1
		call RIMObj.Move 12.802125 -5.149916 -1219.629150 1 0 0 0 1 1 1 1
		call RIMObj.Move 35.759937 -5.149971 -1216.970337 1 0 0 0 1 0 1 1
		CustomLoc:Set["0 0 0"]
		call HailActor Chosooth 14
		call RIMObj.Move 11.669339 -5.149916 -1218.828125 1 0 0 0 1 1 1 1
		call RIMObj.Move -0.584382 -5.165592 -1200.475830 1 0 0 0 1 1 1 1
		call RIMObj.Move -0.992143 -4.971283 -1179.257568 1 0 0 0 1 1 1 1
		call RIMObj.Move -17.032045 -4.971283 -1177.873047 1 0 0 0 1 1 1 1
		call RIMObj.Move -16.716248 -4.995886 -1131.974243 1 0 0 0 1 1 1 1
		call RIMObj.Move 6.298306 -1.754801 -1118.231689 1 0 0 0 1 1 1 1
	}
	if ${QuestJournalWindow.ActiveQuest[Awakening Bonds: Whispers of the Past](exists)}
	{
		call RIMObj.Move -0.384015 -1.754801 -1115.690796 1 0 0 0 1 1 1 1
		call RIMObj.Move -17.538403 -4.995497 -1135.468994 1 0 0 0 1 1 1 1
		call RIMObj.Move -17.917027 -5.219389 -1158.058960 1 0 0 0 1 1 1 1
		call RIMObj.Move -16.785690 -4.971283 -1177.287109 1 0 0 0 1 1 1 1
		call RIMObj.Move -0.729423 -4.971283 -1178.138306 1 0 0 0 1 1 1 1
		call RIMObj.Move -0.321138 -5.149948 -1207.141235 1 0 0 0 1 1 1 1
		call RIMObj.Move -5.120276 -5.149990 -1214.553955 1 0 0 0 1 1 1 1
		call RIMObj.Move -5.840823 -5.149997 -1225.532959 1 0 0 0 1 0 1 1
		CustomLoc:Set["0 0 0"]
		call ClickActor TintFlags-27761
		call RIMObj.Move -5.120276 -5.149990 -1214.553955 1 0 0 0 1 1 1 1
		call RIMObj.Move -0.584382 -5.165592 -1200.475830 1 0 0 0 1 1 1 1
		call RIMObj.Move -0.992143 -4.971283 -1179.257568 1 0 0 0 1 1 1 1
		call RIMObj.Move -17.032045 -4.971283 -1177.873047 1 0 0 0 1 1 1 1
		call RIMObj.Move -16.716248 -4.995886 -1131.974243 1 0 0 0 1 1 1 1
		call RIMObj.Move 6.298306 -1.754801 -1118.231689 1 0 0 0 1 1 1 1
	}
}
function TargetUntilAnnounce(string _TargetName, int _Distance, string _Announce)
{
	TriggerMessage:Set[""]
	AnnounceText:Clear
	AnnounceText:Insert["${_Announce}"]
	while !${TriggerMessage.Find["${_Announce}"](exists)}
	{
		if ${Actor[Query, Name=-"${_TargetName}" && Distance<=${_Distance} && IsDead=FALSE](exists)}
			Actor[Query, Name=-"${_TargetName}" && Distance<=${_Distance} && IsDead=FALSE]:DoTarget
		waitframe
	}
}
function TargetUntilQuestStepExists(string _TargetName, int _Distance, string _QuestStep)
{
	TriggerMessage:Set[""]
	while !${RIObj.QuestStepExists["${_QuestStep}"]}
	{
		if ${Actor[Query, Name=-"${_TargetName}" && Distance<=${_Distance} && IsDead=FALSE](exists)}
			Actor[Query, Name=-"${_TargetName}" && Distance<=${_Distance} && IsDead=FALSE]:DoTarget
		wait 2
	}
}

function Instance(string _InstanceName="${Me.GetGameData[Self.ZoneName].Label.Replace[" ",""].Replace["'",""].Replace[":",""].Replace["[",,""].Replace["]",""].Replace["\,",""]}")
{
	variable string _ConvertedQuestName
	variable string _QuestName
	variable int _OriginalMAC
	if !${InstanceMode(exists)}
		declare InstanceMode bool script TRUE
	else
		InstanceMode:Set[TRUE]
	_OriginalMAC:Set[${MainArrayCounter}]
	RI_Var_Bool_QuestMode:Set[FALSE]
	press -release ${RI_Var_String_ForwardKey}
	declare _FP filepath "${LavishScript.HomeDirectory}/Scripts/RI/ZoneFiles/"

	relay ${RI_Var_String_RelayGroup} RI_CMD_Hidden_AddTLO ${_InstanceName}
	
	wait 50 ${${_InstanceName}[3rtZdjv7,1](exists)}
	
	if !${${_InstanceName}[3rtZdjv7,1](exists)}
	{
		;echo dne
		;echo ${_InstanceName}
		;echo _InstanceName:Set["${RIObj.ConvertedZoneName["${_InstanceName}"]}"]
		_InstanceName:Set["${RIObj.ConvertedZoneName["${_InstanceName}"]}"]
		;echo ${_InstanceName}
		;echo relay ${RI_Var_String_RelayGroup} RI_CMD_Hidden_AddTLO ${_InstanceName}
		relay ${RI_Var_String_RelayGroup} RI_CMD_Hidden_AddTLO ${_InstanceName}
	
		wait 50 ${${_InstanceName}[3rtZdjv7,1](exists)}
		
	}
	;echo ${_InstanceName}
	
	if ${${_InstanceName}[3rtZdjv7,1](exists)}
	{
		relay ${RI_Var_String_RelayGroup} -noredirect _PreGo_ "${_InstanceName}" 0
		wait 5
		wait 50 ${istrMain.Used}>0
		if ${RI_Var_Bool_GlobalOthers}
			return
		if ${_InstanceName.Find["SandstoneDeltaEyeoftheStorm"]}
		{
			;Sans Manifested Sands
            if ${QuestJournalWindow.ActiveQuest["Sans Manifested Sands"](exists)}
            {
                RI_Var_Bool_GrabShinys:Set[1]
                call AddShinyActor "Sands of Clarity"
                call AddShinyActor "Sands of Supremacy"
            }
		}
		if ${_InstanceName.Find["SandstoneDeltaEyeofNight"]}
		{
			;Sand By Me
            if ${QuestJournalWindow.ActiveQuest["Sand By Me"](exists)}
            {
                RI_Var_Bool_GrabShinys:Set[1]
                call AddShinyActor "Sands of Zealotry"
                call AddShinyActor "Sands of Blessing"
                call AddShinyActor "Sands of Secrets"
            }
		}
		if ${_InstanceName.Find["TakishBadlandsOvergrowth"]}
		{
			;Renewal of Ro: Tailing Dragons
			if ${QuestJournalWindow.ActiveQuest["Renewal of Ro: Tailing Dragons"](exists)}
			{
				RI_Var_Bool_GrabShinys:Set[1]
				call AddShinyActor "Spell-shaped Stone"
			}
			;Overgrowth Seed Stealers
            if ${QuestJournalWindow.ActiveQuest["Overgrowth Seed Stealers"](exists)}
            {
                RI_Var_Bool_GrabShinys:Set[1]
                call AddShinyActor "Jar of Seeds"
            }
		}
		if ${_InstanceName.Find["SandstoneDeltaEyeofNight"]}
		{
			;Renewal of Ro: Illusion From the Disillusioned // Sandstone Delta: Eye of Night
			if ${QuestJournalWindow.ActiveQuest["Renewal of Ro: Illusion From the Disillusioned"](exists)}
			{
				RI_Var_Bool_GrabShinys:Set[1]
				call AddShinyActor "Eye of Night Ward"
				call AddShinyActor "Night Metal"
			}
		}
		if ${_InstanceName.Find["RajDurPlateausTheSultansDagger"]}
		{
			;Taskish Tablets for the Taking
            if ${QuestJournalWindow.ActiveQuest["Taskish Tablets for the Taking"](exists)}
            {
                RI_Var_Bool_GrabShinys:Set[1]
                call AddShinyActor "Stolen Ancient Tablet"
            }
		}
		call LootOptions RoundRobin
		relay ${RI_Var_String_RelayGroup} RI_CMD_Assist 1 ${Me.Name}
		MainArrayCounter:Set[0]
		echo ISXRI: Starting ${Me.GetGameData[Self.ZoneName].Label}
			
		call Go TRUE
		
		echo ISXRI: Ending ${Me.GetGameData[Self.ZoneName].Label}

		RI_CMD_Hidden_RemoveTLO ${_InstanceName}
	}
	elseif ${_FP.FileExists[${_InstanceName}.dat]}
	{
		relay ${RI_Var_String_RelayGroup} -noredirect ImportZoneFile "${_InstanceName}" 0
		wait 5
		wait 50 ${istrMain.Used}>0
		if ${RI_Var_Bool_GlobalOthers}
			return

		if ${_InstanceName.Find["TakishBadlandsOvergrowth"]}
		{
			;Renewal of Ro: Tailing Dragons
			if ${QuestJournalWindow.ActiveQuest["Renewal of Ro: Tailing Dragons"](exists)}
			{
				RI_Var_Bool_GrabShinys:Set[1]
				call AddShinyActor "Spell-shaped Stone"
			}
		}
		if ${_InstanceName.Find["SandstoneDeltaEyeofNight"]}
		{
			;Renewal of Ro: Illusion From the Disillusioned // Sandstone Delta: Eye of Night
			if ${QuestJournalWindow.ActiveQuest["Renewal of Ro: Illusion From the Disillusioned"](exists)}
			{
				RI_Var_Bool_GrabShinys:Set[1]
				call AddShinyActor "Eye of Night Ward"
				call AddShinyActor "Night Metal"
			}
		}
		call LootOptions RoundRobin
		relay ${RI_Var_String_RelayGroup} RI_CMD_Assist 1 ${Me.Name}
		MainArrayCounter:Set[0]
		echo ISXRI: Starting ${Me.GetGameData[Self.ZoneName].Label}
			
		call Go TRUE
		
		echo ISXRI: Ending ${Me.GetGameData[Self.ZoneName].Label}

		RI_CMD_Hidden_RemoveTLO ${_InstanceName}
	}
	else
		call MessageBox "${Me.GetGameData[Self.ZoneName].Label} is not coded, run manually and resume at exit door" 1
	
	;echo _QuestName:Set["${MainQuestName.Get[${MainQuestName.Used}]}"]
	_QuestName:Set["${MainQuestName.Get[${MainQuestName.Used}]}"]

	_ConvertedQuestName:Set["${_QuestName.Replace[".",""].Replace["(",""].Replace[")",""].Replace["!",""].Replace["'",""].Replace["-",""].Replace[" ",""].Replace["?",""].Replace[",",""].Replace[":",""]}"]

	relay ${RI_Var_String_RelayGroup} RI_CMD_Hidden_AddTLO ${_ConvertedQuestName.Upper}
	
	wait 50 ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
	
	istrMain:Clear
	
	if ${${_ConvertedQuestName.Upper}[3rtZdjv7,1](exists)}
		relay ${RI_Var_String_RelayGroup} -noredirect _PreGo_ "${_ConvertedQuestName.Upper}" 0
	else
		relay ${RI_Var_String_RelayGroup} -noredirect ImportZoneFile "${_ConvertedQuestName}" 0
	wait 5
	wait 50 ${istrMain.Used}>0
	
	MainArrayCounter:Set[${_OriginalMAC}]

	if ${Me.IsMoving}
	{
		press -release ${RI_Var_String_ForwardKey}
	}
	relay ${RI_Var_String_RelayGroup} RI_Var_Bool_QuestMode:Set[TRUE]
	deletevariable InstanceMode
}
function DrusellaSigCheck1()
{
	if ${QuestJournalWindow.ActiveQuest[Kunark Ascending: Resurrection Machination](exists)}
	{
		call UseItem "Middle Shard of an Obulus Medallion"
		wait 5
		call UseItem "Middle Shard of an Obulus Medallion"
		wait 50
		call ReplyDialog 1 1 1
		wait 50
		RI_Var_Bool_SkipLoot:Set[TRUE]
	}
}
function DrusellaSigCheck2()
{
	if ${QuestJournalWindow.ActiveQuest[Kunark Ascending: Resurrection Machination](exists)}
	{
		wait 50
		call MoveToActor TintFlags-7683
		wait 50
		call ClickActor TintFlags-7683
		wait 5
		call ClickActor TintFlags-7683
		wait 5
		call ClickActor TintFlags-7683
		wait 20
		RI_Var_Bool_SkipLoot:Set[FALSE]
	}
}
function PressKey(string _Key, int _HoldTime=1)
{
	press -hold ${_Key}
	wait ${_HoldTime}
	press -release ${_Key}
}
function WaitDeath()
{
	while !${Me.IsDead}
		wait 10
}
function WaitWhileMoving()
{
	while ${Me.IsMoving}
		wait 10
}
function Wait(int _WaitTime=0)
{
	wait ${_WaitTime}
}
function Revive()
{
	eq2ex "select_junction 0"
}
function KAANRGotoQueen()
{
	call MessageBox "Return to your queen!"
}
function Collection(... args)
{
	variable int _count
	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		if ${Me.Inventory[Query, Location=="Inventory" && Name=-"${args[${_count}]}"](exists)}
		{
			if (!${Me.Inventory[Query, Location=="Inventory" && Name=-"${args[${_count}]}"].IsItemInfoAvailable})
				wait 20 ${Me.Inventory[Query, Location=="Inventory" && Name=-"${args[${_count}]}"].IsItemInfoAvailable}
			wait 5
			if ${Me.Inventory[Query, Location=="Inventory" && Name=-"${args[${_count}]}"].IsItemInfoAvailable}
			{
				if ${Me.Inventory[Query, Location=="Inventory" && Name=-"${args[${_count}]}"].ToItemInfo.IsCollectible}
				{
					if !${Me.Inventory[Query, Location=="Inventory" && Name=-"${args[${_count}]}"].ToItemInfo.AlreadyCollected}
					{
						echo ISXRI: Collecting ${Me.Inventory[Query, Location=="Inventory" && Name=-"${args[${_count}]}"].Name}
						Me.Inventory[Query, Location=="Inventory" && Name=-"${args[${_count}]}"]:Examine
						wait 5
						EQ2UIPage[Journals,JournalsQuest].Child[Page,TabPages].Child[2].Child[6].Child[2].Child[1].Child[1]:LeftClick
					}
					else
						echo ISXRI: ${Me.Inventory[Query, Location=="Inventory" && Name=-"${args[${_count}]}"].Name} Already Collected
				}
			}
		}
		wait 1
	}
	EQ2UIPage[Journals,JournalsQuest]:Close
}
function EquipItem(string _ItemName, int _slot=1, bool _StoreOldItem=0)
{
	variable int _count=0
	if ${_ItemName.Upper.Equal[STORED]} && ${OldItemStore(exists)}
	{
		do
		{
			Me.Inventory[Query, Name=-"${OldItemStore}"]:Equip
			wait 5 ${Me.Equipment[${_slot}].Name.Find[${OldItemStore}](exists)}
		}
		while !${Me.Equipment[${_slot}].Name.Find[${OldItemStore}](exists)} && ${_count:Inc}<10
		
		deletevariable OldItemStore
	}
	elseif ${Me.Inventory[Query, Name=-"${_ItemName}"](exists)}
	{
		if ${_StoreOldItem}
			declare OldItemStore string globalkeep "${Me.Equipment[${_slot}].Name}"

		do
		{
			Me.Inventory[Query, Name=-"${_ItemName}"]:Equip
			wait 5 ${Me.Equipment[${_slot}].Name.Find[${_ItemName}](exists)} || ${_slot}==0
		}
		while !${Me.Equipment[${_slot}].Name.Find[${_ItemName}](exists)} && ${_count:Inc}<10 && ${_slot}>0
	}
}
function SummonMount()
{
	if !${Me.OnTransport} && !${Me.OnFlyingMount}
		eq2ex summon_mount
	wait 20
}
function HailCollector()
{
	if !${Actor[Query, Guild=="Collector"](exists)}
		return
	variable int _CollectorID=${Actor[Query, Guild=="Collector"].ID}
	
	RI_CMD_PauseCombatBots 1
	wait 20
	relay ${RI_Var_String_RelayGroup} Actor[${_CollectorID}]:DoFace
	relay ${RI_Var_String_RelayGroup} Actor[${_CollectorID}]:DoFace
	wait 5
	relay ${RI_Var_String_RelayGroup} Actor[${_CollectorID}]:DoTarget
	relay ${RI_Var_String_RelayGroup} Actor[${_CollectorID}]:DoTarget
	wait 5
	relay ${RI_Var_String_RelayGroup} eq2ex hail
	wait 5
	variable int count
	variable string _tempbtntxt
	for(count:Set[1];${count}<=3;count:Inc)
	{
		_tempbtntxt:Set["${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[2].GetProperty[LocalText]}"]
		if ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[2](exists)}
			relay ${RI_Var_String_RelayGroup} -noredirect EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[2]:LeftClick
		wait 5
		wait 20 ( ${EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[2].GetProperty[LocalText].NotEqual["${_tempbtntxt}"]} || !${EQ2UIPage[ProxyActor,Conversation].IsVisible} )
	}
	;unpause bots
	relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 0	
}
function ClimbLadder(int _FaceDegree, int _TopY, int _GiveUpCNT=300)
{
	variable int _count=0
	Face ${_FaceDegree}
	wait 2
	press -hold ${RI_Var_String_ForwardKey}
	while ${Me.Y}<${_TopY} && ${_count:Inc}<=${_GiveUpCNT}
	{
		wait 1
	}
	press -release ${RI_Var_String_ForwardKey}
}
function FaceAndMoveForward(int _FaceDegree, int _StopX, int _StopY, int _StopZ, int _GiveUpCNT=300)
{
	variable int _count=0
	Face ${_FaceDegree}
	wait 2
	press -hold ${RI_Var_String_ForwardKey}
	while ${Math.Distance[${Me.Loc},${_StopX},${_StopY},${_StopZ}]}>5 && ${_count:Inc}<=${_GiveUpCNT}
	{
		wait 1
	}
	press -release ${RI_Var_String_ForwardKey}
}
function TimeStampEcho(string _Message)
{
	echo ISXRI: ${Time} ${_Message}
}
function ZoneDoor(string _Actor, string _DoorOption=-1, bool _LoopUntilNoHighlightOnMouseHover=0, int _GiveUpCNT=50, bool _ExactName=0)
{
	;echo ZoneDoor(string _Actor=${_Actor}, string _DoorOption=-1=${_DoorOption}, int _LoopUntilNoHighlightOnMouseHover=0=${_LoopUntilNoHighlightOnMouseHover}, int _GiveUpCNT=50=${_GiveUpCNT})
	;move to ZoneDoor location
	;stop follow
	variable int _Cnt=0
	variable int _ID

	;echo Moving to ${CustomLoc} and Clicking ${_Actor}
	relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call RIMObj.Move ${CustomLoc} ${Precision} 0 TRUE TRUE TRUE FALSE TRUE"]
	if ${CustomLoc.NotEqual[0 0 0]}
	{
		call RIMObj.Move ${CustomLoc} ${Precision} 0 TRUE TRUE TRUE FALSE TRUE
		wait 20
	}
	call RIMObj.stopfollow
	;make sure _Actor exists so we do not go through the motions for nothign
	;echo \${Actor[Query, Name=-"${_Actor}"](exists)}  //  ${Actor[Query, Name=-"${_Actor}"](exists)}
	if ${_LoopUntilNoHighlightOnMouseHover}
	{
		if ${Actor[Query, Name=-"${_Actor}" && HighlightOnMouseHover=TRUE](exists)} || ${Actor[Query, Name=="${_Actor}"](exists)}
		{
			if ${_ExactName}
				_ID:Set[${Actor[Query, Name=="${_Actor}" && HighlightOnMouseHover=TRUE].ID}]
			else
				_ID:Set[${Actor[Query, Name=-"${_Actor}" && HighlightOnMouseHover=TRUE].ID}]
			;wait until we are out of combat
			if ${StopForCombat}
				call RIMObj.CheckCombat
			wait 10
			;pause bots
			
			relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
			wait 5
			
			if ${_LoopUntilNoHighlightOnMouseHover}
			{
				while ${Actor[${_ID}].HighlightOnMouseHover} && ${_Cnt:Inc} <= ${_GiveUpCNT}
				{
					;echo relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
					relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
					wait 5 ${Me.CastingSpell}
					wait 50 !${Me.CastingSpell}
					wait 5
				}
			}
			else
			{
				;echo relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
				wait 5
				relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
				wait 5
				relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
				wait 5
				relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
			}
		}
	}
	else
	{
		if ${Actor[Query, Name=-"${_Actor}"](exists)} || ${Actor[Query, Name=="${_Actor}"](exists)}
		{
			if ${_ExactName}
				_ID:Set[${Actor[Query, Name=="${_Actor}"].ID}]
			else
				_ID:Set[${Actor[Query, Name=-"${_Actor}"].ID}]
			;wait until we are out of combat
			if ${StopForCombat}
				call RIMObj.CheckCombat
			wait 10
			;pause bots
			
			relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 1
			wait 5
			
			if ${_LoopUntilNoHighlightOnMouseHover}
			{
				while ${Actor[${_ID}].HighlightOnMouseHover} && ${_Cnt:Inc} <= ${_GiveUpCNT}
				{
					;echo relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
					relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
					wait 5 ${Me.CastingSpell}
					wait 50 !${Me.CastingSpell}
				}
			}
			else
			{
				;echo relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
				wait 5
				relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
				wait 5
				relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
				wait 5
				relay ${RI_Var_String_RelayGroup} -noredirect Actor[${_ID}]:DoubleClick
			}
		}

	}
	relay ${RI_Var_String_RelayGroup} -noredirect RI_CMD_PauseCombatBots 0
	
	if ${Int[${_DoorOption}]}==-1
		noop
	else
		call DoorOption "${_DoorOption}"
	wait 50 ${EQ2.Zoning}==1
	if ${EQ2.Zoning}==0
	{
		if ${EQ2UIPage[popup,ZoneTeleporter].IsVisible}
			call DoorOption 0;wait 10
		if ${ChoiceWindow(exists)}
			ChoiceWindow:DoChoice1
	}
	wait 600 ${EQ2.Zoning}==1
	wait 600 ${EQ2.Zoning}==0
}
function Teleporter(float _x, float _y, float _z, int _precision=1, int _maxdistance=20)
{
	if ${Script[Buffer:CoT]}
		endscript Buffer:CoT
	;echo Teleporter(float _x=${_x}, float _y=${_y}, float _z=${_z}, int _precision=1=${_precision}, int _maxdistance=20=${_maxdistance})
	if !${RI_Var_Bool_GlobalOthers}
	{
		wait 20
		call RIMObj.stopfollow
	}
	if !${RI_Var_Bool_GlobalOthers}
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Teleporter ${_x} ${_y} ${_z} ${_precision} ${_maxdistance}"]
	RIMUIObj:SetLockSpot[ALL,${_x},${_y},${_z},${_precision},${_maxdistance}]
	;echo RIMUIObj:SetLockSpot[ALL,${_x},${_y},${_z},${_precision},${_maxdistance}]
	wait 100 ${Math.Distance[${Me.Loc},${_x},${_y},${_z}]}<=${_precision}
	;echo before while ${Math.Distance[${Me.Loc},${_x},${_y},${_z}]}<=${_maxdistance} && !${EQ2.Zoning}
	while ${Math.Distance[${Me.Loc},${_x},${_y},${_z}]}<=${_maxdistance} && !${EQ2.Zoning}
	{
		wait 5
		;echo in while
		press -hold ${RI_Var_String_ForwardKey}
	}
	;echo after while ${Math.Distance[${Me.Loc},${_x},${_y},${_z}]}<=${_precision} && !${EQ2.Zoning}
	press -release ${RI_Var_String_ForwardKey}
	RIMUIObj:SetLockSpot[OFF]
	press -release ${RI_Var_String_ForwardKey}
	wait 600 ${RIMObj.AllGroupWithinRange[10]}
	wait 20
	if !${Script[Buffer:CoT]}
		RI_CoT
}
function ClickTeleporter(string _Actor, float _x, float _y, float _z, string _precision=1,string _maxdistance=20)
{
	if ${Script[Buffer:CoT]}
		endscript Buffer:CoT
	;echo Teleporter(float _x=${_x}, float _y=${_y}, float _z=${_z}, int _precision=1=${_precision}, int _maxdistance=10=${_maxdistance})
	if !${RI_Var_Bool_GlobalOthers}
	{
		wait 20
		call RIMObj.stopfollow
	}
	if !${RI_Var_Bool_GlobalOthers}
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call ClickTeleporter \"${_Actor}\" ${_x} ${_y} ${_z} ${_precision} ${_maxdistance}"]
	RIMUIObj:SetLockSpot[ALL,${_x},${_y},${_z},${_precision},${_maxdistance}]
	wait 100 ${Math.Distance[${Me.Loc},${_x},${_y},${_z}]}<=${_precision}
	;echo before while ${Math.Distance[${Me.Loc},${_x},${_y},${_z}]}<=${_maxdistance} && !${EQ2.Zoning}
	
	while ${Math.Distance[${Me.Loc},${_x},${_y},${_z}]}<=${_maxdistance} && !${EQ2.Zoning}
	{
		wait 5
		;echo in while
		if !${Me.InCombat}
		{
			Actor[exactname,${_Actor}]:DoubleClick
			Actor[${_Actor}]:DoubleClick
		}
		wait 300 !${Me.CastingSpell}
	}
	;echo after while ${Math.Distance[${Me.Loc},${_x},${_y},${_z}]}<=${_precision} && !${EQ2.Zoning}
	RIMUIObj:SetLockSpot[OFF]
	wait 600 ${RIMObj.AllGroupWithinRange[10]}
	wait 20
	if !${Script[Buffer:CoT]}
		RI_CoT
}
function RingEvent(int _Distance, ... args)
{
	variable int _countor
	variable string _Query
	;first build our add's Query
	_Query:Set["( "]

	for(_countor:Set[1];${_countor}<${args.Used};_countor:Inc)
	{
		if ${_countor}==${Math.Calc[${args.Used}-1]}
			_Query:Concat["Name=-\"${args[${_countor}]}\" ) && Distance<=${_Distance} && IsLocked=FALSE && IsDead=FALSE && ( Type==\"NPC\" || Type==\"NamedNPC\" )"]
		else
			_Query:Concat["Name=-\"${args[${_countor}]}\" || "]
	}
	while !${Actor[Query, ${_Query}](exists)}
	{
		if ${Actor[Query, ${_Query}](exists)} && ${Target.ID}!=${Actor[Query, ${_Query}].ID}
			Actor[Query, ${_Query}]:DoTarget
		wait 2
	}
	while ${Actor[Query, ${_Query}](exists)}
	{
		if ${Actor[Query, ${_Query}](exists)} && ${Target.ID}!=${Actor[Query, ${_Query}].ID}
			Actor[Query, ${_Query}]:DoTarget
		wait 2
	}
}
function CloseLootWindow()
{
	if !${RI_Var_Bool_GlobalOthers}
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call CloseLootWindow"]
	variable int failcnt=0
	while ${LootWindow(exists)} && ${failcnt:Inc}<150
	{
		LootWindow:Close
		wait 1
	}
}
function BuyFromVendor(string _VendorName, string _Item, int _Qty)
{
	;echo ${_VendorName}
	wait 20
	relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 1
	wait 20
	relay ${RI_Var_String_RelayGroup} Actor["${_VendorName}"]:DoTarget
	relay ${RI_Var_String_RelayGroup} Actor[${_VendorName}]:DoTarget
	wait 2
	relay ${RI_Var_String_RelayGroup} Actor["${_VendorName}"]:DoTarget
	relay ${RI_Var_String_RelayGroup} Actor[${_VendorName}]:DoTarget
	wait 2
	relay ${RI_Var_String_RelayGroup} Actor["${_VendorName}"]:DoubleClick
	relay ${RI_Var_String_RelayGroup} Actor[${_VendorName}]:DoubleClick
	wait 2
	relay ${RI_Var_String_RelayGroup} Actor["${_VendorName}"]:DoubleClick
	relay ${RI_Var_String_RelayGroup} Actor[${_VendorName}]:DoubleClick
	wait 20
	relay ${RI_Var_String_RelayGroup} MerchantWindow.MerchantInventory["${_Item}"]:Buy[${_Qty}]
	wait 20
	if ${ChoiceWindow(exists)}
		relay ${RI_Var_String_RelayGroup} ChoiceWindow:DoChoice1
	wait 2
	if ${ChoiceWindow(exists)}
		relay ${RI_Var_String_RelayGroup} ChoiceWindow:DoChoice1
	wait 2
	relay ${RI_Var_String_RelayGroup} MerchantWindow:Close
	wait 2
	relay ${RI_Var_String_RelayGroup} MerchantWindow:Close
	wait 2
	relay ${RI_Var_String_RelayGroup} MerchantWindow:Close
	wait 2
	relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 0
}
function RILoot(bool _On)
{
	wait 5
	if ${_On}
		relay ${RI_Var_String_RelayGroup} UIElement[RILootOnCheckbox@RILoot]:SetChecked
	else
		relay ${RI_Var_String_RelayGroup} UIElement[RILootOnCheckbox@RILoot]:UnsetChecked
	wait 5
}
function CancelInvis()
{
	relay ${RI_Var_String_RelayGroup} eq2execute usea Transmute
	wait 10 ${EQ2.ReadyToRefineTransmuteOrSalvage}
	relay ${RI_Var_String_RelayGroup} press esc
}
function CastInvis()
{
	if !${RI_Var_Bool_GlobalOthers}
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call CastInvis"]
	
	switch ${Me.SubClass}
	{
		case beastlord
		{
			Me.Ability[id,3010698346]:Use
			break
		}
		case dirge
		{
			Me.Ability[id,2958443420]:Use
			break
		}
		case ranger
		{
			Me.Ability[id,601425776]:Use
			break
		}
		case swashbuckler
		{
			Me.Ability[id,978081226]:Use
			break
		}
		case assassin
		{
			Me.Ability[id,601425776]:Use
			break
		}
		case troubador
		{
			Me.Ability[id,2958443420]:Use
			break
		}
		case brigand
		{
			Me.Ability[id,978081226]:Use
			break
		}
	}
}
function CheckQuestStep(string _Step, int _ArrayCounterSetter=0, bool _Exists=TRUE, bool _IsNotChecked=FALSE)
{
    variable index:collection:string Details    
    variable iterator DetailsIterator
    variable int DetailsCounter = 0
    variable bool _FoundIt = FALSE'
	variable bool _Checked = FALSE
;    echo "Journal Current Quest:"
;    echo "- Name: ${QuestJournalWindow.CurrentQuest.Name.GetProperty["LocalText"]}"
;    echo "- Level: ${QuestJournalWindow.CurrentQuest.Level.GetProperty["LocalText"]}"
;    echo "- Category: ${QuestJournalWindow.CurrentQuest.Category.GetProperty["LocalText"]}"
;    echo "- CurrentZone: ${QuestJournalWindow.CurrentQuest.CurrentZone.GetProperty["LocalText"]}"
;    echo "- TimeStamp: ${QuestJournalWindow.CurrentQuest.TimeStamp.GetProperty["LocalText"]}"
;    echo "- MissionGroup: ${QuestJournalWindow.CurrentQuest.MissionGroup.GetProperty["LocalText"]}"
;    echo "- Status: ${QuestJournalWindow.CurrentQuest.Status.GetProperty["LocalText"]}"
;    echo "- ExpirationTime: ${QuestJournalWindow.CurrentQuest.ExpirationTime.GetProperty["LocalText"]}"
;    echo "- Body: ${QuestJournalWindow.CurrentQuest.Body.GetProperty["LocalText"]}"
    
    QuestJournalWindow.CurrentQuest:GetDetails[Details]
    Details:GetIterator[DetailsIterator]
;    echo "- Details:"
    if (${DetailsIterator:First(exists)})
    {
        do
        {
			_Checked:Set[FALSE]
            if (${DetailsIterator.Value.FirstKey(exists)})
            {
                do
                {
                    ; echo "-- ${DetailsCounter}::  '${DetailsIterator.Value.CurrentKey}' => '${DetailsIterator.Value.CurrentValue}'"
					;echo \${DetailsIterator.Value.CurrentValue.Find[${_Step}](exists)} // ${DetailsIterator.Value.CurrentValue}
					if ${DetailsIterator.Value.CurrentKey.Equal[Check]} && ${DetailsIterator.Value.CurrentValue.Find[true](exists)}
						_Checked:Set[TRUE]
					if ${DetailsIterator.Value.CurrentKey.Equal[Text]} && ${DetailsIterator.Value.CurrentValue.Find[${_Step}](exists)}
						_FoundIt:Set[TRUE]
                }
                while ${DetailsIterator.Value.NextKey(exists)}
                ; echo "------"
            }
            DetailsCounter:Inc
        }
        while ${DetailsIterator:Next(exists)} && !${_FoundIt}
    }
	if ${_FoundIt} && ${_Exists}
	{
		if ${_IsNotChecked}
		{
			if !${_Checked}
			{
				if ${_ArrayCounterSetter}>0
					MainArrayCounter:Set[${_ArrayCounterSetter}]
				else
					call MessageBox "The quest step: ${_Step} is not checked / Get to this step and resume at this spot"
			}
			else
				return
		}
		else
		{
			if ${_ArrayCounterSetter}>0
				MainArrayCounter:Set[${_ArrayCounterSetter}]
			else
				call MessageBox "We are not on the correct quest step: ${_Step} / Get to this step and resume at this spot"
		}
	}
	elseif !${_FoundIt} && !${_Exists}
	{
		if ${_ArrayCounterSetter}>0
			MainArrayCounter:Set[${_ArrayCounterSetter}]
		else
			call MessageBox "We are not on the correct quest step: ${_Step} / Get to this step and resume at this spot"
	}
	;else
	;	echo didnt find it
}
function SetMainArrayCounter(int _ArrayCounterSetter=0)
{
	MainArrayCounter:Set[${_ArrayCounterSetter}]
}
function WaitForQuestStep(string _QuestStep=-1)
{
	if ${_QuestStep.Equals[-1]}
	{
		echo ISXRI: No quest step was passed in, returning
		return
	}

	echo ISXRI: Waiting for Quest Step: ${_QuestStep}

	while !${RIMUIObj.QuestStepExists["${_QuestStep}"]}
		wait 2
}
function WaitForIncomingText(... args)
{
	IncomingText:Clear
	Trigger:Set[0]
	variable int _count
	
	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		IncomingText:Insert[${args[${_count}]}]
	}
	while !${Trigger}
		wait 2
}
function WaitForAnnounceText(... args)
{
	AnnounceText:Clear
	Trigger:Set[0]
	variable int _count	
	variable string MyLoc
	MyLoc:Set["${Me.X},${Me.Y},${Me.Z}"]
	for(_count:Set[1];${_count}<=${args.Used};_count:Inc)
	{
		if ${args[${_count}].Left[1].Equal[-]}
		{
			if ${args[${_count}].Equal[-LockSpot]}
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${MyLoc},1,500]
		}
		else
			AnnounceText:Insert["${args[${_count}]}"]
	}
	
	while !${Trigger}
		wait 2
		
	wait 20
	
	wait 100 ${Me.Distance["${MyLoc}"]}<3
	Trigger:Set[0]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[OFF]
}
function WaitForScript(string _ScriptName)
{
	while ${Script[${_ScriptName}](exists)}
	{
		wait 1
	}
}
function LockAndClickActor(... args)
{
	;echo start
	variable string _XYZ="${Me.Loc}"
	variable string _Actor
	variable int _Precision=1
	variable int _Max=100
	variable int _WaitAfter=0
	variable int _Wait=150
	variable bool _RelayToGroup=0
	variable int _acnt
	variable int _AllGroupWithinRange=0
	variable int _WaitAGWR=0
	variable string _ForWho=!NA!
	variable bool _ClickUntilIMove=FALSE
	variable string _MyLoc
	variable string _Args=""
	for(_acnt:Set[1];${_acnt}<=${args.Used};_acnt:Inc)
	{
		if ${args[${_acnt}].Find[" "]}
		{
			if ${_acnt}==${args.Used}
				_Args:Concat["\"${args[${_acnt}]}\""]
			else
				_Args:Concat["\"${args[${_acnt}]}\" "]
		}
		else
		{
			if ${_acnt}==${args.Used}
				_Args:Concat["${args[${_acnt}]}"]
			else
				_Args:Concat["${args[${_acnt}]} "]
		}
		;echo args ${_acnt} : ${args[${_acnt}]}
		switch ${args[${_acnt}]}
		{
			case -FORWHO
			{
				_ForWho:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -LOC
			{
				_XYZ:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -Precision
			{
				_Precision:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -RelayToGroup
			{
				_RelayToGroup:Set[1]
				break
			}
			case -Max
			{
				_Max:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -WaitAfter
			{
				_WaitAfter:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -Wait
			{
				_Wait:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -AllGroupWithinRange
			{
				_AllGroupWithinRange:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				_WaitAGWR:Set["${args[${Math.Calc[${_acnt}+2]}]}"]
				break
			}
			case -Actor
			{
				_Actor:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -ClickUntilIMove
			{
				_ClickUntilIMove:Set[1]
			}
		}
	}
	if ${_RelayToGroup} && !${RI_Var_Bool_GlobalOthers}
	{
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call LockAndClickActor ${_Args}"]
		relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetRIFollow[OFF]
	}
	if ${_ForWho.NotEqual["!NA!"]} && !${RIMUIObj.ForWhoCheck[${_ForWho}]}
		return
	RIMUIObj:SetLockSpot[ALL,${_XYZ},${_Precision},${_Max}]
	;echo Waiting
	;echo wait 150 \${Math.Distance[${Me.Loc},${_XYZ}]}<=${_Precision}  // ${Math.Distance[${Me.Loc},${_XYZ}]}<=${_Precision}
	_acnt:Set[0]
	while ${Me.Distance2D[${_XYZ.Token[1,","]},${_XYZ.Token[3,","]}]}>${_Precision} && ${_acnt:Inc}<${_Wait}
	{
		RIMUIObj:SetLockSpot[ALL,${_XYZ},${_Precision},${_Max}]
		wait 1
	}
	;wait ${_Wait} ${Me.Distance2D[${_XYZ.Token[1,","]},${_XYZ.Token[3,","]}]}<=${_Precision}
	;squelch echo done waiting
	waitframe
	wait ${_WaitAfter}
	if ${_AllGroupWithinRange}>0
		wait ${_WaitAGWR} ${RIMObj.AllGroupWithinRange[${_AllGroupWithinRange}]}
	CustomLoc:Set[0 0 0]
	wait ${_WaitAfter}
	if ${_ClickUntilIMove}
	{
		_MyLoc:Set["${Me.Loc}"]
		while ${Me.Distance[${_MyLoc}]}<1
		{
			Actor[${_Actor}]:DoubleClick
			wait 1
		}
		eq2ex cancel_spellcast
	}
	else
		call ClickActor -Actor "${_Actor}"	
	
	RIMUIObj:SetLockSpot[ALL,OFF]
	
	if ${_AllGroupWithinRange}>0
		wait ${_WaitAGWR} ${RIMObj.AllGroupWithinRange[${_AllGroupWithinRange}]}
	wait ${WaitAfter}
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	;echo end
}
function LockAndWait(... args)
{
	variable string _XYZ
	variable int _Precision=1
	variable int _Max=100
	variable int _WaitAfter=0
	variable int _Wait=150
	variable bool _RelayToGroup=0
	variable int _acnt
	variable int _AllGroupWithinRange=0
	variable int _WaitAGWR=0
	variable string _ForWho=!NA!
	for(_acnt:Set[1];${_acnt}<=${args.Used};_acnt:Inc)
	{
		;echo args ${_acnt} : ${args[${_acnt}]}
		switch ${args[${_acnt}]}
		{
			case -FORWHO
			{
				_ForWho:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -LOC
			{
				_XYZ:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -Precision
			{
				_Precision:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -RelayToGroup
			{
				_RelayToGroup:Set[1]
				break
			}
			case -Max
			{
				_Max:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -WaitAfter
			{
				_WaitAfter:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -Wait
			{
				_Wait:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				break
			}
			case -AllGroupWithinRange
			{
				_AllGroupWithinRange:Set["${args[${Math.Calc[${_acnt}+1]}]}"]
				_WaitAGWR:Set["${args[${Math.Calc[${_acnt}+2]}]}"]
				break
			}
		}
	}
	if ${_ForWho.NotEqual["!NA!"]} && !${RIMUIObj.ForWhoCheck[${_ForWho}]}
		return
	if ${_RelayToGroup}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_XYZ},${_Precision},${_Max}]
	else
		RIMUIObj:SetLockSpot[ALL,${_XYZ},${_Precision},${_Max}]
	;echo Waiting
	;echo wait 150 \${Math.Distance[${Me.Loc},${_XYZ}]}<=${_Precision}  // ${Math.Distance[${Me.Loc},${_XYZ}]}<=${_Precision}
	_acnt:Set[0]
	while ${Me.Distance2D[${_XYZ.Token[1,","]},${_XYZ.Token[3,","]}]}>${_Precision} && ${_acnt:Inc}<${_Wait}
	{
		if ${_RelayToGroup}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_XYZ},${_Precision},${_Max}]
		else
			RIMUIObj:SetLockSpot[ALL,${_XYZ},${_Precision},${_Max}]
		wait 1
	}
	;wait ${_Wait} ${Me.Distance2D[${_XYZ.Token[1,","]},${_XYZ.Token[3,","]}]}<=${_Precision}
	;squelch echo done waiting
	waitframe
	wait ${_WaitAfter}
	if ${_AllGroupWithinRange}>0
		wait ${_WaitAGWR} ${RIMObj.AllGroupWithinRange[${_AllGroupWithinRange}]}
	noop
}

function SkipLoot(int _On=0)
{
	relay ${RI_Var_String_RelayGroup} RI_Var_Bool_SkipLoot:Set[${_On}]
}
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; End OF Quest CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

function HammyOLDTOV()
{
	;target and pull
	if !${RI_Var_Bool_GlobalOthers}
		target Hammy
	;wait until hammy is to us
	while ${Actor[Hammy].Distance}>10
	{ 
	;need to add an isaggro check 
		if ${Math.Distance[${Me.X},${Me.Y},${Me.Z},-126.527992,-110.023376,74.592873]}>2
			call RIMObj.Move -126.527992 -110.023376 74.592873 ${Precision} 0 FALSE FALSE TRUE FALSE TRUE
		wait 2
		if !${RI_Var_Bool_GlobalOthers}
			target Hammy
	}
	while ${Actor[Query, Name=-"Hammy" && IsAggro=FALSE](exists)}
		wait 1
	while ${Actor[Hammy](exists)} && ${Start}
	;need to add someway for it not to end the fight when hammy changes
	{
		;starting movement for hammy
		if !${Actor[hog_trap](exists)}
		{
			;move to crate 1
			call RIMObj.Move -110 -110.023376 79 ${Precision} 0 FALSE FALSE TRUE FALSE TRUE
			wait 10
			while ${Actor[a storage crate].Distance}<5
			{
				wait 5
				call ExecuteQueued
			}
			wait 20
		}
		;check for hog trap
		if !${Actor[hog_trap](exists)}
		{
			;move to crate 2
			call RIMObj.Move -110 -110.023376 58 ${Precision} 0 FALSE FALSE TRUE FALSE TRUE
			wait 10
			while ${Actor[a storage crate].Distance}<5 && ${Start}
			{
				wait 5
				call ExecuteQueued
			}
			wait 20
		}
		;check for hog trap
		if !${Actor[hog_trap](exists)}
		{
			;move to crate 3
			call RIMObj.Move -110 -110.023376 42 ${Precision} 0 FALSE FALSE TRUE FALSE TRUE
			wait 10
			while ${Actor[a storage crate].Distance}<5 && ${Start}
			{
				wait 5
				call ExecuteQueued
			}
			wait 20
		}
		;check for hog trap
		if !${Actor[hog_trap](exists)}
		{
			;move to crate 4
			call RIMObj.Move -93 -110.023376 40 ${Precision} 0 FALSE FALSE TRUE FALSE TRUE
			wait 10
			while ${Actor[a storage crate].Distance}<5 && ${Start}
			{
				wait 5
				call ExecuteQueued
			}
			wait 20
		}
		;check for hog trap
		if !${Actor[hog_trap](exists)}
		{
			;move to crate 5
			call RIMObj.Move -93 -110.023376 53 ${Precision} 0 FALSE FALSE TRUE FALSE TRUE
			wait 10
			while ${Actor[a storage crate].Distance}<5 && ${Start}
			{
				wait 5
				call ExecuteQueued
			}
			wait 20
		}
		;check for hog trap
		if !${Actor[hog_trap](exists)}
		{
			;move to crate 6
			call RIMObj.Move -82 -110 42 ${Precision} 0 FALSE FALSE TRUE FALSE TRUE
			wait 10
			while ${Actor[a storage crate].Distance}<5 && ${Start}
			{
				wait 5
				call ExecuteQueued
			}
			wait 20
		}
		;check for hog trap
		if !${Actor[hog_trap](exists)}
		{
			;move to crate 7
			call RIMObj.Move -57 -110.023376 47 ${Precision} 0 FALSE FALSE TRUE FALSE TRUE
			wait 10
			while ${Actor[a storage crate].Distance}<5 && ${Start}
			{
				wait 5
				call ExecuteQueued
			}
			wait 20
		}
		;check for hog trap
		if !${Actor[hog_trap](exists)}
		{
			;move to crate 8
			call RIMObj.Move -63 -110.023376 85 ${Precision} 0 FALSE FALSE TRUE FALSE TRUE
			wait 10
			while ${Actor[a storage crate].Distance}<5 && ${Start}
			{
				wait 5
				call ExecuteQueued
			}
			wait 20
		}
		;check for hog trap
		if !${Actor[hog_trap](exists)}
		{
			;move to crate 9
			call RIMObj.Move -85 -110.023376 61 ${Precision} 0 FALSE FALSE TRUE FALSE TRUE
			wait 10
			while ${Actor[a storage crate].Distance}<5 && ${Start}
			{
				wait 5
				call ExecuteQueued
			}
			wait 20
		}
		;check for hog trap
		if !${Actor[hog_trap](exists)}
		{
			;move to crate 10
			call RIMObj.Move -83 -110.023376 93 ${Precision} 0 FALSE FALSE TRUE FALSE TRUE
			wait 10
			while ${Actor[a storage crate].Distance}<5 && ${Start}
			{
				wait 5
				call ExecuteQueued
			}
			wait 20
		}
		;check for hog trap
		if !${Actor[hog_trap](exists)}
		{
			;move to crate 11
			call RIMObj.Move -124 -110.023376 20 ${Precision} 0 FALSE FALSE TRUE FALSE TRUE
			wait 10
			while ${Actor[a storage crate].Distance}<5 && ${Start}
			{
				wait 5
				call ExecuteQueued
			}
			wait 20
		}
		;check for hog trap
		if !${Actor[hog_trap](exists)}
		{
			;move to crate 12
			call RIMObj.Move -131 -110.023376 49 ${Precision} 0 FALSE FALSE TRUE FALSE TRUE
			wait 10
			while ${Actor[a storage crate].Distance}<5 && ${Start}
			{
				wait 5
				call ExecuteQueued
			}
			wait 20
		}
	}
}


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; Start of KA RAID CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
function Blackreaver()
{
	echo ISXRI: Starting Black Reaver
	while !${Me.InCombat} && !${Target.InCombatMode}
		wait 5
	if ${Me.Archetype.Equal[fighter]}
	{
		RIMUIObj:SetLockSpot[ALL,-177.693054,29.179466,-350.950958]
		while ${Math.Distance[${Me.Loc},-177.693054,29.179466,-350.950958]}>3
			wait 1
		wait 5
		RIMUIObj:SetLockSpot[OFF]
	}
	else
	{
		RIMUIObj:SetLockSpot[ALL,-178.088577,29.087303,-341.900818]
	}
	while ${Actor[Query, Name=="A Black Reaver" && Distance<=100](exists)}
	{
		if ${Me.Archetype.Equal[fighter]}
		{
			if ${Actor[Query, Name=-"a Black Stone Shard" && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"a Black Stone Shard" && IsDead=FALSE].ID}
					Actor[Query, Name=="a Black Stone Shard" && IsDead=FALSE]:DoTarget
			}
			else
			{
				if ${Target.ID}!=${Actor[Query, Name=="A Black Reaver" && Distance<=100].ID}
					Actor[Query, Name=="A Black Reaver" && IsDead=FALSE && Distance<=100]:DoTarget
			}
		}
		if ${RIMUIObj.MainIconIDExists[${Me.ID},496]}
		{
			RIMUIObj:SetLockSpot[ALL,-177.750214,29.526823,-320.352386]
			while ${RIMUIObj.MainIconIDExists[${Me.ID},496]}
			{
				if ${Me.Archetype.Equal[fighter]}
				{
					if ${Actor[Query, Name=-"a Black Stone Shard" && IsDead=FALSE](exists)}
					{
						if ${Target.ID}!=${Actor[Query, Name=-"a Black Stone Shard" && IsDead=FALSE].ID}
							Actor[Query, Name=="a Black Stone Shard" && IsDead=FALSE]:DoTarget
					}
					else
					{
						if ${Target.ID}!=${Actor[Query, Name=="A Black Reaver" && Distance<=100].ID}
							Actor[Query, Name=="A Black Reaver" && IsDead=FALSE && Distance<=100]:DoTarget
					}
				}
				wait 2
			}
			if ${Me.Archetype.Equal[fighter]}
			{
				RIMUIObj:SetLockSpot[ALL,-177.693054,29.179466,-350.950958]
				while ${Math.Distance[${Me.Loc},-177.693054,29.179466,-350.950958]}>3
					wait 1
				wait 5
				RIMUIObj:SetLockSpot[OFF]
			}
			else
			{
				RIMUIObj:SetLockSpot[ALL,-178.088577,29.087303,-341.900818]
			}
		}
		wait 2
	}
	if ${Me.Archetype.Equal[fighter]}
	{
		RIMUIObj:SetLockSpot[ALL,-178.088577,29.087303,-341.900818]
		wait 10
		while ${Math.Distance[${Me.Loc},-178.088577,29.087303,-341.900818]}>3
			wait 1
		wait 5
		RIMUIObj:SetLockSpot[OFF]
	}
	echo ISXRI: Ending Black Reaver
}
function Slime()
{
	echo ISXRI: Starting Slime
	IncomingText:Clear
	IncomingText:Insert["prepares to spray gunk to those around him!"]
	RIMUIObj:SetLockSpot[ALL,41.181149,-6.196420,-651.539246]
	while ${Math.Distance[${Me.Loc},41.181149,-6.196420,-651.539246]}>3
		wait 1
	wait 5
	if ${Me.Archetype.Equal[fighter]}
	{
		wait 30
		RIMUIObj:SetLockSpot[OFF]
	}
	while ${Actor[Query, Name=="A Gyrating Green Slime" && IsDead=FALSE](exists)}
	{
		if ${Trigger}
		{
			eq2ex cancel_spellcast
			Me.Ability[Sprint]:Use
			if ${Actor[Query, Name=="A Gyrating Green Slime" && IsDead=FALSE].Target.Name.Equal[${Me.Name}]}
				wait 40
			else
				wait 20
			if ${Math.Distance[${Me.Loc},48.976913,-6.196415,-647.433899]}<35
			{
				RIMUIObj:SetLockSpot[ALL,-12.401492,-6.196422,-649.468689]
				while ${Math.Distance[${Me.Loc},-12.401492,-6.196422,-649.468689]}>3
					wait 1
				wait 5
				if ${Me.Archetype.Equal[fighter]}
				{
					RIMUIObj:SetLockSpot[OFF]
					wait 30
				}
				wait 20
			}
			else
			{
				RIMUIObj:SetLockSpot[ALL,41.181149,-6.196420,-651.539246]
				while ${Math.Distance[${Me.Loc},41.181149,-6.196420,-651.539246]}>3
					wait 1
				wait 5
				if ${Me.Archetype.Equal[fighter]}
				{
					RIMUIObj:SetLockSpot[OFF]
					wait 30
				}
				wait 20
			}
			Trigger:Set[FALSE]
		}
		wait 1
	}
	echo ISXRI: Ending Slime
}
function Chomp()
{
	echo ISXRI: Starting Chomp
	
	IncomingText:Insert["Chomp prepares to unleash a nasty bloody bite to all those nearby in his thirst for blood"]
	RIMUIObj:SetLockSpot[ALL,-323.196747,11.774687,317.118469]
	while ${Math.Distance[${Me.Loc},-323.196747,11.774687,317.118469]}>3
		wait 1
	wait 5
	if ${Me.Archetype.Equal[fighter]}
		RIMUIObj:SetLockSpot[OFF]
	while ${Actor[Query, Name=="Chomp" && IsDead=FALSE](exists)}
	{
		if ${Trigger}
		{
			if ${Actor[Query, Name=="Chomp" && IsDead=FALSE].Target.Name.Equal[${Me.Name}]}
				wait 50
			if ${Math.Distance[${Me.Loc},-323.196747,11.774687,317.118469]}<25
			{
				RIMUIObj:SetLockSpot[ALL,-273.333435,11.774687,317.906952]
				while ${Math.Distance[${Me.Loc},-273.333435,11.774687,317.906952]}>3
					wait 1
				wait 5
				if ${Me.Archetype.Equal[fighter]}
				{
					RIMUIObj:SetLockSpot[OFF]
					wait 30
				}
				wait 20
			}
			else
			{
				RIMUIObj:SetLockSpot[ALL,-323.196747,11.774687,317.118469]
				while ${Math.Distance[${Me.Loc},-323.196747,11.774687,317.118469]}>3
					wait 1
				wait 5
				if ${Me.Archetype.Equal[fighter]}
				{
					RIMUIObj:SetLockSpot[OFF]
					wait 30
				}
				wait 20
			}
			Trigger:Set[FALSE]
		}
		wait 1
	}
	echo ISXRI: Ending Chomp
}
function Primatious()
{
	echo ISXRI: Starting Primatious
	
	IncomingText:Insert["prepares to unleash a nasty bloody bite to all those nearby in his thirst for blood"]
	RIMUIObj:SetLockSpot[ALL,-523.602600,11.180099,-56.043617]
	wait 10
	while ${Math.Distance[${Me.Loc},-523.602600,11.180099,-56.043617]}>3
		wait 1
	wait 5
	if ${Me.Archetype.Equal[fighter]}
		RIMUIObj:SetLockSpot[OFF]
	while ${Actor[Query, Name=="Sentinel Primatious" && IsDead=FALSE](exists)}
	{
		if ${RIMUIObj.MainIconIDExists[${Me.ID},540]}
		{
			RI_CMD_Assist 0
			Actor[${Me.ID}]:DoTarget
			while ${RIMUIObj.MainIconIDExists[${Me.ID},540]}
			{
				if ${Target.ID}!=${Me.ID}
					Actor[${Me.ID}]:DoTarget
				call CheckTriggerPrimatious
				wait 5
			}
			RI_CMD_Assist 1
		}
		elseif ${Me.Archetype.Equal[fighter]} && ${Me.InCombat}
		{
			if ${Target.ID}!=${Actor[Query, Name=="Sentinel Primatious" && IsDead=FALSE].ID}
				Actor[Query, Name=="Sentinel Primatious" && IsDead=FALSE]:DoTarget
		}
		call CheckTriggerPrimatious
		wait 5
	}
	echo ISXRI: Ending Primatious
}
function CheckTriggerPrimatious()
{
	if ${Trigger}
	{
		if ${Actor[Query, Name=="Sentinel Primatious" && IsDead=FALSE].Target.Name.Equal[${Me.Name}]} || ${Me.Archetype.Equal[fighter]}
			wait 50
		if ${Math.Distance[${Me.Loc},-523.602600,11.180099,-56.043617]}<25
		{
			RIMUIObj:SetLockSpot[ALL,-555.931274,11.180054,-25.864149]
			while ${Math.Distance[${Me.Loc},-555.931274,11.180054,-25.864149]}>3
				wait 1
			wait 5
			if ${Me.Archetype.Equal[fighter]}
			{
				RIMUIObj:SetLockSpot[OFF]
				wait 30
			}
			wait 20
		}
		else
		{
			RIMUIObj:SetLockSpot[ALL,-523.602600,11.180099,-56.043617]
			while ${Math.Distance[${Me.Loc},-523.602600,11.180099,-56.043617]}>3
				wait 1
			wait 5
			if ${Me.Archetype.Equal[fighter]}
			{
				RIMUIObj:SetLockSpot[OFF]
				wait 30
			}
			wait 20
		}
		Trigger:Set[FALSE]
	}
}
function Runelord()
{
	echo ISXRI: Starting Runelord
	while ${Actor[Query, Name=="The Strathbone Runelord" && IsDead=FALSE](exists)}
	{
		if ${RIMUIObj.MainIconIDExists[${Me.ID},540]}
		{
			RI_CMD_Assist 0
			Actor[${Me.ID}]:DoTarget
			while ${RIMUIObj.MainIconIDExists[${Me.ID},540]}
			{
				if ${Target.ID}!=${Me.ID}
					Actor[${Me.ID}]:DoTarget
				wait 1
			}
			RI_CMD_Assist 1
		}
		elseif ${Me.Archetype.Equal[fighter]} && ${Me.InCombat}
		{
			if ${Target.ID}!=${Actor[Query, Name=="The Strathbone Runelord" && IsDead=FALSE].ID}
				Actor[Query, Name=="The Strathbone Runelord" && IsDead=FALSE]:DoTarget
		}
		wait 5
	}
	echo ISXRI: Ending Runelord
}
function Shanaira()
{
	echo ISXRI: Starting Shanaira
	
	RI_CMD_Assist 0
	
	if ${Me.Archetype.NotEqual[fighter]}
	{
		RIMUIObj:SetLockSpot[ALL,0.355797,4.718675,-7.988738]
	}
	
	while !${Me.InCombat}
		wait 1
	
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["aligns her magic into a ring of blazing winds around ${Me.Name}"]
	
	while ${Actor[Query, Name=-"Shanaira" && Distance<=100](exists)}
	{
		if ${Actor[Query, Name=-"a swarm of flies" && IsDead=FALSE](exists)}
		{
			if ${Target.ID}!=${Actor[Query, Name=-"a swarm of flies" && IsDead=FALSE].ID}
				Actor[Query, Name=-"a swarm of flies" && IsDead=FALSE]:DoTarget
		}
		elseif ${Actor[Query, Name=-"Illusion of ${Me.Name}" && IsDead=FALSE](exists)}
		{
			if ${Target.ID}!=${Actor[Query, Name=-"Illusion of ${Me.Name}" && IsDead=FALSE].ID}
				Actor[Query, Name=-"Illusion of ${Me.Name}" && IsDead=FALSE]:DoTarget
		}
		else
		{
			if ${Target.ID}!=${Actor[Query, Name=-"Shanaira" && Distance<=100].ID}
				Actor[Query, Name=-"Shanaira" && IsDead=FALSE && Distance<=100]:DoTarget
		}
		if ${RIMUIObj.MainIconIDExists[${Me.ID},488]} || ${Trigger}
		{
			RIMUIObj:SetLockSpot[ALL,9.978826,5.179579,22.060690]
			if ${Trigger}
			{
				wait 100
				Trigger:Set[FALSE]
			}
			else
			{
				while ${RIMUIObj.MainIconIDExists[${Me.ID},488]}
				{
					if ${Actor[Query, Name=-"swarm" && IsDead=FALSE](exists)}
					{
						if ${Target.ID}!=${Actor[Query, Name=-"swarm" && IsDead=FALSE].ID}
							Actor[Query, Name=-"swarm" && IsDead=FALSE]:DoTarget
					}
					elseif ${Actor[Query, Name=-"Illusion of ${Me.Name}" && IsDead=FALSE](exists)}
					{
						if ${Target.ID}!=${Actor[Query, Name=-"Illusion of ${Me.Name}" && IsDead=FALSE].ID}
							Actor[Query, Name=-"Illusion of ${Me.Name}" && IsDead=FALSE]:DoTarget
					}
					else
					{
						if ${Target.ID}!=${Actor[Query, Name=-"Shanaira" && Distance<=100].ID}
							Actor[Query, Name=-"Shanaira" && IsDead=FALSE && Distance<=100]:DoTarget
					}
					wait 2
				}
			}
			RIMUIObj:SetLockSpot[ALL,0.355797,4.718675,-7.988738]
		}
		wait 2
	}
	echo ISXRI: Ending Shanaira
}
;Terris v15
function Terris()
{
	declare TerrisStopCasting bool global 0
	declare HC_Var_Int_Counter int global 0
	declare HC_Var_Int_CastCounter int global 0
	declare HC_Var_String_NameForHud string global "Drain Life/Hemmorahge in"
	declare HC_Var_Bool_JustCasted bool global FALSE
	declare CastTime int global ${Time.SecondsSinceMidnight}
	declare CastSeconds int 105
	declare CalcVar int 0
	
	echo ${Time}: Starting Terris
	;events
	Event[EQ2_onIncomingText]:AttachAtom[TerrisEQ2_onIncomingText]
	HC_Var_Int_Counter:Set[0]
	
	;create hud
	Squelch HUD -add HudCountdown 600,300 ${HC_Var_String_NameForHud}: ${HC_Var_Int_Counter}s

	while !${Me.InCombat}
		wait 1
	
	while ${Actor[Query, Name=-"Terris" && IsDead=FALSE](exists)} || ${Me.IsDead}
	{
		call TerrisCheckMIDandTarget
		if !${HC_Var_Bool_JustCasted} && ( ${Me.GetGameData[Target.Casting].Label.Equal[Drain Life]} || ${Me.GetGameData[Target.Casting].Label.Equal[Hemorrhage]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[Drain Life]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[Hemorrhage]} )
		{
			CastTime:Set[${Time.SecondsSinceMidnight}]
			HC_Var_Bool_JustCasted:Set[TRUE]
			TimedCommand 50 HC_Var_Bool_JustCasted:Set[FALSE]
		}
		call TerrisUpdateHUD
		waitframe
	}
	deletevariable TerrisStopCasting
	deletevariable HC_Var_Int_Counter
	deletevariable HC_Var_Int_CastCounter
	deletevariable HC_Var_String_NameForHud
	deletevariable HC_Var_Bool_JustCasted
	;detach atom
	Event[EQ2_onIncomingText]:DetachAtom[TerrisEQ2_onIncomingText]
	echo ${Time}: Ending Terris
	Squelch HUD -remove HudCountdown
}

function TerrisCheckMIDandTarget()
{
	if ${RIMUIObj.MainIconIDExists[${Me.ID},478]} || ${RIMUIObj.MainIconIDExists[${Me.ID},54]} || ${Me.Cursed} || ${Me.GetGameData[Target.Casting].Label.Equal[Daydream]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[Daydream]} || ${RIMUIObj.MainIconIDExists[${Me.ID},540]} || ${TerrisStopCasting}
	{
		if ${RIMUIObj.MainIconIDExists[${Me.ID},478]} || ${RIMUIObj.MainIconIDExists[${Me.ID},540]} || ${TerrisStopCasting}
			RIMUIObj:SetUISetting[ALL,SettingsCastAbilitiesCheckBox,0]
		RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
		RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
		eq2ex cancel_spellcast
		while ${RIMUIObj.MainIconIDExists[${Me.ID},478]} || ${RIMUIObj.MainIconIDExists[${Me.ID},54]} || ${Me.Cursed} || ${Me.GetGameData[Target.Casting].Label.Equal[Daydream]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[Daydream]} || ${RIMUIObj.MainIconIDExists[${Me.ID},540]} || ${TerrisStopCasting}
		{
			if ${RIMUIObj.MainIconIDExists[${Me.ID},478]} || ${RIMUIObj.MainIconIDExists[${Me.ID},540]} || ${TerrisStopCasting}
			{
				RIMUIObj:SetUISetting[ALL,SettingsCastAbilitiesCheckBox,0]
				eq2ex cancel_spellcast
			}
			if ${RIMUIObj.MainIconIDExists[${Me.ID},478]} || ${RIMUIObj.MainIconIDExists[${Me.ID},54]} || ${Me.Cursed} || ${Me.GetGameData[Target.Casting].Label.Equal[Daydream]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[Daydream]} || ${RIMUIObj.MainIconIDExists[${Me.ID},540]}
				TerrisStopCasting:Set[0]
			waitframe
			call TerrisUpdateHUD
		}
		RIMUIObj:SetUISetting[ALL,SettingsCastAbilitiesCheckBox,1]
		RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
		RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
	}
	elseif ${Me.Archetype.Equal[fighter]} && ${Me.InCombat}
	{
			if ${Target.ID}!=${Actor[Query, Name=-"Terris" && IsDead=FALSE].ID} && !${Actor[Query, Name=-"waking" && IsDead=FALSE](exists)}
				Actor[Query, Name=-"Terris" && IsDead=FALSE]:DoTarget
	}
}
;atom triggered when incoming text is detected
atom TerrisEQ2_onIncomingText(string Message, string SoundType, float Timer)
{
	if ${Message.Find[The air around you crackles with planar magic]}
	{
		TerrisStopCasting:Set[1]
		TimedCommand 150 TerrisStopCasting:Set[0]
		eq2ex r Stopping casting!
	}
	if ${Message.Find[Drain Life]} || ${Message.Find[Hemmorahge]}
	{
		CastTime:Set[${Time.SecondsSinceMidnight}]
	}
}
;UpdateHUD function
function TerrisUpdateHUD()
{
	CalcVar:Set[${Math.Calc[${CastSeconds}-((${Time.SecondsSinceMidnight}-${CastTime})+1)]}]
	if ${CalcVar}>0
		HC_Var_Int_Counter:Set[${CalcVar}]
	else
		HC_Var_Int_Counter:Set[0]
}
function Rak'Ashiir()
{
	call RakAshiir
}
function Rakashiir()
{
	call RakAshiir
}
function RakAshiir()
{
	declare MusicBoxUP bool FALSE
	echo ISXRI: Starting Rak'Ashiir
	
	while !${Me.InCombat}
		wait 1
	while ${Actor[Query, Name=-"Rak'Ashiir" && IsDead=FALSE](exists)} || ${Me.IsDead}
	{
		if ${Actor[Query, Name=-"a Torsis Music Box" && IsDead=FALSE](exists)}
		{
			MusicBoxUP:Set[1]
			if ${Math.Distance[${Actor[Music].Loc},-32.775524,-4.997875,-1086.396118]}<30 && ${Math.Distance[${Me.Loc},${Actor[Music].Loc}]}>30
				call MoveToMusicBox "-32.775524,-4.997875,-1086.396118"
			if ${Math.Distance[${Actor[Music].Loc},65.249672,-4.997911,-1085.140625]}<30 && ${Math.Distance[${Me.Loc},${Actor[Music].Loc}]}>30
				call MoveToMusicBox "65.249672,-4.997911,-1085.140625"
			if ${Math.Distance[${Actor[Music].Loc},-32.554836,-4.995754,-1052.578003]}<30 && ${Math.Distance[${Me.Loc},${Actor[Music].Loc}]}>30
				call MoveToMusicBox "-32.554836,-4.995754,-1052.578003"
			if ${Math.Distance[${Actor[Music].Loc},66.168198,-4.996263,-1054.251221]}<30 && ${Math.Distance[${Me.Loc},${Actor[Music].Loc}]}>30
				call MoveToMusicBox "66.168198,-4.996263,-1054.251221"
			if ${Me.Archetype.Equal[fighter]} && ${Target.ID}!=${Actor[music].ID}
				Actor[Query, Name=-"a Torsis Music Box" && IsDead=FALSE]:DoTarget
		}
		else
		{
			if ${MusicBoxUP}
			{
				if ${Math.Distance[${Me.Loc},-32.775524,-4.997875,-1086.396118]}<30
					call MoveFromMusicBox "-32.775524,-4.997875,-1086.396118"
				if ${Math.Distance[${Me.Loc},65.249672,-4.997911,-1085.140625]}<30
					call MoveFromMusicBox "65.249672,-4.997911,-1085.140625"
				if ${Math.Distance[${Me.Loc},-32.554836,-4.995754,-1052.578003]}<30
					call MoveFromMusicBox "-32.554836,-4.995754,-1052.578003"
				if ${Math.Distance[${Me.Loc},66.168198,-4.996263,-1054.251221]}<30
					call MoveFromMusicBox "66.168198,-4.996263,-1054.251221"
				MusicBoxUP:Set[0]
			}
			if ${Me.Archetype.NotEqual[fighter]} && ${Math.Distance[${Actor[Query, Name=-"Rak'Ashiir" && IsDead=FALSE].Loc},17.957945,-4.742667,-1069.569702]}<20
			{
				RIMUIObj:SetLockSpot[ALL,OFF]
				RIMUIObj:SetMoveBehind[ALL,1,1,1]
			}
			else
			{
				RIMUIObj:SetMoveBehind[ALL,0]
				RIMUIObj:SetLockSpot[${Me.Name},17.957945,-4.742667,-1069.569702,1,500]
			}
		}
		wait 1
	}
	echo ISXRI: Ending Rak'Ashiir
}
function MoveToMusicBox(string _Loc)
{
	RIMUIObj:SetLockSpot[${Me.Name},${_Loc},1,500]
	while ${Math.Distance[${Me.Loc},${_Loc}]}>5
		wait 1
	RIMUIObj:SetLockSpot[${Me.Name},${Actor[Music].X},${Actor[Music].Y},${Actor[Music].Z},5,500]
	while ${Math.Distance[${Me.Loc},${Actor[Music].Loc}]}>7
		wait 1
}
function MoveFromMusicBox(string _Loc)
{
	RIMUIObj:SetLockSpot[${Me.Name},${_Loc},1,500]
	while ${Math.Distance[${Me.Loc},${_Loc}]}>5
		wait 1
}
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; End of KA RAID CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; START OF PoP NAMED CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;; START Plane of Innovation: Masks of the Marvelous
function Masksshinyhunt()
{
	;if !${RI_Var_Bool_GlobalOthers}
	;{
		call RIMObj.follow
		call RIMObj.Move -124.924789 7.905365 -261.083099 2 0 0 1 0 0 1 1
		wait 20
		;function JumpUp(float _X, float _Y, float _Z, float _YTarget, int _FaceDegree, int _GiveUpCNT=10)
		call JumpUp -124.924789 7.905365 -261.083099 9 270 10 1
		wait 20
		call RIMObj.Move -111.706612 7.718957 -263.421967 2 0 0 1 0 1 1 1
		call RIMObj.Move -100.742439 12.476549 -246.208786 2 0 0 1 0 1 1 1
		call RIMObj.Move -97.558731 13.258391 -247.870499 2 0 0 1 0 0 1 1
		wait 20
		call RIMObj.Move -73.829292 9.735672 -253.137878 2 0 0 1 0 1 1 1
		call RIMObj.Move -58.483322 15.882746 -277.657928 2 0 0 1 0 1 1 1
		call RIMObj.Move -27.967058 3.421775 -266.742157 2 0 0 1 0 1 1 1
		call RIMObj.Move 9.475385 3.421775 -274.455322 2 0 0 1 0 1 1 1
		call RIMObj.Move 40.466194 3.421775 -275.411774 2 0 0 1 0 1 1 1
		call RIMObj.Move 83.733780 3.588810 -259.628082 2 0 0 1 0 1 1 1
		call RIMObj.Move 105.221207 9.316585 -253.357132 2 0 0 1 0 1 1 1
		call RIMObj.Move 140.396164 9.893292 -252.499680 2 0 0 1 0 1 1 1
		call RIMObj.Move 175.585556 9.874395 -253.125977 2 0 0 1 0 1 1 1
		call RIMObj.Move 201.678635 3.421775 -263.103149 2 0 0 1 0 1 1 1
		call RIMObj.Move 198.376892 3.421775 -272.090210 2 0 0 1 0 1 1 1
		call RIMObj.Move 160.647034 9.744106 -253.548752 2 0 0 1 0 1 1 1
		call RIMObj.Move 106.473030 9.120202 -254.170807 2 0 0 1 0 1 1 1
		call RIMObj.Move 38.778267 3.421775 -274.946808 2 0 0 1 0 1 1 1
		call RIMObj.Move -53.880840 14.920004 -277.121063 2 0 0 1 0 1 1 1
		call RIMObj.Move -98.818031 13.220114 -277.958466 2 0 0 1 0 1 1 1
		call RIMObj.Move -138.560394 6.008033 -276.528809 2 0 0 1 0 1 1 1
		call RIMObj.Move -143.020386 9.893293 -253.026489 2 0 0 1 0 0 1 1
	;}
	;else
	;{
	;	while ${Me.Distance[-143.020386,9.893293,-253.026489]}>5
	;	{
	;		call ExecuteQueued
	;		wait 2
	;	}
	;}
}

function Ancient()
{
	while ${Me.Inventory[Query, Location=="Inventory" && Name=="Ancient Clockwork Hand"](exists)}
	{
		Me.Inventory[Query, Location=="Inventory" && Name=="Ancient Clockwork Hand"]:Destroy
		waitframe
	}
	
	echo ISXRI: Starting Ancient 
	variable int _AncientID=${Actor[Query, Name=-"Ancient Clockwork Prototype" && IsDead=FALSE].ID}
	variable int _XXIVID=${Actor[Query, Name=-"Clockwork Prototype XXIV" && IsDead=FALSE].ID}
	variable int _XXVIIID=${Actor[Query, Name=-"Clockwork Prototype XXVII" && IsDead=FALSE].ID}
	
	while ${Actor[Query, ID=${_AncientID}].Distance}>35
		wait 5
		
	;attach atoms
	Event[EQ2_onIncomingText]:AttachAtom[EQ2_onIncomingTextAncient]
	
	;declare global variables
	declare _InvalidTargets index:string global
	;declare _LastProtectCallOutTime int global 0
	declare _count int 0
	declare _ancientcantarget 1
	declare _XXIVcantarget 1
	declare _XXVIIcantarget 1
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_AncientID} && IsDead=FALSE]:DoTarget
		RIMUIObj:SetLockSpot[ALL,-200.531754,4.258005,-200.079727]
		wait 25
		relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
	}
	else
	{
		wait 20
		call MoveBehind 1
	}
	
	while ${Actor[Query, ID=${_AncientID} && IsDead=FALSE](exists)}
	{
		;echo main loop
		if !${RI_Var_Bool_GlobalOthers}
		{
			;echo After GO check
			if ${Actor[Query, ID=${_AncientID} && IsDead=FALSE].Health}>0 && ${Actor[Query, ID=${_AncientID} && IsDead=FALSE](exists)} && ${Actor[Query, ID=${_XXIVID} && IsDead=FALSE](exists)} && ${Actor[Query, ID=${_XXVIIID} && IsDead=FALSE](exists)} && ${_InvalidTargets.Used}>0
			{
				;echo before determine who to target
				;first determine who to target			
				_ancientcantarget:Set[1]
				_XXIVcantarget:Set[1]
				_XXVIIcantarget:Set[1]
				for(_count:Set[${Math.Calc[${_InvalidTargets.Used}-1]}];${_count}<=${_InvalidTargets.Used};_count:Inc)
				{
					;echo checking ${_count}: ${_InvalidTargets.Get[${_count}]}
					switch ${_InvalidTargets.Get[${_count}]}
					{
						case Ancient
						{
							_ancientcantarget:Set[0]
							break
						}
						case XXIV
						{
							_XXIVcantarget:Set[0]
							break
						}
						case XXVII
						{
							_XXVIIcantarget:Set[0]
							break
						}
					}
				}
				;echo A: ${_ancientcantarget} // XXIV: ${_XXIVcantarget} // XXVII: ${_XXVIIcantarget}
				if ${_XXVIIcantarget}
				{
					if ${Target.ID}!=${_XXVIIID}
						Actor[Query, ID=${_XXVIIID} && IsDead=FALSE]:DoTarget
				}
				elseif ${_XXIVcantarget} 
				{
					if ${Target.ID}!=${_XXIVID}
						Actor[Query, ID=${_XXIVID} && IsDead=FALSE]:DoTarget
				}
				elseif ${_ancientcantarget} 
				{
					if ${Target.ID}!=${_AncientID}
						Actor[Query, ID=${_AncientID} && IsDead=FALSE]:DoTarget
				}
			}
			else
			{
				;echo not all 3 are alive or no one is protected yet targeting the add then the named // ${Actor[Query, ID=${_XXIVID} && IsDead=FALSE](exists)}  // ${Actor[Query, ID=${_XXVIIID} && IsDead=FALSE](exists)} // ${Actor[Query, ID=${_AncientID} && IsDead=FALSE](exists)} 
				if ${Actor[Query, ID=${_XXIVID} && IsDead=FALSE](exists)} 
				{
					if ${Target.ID}!=${_XXIVID}
						Actor[Query, ID=${_XXIVID} && IsDead=FALSE]:DoTarget
				}
				elseif ${Actor[Query, ID=${_XXVIIID} && IsDead=FALSE](exists)} 
				{
					if ${Target.ID}!=${_XXVIIID}
						Actor[Query, ID=${_XXVIIID} && IsDead=FALSE]:DoTarget
				}
				elseif ${Actor[Query, ID=${_AncientID} && IsDead=FALSE](exists)} 
				{
					if ${Target.ID}!=${_AncientID}
						Actor[Query, ID=${_AncientID} && IsDead=FALSE]:DoTarget
				}
			}
		}
		wait 5
	}
	wait 20 ${Actor[Query, Name=-"Exquisite Chest" && Distance<50](exists)}
	variable int _ChestID
	variable int _ChestCNT=0
	_ChestID:Set[${Actor[Query, Name=-"Exquisite Chest" && Distance<50].ID}]
	
	while ${Actor[id,${_ChestID}](exists)} && ${_ChestCNT:Inc}<10
	{
		call RIMObj.LootChest
		wait 2
		relay ${RI_Var_String_RelayGroup} LootWindow:RequestAll
		relay ${RI_Var_String_RelayGroup} LootWindow:LootAll
		wait 2
	}
	if ${Actor[id,${_ChestID}](exists)}
		RI_Var_IndexInt_InvalidChest:Insert[${_ChestID}]
	
	echo ISXRI: Ending Ancient 
	;delete global variables
	deletevariable _InvalidTargets
	;deletevariable _LastProtectCallOutTime
	;detach atom
	Event[EQ2_onIncomingText]:DetachAtom[EQ2_onIncomingTextAncient]
	;if ${RI_Var_Bool_GlobalOthers}
	call MoveBehind 0
	wait 2
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
}
;atom triggered when incommingtext is detected
atom EQ2_onIncomingTextAncient(string Text)
{
	if ${RI_Var_Bool_Debug}
		echo ${Time}:IncomingText: ${Text}
	;if ${IncomingText} exists in the Incoming, execute
	if ${Text.Find[is protected from harm by their ally!](exists)}
	{
		;_LastProtectCallOutTime:Set[${Script.RunningTime}]
		;if ${Script.RunningTime}>${Math.Calc[${_LastProtectCallOutTime}+5000]}
		;	_InvalidTargets:Clear
		if ${Text.Find[Ancient Clockwork Prototype](exists)}
			_InvalidTargets:Insert[Ancient]
		elseif ${Text.Find[Clockwork Prototype XXVII](exists)}
			_InvalidTargets:Insert[XXVII]
		elseif ${Text.Find[Clockwork Prototype XXIV](exists)}
			_InvalidTargets:Insert[XXIV]
	}
}
function Scrounger()
{
	IncomingText:Clear
	IncomingText2:Clear
	variable int scount=0
	variable int _ScroungerID=${Actor[Query, Name=-"Clockwork Scrounger XVII" && IsDead=FALSE].ID}
	if ${_ScroungerID}==0
		return
	echo ISXRI: Starting Scrounger 
	;if !${Zone.Name.Find["[Expert]"]}
	;{
		IncomingText:Insert["Short circuit detected"]
		IncomingText:Insert["electricity seems to have found a way to be grounded"]
	
		;set lockspot
		RIMUIObj:SetLockSpot[ALL,53.314800,3.523858,-33.248989]
		if !${RI_Var_Bool_GlobalOthers}
		{
			Actor[Query, ID=${_ScroungerID} && IsDead=FALSE]:DoTarget
			wait 30
			relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
		}
		else
		{
			wait 20
			;if !${Zone.Name.Find["[Expert]"]}
				call MoveBehind ${_ScroungerID}
				RI_Var_Int_MoveDistanceMod:Set[6]
		}
	;}
	;else
	;{
	;	"RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Ethershadow Assassin,0]"
	;	if !${RI_Var_Bool_GlobalOthers}
	;	{
	;		RIMUIObj:SetLockSpot[${Me.Name},53.314800,3.523858,-33.248989]
	;		relay is2 RIMUIObj:SetLockSpot[ALL,58.071678,3.421775,-56.795563]
	;		relay is3 RIMUIObj:SetLockSpot[ALL,35.334251,3.756961,-43.391628]
	;		relay is4 RIMUIObj:SetLockSpot[ALL,77.688507,3.421775,-37.381474]
	;		relay is5 RIMUIObj:SetLockSpot[ALL,64.683022,3.421775,-10.705439]
	;		relay is6 RIMUIObj:SetLockSpot[ALL,36.251858,3.704819,-15.456582]
	;	}
	;}
	while ${Actor[Query, ID=${_ScroungerID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_ScroungerID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_ScroungerID}
					Actor[Query, ID=${_ScroungerID} && IsDead=FALSE]:DoTarget
			}
		}
		if ${Trigger} && ${TriggerMessage.Find[Short circuit detected](exists)}
		{
			"RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Ethershadow Assassin,0]"
			if !${RI_Var_Bool_GlobalOthers}
			{
				if ${Zone.Name.Find[Solo]}
				{
					relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,58.071678,3.421775,-56.795563]
				}
				elseif !${RI_Var_Bool_GlobalOthers}
				{
					;if ${Me.Group}>1
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[1].Name},58.071678,3.421775,-56.795563]
					;if ${Me.Group}>2
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[2].Name},35.334251,3.756961,-43.391628]
					;if ${Me.Group}>3
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[3].Name},77.688507,3.421775,-37.381474]
					;if ${Me.Group}>4
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[4].Name},64.683022,3.421775,-10.705439]
					;if ${Me.Group}>5
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5].Name},36.251858,3.704819,-15.456582]
						relay ${RI_Var_String_RelayGroup} RIMObj:Cast[All,Sprint,1]
				}
			}
			scount:Set[1]
			while !${Me.Maintained[Sprint](exists)} && ${Me.Ability[id,1571882540].IsReady} && ${scount:Inc}<5
			{
				eq2ex cancel_spellcast
				Me.Ability[id,1571882540]:Use
				wait 5
			}
			Trigger:Set[FALSE]
			while !${Trigger} && ${Actor[Query, ID=${_ScroungerID} && IsDead=FALSE](exists)}
				wait 1
			;if !${Zone.Name.Find["[Expert]"]}
			;{
				if ${RI_Var_Bool_GlobalOthers}
				{
					RIMUIObj:SetLockSpot[OFF]
				}
			;}
			;else
			;	RIMUIObj:SetLockSpot[ALL,53.314800,3.523858,-33.248989]
			"RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Ethershadow Assassin,1]"
			wait 5
			scount:Set[1]
			Me.Maintained[Sprint]:Cancel
			while ${Me.Maintained[Sprint](exists)} && ${scount:Inc}<25
			{
				Me.Maintained[Sprint]:Cancel
				waitframe
			}
			Me.Maintained[Sprint]:Cancel
		}
		wait 2
	}
	call MoveBehind 0
	RI_Var_Int_MoveDistanceMod:Set[1]
	wait 2
	"RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Ethershadow Assassin,1]"
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	echo ISXRI: Ending Scrounger 
}
function Glitched()
{
	echo ISXRI: Starting Glitched 
	variable int _GlitchedID=${Actor[Query, Name=-"The Glitched Guardian 10101" && IsDead=FALSE].ID}
	
	;IncomingText:Clear
	;IncomingText2:Clear
	;IncomingText:Insert["a deadly explosion is imminent!"]
	
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_GlitchedID} && IsDead=FALSE]:DoTarget
		RIMUIObj:SetLockSpot[ALL,187.213654,3.421775,-144.772171]
		wait 25
		relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
	}
	else
	{
		wait 20
		call MoveBehind 1
	}
	
	while ${Actor[Query, ID=${_GlitchedID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			;if ${Actor[Query, Name=-"a whirling gear" && IsDead=FALSE](exists)}
			;{
			;	if ${Target.ID}!=${Actor[Query, Name=-"a whirling gear" && IsDead=FALSE].ID}
			;		Actor[Query, Name=-"a whirling gear" && IsDead=FALSE]:DoTarget
			;}
			;else
			if ${Actor[Query, ID=${_GlitchedID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_GlitchedID}
					Actor[Query, ID=${_GlitchedID} && IsDead=FALSE]:DoTarget
			}
		}
		; if ${Trigger}
		; {
			; if ${Math.Distance[${Me.Loc},187.213654,3.421775,-144.772171]}<5
				; RIMUIObj:SetLockSpot[ALL,150.011292,3.421775,-154.625687]
			; else
				; RIMUIObj:SetLockSpot[ALL,187.213654,3.421775,-144.772171]
			; Trigger:Set[FALSE]
			; if ${RI_Var_Bool_GlobalOthers}
			; {
				; wait 100 ${Actor[Query, ID=${_GlitchedID} && IsDead=FALSE].Distance}<8
				; RIMUIObj:SetLockSpot[OFF]
			; }	
		; }
		wait 2
	}
	call MoveBehind 0
	wait 2
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	echo ISXRI: Ending Glitched 
}
function Keeper()
{
	variable int _KeeperID=${Actor[Query, Name=-"Glitched Cell Keeper" && IsDead=FALSE].ID}
	variable bool _Triggered=0
	variable int _TriggeredTime=${Script.RunningTime}
	RIMUIObj:SetLockSpot[ALL,131.844910,9.893293,-218.589996]

	echo ISXRI: Starting Keeper 
	while ${Actor[Query, ID=${_KeeperID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_KeeperID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_KeeperID}
					Actor[Query, ID=${_KeeperID} && IsDead=FALSE]:DoTarget
			}
			if ${Actor[Query, ID=${_KeeperID} && IsDead=FALSE].CurrentAnimation.Find[cast_forced_flasher_diff_noise](exists)} && !${_Triggered}
			{
				;echo Red Circle: Jousting
				_Triggered:Set[1]
				_TriggeredTime:Set[${Script.RunningTime}]
				if ${Math.Distance[${Me.Loc},118.828079,9.893293,-218.826157]}<15
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,171.872147,9.893293,-219.553787]
				else
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,118.828079,9.893293,-218.826157]
			}
			if ( ${Actor[Query, ID=${_KeeperID} && IsDead=FALSE].CurrentAnimation.Find[attack](exists)} || ${Actor[Query, ID=${_KeeperID} && IsDead=FALSE].CurrentAnimation.Find[design_mount_explode](exists)} || ${Script.RunningTime}>${Math.Calc[${_TriggeredTime}+10000]} ) && ${_Triggered}
			{
				;echo Red Circle: GONE
				_Triggered:Set[0]
			}
		}
		
		waitframe
	}
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	echo ISXRI: Ending Keeper 
}
function Gearclaw()
{
	call WaitForLastNamedChest START
	variable int _GearclawID=${Actor[Query, Name=-"Gearclaw the Collector" && IsDead=FALSE].ID}
	
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["Gearclaw the Collector runs out of power..."]
	IncomingText:Insert["Gearclaw the Collector is energized!"]

	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_GearclawID} && IsDead=FALSE]:DoTarget
		RIMUIObj:SetLockSpot[ALL,-142.149750,5.488159,-265.438293]
		wait 25
		relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
	}
	else
	{
		wait 20
		call MoveBehind 1
	}
	echo ISXRI: Starting Gearclaw 
	while ${Actor[Query, ID=${_GearclawID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_GearclawID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_GearclawID}
					Actor[Query, ID=${_GearclawID} && IsDead=FALSE]:DoTarget
			}
		}
		if ${Trigger} && ${TriggerMessage.Find[Gearclaw the Collector runs out of power...](exists)} && !${RI_Var_Bool_GlobalOthers}
		{
			Trigger:Set[FALSE]
			RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_GearclawID} && IsDead=FALSE].Loc},2]
			
			while !${Trigger}
			{
				eq2ex apply_verb ${_GearclawID} "Turn Key"
				wait 5
			}
			RIMUIObj:SetLockSpot[ALL,-142.149750,5.488159,-265.438293]
			Trigger:Set[FALSE]
		}
		;if we are a mage watch for spell's MainIconID and cast absorb magic
		if ${Me.Archetype.Equal[mage]}
		{
			;if we see The MainIconID of the Ability on Named, pause bot, stop casting and cast Absorb Magic
			if ${RIMUIObj.MainIconIDExists[${_GearclawID},546]} && ${Me.Ability[id,1812025739].IsReady}
			{
				;echo ${Time}: Astral Dominion Found
				
				;turn off assisting
				RI_CMD_Assisting 0
				
				;pause bots
				RI_CMD_PauseCombatBots 1
				
				;target "Sorceress Gwen'vae"
				Actor[Query, ID=${_GearclawID}]:DoTarget
				
				;cancel spellcast and clear ability queue
				eq2ex cancel_spellcast
				eq2ex clearabilityqueue 
				
				;wait until we are not casting
				wait 200 !${Me.CastingSpell}
				
				;keep attempting to cast absorb magic (ID=1812025739) until it is no longer ready (aka casted)
				do
				{
					if ${Target.ID}==${_GearclawID}
						Me.Ability[id,1812025739]:Use
					else
						Actor[Query, ID=${_GearclawID}]:DoTarget
					wait 1
				}
				while ${Me.Ability[id,1812025739].IsReady}
				
				;wait until we are not casting
				wait 200 !${Me.CastingSpell}
				
				;turn on assisting
				RI_CMD_Assisting 1
				
				;unpause bots
				RI_CMD_PauseCombatBots 0
			}
		}
		wait 2
	}
	;if ${RI_Var_Bool_GlobalOthers}
	call MoveBehind 0
	call WaitForLastNamedChest
	wait 2
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	echo ISXRI: Ending Gearclaw 
}
function WaitForLastNamedChest(string _special=0)
{
	variable string _way
	variable int _cnt
	_cnt:Set[0]
	if ${RI_Var_Bool_WaitForLastNamedChest}
	{
		if ${_special.Equal[START]}
		{
			relay ${RI_Var_String_RelayGroup} RI_Var_Bool_SkipLoot:Set[1]
			return
		}
		wait 300 !${Me.InCombat}
		wait 5
		call LootOptions LEADERONLY
		wait 5
		call LootOptions LEADERONLY
		if ${_special.Equal[0]}
		{
			echo ISXRI: Waiting 30 mins or until Chest no longer exists
			relay ${RI_Var_String_RelayGroup} RI_Var_Bool_SkipLoot:Set[1]
			;eq2ex apply_verb ${Actor[Query, Name=-"Exquisite Chest" && Distance<50].ID} Summon
			eq2ex apply_verb ${Actor[Query, Name=-"Chest" && Distance<50].ID} Summon
			;eq2ex summon ${Actor[Query, Name=-"Exquisite Chest" && Distance<50].ID}
			eq2ex summon ${Actor[Query, Name=-"Chest" && Distance<50].ID}
			while ${_cnt:Inc}<18000 && ${Actor[Query, Name=-"Chest" && Distance<50](exists)}
				wait 1
			relay ${RI_Var_String_RelayGroup} RI_Var_Bool_SkipLoot:Set[0]
		}
		elseif ${_special.Equal[Gaukr]}
		{
			relay ${RI_Var_String_RelayGroup} RI_Var_Bool_SkipLoot:Set[1]
			_way:Set["${Me.Loc}"]
			eq2ex way ${Actor[Query, Name=-"Gaukr Sandstorm's Treasure"].Loc}
			call MessageBox "Go loot Gaukr Sandstorm's Treasure and resume back at the waypoint that shows up when your resume RI"
			eq2ex way ${_way}
			wait 600 ${Me.Distance2D[${_way}]}<15
			relay ${RI_Var_String_RelayGroup} RI_Var_Bool_SkipLoot:Set[0]
			MainArrayCounter:Set[796]
		}
		elseif ${_special.Equal[Hreidar]}
		{
			relay ${RI_Var_String_RelayGroup} RI_Var_Bool_SkipLoot:Set[1]
			_way:Set["${Me.Loc}"]
			eq2ex way ${Actor[Query, Name=-"Hreidar Lynhillig's Treasure"].Loc}
			call MessageBox "Go loot Hreidar Lynhillig's Treasure and resume back at the waypoint that shows up when your resume RI"
			eq2ex way ${_way}
			wait 600 ${Me.Distance2D[${_way}]}<15
			relay ${RI_Var_String_RelayGroup} RI_Var_Bool_SkipLoot:Set[0]
			MainArrayCounter:Set[700]
		}
		if ${Developer}
			call LootOptions RoundRobin
	}
}
function Tordeniceharvest(bool Ice=FALSE)
{
	variable index:string TowerLocs
	variable index:string RampToExit
	variable index:string UpRamp
	variable int NID=0
	variable int ClosestDistance=1000
	variable int ClosestIndex=0
	variable int i=0
	TowerLocs:Insert["702.119873,-16.916431,-709.564941"]
	TowerLocs:Insert["666.297058,-15.172900,-737.471680"]
	TowerLocs:Insert["608.515259,-16.950439,-724.270081"]
	TowerLocs:Insert["565.902039,-16.973282,-692.773926"]
	TowerLocs:Insert["549.774353,-16.974749,-645.779663"]
	TowerLocs:Insert["554.128723,-16.983551,-590.650024"]
	TowerLocs:Insert["583.758789,-16.970869,-555.771240"]
	TowerLocs:Insert["642.918518,-16.966190,-527.054016"]
	TowerLocs:Insert["696.345032,-16.975197,-525.613159"]
	TowerLocs:Insert["735.651062,-16.966032,-554.210693"]
	TowerLocs:Insert["766.698853,-16.975491,-592.381104"]
	TowerLocs:Insert["764.521057,-16.967421,-674.611511"]
	TowerLocs:Insert["747.195801,-16.974709,-709.371643"]
	RampToExit:Insert["763.607483,-16.982561,-688.947266"]
	RampToExit:Insert["775.076416,-16.973558,-635.237427"]
	RampToExit:Insert["767.796448,-16.985189,-586.011353"]
	RampToExit:Insert["727.702148,-16.962910,-547.708496"]
	RampToExit:Insert["681.034180,-16.965700,-527.330933"]
	RampToExit:Insert["626.545532,-16.984177,-521.957581"]
	RampToExit:Insert["585.097473,-16.980629,-548.544983"]
	RampToExit:Insert["555.739746,-16.974344,-595.451904"]
	RampToExit:Insert["542.433044,-16.989290,-635.717102"]
	RampToExit:Insert["484.556122,-4.015545,-632.799561"]
	RampToExit:Insert["423.111786,-2.090988,-634.312073"]
	RampToExit:Insert["370.492676,4.774867,-635.130676"]
	RampToExit:Insert["296.573761,-0.913154,-634.618652"]
	RampToExit:Insert["279.261780,4.866563,-634.985229"]
	RampToExit:Insert["241.691422,11.843900,-636.872620"]
	RampToExit:Insert["227.242523,10.640715,-638.079895"]
	UpRamp:Insert["699.929932,9.152539,-745.824158"]
	UpRamp:Insert["666.500305,23.086889,-752.628662"]
	UpRamp:Insert["624.832703,36.991673,-745.724426"]
	UpRamp:Insert["559.252686,39.648159,-702.407043"]
	UpRamp:Insert["535.513245,60.366699,-664.613953"]
	UpRamp:Insert["530.050232,75.559319,-625.456787"]
	UpRamp:Insert["551.758789,89.111618,-567.999207"]
	UpRamp:Insert["601.304688,91.338486,-509.219360"]
	UpRamp:Insert["627.057495,104.235535,-495.333984"]
	UpRamp:Insert["658.925537,119.077858,-494.746033"]
	UpRamp:Insert["694.465759,136.431976,-503.158569"]
	UpRamp:Insert["716.657227,144.023514,-521.229858"]
	UpRamp:Insert["770.890259,146.522705,-571.961365"]
	UpRamp:Insert["787.666687,163.061020,-601.474365"]
	UpRamp:Insert["792.359375,182.258240,-640.436157"]
	UpRamp:Insert["768.941895,197.929123,-690.656372"]
	;first we need to get to the tower
	press space
	RIMUIObj:SetLockSpot[ALL,282.465515,4.866563,-638.132507,3]
	wait 150 ${Me.Distance[282.465515,4.866563,-638.132507]}<4
	press space
	RIMUIObj:SetLockSpot[ALL,355.382172,5.196898,-638.006470,3]
	wait 150 ${Me.Distance[355.382172,5.196898,-638.006470]}<4
	press space
	RIMUIObj:SetLockSpot[ALL,409.328400,-2.478711,-636.124329,3]
	wait 150 ${Me.Distance[409.328400,-2.478711,-636.124329]}<4
	press space
	RIMUIObj:SetLockSpot[ALL,467.333221,-3.577754,-636.104309,3]
	wait 150 ${Me.Distance[467.333221,-3.577754,-636.104309]}<4
	press space
	RIMUIObj:SetLockSpot[ALL,548.023621,-16.974627,-635.826538,3]
	wait 150 ${Me.Distance[548.023621,-16.974627,-635.826538]}<4
	press space
	RIMUIObj:SetLockSpot[ALL,545.734375,-16.987186,-619.153259,3]
	wait 150 ${Me.Distance[545.734375,-16.987186,-619.153259]}<4
	
	if !${Ice}
	{
		press shift+r
		while ${RIMUIObj.InventoryQuantity[Copper Orb]}<10
		{
			press space
			RIMUIObj:SetLockSpot[ALL,OFF]
			NID:Set[${Actor[a copper orb].ID}]
			if ${Actor[id,${NID}].Distance}<50 
			;&& !${EQ2.CheckCollision[${Me.X},${Math.Calc[${Me.Y}+1]},${Me.Z},${Actor[Query, ID=${NID}].X},${Math.Calc[${Actor[Query, ID=${NID}].Y}+1]},${Actor[Query, ID=${NID}].Z}]}
			{
				call TordenIceHarvestNode ${NID}
			}
			else
			{
				;find closest point and move to it then check again
				for(i:Set[1];${i}<=${TowerLocs.Used};i:Inc)
				{
					if ${Me.Distance[${TowerLocs.Get[${i}]}]}<${ClosestDistance}
					{
						ClosestDistance:Set[${Me.Distance[${TowerLocs.Get[${i}]}]}]
						ClosestIndex:Set[${i}]
					}
				}
				if ${ClosestDistance}>10
				{
					press space
					RIMUIObj:SetLockSpot[ALL,${TowerLocs.Get[${ClosestIndex}]},3]
					wait 150 ${Me.Distance[${TowerLocs.Get[${ClosestIndex}]}]}<4
				}
				else
				{
					press space
					if ${ClosestIndex}==${TowerLocs.Used}
					{
						RIMUIObj:SetLockSpot[ALL,${TowerLocs.Get[1]},3]
						wait 150 ${Me.Distance[${TowerLocs.Get[1]}]}<4
					}
					else
					{
						RIMUIObj:SetLockSpot[ALL,${TowerLocs.Get[${Math.Calc[${ClosestIndex}+1]}]},3]
						wait 150 ${Me.Distance[${TowerLocs.Get[${Math.Calc[${ClosestIndex}+1]}]}]}<4
					}
				}
				wait 1
			}
		}
		press shift+r
	}
	;done now we need to find our closest location in the Index of locs and move to it then follow the rest of the path to get to the ramp, then check for bucket, if it exists within 25 of the top loc, go up if not go out, we will do all in here so as to not have to worry about changing the dat too much other than to change the messagebox to call this function inside RI
	
	for(i:Set[1];${i}<=${TowerLocs.Used};i:Inc)
	{
		if ${Me.Distance[${TowerLocs.Get[${i}]}]}<${ClosestDistance}
		{
			ClosestDistance:Set[${Me.Distance[${TowerLocs.Get[${i}]}]}]
			ClosestIndex:Set[${i}]
		}
	}
	for(i:Set[${ClosestIndex}];${i}<=${TowerLocs.Used};i:Inc)
	{
		press space
		RIMUIObj:SetLockSpot[ALL,${TowerLocs.Get[${i}]},3]
		wait 150 ${Me.Distance[${TowerLocs.Get[${i}]}]}<4
	}
	
	;now see if the bucket is up top
	if ( ${Actor[bucket].Distance[762.280701,198.403244,-720.223389]}<25 || ${Ice} ) && ( !${Me.Inventory[Query, Location=="Inventory" && Name=="a bucket"](exists)} || ${Ice} )
	{
		;go up top and use same code to get the bucket once up top, then come back down
		press space
		for(i:Set[1];${i}<=${UpRamp.Used};i:Inc)
		{
			RIMUIObj:SetLockSpot[ALL,${UpRamp.Get[${i}]}]
			wait 150 ${Me.Distance[${UpRamp.Get[${i}]}]}<2
		}
		RIMUIObj:SetLockSpot[ALL,OFF]

		press shift+r
		if ${Ice}
			NID:Set[${Actor[ice].ID}]
		else
			NID:Set[${Actor[bucket].ID}]
		if ${NID}!=0
			call TordenIceHarvestNode ${NID}
		press shift+r
		
		;now back down the ramp
		for(i:Set[${UpRamp.Used}];${i}>0;i:Dec)
		{
			RIMUIObj:SetLockSpot[ALL,${UpRamp.Get[${i}]}]
			wait 150 ${Me.Distance[${UpRamp.Get[${i}]}]}<2
		}
	}
	;now leave this side
	for(i:Set[1];${i}<=${RampToExit.Used};i:Inc)
	{
		press space
		RIMUIObj:SetLockSpot[ALL,${RampToExit.Get[${i}]},3]
		wait 150 ${Me.Distance[${RampToExit.Get[${i}]}]}<4
	}
	RIMUIObj:SetLockSpot[ALL,OFF]
}
function TordenIceHarvestNode(int ID)
{
	variable string _loc
	_loc:Set["${Actor[id,${ID}].Loc}"]
	;echo tihn ${ID} // ${_loc} // \${Actor[Query, ID=${ID} && Loc="${_loc}"](exists)} // ${Actor[Query, ID=${ID} && Loc="${_loc}"](exists)}
	while ${Actor[Query, ID=${ID} && Loc="${_loc}"](exists)}
	{
		Actor[id,${ID}]:DoFace
		Actor[id,${ID}]:DoTarget
		if ${Actor[id,${ID}].Distance}<5 
			Actor[id,${ID}]:DoubleClick
		if ${Actor[id,${ID}].Distance}>5
			press -hold w
		else
			press -release w
		if ${Actor[id,${ID}].Distance}<5 && ${Actor[id,${ID}].Distance}>1
		{
			press w
		}
		wait 1
	}
}
function TordenTowerCyclone()
{
	call LockAndWait -Loc "-826.257935,346.421570,-751.601196" -RelayToGroup -Max 1000 -Precision 1
	wait 300 ${RIMObj.AllGroupWithinRange[5]}
	call RIMObj.follow
}
function LockSpotGroup(string Loc)
{
	call LockAndWait -Loc "${Loc.Replace[" ",","]}" -RelayToGroup -Max 1000 -Precision 1
	wait 300 ${RIMObj.AllGroupWithinRange[5]}
	call RIMObj.follow
}
function CheckShortZone()
{
	if ${RI_Var_Bool_TordenShort}
	{
		if ${Zone.Name.Find[Bastion of Thunder: Tower Breach]}
			MainArrayCounter:Set[319]
		elseif ${Zone.Name.Find[Bastion of Thunder: Winds of Change]}
			MainArrayCounter:Set[376]
	}
}
function Poimomss()
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	;wait for the sweeper to be near the safe zone and facing towards it
	while ${Actor[Security Sweeper].Heading}<170 || ${Actor[Security Sweeper].Heading}>190 || ${Math.Distance[${Actor[Security Sweeper].Loc},237.345123,-13.491620,-32.000992]}>30
		waitframe
	
	;start follow
	call RIMObj.follow
	;move
	;function Move(float X1, float Y1, float Z1, int MPrecision=2, int PauseLength=0, bool ClearTarget=FALSE, bool StopForCombat=FALSE, bool SkipCheck=TRUE, bool KeepMoving=FALSE, bool UseRI_Var_String_ForwardKey=TRUE, bool SkipCollisionCheck=FALSE)
	call RIMObj.Move 241.352753 -13.300402 -71.690414 2 0 1 0 1 0 1 1
	wait 10
	;start follow
	call RIMObj.follow
	call RIMObj.Move 238.826492 -13.193188 -219.755493 2 0 1 0 1 0 1 1
	wait 20
	;start follow
	call RIMObj.follow
	call RIMObj.Move 213.512756 -5.162802 -219.917786 2 0 1 0 1 0 1 1
	wait 20
	;start follow
	call RIMObj.follow
}

;;;;;;;; END Plane of Innovation: Masks of the Marvelous
;;;;;;;; START Plane of Innovation: Gears in the Machine
function Poigearssigcheck()
{
	if ${QuestJournalWindow.ActiveQuest[Legacy of Power: An Innovative Approach](exists)}
	{
		call RIMObj.Move 24.640141 21.154209 -284.446655 2 0 1 1 1 0 1
		wait 20
		call RIMObj.CheckCombat
		CustomLoc:Set["0 0 0"]
		call HailActor "The Great Gear" 12
		call RIMObj.CheckCombat
		wait 150
		call RIMObj.CheckCombat
		wait 50
		call RIMObj.CheckCombat
		wait 300
		call RIMObj.CheckCombat
		call RIMObj.Move 25.418760 21.154343 -277.073883 2 0 1 1 1 1 1
		call RIMObj.Move 23.376228 21.154039 -267.233582 2 0 1 1 1 1 1
		call RIMObj.Move 24.856493 21.290298 -263.545624 2 0 1 1 1 1 1
		call RIMObj.Move 23.792351 17.739491 -257.662537 2 0 1 1 1 1 1
		call RIMObj.Move 23.990973 12.719796 -248.865005 2 0 1 1 1 1 1
		call RIMObj.Move 24.040649 12.720225 -238.741501 2 0 1 1 1 1 1
		call RIMObj.Move 24.368406 12.368553 -228.682632 2 0 1 1 1 1 1
		call RIMObj.Move 27.243088 7.034668 -220.449081 2 0 1 1 1 1 1
		call RIMObj.Move 31.924129 3.854991 -211.686981 2 0 1 1 1 1 1
		call RIMObj.Move 37.100109 3.857544 -202.984955 2 0 1 1 1 1 1
		call RIMObj.Move 42.462048 3.605478 -194.419205 2 0 1 1 1 1 1
		call RIMObj.Move 46.126621 4.035593 -188.461548 2 0 1 1 1 0 1
		wait 20
		call ClickActor "Gyro-stabilized Sorcerous Generator" 1
		call RIMObj.Move 36.682247 3.844167 -184.781387 2 0 1 1 1 1 1
		call RIMObj.Move 30.003736 3.855189 -177.034103 2 0 1 1 1 1 1
		call RIMObj.Move 27.181763 3.856225 -167.399704 2 0 1 1 1 1 1
		call RIMObj.Move 26.212839 3.856225 -157.384399 2 0 1 1 1 1 1
		call RIMObj.Move 25.764122 3.856225 -147.213028 2 0 1 1 1 1 1
		call RIMObj.Move 25.310307 3.856225 -136.966827 2 0 1 1 1 1 1
		call RIMObj.Move 22.340605 3.856225 -127.164864 2 0 1 1 1 1 1
		call RIMObj.Move 13.574960 3.537393 -122.347809 2 0 1 1 1 0 1
		wait 20
		call ClickActor "Junkyard East Door 02"
		call RIMObj.Move 3.358238 3.667451 -121.891098 2 0 1 1 1 1 1
		call RIMObj.Move -6.865152 3.667451 -121.047081 2 0 1 1 1 1 1
		call RIMObj.Move -13.365169 3.667451 -120.667480 2 0 1 1 1 0 1
		wait 20
		call HailActor "Meldrath the Marvelous" 5
		call RIMObj.Move -6.865152 3.667451 -121.047081 2 0 1 1 1 1 1
		call RIMObj.Move 3.358238 3.667451 -121.891098 2 0 1 1 1 0 1
		wait 20
		call ClickActor "Junkyard East Door 02"
		call RIMObj.Move 13.574960 3.537393 -122.347809 2 0 1 1 1 1 1
		call RIMObj.Move 25.329494 3.856225 -130.811264 2 0 1 1 1 1 1
		call RIMObj.Move 25.272472 3.856225 -151.209335 2 0 1 1 1 1 1
		call RIMObj.Move 25.214958 3.856133 -171.781403 2 0 1 1 1 1 1
		call RIMObj.Move 25.174196 3.856133 -186.363617 2 0 1 1 1 1 1
		call RIMObj.Move 24.861246 4.140646 -208.189056 2 0 1 1 1 0 1
	}
}
function Mechanization()
{
	call PreHeal
	variable int _MechanizationID=${Actor[Query, Name=-"Powered Mechanization" && IsDead=FALSE].ID}
	
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["Powered Mechanization begins to cast a powerful beam spell"]
	Actor[Query, ID=${_MechanizationID} && IsDead=FALSE]:DoTarget
	wait 20
	RIMUIObj:SetLockSpot[ALL,6.343683,3.793154,-125.300911]

	echo ISXRI: Starting Mechanization 
	while ${Actor[Query, ID=${_MechanizationID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_MechanizationID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_MechanizationID}
					Actor[Query, ID=${_MechanizationID} && IsDead=FALSE]:DoTarget
			}
		}
		if ${Trigger}
		{
			wait 10
			;here need to check the mobs location if its one of the 2 on the opposite side of the room then lockspot to the opposite and vice versa
			if ${Math.Distance[${Actor[Query, ID=${_MechanizationID} && IsDead=FALSE].Loc},4.310000,3.667451,-120.360001]}<5
				RIMUIObj:SetLockSpot[ALL,5.699681,4.450512,-106.275620]
			else
				RIMUIObj:SetLockSpot[ALL,6.343683,3.793154,-125.300911]
			Trigger:Set[FALSE]
		}
		wait 2
	}
	echo ISXRI: Ending Mechanization 
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
}
function Toa()
{
	variable int _ToaID=${Actor[Query, Name=-"Toa" && IsDead=FALSE].ID}
	
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["electric charge through their chassis!"]
	IncomingText:Insert["is no longer electrically charged"]
	
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_ToaID} && IsDead=FALSE]:DoTarget
		RIMUIObj:SetLockSpot[ALL,-200.531754,4.258005,-200.079727]
		wait 25
		relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
	}
	else
	{
		wait 20
		call MoveBehind 1
	}
	echo ISXRI: Starting Toa 
	while ${Actor[Query, ID=${_ToaID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
		    if ${RIObj.GroupDetrimentCount[Cursed]}>1
				Me:DoTarget
			elseif ${Actor[Query, ID=${_ToaID} && IsDead=FALSE && Health>10](exists)}
			{
				if ${Target.ID}!=${_ToaID}
					Actor[Query, ID=${_ToaID} && IsDead=FALSE]:DoTarget
			}
			elseif ${Actor[Query, Name=-"Keewi the Shiner" && IsDead=FALSE && Health>10](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"Keewi the Shiner" && IsDead=FALSE].ID}
					Actor[Query, Name=-"Keewi the Shiner" && IsDead=FALSE]:DoTarget
			}
			elseif ${Actor[Query, Name=-"Brasoh the Polisher" && IsDead=FALSE && Health>10](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"Brasoh the Polisher" && IsDead=FALSE].ID}
					Actor[Query, Name=-"Brasoh the Polisher" && IsDead=FALSE]:DoTarget
			}
			elseif ${Actor[Query, ID=${_ToaID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_ToaID}
					Actor[Query, ID=${_ToaID} && IsDead=FALSE]:DoTarget
			}
			if ${Trigger} && ${TriggerMessage.Find[electric charge through their chassis!](exists)} && ${TriggerMessage.Find[Toa the shiny](exists)}
			{
				Trigger:Set[FALSE]
				while !${Trigger} && ${Actor[Query, ID=${_ToaID} && IsDead=FALSE](exists)}
				{
					if ${RIObj.GroupDetrimentCount[Cursed]}>1
						Me:DoTarget
					elseif ${Actor[Query, Name=-"Keewi the Shiner" && IsDead=FALSE].Health}>10
					{
						if ${Target.ID}!=${Actor[Query, Name=-"Keewi the Shiner" && IsDead=FALSE].ID}
							Actor[Query, Name=-"Keewi the Shiner" && IsDead=FALSE]:DoTarget
					}
					else
					{
						if ${Target.ID}!=${Actor[Query, Name=-"Brasoh the Polisher" && IsDead=FALSE].ID}
							Actor[Query, Name=-"Brasoh the Polisher" && IsDead=FALSE]:DoTarget
					}
					wait 1
				}
				Trigger:Set[FALSE]
			}
		}
		wait 2
	}
	;if ${RI_Var_Bool_GlobalOthers}
	call MoveBehind 0
	wait 2
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	echo ISXRI: Ending Toa 
}
function Manaetic()
{
	call WaitForLastNamedChest START
	variable int _ManaeticID=${Actor[Query, Name=-"The Manaetic Behemoth" && IsDead=FALSE].ID}
	variable int _cnt=0
	variable int _cnt2=0
	variable index:string _Points
	;variable index:string _Distances
	variable index:bool _All3Away
	variable bool _AllAway
	variable index:actor _Actors
    variable int _ClosestIndex=0
	variable int _ClosestDistance=10000000
	_Points:Insert["46.373379 3.605478 -207.900238"]
	_Points:Insert["42.991592 3.605478 -196.000977"]
	_Points:Insert["41.090023 3.835477 -188.113403"]
	_Points:Insert["37.916798 3.839002 -174.053635"]
	_Points:Insert["31.494320 3.854897 -173.851624"]
	_Points:Insert["32.327793 3.854322 -185.175415"]
	_Points:Insert["33.313599 3.650632 -196.889374"]
	_Points:Insert["34.123245 3.856303 -207.600616"]
	_Points:Insert["22.231794 4.140542 -206.483017"]
	_Points:Insert["22.859894 3.856225 -193.186279"]
	_Points:Insert["21.154711 3.855691 -181.432526"]
	_Points:Insert["19.791559 3.855189 -173.108688"]
	_Points:Insert["11.040295 3.838649 -172.709991"]
	_Points:Insert["10.092204 3.839139 -183.093033"]
	_Points:Insert["9.425178 3.676035 -191.898193"]
	_Points:Insert["8.446525 3.699227 -202.072296"]
	_Points:Insert["7.647158 3.855632 -209.260056"]
	_Points:Insert["24.538240 3.856225 -183.147858"]
	_All3Away:Insert[0]
	_All3Away:Insert[0]
	_All3Away:Insert[0]
	_All3Away:Insert[0]
	_All3Away:Insert[0]
	_All3Away:Insert[0]
	_All3Away:Insert[0]
	_All3Away:Insert[0]
	_All3Away:Insert[0]
	_All3Away:Insert[0]
	_All3Away:Insert[0]
	_All3Away:Insert[0]
	_All3Away:Insert[0]
	_All3Away:Insert[0]
	_All3Away:Insert[0]
	_All3Away:Insert[0]
	_All3Away:Insert[0]
	_All3Away:Insert[0]
	
	if !${RI_Var_Bool_GlobalOthers}
	{
		RIMUIObj:SetLockSpot[ALL,24.755199,4.140682,-209.047897]
		Actor[Query, ID=${_ManaeticID} && IsDead=FALSE]:DoTarget
	}
	else
	{
		RIMUIObj:SetLockSpot[ALL,24.538240,3.856225,-183.147858]
	}
	wait 50 ${Actor[Query, ID=${_ManaeticID} && IsDead=FALSE].Distance}<10
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_ManaeticID} && IsDead=FALSE]:DoTarget
		RIMUIObj:SetLockSpot[ALL,24.538240,3.856225,-183.147858]
		wait 25
		relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
	}
	else
	{
		RIMUIObj:SetLockSpot[OFF]
		wait 20
		call MoveBehind 1
	}
	if !${Actor[Query, ID=${_ManaeticID} && IsDead=FALSE](exists)}
		return
	echo ISXRI: Starting Manaetic 
	
	;relay ${RI_Var_String_RelayGroup} RIMUIObj:DisablePets[ALL]
	;relay ${RI_Var_String_RelayGroup} RIMUIObj:DisableTempPets[ALL]
	while ${Actor[Query, ID=${_ManaeticID} && IsDead=FALSE](exists)}
	{
		if ${Me.Archetype.NotEqual[priest]} && ${Me.Trauma}>0 && ${Me.Inventory[Query, Location=="Inventory" && Name=-"Trauma Remedy"](exists)} && ${Me.Inventory[Query, Location=="Inventory" && Name=-"Trauma Remedy"].TimeUntilReady}<=0
		{
			RI_CMD_PauseCombatBots 1
			eq2ex clearabilityqueue
			eq2ex cancel_spellcast
			Me.Inventory[Trauma Remedy]:Use
			wait 5 ${Me.CastingSpell}
			wait 50 !${Me.CastingSpell}
			RI_CMD_PauseCombatBots 0
		}
			
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_ManaeticID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_ManaeticID}
					Actor[Query, ID=${_ManaeticID} && IsDead=FALSE]:DoTarget
			}
		}
		if ${Actor[Query, Name=="" && Aura=="design_circle_warning_zone"](exists)} && !${RI_Var_Bool_GlobalOthers}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
			relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
			;relay ${RI_Var_String_RelayGroup} eq2ex pet backoff
			;wait 1
			;relay ${RI_Var_String_RelayGroup} eq2ex pet backoff
			_Actors:Clear
			for(_cnt:Set[1];${_cnt}<=${_All3Away.Used};_cnt:Inc)
			{
				_All3Away.Get[${_cnt}]:Set[0]
			}
			EQ2:QueryActors[_Actors, Name=="" && Aura=="design_circle_warning_zone"]
			for(_cnt:Set[1];${_cnt}<=${_Points.Used};_cnt:Inc)
			{
				_AllAway:Set[1]
				for(_cnt2:Set[1];${_cnt2}<=${_Actors.Used};_cnt2:Inc)
				{
					if ${Math.Distance[${_Actors.Get[${_cnt2}].Loc},${_Points.Get[${_cnt}].Replace[" ",","]}]}<13
						_AllAway:Set[0]
				}
				_All3Away.Get[${_cnt}]:Set[${_AllAway}]
				;echo Point ${_cnt} safe: ${_AllAway}
			}
			for(_cnt:Set[1];${_cnt}<=${_All3Away.Used};_cnt:Inc)
			{
				;echo ${Math.Distance[${Me.Loc},${_Points.Get[${_cnt}].Replace[" ",","]}]}<${_ClosestDistance} && ${_All3Away.Get[${_cnt}]}
				if ${Math.Distance[${Me.Loc},${_Points.Get[${_cnt}].Replace[" ",","]}]}<${_ClosestDistance} && ${_All3Away.Get[${_cnt}]}
				{
					;echo ${_cnt} is closer ${_ClosestDistance} // ${_Points.Get[${_cnt}]}
					_ClosestIndex:Set[${_cnt}]
					_ClosestDistance:Set[${Math.Distance[${Me.Loc},${_Points.Get[${_cnt}].Replace[" ",","]}]}]
				}
			}
			;echo RIMUIObj:SetLockSpot[ALL,\${_Points.Get[${_ClosestIndex}].Replace[" ",","]}] // RIMUIObj:SetLockSpot[ALL,${_Points.Get[${_ClosestIndex}].Replace[" ",","]}]
			relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${_Points.Get[${_ClosestIndex}].Replace[" ",","]}]
			;wait 20
			RIMUIObj:SetLockSpot[ALL,${_Points.Get[${_ClosestIndex}].Replace[" ",","]},2]
			while ${Actor[Query, Name=="" && Aura=="design_circle_warning_zone"](exists)}
			{
				;if ${Me.Pet(exists)} && ( !${Me.Pet.InCombatMode} || ${Me.Pet.Target.ID}!=${_ManaeticID} )
				;relay ${RI_Var_String_RelayGroup} eq2ex pet backoff
				waitframe
			}
			RIMUIObj:SetLockSpot[ALL,24.538240,3.856225,-183.147858]
			wait 100 ${Math.Distance[${Me.Loc},24.538240,3.856225,-183.147858]}<3
			;if ${RI_Var_Bool_GlobalOthers}
			relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[OFF]
			_ClosestIndex:Set[1]
			_ClosestDistance:Set[10000000]
			;RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
		}
		wait 2
	}
	echo ISXRI: Ending Manaetic 
	;relay ${RI_Var_String_RelayGroup} RIMUIObj:EnablePets[ALL]
	;relay ${RI_Var_String_RelayGroup} RIMUIObj:EnableTempPets[ALL]
	call MoveBehind 0
	call WaitForLastNamedChest
	wait 2
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
}
;;;;;;;; End Plane of Innovation: Gears in the Machine
;;;;;;;; START Plane of Disease: Outbreak

function Felkruk()
{
	while ${Me.Inventory[Query, Location=="Inventory" && Name=="Springview Healer Mask"](exists)}
	{
		Me.Inventory[Query, Location=="Inventory" && Name=="Springview Healer Mask"]:Destroy
		waitframe
	}
	echo ISXRI: Starting Felkruk 
	variable int _FelkrukID=${Actor[Query, Name=-"Felkruk" && IsDead=FALSE].ID}
	variable int _Cnt
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["Your affliction awakens"]
	AnnounceText:Clear
	AnnounceText:Insert["Your affliction awakens"]
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		RIMUIObj:SetLockSpot[ALL,530.413940,67.451500,-46.548641]
		wait 150 ${Math.Distance[${Me.Loc},530.413940,67.451500,-46.548641]}<3
		Actor[Query, ID=${_FelkrukID} && IsDead=FALSE]:DoTarget
		wait 25
		relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
	}
	else
	{
		RIMUIObj:SetLockSpot[ALL,530.413940,67.451500,-46.548641]
		wait 150 ${Math.Distance[${Me.Loc},530.413940,67.451500,-46.548641]}<3
		RIMUIObj:SetLockSpot[OFF]
		wait 20
		call MoveBehind 1
	}
	ISXEQ2:EnableAfflictionEvents
	Event[EQ2_onGroupMemberAfflicted]:AttachAtom[EQ2_onGroupMemberAfflictedFelkruk]
	Event[EQ2_onMeAfflicted]:AttachAtom[EQ2_onMeAfflictedFelkruk]
	;declare global variables
	declare _Cursed index:int global
	RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Cure Curse,0]
	;variable int tempcnt=0
	variable bool _CursedDone=0
	while ${Actor[Query, ID=${_FelkrukID} && IsDead=FALSE](exists)}
	{
		; if ${_Cursed.Used}>${tempcnt}
		; {
			; tempcnt:Inc
			; echo Cursed: ${_Cursed.Used}
			; for(_Cnt:Set[1];${_Cnt}<=${_Cursed.Used};_Cnt:Inc)
			; {
				; echo ${_Cnt}: ${Actor[id,${_Cursed.Get[${_Cnt}]}].Name}
			; }
		; }
		;echo ${_Cursed.Used}==${Me.Group} && !${_CursedDone}
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_FelkrukID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_FelkrukID}
					Actor[Query, ID=${_FelkrukID} && IsDead=FALSE]:DoTarget
			}
		}
		if ${Trigger}
		{
			;echo Trigger
			_CursedDone:Set[0]
			Trigger:Set[0]
			wait 10
		}
		if ${_Cursed.Used}==${Me.Group} && !${_CursedDone}
		{
			Event[EQ2_onGroupMemberAfflicted]:DetachAtom[EQ2_onGroupMemberAfflictedFelkruk]
			Event[EQ2_onMeAfflicted]:DetachAtom[EQ2_onMeAfflictedFelkruk]
			;pause bots
			;RI_CMD_PauseCombatBots 1
			if ${Me.Archetype.Equal[Priest]}
			{
				for(_Cnt:Set[1];${_Cnt}<=${_Cursed.Used};_Cnt:Inc)
				{
					if ${_Cursed.Get[${_Cnt}]}==${Me.ID}
					{
						while ${Me.Cursed}==1
						{
							if !${Me.CastingSpell}
							{
								;echo eq2execute useabilityonplayer ${Me.Name} "Cure Curse"
								eq2execute useabilityonplayer ${Me.Name} "Cure Curse"
								eq2execute clearabilityqueue
							}
							wait 2 ${Me.CastingSpell}
							if ${_Cnt}!=1
								_Cnt:Set[1]
						}
					}
					else
					{
						while ${Me.Group[id,${_Cursed.Get[${_Cnt}]}].Cursed}==1
						{
							if !${Me.CastingSpell}
							{
								;echo eq2execute useabilityonplayer ${Actor[id,${_Cursed.Get[${_Cnt}]}].Name} "Cure Curse"
								eq2execute useabilityonplayer ${Actor[id,${_Cursed.Get[${_Cnt}]}].Name} "Cure Curse"
								eq2execute clearabilityqueue
							}
							wait 2 ${Me.CastingSpell}
							if ${_Cnt}!=1
								_Cnt:Set[1]
						}
					}
				}
			}
			;unpause bots
			;RI_CMD_PauseCombatBots 0
			_CursedDone:Set[1]
		}
		wait 2
	}
	ISXEQ2:DisableAfflictionEvents
	Event[EQ2_onGroupMemberAfflicted]:DetachAtom[EQ2_onGroupMemberAfflictedFelkruk]
	Event[EQ2_onMeAfflicted]:DetachAtom[EQ2_onMeAfflictedFelkruk]
	deletevariable _Cursed
	RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Cure Curse,1]
	call MoveBehind 0
	wait 2
	call RIMObj.follow
	;loot
	call RIMObj.LootChest
	wait 5
	call RIMObj.LootChest
	wait 20
	relay ${RI_Var_String_RelayGroup} LootWindow:RequestAll
	wait 5
	while !${Me.Maintained[Springview Healer Mask](exists)} && ${Me.Inventory[Query, Location=="Inventory" && Name=-"Springview Healer Mask"](exists)}
	{
		Me.Inventory[Query, Location=="Inventory" && Name=-"Springview Healer Mask"]:Use
		wait 5
	}
	echo ISXRI: Ending Felkruk 
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
}
;need to check the index first before adding so in case they are already cursed they dont get added again
atom EQ2_onGroupMemberAfflictedFelkruk(int ActorID, int TraumaCounter, int ArcaneCounter, int NoxiousCounter, int ElementalCounter, int CursedCounter)
{
	variable int _cnt=0
	variable bool _cursedalready=0
	for(_cnt:Set[1];${_cnt}<=${_Cursed.Used};_cnt:Inc)
	{
		if ${ActorID}==${_Cursed.Get[${_cnt}]}
			_cursedalready:Set[1]
	}
	if ${CursedCounter}>0 && !${_cursedalready}
	{
		_Cursed:Insert[${ActorID}]
	}
}
atom EQ2_onMeAfflictedFelkruk(int TraumaCounter, int ArcaneCounter, int NoxiousCounter, int ElementalCounter, int CursedCounter)
{
	variable int _cnt=0
	variable bool _cursedalready=0
	for(_cnt:Set[1];${_cnt}<=${_Cursed.Used};_cnt:Inc)
	{
		if ${Me.ID}==${_Cursed.Get[${_cnt}]}
			_cursedalready:Set[1]
	}
	if ${CursedCounter}>0 && !${_cursedalready}
	{
		_Cursed:Insert[${Me.ID}]
	}
}
function Larva()
{
	echo ISXRI: Starting Larva 
	variable int _LarvaID=${Actor[Query, Name=-"Carrion Larva" && IsDead=FALSE].ID}
	variable int _MLarvaID=${Actor[Query, Name=-"Malarian Larva" && IsDead=FALSE].ID}
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_MLarvaID} && IsDead=FALSE]:DoTarget
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,135.707367,74.169212,-349.603455]
		;wait 25
		;relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
	}
	; else
	; {
		; wait 20
		; call MoveBehind 1
	; }
	
	while ${Actor[Query, ID=${_LarvaID} && IsDead=FALSE](exists)} || ${Actor[Query, ID=${_MLarvaID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_LarvaID} && IsDead=FALSE](exists)} && ${Actor[Query, ID=${_LarvaID} && IsDead=FALSE].Target.ID}!=${Me.ID}
			{
				if ${Target.ID}!=${_LarvaID}
					Actor[Query, ID=${_LarvaID} && IsDead=FALSE]:DoTarget
			}
			elseif ${Actor[Query, ID=${_MLarvaID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_MLarvaID}
					Actor[Query, ID=${_MLarvaID} && IsDead=FALSE]:DoTarget
			}
			elseif ${Actor[Query, ID=${_LarvaID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_LarvaID}
					Actor[Query, ID=${_LarvaID} && IsDead=FALSE]:DoTarget
			}
		}
		wait 2
	}
	;call MoveBehind 0
	;wait 2
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	echo ISXRI: Ending Larva 
}
function Flesh()
{
	while !${Me.Maintained[Hirudin Extract](exists)} && ${Me.Inventory[Query, Location=="Inventory" && Name=-"Hirudin Extract"](exists)}
	{
		Me.Inventory[Query, Location=="Inventory" && Name=-"Hirudin Extract"]:Use
		wait 5
	}
		
	wait 50
	echo ISXRI: Starting Flesh 
	variable int _FleshID=${Actor[Query, Name=-"The Flesh Eater" && IsDead=FALSE].ID}
	RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Absorb Magic,1]
	
	call RIObj.LockAndPull ${_FleshID} "210.751465,390.793640,5.879988" 10 0
	call RIObj.LockAndPull ${_FleshID} "232.244095,391.621765,-3.057931" 10 0
	
	while ${Actor[Query, ID=${_FleshID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_FleshID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_FleshID}
					Actor[Query, ID=${_FleshID} && IsDead=FALSE]:DoTarget
			}
		}
		if ${Me.Archetype.Equal[mage]}
		{
			if ${Me.Ability[id,1812025739].IsReady}
			{
				;turn off assisting
				RI_CMD_Assisting 0
				
				;pause bots
				RI_CMD_PauseCombatBots 1
				
				;target
				Actor[Query, ID=${_FleshID}]:DoTarget
				
				;cancel spellcast and clear ability queue
				eq2ex cancel_spellcast
				eq2ex clearabilityqueue 
				
				;wait until we are not casting
				wait 200 !${Me.CastingSpell}
				
				;keep attempting to cast absorb magic (ID=1812025739) until it is no longer ready (aka casted)
				do
				{
					if ${Target.ID}==${_FleshID}
						Me.Ability[id,1812025739]:Use
					else
						Actor[Query, ID=${_FleshID}]:DoTarget
					wait 1
				}
				while ${Me.Ability[id,1812025739].IsReady}
				
				;wait until we are not casting
				wait 200 !${Me.CastingSpell}
				
				;turn on assisting
				RI_CMD_Assisting 1
				
				;unpause bots
				RI_CMD_PauseCombatBots 0
			}
		}
		wait 2
	}
	;call MoveBehind 0
	wait 150
	relay ${RI_Var_String_RelayGroup} press esc
	wait 50
	relay ${RI_Var_String_RelayGroup} press esc
	wait 5
	relay ${RI_Var_String_RelayGroup} press esc
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	echo ISXRI: Ending Flesh 
}
function V'Aliar()
{
	call Valiar
}
function Valiar()
{
	echo ISXRI: Starting Valiar 
	variable int _ValiarID=${Actor[Query, Name=-"High Dragoon V'Aliar" && IsDead=FALSE].ID}
	variable int _tempcnt
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["Planar static increases around High Dragoon V'Aliar"]
	variable string LS2
	variable string LS1
	LS1:Set["34.452705,93.658646,-212.283173"]
	LS2:Set["-4.524120,95.223457,-181.931030"]
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_ValiarID} && IsDead=FALSE]:DoTarget
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,34.452705,93.658646,-212.283173]
		wait 150 ${Math.Distance[${Me.Loc},34.452705,93.658646,-212.283173]}<3
		wait 150 ${Actor[Query, ID=${_ValiarID} && IsDead=FALSE].Distance}<8
		wait 10
		relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
	}
	else
	{
		wait 150 ${Math.Distance[${Me.Loc},34.452705,93.658646,-212.283173]}<3
		wait 150 ${Actor[Query, ID=${_ValiarID} && IsDead=FALSE].Distance}<8
		RIMUIObj:SetLockSpot[OFF]
		call MoveBehind 1
	}
	Trigger:Set[FALSE]
	while ${Actor[Query, ID=${_ValiarID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=="a metallic squire" && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=="a metallic squire" && IsDead=FALSE].ID}
					Actor[Query, Name=="a metallic squire" && IsDead=FALSE]:DoTarget
				LS1:Set["34.452705,93.658646,-212.283173"]
				LS2:Set["-4.524120,95.223457,-181.931030"]
			}
			elseif ${Actor[Query, ID=${_ValiarID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_ValiarID}
					Actor[Query, ID=${_ValiarID} && IsDead=FALSE]:DoTarget
				LS1:Set["59.721874,76.159340,-287.730377"]
				LS2:Set["42.444218,85.762466,-251.771805"]
			}
			if ${Trigger}
			{
				if ${Math.Distance[${Me.Loc},${LS2}]}<5
				{
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${LS1},1,500]
					wait 150 ${Math.Distance[${Me.Loc},${LS1}]}<3
				}
				else
				{
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${LS2},1,500]
					wait 150 ${Math.Distance[${Me.Loc},${LS2}]}<3
				}
				_tempcnt:Set[0]
				while ${Actor[Query, ID=${_ValiarID} && IsDead=FALSE].Distance}>8 && ${_tempcnt:Inc}<300
				{
					if ${Actor[Query, Name=="a metallic squire" && IsDead=FALSE](exists)}
					{
						if ${Target.ID}!=${Actor[Query, Name=="a metallic squire" && IsDead=FALSE].ID}
							Actor[Query, Name=="a metallic squire" && IsDead=FALSE]:DoTarget
					}
					elseif ${Actor[Query, ID=${_ValiarID} && IsDead=FALSE](exists)}
					{
						if ${Target.ID}!=${_ValiarID}
							Actor[Query, ID=${_ValiarID} && IsDead=FALSE]:DoTarget
					}
					wait 1
				}
			
				Trigger:Set[FALSE]
				relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[OFF]
			}
		}
		
		wait 2
	}
	call MoveBehind 0
	wait 2
	call RIMObj.follow
	;loot
	call RIMObj.LootChest
	wait 5
	call RIMObj.LootChest
	wait 20
	relay ${RI_Var_String_RelayGroup} LootWindow:RequestAll
	wait 5
	while !${Me.Maintained[Weakened Mutualism](exists)} && ${Me.Inventory[Query, Location=="Inventory" && Name=-"Damaged Rune of Symbiosis"](exists)}
	{
		Me.Inventory[Query, Location=="Inventory" && Name=-"Damaged Rune of Symbiosis"]:Use
		wait 5
	}
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	echo ISXRI: Ending Valiar 
}
function Rallius()
{
	AnnounceText:Clear
	AnnounceText:Insert["You are about to be quarantined"]
	declare _RalliusCoding bool global
	_RalliusCoding:Set[1]
	call WaitForLastNamedChest START
	echo ISXRI: Starting Rallius 
	call PreHeal
	RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Battle Coordination,0]
	Me.Maintained[Battle Coordination]:Cancel
	variable int _RalliusID=${Actor[Query, Name=-"Rallius Rattican" && IsDead=FALSE].ID}
	variable int _sid=0
	variable string _MainWep
	variable string _SecWep
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-182.239761,129.033844,-270.444580]
		wait 150 ${Math.Distance[${Me.Loc},-182.239761,129.033844,-270.444580]}<3
		;turn off assisting
		relay ${RI_Var_String_RelayGroup} RI_CMD_Assisting 0
		relay ${RI_Var_String_RelayGroup} press F1
		;getspores
		RIMUIObj:SetLockSpot[ALL,-194.883789,126.604240,-266.778076]
		wait 1
		RIMUIObj:SetLockSpot[ALL,-194.883789,126.604240,-266.778076]
		wait 150 ${Me.Distance2D[-194.883789,-266.778076]}<3
		RIMUIObj:SetLockSpot[OFF]
		while ${Me.Inventory[Query, Location="Inventory" && Name=="Bileburn Spore"].Quantity}<4
		{
			press -release ${RI_Var_String_ForwardKey}
			if ${Actor[Query, TintFlags=29909 && Distance<41](exists)}
			{
				_sid:Set[${Actor[Query, TintFlags=29909 && Distance<41].ID}]
				while ${Actor[Query, ID=${_sid}](exists)}
				{
					while !${Actor[Query, ID=${_sid} && Distance<6](exists)}
					{
						Actor[Query, ID=${_sid}]:DoFace
						Actor[Query, ID=${_sid}]:DoubleClick
						press -hold ${RI_Var_String_ForwardKey}
						waitframe
					}
					press -release ${RI_Var_String_ForwardKey}
					Actor[Query, ID=${_sid}]:DoubleClick
					press -release ${RI_Var_String_ForwardKey}
					wait 2
					Actor[Query, ID=${_sid}]:DoubleClick
					press -release ${RI_Var_String_ForwardKey}
					wait 2
					Actor[Query, ID=${_sid}]:DoubleClick
					press -release ${RI_Var_String_ForwardKey}
				}
				press -release ${RI_Var_String_ForwardKey}
				RIMUIObj:SetLockSpot[ALL,-194.883789,126.604240,-266.778076]
				wait 150 ${Me.Distance2D[-194.883789,-266.778076]}<3
				RIMUIObj:SetLockSpot[OFF]
				wait 10
			}
			else
			{
				echo ISXRI: There are no Orbs within 40m for us to safely go collect, waiting 5s you can either wait for some to move closer or pause and go collect them yourself and return here
				wait 50
			}
			wait 1
		}
		;use the items on the bats
		;bat 1
		call ToggleWalkRun
		RIMUIObj:SetLockSpot[ALL,-167.799026,125.495522,-256.357758,1]
		variable int _whilecnt
		_whilecnt:Set[1]
		while ${Me.Distance2D[-167.799026,-256.357758]}>2 && ${_whilecnt:Inc}<150
		{
			Actor[Query, TintFlags=29909 && Distance<20]:DoubleClick
			wait 1
		}
		wait 5
		call ToggleWalkRun
		call PreHeal
		;relay ${RI_Var_String_RelayGroup} 
		RI_CMD_PauseCombatBots 1
		RIMUIObj:SetLockSpot[OFF]
		while ${Actor[Query, Name=-"a patron of plagues" && X=-138.330002 && Z=-249.130005].IsAggro}
		{ 
			Actor[Query, Name=-"a patron of plagues" && X=-138.330002 && Z=-249.130005]:DoTarget
			Me.Inventory[Query, Location="Inventory" && Name=="Bileburn Spore"]:Use
			wait 50 !${Actor[Query, Name=-"a patron of plagues" && X=-138.330002 && Z=-249.130005].IsAggro}
			wait 50 ${Me.Inventory[Query, Location="Inventory" && Name=="Bileburn Spore"].TimeUntilReady}<0
		}
		;bat 2
		while ${Actor[Query, Name=-"a patron of plagues" && X=-144.910004 && Z=-257.079987].IsAggro}
		{ 
			Actor[Query, Name=-"a patron of plagues" && X=-144.910004 && Z=-257.079987]:DoTarget
			Me.Inventory[Query, Location="Inventory" && Name=="Bileburn Spore"]:Use
			wait 50 !${Actor[Query, Name=-"a patron of plagues" && X=-144.910004 && Z=-257.079987].IsAggro}
			wait 50 ${Me.Inventory[Query, Location="Inventory" && Name=="Bileburn Spore"].TimeUntilReady}<0
		}
		;bat 3
		RIMUIObj:SetLockSpot[ALL,-164.674362,125.745636,-269.627563,1]
		_whilecnt:Set[1]
		while ${Me.Distance2D[-164.674362,-269.627563]}>2 && ${_whilecnt:Inc}<150
		{
			Actor[Query, TintFlags=29909 && Distance<20]:DoubleClick
			wait 1
		}
		wait 5
		while ${Actor[Query, Name=-"a patron of plagues" && X=-139.279999 && Z=-264.179993].IsAggro}
		{ 
			Actor[Query, Name=-"a patron of plagues" && X=-139.279999 && Z=-264.179993]:DoTarget
			Me.Inventory[Query, Location="Inventory" && Name=="Bileburn Spore"]:Use
			wait 50 !${Actor[Query, Name=-"a patron of plagues" && X=-139.279999 && Z=-264.179993].IsAggro}
			wait 50 ${Me.Inventory[Query, Location="Inventory" && Name=="Bileburn Spore"].TimeUntilReady}<0
		}
		;bat 4
		while ${Actor[Query, Name=-"a patron of plagues" && X=-134.830002 && Z=-272.589996].IsAggro}
		{ 
			Actor[Query, Name=-"a patron of plagues" && X=-134.830002 && Z=-272.589996]:DoTarget
			Me.Inventory[Query, Location="Inventory" && Name=="Bileburn Spore"]:Use
			wait 50 !${Actor[Query, Name=-"a patron of plagues" && X=-134.830002 && Z=-272.589996].IsAggro}
			wait 50 ${Me.Inventory[Query, Location="Inventory" && Name=="Bileburn Spore"].TimeUntilReady}<0
		}
		;turn on Singular Focus 4026518400  or if guardian Focused Offensive 1432018334
		if ${Me.SubClass.Equal[guardian]} && ${Me.Ability[id,1432018334].IsReady}
		{
			while !${Me.Maintained[Focused Offensive](exists)}
			{
				while ${Me.Ability[id,1432018334].IsReady}
				{
					Me.Ability[id,1432018334]:Use
					wait 5 ${Me.Maintained[Focused Offensive](exists)}
				}
				wait 5 ${Me.Maintained[Focused Offensive](exists)}
			}
		}
		elseif ${Me.Ability[id,4026518400].IsReady}
		{
			
			while !${Me.Maintained[Singular Focus](exists)}
			{
				while ${Me.Ability[id,4026518400].IsReady}
				{
					Me.Ability[id,4026518400]:Use
					wait 5 ${Me.Maintained[Singular Focus](exists)}
				}
				wait 5 ${Me.Maintained[Singular Focus](exists)}
			}
		}
		;remove main and sec weps
		relay ${RI_Var_String_RelayGroup} press f1
		wait 1
		relay "other RI_Var_String_RelayGroup}" RI_CMD_PauseCombatBots 0
		call PreHeal
		relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 1
		_MainWep:Set[${Me.Equipment[1]:UnEquip}]
		_SecWep:Set[${Me.Equipment[2]:UnEquip}]
		RIMUIObj:SetLockSpot[ALL,-155.450333,125.758110,-264.457581]
		_whilecnt:Set[1]
		while ${Me.Distance2D[-155.450333,-264.457581]}>2 && ${_whilecnt:Inc}<150
		{
			Actor[Query, TintFlags=29909 && Distance<20]:DoubleClick
			wait 1
		}
		wait 5		
		Actor[Query, ID=${_RalliusID} && IsDead=FALSE]:DoTarget
		Actor[Query, ID=${_RalliusID} && IsDead=FALSE]:DoFace
		;echo turning on ranged
		eq2execute setautoattackmode 2
		eq2execute togglerangedattack
		wait 5
		press ${RI_Var_String_JumpKey}
		TimedCommand 5 press ${RI_Var_String_JumpKey}
		TimedCommand 10 press ${RI_Var_String_JumpKey}
		while ${Actor[Query, ID=${_RalliusID} && IsDead=FALSE].Distance}>15
		{
			Actor[Query, ID=${_RalliusID} && IsDead=FALSE]:DoTarget
			Actor[Query, ID=${_RalliusID} && IsDead=FALSE]:DoFace
			wait 1
		}
		
		RIMUIObj:SetLockSpot[ALL,-182.239761,129.033844,-270.444580]
		wait 150 ${Me.Distance2D[-182.239761,-270.444580]}<3
		;waitfor mob to be within 7
		wait 150 ${Actor[Query, ID=${_RalliusID} && IsDead=FALSE].Distance}<8
		if ${Me.SubClass.Equal[guardian]}
			Me.Maintained[Focused Offensive]:Cancel
		else
			Me.Maintained[Singular Focus]:Cancel
		relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 0
		relay ${RI_Var_String_RelayGroup} RI_CMD_Assisting 1
		Me.Inventory[Query,Location=="Inventory" && Name=="${_MainWep}"]:Equip
		wait 30
		Me.Inventory[Query,Location=="Inventory" && Name=="${_SecWep}"]:Equip
		relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 0
		relay ${RI_Var_String_RelayGroup} RI_CMD_Assisting 1
	}
	while ${Actor[Query, ID=${_RalliusID} && IsDead=FALSE].Distance}>10
		wait 1
	while ${Actor[Query, ID=${_RalliusID} && IsDead=FALSE](exists)}
	{
		if ${Me.Equipment[1].Name.NotEqual["${_MainWep}"]}
			Me.Inventory[Query,Location=="Inventory" && Name=="${_MainWep}"]:Equip
		if ${Me.Equipment[2].Name.NotEqual["${_SecWep}"]}
			Me.Inventory[Query,Location=="Inventory" && Name=="${_SecWep}"]:Equip
		
		RI_CMD_PauseCombatBots 0
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_RalliusID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_RalliusID}
					Actor[Query, ID=${_RalliusID} && IsDead=FALSE]:DoTarget
			}
		}
		;if i have the detrimental
		if ${RIMUIObj.MainIconIDExists[${Me.ID},864]} && !${Zone.Name.Find[Solo](exists)} && ${NONOTNOMORE}
		{
			;echo in if
			;while I still have the detrimental, loop
			while ${RIMUIObj.MainIconIDExists[${Me.ID},864]}
			{
				;echo in loop
				wait 1
			}
			;pause until my Y is > then 175
			RI_CMD_PauseCombatBots 1
			eq2ex cancel_spellcast
			RIMUIObj:SetLockSpot[OFF]
			RIMUIObj:SetRIFollow[ALL,OFF]
			Actor[id,${Me.ID}]:DoTarget
			;echo before while
			while ${Me.Y}<176
				wait 1
			;echo after while
			TimedCommand 50 press -hold space
			RIMUIObj:SetLockSpot[ALL,-172.480133,124.239014,-294.307678]
			wait 150 ${Me.Distance2D[-172.480133,-294.307678]}<3
			wait 20
			press -release space
			RIMUIObj:SetLockSpot[ALL,-182.239761,129.033844,-270.444580]
			RI_CMD_PauseCombatBots 0
			Trigger:Set[0]
		}
		if ${Trigger} && !${Zone.Name.Find[Solo](exists)}
		{
			;pause until my Y is > then 175
			RI_CMD_PauseCombatBots 1
			eq2ex cancel_spellcast
			RIMUIObj:SetLockSpot[OFF]
			RIMUIObj:SetRIFollow[ALL,OFF]
			Actor[id,${Me.ID}]:DoTarget
			while ${Me.Y}<176
				wait 1
			TimedCommand 50 press -hold space
			RIMUIObj:SetLockSpot[ALL,-172.480133,124.239014,-294.307678]
			wait 150 ${Me.Distance2D[-172.480133,-294.307678]}<3
			wait 20
			press -release space
			RIMUIObj:SetLockSpot[ALL,-182.239761,129.033844,-270.444580]
			RI_CMD_PauseCombatBots 0
			Trigger:Set[0]
		}
		if ${Me.Archetype.NotEqual[priest]} && ${Zone.Name.Find[Solo](exists)} && ${Me.Noxious}>0 && ${Me.Inventory[Noxious Remedy](exists)}
		{
			RI_CMD_PauseCombatBots 1
			eq2ex clearabilityqueue
			eq2ex cancel_spellcast
			Me.Inventory[Noxious Remedy]:Use
			wait 5 ${Me.CastingSpell}
			wait 50 !${Me.CastingSpell}
			RI_CMD_PauseCombatBots 0
		}
			
		wait 2
	}
	;call MoveBehind 0
	;wait 2

	
	if ${Me.SubClass.Equal[guardian]}
		Me.Maintained[Focused Offensive]:Cancel
	else
		Me.Maintained[Singular Focus]:Cancel
	RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Battle Coordination,1]
	relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 0
	if !${RI_Var_Bool_GlobalOthers}
		echo ISXRI: Ending Rallius 
	deletevariable _RalliusCoding
	call WaitForLastNamedChest
	call RIMObj.follow
}
;;;;;;;; End Plane of Disease: Outbreak
;;;;;;;; START Plane of Disease: The Source

function Blighthorn()
{
	echo ISXRI: Starting Blighthorn 
	variable int _BlighthornID=${Actor[Query, Name=-"Blighthorn" && IsDead=FALSE].ID}
	
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_BlighthornID} && IsDead=FALSE]:DoTarget
		RIMUIObj:SetLockSpot[ALL,-214.621765,39.023975,276.547791]
		wait 25
		relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
	}
	else
	{
		wait 20
		call MoveBehind ${_BlighthornID}
	}
	
	while ${Actor[Query, ID=${_BlighthornID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=="a blighted festrus" && Distance<15 && IsDead=FALSE && IsAggro=TRUE && Target.ID!=${Me.ID}](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=="a blighted festrus" && Distance<15 && IsDead=FALSE && IsAggro=TRUE && Target.ID!=${Me.ID}].ID}
					Actor[Query, Name=="a blighted festrus" && Distance<15 && IsDead=FALSE && IsAggro=TRUE && Target.ID!=${Me.ID}]:DoTarget
			}
			elseif ${Actor[Query, Name=="a blighted festrus" && Distance<15 && IsDead=FALSE && IsAggro=TRUE](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=="a blighted festrus" && IsDead=FALSE].ID}
					Actor[Query, Name=="a blighted festrus" && IsDead=FALSE]:DoTarget
			}
			elseif ${Actor[Query, ID=${_BlighthornID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_BlighthornID}
					Actor[Query, ID=${_BlighthornID} && IsDead=FALSE]:DoTarget
			}
		}
		;if i have the detrimental
		if ${RIMUIObj.MainIconIDExists[${Me.ID},651,1]}
		{
			while ${RIMUIObj.MainIconIDExists[${Me.ID},651,1]}
			{
				RIMUIObj:SetLockSpot[ALL,-197.141556,30.502598,298.417053]
				;turn off assisting
				RI_CMD_Assisting 0
				Actor[${Me.ID}]:DoTarget
				wait 1
			}
			;turn on assisting
			RI_CMD_Assisting 1
			RIMUIObj:SetLockSpot[OFF]
		}
		
		wait 2
	}
	call MoveBehind 0
	wait 2
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	echo ISXRI: Ending Blighthorn 
}
function Rancine()
{
	echo ISXRI: Starting Rancine 
	variable int _RancineID=${Actor[Query, Name=-"Rancine" && IsDead=FALSE].ID}
	
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_RancineID} && IsDead=FALSE]:DoTarget
		wait 50
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-110.338966,20.445469,516.208740]
		wait 150 ${Math.Distance[${Me.Loc},-110.338966,20.445469,516.208740]}<3
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-110.338966,20.445469,516.208740]
		wait 150 ${Math.Distance[${Me.Loc},-110.338966,20.445469,516.208740]}<3
		wait 600 ${Actor[Query, ID=${_RancineID} && IsDead=FALSE].Distance}<8
		wait 10
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-111.69,20.87,518.85]
	}
	
	while ${Actor[Query, ID=${_RancineID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_RancineID} && IsDead=FALSE](exists)} && ${RIMUIObj.MainIconIDExists[${_RancineID},632]}==0 && !${Actor[Query, Name=-"lesion of doom" && Distance<30](exists)}
			{
				if ${Target.ID}!=${_RancineID}
					Actor[Query, ID=${_RancineID} && IsDead=FALSE]:DoTarget
			}
		}
		if ${Actor[Query, Name=-"budding_lesion" && Distance<10 && Interactable=TRUE](exists)}
			Actor[Query, Name=-"budding_lesion" && Distance<10 && Interactable=TRUE]:DoubleClick
			
		if ${RIMUIObj.MainIconIDExists[${_RancineID},632]}
		{
			if ${Zone.Name.Find[Solo]}
			{
				if ${RIMUIObj.MainIconIDExists[${_RancineID},632]}
				{
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-86.552498,21.786621,490.807404]
					if ${Actor[Query, Name=-"lesion of doom" && Distance<30](exists)}
						Actor[Query, Name=-"lesion of doom" && Distance<30]:DoTarget
					else
						Me:DoTarget
				}
				else
				{
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-111.69,20.87,518.85]
					if ${Target.ID}==${Me.ID}
						eq2ex target_none
				}
			}
			elseif !${RI_Var_Bool_GlobalOthers}
			{
				if ${Actor[Query, Name=-"lesion of doom" && Distance<30](exists)}
					Actor[Query, Name=-"lesion of doom" && Distance<30]:DoTarget
			}
		}
		waitframe
	}
	if !${RI_Var_Bool_GlobalOthers}
	{
		call RIMObj.follow
		call RIMObj.Move -81.888199 22.394815 477.555389
	}
	echo ISXRI: Ending Rancine 
}
function Gryme()
{
	echo ISXRI: Starting Gryme 
	variable int _GrymeID=${Actor[Query, Name=-"Gryme" && IsDead=FALSE].ID}
	
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["calves are exposed"]
	IncomingText:Insert["follows through with a dirty backhand"]
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_GrymeID} && IsDead=FALSE]:DoTarget
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-44.522976,97.219543,-57.057323]
		wait 150 ${Math.Distance[${Me.Loc},-44.522976,97.219543,-57.057323]}<3
		wait 150 ${Actor[Query, ID=${_GrymeID} && IsDead=FALSE].Distance}<8
		wait 25
		relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
	}
	else
	{
		wait 150 ${Math.Distance[${Me.Loc},-44.522976,97.219543,-57.057323]}<3
		wait 150 ${Actor[Query, ID=${_GrymeID} && IsDead=FALSE].Distance}<8
		RIMUIObj:SetLockSpot[OFF]
		call MoveBehind 1
	}
	
	while ${Actor[Query, ID=${_GrymeID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_GrymeID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_GrymeID}
					Actor[Query, ID=${_GrymeID} && IsDead=FALSE]:DoTarget
			}
		}
		if ${Trigger} && ${TriggerMessage.Find[calves are exposed](exists)} || ( ${Actor[Query, ID=${_GrymeID} && IsDead=FALSE].Effect[1].MainIconID}==484 && ${Actor[Query, ID=${_GrymeID} && IsDead=FALSE].Effect[1].CurrentIncrements}>=50 && !${RI_Var_Bool_GlobalOthers} )
		{
			if ( ${Actor[Query, ID=${_GrymeID} && IsDead=FALSE].Effect[1].MainIconID}==484 && ${Actor[Query, ID=${_GrymeID} && IsDead=FALSE].Effect[1].CurrentIncrements}>=50 )
				wait 10
			eq2ex "apply_verb ${Actor[Query, ID=${_GrymeID} && IsDead=FALSE].ID} Bite calf"
			wait 5
			eq2ex "apply_verb ${Actor[Query, ID=${_GrymeID} && IsDead=FALSE].ID} Bite calf"
			wait 5
			eq2ex "apply_verb ${Actor[Query, ID=${_GrymeID} && IsDead=FALSE].ID} Bite calf"
			Trigger:Set[0]
		}
		if ${Trigger} && ${TriggerMessage.Find[follows through with a dirty backhand](exists)}
		{
			RIMUIObj:SetLockSpot[OFF]
			RI_Var_Bool_MoveInFrontIgnoreAggroCheck:Set[1]
			call MoveBehind 0
			call MoveInFront 1
			RI_Var_Bool_MoveInFrontIgnoreAggroCheck:Set[1]
			wait 30
			RI_Var_Bool_MoveInFrontIgnoreAggroCheck:Set[0]
			call MoveInFront 0
			RI_Var_Bool_MoveInFrontIgnoreAggroCheck:Set[0]
			if !${RI_Var_Bool_GlobalOthers}
				RIMUIObj:SetLockSpot[ALL,-44.522976,97.219543,-57.057323]
			else
				call MoveBehind 1
			Trigger:Set[FALSE]
		}
		wait 1
	}
	call MoveBehind 0
	wait 2
	if !${RI_Var_Bool_GlobalOthers}	
		call RIMObj.follow
	echo ISXRI: Ending Gryme 
}
function Darwol()
{
	variable int _DarwolID=${Actor[Query, Name=-"Darwol Adan" && IsDead=FALSE].ID}
	IncomingText:Clear
	IncomingText2:Clear
	AnnounceText:Clear
	;IncomingText:Insert["Darwol's affliction washes over you as he prepares to devour your souls"]
	IncomingText:Insert["prepares to devour the souls"]
	
	if ${Zone.Name.Find[Solo]}
	{	
		echo ISXRI: Starting Darwol (Solo)
		echo ISXRI: Waiting for Darwol Adan to be within 20m
		while ${Actor[Query, ID=${_DarwolID}].Distance}>20
			wait 5
		if !${RI_Var_Bool_GlobalOthers}
		{
			Actor[Query, ID=${_DarwolID} && IsDead=FALSE]:DoTarget
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-137.564545,-516.963318,-301.691345]
		}
		while ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
		{
			if !${RI_Var_Bool_GlobalOthers}
			{
				if ${Actor[Query, ID=${_barrelid} && IsDead=FALSE](exists)}
				{
					if ${Target.ID}!=${Actor[Query, Name=-"a barrel of volatile pus" && IsDead=FALSE].ID}
						Actor[Query, Name=-"a barrel of volatile pus" && IsDead=FALSE]:DoTarget
				}
				elseif ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
				{
					if ${Target.ID}!=${_DarwolID}
						Actor[Query, ID=${_DarwolID} && IsDead=FALSE]:DoTarget
				}
				if ${Trigger}
				{
					RIMUIObj:SetLockSpot[OFF]
					RIMUIObj:SetRIFollow[OFF]
					Trigger:Set[FALSE]
					RIMUIObj:SetLockSpot[ALL,${Actor["Pus Barrel"].Loc}]
					wait 150 ${Me.Distance2D[${Actor["Pus Barrel"].X},${Actor["Pus Barrel"].Z}]}<3 || !${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
					if ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
						Actor[Pus Barrel]:DoubleClick;wait 2
					if ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
						Actor[Pus Barrel]:DoubleClick
					if ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
					{
						RIMUIObj:SetLockSpot[ALL,${Actor["Darwol Adan"].Loc},5]
						wait 150 ${Me.Distance2D[${Actor["Darwol Adan"].X},${Actor["Darwol Adan"].Z}]}<6 || !${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
						wait 5
					}
					if ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
						call PlaceHouseItem
					if ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
						
					if ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
						RIMUIObj:SetLockSpot[ALL,-137.564545,-516.963318,-301.691345]
				}
			}
			wait 1
		}
	}
	else
	{
		echo ISXRI: Starting Darwol (Heroic)
		AnnounceText:Insert["The exploding barrel of pus has interrupted Darwol's devouring"]
		echo ISXRI: Waiting for Darwol Adan to be within 20m
		while ${Actor[Query, ID=${_DarwolID}].Distance}>20
			wait 5
		variable string _greatestalpha
		;lets determine who in the group has the LowestName in the Alpha and is not healer or tank
		if ${Me.Archetype.NotEqual[priest]} && ${Me.Archetype.NotEqual[fighter]} 
		{
			variable int _gcnt=0
			_greatestalpha:Set[${Me.Name}]
			for(_gcnt:Set[1];${_gcnt}<${Me.Group};_gcnt:Inc)
			{
				if ${Me.Group[${_gcnt}].Name.Compare[${_greatestalpha}]}>0 && ${Me.Group[${_gcnt}].Class.NotEqual[guardian]} && ${Me.Group[${_gcnt}].Class.NotEqual[berserker]} && ${Me.Group[${_gcnt}].Class.NotEqual[monk]} && ${Me.Group[${_gcnt}].Class.NotEqual[bruiser]} && ${Me.Group[${_gcnt}].Class.NotEqual[paladin]} && ${Me.Group[${_gcnt}].Class.NotEqual[shadowknight]} && ${Me.Group[${_gcnt}].Class.NotEqual[defiler]} && ${Me.Group[${_gcnt}].Class.NotEqual[mystic]} && ${Me.Group[${_gcnt}].Class.NotEqual[warden]} && ${Me.Group[${_gcnt}].Class.NotEqual[fury]} && ${Me.Group[${_gcnt}].Class.NotEqual[templar]} && ${Me.Group[${_gcnt}].Class.NotEqual[inquisitor]} && ${Me.Group[${_gcnt}].Class.NotEqual[channeler]}
					_greatestalpha:Set[${Me.Group[${_gcnt}].Name}]
			}
		}
		else
			_greatestalpha:Set[****]

		;set lockspot
		if !${RI_Var_Bool_GlobalOthers}
		{
			Actor[Query, ID=${_DarwolID} && IsDead=FALSE]:DoTarget
			RIMUIObj:SetLockSpot[ALL,-137.564545,-516.963318,-301.691345]
			wait 25
			relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
		}
		elseif ${_greatestalpha.NotEqual[${Me.Name}]}
		{
			wait 20
			call MoveBehind 1
		}
		else
		{
			RIMUIObj:SetLockSpot[OFF]
			RIMUIObj:SetRIFollow[OFF]
			Trigger:Set[FALSE]
			call MoveBehind 0
			RIMUIObj:SetLockSpot[ALL,${Actor["Pus Barrel"].Loc}]
			wait 150 ${Me.Distance2D[${Actor["Pus Barrel"].X},${Actor["Pus Barrel"].Z}]}<3 || !${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
			if ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
				Actor[Pus Barrel]:DoubleClick;wait 2
			if ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
				Actor[Pus Barrel]:DoubleClick
			if ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
			{
				RIMUIObj:SetLockSpot[ALL,${Actor["Darwol Adan"].Loc},5]
				wait 150 ${Me.Distance2D[${Actor["Darwol Adan"].X},${Actor["Darwol Adan"].Z}]}<6 || !${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
				wait 5
			}
			if ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
				call PlaceHouseItem
			if ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
				call MoveBehind 1
		}
		variable int _barrelid=0
		while ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
		{
			if !${RI_Var_Bool_GlobalOthers}
			{
				if ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
				{
					if ${Target.ID}!=${_DarwolID}
						Actor[Query, ID=${_DarwolID} && IsDead=FALSE]:DoTarget
				}
				if ${Trigger} && ${TriggerMessage.Find[prepares to devour the souls]}
				{
					Trigger:Set[FALSE]
					while !${Actor[Query, Name=-"a barrel of volatile pus" && IsDead=FALSE](exists)}
						wait 2
					if ${Actor[Query, Name=-"a barrel of volatile pus" && IsDead=FALSE](exists)}
					{
						_barrelid:Set[${Actor[Query, Name=-"a barrel of volatile pus" && IsDead=FALSE].ID}]
						while ${Actor[Query, ID=${_barrelid} && IsDead=FALSE](exists)}
						{
							if ${Target.ID}!=${Actor[Query, Name=-"a barrel of volatile pus" && IsDead=FALSE].ID}
								Actor[Query, Name=-"a barrel of volatile pus" && IsDead=FALSE]:DoTarget
							wait 1
						}
					}
				}
			}
			if ${Trigger} && ${_greatestalpha.Equal[${Me.Name}]} && ${TriggerMessage.Find[The exploding barrel of pus has interrupted Darwol's devouring]}
			{
				RIMUIObj:SetLockSpot[OFF]
				RIMUIObj:SetRIFollow[OFF]
				Trigger:Set[FALSE]
				call MoveBehind 0
				RIMUIObj:SetLockSpot[ALL,${Actor["Pus Barrel"].Loc}]
				wait 150 ${Me.Distance2D[${Actor["Pus Barrel"].X},${Actor["Pus Barrel"].Z}]}<3 || !${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
				if ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
					Actor[Pus Barrel]:DoubleClick;wait 2
				if ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
					Actor[Pus Barrel]:DoubleClick
				if ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
				{
					RIMUIObj:SetLockSpot[ALL,${Actor["Darwol Adan"].Loc},5]
					wait 150 ${Me.Distance2D[${Actor["Darwol Adan"].X},${Actor["Darwol Adan"].Z}]}<6 || !${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
					wait 5
				}
				if ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
					call PlaceHouseItem
				if ${Actor[Query, ID=${_DarwolID} && IsDead=FALSE](exists)}
					call MoveBehind 1
			}
			wait 1
		}
	}
	if !${RI_Var_Bool_GlobalOthers}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[OFF]
		call MoveBehind 0
		wait 150 ${Actor[Query, Name=-"Wavadozzik Adan" && IsDead=FALSE](exists)}
		wait 150 ${RIMObj.AllGroupInZone}
		call RIMObj.follow
		wait 150 ${RIMObj.AllGroupWithinRange[3]}
		variable int _cnter=0
		while ${Me.Distance2D[-35.893078,96.041214]}>3 && ${_cnter:Inc}<300
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-35.893078,-517.114319,96.041214]
			wait 1
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-81.123589,-521.433044,100.581055]
		wait 150 ${Me.Distance2D[-81.123589,100.581055]}<3
		variable int _WavadozzikID=${Actor[Query, Name=-"Wavadozzik Adan" && IsDead=FALSE].ID}
		
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_WavadozzikID} && IsDead=FALSE].Loc},5]
		Actor[Query, ID=${_WavadozzikID} && IsDead=FALSE]:DoTarget
		wait 150 ${Math.Distance[${Me.Loc},${Actor[Query, ID=${_WavadozzikID} && IsDead=FALSE].Loc}]}<8
		Actor[Query, ID=${_WavadozzikID} && IsDead=FALSE]:DoTarget
	}
	variable int _Nest1ID
	variable int _Nest2ID
	variable int _Nest3ID
	variable int _Nest4ID
	
	while ${Actor[Query, ID=${_WavadozzikID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_WavadozzikID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_WavadozzikID}
					Actor[Query, ID=${_WavadozzikID} && IsDead=FALSE]:DoTarget
			}
			if ${Actor[Query, Name=-"an arachnae nest" && IsDead=FALSE && Type=="NPC"](exists)}
			{
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-82.285934,-521.090698,87.611549]
				wait 150 ${Math.Distance[${Me.Loc},-82.285934,-521.090698,87.611549]}<3
				_Nest1ID:Set[${Actor[Query, Name=-"an arachnae nest" && IsDead=FALSE && Type=="NPC"].ID}]
				while ${Actor[Query, ID=${_Nest1ID} && IsDead=FALSE](exists)}
				{
					if !${RI_Var_Bool_GlobalOthers}
					{
						if ${Actor[Query, ID=${_Nest1ID} && IsDead=FALSE](exists)}
						{
							if ${Target.ID}!=${_Nest1ID}
								Actor[Query, ID=${_Nest1ID} && IsDead=FALSE]:DoTarget
							Actor[Query, ID=${_Nest1ID} && IsDead=FALSE]:DoFace
						}
					}
					if ${Actor[Query, ID=${_Nest1ID} && IsDead=FALSE].Distance}>30
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_Nest1ID} && IsDead=FALSE].Loc},30,500]
					wait 2
				}
				_Nest2ID:Set[${Actor[Query, Name=-"an arachnae nest" && IsDead=FALSE && Type=="NPC"].ID}]
				while ${Actor[Query, ID=${_Nest2ID} && IsDead=FALSE](exists)}
				{
					if !${RI_Var_Bool_GlobalOthers}
					{
						if ${Actor[Query, ID=${_Nest2ID} && IsDead=FALSE](exists)}
						{
							if ${Target.ID}!=${_Nest2ID}
								Actor[Query, ID=${_Nest2ID} && IsDead=FALSE]:DoTarget
							Actor[Query, ID=${_Nest1ID} && IsDead=FALSE]:DoFace
						}
					}
					if ${Actor[Query, ID=${_Nest2ID} && IsDead=FALSE].Distance}>30
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_Nest2ID} && IsDead=FALSE].Loc},30,500]
					wait 2
				}
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-67.848167,-521.433044,121.959526]
				wait 150 ${Math.Distance[${Me.Loc},-67.848167,-521.433044,121.959526]}<3
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-81.447945,-521.090759,155.660599]
				wait 150 ${Math.Distance[${Me.Loc},-81.447945,-521.090759,155.660599]}<3
				_Nest3ID:Set[${Actor[Query, Name=-"an arachnae nest" && IsDead=FALSE && Type=="NPC"].ID}]
				while ${Actor[Query, ID=${_Nest3ID} && IsDead=FALSE](exists)}
				{
					if !${RI_Var_Bool_GlobalOthers}
					{
						if ${Actor[Query, ID=${_Nest3ID} && IsDead=FALSE](exists)}
						{
							if ${Target.ID}!=${_Nest3ID}
								Actor[Query, ID=${_Nest3ID} && IsDead=FALSE]:DoTarget
							Actor[Query, ID=${_Nest1ID} && IsDead=FALSE]:DoFace
						}
					}
					if ${Actor[Query, ID=${_Nest3ID} && IsDead=FALSE].Distance}>30
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_Nest3ID} && IsDead=FALSE].Loc},30,500]
					wait 2
				}
				_Nest4ID:Set[${Actor[Query, Name=-"an arachnae nest" && IsDead=FALSE && Type=="NPC"].ID}]
				while ${Actor[Query, ID=${_Nest4ID} && IsDead=FALSE](exists)}
				{
					if !${RI_Var_Bool_GlobalOthers}
					{
						if ${Actor[Query, ID=${_Nest4ID} && IsDead=FALSE](exists)}
						{
							if ${Target.ID}!=${_Nest4ID}
								Actor[Query, ID=${_Nest4ID} && IsDead=FALSE]:DoTarget
							Actor[Query, ID=${_Nest1ID} && IsDead=FALSE]:DoFace
						}
					}
					if ${Actor[Query, ID=${_Nest4ID} && IsDead=FALSE].Distance}>30
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_Nest4ID} && IsDead=FALSE].Loc},30,500]
					wait 2
				}
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-33.483803,-516.559875,121.770721]
				wait 150 ${Math.Distance[${Me.Loc},-33.483803,-516.559875,121.770721]}<3
				;set lockspot
				Actor[Query, ID=${_WavadozzikID} && IsDead=FALSE]:DoTarget
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-33.483803,-516.559875,121.770721]
				wait 150 ${Me.Distance2D[-33.483803,121.770721]}<3
				wait 150 ${Actor[Query, ID=${_WavadozzikID} && IsDead=FALSE].Distance}<10
				relay "other ${RI_Var_String_RelayGroup}" RI_Var_Bool_MoveCBImmunity:Set[1]
				relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[OFF]
				wait 5
				relay "other ${RI_Var_String_RelayGroup}" RI_Atom_MoveBehind ALL ${_WavadozzikID} 30 99
				wait 5
				relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
			}
		}
		
		wait 2
	}
	
	call MoveBehind 0
	wait 2
	if !${RI_Var_Bool_GlobalOthers}	
		call RIMObj.follow
	echo ISXRI: Ending Darwol 
}
function SourceSigCheck()
{
	if ${QuestJournalWindow.ActiveQuest[Legacy of Power: Realm of the Plaguebringer](exists)}
	{
		wait 1200
	}
	else
		wait 300
}
function Bhaly()
{
	call WaitForLastNamedChest START
	echo ISXRI: Starting Bhaly 
	variable int _BhalyID=${Actor[Query, Name=-"Bhaly Adan" && IsDead=FALSE].ID}
	variable int _ManifestationID=${Actor[Query, Name=-"Manifestation of Disease" && IsDead=FALSE].ID}
	variable int _Orb1ID
	variable int _Orb2ID
	variable int _Orb3ID
	variable int _Orb4ID
	RI_Var_Int_MoveDistanceMod:Set[6]
	;disable cloak of divinity
	RI_CMD_AbilityEnableDisable "Cloak of Divinity" 0
	RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Absorb Magic,0]
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers} || ${Zone.Name.Find[Solo]}
	{
		Actor[Query, ID=${_BhalyID} && IsDead=FALSE]:DoTarget
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,4.619247,-473.034576,-90.528389]
	}
	wait 150 ${Math.Distance[${Me.Loc},4.619247,-473.034576,-90.528389]}<3
	wait 20
	variable bool _Placed=0
	while ${Actor[Query, ID=${_BhalyID} && IsDead=FALSE](exists)}
	{
		if ${Actor[Query, Name=-"Primordial" && IsDead=FALSE && Distance<10 && Health<26](exists)}
		{
			call RIObj.MageAbsorbMagic ${Actor[Query, Name=-"Primordial" && IsDead=FALSE && Distance<10 && Health<26].ID} 1010
		}
		if !${RI_Var_Bool_GlobalOthers}
		{
			if !${Actor[Query, ID=${_ManifestationID} && IsDead=FALSE](exists)} && !${_Placed}
			{
				RIMUIObj:SetLockSpot[ALL,-8.555428,-473.034363,-91.374184,2,500]
				wait 150 ${Math.Distance[${Me.Loc},-8.555428,-473.034363,-91.374184]}<3
			}
			if ${Actor[Query, Name=-"cultist" && IsDead=FALSE && Distance<10](exists)}
			{
				if ${Actor[Query, ID=${_ManifestationID} && IsDead=FALSE](exists)}
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-0.679394,-473.034485,-90.759888,2,500]
				if ${Target.ID}!=${Actor[Query, Name=-"cultist" && IsDead=FALSE && Distance<10].ID}
					Actor[Query, Name=-"cultist" && IsDead=FALSE && Distance<10]:DoTarget
			}
			; elseif ${Actor[Query, Name=-"Primordial" && IsDead=FALSE && Distance<10](exists)}
			; {
				; if ${Target.ID}!=${Actor[Query, Name=-"Primordial" && IsDead=FALSE && Distance<10].ID}
					; Actor[Query, Name=-"Primordial" && IsDead=FALSE && Distance<10]:DoTarget
			; }
			elseif ${Actor[Query, ID=${_ManifestationID} && Distance<10 && IsDead=FALSE](exists)}
			{
				relay "other {RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,-8.555428,-473.034363,-91.374184,2,500,2,500]
				if ${Target.ID}!=${_ManifestationID}
					Actor[Query, ID=${_ManifestationID} && IsDead=FALSE]:DoTarget
			}
			elseif ${Actor[Query, ID=${_BhalyID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_BhalyID}
					Actor[Query, ID=${_BhalyID} && IsDead=FALSE]:DoTarget
			}
		}
		if ${Actor[Query, Name=-"Infected Microbe" && IsDead=FALSE && Overlay=="design_sphere_green_no_glow"](exists)} && !${Actor[Query, Name=-"cultist" && IsDead=FALSE && Distance<10](exists)}
		{
			if !${RI_Var_Bool_GlobalOthers}
			{
				if ${Actor[Query, Name=-"cultist" && IsDead=FALSE && Distance<10](exists)}
				{
					if ${Target.ID}!=${Actor[Query, Name=-"cultist" && IsDead=FALSE && Distance<10].ID}
						Actor[Query, Name=-"cultist" && IsDead=FALSE && Distance<10]:DoTarget
				}
				elseif ${Actor[Query, Name=-"Primordial" && IsDead=FALSE && Distance<10](exists)}
				{
					if ${Target.ID}!=${Actor[Query, Name=-"Primordial" && IsDead=FALSE && Distance<10].ID}
						Actor[Query, Name=-"Primordial" && IsDead=FALSE && Distance<10]:DoTarget
				}
				elseif ${Actor[Query, ID=${_BhalyID} && IsDead=FALSE](exists)}
				{
					if ${Target.ID}!=${_BhalyID}
						Actor[Query, ID=${_BhalyID} && IsDead=FALSE]:DoTarget
				}
			}
			;call PreHeal
			wait 5
			RIMUIObj:SetLockSpot[ALL,64.270439,-483.178680,-90.064362,2,500]
			wait 150 ${Math.Distance[${Me.Loc},64.270439,-483.178680,-90.064362]}<3
			_Orb1ID:Set[${Actor[Query, Name=-"Infected Microbe" && IsDead=FALSE && Distance<20 && Overlay=="design_sphere_green_no_glow"].ID}]
			while ${Actor[Query, ID=${_Orb1ID} && IsDead=FALSE].Overlay.Equal["design_sphere_green_no_glow"]}
			{
				Actor[Query, ID=${_Orb1ID} && IsDead=FALSE]:DoubleClick
				wait 2
			}
			;call PreHeal
			wait 5
			RIMUIObj:SetLockSpot[ALL,-7.936667,-482.834015,-147.8382729,2,500]
			wait 150 ${Math.Distance[${Me.Loc},-7.936667,-482.834015,-147.838272]}<3
			_Orb2ID:Set[${Actor[Query, Name=-"Infected Microbe" && IsDead=FALSE && Distance<20 && Overlay=="design_sphere_green_no_glow"].ID}]
			while ${Actor[Query, ID=${_Orb2ID} && IsDead=FALSE].Overlay.Equal["design_sphere_green_no_glow"]}
			{
				Actor[Query, ID=${_Orb2ID} && IsDead=FALSE]:DoubleClick
				wait 2
			}
			wait 5
			;cast Clock of Divinity
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Cast[ALL,Cloak of Divinity,1]
			wait 5
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Cast[ALL,Cloak of Divinity,1]
			wait 5
			Actor[Query, ID=${_ManifestationID} && IsDead=FALSE]:DoTarget
			;call PreHeal
			wait 5
			RIMUIObj:SetLockSpot[ALL,-79.244186,-483.178680,-89.907211,2,500]
			wait 150 ${Math.Distance[${Me.Loc},-79.244186,-483.178680,-89.907211]}<3
			_Orb3ID:Set[${Actor[Query, Name=-"Infected Microbe" && IsDead=FALSE && Distance<20 && Overlay=="design_sphere_green_no_glow"].ID}]
			while ${Actor[Query, ID=${_Orb3ID} && IsDead=FALSE].Overlay.Equal["design_sphere_green_no_glow"]}
			{
				Actor[Query, ID=${_Orb3ID} && IsDead=FALSE]:DoubleClick
				wait 2
			}
			;call PreHeal
			wait 5
			RIMUIObj:SetLockSpot[ALL,-7.106198,-482.834045,-30.564457,2,500]
			wait 150 ${Math.Distance[${Me.Loc},-7.106198,-482.834045,-30.564457]}<3
			_Orb4ID:Set[${Actor[Query, Name=-"Infected Microbe" && IsDead=FALSE && Distance<20 && Overlay=="design_sphere_green_no_glow"].ID}]
			while ${Actor[Query, ID=${_Orb4ID} && IsDead=FALSE].Overlay.Equal["design_sphere_green_no_glow"]}
			{
				Actor[Query, ID=${_Orb4ID} && IsDead=FALSE]:DoubleClick
				wait 2
			}
			;call PreHeal
			wait 5
			RIMUIObj:SetLockSpot[ALL,38.271618,-482.833191,-90.715889,2,500]
			wait 150 ${Math.Distance[${Me.Loc},38.271618,-482.833191,-90.715889]}<3
			if !${RI_Var_Bool_GlobalOthers}
			{
				RIMUIObj:SetLockSpot[ALL,-0.679394,-473.034485,-90.759888,2,500]
				wait 150 ${Math.Distance[${Me.Loc},-0.679394,-473.034485,-90.759888]}<3
			}
			else
			{
				RIMUIObj:SetLockSpot[ALL,-8.555428,-473.034363,-91.374184,2,500]
				wait 150 ${Math.Distance[${Me.Loc},-8.555428,-473.034363,-91.374184]}<3
			}
		}
		if !${Actor[Query, ID=${_ManifestationID} && IsDead=FALSE](exists)} && !${RI_Var_Bool_GlobalOthers}
		{
			call MoveBehind ${_BhalyID} 30 99
		}
		wait 2
	}
	RI_Var_Int_MoveDistanceMod:Set[1]
	RI_CMD_AbilityEnableDisable "Cloak of Divinity" 1
	call WaitForLastNamedChest
	if !${RI_Var_Bool_GlobalOthers}	
		call RIMObj.follow
	wait 5
	call RIMObj.LootChest
	wait 5
	call RIMObj.LootChest
	echo ISXRI: Ending Bhaly 
}
;;;;;;;; End Plane of Disease: The Source
;;;;;;;; Start Torden, Bastion of Thunder: Tower Breach
function Auliffe()
{
	
	if ${Actor[Query, Name=-"Auliffe Chaoswind" && IsDead=FALSE && Type!="Chest"].ID}<1
		return
	
	echo ISXRI: Starting Auliffe
	variable int _AuliffeID=${Actor[Query, Name=-"Auliffe Chaoswind" && IsDead=FALSE && Type!="Chest"].ID}
	variable int _tempcnt
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["Let's see how well you scramble"]
	IncomingText:Insert["you are locked in here with ME"]
	;if ${Zone.Name.Find[Solo]}
	if ${RI_Var_Bool_GlobalOthers}
	{
		RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
		RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
		RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
		eq2ex pet backoff
	}
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_AuliffeID} && IsDead=FALSE]:DoTarget
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,659.083679,309.283508,-631.769409]
		wait 150 ${Math.Distance[${Me.Loc},659.083679,309.283508,-631.769409]}<3
		wait 150 ${Actor[Query, ID=${_AuliffeID} && IsDead=FALSE].Distance2D}<20
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,680.178101,309.283508,-650.392883]
		;wait 150 ${Math.Distance[${Me.Loc},680.178101,309.283508,-650.392883]}<3
		; wait 150 ${Actor[Query, ID=${_AuliffeID} && IsDead=FALSE].Distance}<12
		; wait 10
		; relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
	}
	; else
	; {
		; wait 150 ${Math.Distance[${Me.Loc},661.291321,309.283508,-635.154053]}<3
		; wait 150 ${Actor[Query, ID=${_AuliffeID} && IsDead=FALSE].Distance}<12
		; RIMUIObj:SetLockSpot[OFF]
		; call MoveBehind 1
	; }
	while ${Actor[Query, ID=${_AuliffeID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_AuliffeID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_AuliffeID}
					Actor[Query, ID=${_AuliffeID} && IsDead=FALSE]:DoTarget
			}
			if ${Trigger}
			{
				;echo trigger
				Trigger:Set[FALSE]
				if ${TriggerMessage.Find[Let's see how well you scramble]}
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,692.527771,309.283508,-661.921509]
				press f1
				;else
				if ${TriggerMessage.Find[Let's see how well you scramble]}
					wait 70
				else
					wait 80
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,680.178101,309.283508,-650.392883]
				
				;wait 80

				;relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[OFF]
			}
			wait 1
		}
		
		wait 2
	}
	;call MoveBehind 0
	wait 2
	if ${Actor[Query, ID=${_AuliffeID}](exists)}
	{
		RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_AuliffeID}].Loc}]
		wait 150 ${Math.Distance[${Me.Loc},${Actor[Query, ID=${_AuliffeID}].Loc}]}<3
	}
	RIMUIObj:SetLockSpot[ALL,666.178101,309.283508,-638.392883]
	wait 150 ${Math.Distance[${Me.Loc},661.291321,309.283508,-635.154053]}<3
	if !${RI_Var_Bool_GlobalOthers}	
		call RIMObj.follow
	;if ${Zone.Name.Find[Solo]}
	;{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
	;}
	echo ISXRI: Ending Auliffe 
}
function Lore()
{
	
	echo ISXRI: Starting Lore
	variable int _LoreID=${Actor[Query, Name=-"Keeper of Past Lore" && IsDead=FALSE].ID}
	variable string _LockSpot
	if !${Zone.Name.Find[Solo]}
	{
		call LockAndWait -Loc -1390.706543,290.014923,-1286.668335
		call LockAndWait -Loc -1330.145874,296.368896,-1304.664795
		call LockAndWait -Loc -1329.486450,298.381042,-1301.803345
		call LockAndWait -Loc -1318.916870,297.089081,-1304.852905
		call LockAndWait -Loc -1275.776245,294.872833,-1336.353394
		_LockSpot:Set["-1272.124512,294.935974,-1350.713013"]
	}
	else
		_LockSpot:Set["-1454.311401,289.407074,-1296.604370"]
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		RIMUIObj:SetLockSpot[ALL,${_LockSpot}]
		wait 150 ${Math.Distance[${Me.Loc},${_LockSpot}]}<3
		wait 150 ${RIMObj.AllGroupWithinRange[3]}
		Actor[Query, ID=${_LoreID} && IsDead=FALSE]:DoTarget
		wait 150 ${Actor[Query, ID=${_LoreID} && IsDead=FALSE].Distance}<12
		wait 50
		relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
	}
	else
	{
		RIMUIObj:SetLockSpot[ALL,${_LockSpot}]
		wait 150 ${Math.Distance[${Me.Loc},${_LockSpot}]}<3
		wait 150 ${RIMObj.AllGroupWithinRange[3]}
		wait 150 ${Actor[Query, ID=${_LoreID} && IsDead=FALSE].Distance}<12
		wait 50
		RIMUIObj:SetLockSpot[OFF]
		call MoveBehind 1
	}
	while ${Actor[Query, ID=${_LoreID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_LoreID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_LoreID}
					Actor[Query, ID=${_LoreID} && IsDead=FALSE]:DoTarget
			}
			wait 1
		}
		
		wait 2
	}
	wait 20
	variable int cid
	cid:Set[${Actor[chest].ID}]
	eq2ex apply_verb ${Actor[chest].ID} Summon
	eq2ex summon ${Actor[chest].ID}
	wait 100 ( !${Actor[id,${cid}](exists)} || !${Actor[id,${cid}].Name(exists)} )
	
	;call MoveBehind 0
	wait 2
	if !${RI_Var_Bool_GlobalOthers}	
		call RIMObj.follow
	if !${Zone.Name.Find[Solo]}
	{
		call LockAndWait -Loc -1275.776245,294.872833,-1336.353394
		call LockAndWait -Loc -1318.916870,297.089081,-1304.852905
		call LockAndWait -Loc -1329.486450,298.381042,-1301.803345
		call LockAndWait -Loc -1330.145874,296.368896,-1304.664795
		call LockAndWait -Loc -1390.706543,290.014923,-1286.668335
	}
	echo ISXRI: Ending Lore 
}
function Gaukr()
{
	echo ISXRI: Starting Gaukr 
	if ${Zone.Name.Find["[Expert]"]}
		call WaitForLastNamedChest START
	variable int _GaukrID=${Actor[Query, Name=-"Gaukr" && IsDead=FALSE].ID}
	RIMUIObj:SetLockSpot[ALL,-659.077087,309.283508,-631.439575]
	while ${Actor[Query, ID=${_GaukrID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_GaukrID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_GaukrID}
					Actor[Query, ID=${_GaukrID} && IsDead=FALSE]:DoTarget
			}
			wait 1
		}
		
		wait 2
	}
	if ${Zone.Name.Find["[Expert]"]}
		call WaitForLastNamedChest
	;call MoveBehind 0
	wait 2
	if !${RI_Var_Bool_GlobalOthers}	
		call RIMObj.follow
	echo ISXRI: Ending Gaukr 
}
;;;;;;;; End Torden, Bastion of Thunder: Tower Breach
;;;;;;;; Start Torden, Bastion of Thunder: Storm Chase
function Tsc3planes1()
{
	if !${RI_Var_Bool_GlobalOthers}
	{
		relay "other ${RI_Var_String_RelayGroup}" Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Tsc3planes1"]
	}
	if ${Zone.Name.Find[Duo]}
	{
		call LockAndWait -Loc "-874.859985,346.520013,-788.219971"
		wait 1200 ${Actor[Query, Name=-"a sand strider" && Distance<100 && IsDead=FALSE](exists)}
		wait 50
		if !${RI_Var_Bool_GlobalOthers}
			Actor[a sand strider]:DoTarget
		RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=-"a sand strider" && Distance<100 && IsDead=FALSE].Loc},35,1000]
		wait 150 ${Actor[Query, Name=-"a sand strider" && Distance<100].Distance}<10
		variable index:actor Actors
		variable iterator ActorIterator
		
		EQ2:QueryActors[Actors, Type=-"NPC" && Distance<=100 && Name=-"a sand strider"]
		Actors:GetIterator[ActorIterator]
		while ${Actor[Query, Name=-"a sand strider" && Distance<100 && IsDead=FALSE](exists)}
		{
			EQ2:QueryActors[Actors, Type=-"NPC" && Distance<=100 && Name=-"a sand strider"]
			Actors:GetIterator[ActorIterator]
			if ${Actors.Used}==3
				RIMUIObj:SetLockSpot[ALL,-874.859985,346.520013,-788.219971]
			elseif ${Actors.Used}==2
				RIMUIObj:SetLockSpot[ALL,-882.070007,346.500024,-828.899963]
			elseif ${Actors.Used}==1
				RIMUIObj:SetLockSpot[ALL,-914.989990,346.500024,-783.119995]
			if ${ActorIterator:First(exists)} && !${RI_Var_Bool_GlobalOthers}
			{
				do
				{
					;echo "${ActorIterator.Value.ID}" - "${ActorIterator.Value.Name} - ${ActorIterator.Value.Type}"
					;Actor[id,${ActorIterator.Value.ID}]:DoubleClick
					;ActorIterator.Value:DoubleClick
					;eq2ex Apply_Verb ${ActorIterator.Value.ID} \"Push Plate\"
					if ${RIMUIObj.MainIconIDExists[${ActorIterator.Value.ID},872]}
						noop
					elseif ${Target.ID}!=${ActorIterator.Value.ID}
						Actor[id,${ActorIterator.Value.ID}]:DoTarget
				}
				while ${ActorIterator:Next(exists)}
			}
			wait 5
		}
	}
	else
	{
		if ${Me.Class.Equal[bard]}
			call LockAndWait -Loc "-882.070007,346.500024,-828.899963"
		elseif ${Me.Class.Equal[enchanter]}
			call LockAndWait -Loc "-914.989990,346.500024,-783.119995"
		else
			call LockAndWait -Loc "-874.859985,346.520013,-788.219971"
		wait 1200 ${Actor[Query, Name=-"a sand strider" && Distance<100 && IsDead=FALSE](exists)}
		wait 50
		if !${RI_Var_Bool_GlobalOthers}
			Actor[a sand strider]:DoTarget
		while ${Actor[Query, Name=-"a sand strider" && Distance<100 && IsDead=FALSE](exists)}
		{
			if !${RI_Var_Bool_GlobalOthers}
				Actor[Query, Name=-a sand strider && IsDead=FALSE]:DoTarget
			wait 1
		}
	}
	call LockAndWait -Loc "-868.576355,346.419586,-783.073730"
	wait 50
	call RIMObj.LootChest
}

function Tsc3planes2()
{
	if !${RI_Var_Bool_GlobalOthers}
	{
		relay "other ${RI_Var_String_RelayGroup}" Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Tsc3planes1"]
	}
	if ${Zone.Name.Find[Duo]}
	{
		call LockAndWait -Loc "-838.159973,346.420013,-760.369995"
		wait 1200 ${Actor[Query, Name=-"a sand strider" && Distance<100 && IsDead=FALSE](exists)}
		wait 50
		if !${RI_Var_Bool_GlobalOthers}
			Actor[a sand strider]:DoTarget
		wait 150 ${Actor[Query, Name=-"a sand strider" && Distance<100].Distance && IsDead=FALSE}<10
		variable index:actor Actors
		variable iterator ActorIterator
		
		EQ2:QueryActors[Actors, Type=-"NPC" && Distance<=100 && Name=-"a sand strider"]
		Actors:GetIterator[ActorIterator]
		
		while ${Actor[Query, Name=-"a sand strider" && Distance<100 && IsDead=FALSE](exists)}
		{
			EQ2:QueryActors[Actors, Type=-"NPC" && Distance<=100 && Name=-"a sand strider"]
			Actors:GetIterator[ActorIterator]
			if ${Actors.Used}==3
				RIMUIObj:SetLockSpot[ALL,-838.159973,346.420013,-760.369995]
			elseif ${Actors.Used}==2
				RIMUIObj:SetLockSpot[ALL,-877.779968,346.410004,-757.190002]
			elseif ${Actors.Used}==1
				RIMUIObj:SetLockSpot[ALL,-852.159973,346.410004,-802.769958]
			if ${ActorIterator:First(exists)} && !${RI_Var_Bool_GlobalOthers}
			{
				do
				{
					;echo "${ActorIterator.Value.ID}" - "${ActorIterator.Value.Name} - ${ActorIterator.Value.Type}"
					;Actor[id,${ActorIterator.Value.ID}]:DoubleClick
					;ActorIterator.Value:DoubleClick
					;eq2ex Apply_Verb ${ActorIterator.Value.ID} \"Push Plate\"
					if ${RIMUIObj.MainIconIDExists[${ActorIterator.Value.ID},872]}
						noop
					elseif ${Target.ID}!=${ActorIterator.Value.ID}
						Actor[id,${ActorIterator.Value.ID}]:DoTarget
				}
				while ${ActorIterator:Next(exists)}
			}
			wait 5
		}
	}
	else
	{
		if ${Me.Class.Equal[bard]}
			call LockAndWait -Loc "-877.779968,346.410004,-757.190002"
		elseif ${Me.Class.Equal[enchanter]}
			call LockAndWait -Loc "-852.159973,346.410004,-802.769958"
		else
			call LockAndWait -Loc "-838.159973,346.420013,-760.369995"
		wait 1200 ${Actor[Query, Name=-"a sand strider" && Distance<100 && IsDead=FALSE](exists)}
		wait 50
		if !${RI_Var_Bool_GlobalOthers}
			Actor[a sand strider]:DoTarget
		while ${Actor[Query, Name=-"a sand strider" && Distance<100 && IsDead=FALSE](exists)}
		{
			if !${RI_Var_Bool_GlobalOthers}
				Actor[Query, Name=-a sand strider && IsDead=FALSE]:DoTarget
			wait 1
		}
	}
	call LockAndWait -Loc "-826.747192 346.421509 -752.143921"
	wait 50
	call RIMObj.LootChest
}
function Arkose()
{
	echo ISXRI: Starting Arkose

	variable int _ArkoseID=${Actor[Query, Name=-"Arkose" && IsDead=FALSE].ID}

	RIMUIObj:SetLockSpot[ALL,-709.594177,309.283508,-668.948792]
	RIConsole:Echo["ISXRI: Gathering Arkose Active Wand Loc's (This takes some time as he needs to goto all 4)"]
	echo ISXRI: Gathering Arkose Active Wand Loc's (This takes some time as he needs to goto all 4)
	
	variable index:int ActiveWands
	variable int i=0
	variable int ClosestWand=0
	variable int ClosestDistance=1000
	variable bool AlreadyExists=FALSE
	while ${ActiveWands.Used}<4
	{
		;echo ${Actor[Query, ID=${_ArkoseID} && IsDead=FALSE].CurrentAnimation.Equal[attack01]} // ${Actor[Query, ID=${_ArkoseID} && IsDead=FALSE].CurrentAnimation}
		if ${Actor[Query, ID=${_ArkoseID} && IsDead=FALSE].CurrentAnimation.Equal[attack01]}
		{
			ClosestWand:Set[0]
			ClosestDistance:Set[1000]
			for(i:Set[1];${i}<=8;i:Inc)
			{
				;echo ${Actor[Query, Name=-"Boss 1 Wand Loc ${i}"].Name}: ${Actor[Query, ID=${_ArkoseID} && IsDead=FALSE].Distance[${Actor[Query, Name=-"Boss 1 Wand Loc ${i}"].Loc}]}<${ClosestDistance}
				if ${Actor[Query, ID=${_ArkoseID} && IsDead=FALSE].Distance[${Actor[Query, Name=-"Boss 1 Wand Loc ${i}"].Loc}]}<${ClosestDistance}
				{
					ClosestDistance:Set[${Actor[Query, ID=${_ArkoseID} && IsDead=FALSE].Distance[${Actor[Query, Name=-"Boss 1 Wand Loc ${i}"].Loc}]}]
					ClosestWand:Set[${i}]
				}
			}
			;echo ClosestWand: ${ClosestWand}
			AlreadyExists:Set[0]
			for(i:Set[0];${i}<=${ActiveWands.Used};i:Inc)
			{
				if ${ActiveWands.Get[${i}]}==${ClosestWand} && ${ActiveWands.Used}>0
					AlreadyExists:Set[1]
			}
			;echo AlreadyExists: ${AlreadyExists} 
			if !${AlreadyExists}
			{
				RIConsole:Echo["ISXRI: Boss 1 Wand Loc ${ClosestWand} is Marked Active"]
				echo ISXRI: Boss 1 Wand Loc ${ClosestWand} is Marked Active
				ActiveWands:Insert[${ClosestWand}]
			}
			else
				wait 10
			;echo ActiveWands: ${ActiveWands.Used} 
		}
	}
	RIConsole:Echo["ISXRI: Done Gathering Arkose Active Wand Loc's: The Following wands are Active: ${ActiveWands.Get[1]} ${ActiveWands.Get[2]} ${ActiveWands.Get[3]} ${ActiveWands.Get[4]}"]
	echo ISXRI: Done Gathering Arkose Active Wand Loc's: The Following wands are Active: ${ActiveWands.Get[1]} ${ActiveWands.Get[2]} ${ActiveWands.Get[3]} ${ActiveWands.Get[4]}
	call RIObj.LockAndPull ${_ArkoseID} "-662.356812,309.283508,-636.037354"
	while ${Actor[Query, ID=${_ArkoseID} && IsDead=FALSE](exists)}
	{
		if ${RIMUIObj.MainIconIDExists[${_ArkoseID},755]}
		{
			while ${RIMUIObj.MainIconIDExists[${_ArkoseID},755]}
			{
				if ${Me.Inventory[Query, Name=="an arcane quartz rod" && Location=="Inventory"](exists)} && ${ActiveWands.Used}>0
				{
					RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=-"Boss 1 Wand Loc ${ActiveWands.Get[${ActiveWands.Used}]}"].Loc}]
					RI_CMD_PauseCombatBots 1
					eq2ex cancel_spellcast
					while ${Actor[Query, Name=-"Boss 1 Wand Loc ${ActiveWands.Get[${ActiveWands.Used}]}"].Interactable}
					{
						
						Actor[Query, Name=-"Boss 1 Wand Loc ${ActiveWands.Get[${ActiveWands.Used}]}"]:DoubleClick
						wait 1
					}
					RI_CMD_PauseCombatBots 0
					if !${RI_Var_Bool_GlobalOthers}
						RIMUIObj:SetLockSpot[ALL,-662.356812,309.283508,-636.037354]
					else
						RIMUIObj:SetLockSpot[ALL,OFF]
				}
				wait 1
			}
			ActiveWands:Remove[${ActiveWands.Used}]
			ActiveWands:Collapse
		}
		call RIObj.Target ${_ArkoseID}
		wait 2
	}

	echo ISXRI: Ending Arkose
}
function Frostward()
{
	echo ISXRI: Starting Frostward

	variable int _FrostwardID=${Actor[Query, Name=-"Frostward" && IsDead=FALSE].ID}

	call RIObj.LockAndPull ${_FrostwardID} "664.566223,309.283508,-634.170776"
	
	while ${Actor[Query, ID=${_FrostwardID} && IsDead=FALSE](exists)}
	{
		call RIObj.Target ${_FrostwardID}
		
		wait 2
	}

	echo ISXRI: Ending Frostward
}
function Oveld()
{
	;maelstrom - sandstorm
	
	echo ISXRI: Starting Oveld

	AnnounceText:Clear
	AnnounceText:Insert["Oveld awakens the maelstrom within him"]
	AnnounceText:Insert["Oveld awakens the sandstorm within him"]
	AnnounceText:Insert["Oveld awakens the snowstorm within him"]
	AnnounceText:Insert["Oveld awakens the firestorm within him"]
	
	variable int _OveldID=${Actor[Query, Name=-"Oveld" && IsDead=FALSE].ID}
	variable string Point=""
	variable string TargetName=""
	variable string PointName=""
	call RIObj.LockAndPull ${_OveldID} "662.349731,309.283539,634.980957"

	while ${Actor[Query, ID=${_OveldID} && IsDead=FALSE](exists)}
	{
		call RIObj.Target "Rod of Storms" ${_OveldID}
		
		if ${Trigger} || ${Actor[Query, ID=${_OveldID} && IsDead=FALSE].Aura.Find[water]} || ${Actor[Query, ID=${_OveldID} && IsDead=FALSE].Aura.Find[fire]} || ${Actor[Query, ID=${_OveldID} && IsDead=FALSE].Aura.Find[snow]} || ${Actor[Query, ID=${_OveldID} && IsDead=FALSE].Aura.Find[sand]}
		{
			if ${TriggerMessage.Find[sandstorm](exists)} || ${Actor[Query, ID=${_OveldID} && IsDead=FALSE].Aura.Find[sand]}
			{
				TargetName:Set["a Torden waterborn"]
				PointName:Set["a maelstrom"]
			}
			elseif ${TriggerMessage.Find[maelstrom](exists)} || ${Actor[Query, ID=${_OveldID} && IsDead=FALSE].Aura.Find[water]}
			{
				TargetName:Set["a Torden sandborn"]
				PointName:Set["a sandstorm"]
			}
			elseif ${TriggerMessage.Find[snowstorm](exists)} || ${Actor[Query, ID=${_OveldID} && IsDead=FALSE].Aura.Find[snow]}
			{
				TargetName:Set["a Torden fireborn"]
				PointName:Set["a firestorm"]
			}
			elseif ${TriggerMessage.Find[firestorm](exists)} || ${Actor[Query, ID=${_OveldID} && IsDead=FALSE].Aura.Find[fire]}
			{
				TargetName:Set["a Torden frostborn"]
				PointName:Set["a snowstorm"]
			}
			while ${RIMUIObj.MainIconIDExists[${_OveldID},740]}
			{
				if ${Actor[Query, Name=="${TargetName}" && IsDead=FALSE](exists)}
					call RIObj.Target "${TargetName}"
				elseif ${Actor[Query, Name=="${PointName}" && IsDead=FALSE](exists)}
				{
					Point:Set["${RIMUIObj.3rdPointLine[${Actor[Query, ID=${_OveldID} && IsDead=FALSE].X},${Actor[Query, ID=${_OveldID} && IsDead=FALSE].Z},${Actor[Query, Name=="${PointName}" && IsDead=FALSE].X},${Actor[Query, Name=="${PointName}" && IsDead=FALSE].Z},5]}"]
					call RIObj.Target "Rod of Storms" ${_OveldID}
					;echo RIMUIObj:SetLockSpot[ALL,"${Point.Token[1,"\,"]}",0,"${Point.Token[2,"\,"]}"]
					RIMUIObj:SetLockSpot[ALL,"${Point.Token[1,"\,"]}",0,"${Point.Token[2,"\,"]}"]
				}
			}
			Trigger:Set[0]
			if !${RI_Var_Bool_GlobalOthers}
				RIMUIObj:SetLockSpot[ALL,662.349731,309.283539,634.980957]
			else
				RIMUIObj:SetLockSpot[ALL,OFF]
		}
		wait 2
	}

	echo ISXRI: Ending Oveld
}
;;;;;;;; End Torden, Bastion of Thunder: Storm Chase
;;;;;;;; Start Torden, Bastion of Thunder: Winds of Change
function Elif()
{
	echo ISXRI: Starting Elif

	variable int _ElifID=${Actor[Query, Name=-"Elif Whitewind" && IsDead=FALSE].ID}

	RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Absorb Magic,0]

	call RIObj.LockAndPull ${_ElifID} "-660.779663,309.283508,-633.644836"
	
	while ${Actor[Query, ID=${_ElifID} && IsDead=FALSE](exists)}
	{
		call RIObj.Target ${_ElifID}
		call RIObj.MageAbsorbMagic ${_ElifID} 509
		wait 2
	}
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	else
		call MoveBehind 0
	echo ISXRI: Ending Elif
}
function Yveti()
{
	if ${Actor[Query, Name=-"Yveti Stormbrood" && IsDead=FALSE && Type!="Chest"].ID}<1
		return
		
	echo ISXRI: Starting Yveti
	variable string _LockSpot
	if ${Math.Distance[${Actor[Query, Name=="Yveti Stormbrood"].Loc},-798.367737,340.689331,791.846924]}>150 && ${Math.Distance[${Actor[Query, Name=="Yveti Stormbrood"].Loc},-519.234497,340.689667,490.558197]}>150
	{
		echo ISXRI: Waiting until Yveti is near a platform
		while ${Math.Distance[${Actor[Query, Name=="Yveti Stormbrood"].Loc},-798.367737,340.689331,791.846924]}>150 && ${Math.Distance[${Actor[Query, Name=="Yveti Stormbrood"].Loc},-519.234497,340.689667,490.558197]}>150
			wait 1
	}
	Actor[Query, Name=="Yveti Stormbrood"]:DoTarget
	if ${Math.Distance[${Actor[Query, Name=="Yveti Stormbrood"].Loc},-798.367737,340.689331,791.846924]}>${Math.Distance[${Actor[Query, Name=="Yveti Stormbrood"].Loc},-519.234497,340.689667,490.558197]}
	{
		call LockAndWait -Loc -614.942932,311.155457,585.738892
		call LockAndWait -Loc -580.337219,333.630432,550.521057
		call LockAndWait -Loc -519.234497,340.689667,490.558197
		_LockSpot:Set[-519.234497,340.689667,490.558197]
	}
	else
	{
		call LockAndWait -Loc -705.739990,311.295837,687.695679
		call LockAndWait -Loc -741.494263,335.669189,727.914490
		call LockAndWait -Loc -798.367737,340.689331,791.846924
		_LockSpot:Set[-798.367737,340.689331,791.846924]
	}
	variable int _YvetiID=${Actor[Query, Name=="Yveti Stormbrood" && IsDead=FALSE].ID}
	
	call RIObj.LockAndPull ${_YvetiID} ${_LockSpot}
	
	while ${Actor[Query, ID=${_YvetiID} && IsDead=FALSE](exists)}
	{
		call RIObj.Target ${_YvetiID}
		if ${Actor[Query, Name=="A Windcaller Golem"](exists)}
		{
			;echo GOLEM
			;im at n and golem is at n; just move to golem
			if ${Me.Distance2D[-518.964478,493.276276]}<50 && ${Actor[Query, Name=="A Windcaller Golem"].Distance2D[-518.964478,493.276276]}<50
			{
				call LockAndWait -Loc ${Actor[Query, Name=="A Windcaller Golem"].Loc} -Precision 5 -RelayToGroup
			}
			;im at s and golem is at s; just move to golem
			if ${Me.Distance2D[-796.010010,789.750000]}<50 && ${Actor[Query, Name=="A Windcaller Golem"].Distance2D[-796.010010,789.750000]}<50
			{
				call LockAndWait -Loc ${Actor[Query, Name=="A Windcaller Golem"].Loc} -Precision 5 -RelayToGroup
			}
			;im at s and golem is at n;
			;im at s and golem is at s; just move to golem
			if ${Me.Distance2D[-796.010010,789.750000]}<50 && ${Actor[Query, Name=="A Windcaller Golem"].Distance2D[-518.964478,493.276276]}<50
			{
				call LockAndWait -Loc -741.494263,335.669189,727.914490
				call LockAndWait -Loc -705.739990,311.295837,687.695679
				call LockAndWait -Loc -656.196289,309.283508,641.369507
				call PreHeal
				call LockAndWait -Loc -614.942932,311.155457,585.738892
				call LockAndWait -Loc -580.337219,333.630432,550.521057
				call LockAndWait -Loc -519.234497,340.689667,490.558197
				call LockAndWait -Loc ${Actor[Query, Name=="A Windcaller Golem"].Loc} -Precision 5
			}
			;im at n and golem is at s;
			if ${Me.Distance2D[-518.964478,493.276276]}<50 && ${Actor[Query, Name=="A Windcaller Golem"].Distance2D[-796.010010,789.750000]}<50
			{
				call LockAndWait -Loc -580.337219,333.630432,550.521057
				call LockAndWait -Loc -614.942932,311.155457,585.738892
				call LockAndWait -Loc -656.196289,309.283508,641.369507
				call PreHeal
				call LockAndWait -Loc -705.739990,311.295837,687.695679
				call LockAndWait -Loc -741.494263,335.669189,727.914490
				call LockAndWait -Loc ${Actor[Query, Name=="A Windcaller Golem"].Loc} -Precision 5
			}
			if ${RI_Var_Bool_GlobalOthers}
				call MoveBehind 1
			while ${Actor[Query, Name=="A Windcaller Golem" && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=="A Windcaller Golem" && IsDead=FALSE].ID} && !${RI_Var_Bool_GlobalOthers}
					Actor[Query, Name=="A Windcaller Golem" && IsDead=FALSE]:DoTarget
				wait 1
			}
			wait 20
		}
		wait 2
	}
	
	call MoveBehind 0
	wait 2
	if ${Actor[Query, ID=${_YvetiID}](exists)}
	{
		RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_YvetiID}].Loc}]
		wait 150 ${Math.Distance[${Me.Loc},${Actor[Query, ID=${_YvetiID}].Loc}]}<3 && !${Actor[Query, ID=${_YvetiID}](exists)}
	}
	;im at n
	if ${Me.Distance2D[-518.964478,493.276276]}<50
	{
		call LockAndWait -Loc -580.337219,333.630432,550.521057
		call LockAndWait -Loc -614.942932,311.155457,585.738892
		call LockAndWait -Loc -656.196289,309.283508,641.369507
	}
	;im at s and golem is at s; just move to golem
	if ${Me.Distance2D[-796.010010,789.750000]}<50
	{
		call LockAndWait -Loc -741.494263,335.669189,727.914490
		call LockAndWait -Loc -705.739990,311.295837,687.695679
		call LockAndWait -Loc -656.196289,309.283508,641.369507
	}
	wait 300 ${RIMObj.AllGroupWithinRange[5]}
	if !${RI_Var_Bool_GlobalOthers}	
		call RIMObj.follow
	echo ISXRI: Ending Yveti 
}
function Laef()
{
	echo ISXRI: Starting Laef 
	variable int _LaefID=${Actor[Query, Name=-"Laef Windfall" && IsDead=FALSE].ID}
	
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["prepares to unleash a barrage of powerful wind in front of him"]
	IncomingText:Insert["prepares to unless a barrage of powerful wind in front of him"]

	call RIObj.LockAndPull ${_LaefID} "547.358215,-16.976404,633.966980"

	while ${Actor[Query, ID=${_LaefID} && IsDead=FALSE](exists)}
	{
		call RIObj.Target ${_LaefID}
		if ${Me.Maintained[Caught in the Storm](exists)}
			Me.Maintained[Caught in the Storm]:Cancel
		; if !${RI_Var_Bool_GlobalOthers}
		; {
			; if ${Trigger}
			; {
				; RIMUIObj:SetLockSpot[OFF]
				; RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[1]
				; call MoveBehind 1
				; RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[1]
				; wait 50
				; RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
				; call MoveBehind 0
				; RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
				; wait 50
				; RIMUIObj:SetLockSpot[ALL,547.358215,-16.976404,633.966980]
				; Trigger:Set[FALSE]
			; }
		; }
		
		wait 1
	}
	call MoveBehind 0
	wait 2
	if !${RI_Var_Bool_GlobalOthers}	
		call RIMObj.follow
	echo ISXRI: Ending Laef 
}
function Torstien()
{
	echo ISXRI: Starting Torstien 
	if ${Zone.Name.Find["[Expert]"]}
		call WaitForLastNamedChest START
	variable int _HreidarID=${Actor[Query, Name=-"Hreidar Lynhillig" && IsDead=FALSE].ID}
	variable int _TorstienID=${Actor[Query, Name=-"Torstien Stoneskin" && IsDead=FALSE].ID}
	variable int _TargetID
	_TargetID:Set[${_HreidarID}]
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["casts a protection spell on"]
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_TargetID} && IsDead=FALSE]:DoTarget
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,646.923950,309.283508,621.031311]
		wait 150 ${Math.Distance[${Me.Loc},646.923950,309.283508,621.031311]}<3
		wait 150 ${Actor[Query, ID=${_LaefID} && IsDead=FALSE].Distance}<11
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,660.717407,309.283539,634.917603]
		wait 150 ${Actor[Query, ID=${_LaefID} && IsDead=FALSE].Distance}<11
		; wait 25
		relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
	}
	else
	{
		wait 150 ${Math.Distance[${Me.Loc},646.923950,309.283508,621.031311]}<3
		wait 150 ${Math.Distance[${Me.Loc},660.717407,309.283539,634.917603]}<3
		wait 150 ${Actor[Query, ID=${_LaefID} && IsDead=FALSE].Distance}<11
		wait 5
		RIMUIObj:SetLockSpot[OFF]
		call MoveBehind 1
	}
	
	;;; MainIconID of Cooperation Blast is 3 if we need it but we dont, even if we decide to start jousting we will use the trigger
	;;616.562866,309.283508,589.002075
	;;710.518372,309.932556,678.954224
	while ${Actor[Query, ID=${_HreidarID} && IsDead=FALSE](exists)} || ${Actor[Query, ID=${_TorstienID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			call RIObj.Target ${_TargetID}
			if ${Trigger} || ${Target.Health}==1
			{
				Trigger:Set[0]
				if ${_TargetID}==${_HreidarID}
					_TargetID:Set[${_TorstienID}]
				else
					_TargetID:Set[${_HreidarID}]
			}
		}
		wait 1
	}
	if ${Zone.Name.Find["[Expert]"]}
		call WaitForLastNamedChest
	call MoveBehind 0
	if !${RI_Var_Bool_GlobalOthers}	
		call RIMObj.follow
	if ${Actor[Query, ID=${_TorstienID}](exists)}
	{
		RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_TorstienID}].Loc}]
		wait 150 ${Math.Distance[${Me.Loc},${Actor[Query, ID=${_TorstienID}].Loc}]}<3
	}
	if ${Actor[Query, ID=${_HreidarID}](exists)}
	{
		RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_HreidarID}].Loc}]
		wait 150 ${Math.Distance[${Me.Loc},${Actor[Query, ID=${_HreidarID}].Loc}]}<3
	}
	
	echo ISXRI: Ending Torstien 
}
;;;;;;;; End Torden, Bastion of Thunder: Winds of Change
;;;;;;;; Start Solusek Ro's Tower: The Obsidian Core
function Cindrax2319801239823178()
{
	;still need to write when maintoon gets confined and getting the confined toon back
	echo ISXRI: Starting Cindrax 
	variable int _CindraxID=${Actor[Query, Name=-"Cindrax" && IsDead=FALSE].ID}
	variable int _cnt
	variable int _GargoyleID
	variable string _InterimLoc
	declare _ConfinedToonLoc string global
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["throwing everyone in front"]
	IncomingText:Insert["has been confined to one of the Solitude statues"]
	IncomingText:Insert["You have been confined to one of the Solitude statues"]
	;RI_Var_Int_MoveDistanceMod:Set[6]
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_CindraxID} && IsDead=FALSE]:DoTarget
		wait 20
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-20.353800,-6.485186,-104.193123]
		; wait 150 ${Math.Distance[${Me.Loc},-53.932232,-5.677016,-101.803299]}<3
		; wait 150 ${Actor[Query, ID=${_CindraxID} && IsDead=FALSE].Distance}<8
		; wait 25
		; relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
	}
	; else
	; {
		; wait 150 ${Math.Distance[${Me.Loc},-53.932232,-5.677016,-101.803299]}<3
		; wait 150 ${Actor[Query, ID=${_CindraxID} && IsDead=FALSE].Distance}<8
		; RIMUIObj:SetLockSpot[OFF]
		; call MoveBehind ${_CindraxID}
	; }
	
	while ${Actor[Query, ID=${_CindraxID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=-"Solitude" && IsDead=FALSE && Distance<5](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"Solitude" && IsDead=FALSE && Distance<5].ID}
					Actor[Query, Name=-"Solitude" && IsDead=FALSE && Distance<5]:DoTarget
			}
			elseif ${Actor[Query, ID=${_CindraxID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_CindraxID}
					Actor[Query, ID=${_CindraxID} && IsDead=FALSE]:DoTarget
			}
			if ${Trigger} && ${TriggerMessage.Find[throwing everyone in front]}
			{
				Trigger:Set[FALSE]
				if ${Math.Distance[${Me.Loc},-20.353800,-6.485186,-104.193123]}<10
					call LockAndWait -Loc 20.359574,-6.485186,-104.094017 -RelayToGroup
				elseif ${Math.Distance[${Me.Loc},20.353800,-6.485186,-104.193123]}<10
					call LockAndWait -Loc -20.353800,-6.485186,-104.193123 -RelayToGroup
				elseif ${Math.Distance[${Me.Loc},-20.353800,-6.485186,-54.193123]}<10
					call LockAndWait -Loc 20.359574,-6.485186,-54.094017 -RelayToGroup
				elseif ${Math.Distance[${Me.Loc},20.353800,-6.485186,-54.193123]}<10
					call LockAndWait -Loc -20.353800,-6.485186,-54.193123 -RelayToGroup
			}
			if ${Trigger} && ${TriggerMessage.Find[has been confined to one of the Solitude statues]}
			{
				Trigger:Set[FALSE]
				wait 10
				;NE
				if ${Math.Distance[${_ConfinedToonLoc},-14.200000,-5.321877,-94.760002]}<2
				{
					echo ISXRI: _ConfinedToonLoc=${_ConfinedToonLoc} which is at NE
					_InterimLoc:Set["-20.436083,-6.485186,-104.946125"]
					if ${Math.Distance[${Me.Loc},20.353800,-6.485186,-54.193123]}<5
						call LockAndWait -Loc -20.359574,-6.485186,-54.094017 -RelayToGroup
					wait 5
					call LockAndWait -Loc ${_InterimLoc} -RelayToGroup
					wait 5
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-14.200000,-5.321877,-94.760002,5]
				}
				;NW
				if ${Math.Distance[${_ConfinedToonLoc},15.613154,-6.485187,-97.000000]}<2
				{
					echo ISXRI: _ConfinedToonLoc=${_ConfinedToonLoc} which is at NW
					_InterimLoc:Set["20.436083,-6.485186,-104.946125"]
					if ${Math.Distance[${Me.Loc},-20.353800,-6.485186,-54.193123]}<5
						call LockAndWait -Loc 20.359574,-6.485186,-54.094017 -RelayToGroup
					wait 5
					call LockAndWait -Loc ${_InterimLoc} -RelayToGroup
					wait 5
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,15.613154,-6.485187,-97.000000,5]
				}
				;SE
				if ${Math.Distance[${_ConfinedToonLoc},-13.880000,-5.286180,-60.509998]}<2
				{
					echo ISXRI: _ConfinedToonLoc=${_ConfinedToonLoc} which is at SE
					_InterimLoc:Set["-20.436083,-6.485186,-54.946125"]
					if ${Math.Distance[${Me.Loc},20.353800,-6.485186,-104.193123]}<5
						call LockAndWait -Loc -20.359574,-6.485186,-104.094017 -RelayToGroup
					wait 5
					call LockAndWait -Loc ${_InterimLoc} -RelayToGroup
					wait 5
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-13.880000,-5.286180,-60.509998,5]
				}
				;SW
				if ${Math.Distance[${_ConfinedToonLoc},14.050000,-5.286187,-60.549999]}<2
				{
					echo ISXRI: _ConfinedToonLoc=${_ConfinedToonLoc} which is at SW
					_InterimLoc:Set["20.436083,-6.485186,-54.946125"]
					if ${Math.Distance[${Me.Loc},-20.353800,-6.485186,-104.193123]}<5
						call LockAndWait -Loc 20.359574,-6.485186,-104.094017 -RelayToGroup
					wait 5
					call LockAndWait -Loc ${_InterimLoc} -RelayToGroup
					wait 5
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,14.050000,-5.286187,-60.549999,5]
				}
				Trigger:Set[FALSE]
				_GargoyleID:Set[${Actor[Query, Name=-"Solitude" && IsDead=FALSE && Distance<15].ID}]
				wait 5
				while ${Actor[Query, ID=${_GargoyleID} && IsDead=FALSE](exists)} && ${Actor[Query, ID=${_CindraxID} && IsDead=FALSE](exists)}
				{
					if !${RI_Var_Bool_GlobalOthers}
					{
						if ${Actor[Query, ID=${_GargoyleID} && IsDead=FALSE](exists)}
						{
							if ${Target.ID}!=${_GargoyleID}
								Actor[Query, ID=${_GargoyleID} && IsDead=FALSE]:DoTarget
						}
						if ${Trigger} && ${TriggerMessage.Find[throwing everyone in front]}
						{
							Trigger:Set[FALSE]
							;echo call LockAndWait -Loc ${_InterimLoc} -RelayToGroup
							;call LockAndWait -Loc ${_InterimLoc} -RelayToGroup
							;wait 5
							if ${Math.Distance[${Me.Loc},-20.353800,-6.485186,-104.193123]}<10
								call LockAndWait -Loc 20.359574,-6.485186,-104.094017 -RelayToGroup
							elseif ${Math.Distance[${Me.Loc},20.353800,-6.485186,-104.193123]}<10
								call LockAndWait -Loc -20.353800,-6.485186,-104.193123 -RelayToGroup
							elseif ${Math.Distance[${Me.Loc},-20.353800,-6.485186,-54.193123]}<10
								call LockAndWait -Loc 20.359574,-6.485186,-54.094017 -RelayToGroup
							elseif ${Math.Distance[${Me.Loc},20.353800,-6.485186,-54.193123]}<10
								call LockAndWait -Loc -20.353800,-6.485186,-54.193123 -RelayToGroup
							wait 5
							;echo call LockAndWait -Loc ${_InterimLoc} -RelayToGroup
							call LockAndWait -Loc ${_InterimLoc} -RelayToGroup
							wait 5
							relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_GargoyleID} && IsDead=FALSE].Loc},5]
						}
					}
					waitframe
				}
				call LockAndWait -Loc ${_InterimLoc} -RelayToGroup
			}
		}
		if ${Trigger} 
		{	
			Trigger:Set[0]
			if ${TriggerMessage.Find[You have been confined to one of the Solitude statues]}
			{
				
				Trigger:Set[FALSE]
				wait 1
				relay ${RI_Var_String_RelayGroup} _ConfinedToonLoc:Set["${Me.Loc}"]
				wait 2
				echo ISXRI: ${Me.Name} is confined, Relaying my location "${Me.Loc}" to _ConfinedToonLoc=${_ConfinedToonLoc}
				if !${RI_Var_Bool_GlobalOthers}
				{	
					echo in if
					Trigger:Set[FALSE]
					;NE
					echo before multi ifs
					if ${Math.Distance[${_ConfinedToonLoc},-14.200000,-5.321877,-94.760002]}<2
					{
						echo ISXRI: _ConfinedToonLoc=${_ConfinedToonLoc} which is at NE
						_InterimLoc:Set["-20.436083,-6.485186,-104.946125"]
						if ${Math.Distance[${Me.Loc},20.353800,-6.485186,-54.193123]}<5
						{
							relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,-20.359574,-6.485186,-54.094017]
							wait 150 ${Me.Group[1].Distance2D[-20.359574,-54.094017]}<3
							wait 5
						}
						relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${_InterimLoc}]
						wait 150 ${Me.Group[1].Distance2D[${_InterimLoc.Token[1,","]},${_InterimLoc.Token[3,","]}]}<3
						wait 5
						relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,-14.200000,-5.321877,-94.760002,5]
					}
					;NW
					if ${Math.Distance[${_ConfinedToonLoc},15.613154,-6.485187,-97.000000]}<2
					{
						echo ISXRI: _ConfinedToonLoc=${_ConfinedToonLoc} which is at NW
						_InterimLoc:Set["20.436083,-6.485186,-104.946125"]
						if ${Math.Distance[${Me.Loc},-20.353800,-6.485186,-54.193123]}<5
						{
							relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,20.359574,-6.485186,-54.094017]
							wait 150 ${Me.Group[1].Distance2D[20.359574,-54.094017]}<3
							wait 5
						}
						relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${_InterimLoc}]
						wait 150 ${Me.Group[1].Distance2D[${_InterimLoc.Token[1,","]},${_InterimLoc.Token[3,","]}]}<3
						wait 5
						relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,15.613154,-6.485187,-97.000000,5]
					}
					;SE
					if ${Math.Distance[${_ConfinedToonLoc},-13.880000,-5.286180,-60.509998]}<2
					{
						echo ISXRI: _ConfinedToonLoc=${_ConfinedToonLoc} which is at SE
						_InterimLoc:Set["-20.436083,-6.485186,-54.946125"]
						if ${Math.Distance[${Me.Loc},20.353800,-6.485186,-104.193123]}<5
						{
							relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,-20.359574,-6.485186,-104.094017]
							wait 150 ${Me.Group[1].Distance2D[-20.359574,-104.094017]}<3
							wait 5
						}
						relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${_InterimLoc}]
						wait 150 ${Me.Group[1].Distance2D[${_InterimLoc.Token[1,","]},${_InterimLoc.Token[3,","]}]}<3
						wait 5
						relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,-13.880000,-5.286180,-60.509998,5]
					}
					;SW
					if ${Math.Distance[${_ConfinedToonLoc},14.050000,-5.286187,-60.549999]}<2
					{
						echo ISXRI: _ConfinedToonLoc=${_ConfinedToonLoc} which is at SW
						_InterimLoc:Set["20.436083,-6.485186,-54.946125"]
						if ${Math.Distance[${Me.Loc},-20.353800,-6.485186,-104.193123]}<5
						{
							relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,20.359574,-6.485186,-104.094017]
							wait 150 ${Me.Group[1].Distance2D[20.359574,-104.094017]}<3
							wait 5
						}
						relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${_InterimLoc}]
						wait 150 ${Me.Group[1].Distance2D[${_InterimLoc.Token[1,","]},${_InterimLoc.Token[3,","]}]}<3
						wait 5
						relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,14.050000,-5.286187,-60.549999,5]
					}
					echo after ifs
					_GargoyleID:Set[${Actor[Query, Name=-"Solitude" && IsDead=FALSE && Distance<15].ID}]
					wait 5
					echo before while
					while ${Actor[Query, ID=${_GargoyleID} && IsDead=FALSE](exists)} && ${Actor[Query, ID=${_CindraxID} && IsDead=FALSE](exists)}
					{
					echo in while
						if !${RI_Var_Bool_GlobalOthers}
						{
							if ${Actor[Query, ID=${_GargoyleID} && IsDead=FALSE](exists)}
							{
								if ${Target.ID}!=${_GargoyleID}
									Actor[Query, ID=${_GargoyleID} && IsDead=FALSE]:DoTarget
							}
							if ${Trigger} && ${TriggerMessage.Find[throwing everyone in front]}
							{
								Trigger:Set[FALSE]
								;echo call LockAndWait -Loc ${_InterimLoc} -RelayToGroup
								relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${_InterimLoc}]
								wait 150 ${Me.Group[1].Distance2D[${_InterimLoc.Token[1,","]},${_InterimLoc.Token[3,","]}]}<3
								wait 5
								if ${Math.Distance[${Me.Loc},-20.353800,-6.485186,-104.193123]}<10
								{
									;call LockAndWait -Loc 20.359574,-6.485186,-104.094017 -RelayToGroup
									relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,20.359574,-6.485186,-104.094017]
									wait 150 ${Me.Group[1].Distance2D[20.359574,-104.094017]}<3
								}
								elseif ${Math.Distance[${Me.Loc},20.353800,-6.485186,-104.193123]}<10
								{
									;call LockAndWait -Loc -20.353800,-6.485186,-104.193123 -RelayToGroup
									relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,-20.353800,-6.485186,-104.193123]
									wait 150 ${Me.Group[1].Distance2D[-20.359574,-104.094017]}<3
								}
								elseif ${Math.Distance[${Me.Loc},-20.353800,-6.485186,-54.193123]}<10
								{
									relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,20.353800,-6.485186,-54.193123]
									wait 150 ${Me.Group[1].Distance2D[20.359574,-54.094017]}<3
								}
								elseif ${Math.Distance[${Me.Loc},20.353800,-6.485186,-54.193123]}<10
								{
									relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,-20.353800,-6.485186,-54.193123]
									wait 150 ${Me.Group[1].Distance2D[-20.359574,-54.094017]}<3
								}
								wait 5
								relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${_InterimLoc}]
								wait 150 ${Me.Group[1].Distance2D[${_InterimLoc.Token[1,","]},${_InterimLoc.Token[3,","]}]}<3
								wait 5
								relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_GargoyleID} && IsDead=FALSE].Loc},5]
							}
						}
						waitframe
					}
					echo after while
					relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${_InterimLoc}]
					wait 150 ${Me.Group[1].Distance2D[${_InterimLoc.Token[1,","]},${_InterimLoc.Token[3,","]}]}<3
					wait 5
				}
				;wait while im at loc
				while ${Me.Distance[${_ConfinedToonLoc}]}<1 && ${Actor[Query, ID=${_CindraxID} && IsDead=FALSE](exists)}
					wait 1
				;now move me to the interimloc
				if ${Math.Distance[${Me.Loc},-20.353800,-6.485186,-104.193123]}<10 && ${_InterimLoc.Equal["20.436083,-6.485186,-54.946125"]}
					call LockAndWait -Loc 20.359574,-6.485186,-104.094017
				elseif ${Math.Distance[${Me.Loc},20.353800,-6.485186,-104.193123]}<10 && ${_InterimLoc.Equal["-20.436083,-6.485186,-54.946125"]}
					call LockAndWait -Loc -20.353800,-6.485186,-104.193123
				elseif ${Math.Distance[${Me.Loc},-20.353800,-6.485186,-54.193123]}<10 && ${_InterimLoc.Equal["20.436083,-6.485186,-104.946125"]}
					call LockAndWait -Loc 20.359574,-6.485186,-54.094017
				elseif ${Math.Distance[${Me.Loc},20.353800,-6.485186,-54.193123]}<10 && ${_InterimLoc.Equal["-20.436083,-6.485186,-104.946125"]}
					call LockAndWait -Loc -20.353800,-6.485186,-54.193123
				call LockAndWait -Loc ${_InterimLoc}
			}
			
		}
		; else
		; {
			; if ${Actor[Query, ID=${_CindraxID} && IsDead=FALSE].Target.ID}==${Me.ID}
			; {
				; call MoveBehind 0
				; RIMUIObj:SetLockSpot[ALL,-53.932232,-5.677016,-101.803299]
			; }
			; else
			; {
				; call MoveBehind ${_CindraxID}
			; }
		; }
		; if ${Trigger}
		; {
			; RIMUIObj:SetLockSpot[OFF]
			; RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[1]
			; call MoveInFront 0
			; call MoveBehind ${_CindraxID}
			; RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[1]
			; wait 30
			; RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
			; call MoveBehind 0
			; RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
			; if !${RI_Var_Bool_GlobalOthers}
				; RIMUIObj:SetLockSpot[ALL,-53.932232,-5.677016,-101.803299]
			; else
				; call MoveBehind ${_CindraxID}
			; Trigger:Set[FALSE]
		; }
		wait 1
	}
	;call MoveBehind 0
	;RI_Var_Int_MoveDistanceMod:Set[1]
	call RIMObj.follow
	if ${Math.Distance[${Me.Loc},20.353800,-6.485186,-54.193123]}<10
		call LockAndWait -Loc -20.353800,-6.485186,-54.193123
	call LockAndWait -Loc 20.359574,-6.485186,-104.094017
	wait 25
	call RIMObj.follow
	deletevariable _ConfinedToonLoc
	echo ISXRI: Ending Cindrax 
}
function Cindrax()
{
	;still need to write when maintoon gets confined and getting the confined toon back
	echo ISXRI: Starting Cindrax 
	variable int _CindraxID=${Actor[Query, Name=-"Cindrax" && IsDead=FALSE].ID}
	variable float _Heading
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["throwing everyone in front"]
	;IncomingText:Insert["has been confined to one of the Solitude statues"]
	;IncomingText:Insert["You have been confined to one of the Solitude statues"]
	RI_Var_Int_MoveDistanceMod:Set[10]
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_CindraxID} && IsDead=FALSE]:DoTarget
		wait 120 ${Math.Distance[${Me.Loc},${Actor[Query, ID=${_CindraxID} && IsDead=FALSE].Loc}]}<10
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-53.932232,-5.677016,-101.803299]
		wait 150 ${Math.Distance[${Me.Loc},-53.932232,-5.677016,-101.803299]}<3
		wait 150 ${Actor[Query, ID=${_CindraxID} && IsDead=FALSE].Distance}<11
		wait 25
		relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
	}
	else
	{
		wait 150 ${Math.Distance[${Me.Loc},-53.932232,-5.677016,-101.803299]}<3
		wait 150 ${Actor[Query, ID=${_CindraxID} && IsDead=FALSE].Distance}<11
		RIMUIObj:SetLockSpot[OFF]
		call MoveBehind ${_CindraxID}
	}
	
	while ${Actor[Query, ID=${_CindraxID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=-"Solitude" && IsDead=FALSE && Distance<15](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"Solitude" && IsDead=FALSE && Distance<15].ID}
					Actor[Query, Name=-"Solitude" && IsDead=FALSE && Distance<15]:DoTarget
			}
			elseif ${Actor[Query, ID=${_CindraxID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_CindraxID}
					Actor[Query, ID=${_CindraxID} && IsDead=FALSE]:DoTarget
			}
		}
		else
		{
			if ${Actor[Query, ID=${_CindraxID} && IsDead=FALSE].Target.ID}==${Me.ID}
			{
				call MoveBehind 0
				RIMUIObj:SetLockSpot[ALL,-53.932232,-5.677016,-101.803299]
			}
			else
			{
				call MoveBehind ${_CindraxID}
			}
		}
		if ${Trigger}
		{
			_Heading:Set[${Actor[Query, ID=${_CindraxID} && IsDead=FALSE].Heading}]
			;echo ${_Heading}
			RIMUIObj:SetLockSpot[OFF]
			RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[1]
			call MoveInFront 0
			call MoveBehind ${_CindraxID}
			RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[1]
			;echo ${Actor[Query, ID=${_CindraxID} && IsDead=FALSE].Heading}!=${_Heading}
			wait 30
			RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
			call MoveBehind 0
			RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
			if !${RI_Var_Bool_GlobalOthers}
				RIMUIObj:SetLockSpot[ALL,-53.932232,-5.677016,-101.803299]
			else
				call MoveBehind ${_CindraxID}
			Trigger:Set[FALSE]
		}
		wait 1
	}
	call MoveBehind 0
	RI_Var_Int_MoveDistanceMod:Set[1]
	wait 25
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	echo ISXRI: Ending Cindrax 
}
function Molten()
{
	echo ISXRI: Starting Molten 
	variable int _MoltenID=${Actor[Query, Name=-"The Molten Behemoth" && IsDead=FALSE].ID}
	
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["begins expelling molten rocks"]
	
	variable index:actor _ActorIndex
	
	;RI_Var_Int_MoveDistanceMod:Set[5]
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_MoltenID} && IsDead=FALSE]:DoTarget
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,64.218613,-121.359184,-201.442612]
		;wait 150 ${Math.Distance[${Me.Loc},64.218613,-121.359184,-201.442612]}<3
		; wait 150 ${Actor[Query, ID=${_MoltenID} && IsDead=FALSE].Distance}<8
		; wait 25
		; relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
	}
	else
	{
		;wait 150 ${Math.Distance[${Me.Loc},64.218613,-121.359184,-201.442612]}<3
		; wait 150 ${Actor[Query, ID=${_MoltenID} && IsDead=FALSE].Distance}<8
		; RIMUIObj:SetLockSpot[OFF]
		; call MoveBehind 1
	}
	variable string _greatestalpha=****
	variable string _lowestalpha=****

	if !${Zone.Name.Find[Solo]}
	{
		variable int _greatestrock
		variable int _lowestrock
		;lets determine who in the group has the LowestName in the Alpha and is not healer or tank
		if ${Me.Archetype.NotEqual[priest]} && ${Me.Archetype.NotEqual[fighter]} 
		{
			variable int _gcnt=0
			_greatestalpha:Set[${Me.Name}]
			_lowestalpha:Set[${Me.Name}]
			for(_gcnt:Set[1];${_gcnt}<${Me.Group};_gcnt:Inc)
			{
				if ${Me.Group[${_gcnt}].Name.Compare[${_greatestalpha}]}>0 && ${Me.Group[${_gcnt}].Class.NotEqual[guardian]} && ${Me.Group[${_gcnt}].Class.NotEqual[berserker]} && ${Me.Group[${_gcnt}].Class.NotEqual[monk]} && ${Me.Group[${_gcnt}].Class.NotEqual[bruiser]} && ${Me.Group[${_gcnt}].Class.NotEqual[paladin]} && ${Me.Group[${_gcnt}].Class.NotEqual[shadowknight]} && ${Me.Group[${_gcnt}].Class.NotEqual[defiler]} && ${Me.Group[${_gcnt}].Class.NotEqual[mystic]} && ${Me.Group[${_gcnt}].Class.NotEqual[warden]} && ${Me.Group[${_gcnt}].Class.NotEqual[fury]} && ${Me.Group[${_gcnt}].Class.NotEqual[templar]} && ${Me.Group[${_gcnt}].Class.NotEqual[inquisitor]} && ${Me.Group[${_gcnt}].Class.NotEqual[channeler]}
					_greatestalpha:Set[${Me.Group[${_gcnt}].Name}]
				if ${Me.Group[${_gcnt}].Name.Compare[${_lowestalpha}]}<0 && ${Me.Group[${_gcnt}].Class.NotEqual[guardian]} && ${Me.Group[${_gcnt}].Class.NotEqual[berserker]} && ${Me.Group[${_gcnt}].Class.NotEqual[monk]} && ${Me.Group[${_gcnt}].Class.NotEqual[bruiser]} && ${Me.Group[${_gcnt}].Class.NotEqual[paladin]} && ${Me.Group[${_gcnt}].Class.NotEqual[shadowknight]} && ${Me.Group[${_gcnt}].Class.NotEqual[defiler]} && ${Me.Group[${_gcnt}].Class.NotEqual[mystic]} && ${Me.Group[${_gcnt}].Class.NotEqual[warden]} && ${Me.Group[${_gcnt}].Class.NotEqual[fury]} && ${Me.Group[${_gcnt}].Class.NotEqual[templar]} && ${Me.Group[${_gcnt}].Class.NotEqual[inquisitor]} && ${Me.Group[${_gcnt}].Class.NotEqual[channeler]}
					_lowestalpha:Set[${Me.Group[${_gcnt}].Name}]
			}
		}
		else
			_greatestalpha:Set[****]
	}
	RI_CMD_Assist 0
	;echo ${_greatestalpha} // ${_lowestalpha}
	while ${Actor[Query, ID=${_MoltenID} && IsDead=FALSE](exists)}
	{
		;still need to code the placeable items for heroic
		;if !${RI_Var_Bool_GlobalOthers}
		;{
			if ${Actor[Query, ID=${_MoltenID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_MoltenID}
					Actor[Query, ID=${_MoltenID} && IsDead=FALSE]:DoTarget
			}
			if ${Trigger}
			{
				;relay ${RI_Var_String_RelayGroup} 
				RIMUIObj:SetLockSpot[ALL,64.604515,-121.683655,-173.401505]
				wait 150 ${Me.Distance2D[64.604515,-173.401505]}<3
				wait 100 ${Actor[Query, ID=${_MoltenID} && IsDead=FALSE].Distance}<10 || ${Actor[Query, Name=="Movable Molten Rock"](exists)}
				wait 5
				;if !${RI_Var_Bool_GlobalOthers}
					;relay ${RI_Var_String_RelayGroup} 
					RIMUIObj:SetLockSpot[ALL,64.218613,-121.359184,-201.442612]
				;else
				;	call MoveBehind 1
				Trigger:Set[FALSE]
			}
			
		;}
		;echo ${_greatestalpha.Equal[${Me.Name}]} && ${Actor[Query, Name=="Movable Molten Rock"](exists)}
		while ( ${_greatestalpha.Equal[${Me.Name}]} || ${_lowestalpha.Equal[${Me.Name}]} || ( ${Zone.Name.Find[Solo]} && !${RI_Var_Bool_GlobalOthers} ) ) && ${Actor[Query, Name=="Movable Molten Rock"](exists)} 
		{
			_ActorIndex:Clear
			EQ2:QueryActors[_ActorIndex, Name=="Movable Molten Rock"]
			if ${_lowestalpha.Equal[${Me.Name}]} && ${_ActorIndex.Used}<2
			{
				waitframe
				continue
			}
			if ${_ActorIndex.Get[1].ID}>${_ActorIndex.Get[2].ID}
				_greatestrock:Set[${_ActorIndex.Get[1].ID}];_lowestrock:Set[${_ActorIndex.Get[2].ID}]
			else
				_greatestrock:Set[${_ActorIndex.Get[2].ID}];_lowestrock:Set[${_ActorIndex.Get[1].ID}]
			;echo ROCKS
			RI_CMD_Assist 0
			Actor[${Me.ID}]:DoTarget
			wait 50 ${Me.Distance2D[64.218613,-201.442612]}<5 || !${Actor[Query, ID=${_MoltenID} && IsDead=FALSE](exists)}
			if ( ${_greatestalpha.Equal[${Me.Name}]} || ${Zone.Name.Find[Solo]} ) && ${Actor[Query, ID=${_MoltenID} && IsDead=FALSE](exists)}
			{
				call LockAndWait -Loc ${Actor[Query, ID=${_greatestrock}].Loc} -Precision 3
				RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_greatestrock}].Loc}]
				wait 150 ${Me.Distance2D[${Actor[Query, ID=${_greatestrock}].X},${Actor[Query, ID=${_greatestrock}].Z}]}<3 || !${Actor[Query, ID=${_MoltenID} && IsDead=FALSE](exists)}
				if ${Actor[Query, ID=${_MoltenID} && IsDead=FALSE](exists)}
				{
					Actor[Query, ID=${_greatestrock}]:DoubleClick
					Actor[Query, ID=${_greatestrock}]:DoubleClick
					Actor[Query, ID=${_greatestrock}]:DoubleClick
				}
			}
			elseif ${Actor[Query, ID=${_MoltenID} && IsDead=FALSE](exists)}
			{
				call LockAndWait -Loc ${Actor[Query, ID=${_lowestrock}].Loc} -Precision 3
				RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_lowestrock}].Loc}]
				wait 150 ${Me.Distance2D[${Actor[Query, ID=${_lowestrock}].X},${Actor[Query, ID=${_lowestrock}].Z}]}<3 || !${Actor[Query, ID=${_MoltenID} && IsDead=FALSE](exists)}
				if ${Actor[Query, ID=${_MoltenID} && IsDead=FALSE](exists)}
				{
					Actor[Query, ID=${_lowestrock}]:DoubleClick
					Actor[Query, ID=${_lowestrock}]:DoubleClick
					Actor[Query, ID=${_lowestrock}]:DoubleClick
				}
			}
			call LockAndWait -Loc 64.218613,-121.359184,-201.442612
			RIMUIObj:SetLockSpot[ALL,64.218613,-121.359184,-201.442612]
			wait 150 ${Me.Distance2D[64.218613,-201.442612]}<3 || !${Actor[Query, ID=${_MoltenID} && IsDead=FALSE](exists)}
			RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="Molten Rock Placement"].Loc},3]
			wait 150 ${Me.Distance2D[${Actor[Query, Name=="Molten Rock Placement"].X},${Actor[Query, Name=="Molten Rock Placement"].Z}]}<4 || !${Actor[Query, ID=${_MoltenID} && IsDead=FALSE](exists)}
			wait 10 !${Me.IsMoving}
			if ${Actor[Query, ID=${_MoltenID} && IsDead=FALSE](exists)}
			{
				Face 360
				call PlaceHouseItem
			}
			RIMUIObj:SetLockSpot[ALL,64.218613,-121.359184,-201.442612]
			wait 150 ${Me.Distance2D[64.218613,-201.442612]}<3 || !${Actor[Query, ID=${_MoltenID} && IsDead=FALSE](exists)}
			;wait 2
			;call PlaceHouseItem
			;wait 2
			RI_CMD_Assist 1
		}
		wait 1
	}
	;call MoveBehind 
	;RI_Var_Int_MoveDistanceMod:Set[1]
	RI_CMD_Assist 1
	if ${Me.Distance2D[64.218613,-201.442612]}<5
		call LockAndWait -Loc 64.218613,-121.359184,-201.442612 -RelayToGroup
	wait 20
	call LockAndWait -Loc 64.604515,-121.683655,-173.401505 -RelayToGroup
	wait 2
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	echo ISXRI: Ending Molten 
}

function Balrezu()
{
	echo ISXRI: Starting Balrezu (Special thanks to MultiCharacter)
	variable int _DeadAddID=0
	while ${Me.Inventory[Query, Location=="Inventory" && Name=="Obsidian Sun Disc"](exists)} || ${Actor[Query, Name=-"a scorched fiend" && IsDead=TRUE && Distance<10](exists)}
	{
		Me.Inventory[Query, Location=="Inventory" && Name=="Obsidian Sun Disc"]:Destroy
		_DeadAddID:Set[${Actor[Query, Name=-"a scorched fiend" && IsDead=TRUE].ID}]
		relay ${RI_Var_String_RelayGroup} Actor[id,${_DeadAddID}]:DoubleClick
		relay ${RI_Var_String_RelayGroup} Actor[a scorched fiend]:DoubleClick
		relay ${RI_Var_String_RelayGroup} eq2ex apply_verb ${_DeadAddID} Loot
		relay ${RI_Var_String_RelayGroup} eq2ex apply_verb ${Actor[a scorched fiend].ID} Loot
		wait 1
		relay ${RI_Var_String_RelayGroup} LootWindow:RequestAll
		relay ${RI_Var_String_RelayGroup} LootWindow:LootAll
		waitframe
	}
	
	;declare _BALREZUSCRIPTRUNNING bool global TRUE
	Event[EQ2_ActorDespawned]:AttachAtom[EQ2_ActorDespawnedBalrezu]
	Event[EQ2_ActorSpawned]:AttachAtom[EQ2_ActorSpawnedBalrezu]
	
	RI_Var_Bool_Follow:Set[0]
	variable int _BalrezuID=${Actor[Query, Name=-"Balrezu" && IsDead=FALSE].ID}
	
	declare brazier1 int script 0
	declare brazier2 int script 0
	declare brazier3 int script 0
	declare brazier4 int script 0
	declare brazier5 int script 0
	declare brazier6 int script 0
	declare lastdead int script 0
	declare runtobrazier int global 0
	variable int _cnt
	if ${Me.SubClass.Equal[guardian]} && ${Me.Ability[id,1432018334].IsReady}
	{
		while !${Me.Maintained[Focused Offensive](exists)}
		{
			while ${Me.Ability[id,1432018334].IsReady}
			{
				Me.Ability[id,1432018334]:Use
				wait 5 ${Me.Maintained[Focused Offensive](exists)}
			}
			wait 5 ${Me.Maintained[Focused Offensive](exists)}
		}
	}
	elseif ${Me.Ability[id,4026518400].IsReady}
	{
		
		while !${Me.Maintained[Singular Focus](exists)}
		{
			while ${Me.Ability[id,4026518400].IsReady}
			{
				Me.Ability[id,4026518400]:Use
				wait 5 ${Me.Maintained[Singular Focus](exists)}
			}
			wait 5 ${Me.Maintained[Singular Focus](exists)}
		}
	}

	wait 10
	
	RI_Obj_CB:DoNotCastEncounter[TRUE]
	RI_Obj_CB:DoNotCastAE[TRUE]
	
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_BalrezuID} && IsDead=FALSE]:DoTarget
		RIMUIObj:SetLockSpot[ALL,36.469017,-137.864410,54.104221]
	}
	else
		RIMUIObj:SetLockSpot[ALL,36.469017,-137.864410,54.104221]
		
	while ${Actor[Query, ID=${_BalrezuID} && IsDead=FALSE](exists)} || ${Actor[Query, Name=-"a scorched fiend" && IsDead=FALSE](exists)} || ${lastdead}>0 || ${runtobrazier}>0
	{
		if ${Me.Inventory[Query, Location=="Inventory" && Name=="Obsidian Sun Disc"](exists)}
			Me.Inventory[Query, Location=="Inventory" && Name=="Obsidian Sun Disc"]:Destroy
		if ${Actor[Query, Name=-"a scorched fiend" && IsDead=TRUE && Distance<20](exists)}
		{
			RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=-"a scorched fiend" && IsDead=TRUE && Distance<20].Loc},7,500]
			_DeadAddID:Set[${Actor[Query, Name=-"a scorched fiend" && IsDead=TRUE].ID}]
			relay ${RI_Var_String_RelayGroup} Actor[id,${_DeadAddID}]:DoubleClick
			relay ${RI_Var_String_RelayGroup} Actor[a scorched fiend]:DoubleClick
			relay ${RI_Var_String_RelayGroup} eq2ex apply_verb ${_DeadAddID} Loot
			relay ${RI_Var_String_RelayGroup} eq2ex apply_verb ${Actor[a scorched fiend].ID} Loot
			wait 1
			relay ${RI_Var_String_RelayGroup} LootWindow:RequestAll
			relay ${RI_Var_String_RelayGroup} LootWindow:LootAll
		}
		else
			RIMUIObj:SetLockSpot[ALL,36.469017,-137.864410,54.104221]
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_BalrezuID} && IsDead=TRUE](exists)}
				runtobrazier:Set[0]
			if ${Actor[Query, Name=-"a scorched fiend" && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"a scorched fiend" && IsDead=FALSE].ID}
					Actor[Query, Name=-"a scorched fiend" && IsDead=FALSE]:DoTarget
			}
			elseif ${Actor[Query, ID=${_BalrezuID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_BalrezuID}
					Actor[Query, ID=${_BalrezuID} && IsDead=FALSE]:DoTarget
			}
			;echo runtobrazier: ${runtobrazier} // lastdead: ${lastdead} // \${Actor["a scorched fiend"](exists)}: ${Actor["a scorched fiend"](exists)}
			if !${Actor[Query, Name=-"a scorched fiend" && IsDead=FALSE && Distance<20](exists)}
			{
				_cnt:Set[1]
				while ${Actor[Query, Name=-"a scorched fiend" && IsDead=TRUE && Distance<20](exists)} && ${_cnt:Inc}<25
				{
					if ${Me.Inventory[Query, Location=="Inventory" && Name=="Obsidian Sun Disc"](exists)}
						Me.Inventory[Query, Location=="Inventory" && Name=="Obsidian Sun Disc"]:Destroy
					_DeadAddID:Set[${Actor[Query, Name=-"a scorched fiend" && IsDead=TRUE].ID}]
					relay ${RI_Var_String_RelayGroup} Actor[id,${_DeadAddID}]:DoubleClick
					relay ${RI_Var_String_RelayGroup} Actor[a scorched fiend]:DoubleClick
					relay ${RI_Var_String_RelayGroup} eq2ex apply_verb ${_DeadAddID} Loot
					relay ${RI_Var_String_RelayGroup} eq2ex apply_verb ${Actor[a scorched fiend].ID} Loot
					wait 1
					relay ${RI_Var_String_RelayGroup} LootWindow:RequestAll
					relay ${RI_Var_String_RelayGroup} LootWindow:LootAll
				}
				wait 5
				if ${lastdead}==1 && !${Actor[Query, Name=-"a scorched fiend" && IsDead=FALSE && Distance<20](exists)} && ${runtobrazier}==0
				{
					echo ISXRI: Moving to Brazier 1
					RIMUIObj:SetLockSpot[ALL,27.430893,-136.936249,55.982761]
					wait 10
					Actor["Brazier 1 - Boss 3"]:DoubleClick
					do
					{
						Actor["Brazier 1 - Boss 3"]:DoubleClick
						wait 1
					}
					while ${Actor["Brazier 1 - Boss 3"].Interactable}
					Actor["Brazier 1 - Boss 3"]:DoubleClick
					Actor["Brazier"]:DoubleClick
					wait 30 ${Actor[Query, ID=${_BalrezuID} && IsDead=FALSE](exists)}
					echo ISXRI: Moving to Main LockSpot
					RIMUIObj:SetLockSpot[ALL,36.469017,-137.864410,54.104221]
					runtobrazier:Set[1]
				}
				if ${lastdead}==2 && !${Actor[Query, Name=-"a scorched fiend" && IsDead=FALSE && Distance<20](exists)} && ${runtobrazier}==0
				{
					echo ISXRI: Moving to Brazier 2
					RIMUIObj:SetLockSpot[ALL,33.811638,-137.957504,63.495987]
					wait 10
					Actor["Brazier 2 - Boss 3"]:DoubleClick
					do
					{
						Actor["Brazier 2 - Boss 3"]:DoubleClick
						wait 1
					}
					while ${Actor["Brazier 2 - Boss 3"].Interactable}
					Actor["Brazier 2 - Boss 3"]:DoubleClick
					Actor["Brazier"]:DoubleClick
					wait 30 ${Actor[Query, ID=${_BalrezuID} && IsDead=FALSE](exists)}
					echo ISXRI: Moving to Main LockSpot
					RIMUIObj:SetLockSpot[ALL,36.469017,-137.864410,54.104221]
					runtobrazier:Set[1]
				}
				if ${lastdead}==3 && !${Actor[Query, Name=-"a scorched fiend" && IsDead=FALSE && Distance<20](exists)} && ${runtobrazier}==0
				{
					echo ISXRI: Moving to Brazier 3
					RIMUIObj:SetLockSpot[ALL,39.328651,-137.967072,71.948235]
					wait 10
					Actor["Brazier 3 - Boss 3"]:DoubleClick
					do
					{
						Actor["Brazier 3 - Boss 3"]:DoubleClick
						wait 1
					}
					while ${Actor["Brazier 3 - Boss 3"].Interactable}
					Actor["Brazier 3 - Boss 3"]:DoubleClick
					Actor["Brazier"]:DoubleClick
					wait 30 ${Actor[Query, ID=${_BalrezuID} && IsDead=FALSE](exists)}
					echo ISXRI: Moving to Main LockSpot
					RIMUIObj:SetLockSpot[ALL,36.469017,-137.864410,54.104221]
					runtobrazier:Set[1]
				}
				if ${lastdead}==4 && !${Actor[Query, Name=-"a scorched fiend" && IsDead=FALSE && Distance<20](exists)} && ${runtobrazier}==0
				{
					echo ISXRI: Moving to Brazier 4
					RIMUIObj:SetLockSpot[ALL,52.145103,-137.968842,59.713840]
					wait 10
					Actor["Brazier 4 - Boss 3"]:DoubleClick
					do
					{
						Actor["Brazier 4 - Boss 3"]:DoubleClick
						wait 1
					}
					while ${Actor["Brazier 4 - Boss 3"].Interactable}
					Actor["Brazier 4 - Boss 3"]:DoubleClick
					Actor["Brazier"]:DoubleClick
					wait 30 ${Actor[Query, ID=${_BalrezuID} && IsDead=FALSE](exists)}
					echo ISXRI: Moving to Main LockSpot
					RIMUIObj:SetLockSpot[ALL,36.469017,-137.864410,54.104221]
					runtobrazier:Set[1]
				}
				if ${lastdead}==5 && !${Actor[Query, Name=-"a scorched fiend" && IsDead=FALSE && Distance<20](exists)} && ${runtobrazier}==0
				{
					echo ISXRI: Moving to Brazier 5
					RIMUIObj:SetLockSpot[ALL,45.508354,-137.960281,53.483452]
					wait 10
					Actor["Brazier 5 - Boss 3"]:DoubleClick
					do
					{
						Actor["Brazier 5 - Boss 3"]:DoubleClick
						wait 1
					}
					while ${Actor["Brazier 5 - Boss 3"].Interactable}
					Actor["Brazier 5 - Boss 3"]:DoubleClick
					Actor["Brazier"]:DoubleClick
					wait 30 ${Actor[Query, ID=${_BalrezuID} && IsDead=FALSE](exists)}
					echo ISXRI: Moving to Main LockSpot
					RIMUIObj:SetLockSpot[ALL,36.469017,-137.864410,54.104221]
					runtobrazier:Set[1]
				}
				if ${lastdead}==6 && !${Actor[Query, Name=-"a scorched fiend" && IsDead=FALSE && Distance<20](exists)} && ${runtobrazier}==0
				{
					echo ISXRI: Moving to Brazier 6
					RIMUIObj:SetLockSpot[ALL,39.582027,-136.806122,45.559685]
					wait 10
					Actor["Brazier 6 - Boss 3"]:DoubleClick
					do
					{
						Actor["Brazier 6 - Boss 3"]:DoubleClick
						wait 1
					}
					while ${Actor["Brazier 6 - Boss 3"].Interactable}
					Actor["Brazier 6 - Boss 3"]:DoubleClick
					Actor["Brazier"]:DoubleClick
					wait 30 ${Actor[Query, ID=${_BalrezuID} && IsDead=FALSE](exists)}
					echo ISXRI: Moving to Main LockSpot
					RIMUIObj:SetLockSpot[ALL,36.469017,-137.864410,54.104221]
					runtobrazier:Set[1]
				}
			}
		}
		wait 5
	}
	RI_Var_Bool_Follow:Set[1]
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	RI_Var_Bool_Follow:Set[1]
	Event[EQ2_ActorDespawned]:DetachAtom[EQ2_ActorDespawnedBalrezu]
	Event[EQ2_ActorSpawned]:DetachAtom[EQ2_ActorSpawnedBalrezu]
	deletevariable runtobrazier
	
	;turn on ae's in CB
	RI_Obj_CB:DoNotCastEncounter[FALSE]
	RI_Obj_CB:DoNotCastAE[FALSE]
	
	if ${Me.SubClass.Equal[guardian]}
		Me.Maintained[Focused Offensive]:Cancel
	else
		Me.Maintained[Singular Focus]:Cancel
		
	wait 10
	;_BALREZUSCRIPTRUNNING:Set[FALSE]
	;deletevariable _BALREZUSCRIPTRUNNING
	echo ISXRI: Ending Balrezu
}
atom EQ2_ActorSpawnedBalrezu(string ID, string Name)
{
	if ${Name.Find[Balrezu](exists)}
	{
		brazier1:Set[0]
		brazier2:Set[0]
		brazier3:Set[0]
		brazier4:Set[0]
		brazier5:Set[0]
		brazier6:Set[0]
		lastdead:Set[0]
	}
	elseif ${Name.Find[a scorched fiend](exists)}
	{
		brazier1:Set[${Actor[Query, Name =- "a scorched fiend" && X < "25" && X > "21" && Z < "60" && Z > "56"].ID}]
		brazier2:Set[${Actor[Query, Name =- "a scorched fiend" && X < "32" && X > "28" && Z < "68" && Z > "64"].ID}]
		brazier3:Set[${Actor[Query, Name =- "a scorched fiend" && X < "38" && X > "34" && Z < "76" && Z > "72"].ID}]
		brazier4:Set[${Actor[Query, Name =- "a scorched fiend" && X < "57" && X > "53" && Z < "60" && Z > "55"].ID}]
		brazier5:Set[${Actor[Query, Name =- "a scorched fiend" && X < "50" && X > "46" && Z < "52" && Z > "48"].ID}]
		brazier6:Set[${Actor[Query, Name =- "a scorched fiend" && X < "44" && X > "40" && Z < "44" && Z > "40"].ID}]
		runtobrazier:Set[0]
	}
}
atom EQ2_ActorDespawnedBalrezu(string ID, string Name)
{
	if ${Name.Find[Balrezu](exists)}
		TimedCommand 5 runtobrazier:Set[0]
	if ${ID}==${brazier1}
	{
		echo ISXRI: Fiend 1 Despawned
		lastdead:Set[1]
	}
	if ${ID}==${brazier2}
	{
		echo ISXRI: Fiend 2 Despawned
		lastdead:Set[2]
	}
	if ${ID}==${brazier3}
	{
		echo ISXRI: Fiend 3 Despawned
		lastdead:Set[3]
	}
	if ${ID}==${brazier4}
	{
		echo ISXRI: Fiend 4 Despawned
		lastdead:Set[4]
	}
	if ${ID}==${brazier5}
	{
		echo ISXRI: Fiend 5 Despawned
		lastdead:Set[5]
	}
	if ${ID}==${brazier6}
	{
		echo ISXRI: Fiend 6 Despawned
		lastdead:Set[6]
	}
}
function Verlixa()
{	
	echo ISXRI: Starting Verlixa
	variable int _VerlixaID=${Actor[Query, Name=-"Verlixa" && IsDead=FALSE].ID}
	variable index:string _ClickOrder
	variable int _ShimID=-1
	variable int _ClickID=-1
	variable int _cnt
	variable int _ClickDistance=0
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["Reach for the flames and track down Verlixa before it's too late"]
	
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_VerlixaID} && IsDead=FALSE]:DoTarget
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-133.458954,-156.745697,-32.316185]
		wait 150 ${Me.Distance2D[-133.458954,-32.316185]}<3
		wait 150 ${Me.Distance2D[${Actor[Query, ID=${_VerlixaID} && IsDead=FALSE].X},${Actor[Query, ID=${_VerlixaID} && IsDead=FALSE].Z}]}<8
		wait 5
		relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,-137.744095,-156.544662,-28.210661]
	}
	
	while ${Actor[Query, ID=${_VerlixaID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=-"Shimmering Mirage" && Distance<10 && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"Shimmering Mirage" && Distance<10 && IsDead=FALSE].ID}
					Actor[Query, Name=-"Shimmering Mirage" && Distance<10 && IsDead=FALSE]:DoTarget
			}
			elseif ${Actor[Query, ID=${_BalrezuID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_BalrezuID}
					Actor[Query, ID=${_BalrezuID} && IsDead=FALSE]:DoTarget
			}
		}
		if ${Actor[Query, ID=${_VerlixaID} && X=-125.220001 && Y=-155.645615 && Z=-39.110001](exists)} && !${RI_Var_Bool_GlobalOthers}
		{
			;echo Triggered
			if !${RI_Var_Bool_GlobalOthers}
				press f1
			_ShimID:Set[-1]
			_ClickOrder:Clear
			Trigger:Set[0]
			while !${Trigger} && ${Actor[Query, ID=${_VerlixaID} && IsDead=FALSE](exists)}
			{
				if ${_ShimID}!=${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].ID} && ${Math.Distance[${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].Loc},-122.786087,-155.670547,-23.872786]}<8
				{
					echo ISXRI: #${Math.Calc[${_ClickOrder.Used}+1].Precision[0]}: Right
					; Y:${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].Y}
					_ShimID:Set[${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].ID}]
					_ClickOrder:Insert[Room Right]
				}
				elseif ${_ShimID}!=${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].ID} && ${Math.Distance[${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].Loc},-140.720886,-155.668198,-40.610302]}<8
				{
					echo ISXRI: #${Math.Calc[${_ClickOrder.Used}+1].Precision[0]}: Left
					; Y:${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].Y}
					_ShimID:Set[${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].ID}]
					_ClickOrder:Insert[Room Left]
				}
				elseif ${_ShimID}!=${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].ID} && ${Math.Distance[${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].Loc},-135.877472,-156.717697,-27.293276]}<8 && ${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].Y}<-155.9
				{
					echo ISXRI: #${Math.Calc[${_ClickOrder.Used}+1].Precision[0]}: Bottom
					; Y:${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].Y}
					_ShimID:Set[${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].ID}]
					_ClickOrder:Insert[Room Bottom]
				}
				elseif ${_ShimID}!=${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].ID} && ${Math.Distance[${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].Loc},-135.877472,-136.750076,-27.293276]}<8
				{
					echo ISXRI: #${Math.Calc[${_ClickOrder.Used}+1].Precision[0]}: Top
					; Y:${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].Y}
					_ShimID:Set[${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].ID}]
					_ClickOrder:Insert[Room Top]
				}
				elseif ${_ShimID}!=${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].ID} && ${Math.Distance[${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].Loc},-148.665451,-155.097153,-13.346222]}<8
				{
					echo ISXRI: #${Math.Calc[${_ClickOrder.Used}+1].Precision[0]}: Back
					; Y:${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].Y}
					_ShimID:Set[${Actor[Query, Name=-"Shimmering Mirage" && Type=="NoKill NPC"].ID}]
					_ClickOrder:Insert[Room Back]
				}
				waitframe
			}
			;echo Triggered 2
			Trigger:Set[0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[OFF]
			;echo ${_ClickOrder.Used}
			for(_cnt:Set[1];${_cnt}<=${_ClickOrder.Used};_cnt:Inc)
			{
				if	${_ClickOrder.Get[${_cnt}].Equal[Room Top]}
					_ClickDistance:Set[21]
				else
					_ClickDistance:Set[6]
				echo ISXRI: Moving To: ${_ClickOrder.Get[${_cnt}].Right[-5]}
				_ClickID:Set[${Actor[Query, Name=-"${_ClickOrder.Get[${_cnt}]}"].ID}]
				
				;echo RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ClickID}].Loc},2]
				;RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ClickID}].Loc},2]
				wait 5
				RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ClickID}].Loc},2]
				;echo before wait
				wait 150 ${Me.Distance2D[${Actor[Query, ID=${_ClickID}].X},${Actor[Query, ID=${_ClickID}].Z}]}<4
				;echo after wait
				;wait 5
				while ${Me.Distance2D[${Actor[Query, ID=${_ClickID}].X},${Actor[Query, ID=${_ClickID}].Z}]}<4
				{
					Actor[id,${Actor[Query, ID=${_ClickID}].ID}]:DoubleClick
					wait 1
				}
				;wait 5
				;relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Math.Calc[${Me.X}-2]},${Me.Y},${Me.Z}]
				;wait 10
				_ClickID:Set[${Actor[Query, Name=-"Room Bottom"].ID}]
				;echo RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ClickID}].X},${Actor[Query, ID=${_ClickID}].Y},${Math.Calc[${Actor[Query, ID=${_ClickID}].Z}-6]}]
				;RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ClickID}].X},${Actor[Query, ID=${_ClickID}].Y},${Math.Calc[${Actor[Query, ID=${_ClickID}].Z}-6]}]
				;wait 5
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ClickID}].X},${Actor[Query, ID=${_ClickID}].Y},${Math.Calc[${Actor[Query, ID=${_ClickID}].Z}-6]}]
				
				wait 150 ${Me.Distance2D[${Actor[Query, ID=${_ClickID}].X},${Actor[Query, ID=${_ClickID}].Z}]}<8
				wait 1
				_ShimID:Set[${Actor[Query, Name=-"Shimmering Mirage" && Type=="NamedNPC"].ID}]
				if !${RI_Var_Bool_GlobalOthers}
				{
					if ${Actor[Query, Name=-"Shimmering Mirage" && Distance<20 && IsDead=FALSE](exists)}
					{
						if ${Target.ID}!=${Actor[Query, Name=-"Shimmering Mirage" && Distance<20 && IsDead=FALSE].ID}
							Actor[Query, Name=-"Shimmering Mirage" && Distance<20 && IsDead=FALSE]:DoTarget
					}
				}
				if ${_ClickOrder.Get[${_cnt}].Equal[Room Bottom]} || ${_ClickOrder.Get[${_cnt}].Equal[Room Top]}
					wait 10
				_ClickID:Set[${Actor[Query, Name=-"Room Back"].ID}]
				_ShimID:Set[${Actor[Query, Name=-"Shimmering Mirage" && Type=="NamedNPC"].ID}]
				wait 2
				RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ShimID}].Loc},4]
				relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ClickID}].Loc},5]
				;wait 150 ${Math.Distance[${Me.Loc},${Actor[Query, ID=${_ShimID}].Loc}]}<5
				while ${Actor[Query, ID=${_ShimID} && IsDead=FALSE](exists)}
				{
					;echo ${Script.RunningTime} loop
					RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ShimID}].Loc},4]
					relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ClickID}].Loc},5]
					if !${RI_Var_Bool_GlobalOthers}
					{
						if ${Actor[Query, Name=-"Shimmering Mirage" && Distance<10 && IsDead=FALSE](exists)}
						{
							if ${Target.ID}!=${Actor[Query, Name=-"Shimmering Mirage" && Distance<10 && IsDead=FALSE].ID}
								Actor[Query, Name=-"Shimmering Mirage" && Distance<10 && IsDead=FALSE]:DoTarget
						}
					}
					wait 1
				}
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[OFF]
				if ${_ClickOrder.Get[${Math.Calc[${_cnt}+1]}].Equal[Room Left]} || ${Math.Calc[${_cnt}+1]}>${_ClickOrder.Used}
				{
					_ClickID:Set[${Actor[Query, Name=-"Room Bottom"].ID}]
					;echo RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ClickID}].X},${Actor[Query, ID=${_ClickID}].Y},${Math.Calc[${Actor[Query, ID=${_ClickID}].Z}-6]}]
					;RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ClickID}].X},${Actor[Query, ID=${_ClickID}].Y},${Math.Calc[${Actor[Query, ID=${_ClickID}].Z}-6]}]
					wait 1
					RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ClickID}].X},${Actor[Query, ID=${_ClickID}].Y},${Math.Calc[${Actor[Query, ID=${_ClickID}].Z}-6]}]
					wait 150 ${Me.Distance2D[${Actor[Query, ID=${_ClickID}].X},${Math.Calc[${Actor[Query, ID=${_ClickID}].Z}-6]}]}<3
				}
				if ${_ClickOrder.Get[${Math.Calc[${_cnt}+1]}].Equal[Room Right]} || ${Math.Calc[${_cnt}+1]}>${_ClickOrder.Used}
				{
					_ClickID:Set[${Actor[Query, Name=-"Room Bottom"].ID}]
					;echo RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ClickID}].X},${Actor[Query, ID=${_ClickID}].Y},${Math.Calc[${Actor[Query, ID=${_ClickID}].Z}-6]}]
					;RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ClickID}].X},${Actor[Query, ID=${_ClickID}].Y},${Math.Calc[${Actor[Query, ID=${_ClickID}].Z}-6]}]
					wait 1
					RIMUIObj:SetLockSpot[ALL,${Math.Calc[${Actor[Query, ID=${_ClickID}].X}+6]},${Actor[Query, ID=${_ClickID}].Y},${Actor[Query, ID=${_ClickID}].Z}]
					wait 150 ${Me.Distance2D[${Math.Calc[${Actor[Query, ID=${_ClickID}].X}+6]},${Actor[Query, ID=${_ClickID}].Z}]}<3
				}
				wait 1
			}
			_ClickID:Set[${Actor[Query, Name=-"Boss 4 Exit Portal"].ID}]
			RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_ClickID}].Loc}]
			wait 150 ${Me.Distance2D[${Actor[Query, ID=${_ClickID}].X},${Actor[Query, ID=${_ClickID}].Z}]}<3
			while ${Me.Distance2D[${Actor[Query, ID=${_ClickID}].X},${Actor[Query, ID=${_ClickID}].Z}]}<3
			{
				Actor[id,${Actor[Query, ID=${_ClickID}].ID}]:DoubleClick
				wait 1
			}
			RIMUIObj:SetLockSpot[OFF]
			;wait 20
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-133.458954,-156.745697,-32.316185]
			wait 150 ${Me.Distance2D[${Me.Loc},-133.458954,-32.316185]}<3
			while !${Actor[Query, ID=${_VerlixaID} && IsDead=FALSE](exists)} && ${Me.InCombat}
				wait 1
			wait 150 ${Me.Distance2D[${Actor[Query, ID=${_VerlixaID} && IsDead=FALSE].X},${Actor[Query, ID=${_VerlixaID} && IsDead=FALSE].Z}]}<8
			wait 5
			relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,-137.744095,-156.544662,-28.210661]
			_ClickID:Set[-1]
			_ShimID:Set[-1]
		}
		wait 1
	}
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	echo ISXRI: Ending Verlixa
}
function Galremos()
{
	call WaitForLastNamedChest START
	echo ISXRI: Starting Galremos 
	variable int _GalremosID=${Actor[Query, Name=-"Galremos" && IsDead=FALSE].ID}
	variable int _cnt=1
	variable int _Cnt=0
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,0]
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["Your obsidian sun disc glows"]
	RI_CMD_AbilityEnableDisable "Mana Cure" 0
	wait 1
	Me.Maintained[Mana Cure]:Cancel
	wait 1
	Me.Maintained[Mana Cure]:Cancel
	wait 1
	Me.Maintained[Mana Cure]:Cancel
	;set lockspot
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_GalremosID} && IsDead=FALSE]:DoTarget
		call LockAndWait -Loc -0.219651,-176.740952,-77.486061 -RelayToGroup
	}
	
	while ${Actor[Query, ID=${_GalremosID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=-"volatile construct of flames" && Distance<15 && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"volatile construct of flames" && Distance<15 && IsDead=FALSE].ID}
					Actor[Query, Name=-"volatile construct of flames" && Distance<15 && IsDead=FALSE]:DoTarget
			}
			elseif ${Actor[Query, ID=${_GalremosID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_GalremosID}
					Actor[Query, ID=${_GalremosID} && IsDead=FALSE]:DoTarget
			}
		}
		if ${Trigger}
		{
			Trigger:Set[FALSE]
			wait 2
			call LockAndWait -Loc ${Actor[Query, Name=-"Obsidian Sun Disc Drop Spot"].Loc}
			_cnt:Set[1]
			while ${_cnt:Inc}<20
			{
				Actor[Query, Name=-"Obsidian Sun Disc Drop Spot"]:DoubleClick
				wait 1
			}
			call LockAndWait -Loc -0.219651,-176.740952,-77.486061
		}
		if ${Me.Archetype.Equal[priest]} && ${Me.Ability[id,969542071].IsReady} && ( ${Me.Cursed}==-1 || ${Me.Group[1].Cursed}==-1 || ${Me.Group[2].Cursed}==-1 || ${Me.Group[3].Cursed}==-1 || ${Me.Group[4].Cursed}==-1 || ${Me.Group[5].Cursed}==-1 ) && ${Me.Elemental}==1
		{
			for(_Cnt:Set[0];${_Cnt}<${Me.Group};_Cnt:Inc)
			{
				if ${_Cnt}==0
				{
					while ${Me.Cursed}==-1
					{
						if !${Me.CastingSpell}
						{
							;echo eq2execute useabilityonplayer ${Me.Name} "Cure Curse"
							eq2execute useabilityonplayer ${Me.Name} 969542071
							eq2execute clearabilityqueue
						}
						else
							waitframe
						wait 2 ${Me.CastingSpell}
					}
				}
				else
				{
					while ${Me.Group[${_Cnt}].Cursed}==-1
					{
						if !${Me.CastingSpell}
						{
							;echo eq2execute useabilityonplayer ${Actor[id,${_Cursed.Get[${_Cnt}]}].Name} "Cure Curse"
							eq2execute useabilityonplayer ${Me.Group[${_Cnt}].Name} 969542071
							eq2execute clearabilityqueue
						}
						else
							waitframe
						wait 2 ${Me.CastingSpell}
					}
				}
			}
		}
		if ${Me.Archetype.Equal[priest]} && ( ( ${Me.Group[1].Elemental}==1 && ${RIObj.Archetype[${Me.Group[1].ID}].NotEqual[priest]} ) || ( ${Me.Group[2].Elemental}==1 && ${RIObj.Archetype[${Me.Group[2].ID}].NotEqual[priest]} ) || ( ${Me.Group[3].Elemental}==1 && ${RIObj.Archetype[${Me.Group[3].ID}].NotEqual[priest]} ) || ( ${Me.Group[4].Elemental}==1 && ${RIObj.Archetype[${Me.Group[4].ID}].NotEqual[priest]} ) || ( ${Me.Group[5].Elemental}==1 && ${RIObj.Archetype[${Me.Group[5].ID}].NotEqual[priest]} ) )
		{
			for(_Cnt:Set[0];${_Cnt}<${Me.Group};_Cnt:Inc)
			{
				while ${Me.Group[${_Cnt}].Elemental}==1 && ${RIObj.Archetype[${Me.Group[${_Cnt}].ID}].NotEqual[priest]}
				{
					if !${Me.CastingSpell}
					{
						;echo eq2execute useabilityonplayer ${Actor[id,${_Cursed.Get[${_Cnt}]}].Name} Cure
						eq2execute useabilityonplayer ${Me.Group[${_Cnt}].Name} 2945678992
						eq2execute clearabilityqueue
					}
					wait 2 ${Me.CastingSpell}
				}
			}
		}
		wait 2
	}
	;call MoveBehind 0
	;wait 2
	
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,1]
	RI_CMD_AbilityEnableDisable "Mana Cure" 1
	
	echo ISXRI: Ending Galremos 
	call WaitForLastNamedChest
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
}
;;;;;;;; End Solusek Ro's Tower: The Obsidian Core
;;;;;;;; Start Solusek Ro's Tower: The Monolith of Fire

function Jiva()
{	
	if !${Actor[Query, ID=${_JivaID} && IsDead=FALSE](exists)}
		return
	echo ISXRI: Starting Jiva 
	variable int _JivaID=${Actor[Query, Name=-"Jiva" && IsDead=FALSE].ID}
	variable bool _StoppedDPS=0
	variable bool _AscensionWasOn=False
	if ${RI_Obj_CB.GetUISetting[AscensionAutoComboAscensionsCheckBox]} && ${Me.GetGameData[Self.AscensionLevelClass].Label.Find["Etherealist"](exists)}
	{
		_AscensionWasOn:Set[1]
		RI_Obj_CB:SetUISetting[AscensionAutoComboAscensionsCheckBox,0]
	}
	RI_CMD_Assist 0
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["now vulnerable to your attacks"]
	"RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Ethershadow Assassin,0]"
	"RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Ethereal Conduit,0]"
	"RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Mantis Leap,0]"
	;IMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,0]
	;RIMUIObj:SetUISetting[ALL,SettingsCastInCombatTargetCheckBox,0]
	;RIMUIObj:SetUISetting[ALL,SettingsCastPowerCheckBox,0]
	if ${Zone.Name.Find[Solo]}
	{
		;set lockspot
		call LockAndWait -Loc "0.087217,-6.485186,-103.009682"
		call JumpUp 0.087217 -6.485186 -103.009682 -6 180
		wait 20
		call LockAndWait -Loc "0.130576,-4.802372,-97.933891"
	}
	else
	{
		;call LockAndWait -Loc "0.087217,-6.485186,-103.009682"
		declare _1Done bool global FALSE
		declare _2Done bool global FALSE
		declare _3Done bool global FALSE
		declare _4Done bool global FALSE
		declare _5Done bool global FALSE
		variable int _MyNum
		variable index:string _group
		variable index:string _priests
		declare Group string
		variable int _count=0
		for(_count:Set[1];${_count}<=${Me.Group};_count:Inc)
		{
			if ${RIObj.Archetype[${Me.Group[${Math.Calc[${_count}-1]}].ID}].NotEqual[priest]} && ${RIObj.Archetype[${Me.Group[${Math.Calc[${_count}-1]}].ID}].NotEqual[fighter]}
				_group:Insert[${Me.Group[${Math.Calc[${_count}-1]}]}]
		}
		for(_count:Set[1];${_count}<=${Me.Group};_count:Inc)
		{
			if ${RIObj.Archetype[${Me.Group[${Math.Calc[${_count}-1]}].ID}].Equal[priest]}
				_priests:Insert[${Me.Group[${Math.Calc[${_count}-1]}]}]
		}
		variable int _count2=0
		declare temp string
		for(_count:Set[1];${_count}<=${_group.Used};_count:Inc)
		{
			for(_count2:Set[1];${_count2}<=${_group.Used};_count2:Inc)
			{
				if ${_group.Get[${_count2}].Compare[${_group.Get[${_count}]}]}>0
				{
					temp:Set[${_group.Get[${_count}]}]
					_group.Get[${_count}]:Set[${_group.Get[${_count2}]}]
					_group.Get[${_count2}]:Set[${temp}]
				}
			}
		}
		for(_count:Set[1];${_count}<=${_priests.Used};_count:Inc)
		{
			for(_count2:Set[1];${_count2}<=${_priests.Used};_count2:Inc)
			{
				if ${_priests.Get[${_count2}].Compare[${_priests.Get[${_count}]}]}>0
				{
					temp:Set[${_priests.Get[${_count}]}]
					_priests.Get[${_count}]:Set[${_priests.Get[${_count2}]}]
					_priests.Get[${_count2}]:Set[${temp}]
				}
			}
		}
		for(_count:Set[1];${_count}<=${_priests.Used};_count:Inc)
		{
			_group:Insert[${_priests.Get[${_count}]}]
		}
		for(_count:Set[1];${_count}<=${_group.Used};_count:Inc)
		{
			echo ${_count}: ${_group.Get[${_count}]}
			if ${Me.Name.Equal[${_group.Get[${_count}]}]}
				_MyNum:Set[${_count}]
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetRIFollow[OFF]
		wait 5
		;NW
		if ${_MyNum}==3
		{
			call LockAndWait -Loc 20.858171,-6.485186,-104.812553
			wait 5
			call JumpUp 16.394678 -6.485186 -97.233582 -6 135 10 0
			wait 20
			call LockAndWait -Loc 13.815892,-5.322013,-94.462601
			relay ${RI_Var_String_RelayGroup} _4Done:Set[1]
		}
		;NE
		if ${_MyNum}==2
		{
			call LockAndWait -Loc -20.858171,-6.485186,-104.812553
			wait 5
			call JumpUp -15.838044 -6.485186 -97.059563 -6 220 10 0
			wait 20
			call LockAndWait -Loc -13.863585,-5.322164,-94.703926
			relay ${RI_Var_String_RelayGroup} _3Done:Set[1]
		}
		; SW
		if ${_MyNum}==1
		{
			call LockAndWait -Loc 20.621332,-6.485186,-54.947998
			wait 5
			call JumpUp 16.320486 -6.485186 -57.979885 -6 40 10 0
			wait 20
			call LockAndWait -Loc 13.823691,-5.285949,-60.345699 
			relay ${RI_Var_String_RelayGroup} _1Done:Set[1]
		}
		; SE (healer)
		if ${_MyNum}==4
		{
			call LockAndWait -Loc 20.621332,-6.485186,-54.947998
			call LockAndWait -Loc -20.017866,-6.485186,-54.868988
			wait 5
			call JumpUp -16.049561 -6.485186 -58.290283 -6 315 10 0
			wait 20
			call LockAndWait -Loc -13.805676,-5.285904,-60.179337
			relay ${RI_Var_String_RelayGroup} _2Done:Set[1]
		}
		;N
		if ${Me.Archetype.Equal[fighter]} || ${_MyNum}==5
		{
			call LockAndWait -Loc 0.087217,-6.485186,-103.009682
			wait 5
			call JumpUp 0.087217 -6.485186 -103.009682 -6 180 10 0
			wait 20
			call LockAndWait -Loc 0.207617,-4.801731,-96.777855
			relay ${RI_Var_String_RelayGroup} _5Done:Set[1]
		}
		wait 300 ${_1Done} && ${_2Done} && ${_3Done} && ${_4Done} && ${_5Done}
	}
	while ${Actor[Query, ID=${_JivaID} && IsDead=FALSE](exists)}
	{
		;still need to code the placeable items for heroic
		;if !${RI_Var_Bool_GlobalOthers}
		;{
			if ${Actor[Query, Name=-"construct" && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"construct" && IsDead=FALSE].ID}
					Actor[Query, Name=-"construct" && IsDead=FALSE]:DoTarget
			}
			elseif ${Actor[Query, ID=${_JivaID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_JivaID}
					Actor[Query, ID=${_JivaID} && IsDead=FALSE]:DoTarget
			}
		;}
		if ${RIMUIObj.MainIconIDExists[${_JivaID},274]} && !${_StoppedDPS} && ${Zone.Name.Find[Solo]}
		{
			RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
			RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
			_StoppedDPS:Set[1]
		}
		if ${Trigger} && ${Zone.Name.Find[Solo]}
		{
			RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
			RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
			Trigger:Set[0]
		}
		wait 1
	}
	if !${Zone.Name.Find[Solo]}
	{
		;NW
		if ${_MyNum}==3
		{
			call LockAndWait -Loc 20.858171,-6.485186,-104.812553
		}
		;NE
		if ${_MyNum}==2
		{
			call LockAndWait -Loc -20.858171,-6.485186,-104.812553
			call LockAndWait -Loc 20.858171,-6.485186,-104.812553
		}
		;SW
		if ${_MyNum}==1
		{
			call LockAndWait -Loc 20.621332,-6.485186,-54.947998
			call LockAndWait -Loc 20.858171,-6.485186,-104.812553
		}
		;SE
		if ${_MyNum}==4
		{
			call LockAndWait -Loc -20.017866,-6.485186,-54.868988
			call LockAndWait -Loc 20.621332,-6.485186,-54.947998
			call LockAndWait -Loc 20.858171,-6.485186,-104.812553
		}
		;N
		if ${Me.Archetype.Equal[fighter]} || ${_MyNum}==5
		{
			call LockAndWait -Loc 0.087217,-6.485186,-103.009682
			call LockAndWait -Loc 20.858171,-6.485186,-104.812553
		}
		wait 300 ${RIMObj.AllGroupWithinRange[3]}
	}
	else
		call LockAndWait -Loc 0.087217,-6.485186,-103.009682 -RelayToGroup
	RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
	RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	if !${Zone.Name.Find[Solo]}
	{
		deletevariable _1Done
		deletevariable _2Done
		deletevariable _3Done
		deletevariable _4Done
		deletevariable _5Done
	}
	RI_CMD_Assist 1
	"RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Ethershadow Assassin,1]"
	"RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Ethereal Conduit,1]"
	"RI_Obj_CB:ModifyCastStackAbiltiesListBoxItem[Mantis Leap,1]"
	;RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,1]
	;RIMUIObj:SetUISetting[ALL,SettingsCastInCombatTargetCheckBox,1]
	;RIMUIObj:SetUISetting[ALL,SettingsCastPowerCheckBox,1]
	if ${_AscensionWasOn}
	{
		RI_Obj_CB:SetUISetting[AscensionAutoComboAscensionsCheckBox,1]
	}
	echo ISXRI: Ending Jiva 
}
function Estryxia()
{
	echo ISXRI: Starting Estryxia 
	variable int _EstryxiaID=${Actor[Query, Name=-"Estryxia" && IsDead=FALSE && Type!="NoKill NPC"].ID}
	variable string _CurrentLockSpot="163.830322,102.289536,-100.806717"
	variable bool _Triggered=0
	variable bool _FirstTrigger=0
	RI_CMD_AbilityEnableDisable "Cloak of Divinity" 0
	;RI_Var_Int_MoveDistanceMod:Set[6]
	;set lockspot
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["rings become too imbalanced! Estryxia responds with Untamed Fire!"]
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_EstryxiaID} && IsDead=FALSE]:DoTarget
		;wait 20
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,140.198959,102.289925,-114.017471]
		wait 150 ${Math.Distance[${Me.Loc},140.198959,102.289925,-114.017471]}<3
		wait 150 ${Actor[Query, ID=${_EstryxiaID} && IsDead=FALSE].Distance}<10
		if !${Zone.Name.Find[Heroic]}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,149.164719,103.643303,-184.984360,1,500]
		; wait 25
		; relay "other ${RI_Var_String_RelayGroup}" RI_Var_String_MoveBehindFallBackPCName:Set[${Me.ID}]
	}
	; else
	; {
		; wait 150 ${Math.Distance[${Me.Loc},163.830322,102.289536,-100.806717]}<3
		; wait 150 ${Actor[Query, ID=${_EstryxiaID} && IsDead=FALSE].Distance}<8
		; RIMUIObj:SetLockSpot[OFF]
		; call MoveBehind ${_EstryxiaID}
	; }
	
	while ${Actor[Query, ID=${_EstryxiaID} && IsDead=FALSE](exists)}
	{
		;still need to code the placeable items for heroic
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_EstryxiaID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_EstryxiaID}
					Actor[Query, ID=${_EstryxiaID} && IsDead=FALSE]:DoTarget
			}
		}
		; else
		; {
			; if ${Actor[Query, ID=${_EstryxiaID} && IsDead=FALSE].Target.ID}==${Me.ID}
			; {
				; call MoveBehind 0
				; RIMUIObj:SetLockSpot[ALL,${_CurrentLockSpot}]
			; }
			; else
			; {
				; call MoveBehind ${_EstryxiaID}
			; }
		; }
		if ${Actor[Query, ID=${_EstryxiaID} && IsDead=FALSE].Health}==100 && !${_Triggered} && ${_FirstTrigger} && !${Triggered} && !${Zone.Name.Find[Heroic]} && !${Zone.Name.Find["[Expert]"]}
		{
			_Triggered:Set[1]
			if ${Me.Distance[149.164719,103.643303,-184.984360]}<10
				_CurrentLockSpot:Set["142.117279,103.562439,18.983875"]
			else
				_CurrentLockSpot:Set["149.164719,103.643303,-184.984360"]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Cast[ALL,Cloak of Divinity,1]
			TimedCommand 10 relay ${RI_Var_String_RelayGroup} RIMUIObj:Cast[ALL,Cloak of Divinity,1]
			waitframe
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_CurrentLockSpot},1,500]
			waitframe
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_CurrentLockSpot},1,500]
			Actor[${Me.ID}]:DoTarget
			waitframe
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_CurrentLockSpot},1,500]
			
			wait 300 ${Math.Distance[${Me.Loc},${_CurrentLockSpot}]}<4
			if ${Me.Distance[142.117279,103.562439,18.983875]}<10
				_CurrentLockSpot:Set["150.010345,103.568810,18.990198"]
			wait 20
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_CurrentLockSpot},1,500]
		}
		if ${Actor[Query, ID=${_EstryxiaID} && IsDead=FALSE].Health}<100 && !${_FirstTrigger}
			_FirstTrigger:Set[1]
		if ${Actor[Query, ID=${_EstryxiaID} && IsDead=FALSE].Health}<100
			_Triggered:Set[0]
		wait 1
	}
	;RI_Var_Int_MoveDistanceMod:Set[1]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,163.830322,102.289536,-100.806717]
	wait 150 ${Math.Distance[${Me.Loc},163.830322,102.289536,-100.806717]}<3
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	echo ISXRI: Ending Estryxia 
	Triggered:Set[0]
	RI_CMD_AbilityEnableDisable "Cloak of Divinity" 1
}
function So'valiz()
{
	call So'Valiz
}
function Sovaliz()
{
	call So'Valiz
}
function So'Valiz()
{	
	echo ISXRI: Starting So'Valiz 
	variable int _SovalizID=${Actor[Query, Name=-"So'Valiz" && IsDead=FALSE].ID}
	variable index:string _Claws
	variable int _cnt
	
	IncomingText:Clear
	IncomingText:Insert[You raised the correct claw]
	IncomingText:Insert[claws must match the]
	IncomingText:Insert[claws must mirror the]
	IncomingText:Insert[Let the game continue]
	IncomingText:Insert[Let us play a little game]
	RI_CMD_AbilityEnableDisable "Cloak of Divinity" 0
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_SovalizID} && IsDead=FALSE]:DoTarget
		call LockAndWait -Loc -169.114044,102.289429,-82.089691 -RelayToGroup
	}
	_SovalizID:Set[${Actor[Query, Name=-"So'Valiz" && IsDead=FALSE].ID}]
	while ${Actor[Query, ID=${_SovalizID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=-"emberscale" && IsDead=FALSE && Distance<15](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"emberscale" && IsDead=FALSE && Distance<15].ID}
					Actor[Query, Name=-"emberscale" && IsDead=FALSE && Distance<15]:DoTarget
			}
			elseif ${Actor[Query, ID=${_SovalizID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_SovalizID}
					Actor[Query, ID=${_SovalizID} && IsDead=FALSE]:DoTarget
			}
		}
		if ${Trigger} && ( ${TriggerMessage.Find[Let the game continue]} || ${TriggerMessage.Find[Let us play a little game]} ) && !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=-"emberscale" && IsDead=FALSE && Distance<15](exists)}
				Actor[Query, Name=-"emberscale" && IsDead=FALSE && Distance<15]:DoTarget
			else
				Actor[id, ${Me.ID}]:DoTarget
			Trigger:Set[0]
			wait 100 ${Trigger}
			wait 5
		}
		if ${Trigger} && ${TriggerMessage.Find[claws must mirror the]} && !${RI_Var_Bool_GlobalOthers}
		{
			echo ISXRI: Click Order:
			_Claws:Clear
			press f1
			Trigger:Set[0]
			_cnt:Set[1]
			while ${_Claws.Used}<1 && ${_cnt:Inc}<11
			{
				wait 5
				;Pillar 1 Claw 1 
				if ${Actor[Query, Name="Claw Socket" && X=-132.809906 && Y=102.289902 && Z=-30.139030].CheckCollision[-132.876740,104.974373,-30.551285]} || ${EQ2.CheckCollision[-132.809906 && Y=102.289902 && Z=-30.139030,-132.876740,104.974373,-30.551285]}
					_Claws:Insert["Pillar 2 Claw 1"];echo ISXRI: Pillar 2 Claw 1
				
				;Pillar 1 Claw 2 
				if ${Actor[Query, Name="Claw Socket" && X=-123.072304 && Y=102.290199 && Z=-26.993500].CheckCollision[-122.563492,104.076027,-27.986765]} || ${EQ2.CheckCollision[-123.072304,102.290199,-26.993500,-122.563492,104.076027,-27.986765]}
					_Claws:Insert["Pillar 2 Claw 2"];echo ISXRI: Pillar 2 Claw 2
				
				;Pillar 1 Claw 3 
				if ${Actor[Query, Name="Claw Socket" && X=-116.990097 && Y=102.290199 && Z=-18.678169].CheckCollision[-116.508820,104.576309,-18.889311]} || ${EQ2.CheckCollision[-116.990097,102.290199,-18.678169,-116.508820,104.576309,-18.889311]}
					_Claws:Insert["Pillar 2 Claw 3"];echo ISXRI: Pillar 2 Claw 3
				
				;Pillar 1 Claw 4 
				if ${Actor[Query, Name="Claw Socket" && X=-116.967903 && Y=102.290199 && Z=-8.441080].CheckCollision[-116.134590,104.275299,-8.234612]} || ${EQ2.CheckCollision[-116.967903,102.290199,-8.441080,-116.134590,104.275299,-8.234612]}
					_Claws:Insert["Pillar 2 Claw 4"];echo ISXRI: Pillar 2 Claw 4

				;Pillar 1 Claw 5 
				if ${Actor[Query, Name="Claw Socket" && X=-123.006500 && Y=102.290199 && Z=-0.073608].CheckCollision[-123.201340,105.026001,-0.066932]} || ${EQ2.CheckCollision[-123.006500,102.290199,-0.073608,-123.201340,105.026001,-0.066932]}
					_Claws:Insert["Pillar 2 Claw 5"];echo ISXRI: Pillar 2 Claw 5
					
				;Pillar 1 Claw 6 
				if ${Actor[Query, Name="Claw Socket" && X=-132.795898 && Y=102.290199 && Z=3.088176].CheckCollision[-132.789337,105.588890,2.177380]} || ${EQ2.CheckCollision[-132.795898,102.290199,3.088176,-132.789337,105.588890,2.177380]}
					_Claws:Insert["Pillar 2 Claw 6"];echo ISXRI: Pillar 2 Claw 6
					
				;Pillar 1 Claw 7 
				if ${Actor[Query, Name="Claw Socket" && X=-142.551697 && Y=102.290199 && Z=-0.048574].CheckCollision[-142.967758,104.362869,0.526986]} || ${EQ2.CheckCollision[-142.551697,102.290199,-0.048574,-142.967758,104.362869,0.526986]}
					_Claws:Insert["Pillar 2 Claw 7"];echo ISXRI: Pillar 2 Claw 7
					
				;Pillar 1 Claw 8 
				if ${Actor[Query, Name="Claw Socket" && X=-148.644196 && Y=102.290199 && Z=-8.376815].CheckCollision[-148.193466,105.331329,-8.590580]} || ${EQ2.CheckCollision[-148.644196,102.290199,-8.376815,-148.193466,105.331329,-8.590580]}
					_Claws:Insert["Pillar 2 Claw 8"];echo ISXRI: Pillar 2 Claw 8
					
				;Pillar 1 Claw 9 
				if ${Actor[Query, Name="Claw Socket" && X=-148.641006 && Y=102.290199 && Z=-18.598370].CheckCollision[-149.564621,104.165581,-18.901840]} || ${EQ2.CheckCollision[-148.641006,102.290199,-18.598370,-149.564621,104.165581,-18.901840]}
					_Claws:Insert["Pillar 2 Claw 9"];echo ISXRI: Pillar 2 Claw 9
					
				;Pillar 1 Claw 10 
				if ${Actor[Query, Name="Claw Socket" && X=-142.606293 && Y=102.290199 && Z=-26.952299].CheckCollision[-142.731247,104.853073,-27.068985]} || ${EQ2.CheckCollision[-142.606293,102.290199,-26.952299,-142.731247,104.853073,-27.068985]}
					_Claws:Insert["Pillar 2 Claw 10"];echo ISXRI: Pillar 2 Claw 10
					
				;Pillar 2 Claw 1 
				if ${Actor[Query, Name="Claw Socket" && X=-132.794495 && Y=102.290199 && Z=-133.908203].CheckCollision[-132.830460,104.594795,-133.452286]} || ${EQ2.CheckCollision[-132.794495,102.290199,-133.908203,-132.830460,104.594795,-133.452286]}
					_Claws:Insert["Pillar 1 Claw 1"];echo ISXRI: Pillar 1 Claw 1
					
				;*Pillar 2 Claw 2 -- changed to used locs
				;if !${Actor[Query, Name="Claw Socket" && X=-121.135902 && Y=102.290199 && Z=-134.425598].CheckCollision[-119.885948,108.290123,-132.507950]} && ${Actor[Query, Name="Claw Socket" && X=-121.135902 && Y=102.290199 && Z=-134.425598](exists)}
				if ${EQ2.CheckCollision[-123.315155,102.356049,-137.388168,-123.315155,112.356049,-137.388168]}
					_Claws:Insert["Pillar 1 Claw 2"];echo ISXRI: Pillar 1 Claw 2
					
				;Pillar 2 Claw 3 
				if ${Actor[Query, Name="Claw Socket" && X=-116.966499 && Y=102.290199 && Z=-145.437393].CheckCollision[-116.897285,104.805008,-145.289871]} || ${EQ2.CheckCollision[-116.966499,102.290199,-145.437393,-116.897285,104.805008,-145.289871]}
					_Claws:Insert["Pillar 1 Claw 3"];echo ISXRI: Pillar 1 Claw 3
					
				;Pillar 2 Claw 4 
				if ${Actor[Query, Name="Claw Socket" && X=-116.988701 && Y=102.290199 && Z=-155.674500].CheckCollision[-116.703773,104.723480,-155.781784]} || ${EQ2.CheckCollision[-116.988701,102.290199,-155.674500,-116.703773,104.723480,-155.781784]}
					_Claws:Insert["Pillar 1 Claw 4"];echo ISXRI: Pillar 1 Claw 4
					
				;Pillar 2 Claw 5 
				if ${Actor[Query, Name="Claw Socket" && X=-123.070900 && Y=102.290199 && Z=-163.989899].CheckCollision[-123.116676,105.095894,-163.806793]} || ${EQ2.CheckCollision[-123.070900,102.290199,-163.989899,-123.116676,105.095894,-163.806793]}
					_Claws:Insert["Pillar 1 Claw 5"];echo ISXRI: Pillar 1 Claw 5
					
				;Pillar 2 Claw 6 
				if ${Actor[Query, Name="Claw Socket" && X=-132.808502 && Y=102.289902 && Z=-167.135406].CheckCollision[-132.741974,104.808174,-167.320221]} || ${EQ2.CheckCollision[-132.808502,102.289902,-167.135406,-132.741974,104.808174,-167.320221]}
					_Claws:Insert["Pillar 1 Claw 6"];echo ISXRI: Pillar 1 Claw 6
					
				;Pillar 2 Claw 7
				if ${Actor[Query, Name="Claw Socket" && X=-142.604904 && Y=102.290199 && Z=-163.948700].CheckCollision[-141.952988,105.716217,-163.201263]} || ${EQ2.CheckCollision[-142.604904,102.290199,-163.948700,-141.952988,105.716217,-163.201263]}
					_Claws:Insert["Pillar 1 Claw 7"];echo ISXRI: Pillar 1 Claw 7
					
				;Pillar 2 Claw 8 
				if ${Actor[Query, Name="Claw Socket" && X=-148.639603 && Y=102.290199 && Z=-155.594696].CheckCollision[-149.126892,104.558823,-155.486404]} || ${EQ2.CheckCollision[-148.639603,102.290199,-155.594696,-149.126892,104.558823,-155.486404]}
					_Claws:Insert["Pillar 1 Claw 8"];echo ISXRI: Pillar 1 Claw 8
					
				;Pillar 2 Claw 9 
				if ${Actor[Query, Name="Claw Socket" && X=-148.642807 && Y=102.290199 && Z=-145.373199].CheckCollision[-149.332596,104.337715,-145.057266]} || ${EQ2.CheckCollision[-148.642807,102.290199,-145.373199,-149.332596,104.337715,-145.057266]}
					_Claws:Insert["Pillar 1 Claw 9"];echo ISXRI: Pillar 1 Claw 9
					
				;Pillar 2 Claw 10 
				if ${Actor[Query, Name="Claw Socket" && X=-142.550400 && Y=102.290199 && Z=-137.044907].CheckCollision[-142.454697,105.069016,-137.221100]} || ${EQ2.CheckCollision[-142.550400,102.290199,-137.044907,-142.454697,105.069016,-137.221100]}
					_Claws:Insert["Pillar 1 Claw 10"];echo ISXRI: Pillar 1 Claw 10
			}
			if ${_Claws.Used}<1
			{
				echo ISXRI: Unable to determine claw click order after 5s, report this to Herculezz
			}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Cast[ALL,Cloak of Divinity,1]
			TimedCommand 10 relay ${RI_Var_String_RelayGroup} RIMUIObj:Cast[ALL,Cloak of Divinity,1]
			if ${_Claws.Get[1].Find[Pillar 2 Claw]}
			{
				if ${_Claws.Get[1].Find[Pillar 2 Claw 5]}
				{
					call LockAndWait -Loc -160.235199,102.289948,-146.112701 -RelayToGroup
				}
				else
				{	
					call LockAndWait -Loc -150.666718,102.290024,-127.147987 -RelayToGroup
				}
			}
			else
			{
				if ${_Claws.Get[1].Find[Pillar 1 Claw 5]}
				{
					call LockAndWait -Loc -161.633987,102.289909,-16.908567 -RelayToGroup
				}
				else
				{	
					call LockAndWait -Loc -150.365585,102.290047,-37.839512 -RelayToGroup
				}
			}
			;for loop
			for(_cnt:Set[1];${_cnt}<=${_Claws.Used};_cnt:Inc)
			{
				echo ISXRI: Moving to and Clicking: ${_Claws.Get[${_cnt}]}
				if ${_Claws.Get[${_cnt}].Find[Pillar 2 Claw](exists)} && !${_Claws.Get[${_cnt}].Find[Pillar 2 Claw 5](exists)}
				{
					;call LockAndWait -Loc -150.666718,102.290024,-127.147987 -RelayToGroup
					wait 5
					echo ISXRI: Moving To ${Actor[Query, Name=="${_Claws.Get[${_cnt}]}"].Loc}
					call LockAndWait -Loc ${Actor[Query, Name=="${_Claws.Get[${_cnt}]}"].Loc} -Precision 5
					while !${Trigger}
					{
						Actor[Query, Name=="${_Claws.Get[${_cnt}]}"]:DoubleClick
					}
					Trigger:Set[0]
					;call LockAndWait -Loc -150.666718,102.290024,-127.147987 -RelayToGroup
				}
				elseif ${_Claws.Get[${_cnt}].Find[Pillar 2 Claw](exists)} && ${_Claws.Get[${_cnt}].Find[Pillar 2 Claw 5](exists)}
				{
					;call LockAndWait -Loc -160.235199,102.289948,-146.112701 -RelayToGroup
					wait 5
					echo ISXRI: Moving to ${Actor[Query, Name=="${_Claws.Get[${_cnt}]}"].Loc}
					call LockAndWait -Loc ${Actor[Query, Name=="${_Claws.Get[${_cnt}]}"].Loc} -Precision 5
					while !${Trigger}
					{
						Actor[Query, Name=="${_Claws.Get[${_cnt}]}"]:DoubleClick
					}
					Trigger:Set[0]
					;call LockAndWait -Loc -160.235199,102.289948,-146.112701 -RelayToGroup
					;call LockAndWait -Loc -150.666718,102.290024,-127.147987 -RelayToGroup
				}
				elseif ${_Claws.Get[${_cnt}].Find[Pillar 1 Claw](exists)} && !${_Claws.Get[${_cnt}].Find[Pillar 1 Claw 5](exists)}
				{
					;call LockAndWait -Loc -150.365585,102.290047,-37.839512 -RelayToGroup
					wait 5
					echo ISXRI: Moving to ${Actor[Query, Name=="${_Claws.Get[${_cnt}]}"].Loc}
					call LockAndWait -Loc ${Actor[Query, Name=="${_Claws.Get[${_cnt}]}"].Loc} -Precision 5
					while !${Trigger}
					{
						Actor[Query, Name=="${_Claws.Get[${_cnt}]}"]:DoubleClick
					}
					Trigger:Set[0]
					;call LockAndWait -Loc -150.365585,102.290047,-37.839512 -RelayToGroup
				}
				elseif ${_Claws.Get[${_cnt}].Find[Pillar 1 Claw](exists)} && ${_Claws.Get[${_cnt}].Find[Pillar 1 Claw 5](exists)}
				{
					;call LockAndWait -Loc -161.633987,102.289909,-16.908567 -RelayToGroup
					wait 5
					echo ISXRI: Moving to ${Actor[Query, Name=="${_Claws.Get[${_cnt}]}"].Loc}
					call LockAndWait -Loc ${Actor[Query, Name=="${_Claws.Get[${_cnt}]}"].Loc} -Precision 5
					while !${Trigger}
					{
						Actor[Query, Name=="${_Claws.Get[${_cnt}]}"]:DoubleClick
					}
					Trigger:Set[0]
					;call LockAndWait -Loc -161.633987,102.289909,-16.908567 -RelayToGroup
					;call LockAndWait -Loc -150.365585,102.290047,-37.839512 -RelayToGroup
				}
				wait 5
			}
			if ${Actor[Query, ID=${_SovalizID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_SovalizID}
					Actor[Query, ID=${_SovalizID} && IsDead=FALSE]:DoTarget
			}
			;;;;;;;;;;;;;;;
			if ${_Claws.Get[${_Claws.Used}].Find[Pillar 2 Claw]}
			{
				if ${_Claws.Get[${_Claws.Used}].Find[Pillar 2 Claw 5]}
				{
					call LockAndWait -Loc -160.235199,102.289948,-146.112701 -RelayToGroup
				}
				else
				{	
					call LockAndWait -Loc -150.666718,102.290024,-127.147987 -RelayToGroup
				}
			}
			else
			{
				if ${_Claws.Get[${_Claws.Used}].Find[Pillar 1 Claw 5]}
				{
					call LockAndWait -Loc -161.633987,102.289909,-16.908567 -RelayToGroup
				}
				else
				{	
					call LockAndWait -Loc -150.365585,102.290047,-37.839512 -RelayToGroup
				}
			}
			call PreHeal
			call LockAndWait -Loc -169.114044,102.289429,-82.089691 -RelayToGroup
		}
		if ${Trigger} && ${TriggerMessage.Find[claws must match the]} && !${Zone.Name.Find[Solo]} && !${RI_Var_Bool_GlobalOthers}
		{
			echo ISXRI: Click Order:
			_Claws:Clear
			press f1
			Trigger:Set[0]
			_cnt:Set[1]
			while ${_Claws.Used}<1 && ${_cnt:Inc}<11
			{
				wait 5
				;Pillar 1 Claw 1 
				if ${Actor[Query, Name="Claw Socket" && X=-132.809906 && Y=102.289902 && Z=-30.139030].CheckCollision[-132.876740,104.974373,-30.551285]} || ${EQ2.CheckCollision[-132.809906,102.289902,-30.139030,-132.876740,104.974373,-30.551285]}
					_Claws:Insert["Pillar 2 Claw 6"];echo ISXRI: Pillar 2 Claw 6
				
				;Pillar 1 Claw 2 
				if ${Actor[Query, Name="Claw Socket" && X=-123.072304 && Y=102.290199 && Z=-26.993500].CheckCollision[-122.563492,104.076027,-27.986765]} || ${EQ2.CheckCollision[]}
					_Claws:Insert["Pillar 2 Claw 5"];echo ISXRI: Pillar 2 Claw 5
				
				;Pillar 1 Claw 3 
				if ${Actor[Query, Name="Claw Socket" && X=-116.990097 && Y=102.290199 && Z=-18.678169].CheckCollision[-116.508820,104.576309,-18.889311]} || ${EQ2.CheckCollision[]}
					_Claws:Insert["Pillar 2 Claw 4"];echo ISXRI: Pillar 2 Claw 4
				
				;Pillar 1 Claw 4 
				if ${Actor[Query, Name="Claw Socket" && X=-116.967903 && Y=102.290199 && Z=-8.441080].CheckCollision[-116.134590,104.275299,-8.234612]} || ${EQ2.CheckCollision[]}
					_Claws:Insert["Pillar 2 Claw 3"];echo ISXRI: Pillar 2 Claw 3

				;Pillar 1 Claw 5 
				if ${Actor[Query, Name="Claw Socket" && X=-123.006500 && Y=102.290199 && Z=-0.073608].CheckCollision[-123.201340,105.026001,-0.066932]} || ${EQ2.CheckCollision[]}
					_Claws:Insert["Pillar 2 Claw 2"];echo ISXRI: Pillar 2 Claw 2
					
				;Pillar 1 Claw 6 
				if ${Actor[Query, Name="Claw Socket" && X=-132.795898 && Y=102.290199 && Z=3.088176].CheckCollision[-132.789337,105.588890,2.177380]} || ${EQ2.CheckCollision[]}
					_Claws:Insert["Pillar 2 Claw 1"];echo ISXRI: Pillar 2 Claw 1
					
				;Pillar 1 Claw 7 
				if ${Actor[Query, Name="Claw Socket" && X=-142.551697 && Y=102.290199 && Z=-0.048574].CheckCollision[-142.967758,104.362869,0.526986]} || ${EQ2.CheckCollision[]}
					_Claws:Insert["Pillar 2 Claw 10"];echo ISXRI: Pillar 2 Claw 10
					
				;Pillar 1 Claw 8 
				if ${Actor[Query, Name="Claw Socket" && X=-148.644196 && Y=102.290199 && Z=-8.376815].CheckCollision[-148.193466,105.331329,-8.590580]} || ${EQ2.CheckCollision[]}
					_Claws:Insert["Pillar 2 Claw 9"];echo ISXRI: Pillar 2 Claw 9
					
				;Pillar 1 Claw 9 
				if ${Actor[Query, Name="Claw Socket" && X=-148.641006 && Y=102.290199 && Z=-18.598370].CheckCollision[-149.564621,104.165581,-18.901840]} || ${EQ2.CheckCollision[]}
					_Claws:Insert["Pillar 2 Claw 8"];echo ISXRI: Pillar 2 Claw 8
					
				;Pillar 1 Claw 10 
				if ${Actor[Query, Name="Claw Socket" && X=-142.606293 && Y=102.290199 && Z=-26.952299].CheckCollision[-142.731247,104.853073,-27.068985]} || ${EQ2.CheckCollision[]}
					_Claws:Insert["Pillar 2 Claw 7"];echo ISXRI: Pillar 2 Claw 7
					
				;Pillar 2 Claw 1 
				if ${Actor[Query, Name="Claw Socket" && X=-132.794495 && Y=102.290199 && Z=-133.908203].CheckCollision[-132.830460,104.594795,-133.452286]} || ${EQ2.CheckCollision[]}
					_Claws:Insert["Pillar 1 Claw 6"];echo ISXRI: Pillar 1 Claw 6
					
				;*Pillar 2 Claw 2 
				if !${Actor[Query, Name="Claw Socket" && X=-121.135902 && Y=102.290199 && Z=-134.425598].CheckCollision[-119.885948,108.290123,-132.507950]} && ${Actor[Query, Name="Claw Socket" && X=-121.135902 && Y=102.290199 && Z=-134.425598](exists)}
					_Claws:Insert["Pillar 1 Claw 5"];echo ISXRI: Pillar 1 Claw 5
					
				;Pillar 2 Claw 3 
				if ${Actor[Query, Name="Claw Socket" && X=-116.966499 && Y=102.290199 && Z=-145.437393].CheckCollision[-116.897285,104.805008,-145.289871]} || ${EQ2.CheckCollision[]}
					_Claws:Insert["Pillar 1 Claw 4"];echo ISXRI: Pillar 1 Claw 4
					
				;Pillar 2 Claw 4 
				if ${Actor[Query, Name="Claw Socket" && X=-116.988701 && Y=102.290199 && Z=-155.674500].CheckCollision[-116.703773,104.723480,-155.781784]} || ${EQ2.CheckCollision[]}
					_Claws:Insert["Pillar 1 Claw 3"];echo ISXRI: Pillar 1 Claw 3
					
				;Pillar 2 Claw 5 
				if ${Actor[Query, Name="Claw Socket" && X=-123.070900 && Y=102.290199 && Z=-163.989899].CheckCollision[-123.116676,105.095894,-163.806793]} || ${EQ2.CheckCollision[]}
					_Claws:Insert["Pillar 1 Claw 2"];echo ISXRI: Pillar 1 Claw 2
					
				;Pillar 2 Claw 6 
				if ${Actor[Query, Name="Claw Socket" && X=-132.808502 && Y=102.289902 && Z=-167.135406].CheckCollision[-132.741974,104.808174,-167.320221]} || ${EQ2.CheckCollision[]}
					_Claws:Insert["Pillar 1 Claw 1"];echo ISXRI: Pillar 1 Claw 1
					
				;Pillar 2 Claw 7
				if ${Actor[Query, Name="Claw Socket" && X=-142.604904 && Y=102.290199 && Z=-163.948700].CheckCollision[-141.952988,105.716217,-163.201263]} || ${EQ2.CheckCollision[]}
					_Claws:Insert["Pillar 1 Claw 10"];echo ISXRI: Pillar 1 Claw 10
					
				;Pillar 2 Claw 8 
				if ${Actor[Query, Name="Claw Socket" && X=-148.639603 && Y=102.290199 && Z=-155.594696].CheckCollision[-149.126892,104.558823,-155.486404]} || ${EQ2.CheckCollision[]}
					_Claws:Insert["Pillar 1 Claw 9"];echo ISXRI: Pillar 1 Claw 9
					
				;Pillar 2 Claw 9 
				if ${Actor[Query, Name="Claw Socket" && X=-148.642807 && Y=102.290199 && Z=-145.373199].CheckCollision[-149.332596,104.337715,-145.057266]} || ${EQ2.CheckCollision[]}
					_Claws:Insert["Pillar 1 Claw 8"];echo ISXRI: Pillar 1 Claw 8
					
				;Pillar 2 Claw 10 
				if ${Actor[Query, Name="Claw Socket" && X=-142.550400 && Y=102.290199 && Z=-137.044907].CheckCollision[-142.454697,105.069016,-137.221100]} || ${EQ2.CheckCollision[]}
					_Claws:Insert["Pillar 1 Claw 7"];echo ISXRI: Pillar 1 Claw 7
			}
			;for loop
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Cast[ALL,Cloak of Divinity,1]
			TimedCommand 10 relay ${RI_Var_String_RelayGroup} RIMUIObj:Cast[ALL,Cloak of Divinity,1]
			for(_cnt:Set[1];${_cnt}<=${_Claws.Used};_cnt:Inc)
			{
				echo ISXRI: Moving to and Clicking: ${_Claws.Get[${_cnt}]}
				if ${_Claws.Get[${_cnt}].Find[Pillar 2 Claw](exists)} && !${_Claws.Get[${_cnt}].Find[Pillar 2 Claw 5](exists)}
				{
					call LockAndWait -Loc -150.666718,102.290024,-127.147987 -RelayToGroup
					echo ISXRI: Moving To ${Actor[Query, Name=="${_Claws.Get[${_cnt}]}"].Loc}
					call LockAndWait -Loc ${Actor[Query, Name=="${_Claws.Get[${_cnt}]}"].Loc} -Precision 3
					while !${Trigger}
					{
						Actor[Query, Name=="${_Claws.Get[${_cnt}]}"]:DoubleClick
					}
					Trigger:Set[0]
					call LockAndWait -Loc -150.666718,102.290024,-127.147987 -RelayToGroup
				}
				elseif ${_Claws.Get[${_cnt}].Find[Pillar 2 Claw](exists)} && ${_Claws.Get[${_cnt}].Find[Pillar 2 Claw 5](exists)}
				{
					call LockAndWait -Loc -160.235199,102.289948,-146.112701 -RelayToGroup
					echo ISXRI: Moving to ${Actor[Query, Name=="${_Claws.Get[${_cnt}]}"].Loc}
					call LockAndWait -Loc ${Actor[Query, Name=="${_Claws.Get[${_cnt}]}"].Loc} -Precision 3
					while !${Trigger}
					{
						Actor[Query, Name=="${_Claws.Get[${_cnt}]}"]:DoubleClick
					}
					Trigger:Set[0]
					call LockAndWait -Loc -160.235199,102.289948,-146.112701 -RelayToGroup
					;call LockAndWait -Loc -150.666718,102.290024,-127.147987 -RelayToGroup
				}
				elseif ${_Claws.Get[${_cnt}].Find[Pillar 1 Claw](exists)} && !${_Claws.Get[${_cnt}].Find[Pillar 1 Claw 5](exists)}
				{
					call LockAndWait -Loc -150.365585,102.290047,-37.839512 -RelayToGroup
					echo ISXRI: Moving to ${Actor[Query, Name=="${_Claws.Get[${_cnt}]}"].Loc}
					call LockAndWait -Loc ${Actor[Query, Name=="${_Claws.Get[${_cnt}]}"].Loc} -Precision 3
					while !${Trigger}
					{
						Actor[Query, Name=="${_Claws.Get[${_cnt}]}"]:DoubleClick
					}
					Trigger:Set[0]
					call LockAndWait -Loc -150.365585,102.290047,-37.839512 -RelayToGroup
				}
				elseif ${_Claws.Get[${_cnt}].Find[Pillar 1 Claw](exists)} && ${_Claws.Get[${_cnt}].Find[Pillar 1 Claw 5](exists)}
				{
					call LockAndWait -Loc -161.633987,102.289909,-16.908567 -RelayToGroup
					echo ISXRI: Moving to ${Actor[Query, Name=="${_Claws.Get[${_cnt}]}"].Loc}
					call LockAndWait -Loc ${Actor[Query, Name=="${_Claws.Get[${_cnt}]}"].Loc} -Precision 3
					while !${Trigger}
					{
						Actor[Query, Name=="${_Claws.Get[${_cnt}]}"]:DoubleClick
					}
					Trigger:Set[0]
					call LockAndWait -Loc -161.633987,102.289909,-16.908567 -RelayToGroup
					;call LockAndWait -Loc -150.365585,102.290047,-37.839512 -RelayToGroup
				}
				wait 5
			}
			;;;;;;;;;;;;;;;
			call PreHeal
			call LockAndWait -Loc -169.114044,102.289429,-82.089691 -RelayToGroup
		}
		wait 1
	}
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	echo ISXRI: Ending So'Valiz 
	RI_CMD_AbilityEnableDisable "Cloak of Divinity" 1
}
function Xuzl()
{	
	;need to check where we are when done up top because sometimes we are at the lockspot so it stays there, need to change in that case
	echo ISXRI: Starting Xuzl 
	variable int _XuzlID=${Actor[Query, Name=-"Xuzl" && IsDead=FALSE].ID}
	variable int _fissureID
	variable int _SwordID
	variable bool _ShardDone=0
	RIMUIObj:SetRIFollow[OFF]
	IncomingText:Clear
	IncomingText:Insert[Do you smell sulfur]
		
	if !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, ID=${_XuzlID} && IsDead=FALSE]:DoTarget
		call LockAndWait -Loc -3.638152,102.912415,-80.025955 -RelayToGroup
	}
		
	while ${Actor[Query, ID=${_XuzlID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=-"a sulfur mephit" && IsDead=FALSE && Distance<15](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"a sulfur mephit" && IsDead=FALSE].ID}
					Actor[Query, Name=-"a sulfur mephit" && IsDead=FALSE]:DoTarget
			}
			elseif ${Actor[Query, ID=${_XuzlID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_XuzlID}
					Actor[Query, ID=${_XuzlID} && IsDead=FALSE]:DoTarget
			}
		}
		if ${Trigger}
		{
			wait 5
			while ( ${Me.Y}<130 || ${Actor[Shard of Obsidian](exists)} ) && !${_ShardDone}
			{
				if ${Me.Y}>130 && !${Actor[Shard of Obsidian](exists)}
					_ShardDone:Set[1]
				if ${Actor[Query, Name=-"a fissure vent" && X=-8.260000 && Y=102.930000 && Z=-71.779999](exists)}
					_fissureID:Set[${Actor[Query, Name=-"a fissure vent" && X=-8.260000 && Y=102.930000 && Z=-71.779999].ID}]
				elseif ${Actor[Query, Name=-"a fissure vent" && X=0.030000 && Y=102.930000 && Z=-71.800003](exists)}
					_fissureID:Set[${Actor[Query, Name=-"a fissure vent" && X=0.030000 && Y=102.930000 && Z=-71.800003].ID}]
				elseif ${Actor[Query, Name=-"a fissure vent" && X=-8.270000 && Y=102.930000 && Z=-80.110001](exists)}
					_fissureID:Set[${Actor[Query, Name=-"a fissure vent" && X=-8.270000 && Y=102.930000 && Z=-80.110001].ID}]
				elseif ${Actor[Query, Name=-"a fissure vent" && X=8.330000 && Y=102.930000 && Z=-71.800003](exists)}
					_fissureID:Set[${Actor[Query, Name=-"a fissure vent" && X=8.330000 && Y=102.930000 && Z=-71.800003].ID}]
				elseif ${Actor[Query, Name=-"a fissure vent" && X=8.340000 && Y=102.930000 && Z=-80.120003](exists)}
					_fissureID:Set[${Actor[Query, Name=-"a fissure vent" && X=8.340000 && Y=102.930000 && Z=-80.120003].ID}]
				else
					_fissureID:Set[0]
				
				if ${_fissureID}>0 
				;&& !${Actor[Query, ID=${_XuzlID} && IsDead=FALSE].IsMoving}
				{
					;echo before lockandwait
					call LockAndWait -Loc ${Actor[Query, ID=${_fissureID} && IsDead=FALSE].Loc}
					;echo after lockandwait
					RIMUIObj:SetLockSpot[OFF]
					;echo before wait y
					while ${Me.Y}<130 && ${Actor[Query, ID=${_XuzlID} && IsDead=FALSE](exists)} && ${Actor[Query, ID=${_fissureID} && IsDead=FALSE](exists)}
						RIMUIObj:SetLockSpot[OFF];wait 1
					;echo after wait y
					wait 20
					while ${Me.Y}>130 && ${Actor[Query, ID=${_XuzlID} && IsDead=FALSE](exists)} && ${Actor[Shard of Obsidian](exists)}
					{
						RIMUIObj:SetLockSpot[OFF]
						;echo in while
						if ${Actor[Query, Name=-"a sulfur mephit" && IsDead=FALSE && Distance<15](exists)} && !${RI_Var_Bool_GlobalOthers}
						{
							if ${Target.ID}!=${Actor[Query, Name=-"a sulfur mephit" && IsDead=FALSE].ID}
								Actor[Query, Name=-"a sulfur mephit" && IsDead=FALSE]:DoTarget
						}
						elseif ${Actor[Query, Name=-"Shard of Obsidian" && IsDead=FALSE](exists)} && !${RI_Var_Bool_GlobalOthers}
						{
							if ${Target.ID}!=${Actor[Query, Name=-"Shard of Obsidian" && IsDead=FALSE].ID}
								Actor[Query, Name=-"Shard of Obsidian" && IsDead=FALSE]:DoTarget
						}
						wait 1
						if ${Me.Y}>130 && !${Actor[Shard of Obsidian](exists)}
							_ShardDone:Set[1]
					}
					if ${Me.Y}>130 && !${Actor[Shard of Obsidian](exists)}
						_ShardDone:Set[1]
					;echo after while
				}
				elseif !${RI_Var_Bool_GlobalOthers}
				{
					if ${Actor[Query, Name=-"a sulfur mephit" && IsDead=FALSE](exists)}
					{
						if ${Target.ID}!=${Actor[Query, Name=-"a sulfur mephit" && IsDead=FALSE].ID}
							Actor[Query, Name=-"a sulfur mephit" && IsDead=FALSE]:DoTarget
					}
					else
					{
						Me:DoTarget
					}
				}
				wait 1
			}
			call LockAndWait -Loc -3.638152,102.912415,-80.025955 -RelayToGroup
		}
		if ${Actor[Query, Name=-"Flame Sword" && Interactable=TRUE](exists)}
		{
			_SwordID:Set[${Actor[Query, Name=-"Flame Sword" && Interactable=TRUE].ID}]
			call LockAndWait -Loc ${Actor[Query, ID=${_SwordID} && Interactable=TRUE].Loc} -RelayToGroup
			while ${Actor[Query, ID=${_SwordID} && Interactable=TRUE](exists)}
			{
				Actor[Query, ID=${_SwordID} && Interactable=TRUE]:DoubleClick
				wait 1
			}
			call LockAndWait -Loc -3.638152,102.912415,-80.025955 -RelayToGroup
		}
		wait 1
	}
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	echo ISXRI: Ending Xuzl
}
function Solusek()
{
	call WaitForLastNamedChest START
	IncomingText:Clear
	IncomingText:Insert[turns and readies a terrible frontal blast]
	IncomingText:Insert[flesh will be nothing but ash and cinder]
	echo ISXRI: Starting Solusek 
	variable int _FaceTime
	RI_Var_Int_MoveDistanceMod:Set[6]
	while ${Me.Distance[-0.520629,238.989075,-78.876534]}>30
	{
		if ${Me.Distance[-0.520629,238.989075,-78.876534]}>30 && ${Me.Distance[29.944599,238.598541,-79.815689]}<15
		{
			call LockAndWait -Loc 41.431,239.189075,-79.51 -RelayToGroup
			RI_Var_Bool_Follow:Set[0]
			RIMUIObj:SetLockSpot[OFF]
			RIMUIObj:SetRIFollow[OFF]
			variable bool _Jump1=0
			variable bool _Jump2=0
			face 90
			_FaceTime:Set[${Math.Calc[${Script.RunningTime}+250]}]
			while ${Math.Distance[${Me.Loc},0.1,238.989075,-80]}>15 && !${Me.IsDead}
			{
				RIMUIObj:SetLockSpot[OFF]
				RIMUIObj:SetRIFollow[OFF]
				if ${Script.RunningTime}>${_FaceTime}	
					face 90
				if ${Math.Distance[${Me.Loc},32.358055,239.185242,-80.135078]}<2 && !${_Jump1}
				{
					press ${RI_Var_String_JumpKey}
					_Jump1:Set[1]
				}
				if ${Math.Distance[${Me.Loc},21.551052,239.187241,-79.866791]}<2
				;&& !${_Jump2}
				;{
					press ${RI_Var_String_JumpKey}
				;	_Jump2:Set[1]
				;}
				press -hold ${RI_Var_String_ForwardKey}
				waitframe
			}
			call LockAndWait -Loc 0.1,238.989075,-80 -RelayToGroup
		}
		elseif ${Me.Distance[-0.520629,238.989075,-78.876534]}>30 && ${Me.Distance[29.944599,238.598541,-79.815689]}>15
		{
			eq2ex way 29.944599 238.598541 -79.815689
			if !${RI_Var_Bool_GlobalOthers}
				call MessageBox "Either move to middle platform or to waypoint and resume"
		}
		wait 1
	}
	if !${RI_Var_Bool_GlobalOthers}
	{
		call LockAndWait -Loc 0.1,238.989075,-80 -RelayToGroup
		wait 600 ${RIMObj.AllGroupWithinRange[5]}
		RI_Var_Bool_Follow:Set[1]
	}
	wait 300 ${Actor[Query, ID=${_SolusekID} && IsDead=FALSE].Distance2D[0.1,-80]}<7
	if ${QuestJournalWindow.ActiveQuest[Legacy of Power: Drawn to the Fire](exists)}
	{
		RI_CMD_Assist 0
		Actor[Query, Name=-"Solusek Ro"]:DoTarget
		wait 2
		eq2ex hail
		wait 2
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 2
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 2
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 2
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 2
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 2
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 2
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 2
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 2
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 2
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 5
		wait 50
		Actor[Query, Name=-"Solusek Ro"]:DoTarget
		wait 2
		;eq2ex hail
		wait 2
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 2
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 2
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 2
		EQ2UIPage[ProxyActor,Conversation].Child[composite,replies].Child[1]:LeftClick
		wait 5
		RI_CMD_Assist 1
	}
	elseif !${RI_Var_Bool_GlobalOthers}
	{
		Actor[Query, Name=-"Solusek Ro"]:DoTarget
		wait 2
		eq2ex hail
		wait 5
	}
	variable bool _SetMoveBehindS=FALSE
	variable bool _SetMoveBehindA=FALSE
	wait 600 ${Actor[Query, Name=-"Solusek Ro"].IsAggro} || !${Actor[Query, Name=-"Solusek Ro" && IsDead=FALSE](exists)}
	variable int _SolusekID=${Actor[Query, Name=-"Solusek Ro" && IsDead=FALSE].ID}
	Actor[Query, ID=${_SolusekID} && IsDead=FALSE]:DoTarget
	wait 5
	variable string _LockSpot
	_LockSpot:Set["${Actor[Query, ID=${_SolusekID} && IsDead=FALSE].Loc}"]
	;echo setting lockspot to sol: ${_LockSpot}
	RIMUIObj:SetLockSpot[ALL,${_LockSpot},5,500]
	wait 50
	
	_LockSpot:Set["${Me.Loc}"]
	;echo setting lockspot to ${_LockSpot}
	RIMUIObj:SetLockSpot[ALL,${_LockSpot},1,500]
	
	while ${Actor[Query, ID=${_SolusekID} && IsDead=FALSE](exists)} || ${Actor[Query, Name=-"Avatar" && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, Name=-"Star of Ro" && IsDead=FALSE && Distance<=30](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"Star of Ro" && IsDead=FALSE && Distance<=30].ID}
					Actor[Query, Name=-"Star of Ro" && IsDead=FALSE && Distance<=30]:DoTarget
			}
			elseif ${Actor[Query, Name=-"Avatar" && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${Actor[Query, Name=-"Avatar" && IsDead=FALSE].ID}
					Actor[Query, Name=-"Avatar" && IsDead=FALSE]:DoTarget
				if ${_LockSpot.NotEqual["0.1,238.989075,-80"]}
					_LockSpot:Set["0.1,238.989075,-80"]
			}
			elseif ${Actor[Query, ID=${_SolusekID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_SolusekID}
					Actor[Query, ID=${_SolusekID} && IsDead=FALSE]:DoTarget
			}
			if ${Trigger}
			{
				if ( ${TriggerMessage.Find[flesh will be nothing but ash and cinder]} && ${Actor[Query, ID=${_SolusekID} && IsDead=FALSE].Distance2D[0.1,-80]}<7 ) || ${TriggerMessage.Find[turns and readies a terrible frontal blast]}
				{
					;echo NOVA
					wait 5
					RIMUIObj:SetLockSpot[OFF]
					RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[1]
					call MoveInFront 0
					if ${TriggerMessage.Find[flesh will be nothing but ash and cinder]}
					{
						RI_Var_Int_MoveDistanceMod:Set[8]
						call MoveBehind ${Actor[Query, ID=${_SolusekID} && IsDead=FALSE].ID}
					}
					else
					{
						RI_Var_Int_MoveDistanceMod:Set[6]
						call MoveBehind ${Actor[Query, Name=-"Avatar" && IsDead=FALSE].ID}
					}
					RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[1]
					wait 60
					if !${RI_Var_Bool_GlobalOthers}
					{
						RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
						call MoveBehind 0
						RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
						;RIMUIObj:SetLockSpot[ALL,0.1,238.989075,-80]
						RIMUIObj:SetLockSpot[ALL,${_LockSpot}]
					}
					Trigger:Set[FALSE]
				}
			}
		}
		if ${RI_Var_Bool_GlobalOthers} && !${_SetMoveBehindS} && ${Actor[Query, ID=${_SolusekID} && IsDead=FALSE].Distance2D[0.1,-80]}<7
		{
			RI_Var_Int_MoveDistanceMod:Set[8]
			RIMUIObj:SetLockSpot[OFF]
			_SetMoveBehindS:Set[1]
			call MoveBehind ${Actor[Query, ID=${_SolusekID} && IsDead=FALSE].ID} 30 100
		}
		if ${RI_Var_Bool_GlobalOthers} && !${_SetMoveBehindA} && ${Actor[Query, Name=-"Avatar" && IsDead=FALSE].IsAggro}
		{
			RI_Var_Int_MoveDistanceMod:Set[6]
			RIMUIObj:SetLockSpot[OFF]
			_SetMoveBehindA:Set[1]
			call MoveBehind ${Actor[Query, Name=-"Avatar" && IsDead=FALSE].ID}
		}
		wait 1
	}
	
	RI_Var_Int_MoveDistanceMod:Set[1]
	echo ISXRI: Ending Solusek
	call WaitForLastNamedChest
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
}
function Solromonolitheast()
{
	call SolRoMonolithEast
}
function SolRoMonolithEast()
{
	;echo SolRoMonolithEast
	if !${RI_Var_Bool_GlobalOthers}
	{
		relay "other ${RI_Var_String_RelayGroup}" Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call SolRoMonolithEast"]
	}
	if ${Zone.Name.Find[Solo]}
		return
	else
	{
		if ${Script[Buffer:CoT]}
			endscript Buffer:CoT
		wait 20
		declare _1Done bool global FALSE
		declare _2Done bool global FALSE
		declare _3Done bool global FALSE
		;IncomingText:Insert[Do you smell sulfur]
		variable int _MyNum
		variable index:string _group
		variable int _count=0
		for(_count:Set[1];${_count}<=${Me.Group};_count:Inc)
				_group:Insert[${Me.Group[${Math.Calc[${_count}-1]}]}]
		variable int _count2=0
		declare temp string
		for(_count:Set[1];${_count}<=${_group.Used};_count:Inc)
		{
			for(_count2:Set[1];${_count2}<=${_group.Used};_count2:Inc)
			{
				if ${_group.Get[${_count2}].Compare[${_group.Get[${_count}]}]}>0
				{
					temp:Set[${_group.Get[${_count}]}]
					_group.Get[${_count}]:Set[${_group.Get[${_count2}]}]
					_group.Get[${_count2}]:Set[${temp}]
				}
			}
		}
		for(_count:Set[1];${_count}<=${_group.Used};_count:Inc)
		{
			;echo ${_count}: ${_group.Get[${_count}]}
			if ${Me.Name.Equal[${_group.Get[${_count}]}]}
				_MyNum:Set[${_count}]
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetRIFollow[OFF]
		wait 5
	;	echo ${_MyNum}

		if ${_MyNum}==1
		{
			call LockAndWait -Loc -138.842285,-5.009025,-136.650146
			call LockAndWait -Loc -138.452164,-4.053009,-211.623901
			wait 10
			relay ${RI_Var_String_RelayGroup} _1Done:Set[1]
			wait 300 ${_1Done} && ${_2Done} && ${_3Done}
			call LockAndWait -Loc -138.842285,-5.009025,-136.650146
			call LockAndWait -Loc -141.873352,-7.545671,-101.671265
		}
		elseif ${_MyNum}==2
		{
			call LockAndWait -Loc -176.929581,-5.009024,-101.646515
			call LockAndWait -Loc -250.391449,-4.051274,-101.568497
			wait 10
			relay ${RI_Var_String_RelayGroup} _2Done:Set[1]
			wait 300 ${_1Done} && ${_2Done} && ${_3Done}
			call LockAndWait -Loc -176.929581,-5.009024,-101.646515
			call LockAndWait -Loc -141.873352,-7.545671,-101.671265
		}
		elseif ${_MyNum}==3
		{
			call LockAndWait -Loc -139.046539,-5.007735,-66.573433
			call LockAndWait -Loc -139.260223,-4.050378,8.146012
			wait 10
			relay ${RI_Var_String_RelayGroup} _3Done:Set[1]
			wait 300 ${_1Done} && ${_2Done} && ${_3Done}
			call LockAndWait -Loc -139.046539,-5.007735,-66.573433
			call LockAndWait -Loc -141.873352,-7.545671,-101.671265
		}
		else
			wait 300 ${_1Done} && ${_2Done} && ${_3Done}
		wait 600 ${RIMObj.AllGroupWithinRange[5]}
		deletevariable _1Done
		deletevariable _2Done
		deletevariable _3Done
		if !${Script[Buffer:CoT]}
			RI_CoT
	}
}
function Solromonolithwest()
{
	call SolRoMonolithWest
}
function SolRoMonolithWest()
{
	;echo SolRoMonolithWest
	if !${RI_Var_Bool_GlobalOthers}
	{
		relay "other ${RI_Var_String_RelayGroup}" Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call SolRoMonolithWest"]
	}
	if ${Zone.Name.Find[Solo]}
		return
	else
	{
		if ${Script[Buffer:CoT]}
			endscript Buffer:CoT
		wait 20
		declare _1Done bool global FALSE
		declare _2Done bool global FALSE
		declare _3Done bool global FALSE
		;IncomingText:Insert[Do you smell sulfur]
		variable int _MyNum
		variable index:string _group
		variable int _count=0
		for(_count:Set[1];${_count}<=${Me.Group};_count:Inc)
				_group:Insert[${Me.Group[${Math.Calc[${_count}-1]}]}]
		variable int _count2=0
		declare temp string
		for(_count:Set[1];${_count}<=${_group.Used};_count:Inc)
		{
			for(_count2:Set[1];${_count2}<=${_group.Used};_count2:Inc)
			{
				if ${_group.Get[${_count2}].Compare[${_group.Get[${_count}]}]}>0
				{
					temp:Set[${_group.Get[${_count}]}]
					_group.Get[${_count}]:Set[${_group.Get[${_count2}]}]
					_group.Get[${_count2}]:Set[${temp}]
				}
			}
		}
		for(_count:Set[1];${_count}<=${_group.Used};_count:Inc)
		{
			;echo ${_count}: ${_group.Get[${_count}]}
			if ${Me.Name.Equal[${_group.Get[${_count}]}]}
				_MyNum:Set[${_count}]
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetRIFollow[OFF]
		wait 5
	;	echo ${_MyNum}

		if ${_MyNum}==1
		{
			call LockAndWait -Loc 139.068726,-5.007735,-67.074303
			call LockAndWait -Loc 138.474731,-4.050569,8.097176
			wait 10
			relay ${RI_Var_String_RelayGroup} _1Done:Set[1]
			wait 300 ${_1Done} && ${_2Done} && ${_3Done}
			call LockAndWait -Loc 139.068726,-5.007735,-67.074303
			call LockAndWait -Loc 143.933792,-7.519605,-101.236786
		}
		elseif ${_MyNum}==2
		{
			call LockAndWait -Loc 175.306610,-5.009024,-101.776848 
			call LockAndWait -Loc 250.422256,-4.046821,-101.464073 
			wait 10
			relay ${RI_Var_String_RelayGroup} _2Done:Set[1]
			wait 300 ${_1Done} && ${_2Done} && ${_3Done}
			call LockAndWait -Loc 175.306610,-5.009024,-101.776848 
			call LockAndWait -Loc 143.933792,-7.519605,-101.236786
		}
		elseif ${_MyNum}==3
		{
			call LockAndWait -Loc 138.928940,-5.009025,-136.444809
			call LockAndWait -Loc 139.326859,-4.046970,-211.277145 
			wait 10
			relay ${RI_Var_String_RelayGroup} _3Done:Set[1]
			wait 300 ${_1Done} && ${_2Done} && ${_3Done}
			call LockAndWait -Loc 138.928940,-5.009025,-136.444809
			call LockAndWait -Loc 143.933792,-7.519605,-101.236786
		}
		else
			wait 300 ${_1Done} && ${_2Done} && ${_3Done}
		wait 600 ${RIMObj.AllGroupWithinRange[5]}
		deletevariable _1Done
		deletevariable _2Done
		deletevariable _3Done
		if !${Script[Buffer:CoT]}
			RI_CoT
	}
}
;;;;;;;; End Solusek Ro's Tower: The Monolith of Fire
;;;;;;;; Start Plane of Disease: Infested Mesa
function Deathbone()
{
	echo ISXRI: Starting Deathbone

	variable int _DeathboneID=${Actor[Query, Name=-"Deathbone" && IsDead=FALSE].ID}

	call RIObj.LockAndPull ${_DeathboneID} "-183.660217,239.238251,-47.744381" 10 0
	call RIObj.LockAndPull ${_DeathboneID} "-161.148895,239.635071,-54.566441"
	
	while ${Actor[Query, ID=${_DeathboneID} && IsDead=FALSE](exists)}
	{
		call RIObj.Target "a deadly contagion" -Distance 35 ${_DeathboneID}
		wait 2
	}
	
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	else
		call MoveBehind 0
		
	echo ISXRI: Ending Deathbone
}
function Walker()
{
	echo ISXRI: Starting Walker

	variable int _WalkerID=${Actor[Query, Name=-"Carrion Walker" && IsDead=FALSE].ID}

	call RIObj.LockAndPull ${_WalkerID} "-161.485428,239.635056,-43.996758" 10 0
	call RIObj.LockAndPull ${_WalkerID} "-161.148895,239.635071,-54.566441"
	
	while ${Actor[Query, ID=${_WalkerID} && IsDead=FALSE](exists)}
	{
		call RIObj.Target "a deadly contagion" -Distance 35 ${_WalkerID}
		;here we need to handle our organs
		if ${RIObj.MainIconIDExists[${Me.ID},196]} || ${RIObj.MainIconIDExists[${Me.ID},496]} || ${RIObj.MainIconIDExists[${Me.ID},262]}
		{
			while ${Actor[Brain](exists)}
			{
				Me.Effect[detrimental,${RIObj.MainIconIDExists[${Me.ID},262]}]:Cancel
				wait 1
			}
			while ${Actor[Stomach](exists)}
			{
				Me.Effect[detrimental,${RIObj.MainIconIDExists[${Me.ID},196]}]:Cancel
				wait 1
			}
			while ${Actor[Heart](exists)}
			{
				Me.Effect[detrimental,${RIObj.MainIconIDExists[${Me.ID},496]}]:Cancel
				wait 1
			}
		}
		wait 2
	}
	
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	else
		call MoveBehind 0
		
	if !${RI_Var_Bool_SkipLoot}
		call RIMObj.LootChest
		
	echo ISXRI: Ending Walker
}
function Grimror()
{
	echo ISXRI: Starting Grimror
	
	IncomingText:Insert["flesh turns"]
	IncomingText:Insert["successfully stripped Grimror"]
	
	variable int _GrimrorID=${Actor[Query, Name=-"Grimror" && IsDead=FALSE && Type=="NamedNPC"].ID}

	call RIObj.LockAndPull ${_GrimrorID} "-161.148895,239.635071,-54.566441"
	
	while ${Actor[Query, ID=${_GrimrorID} && IsDead=FALSE](exists)}
	{
		call RIObj.Target "revenant" -Distance 50 "a deadly contagion" -Distance 35 ${_GrimrorID}
		
		if ${Trigger}
		{
			
			if ${TriggerMessage.Find[generian](exists)} && ${Me.Effect[detrimental,Generian Host](exists)}
			{
				;turn off assisting
				RI_CMD_Assisting 0
				press f1
				call MoveBehind 0
				RIMUIObj:SetLockSpot[OFF]
				RIMUIObj:SetRIFollow[ALL,OFF]
				call RIMObj.Move ${String["${Actor[Generian Larvae].Loc}"].Replace[","," "]} 7 0 0 0 1 0 1 1
				while !${TriggerMessage.Find["successfully stripped Grimror"](exists)}
				{
					press f1
					;echo ${Trigger} ${TriggerMessage}
					Actor[Generian Larvae]:DoubleClick
					wait 20 ${TriggerMessage.Find["successfully stripped Grimror"](exists)}
				}
				Trigger:Set[FALSE]
				TriggerMessage:Set[""]
				;turn on assisting
				RI_CMD_Assisting 1
				if !${RI_Var_Bool_GlobalOthers}
					RIMUIObj:SetLockSpot[${Me.Name},-161.148895,239.635071,-54.566441,1,200]
				else
				{
					call RIMObj.Move ${String["${Actor[id,${_GrimrorID}].Loc}"].Replace[","," "]} 7 0 0 0 1 0 1 1
					call MoveBehind 1
				}
			}
			if ${TriggerMessage.Find[scaevian](exists)} && ${Me.Effect[detrimental,Scaevian Host](exists)}
			{
				;turn off assisting
				RI_CMD_Assisting 0
				press f1
				call MoveBehind 0
				RIMUIObj:SetLockSpot[OFF]
				RIMUIObj:SetRIFollow[ALL,OFF]
				call RIMObj.Move ${String["${Actor[Scaevian Larvae].Loc}"].Replace[","," "]} 7 0 0 0 1 0 1 1
				while !${TriggerMessage.Find["successfully stripped Grimror"](exists)}
				{
					press f1
					;echo ${Trigger} ${TriggerMessage}
					Actor[Scaevian Larvae]:DoubleClick
					wait 20 ${TriggerMessage.Find["successfully stripped Grimror"](exists)}
				}
				Trigger:Set[FALSE]
				TriggerMessage:Set[""]
				;turn on assisting
				RI_CMD_Assisting 1
				if !${RI_Var_Bool_GlobalOthers}
					RIMUIObj:SetLockSpot[${Me.Name},-161.148895,239.635071,-54.566441,1,200]
				else
				{
					call RIMObj.Move ${String["${Actor[id,${_GrimrorID}].Loc}"].Replace[","," "]} 7 0 0 0 1 0 1 1
					call MoveBehind 1
				}
			}
			if ${TriggerMessage.Find[harrion](exists)} && ${Me.Effect[detrimental,Harrion Host](exists)}
			{
				;turn off assisting
				RI_CMD_Assisting 0
				press f1
				call MoveBehind 0
				RIMUIObj:SetLockSpot[OFF]
				RIMUIObj:SetRIFollow[ALL,OFF]
				call RIMObj.Move ${String["${Actor[Harrion Larvae].Loc}"].Replace[","," "]} 7 0 0 0 1 0 1 1
				while !${TriggerMessage.Find["successfully stripped Grimror"](exists)}
				{
					press f1
					;echo ${Trigger} ${TriggerMessage}
					Actor[Harrion Larvae]:DoubleClick
					wait 20 ${TriggerMessage.Find["successfully stripped Grimror"](exists)}
				}
				Trigger:Set[FALSE]
				TriggerMessage:Set[""]
				;turn on assisting
				RI_CMD_Assisting 1
				if !${RI_Var_Bool_GlobalOthers}
					RIMUIObj:SetLockSpot[${Me.Name},-161.148895,239.635071,-54.566441,1,200]
				else
				{
					call RIMObj.Move ${String["${Actor[id,${_GrimrorID}].Loc}"].Replace[","," "]} 7 0 0 0 1 0 1 1
					call MoveBehind 1
				}
			}
			if ${TriggerMessage.Find[sengian](exists)} && ${Me.Effect[detrimental,Sengian Host](exists)}
			{
				;turn off assisting
				RI_CMD_Assisting 0
				press f1
				call MoveBehind 0
				RIMUIObj:SetLockSpot[OFF]
				RIMUIObj:SetRIFollow[ALL,OFF]
				echo ${String["${Actor[Sengian Larvae].Loc}"].Replace[","," "]}
				call RIMObj.Move ${String["${Actor[Sengian Larvae].Loc}"].Replace[","," "]} 7 0 0 0 1 0 1 1
				while !${TriggerMessage.Find["successfully stripped Grimror"](exists)}
				{
					press f1
					;echo ${Trigger} ${TriggerMessage}
					Actor[Sengian Larvae]:DoubleClick
					wait 20 ${TriggerMessage.Find["successfully stripped Grimror"](exists)}
				}
				Trigger:Set[FALSE]
				TriggerMessage:Set[""]
				;turn on assisting
				RI_CMD_Assisting 1
				if !${RI_Var_Bool_GlobalOthers}
					RIMUIObj:SetLockSpot[${Me.Name},-161.148895,239.635071,-54.566441,1,200]
				else
				{
					call RIMObj.Move ${String["${Actor[id,${_GrimrorID}].Loc}"].Replace[","," "]} 7 0 0 0 1 0 1 1
					call MoveBehind 1
				}
			}
			wait 5
		}
		
		wait 2
	}
	
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	else
		call MoveBehind 0
		
	echo ISXRI: Ending Grimror
}
;;;;;;;; End Plane of Disease: Infested Mesa
;;;;;;;; Start Plane of Innovation: Parts Not Included
function Poipniring()
{
	echo ISXRI: Starting Plane of Innovation: Parts Not Included Swarm Ring Event
	Actor[Factory East Side Door 03]:DoubleClick
	wait 1
	Actor[Factory East Side Door 03]:DoubleClick
	wait 1
	Actor[Factory East Side Door 03]:DoubleClick
	while ${Actor[Factory East Side Door 03].Interactable}
		wait 1
	echo ISXRI: Ending Plane of Innovation: Parts Not Included Swarm Ring Event
}
function Poipniactivate(string _Who)
{
	echo ISXRI: Starting Activate ${_Who}
	while !${Actor[${_Who}].IsAggro}
	{
		if ${Actor[${_Who}].Distance}>3
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[${_Who}].Loc},3,500]
		if !${Me.InCombat} && ${Actor[${_Who}].Overlay.Equal[shut_down_idle]} && ${Actor[${_Who}].Distance}<=4
		{
			relay ${RI_Var_String_RelayGroup} Actor[${_Who}]:DoubleClick
			wait 50
		}
		waitframe
	}
	echo ISXRI: Ending Activate ${_Who}
}

function Microtock()
{
	echo ISXRI: Starting Microtock
	IncomingText:Insert["** GET ** BZZZZZZOINK ** BACK! **"]
	variable int _MicrotockID=${Actor[Query, Name=-"Fixit Microtock" && IsDead=FALSE].ID}

	call RIObj.LockAndPull ${_MicrotockID} "25.475100,7.079736,-343.681152"
	
	while ${Actor[Query, ID=${_MicrotockID} && IsDead=FALSE](exists)}
	{
		call RIObj.MageAbsorbMagic ${_MicrotockID} 509
		call RIObj.Target ${_MicrotockID}
		if ${Actor[Query, ID=${_MicrotockID} && IsDead=FALSE].Distance}>7
			call LockAndWait -Loc "${Actor[Query, ID=${_MicrotockID} && IsDead=FALSE].Loc}" -Precision 5
		if ${Trigger}
		{
			if ${Me.X}>${Actor[Query, ID=${_MicrotockID} && IsDead=FALSE].X}
				call LockAndWait -Loc "${Math.Calc[${Actor[Query, ID=${_MicrotockID} && IsDead=FALSE].X}+20]},${Actor[Query, ID=${_MicrotockID} && IsDead=FALSE].Y},${Actor[Query, ID=${_MicrotockID} && IsDead=FALSE].Z}" -Precision 1
			else
				call LockAndWait -Loc "${Math.Calc[${Actor[Query, ID=${_MicrotockID} && IsDead=FALSE].X}-20]},${Actor[Query, ID=${_MicrotockID} && IsDead=FALSE].Y},${Actor[Query, ID=${_MicrotockID} && IsDead=FALSE].Z}" -Precision 1
			wait 100
			call LockAndWait -Loc "${Actor[Query, ID=${_MicrotockID} && IsDead=FALSE].Loc}" -Precision 5
			Trigger:Set[0]
		}
		if ${RI_Var_Bool_GlobalOthers}
		{
			RIMUIObj:SetLockSpot[ALL,OFF]
			RIMUIObj:SetRIFollow[ALL,OFF]
			call MoveBehind ${_MicrotockID}
		}
		wait 2
	}
	
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	else
		call MoveBehind 0
		
	echo ISXRI: Ending Microtock
}
function Megatock()
{
	echo ISXRI: Starting Megatock
	
	IncomingText:Insert["tracks his next target"]
	
	variable int _MegatockID=${Actor[Query, Name=-"Fixit Megatock" && IsDead=FALSE].ID}

	call RIObj.LockAndPull ${_MegatockID} "-88.440086,-3.231944,-376.388092" 10 0
	
	while ${Actor[Query, ID=${_MegatockID} && IsDead=FALSE](exists)}
	{
		call RIObj.Target ${_MegatockID}
		call RIObj.MageAbsorbMagic ${_MegatockID} 509
		if ${Trigger}
		{
			wait 20
			RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
			RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
			RIMUIObj:SetLockSpot[ALL,-89.016090,3.954799,-351.488678]
			wait 100 ${Me.Distance[-89.016090,3.954799,-351.488678]}<3
			wait 200 ${Actor[Query, ID=${_MegatockID} && IsDead=FALSE].Distance}<10
			RIMUIObj:SetLockSpot[ALL,-88.440086,-3.231944,-376.388092]
			RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
			RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
			Trigger:Set[FALSE]
		}
		wait 2
	}
	
	echo ISXRI: Ending Megatock
}
function Omegatock()
{
	echo ISXRI: Starting Omegatock

	variable int _OmegatockID=${Actor[Query, Name=-"Omegatock" && IsDead=FALSE].ID}

	;call RIObj.LockAndPull ${_OmegatockID} "-118.489128,-3.119570,-491.245422" 10 0
	;call RIObj.LockAndPull ${_OmegatockID} "-106.75,-2.35,-515.72" 10 0
	call RIObj.LockAndPull ${_OmegatockID} "-106.338562,-2.293769,-519.488831" 10 0
	
	
	while ${Actor[Query, ID=${_OmegatockID} && IsDead=FALSE](exists)}
	{
		call RIObj.Target "a scrap mite" -Distance 30 ${_OmegatockID}
		if ${Zone.Name.Find[Duo](exists)}
		{
			if ${RIMUIObj.MainIconIDExists[${_OmegatockID},509]}
				eq2ex apply_verb ${_OmegatockID} "Overload systems"
		}
		else
			call RIObj.MageAbsorbMagic ${_OmegatockID} 509
		wait 2
	}
	
	echo ISXRI: Ending Omegatock
}
;;;;;;;; End Plane of Innovation: Parts Not Included
;;;;;;;; Start Shard of Hate: Utter Contempt
function Bovaug()
{
	call Ulvaug TRUE
}
function Ulvaug(bool Herd=FALSE)
{
	variable string NamedName=""
	variable string Add1Name=""
	variable string Add2Name=""
	if ${Herd}
	{
		NamedName:Set["Bovaug the Bull"]
		Add1Name:Set["Blood of Bovaug"]
		Add2Name:Set["a victim of Bovaug"]
	}
	else
	{
		NamedName:Set["Ulvaug the Bloodfang"]
		Add1Name:Set["Blood of Ulvaug"]
		Add2Name:Set["a victim of Ulvaug"]
	}

	echo ISXRI: Starting ${NamedName}
	
	IncomingText:Clear
	IncomingText:Insert["prepares to spray blood in front of him"]
	if ${Me.Archetype.Equal[priest]}
		RI_CMD_AbilityEnableDisable "Cure Curse" 0
	variable int _UlvaugID
	_UlvaugID:Set[${Actor[Query, Name=-"${NamedName}" && IsDead=FALSE].ID}]

	variable int i
	RIMUIObj:SetLockSpot[ALL,-12.693632,30.575264,-163.617035]
	RI_Obj_CB:CastWhileMoving[1]
	while ${Actor[Query, ID=${_UlvaugID} && IsDead=FALSE](exists)}
	{
		call RIObj.Target "${Add1Name}" "${Add2Name}" ${_UlvaugID}
		
		if ${Me.Archetype.Equal[priest]} && ${Me.Ability[id,969542071].IsReady}
		{
			for(i:Set[0];${i}<${Me.Group};i:Inc)
			{
				;echo Checking ${Me.Group[${i}].Name} : ${Me.Group[${i}].Cursed}>0 && ${Me.Group[${i}].Distance[${Actor[Query, ID=${_UlvaugID} && IsDead=FALSE].Loc}]}<3
				if ${Me.Group[${i}].Cursed}>0 && ${Me.Group[${i}].Distance[${Actor[Query, ID=${_UlvaugID} && IsDead=FALSE].Loc}]}<3
					eq2ex useabilityonplayer ${Me.Group[${i}].Name} 969542071
			}
		}
		
		if ${Trigger}
		{
			;move behind
			RI_Var_Int_MoveDistanceMod:Set[8]
			RIMUIObj:SetLockSpot[OFF]
			RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[1]
			;call MoveInFront 0
			call MoveBehind ${_UlvaugID}
			eq2ex cancel_spellcast
			RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[1]
			eq2ex cancel_spellcast
			i:Set[0]
			while ${i:Inc}<65
			{
				call RIObj.Target "${Add1Name}" "${Add2Name}" ${_UlvaugID}
				wait 1
			}
			RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
			call MoveBehind 0
			RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
			Trigger:Set[0]
			RI_Var_Int_MoveDistanceMod:Set[1]
		}
		if ${Me.Cursed}>0
			RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_UlvaugID} && IsDead=FALSE].Loc},2,500]
		elseif ${Actor[Query, Name=="${Add1Name}" && IsDead=FALSE](exists)} && !${Me.Archetype.Equal[priest]} && !${Me.Archetype.Equal[mage]}
			RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="${Add1Name}" && IsDead=FALSE].Loc},7,500]
		else
			RIMUIObj:SetLockSpot[ALL,-12.693632,30.575264,-163.617035,1,500]
		
		waitframe
	}
	if ${Me.Archetype.Equal[priest]}
		RI_CMD_AbilityEnableDisable "Cure Curse" 1
	RI_Obj_CB:CastWhileMoving[0]
	echo ISXRI: Ending ${NamedName}
}
function Telekinetic()
{
	echo ISXRI: Starting Telekinetic

	variable int _TelekineticID=${Actor[Query, Name=-"Telekinetic" && IsDead=FALSE].ID}

	call RIObj.LockAndPull ${_TelekineticID} "-106.338562,-2.293769,-519.488831" 10 0
	
	
	while ${Actor[Query, ID=${_TelekineticID} && IsDead=FALSE](exists)}
	{
		call RIObj.Target "a scrap mite" ${_TelekineticID}

		;if someone is near one of the statues
		;we need to 1 - if its me, clear lockspot
		;2 - find which statue and the heading
		;3 - goto statue and move to correct heading
		;4 - once correct statue is moved correctly, then click 
		;${Actor[Cleric Statue 1].Loc}
		if ${Me.Distance[${Actor[Cleric Statue 1].Loc}]}<5 || ${Me.Group[1].Distance[${Actor[Cleric Statue 1].Loc}]}<5 || ${Me.Group[2].Distance[${Actor[Cleric Statue 1].Loc}]}<5 || ${Me.Group[3].Distance[${Actor[Cleric Statue 1].Loc}]}<5 || ${Me.Group[4].Distance[${Actor[Cleric Statue 1].Loc}]}<5 || ${Me.Group[5].Distance[${Actor[Cleric Statue 1].Loc}]}<5
		{
			;get all statues directions 90 = W 0,360 = S 180 = N 270 = E

			string Color
			string MatchingStatue
			Color:Set["${Actor[Cleric Statue 1].Overlay}"]
			if ${Actor[Cleric Statue Rotating 1].Overlay.Equals[${Color}]}
				MatchingStatue:Set[1]
			elseif ${Actor[Cleric Statue Rotating 2].Overlay.Equals[${Color}]}
				MatchingStatue:Set[2]
			elseif ${Actor[Cleric Statue Rotating 3].Overlay.Equals[${Color}]}
				MatchingStatue:Set[3]
			if ${Me.Distance[${Actor[Cleric Statue 1].Loc}]}<5 && ${Math.Calc[360-${Actor[Cleric Statue 1].Heading}]}
				RIMUIObj:SetLockSpot[${Me.Name},OFF]
			else
			{
				if ${Bool}
					noop
			}
		}
		
		wait 2
	}
	
	echo ISXRI: Ending Telekinetic
}
function Taurus()
{
	call Bellhop TRUE
}
function Bellhop(bool Herd=FALSE)
{
	variable string NamedName=""
	if ${Herd}
		NamedNamed:Set[Taurus]
	else
		NamedNamed:Set[Bellhop]
		
	echo ISXRI: Starting ${NamedName}
		
	IncomingText:Insert["Time to check out"]
	IncomingText:Insert["Time to check in"]
	
	variable int _BellhopID=${Actor[Query, Name=-"Trapped ${NamedName}" && IsDead=FALSE].ID}

	call RIObj.LockAndPull ${_BellhopID} "-177.588593,15.882900,138.629303" 10 0
	
	while ${Actor[Query, ID=${_BellhopID} && IsDead=FALSE](exists)}
	{
		call RIObj.Target ${_BellhopID}
		if ${Actor[Query, Name=-"discarded" && Distance<30](exists)}
		{
			RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=-"discarded" && Distance<30].Loc},5]
			Actor[Query, Name=-"discarded" && Distance<30]:DoubleClick
		}
		else
			RIMUIObj:SetLockSpot[ALL,-177.588593,15.882900,138.629303]	
			
		if ${Trigger}
		{
			echo Trigger: ${TriggerMessage}
			if ${TriggerMessage.Find["check out"]}
			{
				if ${Me.Distance[-177.588593,15.882900,138.629303]}<5
					RIMUIObj:SetLockSpot[ALL,-168.332428,15.260128,157.352615]
				else
					RIMUIObj:SetLockSpot[ALL,-177.588593,15.882900,138.629303]
			}
			else
				RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_BellhopID} && IsDead=FALSE].Loc},5]
			wait 50
			Trigger:Set[0]
		}
		waitframe
	}
	
	echo ISXRI: Ending ${NamedName}
}
function Hateful()
{
	echo ISXRI: Starting Hateful
	variable string Primary
	variable string Secondary
	
	Primary:Set["${Me.Equipment[1].Name}"]
	Secondary:Set["${Me.Equipment[2].Name}"]
	
	variable int _HatefulID=${Actor[Query, Name=-"Hateful Plate" || Name=-"Hateful Steak" && IsDead=FALSE].ID}

	if ${RI_Var_Bool_GlobalOthers}
		RIMUIObj:SetLockSpot[ALL,188.108963,6.904695,106.782738]
	else
		RIMUIObj:SetLockSpot[ALL,184.568207,6.899016,101.343567]
		
	while ${Actor[Query, ID=${_HatefulID} && IsDead=FALSE](exists)}
	{
		call RIObj.Target "Hateful Breastplate" "Hateful Helmet" "Hateful Gauntlets" "Hateful Pauldrons" "Hateful Greaves" ${_HatefulID}

		if ${RIMUIObj.MainIconIDExists[${Me.ID},844,1]}
		{
			if ${Me.Equipment[1](exists)}
				Me.Equipment[1]:UnEquip
			if ${Me.Equipment[2](exists)}
				Me.Equipment[2]:UnEquip
		}
		else
		{
			if !${Me.Equipment[1](exists)}
				Me.Inventory[Query, Location=="Inventory" && Name=="${Primary}"]:Equip
			if !${Me.Equipment[2](exists)}
				Me.Inventory[Query, Location=="Inventory" && Name=="${Secondary}"]:Equip
		}
		
		waitframe
	}
	
	echo ISXRI: Ending Hateful
}
function Skimp()
{
	echo ISXRI: Starting Skimp

	IncomingText:Insert["before Skimp swaps hate"]
	IncomingText:Insert["can't swap"]
	
	variable int _SkimpID=${Actor[Query, Name=-"Skimp the imp" && IsDead=FALSE].ID}

	call RIObj.LockAndPull ${_SkimpID} "43.657230,0.443123,232.577332"

	while ${Actor[Query, ID=${_SkimpID} && IsDead=FALSE](exists)}
	{
		call RIObj.Target ${_SkimpID}

		if ${Trigger}
		{
			if ${TriggerMessage.Find[before skimp swaps hate](exists)}
			{
				echo ISXRI: Swapping with ${TriggerMessage.Right[-23].Left[-25]}
				wait 10
				RIMUIObj:SetLockSpot[${Me.Name},${Me.Group[${TriggerMessage.Right[-23].Left[-25]}].Loc},1,100]
				Trigger:Set[0]
				wait 150 ${Trigger}
				if !${RI_Var_Bool_GlobalOthers}
					RIMUIObj:SetLockSpot[${Me.Name},43.657230,0.443123,232.577332]
				else
					RIMUIObj:SetLockSpot[OFF]
			}
			Trigger:Set[0]
		}
		waitframe
	}
	
	echo ISXRI: Ending Skimp
}
function Moo()
{
	echo ISXRI: Starting Moo

	IncomingText:Insert["before Skimp swaps hate"]
	IncomingText:Insert["can't swap"]
	
	variable int _MooID=${Actor[Query, Name=-"Moo the Cow" && IsDead=FALSE].ID}

	call RIObj.LockAndPull ${_MooID} "43.657230,0.443123,232.577332"

	while ${Actor[Query, ID=${_MooID} && IsDead=FALSE](exists)}
	{
		call RIObj.Target ${_MooID}

		if ${Trigger}
		{
			if ${TriggerMessage.Find[before skimp swaps hate](exists)}
			{
				echo ISXRI: Swapping with ${TriggerMessage.Right[-23].Left[-25]}
				wait 10
				RIMUIObj:SetLockSpot[${Me.Name},${Me.Group[${TriggerMessage.Right[-23].Left[-25]}].Loc},1,100]
				Trigger:Set[0]
				wait 150 ${Trigger}
				if !${RI_Var_Bool_GlobalOthers}
					RIMUIObj:SetLockSpot[${Me.Name},43.657230,0.443123,232.577332]
				else
					RIMUIObj:SetLockSpot[OFF]
			}
			Trigger:Set[0]
		}
		waitframe
	}
	
	echo ISXRI: Ending Moo
}
function Morg(bool HerdMode=FALSE)
{
	variable string NamedName
	if ${HerdMode}
		NamedName:Set[Topsir]
	else
		NamedName:Set[Morg]
	
	echo ISXRI: Starting ${NamedName}
	wait 100 ${Actor[Query, Name=-"${NamedName}"].IsAggro}
	variable int _MorgID
	_MorgID:Set[${Actor[Query, Name=-"${NamedName}" && IsDead=FALSE].ID}]

	variable index:actor Actors
	variable bool Goto2ndSpot=FALSE
	variable bool Moved=FALSE
	variable string LockSpot="214.310562,33.231136,-89.789421"
	call RIObj.LockAndPull ${_MorgID} "${LockSpot}"
	if ${RI_Var_Bool_GlobalOthers}
	{
		RI_Var_Int_MoveDistanceMod:Set[8]
		call MoveBehind ${Actor[Query, ID=${_MorgID} && IsDead=FALSE].ID}
	}
	while ${Actor[Query, ID=${_MorgID} && IsDead=FALSE](exists)}
	{
		Actors:Clear
		EQ2:QueryActors[Actors, Name=="rotting meat"]
		
		if ${Actors.Used}>=15 && !${Moved} && ${Actor[Query, ID=${_MorgID} && IsDead=FALSE].Health}>20
			Goto2ndSpot:Set[TRUE]
		
		if ${Goto2ndSpot}
		{
			LockSpot:Set["215.605545,33.231136,-48.262566"]
			Goto2ndSpot:Set[FALSE]
			Moved:Set[TRUE]
		}
		
		call RIObj.Target ${_MorgID}
		
		if ${Actor[Query, ID=${_MorgID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_MorgID},790]}].CurrentIncrements}>0
			call RIObj.MageAbsorbMagic ${_MorgID} -1
		
		while ${Me.Cursed}==-1
		{
			if ${Actor[rotting meat].Distance}>5
				RIMUIObj:SetLockSpot[${Me.Name},${Actor[rotting meat].Loc},5,500]
			Actor[rotting meat]:DoubleClick
		}
		if ${RI_Var_Bool_GlobalOthers}
			RIMUIObj:SetLockSpot[OFF]
		else
			RIMUIObj:SetLockSpot[${Me.Name},${LockSpot},1,500]
		wait 2
	}
	
	echo ISXRI: Ending ${NamedName}
}
function Topsir()
{
	call Morg TRUE
}
function Horb(HerdMode=FALSE)
{
	variable string NamedName

	if ${HerdMode}
		NamedName:Set[Loin]
	else
		NamedName:Set[Horb]
		
	echo ISXRI: Starting ${NamedName}
		
	if !${Actor[Query, Name=-"${NamedName}"](exists)}
		return

	while !${Actor[Query, Name=-"${NamedName}"].IsAggro}
	{
		if ${Actor[Query, Name=-"${NamedName}"].Distance}<7
			Actor[Query, Name=-"${NamedName}"]:DoubleClick
		waitframe
	}
	
	wait 5

	wait 100 ${Actor[Query, Name=-"${NamedName}"].IsAggro}
	variable int _HorbID
	_HorbID:Set[${Actor[Query, Name=-"${NamedName}" && IsDead=FALSE].ID}]

	variable index:actor Actors
	variable bool Goto2ndSpot=FALSE
	variable bool Moved=FALSE
	variable string LockSpot="-108.844803,15.214252,-87.956612"
	call RIObj.LockAndPull ${_HorbID} "${LockSpot}"
	if ${RI_Var_Bool_GlobalOthers}
	{
		RI_Var_Int_MoveDistanceMod:Set[8]
		call MoveBehind ${Actor[Query, ID=${_HorbID} && IsDead=FALSE].ID}
	}
	while ${Actor[Query, ID=${_HorbID} && IsDead=FALSE](exists)}
	{
		Actors:Clear
		EQ2:QueryActors[Actors, Name=="rotting meat"]
		
		if ${Actors.Used}>=15 && !${Moved} && ${Actor[Query, ID=${_HorbID} && IsDead=FALSE].Health}>20
			Goto2ndSpot:Set[TRUE]
		
		if ${Goto2ndSpot}
		{
			LockSpot:Set["-78.526306,18.716932,-142.403702"]
			Goto2ndSpot:Set[FALSE]
			Moved:Set[TRUE]
		}
		
		call RIObj.Target ${_HorbID}
		
		if ${Actor[Query, ID=${_HorbID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_HorbID},790]}].CurrentIncrements}>0
			call RIObj.MageAbsorbMagic ${_HorbID} -1
		
		while ${Me.Cursed}==-1
		{
			if ${Actor[rotting meat].Distance}>5
				RIMUIObj:SetLockSpot[${Me.Name},${Actor[rotting meat].Loc},5,500]
			Actor[rotting meat]:DoubleClick
		}
		if ${RI_Var_Bool_GlobalOthers}
			RIMUIObj:SetLockSpot[OFF]
		else
			RIMUIObj:SetLockSpot[${Me.Name},${LockSpot},1,500]
		wait 2
	}
	
	echo ISXRI: Ending ${NamedName}
}
function Loin()
{
	call Horb TRUE
}
function Morghorb(bool HerdMode=FALSE)
{
	variable string NamedName
	variable string FrontalSpell
	variable string RearSpell
	if ${HerdMode}
	{
		NamedName:Set[Sirloin]
		FrontalSpell:Set[Topsir's Revenge]
		RearSpell:Set[Loin's Reckoning]
	}
	else
	{
		NamedName:Set[Morghorb]
		FrontalSpell:Set[Morg's Revenge]
		RearSpell:Set[Horb's Reckoning]
	}
	echo ISXRI: Starting ${NamedName}
	RI_Var_Int_MoveDistanceMod:Set[1]
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,0]
	IncomingText:Insert[repares a rear assault!]	
	IncomingText:Insert[repares a frontal assault!]
	IncomingText:Insert[entire bodies turns volatile!]
	variable int _MorghorbID
	_MorghorbID:Set[${Actor[Query, Name=-"${NamedName}" && IsDead=FALSE].ID}]
	variable string _MyLoc
	variable int _cnt
	variable int i
	if !${RI_Var_Bool_GlobalOthers}
	{
		RIMUIObj:SetLockSpot[${Me.Name},49.785309,30.552780,-210.096008,1,500]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[1].Name},49.291969,30.242695,-197.981033,1,500]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[2].Name},37.592064,30.180744,-192.161621,1,500]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[3].Name},25.795946,30.463148,-197.856186,1,500]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[4].Name},25.309896,30.557432,-209.757980,1,500]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5].Name},37.228035,30.621916,-215.940475,1,500]
	}
	wait 50
	if ${Me.Distance[49.785309,30.552780,-210.096008]}<5
		_MyLoc:Set["49.785309,30.552780,-210.096008"]
	elseif ${Me.Distance[49.291969,30.242695,-197.981033]}<5
		_MyLoc:Set["49.291969,30.242695,-197.981033"]
	elseif ${Me.Distance[37.592064,30.180744,-192.161621]}<5
		_MyLoc:Set["37.592064,30.180744,-192.161621"]
	elseif ${Me.Distance[25.795946,30.463148,-197.856186]}<5
		_MyLoc:Set["25.795946,30.463148,-197.856186"]
	elseif ${Me.Distance[25.309896,30.557432,-209.757980]}<5
		_MyLoc:Set["25.309896,30.557432,-209.757980"]
	elseif ${Me.Distance[37.228035,30.621916,-215.940475]}<5
		_MyLoc:Set["37.228035,30.621916,-215.940475"]
	while ${Actor[Query, ID=${_MorghorbID} && IsDead=FALSE](exists)}
	{
		call MorgHorbCure ${_MorghorbID}
		call RIObj.Target "Cage of Condemnation" ${_MorghorbID}
		
		if ${Actor[Query, ID=${_MorghorbID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_MorghorbID},790]}].CurrentIncrements}>0
			call RIObj.MageAbsorbMagic ${_MorghorbID} -1
		
		if ${Trigger} || ${Me.GetGameData[Target.Casting].Label.Equal[${FrontalSpell}]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[${FrontalSpell}]} || ${Me.GetGameData[Target.Casting].Label.Equal[${RearSpell}]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[${RearSpell}]}
		{
			if ${TriggerMessage.Find[frontal](exists)} || ${Me.GetGameData[Target.Casting].Label.Equal[${FrontalSpell}]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[${FrontalSpell}}]}
			{
				;move behind
				RIMUIObj:SetLockSpot[OFF]
				RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[1]
				;call MoveInFront 0
				call MoveBehind ${_MorghorbID}
				eq2ex cancel_spellcast
				RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[1]
				eq2ex cancel_spellcast
				
				_cnt:Set[0]
				while ${Me.GetGameData[Target.Casting].Label.NotEqual[${FrontalSpell}]} && ${Me.GetGameData[ImpliedTarget.Casting].Label.NotEqual[${FrontalSpell}]} && ${_cnt:Inc}<60
				{
					call MorgHorbCure ${_MorghorbID}
					wait 1
				}
				if !${RI_Var_Bool_GlobalOthers} && ${Me.GetGameData[Target.Casting].Label.NotEqual[${FrontalSpell}]} && ${Me.GetGameData[ImpliedTarget.Casting].Label.NotEqual[${FrontalSpell}]}
				{
					RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
					call MoveBehind 0
					RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
					RIMUIObj:SetLockSpot[ALL,13.655996,30.619490,-218.979950]
				}
				_cnt:Set[0]
				while ${Me.GetGameData[Target.Casting].Label.NotEqual[${FrontalSpell}]} && ${Me.GetGameData[ImpliedTarget.Casting].Label.NotEqual[${FrontalSpell}]} && ${_cnt:Inc}<240
				{
					call MorgHorbCure ${_MorghorbID}
					wait 1
				}
				_cnt:Set[0]
				while ( ${Me.GetGameData[Target.Casting].Label.Equal[${FrontalSpell}]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[${FrontalSpell}]} ) && ${_cnt:Inc}<100
				{
					call MorgHorbCure ${_MorghorbID}
					wait 1
				}
				_cnt:Set[0]
				while ${_cnt:Inc}<10
				{
					call MorgHorbCure ${_MorghorbID}
					wait 1
				}
				RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
				call MoveBehind 0
				RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
			}
			elseif ${TriggerMessage.Find[rear](exists)} || ${Me.GetGameData[Target.Casting].Label.Equal[${RearSpell}]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[${RearSpell}}]}
			{
				;move infront
				RIMUIObj:SetLockSpot[OFF]
				RI_Var_Bool_MoveInFrontIgnoreAggroCheck:Set[1]
				;call MoveBehind 0
				call MoveInFront ${_MorghorbID}
				eq2ex cancel_spellcast
				RI_Var_Bool_MoveInFrontIgnoreAggroCheck:Set[1]
				eq2ex cancel_spellcast
				_cnt:Set[0]
				while ${Me.GetGameData[Target.Casting].Label.NotEqual[${RearSpell}]} && ${Me.GetGameData[ImpliedTarget.Casting].Label.NotEqual[${RearSpell}]} && ${_cnt:Inc}<300
				{
					call MorgHorbCure ${_MorghorbID}
					wait 1
				}
				_cnt:Set[0]
				while ( ${Me.GetGameData[Target.Casting].Label.Equal[${RearSpell}]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[${RearSpell}]} ) && ${_cnt:Inc}<100
				{
					call MorgHorbCure ${_MorghorbID}
					wait 1
				}
				_cnt:Set[0]
				while ${_cnt:Inc}<10
				{
					call MorgHorbCure ${_MorghorbID}
					wait 1
				}
				RI_Var_Bool_MoveInFrontIgnoreAggroCheck:Set[0]
				call MoveInFront 0
				RI_Var_Bool_MoveInFrontIgnoreAggroCheck:Set[0]
			}
			elseif ${TriggerMessage.Find[volatile](exists)}
			{
				_cnt:Set[0]
				while !${Me.IsCrouching} && ${_cnt:Inc}<10
				{
					press ${RI_Var_String_CrouchKey}
					wait 2
				}
				_cnt:Set[0]
				while ${Me.GetGameData[Target.Casting].Label.NotEqual[Whirlihurl]} && ${Me.GetGameData[ImpliedTarget.Casting].Label.NotEqual[Whirlihurl]} && ${_cnt:Inc}<300
				{
					if ${Me.Trauma}==1
						RIMUIObj:SetLockSpot[${Me.Name},${Actor[Query, ID=${_MorghorbID} && IsDead=FALSE].Loc},1,500]
					elseif ${Me.Distance[${_MyLoc}]}>3
						RIMUIObj:SetLockSpot[${Me.Name},${_MyLoc},1,500]
					call MorgHorbCure ${_MorghorbID}
					wait 1
				}
				_cnt:Set[0]
				while ( ${Me.GetGameData[Target.Casting].Label.Equal[Whirlihurl]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[Whirlihurl]} ) && ${_cnt:Inc}<100
				{
					if ${Me.Trauma}==1
						RIMUIObj:SetLockSpot[${Me.Name},${Actor[Query, ID=${_MorghorbID} && IsDead=FALSE].Loc},1,500]
					elseif ${Me.Distance[${_MyLoc}]}>3
						RIMUIObj:SetLockSpot[${Me.Name},${_MyLoc},1,500]
					call MorgHorbCure ${_MorghorbID}
					wait 1
				}
				_cnt:Set[0]
				while ${_cnt:Inc}<10
				{
					if ${Me.Trauma}==1
						RIMUIObj:SetLockSpot[${Me.Name},${Actor[Query, ID=${_MorghorbID} && IsDead=FALSE].Loc},1,500]
					elseif ${Me.Distance[${_MyLoc}]}>3
						RIMUIObj:SetLockSpot[${Me.Name},${_MyLoc},1,500]
					call MorgHorbCure ${_MorghorbID}
					wait 1
				}
				press ${RI_Var_String_JumpKey}
			}
			
			RIMUIObj:SetLockSpot[${Me.Name},${_MyLoc},1,500]
			Trigger:Set[FALSE]
		}
		if ${Me.Trauma}==1
			RIMUIObj:SetLockSpot[${Me.Name},${Actor[Query, ID=${_MorghorbID} && IsDead=FALSE].Loc},1,500]
		elseif ${Me.Distance[${_MyLoc}]}>3
			RIMUIObj:SetLockSpot[${Me.Name},${_MyLoc},1,500]

		wait 2
	}
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,1]
	echo ISXRI: Ending ${NamedName}
}
function MorgHorbCure(int _MorghorbID)
{
	variable int i
	if ${Me.Archetype.Equal[priest]}
	{
		for(i:Set[0];${i}<${Me.Group};i:Inc)
		{
			if ${Me.Group[${i}].Trauma}==1 && ( ${Me.Group[${i}].Distance[${Actor[Query, ID=${_MorghorbID} && IsDead=FALSE].Loc}]}<5 || ${Me.Group[${i}].Distance[${Actor[Query, ID=${_MorghorbID} && IsDead=FALSE].Loc}]}>20 )
				eq2ex useabilityonplayer ${Me.Group[${i}].Name} 2945678992
		}
	}
}
function Sirloin()
{
	call Morghorb TRUE
}
function Cowtankerous()
{
	call Triumvirate TRUE
}
;variable(global) bool BatsSpawned=0
function Triumvirate(bool Herd=FALSE)
{
	variable string NamedName=""
	variable string Named2Name=""
	variable string Named3Name=""
	variable string AddName=""
	
	if ${Herd}
	{
		NamedName:Set[Taurine]
		Named2Name:Set["Zebu'Vas"]
		Named3Name:Set["Aurochs'Ta"]
		AddName:Set["torn bovine"]
		echo ISXRI: Starting Cowtankerous
	}
	else
	{
		NamedName:Set[Estir]
		Named2Name:Set["Laxil'Vas"]
		Named3Name:Set["Ragash'Ta"]
		AddName:Set["torn baron"]
		echo ISXRI: Starting Triumvirate
	}

	call EstirVariables
	AnnounceText:Clear
	AnnounceText:Insert[ALL your SCOUTS I shall destroy]
	AnnounceText:Insert[ALL your MAGES I shall destroy]
	AnnounceText:Insert[ALL your PRIESTS I shall destroy]
	AnnounceText:Insert[ALL your FIGHTERS I shall destroy]
	AnnounceText:Insert[ALL your SCOUT I shall destroy]
	AnnounceText:Insert[ALL your MAGE I shall destroy]
	AnnounceText:Insert[ALL your PRIEST I shall destroy]
	AnnounceText:Insert[ALL your FIGHTER I shall destroy]
	AnnounceText:Insert[I shall destroy]
	
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,0]
	RI_Obj_CB:DoNotCastAE[1]
	RI_Obj_CB:DoNotCastEncounter[1]
	call RIObj.SingularFocus 1
	
	;;;also turn off wards bane
	variable int CircleID=0
	variable index:actor ActorIndex
	variable bool NearMe=FALSE
	variable bool NearCoffin=FALSE
	variable bool NearAltSpot1=FALSE
	variable bool NearAltSpot2=FALSE
	variable bool NearAltSpot3=FALSE
	variable bool Moved=FALSE
	variable string MoveLoc=""
	variable int _EstirID=${Actor[Query, Name=-"${NamedName} the Spiteful" && IsDead=FALSE].ID}
	variable int _LaxilID=${Actor[Query, Name=-"${Named2Name} the Torn" && IsDead=FALSE].ID}
	variable int _RagashID=${Actor[Query, Name=-"${Named3Name} the Insidious" && IsDead=FALSE].ID}
	variable string _Archetype
	variable int i
	variable int cnt=0
	variable int traumacnt=0
	variable string AbilityID=0
	variable string AbilityName=0
	IncomingText:Clear
	IncomingText:Insert["my sister still sleeps"]
	IncomingText:Insert["my siblings like to oversleep"]
	if !${Actor[Query, Name=-"${NamedName} the Spiteful"].IsAggro}
	{
		RIMUIObj:SetLockSpot[ALL,OFF]
		RIMUIObj:SetRIFollow[ALL,OFF]
		if !${RI_Var_Bool_GlobalOthers}
		{
			while !${Trigger}
			{
				Actor[Query, Name=-"${NamedName} the Spiteful"]:DoTarget
				eq2ex hail
				wait 50 ${Trigger}
			}
			Trigger:Set[0]
			call LockAndWait -Loc "-58.420773,-151.346619,-309.455658"
			while ${Actor[Coffin Lid 2].Interactable} && !${Actor[Query, Name=-"${NamedName} the Spiteful"].IsAggro}
			{
				Actor[Coffin Lid 2]:DoubleClick
				wait 5
			}
			call LockAndWait -Loc "31.788549,-151.346619,-309.351776"
			while ${Actor[Coffin Lid 3].Interactable} && !${Actor[Query, Name=-"${NamedName} the Spiteful"].IsAggro}
			{
				Actor[Coffin Lid 3]:DoubleClick
				wait 5
			}
			call LockAndWait -Loc "-22.408728,-155.248962,-255.862930"
		}
		while !${Actor[Query, Name=-"${NamedName} the Spiteful"].IsAggro}
			wait 1
		while !${Actor[Query, Name=-"${Named3Name} the Insidious"].IsAggro}
			wait 1
	}
	_EstirID:Set[${Actor[Query, Name=-"${NamedName} the Spiteful" && IsDead=FALSE].ID}]
	_LaxilID:Set[${Actor[Query, Name=-"${Named2Name} the Torn" && IsDead=FALSE].ID}]
	_RagashID:Set[${Actor[Query, Name=-"${Named3Name} the Insidious" && IsDead=FALSE].ID}]
	;echo ${_EstirID} ${_LaxilID} ${_RagashID}
	call RIObj.LockAndPull ${_EstirID} "24.072706,-154.004944,-254.849579" 10 0
	switch ${Me.SubClass}
	{
		case defiler
		{
			AbilityID:Set[1306442377]
			AbilityName:Set["Mail of Souls III"]
			break
		}
		case mystic
		{
			AbilityID:Set[462347794]
			AbilityName:Set["Ebbing Spirit III"]
			break
		}
		case warden
		{
			AbilityID:Set[16740212]
			AbilityName:Set["Verdant Whisper III"]
			break
		}
		case fury
		{
			AbilityID:Set[381761513]
			AbilityName:Set["Abolishment III"]
			break
		}
		case templar
		{
			AbilityID:Set[1116082467]
			AbilityName:Set["Devoted Resolve III"]
			break
		}
		case inquisitor
		{
			AbilityID:Set[3426965795]
			AbilityName:Set["Resolute Flagellant III"]
			break
		}
		case channeler
		{
			AbilityID:Set[2242394780]
			AbilityName:Set["Brood Cure III"]
			break
		}
	}
	;echo ${AbilityID}
	;echo ${Me.Ability[id,${AbilityID}].ToAbilityInfo.Name}
	;wait 5
	;echo ${Me.Ability[id,${AbilityID}].ToAbilityInfo.Name}
	while !${Actor[of spite](exists)} && !${Actor[${AddName}](exists)}
	{
		;echo waiting for adds
		wait 1
	}
	if ${Actor[of spite](exists)}
	{
		while ${Actor[Query, ID=${_EstirID} && IsDead=FALSE](exists)}
		{
			if ${Actor[Query, ID=${_EstirID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_EstirID},790]}].CurrentIncrements}>0
				call RIObj.MageAbsorbMagic ${_EstirID} -1
			;1 add is 100-75 2 75-50 3 50-25 4 25-0
			if ${RIObj.MobCount["of spite"]}==${Actor[Query, ID=${_EstirID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_EstirID},390]}].CurrentIncrements}
				call RIObj.Target ${_EstirID}
			else
				call RIObj.Target -LowestHealth "of spite" -Distance 30

			call EstirCircle
			
			;check for trauma
			if !${Me.Noxious} && !${Trigger}
			{
				;echo if ${RIObj.GroupDetrimentCount[Trauma]}>2 && ${Me.Ability[id,${AbilityID}].IsReady}
				if ${RIObj.GroupDetrimentCount[Trauma]}>2 && ${Me.Ability[id,${AbilityID}].IsReady}
				{
					wait 2
					if ${RIObj.GroupDetrimentCount[Noxious]}==0
					{
						;echo we have >2 trauma
						;cast group cure
						RI_CMD_PauseCombatBots 1
						
						;eq2ex cancel_spellcast
						if ${RIObj.GroupDetrimentCount[Trauma]}>2 && ${RIObj.GroupDetrimentCount[Noxious]}==0
						{
							if ${Me.GetGameData[Spells.Casting].Label.NotEqual["${AbilityName}"]}
							{
								eq2ex cancel_spellcast
								eq2ex clearabilityqueue
							}
							Me.Ability[id,${AbilityID}]:Use
							;wait 2
						}
						RI_CMD_PauseCombatBots 0
					}
				}
				elseif ${RIObj.GroupDetrimentCount[Trauma]}>0
				{
					wait 2
					if ${RIObj.GroupDetrimentCount[Noxious]}==0
					{
						for(i:Set[0];${i}<${Me.Group};i:Inc)
						{
							if ${Me.Group[${i}].Trauma}==1 && ${RIObj.GroupDetrimentCount[Noxious]}==0
							{
								RI_CMD_PauseCombatBots 1
								eq2ex useabilityonplayer ${Me.Group[${i}].Name} 2945678992
							}
						}
						RI_CMD_PauseCombatBots 0
					}
				}
			}		
			if ${Trigger}
			{
				wait 50 ${Me.Noxious}==1
				if ${Me.GetGameData[Spells.Casting].Label.Equal[${AbilityName}]} || ${Me.GetGameData[Spells.Casting].Label.Equal[Cure]}
				{
					eq2ex cancel_spellcast
					eq2ex clearabilityqueue
				}
				wait 5
				if ${Me.GetGameData[Spells.Casting].Label.Equal[${AbilityName}]} || ${Me.GetGameData[Spells.Casting].Label.Equal[Cure]}
				{
					eq2ex cancel_spellcast
					eq2ex clearabilityqueue
				}
				;echo Trigger
				if ${Me.Archetype.Equal[priest]}
				{
					if ${TriggerMessage.Find[SCOUT]}
						_Archetype:Set[scout]
					if ${TriggerMessage.Find[MAGE]}
						_Archetype:Set[mage]
					if ${TriggerMessage.Find[PRIEST]}
						_Archetype:Set[priest]
					if ${TriggerMessage.Find[FIGHTER]}
						_Archetype:Set[fighter]
					;echo Archetype=${_Archetype}
					for(i:Set[0];${i}<${Me.Group};i:Inc)
					{
						;echo checking ${Me.Group[${i}].Name}:${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
						while ${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
						{
							RI_CMD_PauseCombatBots 1
							if ${Me.GetGameData[Spells.Casting].Label.Equal[${AbilityName}]}
							{
								eq2ex cancel_spellcast
								eq2ex clearabilityqueue
							}
							eq2ex useabilityonplayer ${Me.Group[${i}].Name} 2945678992
						}
					}
					RI_CMD_PauseCombatBots 0
				}
				wait 5
				if ${Me.Noxious}==0
					Trigger:Set[0]
			}
			wait 1
		}
		while ${Actor[Query, ID=${_LaxilID} && IsDead=FALSE](exists)}
		{
			if ${Actor[Query, ID=${_LaxilID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_LaxilID},790]}].CurrentIncrements}>0
				call RIObj.MageAbsorbMagic ${_LaxilID} -1
			;1 add is 100-75 2 75-50 3 50-25 4 25-0
			if ${RIObj.MobCount["of spite"]}>0
				call RIObj.Target -LowestHealth "of spite" -Distance 30
			elseif ${RIObj.MobCount["${AddName}"]}==${Actor[Query, ID=${_LaxilID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_LaxilID},390]}].CurrentIncrements}
				call RIObj.Target ${_LaxilID}
			else
				call RIObj.Target -LowestHealth "${AddName}" -Distance 30

			call EstirCircle
			
			;check for trauma
			if !${Me.Noxious} && !${Trigger}
			{
				;echo if ${RIObj.GroupDetrimentCount[Trauma]}>2 && ${Me.Ability[id,${AbilityID}].IsReady}
				if ${RIObj.GroupDetrimentCount[Trauma]}>2 && ${Me.Ability[id,${AbilityID}].IsReady}
				{
					wait 2
					if ${RIObj.GroupDetrimentCount[Noxious]}==0
					{
						;echo we have >2 trauma
						;cast group cure
						RI_CMD_PauseCombatBots 1
						
						;eq2ex cancel_spellcast
						if ${RIObj.GroupDetrimentCount[Trauma]}>2 && ${RIObj.GroupDetrimentCount[Noxious]}==0
						{
							if ${Me.GetGameData[Spells.Casting].Label.NotEqual["${AbilityName}"]}
							{
								eq2ex cancel_spellcast
								eq2ex clearabilityqueue
							}
							Me.Ability[id,${AbilityID}]:Use
							;wait 2
						}
						RI_CMD_PauseCombatBots 0
					}
				}
				elseif ${RIObj.GroupDetrimentCount[Trauma]}>0
				{
					wait 2
					if ${RIObj.GroupDetrimentCount[Noxious]}==0
					{
						for(i:Set[0];${i}<${Me.Group};i:Inc)
						{
							if ${Me.Group[${i}].Trauma}==1 && ${RIObj.GroupDetrimentCount[Noxious]}==0
							{
								RI_CMD_PauseCombatBots 1
								eq2ex useabilityonplayer ${Me.Group[${i}].Name} 2945678992
							}
						}
						RI_CMD_PauseCombatBots 0
					}
				}
			}		
			if ${Trigger}
			{
				wait 50 ${Me.Noxious}==1
				if ${Me.GetGameData[Spells.Casting].Label.Equal[${AbilityName}]} || ${Me.GetGameData[Spells.Casting].Label.Equal[Cure]}
				{
					eq2ex cancel_spellcast
					eq2ex clearabilityqueue
				}
				wait 5
				if ${Me.GetGameData[Spells.Casting].Label.Equal[${AbilityName}]} || ${Me.GetGameData[Spells.Casting].Label.Equal[Cure]}
				{
					eq2ex cancel_spellcast
					eq2ex clearabilityqueue
				}
				;echo Trigger
				if ${Me.Archetype.Equal[priest]}
				{
					if ${TriggerMessage.Find[SCOUT]}
						_Archetype:Set[scout]
					if ${TriggerMessage.Find[MAGE]}
						_Archetype:Set[mage]
					if ${TriggerMessage.Find[PRIEST]}
						_Archetype:Set[priest]
					if ${TriggerMessage.Find[FIGHTER]}
						_Archetype:Set[fighter]
					;echo Archetype=${_Archetype}
					for(i:Set[0];${i}<${Me.Group};i:Inc)
					{
						;echo checking ${Me.Group[${i}].Name}:${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
						while ${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
						{
							RI_CMD_PauseCombatBots 1
							if ${Me.GetGameData[Spells.Casting].Label.Equal[${AbilityName}]}
							{
								eq2ex cancel_spellcast
								eq2ex clearabilityqueue
							}
							eq2ex useabilityonplayer ${Me.Group[${i}].Name} 2945678992
						}
					}
					RI_CMD_PauseCombatBots 0
				}
				wait 5
				if ${Me.Noxious}==0
					Trigger:Set[0]
			}
			wait 1
		}
	}
	else
	{
		while ${Actor[Query, ID=${_LaxilID} && IsDead=FALSE](exists)}
		{
			if ${Actor[Query, ID=${_LaxilID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_LaxilID},790]}].CurrentIncrements}>0
				call RIObj.MageAbsorbMagic ${_LaxilID} -1
			;1 add is 100-75 2 75-50 3 50-25 4 25-0
			if ${RIObj.MobCount["${AddName}"]}==${Actor[Query, ID=${_LaxilID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_LaxilID},390]}].CurrentIncrements}
				call RIObj.Target ${_LaxilID}
			else
				call RIObj.Target -LowestHealth "${AddName}" -Distance 30

			call EstirCircle
			
			;check for trauma
			if !${Me.Noxious} && !${Trigger}
			{
				;echo if ${RIObj.GroupDetrimentCount[Trauma]}>2 && ${Me.Ability[id,${AbilityID}].IsReady}
				if ${RIObj.GroupDetrimentCount[Trauma]}>2 && ${Me.Ability[id,${AbilityID}].IsReady}
				{
					wait 2
					if ${RIObj.GroupDetrimentCount[Noxious]}==0
					{
						;echo we have >2 trauma
						;cast group cure
						RI_CMD_PauseCombatBots 1
						
						;eq2ex cancel_spellcast
						if ${RIObj.GroupDetrimentCount[Trauma]}>2 && ${RIObj.GroupDetrimentCount[Noxious]}==0
						{
							if ${Me.GetGameData[Spells.Casting].Label.NotEqual["${AbilityName}"]}
							{
								eq2ex cancel_spellcast
								eq2ex clearabilityqueue
							}
							Me.Ability[id,${AbilityID}]:Use
							;wait 2
						}
						RI_CMD_PauseCombatBots 0
					}
				}
				elseif ${RIObj.GroupDetrimentCount[Trauma]}>0
				{
					wait 2
					if ${RIObj.GroupDetrimentCount[Noxious]}==0
					{
						for(i:Set[0];${i}<${Me.Group};i:Inc)
						{
							if ${Me.Group[${i}].Trauma}==1 && ${RIObj.GroupDetrimentCount[Noxious]}==0
							{
								RI_CMD_PauseCombatBots 1
								eq2ex useabilityonplayer ${Me.Group[${i}].Name} 2945678992
							}
						}
						RI_CMD_PauseCombatBots 0
					}
				}
			}		
			if ${Trigger}
			{
				wait 50 ${Me.Noxious}==1
				if ${Me.GetGameData[Spells.Casting].Label.Equal[${AbilityName}]} || ${Me.GetGameData[Spells.Casting].Label.Equal[Cure]}
				{
					eq2ex cancel_spellcast
					eq2ex clearabilityqueue
				}
				wait 5
				if ${Me.GetGameData[Spells.Casting].Label.Equal[${AbilityName}]} || ${Me.GetGameData[Spells.Casting].Label.Equal[Cure]}
				{
					eq2ex cancel_spellcast
					eq2ex clearabilityqueue
				}
				;echo Trigger
				if ${Me.Archetype.Equal[priest]}
				{
					if ${TriggerMessage.Find[SCOUT]}
						_Archetype:Set[scout]
					if ${TriggerMessage.Find[MAGE]}
						_Archetype:Set[mage]
					if ${TriggerMessage.Find[PRIEST]}
						_Archetype:Set[priest]
					if ${TriggerMessage.Find[FIGHTER]}
						_Archetype:Set[fighter]
					;echo Archetype=${_Archetype}
					for(i:Set[0];${i}<${Me.Group};i:Inc)
					{
						;echo checking ${Me.Group[${i}].Name}:${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
						while ${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
						{
							RI_CMD_PauseCombatBots 1
							if ${Me.GetGameData[Spells.Casting].Label.Equal[${AbilityName}]}
							{
								eq2ex cancel_spellcast
								eq2ex clearabilityqueue
							}
							eq2ex useabilityonplayer ${Me.Group[${i}].Name} 2945678992
						}
					}
					RI_CMD_PauseCombatBots 0
				}
				wait 5
				if ${Me.Noxious}==0
					Trigger:Set[0]
			}
			wait 1
		}
		
		while ${Actor[Query, ID=${_EstirID} && IsDead=FALSE](exists)}
		{
			if ${Actor[Query, ID=${_EstirID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_EstirID},790]}].CurrentIncrements}>0
				call RIObj.MageAbsorbMagic ${_EstirID} -1
			;1 add is 100-75 2 75-50 3 50-25 4 25-0
			if ${RIObj.MobCount["${AddName}"]}>0
				call RIObj.Target -LowestHealth "${AddName}" -Distance 30
			elseif ${RIObj.MobCount["of spite"]}==${Actor[Query, ID=${_EstirID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_EstirID},390]}].CurrentIncrements}
				call RIObj.Target ${_EstirID}
			else
				call RIObj.Target -LowestHealth "of spite" -Distance 30

			call EstirCircle

			;check for trauma
			if !${Me.Noxious} && !${Trigger}
			{
				if ${RIObj.GroupDetrimentCount[Trauma]}>2 && ${Me.Ability[id,${AbilityID}].IsReady}
				{
					wait 2
					if ${RIObj.GroupDetrimentCount[Noxious]}==0
					{
						;echo we have >2 trauma
						;cast group cure
						RI_CMD_PauseCombatBots 1
						
						;eq2ex cancel_spellcast
						if ${RIObj.GroupDetrimentCount[Trauma]}>2 && ${RIObj.GroupDetrimentCount[Noxious]}==0
						{
							Me.Ability[id,${AbilityID}]:Use
							;wait 2
						}
						RI_CMD_PauseCombatBots 0
					}
				}
				elseif ${RIObj.GroupDetrimentCount[Trauma]}>0
				{
					wait 2
					if ${RIObj.GroupDetrimentCount[Noxious]}==0
					{
						for(i:Set[0];${i}<${Me.Group};i:Inc)
						{
							if ${Me.Group[${i}].Trauma}==1 && ${RIObj.GroupDetrimentCount[Noxious]}==0
							{
								RI_CMD_PauseCombatBots 1
								eq2ex useabilityonplayer ${Me.Group[${i}].Name} 2945678992
							}
						}
						RI_CMD_PauseCombatBots 0
					}
				}
			}		
			if ${Trigger}
			{
				wait 50 ${Me.Noxious}==1
				wait 5
				;echo Trigger
				if ${Me.Archetype.Equal[priest]}
				{
					if ${TriggerMessage.Find[SCOUT]}
						_Archetype:Set[scout]
					if ${TriggerMessage.Find[MAGE]}
						_Archetype:Set[mage]
					if ${TriggerMessage.Find[PRIEST]}
						_Archetype:Set[priest]
					if ${TriggerMessage.Find[FIGHTER]}
						_Archetype:Set[fighter]
					;echo Archetype=${_Archetype}
					for(i:Set[0];${i}<${Me.Group};i:Inc)
					{
						;echo checking ${Me.Group[${i}].Name}:${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
						while ${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
						{
							RI_CMD_PauseCombatBots 1
							eq2ex useabilityonplayer ${Me.Group[${i}].Name} 2945678992
						}
					}
					RI_CMD_PauseCombatBots 0
				}
				wait 5
				if ${Me.Noxious}==0
					Trigger:Set[0]
			}
			wait 1
		}
	}
	while ${Actor[Query, ID=${_RagashID} && IsDead=FALSE](exists)}
	{
		if ${Actor[Query, ID=${_RagashID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_RagashID},790]}].CurrentIncrements}>0
			call RIObj.MageAbsorbMagic ${_RagashID} -1
		;1 add is 100-75 2 75-50 3 50-25 4 25-0
		if ${RIObj.MobCount["of spite"]}>0
			call RIObj.Target -LowestHealth "${AddName}" -Distance 30
		elseif ${RIObj.MobCount["${AddName}"]}==${Actor[Query, ID=${_RagashID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_RagashID},390]}].CurrentIncrements}
			call RIObj.Target ${_RagashID}
		else
			call RIObj.Target -LowestHealth "${AddName}" -Distance 30 -LowestHealth "${AddName}" -Distance 30

		call EstirCircle
		
		;check for trauma
		if !${Me.Noxious} && !${Trigger}
		{
			if ${RIObj.GroupDetrimentCount[Trauma]}>2 && ${Me.Ability[id,${AbilityID}].IsReady}
			{
				wait 2
				if ${RIObj.GroupDetrimentCount[Noxious]}==0
				{
					;echo we have >2 trauma
					;cast group cure
					RI_CMD_PauseCombatBots 1
					
					;eq2ex cancel_spellcast
					if ${RIObj.GroupDetrimentCount[Trauma]}>2 && ${RIObj.GroupDetrimentCount[Noxious]}==0
					{
						Me.Ability[id,${AbilityID}]:Use
						;wait 2
					}
					RI_CMD_PauseCombatBots 0
				}
			}
			elseif ${RIObj.GroupDetrimentCount[Trauma]}>0
			{
				wait 2
				if ${RIObj.GroupDetrimentCount[Noxious]}==0
				{
					for(i:Set[0];${i}<${Me.Group};i:Inc)
					{
						if ${Me.Group[${i}].Trauma}==1 && ${RIObj.GroupDetrimentCount[Noxious]}==0
						{
							RI_CMD_PauseCombatBots 1
							eq2ex useabilityonplayer ${Me.Group[${i}].Name} 2945678992
						}
					}
					RI_CMD_PauseCombatBots 0
				}
			}
		}		
		if ${Trigger}
		{
			wait 50 ${Me.Noxious}==1
			wait 5
			;echo Trigger
			if ${Me.Archetype.Equal[priest]}
			{
				if ${TriggerMessage.Find[SCOUT]}
					_Archetype:Set[scout]
				if ${TriggerMessage.Find[MAGE]}
					_Archetype:Set[mage]
				if ${TriggerMessage.Find[PRIEST]}
					_Archetype:Set[priest]
				if ${TriggerMessage.Find[FIGHTER]}
					_Archetype:Set[fighter]
				;echo Archetype=${_Archetype}
				for(i:Set[0];${i}<${Me.Group};i:Inc)
				{
					;echo checking ${Me.Group[${i}].Name}:${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
					while ${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
					{
						RI_CMD_PauseCombatBots 1
						eq2ex useabilityonplayer ${Me.Group[${i}].Name} 2945678992
					}
				}
				RI_CMD_PauseCombatBots 0
			}
			wait 5
			if ${Me.Noxious}==0
				Trigger:Set[0]
		}
		wait 1
	}
	
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,1]
	RI_Obj_CB:DoNotCastAE[0]
	RI_Obj_CB:DoNotCastEncounter[0]
	call RIObj.SingularFocus 0
	call EstirDeleteVariables
	echo ISXRI: Ending Triumvirate
}
function Moosome()
{
	call Twosome TRUE
}
function Twosome(bool Herd=FALSE)
{
	variable string NamedName=""
	variable string Named2Name=""
	variable string AddName=""
	
	if ${Herd}
	{
		NamedName:Set[Taurine]
		Named2Name:Set["Zebu'Vas"]
		AddName:Set["torn bovine"]
		echo ISXRI: Starting Moosome
	}
	else
	{
		NamedName:Set[Estir]
		Named2Name:Set["Laxil'Vas"]
		AddName:Set["torn baron"]
		echo ISXRI: Starting Twosome
	}
		
	
	call EstirVariables
	AnnounceText:Clear
	AnnounceText:Insert[ALL your SCOUTS I shall destroy]
	AnnounceText:Insert[ALL your MAGES I shall destroy]
	AnnounceText:Insert[ALL your PRIESTS I shall destroy]
	AnnounceText:Insert[ALL your FIGHTERS I shall destroy]
	AnnounceText:Insert[ALL your SCOUT I shall destroy]
	AnnounceText:Insert[ALL your MAGE I shall destroy]
	AnnounceText:Insert[ALL your PRIEST I shall destroy]
	AnnounceText:Insert[ALL your FIGHTER I shall destroy]
	AnnounceText:Insert[I shall destroy]
	
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,0]
	RI_Obj_CB:DoNotCastAE[1]
	RI_Obj_CB:DoNotCastEncounter[1]
	call RIObj.SingularFocus 1
	
	;;;also turn off wards bane
	variable int CircleID=0
	variable index:actor ActorIndex
	variable bool NearMe=FALSE
	variable bool NearCoffin=FALSE
	variable bool NearAltSpot1=FALSE
	variable bool NearAltSpot2=FALSE
	variable bool NearAltSpot3=FALSE
	variable bool Moved=FALSE
	variable string MoveLoc=""
	variable int _EstirID=${Actor[Query, Name=-"${NamedName} the Spiteful" && IsDead=FALSE].ID}
	variable int _LaxilID=${Actor[Query, Name=-"${Named2Name} the Torn" && IsDead=FALSE].ID}

	variable string _Archetype
	variable int i
	variable int cnt=0
	IncomingText:Clear
	IncomingText:Insert["my sister still sleeps"]
	IncomingText:Insert["my siblings like to oversleep"]
	if !${Actor[Query, Name=-"${NamedName} the Spiteful"].IsAggro}
	{
		RIMUIObj:SetLockSpot[ALL,OFF]
		RIMUIObj:SetRIFollow[ALL,OFF]
		if !${RI_Var_Bool_GlobalOthers}
		{
			while !${Trigger}
			{
				Actor[Query, Name=-"${NamedName} the Spiteful"]:DoTarget
				eq2ex hail
				wait 50 ${Trigger}
			}
			Trigger:Set[0]
			call LockAndWait -Loc "-58.420773,-151.346619,-309.455658"
			while ${Actor[Coffin Lid 2].Interactable} && !${Actor[Query, Name=-"${NamedName} the Spiteful"].IsAggro}
			{
				Actor[Coffin Lid 2]:DoubleClick
				wait 5
			}
			call LockAndWait -Loc "-22.408728,-155.248962,-255.862930"
		}
		while !${Actor[Query, Name=-"${NamedName} the Spiteful"].IsAggro}
			wait 1
	}
	_EstirID:Set[${Actor[Query, Name=-"${NamedName} the Spiteful" && IsDead=FALSE].ID}]
	_LaxilID:Set[${Actor[Query, Name=-"${Named2Name} the Torn" && IsDead=FALSE].ID}]
	echo ${_EstirID}
	echo ${_LaxilID}
	call RIObj.LockAndPull ${_EstirID} "24.072706,-154.004944,-254.849579" 10 0

	while !${Actor[of spite](exists)} && !${Actor[${AddName}](exists)}
	{
		;echo waiting for adds
		wait 1
	}
	if ${Actor[of spite](exists)}
	{
		while ${Actor[Query, ID=${_EstirID} && IsDead=FALSE](exists)}
		{
			if ${Actor[Query, ID=${_EstirID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_EstirID},790]}].CurrentIncrements}>0
				call RIObj.MageAbsorbMagic ${_EstirID} -1
			;1 add is 100-75 2 75-50 3 50-25 4 25-0
			if ${RIObj.MobCount["of spite"]}==${Actor[Query, ID=${_EstirID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_EstirID},390]}].CurrentIncrements}
				call RIObj.Target ${_EstirID}
			else
				call RIObj.Target -LowestHealth "of spite" -Distance 30

			call EstirCircle

			if ${Trigger}
			{
				wait 50 ${Me.Noxious}==1
				wait 5
				;echo Trigger
				if ${Me.Archetype.Equal[priest]}
				{
					if ${TriggerMessage.Find[SCOUT]}
						_Archetype:Set[scout]
					if ${TriggerMessage.Find[MAGE]}
						_Archetype:Set[mage]
					if ${TriggerMessage.Find[PRIEST]}
						_Archetype:Set[priest]
					if ${TriggerMessage.Find[FIGHTER]}
						_Archetype:Set[fighter]
					;echo Archetype=${_Archetype}
					for(i:Set[0];${i}<${Me.Group};i:Inc)
					{
						;echo checking ${Me.Group[${i}].Name}:${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
						while ${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
						{
							RI_CMD_PauseCombatBots 1
							eq2ex useabilityonplayer ${Me.Group[${i}].Name} 2945678992
						}
					}
					RI_CMD_PauseCombatBots 0
				}
				wait 5
				if ${Me.Noxious}==0
					Trigger:Set[0]
			}
			wait 1
		}
		while ${Actor[Query, ID=${_LaxilID} && IsDead=FALSE](exists)}
		{
			if ${Actor[Query, ID=${_LaxilID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_LaxilID},790]}].CurrentIncrements}>0
				call RIObj.MageAbsorbMagic ${_LaxilID} -1
			;1 add is 100-75 2 75-50 3 50-25 4 25-0
			if ${RIObj.MobCount["of spite"]}>0
				call RIObj.Target -LowestHealth "of spite" -Distance 30
			elseif ${RIObj.MobCount["${AddName}"]}==${Actor[Query, ID=${_LaxilID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_LaxilID},390]}].CurrentIncrements}
				call RIObj.Target ${_LaxilID}
			else
				call RIObj.Target -LowestHealth "of spite" -Distance 30 -LowestHealth "${AddName}" -Distance 30

			call EstirCircle

			if ${Trigger}
			{
				wait 50 ${Me.Noxious}==1
				wait 5
				;echo Trigger
				if ${Me.Archetype.Equal[priest]}
				{
					if ${TriggerMessage.Find[SCOUT]}
						_Archetype:Set[scout]
					if ${TriggerMessage.Find[MAGE]}
						_Archetype:Set[mage]
					if ${TriggerMessage.Find[PRIEST]}
						_Archetype:Set[priest]
					if ${TriggerMessage.Find[FIGHTER]}
						_Archetype:Set[fighter]
					;echo Archetype=${_Archetype}
					for(i:Set[0];${i}<${Me.Group};i:Inc)
					{
						;echo checking ${Me.Group[${i}].Name}:${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
						while ${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
						{
							RI_CMD_PauseCombatBots 1
							eq2ex useabilityonplayer ${Me.Group[${i}].Name} 2945678992
						}
					}
					RI_CMD_PauseCombatBots 0
				}
				wait 5
				if ${Me.Noxious}==0
					Trigger:Set[0]
			}
			wait 1
		}
	}
	else
	{
		while ${Actor[Query, ID=${_LaxilID} && IsDead=FALSE](exists)}
		{
			if ${Actor[Query, ID=${_LaxilID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_LaxilID},790]}].CurrentIncrements}>0
				call RIObj.MageAbsorbMagic ${_LaxilID} -1
			;1 add is 100-75 2 75-50 3 50-25 4 25-0
			elseif ${RIObj.MobCount["${AddName}"]}==${Actor[Query, ID=${_LaxilID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_LaxilID},390]}].CurrentIncrements}
				call RIObj.Target ${_LaxilID}
			else
				call RIObj.Target -LowestHealth -Distance 30 -LowestHealth "${AddName}" -Distance 30

			call EstirCircle

			if ${Trigger}
			{
				wait 50 ${Me.Noxious}==1
				wait 5
				;echo Trigger
				if ${Me.Archetype.Equal[priest]}
				{
					if ${TriggerMessage.Find[SCOUT]}
						_Archetype:Set[scout]
					if ${TriggerMessage.Find[MAGE]}
						_Archetype:Set[mage]
					if ${TriggerMessage.Find[PRIEST]}
						_Archetype:Set[priest]
					if ${TriggerMessage.Find[FIGHTER]}
						_Archetype:Set[fighter]
					;echo Archetype=${_Archetype}
					for(i:Set[0];${i}<${Me.Group};i:Inc)
					{
						;echo checking ${Me.Group[${i}].Name}:${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
						while ${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
						{
							RI_CMD_PauseCombatBots 1
							eq2ex useabilityonplayer ${Me.Group[${i}].Name} 2945678992
						}
					}
					RI_CMD_PauseCombatBots 0
				}
				wait 5
				if ${Me.Noxious}==0
					Trigger:Set[0]
			}
			wait 1
		}
		while ${Actor[Query, ID=${_EstirID} && IsDead=FALSE](exists)}
		{
			if ${Actor[Query, ID=${_EstirID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_EstirID},790]}].CurrentIncrements}>0
				call RIObj.MageAbsorbMagic ${_EstirID} -1
			;1 add is 100-75 2 75-50 3 50-25 4 25-0
			if ${RIObj.MobCount["${AddName}"]}>0
				call RIObj.Target -LowestHealth "${AddName}" -Distance 30
			elseif ${RIObj.MobCount["of spite"]}==${Actor[Query, ID=${_EstirID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_EstirID},390]}].CurrentIncrements}
				call RIObj.Target ${_EstirID}
			else
				call RIObj.Target -LowestHealth "of spite" -Distance 30
	
			call EstirCircle

			if ${Trigger}
			{
				wait 50 ${Me.Noxious}==1
				wait 5
				;echo Trigger
				if ${Me.Archetype.Equal[priest]}
				{
					if ${TriggerMessage.Find[SCOUT]}
						_Archetype:Set[scout]
					if ${TriggerMessage.Find[MAGE]}
						_Archetype:Set[mage]
					if ${TriggerMessage.Find[PRIEST]}
						_Archetype:Set[priest]
					if ${TriggerMessage.Find[FIGHTER]}
						_Archetype:Set[fighter]
					;echo Archetype=${_Archetype}
					for(i:Set[0];${i}<${Me.Group};i:Inc)
					{
						;echo checking ${Me.Group[${i}].Name}:${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
						while ${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
						{
							RI_CMD_PauseCombatBots 1
							eq2ex useabilityonplayer ${Me.Group[${i}].Name} 2945678992
						}
					}
					RI_CMD_PauseCombatBots 0
				}
				wait 5
				if ${Me.Noxious}==0
					Trigger:Set[0]
			}
			wait 1
		}
	
	}
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,1]
	RI_Obj_CB:DoNotCastAE[0]
	RI_Obj_CB:DoNotCastEncounter[0]
	call RIObj.SingularFocus 0
	call EstirDeleteVariables
	echo ISXRI: Ending Twosome
}
function Estir(bool HerdMode=FALSE)
{
	variable string NamedName=""
	call EstirVariables
	if ${HerdMode}
		NamedName:Set[Taurine]
	else
		NamedName:Set[Estir]
		
	echo ISXRI: Starting ${NamedName}
	AnnounceText:Clear
	AnnounceText:Insert[ALL your SCOUTS I shall destroy]
	AnnounceText:Insert[ALL your MAGES I shall destroy]
	AnnounceText:Insert[ALL your PRIESTS I shall destroy]
	AnnounceText:Insert[ALL your FIGHTERS I shall destroy]
	AnnounceText:Insert[ALL your SCOUT I shall destroy]
	AnnounceText:Insert[ALL your MAGE I shall destroy]
	AnnounceText:Insert[ALL your PRIEST I shall destroy]
	AnnounceText:Insert[ALL your FIGHTER I shall destroy]
	AnnounceText:Insert[I shall destroy]
	
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,0]
	RI_Obj_CB:DoNotCastAE[1]
	RI_Obj_CB:DoNotCastEncounter[1]
	call RIObj.SingularFocus 1
	
	;;;also turn off wards bane

	variable int _EstirID

	variable string _Archetype
	variable int i
	variable int cnt=0
	
	while !${Actor[Query, Name=-"${NamedName} the Spiteful"].IsAggro}
	{
		Actor[Query, Name=-"${NamedName} the Spiteful"]:DoTarget
		eq2ex hail
		wait 10
	}
	wait 5
	_EstirID:Set[${Actor[Query, Name=-"${NamedName} the Spiteful" && IsDead=FALSE].ID}]
	call RIObj.LockAndPull ${_EstirID} "24.072706,-154.004944,-254.849579" 10 0
	wait 150 ${Me.Distance[24.072706,-154.004944,-254.849579]}<3
	variable int CircleID=0
	variable index:actor ActorIndex
	variable bool NearMe=FALSE
	variable bool NearCoffin=FALSE
	variable bool NearAltSpot1=FALSE
	variable bool NearAltSpot2=FALSE
	variable bool NearAltSpot3=FALSE
	variable bool Moved=FALSE
	variable string MoveLoc=""

	while ${Actor[Query, ID=${_EstirID} && IsDead=FALSE](exists)}
	{
		if ${Actor[Query, ID=${_EstirID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_EstirID},790]}].CurrentIncrements}>0
			call RIObj.MageAbsorbMagic ${_EstirID} -1
		;1 add is 100-75 2 75-50 3 50-25 4 25-0
		if ${RIObj.MobCount["of spite"]}==${Actor[Query, ID=${_EstirID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_EstirID},390]}].CurrentIncrements}
			call RIObj.Target ${_EstirID}
		else
			call RIObj.Target -LowestHealth "of spite" -Distance 30
		
		call EstirCircle
		
		if ${Trigger}
		{
			wait 50 ${Me.Noxious}==1
			wait 5
			;echo Trigger
			if ${Me.Archetype.Equal[priest]}
			{
				if ${TriggerMessage.Find[SCOUT]}
					_Archetype:Set[scout]
				if ${TriggerMessage.Find[MAGE]}
					_Archetype:Set[mage]
				if ${TriggerMessage.Find[PRIEST]}
					_Archetype:Set[priest]
				if ${TriggerMessage.Find[FIGHTER]}
					_Archetype:Set[fighter]
				;echo Archetype=${_Archetype}
				for(i:Set[0];${i}<${Me.Group};i:Inc)
				{
					;echo checking ${Me.Group[${i}].Name}:${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
					while ${RIObj.Archetype[${Me.Group[${i}].ID}].Equal[${_Archetype}]} && ${Me.Group[${i}].Noxious}==1
					{
						RI_CMD_PauseCombatBots 1
						eq2ex useabilityonplayer ${Me.Group[${i}].Name} 2945678992
					}
				}
				RI_CMD_PauseCombatBots 0
			}
			wait 5
			if ${Me.Noxious}==0
				Trigger:Set[0]
		}
		wait 1
	}
	
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,1]
	RI_Obj_CB:DoNotCastAE[0]
	RI_Obj_CB:DoNotCastEncounter[0]
	call RIObj.SingularFocus 0
	call EstirDeleteVariables
	echo ISXRI: Ending ${NamedName}
}
function EstirVariables()
{
	declare EstirCircleID int global -1
	declare EstirActorIndex index:actor global
	declare EstirNearMe bool global FALSE
	declare EstirNearCoffin bool global FALSE
	declare EstirNearAltSpot1 bool global FALSE
	declare EstirNearAltSpot2 bool global FALSE
	declare EstirNearAltSpot3 bool global FALSE
	declare EstirMoved bool global FALSE
	declare EstirMoveLoc string global
}
function EstirDeleteVariables()
{
	deletevariable EstirCircleID
	deletevariable EstirActorIndex
	deletevariable EstirNearMe
	deletevariable EstirNearCoffin
	deletevariable EstirNearAltSpot1
	deletevariable EstirNearAltSpot2
	deletevariable EstirNearAltSpot3
	deletevariable EstirMoved
	deletevariable EstirMoveLoc
}
function EstirCircle()
{
	variable int i=0
	
	if ${Actor[Query, Name=="" && Aura=="design_circle_warning_zone_gold"](exists)} && !${EstirMoved} && !${Actor[id,${EstirCircleID}](exists)}
		EQ2:QueryActors[EstirActorIndex, Name=="" && Aura=="design_circle_warning_zone_gold"]
	if !${Actor[id,${EstirCircleID}](exists)} && !${Actor[Query, Name=="" && Aura=="design_circle_warning_zone_gold"](exists)}
	{
		;echo clear
		EstirActorIndex:Clear
		EstirActorIndex:Collapse
		EstirNearMe:Set[FALSE]
		EstirNearCoffin:Set[FALSE]
		EstirNearAltSpot1:Set[FALSE]
		EstirNearAltSpot2:Set[FALSE]
		EstirNearAltSpot3:Set[FALSE]
		EstirMoved:Set[FALSE]
		EstirCircleID:Set[-1]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Name},24.072706,-154.004944,-254.849579,1,1000]
	}
	if ${EstirActorIndex.Used}>0
	{
		if !${EstirMoved}
		{
			for(i:Set[1];${i}<=${EstirActorIndex.Used};i:Inc)
			{
				;echo ${EstirActorIndex.Get[${i}].ID} ${Actor[${EstirActorIndex.Get[${i}].ID}](exists)} ${Actor[${EstirActorIndex.Get[${i}].ID}].Loc}
				if ${Actor[id,${EstirActorIndex.Get[${i}].ID}].Distance[${Me.Loc}]}<3
				{
					EstirNearMe:Set[TRUE]
					EstirCircleID:Set[${EstirActorIndex.Get[${i}].ID}]
				}
				if ${Actor[id,${EstirActorIndex.Get[${i}].ID}].Distance[30.781742,-151.346619,-255.389145]}<6
					EstirNearCoffin:Set[TRUE]
				if ${Actor[id,${EstirActorIndex.Get[${i}].ID}].Distance[23.280275,-154.004944,-247.915024]}<6
					EstirNearAltSpot1:Set[TRUE]
				if ${Actor[id,${EstirActorIndex.Get[${i}].ID}].Distance[17.282152,-154.004944,-254.631729]}<6
					EstirNearAltSpot2:Set[TRUE]
				if ${Actor[id,${EstirActorIndex.Get[${i}].ID}].Distance[23.226727,-154.004944,-261.511688]}<6
					EstirNearAltSpot3:Set[TRUE]
			}
			if !${EstirNearCoffin}
				EstirMoveLoc:Set["30.781742,-151.346619,-255.389145"]
			elseif !${EstirNearAltSpot1}
				EstirMoveLoc:Set["23.280275,-154.004944,-247.915024"]
			elseif !${EstirNearAltSpot2}
				EstirMoveLoc:Set["17.282152,-154.004944,-254.631729"]
			elseif !${EstirNearAltSpot3}
				EstirMoveLoc:Set["23.226727,-154.004944,-261.511688"]
			EstirMoved:Set[TRUE]
		}
		if ${Actor[id,${EstirCircleID}](exists)}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Name},${EstirMoveLoc},1,1000]
	}	
	;echo ${EstirActorIndex.Used}: ${EstirCircleID}: ${Actor[id,${EstirCircleID}].Name(exists)}: ${Actor[id,${EstirCircleID}].Name}
}

function Taurine()
{
	call Estir TRUE
}
;;;;;;;; End Shard of Hate: Utter Contempt
;;;;;;;; Start The Fabled Ruins of Guk: Halls of the Fallen
function Fropitpuzzle()
{
	call MessageBox "Complete this puzzle then resume RI"
}
function Kurpep()
{
	echo ISXRI: Starting Kurpep
	
	variable int _KurpepID=${Actor[Query, Name=-"Lord Kurpep" && IsDead=FALSE].ID}

	RIMUIObj:SetLockSpot[ALL,123.175743,-68.125626,-384.435394]
		
	while ${Actor[Query, ID=${_KurpepID} && IsDead=FALSE](exists)}
	{
		call RIObj.Target "a shin knight squire" -Distance 30 ${_KurpepID}

		if ${Me.Distance[123.240273,-23.597506,-421.110992]}<20
		{
			call LockAndWait -Loc 137.342636,-23.597490,-422.015961
			call LockAndWait -Loc 136.608795,-30.088062,-434.375610
			call LockAndWait -Loc 121.431099,-37.544575,-437.672333
			call LockAndWait -Loc 108.007477,-43.804741,-431.053528
			call LockAndWait -Loc 123.175743,-68.125626,-384.435394
		}
		
		waitframe
	}
	
	echo ISXRI: Ending Kurpep
}
;;;;;;;; End The Fabled Ruins of Guk: Halls of the Fallen
function Blood()
{
	echo ISXRI: Starting Blood 
	
	if !${RI_Var_Bool_GlobalOthers}
	{
		call LockAndWait -Loc -0.520629,238.989075,-78.876534 -RelayToGroup
	}
	variable int _BloodID=${Actor[Query, Name=-"Blood Ro" && IsDead=FALSE].ID}
	Actor[Query, ID=${_BloodID} && IsDead=FALSE]:DoTarget
	
	while ${Actor[Query, ID=${_BloodID} && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[Query, ID=${_BloodID} && IsDead=FALSE](exists)}
			{
				if ${Target.ID}!=${_BloodID}
					Actor[Query, ID=${_BloodID} && IsDead=FALSE]:DoTarget
			}
		}
		wait 1
	}
	if !${RI_Var_Bool_GlobalOthers}
		call RIMObj.follow
	echo ISXR: Ending Blood
}

function Nfaprotect()
{
	echo ISXRI: Starting Innoruk Protect
	variable bool _Done=FALSE
	AnnounceText:Insert["You must seal the crack that has formed in the shield"]
	RIMUIObj:SetLockSpot[ALL,-1392.000000,30.500000,-1345.000000]
	wait 600 ${Actor[Saryrn](exists)}
	while !${Actor[Query, Name=-"Enter shard of hate"](exists)} || ${Actor["fx for crack in barrier"](exists)}
	{
		if ${Trigger} && ${TriggerMessage.Find["You must seal the crack that has formed in the shield"](exists)}
		{
			while ${Actor[Wellspring of Hate].HighlightOnMouseHover}
				Actor[Wellspring of Hate]:DoubleClick
			wait 50
			call LockAndWait -Loc ${Actor["fx for crack in barrier"].Loc}
			while ${Actor["fx for crack in barrier"](exists)}
				Actor["fx for crack in barrier"]:DoubleClick
			Trigger:Set[0]
			RIMUIObj:SetLockSpot[ALL,-1392.000000,30.500000,-1345.000000]
		}
		wait 1
	}
	wait 50
	eq2ex camp
	wait 2
	press ${RI_Var_String_JumpKey}
	press ${RI_Var_String_JumpKey}
	press ${RI_Var_String_JumpKey}
	wait 2
	press ${RI_Var_String_JumpKey}
	press ${RI_Var_String_JumpKey}
	press ${RI_Var_String_JumpKey}
	echo ISXRI: Ending Innoruk Protect
}
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; End OF POP Heroic CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; Start of POP RAID CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
function Alpha()
{
	echo ISXRI: Starting Alpha
	variable int _AlphaID=${Actor[Query, Name=-"Tin Overseer Alpha" && IsDead=FALSE].ID}
	Event[EQ2_onIncomingText]:AttachAtom[EQ2_onIncomingText]
	IncomingText:Clear
	IncomingText:Insert["Prepares to fire molten slag"]
	IncomingText:Insert["directly in front of him"]
	
	;set lockspot
	if !${Me.Archetype.Equal[fighter]}
		RIMUIObj:SetLockSpot[ALL,-16.32,3.67,-116.78]
		
	while ${Actor[Query, ID=${_AlphaID} && IsDead=FALSE](exists)}
	{
		if !${Me.Archetype.Equal[fighter]}
		{
			if ${Trigger}
			{
				Trigger:Set[FALSE]
				if ${TriggerMessage.Find[Prepares to fire molten slag]}
					RIMUIObj:SetLockSpot[ALL,-37.92,3.67,-107.29]
				else
					RIMUIObj:SetLockSpot[ALL,-16.32,3.67,-116.78]
			}
		}
		wait 2
	}
	echo ISXRI: Ending Alpha 
}
function Omega()
{
	echo ISXRI: Starting Omega
	variable int _OmegaID=${Actor[Query, Name=-"Tin Overseer Omega" && IsDead=FALSE].ID}
	Event[EQ2_onIncomingText]:AttachAtom[EQ2_onIncomingText]
	IncomingText:Clear
	IncomingText:Insert["Prepares to fire molten slag"]
	IncomingText:Insert["directly behind him"]
	
	;set lockspot
	if !${Me.Archetype.Equal[fighter]}
		RIMUIObj:SetLockSpot[ALL,44.716545,3.654284,-36.545380]
		
	while ${Actor[Query, ID=${_OmegaID} && IsDead=FALSE](exists)}
	{
		if !${Me.Archetype.Equal[fighter]}
		{
			if ${Trigger}
			{
				Trigger:Set[FALSE]
				if ${TriggerMessage.Find[Prepares to fire molten slag]}
					RIMUIObj:SetLockSpot[ALL,75.860336,3.421775,-37.136383]
				else
					RIMUIObj:SetLockSpot[ALL,44.716545,3.654284,-36.545380]
			}
		}
		wait 2
	}
	echo ISXRI: Ending Omega 
}
function Rankle()
{
	echo ISXRI: Starting Rankle
	variable int _RankleID=${Actor[Query, Name=-"Rankle" && IsDead=FALSE].ID}
	variable string _LockSpot
	Event[EQ2_onIncomingText]:AttachAtom[EQ2_onIncomingText]
	IncomingText:Clear
	IncomingText:Insert["Rankle goes on a RAMPAGE!"]
	
	;set lockspot
	if !${Me.Archetype.Equal[fighter]}
		RIMUIObj:SetLockSpot[ALL,-174.549026,125.979256,-309.719635]
		
	while ${Actor[Query, ID=${_RankleID} && IsDead=FALSE](exists)}
	{
		if ${Trigger}
		{
			Trigger:Set[FALSE]
			if ${Math.Distance[${Me.Loc},-174.549026,125.979256,-309.719635]}<30
				_LockSpot:Set["-76.386551,126.687584,-287.438293"]
			else
				_LockSpot:Set["-174.549026,125.979256,-309.719635"]
			RIMUIObj:SetLockSpot[ALL,${_LockSpot}]
			wait 300 ${Math.Distance[${Me.Loc},${_LockSpot}]}<3
			wait 5
			if ${Me.Archetype.Equal[fighter]}
				RIMUIObj:SetLockSpot[OFF]
		}
		wait 2
	}
	echo ISXRI: Ending Rankle 
}
function Bleeder()
{
	echo ISXRI: Starting Bleeder
	variable int _BleederID=${Actor[Query, Name=-"Bleeder of Ire" && IsDead=FALSE].ID}
	Event[EQ2_onIncomingText]:AttachAtom[EQ2_onIncomingText]
	IncomingText:Clear
	IncomingText:Insert["prepares himself to spray poisonous liquid in"]
	
	;set lockspot
	;if !${Me.Archetype.Equal[fighter]}
	;	RIMUIObj:SetLockSpot[ALL,44.716545,3.654284,-36.545380]
		
	while ${Actor[Query, ID=${_BleederID} && IsDead=FALSE](exists)}
	{
		if ${Trigger}
		{
			Trigger:Set[FALSE]
			if ${TriggerMessage.Find[BEHIND]}
			{
				RIMUIObj:SetLockSpot[OFF]
				RI_Var_Bool_MoveInFrontIgnoreAggroCheck:Set[1]
				call MoveBehind 0
				call MoveInFront 1
				RI_Var_Bool_MoveInFrontIgnoreAggroCheck:Set[1]
				wait 30
				RI_Var_Bool_MoveInFrontIgnoreAggroCheck:Set[0]
				call MoveInFront 0
				RI_Var_Bool_MoveInFrontIgnoreAggroCheck:Set[0]
				if !${Me.Archetype.Equal[fighter]}
					call MoveBehind 1
			}
			else
			{
				RIMUIObj:SetLockSpot[OFF]
				RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[1]
				call MoveBehind 1
				RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[1]
				wait 30
				RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
				RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
				if ${Me.Archetype.Equal[fighter]}
					call MoveBehind 0
			}
			Trigger:Set[FALSE]
		}
		wait 2
	}
	echo ISXRI: Ending Bleeder 
}
function Karnah()
{
	echo ISXRI: Starting Karnah
	variable int _KarnahID=${Actor[Query, Name=-"Karnah" && IsDead=FALSE].ID}

	;set lockspot
	if !${Me.Archetype.Equal[fighter]}
		RIMUIObj:SetLockSpot[ALL,-110.423981,4.213838,-197.020660]
		
	while ${Actor[Query, ID=${_KarnahID} && IsDead=FALSE](exists)}
	{
		if !${Me.Archetype.Equal[fighter]}
		{
			if ${Me.RaidGroupNum}==1 && ${Me.Class.Equal[bard]}
			{
				if ${RIObj.MainIconIDExists[${Me.ID},0]}
				{
					RIMUIObj:SetLockSpot[ALL,-110.423981,4.213838,-197.020660]
				}
				else
				{
					RIMUIObj:SetLockSpot[ALL,-116.499802,4.213838,-196.189377]
				}
			}
		}
		wait 2
	}
	echo ISXRI: Ending Karnah 
}
function Culler()
{
	echo ISXRI: Starting Culler
	variable int _CullerID=${Actor[Query, Name=-"Culler of Bones" && IsDead=FALSE].ID}

	;set lockspot
	if !${Me.Archetype.Equal[fighter]}
		RIMUIObj:SetLockSpot[ALL,45.137691,0.528494,273.621582]
		
	while ${Actor[Query, ID=${_CullerID} && IsDead=FALSE](exists)}
	{
		if !${Me.Archetype.Equal[fighter]} && !${Me.Archetype.Equal[priest]}
		{
			if ${RIMUIObj.MainIconIDExists[${Me.ID},59]}
			{
				RIMUIObj:SetLockSpot[ALL,45.822720,0.202834,299.144958]
			}
			elseif ${RIMUIObj.MainIconIDExists[${Me.ID},247]}
			{
				RIMUIObj:SetLockSpot[ALL,45.822720,0.202834,299.144958]
			}
			else
			{
				RIMUIObj:SetLockSpot[ALL,45.137691,0.528494,273.621582]
			}
		}
		wait 10
	}
	echo ISXRI: Ending Culler 
}
function Ire()
{
	echo ISXRI: Starting Ire
	
	variable int _IreID=${Actor[Query, Name=-"Lord of Ire" && IsDead=FALSE].ID}
	variable int _SpecialID
	variable int _cnt
	if !${Me.Archetype.Equal[fighter]}
	{
		RIMUIObj:SetLockSpot[ALL,-206.850769,19.005644,-3.333212]
	}

	if ${Me.Archetype.Equal[priest]}
		RI_CMD_AbilityEnableDisable "Cure Curse" 0
		
	while ${Actor[Query, ID=${_IreID} && IsDead=FALSE](exists)}
	{
		while ${Me.Cursed}==1
		{
			RI_CMD_Assist 0
			RI_CMD_PauseCombatBots 1
			if ${Me.Inventory[Query, Location=="Inventory" && Name=="a sharp stitching knife"](exists)}
			{
				RIMUIObj:SetLockSpot[ALL,-206.850769,19.005644,-3.333212]
				for(_cnt:Set[1];${_cnt}<=${Me.Raid};_cnt:Inc)
				{
					while ${Me.Raid[${_cnt}].Cursed}==-1 && ${Me.Inventory[Query, Location=="Inventory" && Name=="a sharp stitching knife"](exists)}
					{
						Me.Raid[${_cnt}]:DoTarget
						Me.Inventory[Query, Location=="Inventory" && Name=="a sharp stitching knife"]:Use
						wait 1
					}
				}				
			}
			elseif ${Actor[Query, Type=="special" && TintFlags=22286 && Distance<75](exists)}
			{
				_SpecialID:Set[${Actor[Query, Type=="special" && TintFlags=22286 && Distance<75].ID}]
				RIMUIObj:SetLockSpot[ALL,${Actor[id,${_SpecialID}].Loc}]
				wait 50 ${Me.Distance[${Actor[id,${_SpecialID}].Loc}]}<3
				while ${Actor[id,${_SpecialID}](exists)}
				{
					Actor[id,${_SpecialID}]:DoubleClick
					wait 1
				}
			}
			wait 1
		}
		if !${Me.Archetype.Equal[fighter]}
		{
			RIMUIObj:SetLockSpot[ALL,-206.850769,19.005644,-3.333212]
		}
		RI_CMD_Assist 1
		RI_CMD_PauseCombatBots 0
		wait 1
	}
	if ${Me.Archetype.Equal[priest]}
		RI_CMD_AbilityEnableDisable "Cure Curse" 1
	echo ISXRI: Ending Ire
}
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; End of POP RAID CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; Start of CD Zone CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
function CustomNamed(string _NamedsName, string _LockSpot, string _CustomLoop=NONE, ... args)
{	
	variable bool _MB=TRUE
	variable bool _NLP=FALSE
	variable bool _NLC=FALSE
	variable bool _INC=FALSE
	variable bool _WM=TRUE
	variable string _NamedName
	_NamedName:Set["${_NamedsName}"]
	while ${_NamedName.Right[4].Equal[-NWM]} || ${_NamedName.Right[4].Equal[-INC]} || ${_NamedName.Right[4].Equal[-NMB]} || ${_NamedName.Right[4].Equal[-NLP]} || ${_NamedName.Right[4].Equal[-NLC]}
	{
		if ${_NamedName.Right[4].Equal[-NWM]}
		{
			;echo setting no wait mob
			_WM:Set[FALSE]
			_NamedName:Set["${_NamedName.Left[-4]}"]
		}
		elseif ${_NamedName.Right[4].Equal[-INC]}
		{
			;echo setting loop while me.incombat
			_INC:Set[TRUE]
			_NamedName:Set["${_NamedName.Left[-4]}"]
		}
		elseif ${_NamedName.Right[4].Equal[-NMB]}
		{
			;echo setting no move behind
			_MB:Set[FALSE]
			_NamedName:Set["${_NamedName.Left[-4]}"]
		}
		elseif ${_NamedName.Right[4].Equal[-NLP]}
		{
			;echo setting no lock and pull
			_NLP:Set[TRUE]
			_NamedName:Set["${_NamedName.Left[-4]}"]
		}
		elseif ${_NamedName.Right[4].Equal[-NLC]}
		{
			;echo setting no loot chest
			_NLC:Set[TRUE]
			_NamedName:Set["${_NamedName.Left[-4]}"]
		}
		wait 1
	}
	
	variable int _NamedID=0
	_NamedID:Set[${Actor[Query, Name=-"${_NamedName}" && IsDead=FALSE && ( Type=="NamedNPC" || Type=="NPC" )].ID}]
	wait 2
	if ${_NamedID}==0
		_NamedID:Set[${Actor[Query, Name=-"${_NamedName}" && IsDead=FALSE && ( Type=="NamedNPC" || Type=="NPC" )].ID}]
	wait 2
	if ${_NamedID}==0 && !${_INC} && !${Actor[Query, Name=-"${_NamedName}" && IsDead=FALSE && ( Type=="NamedNPC" || Type=="NPC" )](exists)}
	{
		echo ISXRI: ${Time} ${_NamedName} already dead, Moving on
		return
	}
	
	echo ISXRI: Starting ${_NamedName} @ ${Time}

	variable bool _CustomLoopCheck=FALSE
	variable bool _AddsCheck=FALSE
	if ${_CustomLoop.NotEqual[NONE]}
		_CustomLoopCheck:Set[TRUE]
	
	if ${_NLP}
	{
		noop
	}
	else
	{
		call RIObj.LockAndPull ${_NamedID} "${_LockSpot}" 10 ${_MB} ${_WM}
	}	
	if ${args.Used}>0
	{
		_AddsCheck:Set[TRUE]
		variable string _Adds=""
		variable int _acnt
		for(_acnt:Set[1];${_acnt}<=${args.Used};_acnt:Inc)
		{
			if ${_acnt}==1
			{
				_Adds:Concat["\"${args[${_acnt}]}\" -Distance 15"]
			}
			else
			{
				_Adds:Concat[" \"${args[${_acnt}]}\" -Distance 15"]
			}
		}
	}
		
	while ${Actor[Query, ID=${_NamedID} && IsDead=FALSE](exists)} || ${EQ2.Zoning} || ${Me.IsDead} || ( ${_INC} && ${Me.InCombatMode} )
	{
		if ${_NamedID}==0
		{
			if ${_CustomLoopCheck}
				call ${_CustomLoop} "${_NamedName}"
			elseif ${_AddsCheck}
				call RIObj.Target ${_Adds} "${_NamedName}"
			else
				call RIObj.Target "${_NamedName}"
		}
		else
		{
			if ${_CustomLoopCheck}
				call ${_CustomLoop} ${_NamedID}
			elseif ${_AddsCheck}
			{
				if ${Zone.Name.Find[Solo]}
				{
					if ${Me.Archetype.NotEqual[priest]} && ${RIMUIObj.Archetype[${Me.Group[1].ID}].NotEqual[priest]}
					{
						call CheckCures
					}
				}
				call RIObj.Target ${_Adds} ${_NamedID}
			}
			else
			{
				if ${Zone.Name.Find[Solo]}
				{
					if ${Me.Archetype.NotEqual[priest]} && ${RIMUIObj.Archetype[${Me.Group[1].ID}].NotEqual[priest]}
					{
						call CheckCures
					}
				}
				call RIObj.Target ${_NamedID}
			}
		}	
		;Mortal Coil 205
		call RIObj.Dispell ${_NamedID} 205 1
		;Mortal Coil 205
		call RIObj.Dispell ${_NamedID} 45 1
		waitframe
	}
	call MoveBehind 0
	wait 5
	wait 45 !${Me.IsMoving}
	if !${_NLC} && !${RI_Var_Bool_GlobalOthers} && ${Actor[Chest,radius,100](exists)} && ${Me.WaterDepth}==0 && !${Me.FlyingUsingMount} && !${RI_Var_Bool_SkipLoot}
	{
		eq2ex summon
		wait 2
		call RIMObj.LootChest
		wait 2
		eq2ex summon
	}
	wait 50 !${Me.IsMoving}
	call MoveBehind 0
	echo ISXRI: Ending ${_NamedName} @ ${Time}
}
;;;;;;;; Start Doomfire: The Enkindled Towers

function Kreigor()
{
	call CustomNamed "Kreigor" "-175.295563,6.156166,-118.107635"
}
function Morgelon()
{
	call CustomNamed "Morgelon-NMB" "-365.285767,42.254482,111.615089" NONE greater
}
function Moracar()
{
	call CustomNamed "Moracar" "-361.282257,45.333508,398.198120"
}
function Pyrefist()
{
	call CustomNamed "Pyrefist" "-247.989517,88.125168,403.498596"
}
function Ra-Sekjet()
{
	call Rasekjet
}
function Rasekjet()
{
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-369.917847,61.162582,-334.167633,1,1000]
	Actor[Ra-Sekjet]:DoTarget
	wait 600 ${Actor[Ra-Sekjet].Distance}<15
	call CustomNamed "Ra-Sekjet-NMB" "-398.946686,61.162582,-305.215607" NONE Jel-Ekset Jek-Setek
	;;;;; for custom stuff inside the while loop we can send a 3rd optional variable of a function name to call in the loop where we can add custom stuffs
}
;function Rasekjetcustom()
;{
	;call RIObj.Target Jel-Ekset Jek-Setek Ra-Sekjet
	
	; if ${Me.Distance[-366.707642,61.162582,-337.365082]}>34 && ${Me.Distance[-405.399506,59.252144,-299.038452]}>3
	; {
		; RIMUIObj:SetLockSpot[ALL,-405.399506,59.252144,-299.038452,1,1000]
		; wait 150 ${Me.Distance[-405.399506,59.252144,-299.038452]}<3
		; RIMUIObj:SetLockSpot[ALL,-366.707642,61.162582,-337.365082,1,1000]
		; wait 150 ${Me.Distance[-366.707642,61.162582,-337.365082]}<30
	; }
	; else
		; RIMUIObj:SetLockSpot[ALL,-366.707642,61.162582,-337.365082,1,1000]
;}
;;;;;;;; End Doomfire: The Enkindled Towers

;;;;;;;; Start Eryslai: The Bixel Hive

function Matron()
{
	DeclareVariable Matroncustomjousttime int script -15000
	DeclareVariable Matroncustomjoust int script 0
	call CustomNamed "The Matron of Mists-NMB" "155.892166,-226.879654,-1157.098511" Matroncustom
	DeleteVariable Matroncustomjousttime
	DeleteVariable Matroncustomjoust
}
function Matroncustom(int _NamedID)
{
	call RIObj.Target spren -Distance 20 ${_NamedID}
	if ${RIMUIObj.MainIconIDExists[${Me.ID},126,1]} && ${Script.RunningTime}>${Math.Calc[${Matroncustomjousttime}+15000]}
	{
		Matroncustomjousttime:Set[${Script.RunningTime}]
		if ${Matroncustomjoust}==0
		{
			RIMUIObj:SetLockSpot[ALL,160.020599,-228.727844,-1147.727539]
			Matroncustomjoust:Set[1]
		}
		else
		{
			RIMUIObj:SetLockSpot[ALL,155.892166,-226.879654,-1157.098511]
			Matroncustomjoust:Set[0]
		}
	}
}
function Anzarion()
{
	if !${Zone.Name.Find["[Solo]"](exists)}
	{
		Me.Ability[id,1571882540]:Use
		wait 2
	}
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Anzarion].Loc},20,1000]
	Actor[Anzarion]:DoTarget
	wait 600 ${Actor[Anzarion].Distance}<15
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,175.364059,-227.521606,-1042.660034,1,1000]
	wait 600 ${Me.Distance[175.364059,-227.521606,-1042.660034]}<3
	call CustomNamed "Anzarion-NMB" "175.364059,-227.521606,-1042.660034" Anzarioncustom
}
function Anzarioncustom()
{
	if ${Me.WaterDepth}>=3
		call SwimUp
	call RIObj.Target wind -Distance 30 air -Distance 30 servitor -Distance 30 flutterwasp -Distance 30 spren -Distance 30 nilborien -Distance 30 Anzarion
}
function Daishani()
{
	Actor[Daishani]:DoTarget
	wait 600 ${Actor[Daishani].Distance}<15
	call CustomNamed "Daishani-NMB" "-623.07,403.74,-160.23" NONE bodyguard bixel
}
function Bzzkill()
{
	call CustomNamed "Bzzkill the Honeymonger-NMB" "-655.700867,525.024841,-325.854614" Bzzkillcustom
}
function Bzzkillcustom()
{
	noop
	;Interrupts
	;Beastlord: Sharpened Claws
	;Monk: Challenge,
}
function Aurorax()
{
	echo ISXRI: Pulling Aurorax
	if ${Zone.Name.Find["[Solo]"](exists)}
	{
		call JumpOver -492.960205 640.662659 -173.889542 88 FALSE
		wait 50
	}
	else
	{
		RI_CMD_AbilityEnableDisable "Mantis Leap" 0
		while ${Me.Distance[-554.813965,647.868713,-171.740997]}>10
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,OFF]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetRIFollow[ALL,OFF]
			Actor["a hive queensguard elite"]:DoTarget
			wait 1
		}
		wait 5
		RI_CMD_AbilityEnableDisable "Mantis Leap" 1
	}

	call CustomNamed "Aurorax-NMB" "-554.813965,647.868713,-171.740997"
	wait 50
}
function Erylsaisigcheck()
{
	if ${QuestJournalWindow.ActiveQuest[Elements of Destruction: Pure Adventure](exists)}
		MainArrayCounter:Set[362]
}
;;;;;;;; End Eryslai: The Bixel Hive

;;;;;;;; Start Awuidor: The Nebulous Deep

function Glaucos()
{
	call CustomNamed "Glaucos of the Sink" "0.665457,630.328674,-1221.874512"
}
function Nehalenea()
{
	call CustomNamed "Nehalenea Frostbringer" "0.477443,630.328674,1214.628418" NONE nereid
}
function Pontis()
{
	call CustomNamed "Pontis Aqueous-NMB" "-1295.339355,630.813599,21.386145"
}
function Oceanus()
{
	if ${Zone.Name.Find["[Solo]"](exists)}
	{
		RIMUIObj:SetLockSpot[ALL,1343.879028,409.448853,21.939520]
		Actor[Oceanus]:DoTarget
		wait 600 ${Me.Distance[1343.879028,409.448853,21.939520]}<5
		press shift+r
		wait 2
		press ${RI_Var_String_CrouchKey}
		call CustomNamed "Oceanus the Titan-NMB" "1343.879028,409.448853,21.939520" NONE urchin
		press shift+r
		press ${RI_Var_String_JumpKey}
		RIMUIObj:SetLockSpot[ALL,1358.145508,409.294739,22.402372]
		wait 600 ${Me.Distance[1358.145508,409.294739,22.402372]}<5
	}
	else
	{
		if ${Me.Archetype.Equal[priest]}
		{
			call Groupwaterbreathing 1
		}
		else
		{
			wait 50
		}
		call PreHeal
		call CustomNamed "Oceanus the Titan-NMB" "1358.145508,409.294739,22.402372" NONE urchin
		if ${Me.Class.Equal[shaman]}
		{
			call Groupwaterbreathing 0
		}
		else
		{
			wait 50
		}
		RIMUIObj:SetLockSpot[ALL,1343.195801,409.025757,22.282162]
		wait 600 ${Me.Distance[1343.195801,409.025757,22.282162]}<5
		wait 50 ${Me.IsMoving}
		if !${RI_Var_Bool_GlobalOthers} && ${Actor[Chest,radius,100](exists)} && ${Me.WaterDepth}==0 && !${Me.FlyingUsingMount} 
		{
			eq2ex summon
			wait 2
			call RIMObj.LootChest
			wait 2
			eq2ex summon
		}
		wait 50
		RIMUIObj:SetLockSpot[ALL,1358.145508,409.294739,22.402372]
		wait 600 ${Me.Distance[1358.145508,409.294739,22.402372]}<5
	}
}
function Aegaeon()
{
	call CustomNamed "Aegaeon" "1265.840698,630.328674,21.185741" NONE eel
}
function Groupwaterbreathing(int OnOff=1)
{
	variable string _GroupWaterBreathingSpellID
	variable string _GroupWaterBreathingSpellName
	switch ${Me.SubClass}
	{
		case Mystic
		{
			_GroupWaterBreathingSpellID:Set[2417710155]
			_GroupWaterBreathingSpellName:Set["Water Spirit"]
			break
		}
		case Defiler
		{
			_GroupWaterBreathingSpellID:Set[2155985140]
			_GroupWaterBreathingSpellName:Set[Abominus]
			break
		}
		case Warden
		{
			_GroupWaterBreathingSpellID:Set[1338465399]
			_GroupWaterBreathingSpellName:Set["Nereid's Boon"]
			break
		}
		case Fury
		{
			_GroupWaterBreathingSpellID:Set[1593870690]
			_GroupWaterBreathingSpellName:Set["Ferocity of the Eel"]
			break
		}
		case Templar
		{
			_GroupWaterBreathingSpellID:Set[503186570]
			_GroupWaterBreathingSpellName:Set["Watery Respite"]
			break
		}
		case Inquisitor
		{
			_GroupWaterBreathingSpellID:Set[3002991865]
			_GroupWaterBreathingSpellName:Set[Swill]
			break
		}
		case Channeler
		{
			_GroupWaterBreathingSpellID:Set[2250991888]
			_GroupWaterBreathingSpellName:Set["Oxygen Tunnel"]
			break
		}
	}
	if ${OnOff}>0
	{
		RI_CMD_PauseCombatBots 1
		wait 1
		eq2ex clearabilityqueue
		eq2ex cancel_spellcast
		wait 1
		while ${Me.Ability[id,${_GroupWaterBreathingSpellID}].IsReady} || ${Me.Ability[id,${_GroupWaterBreathingSpellID}].TimeUntilReady}>0
		{
			Me.Ability[id,${_GroupWaterBreathingSpellID}]:Use
			wait 5 ${Me.CastingSpell}
			wait 100 !${Me.CastingSpell} || ${Me.GetGameData[Spells.Casting].Label.NotEqual[${_GroupWaterBreathingSpellName}]}
			wait 5
		}
		RI_CMD_PauseCombatBots 0
	}
	else
	{
		while !${Me.Ability[id,${_GroupWaterBreathingSpellID}].IsReady} && ${Me.Ability[id,${_GroupWaterBreathingSpellID}].TimeUntilReady}==0
		{
			RI_CMD_PauseCombatBots 1
			wait 1
			eq2ex clearabilityqueue
			eq2ex cancel_spellcast
			wait 1
			Me.Ability[id,${_GroupWaterBreathingSpellID}]:Use
			wait 5 ${Me.CastingSpell}
			eq2ex clearabilityqueue
			eq2ex cancel_spellcast
			Me.Maintained[${_GroupWaterBreathingSpellName}]:Cancel
			wait 1
			RI_CMD_PauseCombatBots 0
		}
	}
	
}
;;;;;;;; End Awuidor: The Nebulous Deep
;;;;;;;; Start Vegarlson: Council's Stronghold
function VegarlsonPedestal1()
{
	call MessageBox "Finish this part and resume RI in the middle of the room"
}
function VegarlsonPedestal2()
{
	call MessageBox "Finish this part and resume RI in the middle of the room"
}
function VegarlsonPedestal3()
{
	call MessageBox "Finish this part and resume RI in the middle of the room"
}
function VegarlsonPedestal4()
{
	call MessageBox "Finish this part and resume RI in the middle of the room"
}
function Gravelly()
{
	call CustomNamed "The Great Gravelly One" "864.773010,62.538113,39.231789"
}
function Gravel()
{
	declare _Loc string script "${Actor["Guardian of Gravel"].Loc}"
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Loc},1,1000]
	wait 600 ${Me.Distance[${_Loc}]}<15
	call CustomNamed "Guardian of Gravel-NMB" "0,0,0" GravelCustom
	eq2ex apply_verb ${Actor[Guardian of Gravel].ID} Loot
	eq2ex apply_verb ${Actor[corpse,radius,10].ID} Loot
	Actor[Guardian of Gravel]:DoubleClick
	Actor[corpse,radius,10]:DoubleClick
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,1837.585449,62.538094,-346.332428,1,1000]
	wait 600 ${Me.Distance[1837.585449,62.538094,-346.332428]}<5
	deletevariable _Loc
}
function GravelCustom()
{
	if ${Actor[Guardian of Gravel].Distance}>30
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor["Guardian of Gravel"].Loc},1,1000]
}
function Stones()
{
	declare _Loc string script "${Actor["Guardian of Stones"].Loc}"
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Loc},1,1000]
	wait 600 ${Me.Distance[${_Loc}]}<15	
	call CustomNamed "Guardian of Stones-NMB" "0,0,0" GravelCustom
	eq2ex apply_verb ${Actor[Guardian of Stones].ID} Loot
	eq2ex apply_verb ${Actor[corpse,radius,10].ID} Loot
	Actor[Guardian of Stones]:DoubleClick
	Actor[corpse,radius,10]:DoubleClick
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,1745.791260,274.850769,-249.824219,1,1000]
	wait 600 ${Me.Distance[1745.791260,274.850769,-249.824219]}<5
	deletevariable _Loc
}
function StonesCustom()
{
	if ${Actor[Guardian of Stones].Distance}>30
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor["Guardian of Stones"].Loc},1,1000]
}
function Aggregahn()
{
	IncomingText:Insert["I can destroy as easily as I can build"]
	call CustomNamed "Aggregahn-NMB" "1049.241089,274.857239,39.656723" AggregahnCustom
}
function AggregahnCustom()
{
	if ${Me.Inventory["Ethereal Stones"].TimeUntilReady}==-1 && ${Trigger}
	{
		RI_CMD_PauseCombatBots 1
		eq2ex cancel_spellcast
		wait 2
		Me.Inventory["Ethereal Stones"]:Use
		wait 10
		RI_CMD_PauseCombatBots 0
		Trigger:Set[0]
	}
}
function Soil()
{
	call CustomNamed "Guardian of Soil-NMB" "737.025269,13.631195,-466.546753"
}
function Escargore()
{
	call CustomNamed "Escargore-NMB" "737.025269,13.631195,-466.546753"
}
function Lesha()
{
	call CustomNamed "Lesha Needleleaf-NMB" "1419.217285,635.438538,39.106037"
}
function Council()
{
	declare _Item string script "Severed Ethereal Gravel"
	call CustomNamed "Council of Gravel-NMB" "1424.553345,784.928284,38.462822" CouncilCustom
	_Item:Set["Severed Ethereal Stones"]
	call CustomNamed "Council of Stone-NMB" "1424.553345,784.928284,38.462822" CouncilCustom
	_Item:Set["Severed Ethereal Soil"]
	call CustomNamed "Council of Soil-NMB" "1424.553345,784.928284,38.462822" CouncilCustom
	_Item:Set["Severed Ethereal Leaves"]
	call CustomNamed "Council of Leaves-NMB" "1424.553345,784.928284,38.462822" CouncilCustom
	deletevariable _Item
}
function CouncilCustom()
{
	if ${Me.Inventory["${_Item}"].TimeUntilReady}==-1
	{
		RI_CMD_PauseCombatBots 1
		eq2ex cancel_spellcast
		wait 2
		Me.Inventory["${_Item}"]:Use
		wait 15
		RI_CMD_PauseCombatBots 0
	}
}

;;;;;;;; End Vegarlson: Council's Stronghold
;;;;;;;; Start Vegarlson: Ruins of Rathe
function Glimmerstone()
{
	StopForCombat:Set[FALSE]
	AnnounceText:Clear
	AnnounceText:Insert[Glimmerstone seeks protection within the stones]
	Trigger:Set[TRUE]
	declare GlimmerstoneTriggerCount int global 0
	declare GlimmerstoneRunicID int global 0
	call CustomNamed "Glimmerstone-NMB" "-290.706360,37.276058,-225.688644" GlimmerstoneCustom
	call RIMObj.Move -337.707092 37.278160 -244.253540
	call RIMObj.Move -296.475159 34.322292 -263.796967
	call RIMObj.Move -285.583710 38.303368 -259.535370
	call RIMObj.Move -292.640289 37.276058 -244.154648
	call RIMObj.Move -289.182892 37.276058 -230.824738
	DeleteVariable GlimmerstoneTriggerCount
	DeleteVariable GlimmerstoneRunicID
	StopForCombat:Set[TRUE]
	;;have to move to and kill runic stones every time he is in pillars then, put this in function GlimmerstoneCustom then send that as the customloop
	;13:22:42:Announce: Glimmerstone seeks protection within the stones!
	;just move to and kill the stones he will come to you
}
function GlimmerstoneCustom()
{
	call RIObj.Target "Glimmerstone"
	
	if ${Trigger}
	{
		GlimmerstoneTriggerCount:Inc
		switch ${GlimmerstoneTriggerCount}
		{
			case 1
			{
				call RIMObj.Move -305.970490 36.056591 -177.409592
				call RIMObj.Move -319.988098 36.691917 -173.739548
				;echo 1
				CustomLoc:Set[0 0 0]
				call ClickActor -Actor "Runic Stone"
				;echo 2
				GlimmerstoneRunicID:Set[${Actor[Runic Stone].ID}]
				Actor[${GlimmerstoneRunicID}]:DoTarget
				wait 600 ${Actor[id,${GlimmerstoneRunicID}].IsDead}
				call RIMObj.Move -305.970490 36.056591 -177.409592
				wait 50
				;echo 3
				if ${Actor[Glimmerstone].Distance}>7
					call RIMObj.Move ${Actor[Glimmerstone].X} ${Actor[Glimmerstone].Y} ${Actor[Glimmerstone].Z} 5
				break
			}
			case 2
			{
				call RIMObj.Move -305.970490 36.056591 -177.409592
				call RIMObj.Move -271.679840 35.303829 -183.568771
				call RIMObj.Move -241.667984 32.203972 -170.113388
				CustomLoc:Set[0 0 0]
				call ClickActor -Actor "Runic Stone"
				GlimmerstoneRunicID:Set[${Actor[Runic Stone].ID}]
				Actor[${GlimmerstoneRunicID}]:DoTarget
				wait 600 ${Actor[id,${GlimmerstoneRunicID}].IsDead}
				wait 50
				if ${Actor[Glimmerstone].Distance}>7
				call RIMObj.Move ${Actor[Glimmerstone].X} ${Actor[Glimmerstone].Y} ${Actor[Glimmerstone].Z} 5
				
				break
			}
			case 3
			{
				call RIMObj.Move -241.667984 32.203972 -170.113388
				call RIMObj.Move -260.762085 37.099854 -187.359192
				call RIMObj.Move -257.820587 41.555885 -205.775024
				call RIMObj.Move -230.700089 31.522518 -242.292999
				CustomLoc:Set[0 0 0]
				call ClickActor -Actor "Runic Stone"
				GlimmerstoneRunicID:Set[${Actor[Runic Stone].ID}]
				Actor[${GlimmerstoneRunicID}]:DoTarget
				wait 600 ${Actor[id,${GlimmerstoneRunicID}].IsDead}
				wait 50
				if ${Actor[Glimmerstone].Distance}>7
					call RIMObj.Move ${Actor[Glimmerstone].X} ${Actor[Glimmerstone].Y} ${Actor[Glimmerstone].Z} 5
				
				break
			}
			case 4
			{
				call RIMObj.Move -230.700089 31.522518 -242.292999
				call RIMObj.Move -230.439560 21.789358 -285.013977
				call RIMObj.Move -290.844971 18.960136 -293.921661
				CustomLoc:Set[0 0 0]
				call ClickActor -Actor "Runic Stone"
				GlimmerstoneRunicID:Set[${Actor[Runic Stone].ID}]
				Actor[${GlimmerstoneRunicID}]:DoTarget
				wait 600 ${Actor[id,${GlimmerstoneRunicID}].IsDead}
				wait 50
				if ${Actor[Glimmerstone].Distance}>7
					call RIMObj.Move ${Actor[Glimmerstone].X} ${Actor[Glimmerstone].Y} ${Actor[Glimmerstone].Z} 5
				
				break
			}
			case 5
			{
				call RIMObj.Move -290.844971 18.960136 -293.921661
				call RIMObj.Move -320.598785 26.122463 -279.374573
				call RIMObj.Move -337.707092 37.278160 -244.253540
				CustomLoc:Set[0 0 0]
				call ClickActor -Actor "Runic Stone"
				GlimmerstoneRunicID:Set[${Actor[Runic Stone].ID}]
				Actor[${GlimmerstoneRunicID}]:DoTarget
				wait 600 ${Actor[id,${GlimmerstoneRunicID}].IsDead}
				wait 50
				if ${Actor[Glimmerstone].Distance}>7
					call RIMObj.Move ${Actor[Glimmerstone].X} ${Actor[Glimmerstone].Y} ${Actor[Glimmerstone].Z} 5
				
				break
			}
		}
		Trigger:Set[0]
	}
	
}
function Heaper()
{
	call CustomNamed "Heaper" "254.937057,160.494324,98.761375"
}
function Slurpgaloop()
{
	call CustomNamed "Slurpgaloop" "371.225189,59.227394,229.941391"
}
function Mudwalker()
{
	call RIMObj.Move -104.767761 12.006590 707.156555
	Actor[The Monstrous Mudwalker]:DoTarget
	wait 150 ${Actor[The Monstrous Mudwalker].Distance}<15
	call CustomNamed "The Monstrous Mudwalker" "-97.750626,13.394506,695.192993" NONE mold
}
function Pete()
{
	call CustomNamed "Pete Bog" "-69.166901,79.987602,427.755280" NONE Koni
}
function Vegarlsonnajena()
{
	call MessageBox "Do this part and resume at zone exit when done"
}
;;;;;;;; End Vegarlson: Ruins of Rathe
;;;;;;;; Start Doomfire: Elements of Rage
function Spikesnot()
{
	call CustomNamed "Spikesnot the Gall" "114.089546,17.322762,201.016815" NONE flame
}
function Daedalus()
{
	call CustomNamed "Daedalus the Sunbird-NMB" "209.593353,57.295509,232.682251" NONE fanatic 
}

function Manacrush()
{
	AnnounceText:Clear
	AnnounceText:Insert["You feel the presence of an undeniable threat"]
	call CustomNamed "Manacrush-NMB" "290.179779,67.949646,156.737747" ManacrushCustom
}
function ManacrushCustom()
{
	call RIObj.Target cage -Distance 30 embernaut -Distance 15 "Manacrush"
	
	if ${Trigger}
	{
		if ${Me.Distance[290.179779,67.949646,156.737747]}<5
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,309.227448,68.038010,173.966522]
		else
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,290.179779,67.949646,156.737747]
		Trigger:Set[FALSE]
	}
}
function Wrathflame()
{
	call CustomNamed "Wrathflame the Chosen" "232.470551,84.446480,343.481140" WrathflameCustom
}
function WrathflameCustom(int _NamedID)
{
	if !${RI_Var_Bool_GlobalOthers}
		RIObj:BalanceMobs["ALL"]
	else
		noop
}
function Rosnarga()
{
	call CustomNamed "Firemonger Rosnarga" "372.106934,110.893745,425.317902" NONE fanatical agressive needlescale
}

;;;;;;;; End Doomfire: Elements of Rage
;;;;;;;; Start Eryslai: The Midnight Aerie
function Beaknik()
{
	wait 600 ${Actor[Beaknik](exists)}
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["Beaknik's Hungry"]
	IncomingText:Insert["gobbles up the worm"]
	while ${Actor[Query, Name=-"a phoenix" && Distance<30](exists)} && ${Actor[Beaknik].Distance}>20
		Actor[a phoenix]:DoTarget
	;call CustomNamed "Beaknik-NMB" "1027.765625,281.807587,250.122375" BeaknikCustom
	call CustomNamed "Beaknik-NMB" "1027.765625,281.807587,250.122375"
}
function BeaknikCustom(int _NamedID)
{
	call RIObj.Target Generation -Distance 30 ${_NamedID}
	if !${Me.Inventory[Query, Location=="Inventory" && Name=="slithering windworm"](exists)} && !${RI_Var_Bool_GlobalOthers}
	{
		RIMUIObj:SetLockSpot[ALL,${Actor["Worm - Invis Cube"].Loc},1,500]
		while !${Me.Inventory[Query, Location=="Inventory" && Name=="slithering windworm"](exists)}
		{
			Actor["Worm - Invis Cube"]:DoubleClick
			waitframe
		}
		RIMUIObj:SetLockSpot[ALL,1027.765625,281.807587,250.122375,1,500]
	}
	if ${Trigger} && ${TriggerMessage.Find[Beaknik's Hungry](exists)} && ${Me.Inventory[Query, Location=="Inventory" && Name=="slithering windworm"](exists)}
	{
		Trigger:Set[FALSE]
		RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_NamedID} && IsDead=FALSE].Loc},2]
		
		while !${Trigger}
		{
			eq2ex apply_verb ${_NamedID} "Feed"
			wait 5
		}
		RIMUIObj:SetLockSpot[ALL,1027.765625,281.807587,250.122375]
		Trigger:Set[FALSE]
	}
}
function Skywing()
{
	call CustomNamed "Velos Skywing-NMB" "1046.093506,241.044174,139.518494"
	RIMUIObj:SetLockSpot[ALL,1047.773926,241.872375,124.910805,1,500]
	wait 1200 ${Actor[Aelero].Distance}<30
	call CustomNamed "Aelero Skywing-NMB" "1047.773926,241.872375,124.910805" SkywingCustom
	RIMUIObj:SetLockSpot[ALL,1047.773926,241.872375,124.910805,1,500]
	wait 50
}
function SkywingCustom(int _NamedID)
{
	RIMUIObj:SetLockSpot[ALL,${Actor[id,${_NamedID}].Loc},5,500]
}
function Xoch()
{
	call Xochntula
}
function Xochntula()
{
	call CustomNamed "Xochntula" "1164.273071,211.359711,-3.343382" NONE herald protector
}
function Prosperon()
{
	Actor[Prosperon]:DoTarget
	wait 600 ${Actor[Aerieyal the Subjugated](exists)}
	call CustomNamed "Prosperon-NMB" "1011.159973,-310.109985,251.669998" ProsperonCustom
}
function ProsperonCustom(int _NamedID)
{
	if !${Actor[Aerieyal the Bewitched](exists)}
	{
		RIMUIObj:SetLockSpot[ALL,${Actor[Aerieyal the Subjugated].Loc},1,500]
		RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
		RIMUIObj:SetUISetting[ALL,SettingsRangedAutoCheckBox,0]
		RIMUIObj:SetUISetting[ALL,SettingsMeleeAutoCheckBox,0]
		RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
		Actor[a chaotic tempest]:DoTarget
	}
	else
	{
		call RIObj.Target ${_NamedID}
		if ${RIMUIObj.MainIconIDExists[${Me.ID},715,0]}
		{
			RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
			RIMUIObj:SetUISetting[ALL,SettingsRangedAutoCheckBox,1]
			RIMUIObj:SetUISetting[ALL,SettingsMeleeAutoCheckBox,1]
			RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
			RIMUIObj:SetLockSpot[ALL,${Actor[id,${_NamedID}].Loc},5,500]
		}
		else
		{
			RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
			RIMUIObj:SetLockSpot[ALL,${Actor[Query, TintFlags=26149].Loc},1,500]
		}
	}
}
function Sterek()
{
	RIMUIObj:SetLockSpot[ALL,1267.733032,295.146271,-182.974075]
	while ${Actor[Query, Name=-"zephyren" && Distance<30](exists)} && ${Actor[sterek].Distance}>20
		Actor[zephyren]:DoTarget
	call CustomNamed "Sterek-NMB" "1267.733032,295.146271,-182.974075" SterekCustom
}
function SterekCustom(int _NamedID)
{
	if ${_NamedID}==0
		_NamedID:Set[${Actor[Sterek].ID}]
	call RIObj.Target zephyren -Distance 20 ${_NamedID}
	if ${RIMUIObj.MainIconIDExists[${_NamedID},153]}
	{
		if ${Actor[Query, Name=="a swiftwind egg" && Aura=="design_egg_shake_gold"](exists)}
		{
			RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="a swiftwind egg" && Aura=="design_egg_shake_gold"].Loc},1,500]
			Actor[Query, Name=="a swiftwind egg" && Aura=="design_egg_shake_gold" && Distance<40]:DoubleClick
		}
	}
	else
	{
		RIMUIObj:SetLockSpot[ALL,1267.733032,295.146271,-182.974075,1,500]
	}
}
function EryslaiMidnightRainbowChecker(int _MAC)
{
	if ${Actor[Rainbow Clicky Red](exists)} && ${Actor[Rainbow Clicky Orange](exists)} && ${Actor[Rainbow Clicky Yellow](exists)} && ${Actor[Rainbow Clicky Green](exists)} && ${Actor[Rainbow Clicky Blue](exists)} && ${Actor[Rainbow Clicky Indigo](exists)} && ${Actor[Rainbow Clicky Violet](exists)}
		noop
	else
		MainArrayCounter:Set[${_MAC}]
}
;;;;;;;; End Eryslai: The Midnight Aerie

;;;;;;;; Start Awuidor: Marr's Ascent

function Hirpo()
{
	call CustomNamed "Hirpo the Frosted Spine" "${Actor[Hirpo].Loc}"
}
function Torrent()
{
	call CustomNamed "Torrent" "-0.756965,668.388733,-161.621948"
	call CustomNamed "Torrent" "-0.756965,668.388733,-161.621948" TorrentCustom
}
function TorrentCustom(int _NamedID)
{
	RIObj:BalanceMobs["Raging Torrent of Awuidor"]
}
function Etrigon()
{
	call CustomNamed "Etrigon Icefist" "203.853165,321.853821,137.280594"
}
function Grobnor()
{
	RIMUIObj:SetLockSpot[ALL,-181.501770,489.809723,137.585632]
	wait 600 ${Me.Distance[-181.501770,489.809723,137.585632]}<3
	press ${RI_Var_String_CrouchKey}
	call CustomNamed "Grobnor the Elder Orb-NMB" "-181.501770,489.809723,137.585632"
	wait 50
	press ${RI_Var_String_JumpKey}
}
function Tethys()
{
	;call CustomNamed "Tethys All-Mother" "-0.916376,356.412415,3.662665" NONE Metis Clymene Idyia
	call CustomNamed "Tethys All-Mother" "-0.916376,356.412415,3.662665"
}

;;;;;;;; End Awuidor: Marr's Ascent

;;;;;;;; Start Doomfire: Vengeance of Ro
function Wrath()
{
	call CustomNamed "Wrath of Ro" "434.563446,-20.431398,-387.754333"
}
function Retribution()
{
	call CustomNamed "Retribution of Ro" "434.563446,-20.431398,-387.754333"
}
function Vengeance()
{
	call CustomNamed "Vengeance of Ro-NMB" "405.688446,18.514368,-242.486176" NONE Krel-Ariak
}
;;;;;;;; End Doomfire: Vengeance of Ro
;;;;;;;; Start Eryslai: Trials of Air
function Cyclono()
{
	IncomingText:Insert["Might wanna duck"]
	AnnounceText:Insert["Cyclono dispenses with the pleasantries"]
	call CustomNamed "Cyclono-NMB" "-314.745544,-490.705994,777.626465" CyclonoCustom
}
function CyclonoCustom(int _NamedID)
{
	variable int _cnt=0
	call RIObj.Target spren -Distance 30 ${_NamedID}
	if ${Actor[id,${_NamedID}].Distance}>15
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_NamedID}].Loc},6,1000]

	if ${Trigger}
	{
		if ${TriggerMessage.Find["Might wanna duck"](exists)}
		{
			_cnt:Set[0]
			while !${Me.IsCrouching} && ${_cnt:Inc}<10
			{
				press ${RI_Var_String_CrouchKey}
				wait 2
			}
			TimedCommand 60 press ${RI_Var_String_JumpKey}
		}
		else
		{
			RIMUIObj:SetLockSpot[OFF]
			RIMUIObj:SetRIFollow[OFF]
			_cnt:Set[0]
			RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
			RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
			while ${_cnt:Inc}<100
			{
				if !${RI_Var_Bool_GlobalOthers}
				{
					Actor[id,${_NamedID}]:DoFace
					if ${Actor[id,${_NamedID}].Distance}<35
						press -hold ${RI_Var_String_BackwardKey}
					else
						press -release ${RI_Var_String_BackwardKey}
					relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${Me.Loc},1,1000]
				}
				wait 1
			}
			RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
			RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
			press -release ${RI_Var_String_BackwardKey}
		}
		Trigger:Set[0]
	}
	
}
function Quarez()
{
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,0]
	call CustomNamed "Quarez-NMB" "-314.745544,-490.705994,777.626465" QuarezCustom
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,1]
}
function QuarezCustom(int _NamedID)
{
	call RIObj.Target electric -Distance 30 crackling -Distance 30 ${_NamedID}
	if ${Actor[an efreeti standard].Heading.Precision[0]}==144
		RIMUIObj:SetLockSpot[${Me.Name},-310.025604,-490.865906,806.204102]
	else
		RIMUIObj:SetLockSpot[${Me.Name},-343.410645,-490.865936,781.803040]
}
function Kamara()
{
	call CustomNamed "Kamara Zar-NMB" "-314.745544,-490.705994,777.626465" Kamaracustom
}
function Kamaracustom(int _NamedID)
{
	call RIObj.Target stormrider -Distance 30 nilborien -Distance 30 ${_NamedID}
	if ${RIMUIObj.MainIconIDExists[${Me.ID},584]}>0 
		RIMUIObj:SetLockSpot[${Me.Name},-265.169281,-490.705994,708.171570]
	elseif ${RIMUIObj.MainIconIDExists[${Me.ID},622]}>0
		RIMUIObj:SetLockSpot[${Me.Name},-306.651398,-490.705994,765.479187]
	else
		RIMUIObj:SetLockSpot[${Me.Name},-314.745544,-490.705994,777.626465]
	
}
;;;;;;;; End Eryslai: Trials of Air

;;;;;;;; Start Awuidor: The Veiled Precipice

function E'ci()
{
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Name},-0.649287,668.388489,-84.589081]
	Actor["Champion of E'ci"]:DoTarget
	wait 600 ${Actor["Champion of E'ci"].Distance}<25
	call CustomNamed "Champion of E'ci" "-0.812992,668.386841,-112.053894"
}
function Marr()
{
	;IncomingText:Clear
	;IncomingText2:Clear
	;IncomingText:Insert["can't see target"]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Name},-0.841358,668.761292,148.532806]
	Actor["Champion of Marr"]:DoTarget
	wait 600 ${Actor["Champion of Marr"].Distance}<25
	call CustomNamed "Champion of Marr-NMB" "-2.150011,668.387024,120.076904" NONE eel
}
; function MarrCustom(int _NamedID)
; {
	; call RIObj.Target eel -Distance 30 ${_NamedID}
	; if ${Trigger}
	; {
		; RIMUIObj:SetLockSpot[ALL,-0.455069,668.764160,123.773094,1,1000]
		; wait 50
		; RIMUIObj:SetLockSpot[ALL,-0.823767,668.762451,134.852585,1,1000]	
		; Trigger:Set[0]
	; }
; }
function Veiled()
{
	call CustomNamed "Champion of the Veiled One" "-0.943816,668.389954,177.706711"
}

;;;;;;;; End Awuidor: The Veiled Precipice
function PullNamed(string _Name)
{
	wait 5
	call RIMObj.CheckCombat
	wait 5
	variable int _cnt=1
	while ${Actor[${_Name}].Distance}>15 && ${_cnt:Inc}<600
	{
		if !${RI_Var_Bool_GlobalOthers}
			Actor[${_Name}]:DoTarget
		wait 1
	}
}
;;;;;;;; Start Vegarlson: The Terrene Rift
function Krogrock()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["ack to spit rocks in front of hi"]
	IncomingText:Insert["repares for lift of"]
	IncomingText:Insert["about to Rumble the earth"]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,0]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,60.575142,163.967850,-33.032032,1,1000]
	call PullNamed Krogrock
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,90.483452,159.710510,-49.954582,1,1000]
	wait 600 ${Me.Distance[90.483452,159.710510,-49.954582]}<5
	call CustomNamed "Krogrock the Earthcrasher" "84.212471,159.710510,-82.138199" KrockrockCustom
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,1]
}
function KrockrockCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,0]
	RIMUIObj:SetLockSpot[ALL,84.212471,159.710510,-82.138199,1,1000]
	if ${Trigger}
	{
		if ${TriggerMessage.Find[spit]}
		{
			RIMUIObj:SetLockSpot[OFF]
			eq2ex cancel_spellcast
			RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[1]
			eq2ex cancel_spellcast
			call MoveBehind ${_NamedID} 100 100
			eq2ex cancel_spellcast
			RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[1]
			wait 50
			RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
			RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
			call MoveBehind 0
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,84.212471,159.710510,-82.138199,1,1000]	
		}
		else
		{
			if ${TriggerMessage.Find[Rumble]}
				wait 20
			if ${Actor[id,${_NamedID}].Distance[100.247475,159.710510,-113.626884]}>${Actor[id,${_NamedID}].Distance[96.230217,159.710510,-48.827625]}
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,100.247475,159.710510,-113.626884,1,1000]
			else
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,96.230217,159.710510,-48.827625,1,1000]
			wait 60
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,84.212471,159.710510,-82.138199,1,1000]			
		}
		Trigger:Set[0]
	}
}
function Izanahm()
{
	if !${Actor[Izanahm].Name.Find[Uprooted](exists)}
	{
		variable index:string _Locs
		
		_Locs:Insert["172.023010,159.709747,-183.888855"]
		_Locs:Insert["167.324036,160.817017,-171.117249"]
		_Locs:Insert["167.379761,160.831238,-159.709686"]
		_Locs:Insert["167.665985,160.756546,-148.307022"]
		_Locs:Insert["167.302429,160.833755,-138.056595"]
		_Locs:Insert["167.580536,160.694366,-125.749779"]
		_Locs:Insert["167.573456,160.805130,-114.821472"]
		_Locs:Insert["167.589676,160.752930,-103.510811"]
		_Locs:Insert["167.854904,160.767151,-92.466629"]
		_Locs:Insert["167.836899,160.821426,-82.227554"]
		_Locs:Insert["167.962570,160.776108,-70.247673"]
		_Locs:Insert["167.564911,160.822342,-59.221603"]
		_Locs:Insert["167.746719,160.828232,-48.272148"]
		_Locs:Insert["167.944397,160.828201,-37.522228"]
		_Locs:Insert["168.130890,160.805206,-26.475103"]
		_Locs:Insert["181.676117,159.710510,-12.304850"]
		
		variable int _acnt
		variable int _cnt
		for(_acnt:Set[1];${_acnt}<=${_Locs.Used};_acnt:Inc)
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Locs.Get[${_acnt}]},1,1000]
			wait 600 ${Me.Distance[${_Locs.Get[${_acnt}]}]}<3
			wait 20
			if ${_acnt}==1 || ${_acnt}==${_Locs.Used}
			{
				_cnt:Set[0]
				while ${_cnt:Inc}<600 && ${Actor[Query, Name=-"Stone of Thudos" && Distance<=20 && IsDead=FALSE](exists)}
				{
					if !${RI_Var_Bool_GlobalOthers}
						Actor[Query, Name=-"Stone of Thudos" && Distance<=20 && IsDead=FALSE]:DoTarget
					wait 1
					;need to add code to look for the actor of the knock up item when see, subtract 20 from X position of current loc
				}
			}
			else
			{
				_cnt:Set[0]
				while ${_cnt:Inc}<600 && ${Actor[Query, Name=-"terrene enforcer" && Distance<=10 && IsDead=FALSE](exists)}
				{
					if !${RI_Var_Bool_GlobalOthers}
						Actor[Query, Name=-"terrene enforcer" && Distance<=10 && IsDead=FALSE]:DoTarget
					wait 1
				}
			}
			if ${Zone.Name.Find["[Solo]"]} && ${_acnt}==10
				_acnt:Set[500]
		}
	}
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,150.355911,159.710510,-99.970276,1,1000]
	;wait 600 ${Me.Distance[152.681763,159.710510,-98.346939]}<5
	;wait 600 ${RIMObj.AllGroupWithinRange[5]}
	call CustomNamed "Izanahm the Uprooted-NMB" "150.355911,159.710510,-99.970276" IzanahmCustom
	
}
function IzanahmCustom(int _NamedID)
{
	call RIObj.Target terrene -Distance 25 ${_NamedID}
	if ${Actor[a conjuring of earth](exists)}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,150.365295,159.710510,-87.869179,1,1000]
	else
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,150.355911,159.710510,-99.970276,1,1000]
}
function Mudmartigan()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["see ya!"]
	call CustomNamed "Mudmartigan-NMB" "260.647461,227.344177,-98.289703|250.895309,227.344177,-98.653595" MudmartiganCustom
	wait 50
}
function MudmartiganCustom(int _NamedID)
{
	call RIObj.Target mudflapper -Distance 15 ${_NamedID}
	if ${Trigger}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			RIMUIObj:SetLockSpot[ALL,250.895309,227.344177,-98.6535955,1,1000]
			wait 60
			RIMUIObj:SetLockSpot[ALL,260.647461,227.344177,-98.289703,1,1000]			
		}
		Trigger:Set[0]
	}
}
;;;;;;;; End Vegarlson: The Terrene Rift
;;;;;;;; Start Ward of Chaos Elements
function WOCEChillsoot()
{
	;for now just messagebox but eventually we will set the trigger and go until we hit 4 triggers
	call MessageBox "Do this part and resume when done"
}
function WOCERumbles()
{
	call MessageBox "Do this part and resume by the river when named is spawned"
}
function WOCEClickEle()
{
	call MessageBox "click the elevator then resume"
}
function Glimmerghast()
{
	while !${Actor[Glimmerghast].IsAggro}
	{
		Actor[Glimmerghast]:DoubleClick
	}
	call CustomNamed "Glimmerghast" "-89.803322,-354.685974,95.597313" GlimmerghastCustom
}
function GlimmerghastCustom()
{
	if ${Me.Inventory["Icecrete Shield"].TimeUntilReady}==-1
	{
		RI_CMD_PauseCombatBots 1
		eq2ex cancel_spellcast
		wait 2
		Me.Inventory["Icecrete Shield"]:Use
		wait 10
		RI_CMD_PauseCombatBots 0
	}
}
function Cursemuck()
{
	call CustomNamed "Cursemuck" "-113.605904,-327.897339,163.699036" CursemuckCustom
}
function CursemuckCustom()
{
	if ${Me.Inventory["Icecrete Shield"].TimeUntilReady}==-1
	{
		RI_CMD_PauseCombatBots 1
		eq2ex cancel_spellcast
		wait 2
		Me.Inventory["Icecrete Shield"]:Use
		wait 10
		RI_CMD_PauseCombatBots 0
	}
	if ${Me.Inventory["Fulgurite Strike"].TimeUntilReady}==-1
	{
		RI_CMD_PauseCombatBots 1
		eq2ex cancel_spellcast
		wait 2
		Me.Inventory["Fulgurite Strike"]:Use
		wait 10
		RI_CMD_PauseCombatBots 0
	}
}
function Blazeanger()
{
	declare CastedWellstone bool script FALSE
	call CustomNamed "Blazeanger" "-277.853424,-440.003082,-76.585915" BlazeangerCustom
	deletevariable CastedWellstone
}
function BlazeangerCustom()
{
	if ${Me.Inventory["Icecrete Shield"].TimeUntilReady}==-1
	{
		RI_CMD_PauseCombatBots 1
		eq2ex cancel_spellcast
		wait 2
		Me.Inventory["Icecrete Shield"]:Use
		wait 10
		RI_CMD_PauseCombatBots 0
	}
	if ${Me.Inventory["Wellstone Spout"].TimeUntilReady}==-1 && !${CastedWellstone}
	{
		RI_CMD_PauseCombatBots 1
		eq2ex cancel_spellcast
		wait 2
		Me.Inventory["Wellstone Spout"]:Use
		wait 15
		RI_CMD_PauseCombatBots 0
	}
	if ${Me.Inventory["Wellstone Spout"].TimeUntilReady}>0
		CastedWellstone:Set[1]
}
function Cinderstench()
{
	call CustomNamed "Cinderstench" "-401.413971,-402.284363,65.191833" CinderstenchCustom
}
function CinderstenchCustom()
{
	if ${Me.Inventory["Icecrete Shield"].TimeUntilReady}==-1
	{
		RI_CMD_PauseCombatBots 1
		eq2ex cancel_spellcast
		wait 2
		Me.Inventory["Icecrete Shield"]:Use
		wait 10
		RI_CMD_PauseCombatBots 0
	}
	if ${Me.Noxious}>0
	{
		RI_CMD_PauseCombatBots 1
		eq2ex cancel_spellcast
		wait 2
		Me.Inventory["Filtered Breath"]:Use
		wait 20
		RI_CMD_PauseCombatBots 0
	}
}
function Najena()
{
	RIMUIObj:SetLockSpot[ALL,-499.918518,-179.369812,111.915359]
	declare CastedWellstone bool script FALSE
	wait 600 ${Actor[najena].IsAggro}
	call CustomNamed "Najena-NLP" "-501.176758,-179.369812,110.361961" NajenaCustom
	deletevariable CastedWellstone
}
function NajenaCustom()
{
	if ${Me.Inventory["Wellstone Spout"].TimeUntilReady}>0
		CastedWellstone:Set[1]
	if ${Me.Inventory["Icecrete Shield"].TimeUntilReady}==-1
	{
		RI_CMD_PauseCombatBots 1
		eq2ex cancel_spellcast
		wait 2
		Me.Inventory["Icecrete Shield"]:Use
		wait 10
		RI_CMD_PauseCombatBots 0
	}
	if ${Me.Noxious}>0
	{
		RI_CMD_PauseCombatBots 1
		eq2ex cancel_spellcast
		wait 2
		Me.Inventory["Filtered Breath"]:Use
		wait 20
		RI_CMD_PauseCombatBots 0
	}
	if ${Actor[Query, Name=-"blazeanger" && IsDead=FALSE](exists)}
	{
		Actor[blazeanger]:DoTarget
		
		if ${Me.Inventory["Wellstone Spout"].TimeUntilReady}==-1 && !${CastedWellstone}
		{
			RI_CMD_PauseCombatBots 1
			eq2ex cancel_spellcast
			wait 2
			Me.Inventory["Wellstone Spout"]:Use
			wait 15
			RI_CMD_PauseCombatBots 0
		}
	}
	elseif ${Actor[Query, Name=-"Cursemuck" && IsDead=FALSE](exists)}
	{
		Actor[Cursemuck]:DoTarget
		if ${Me.Inventory["Fulgurite Strike"].TimeUntilReady}==-1
		{
			RI_CMD_PauseCombatBots 1
			eq2ex cancel_spellcast
			wait 2
			Me.Inventory["Fulgurite Strike"]:Use
			wait 10
			RI_CMD_PauseCombatBots 0
		}
	}
	elseif ${Actor[Query, Name=-"Cinderstench" && IsDead=FALSE](exists)}
	{
		Actor[Cinderstench]:DoTarget
	}
	elseif ${Actor[Query, Name=-"Glimmerghast" && IsDead=FALSE](exists)}
	{
		Actor[Glimmerghast]:DoTarget
	}
	else
		Actor[Najena]:DoTarget
}
;;;;;;;; End Ward of Chaos Elements

function Aldez()
{
	call CustomNamed "Aldez the Mighty" "138.556091,-14.350210,-358.204254"
}

function Erskellish()
{
	call CustomNamed "Erskellish Bloodarmor" "480.458740,-19.174274,-416.181854"
}
function Lucrezzia()
{
	call CustomNamed "Lucrezzia Mindrazer" "577.611816,-15.957007,82.284470"
}
function Zun'Liako'Va()
{
	call CustomNamed "Zun'Liako'Va" "206.646652,-50.505955,318.518585"
}
function Eom'Tek'Zen()
{
	call CustomNamed "Eom'Tek'Zen" "746.657654,-100.353165,-976.660522"
}

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; End of CD Zone CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; Start of BoL Zone CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;; Start Aurelian Coast: Sambata Village
function Ercel()
{
	call CustomNamed "Ercel Bloodpaw" "99.220032,73.917030,-279.420074"
}
function Grugnop()
{
	call CustomNamed "Grugnop, the Guard" "36.442844,69.369949,-420.705627"
}
function Grrrunk()
{
	call CustomNamed "Grrrunk the Trunk" "49.395649,78.396690,-577.618896"
}
function Ryryrd()
{
	call PreHeal
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,4.242581,89.169662,-613.572937,1,1000]
	wait 600 ${Me.Distance[4.242581,89.169662,-613.572937]}<5
	wait 600 ${RIMObj.AllGroupWithinRange[3]}
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-17.612984,88.564384,-614.753967,1,1000]
	wait 600 ${Me.Distance[-17.612984,88.564384,-614.753967]}<5
	wait 600 ${RIMObj.AllGroupWithinRange[3]}
	call PullNamed Ryryrd
	eq2ex target_none
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,4.242581,89.169662,-613.572937,1,1000]
	wait 600 ${Me.Distance[4.242581,89.169662,-613.572937]}<5
	wait 600 ${RIMObj.AllGroupWithinRange[3]}
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,13.449534,88.419991,-595.657227,1,1000]
	wait 600 ${Me.Distance[13.449534,88.419991,-595.657227]}<5
	wait 600 ${RIMObj.AllGroupWithinRange[3]}
	call CustomNamed "Ryryrd of the Wind-NMB" "13.449534,88.419991,-595.657227"
}
function Mrokor()
{
	call WaitForLastNamedChest START
	call CustomNamed "Mrokor, the Smartist" "-91.563019,81.940346,-701.779480"
	call CustomNamed "Purpyron the Massive" "-91.563019,81.940346,-701.779480"
	call WaitForLastNamedChest
}
;;;;;;;; End Aurelian Coast: Sambata Village

;;;;;;;; Start Aurelian Coast: Reishi Rumble

function Nerobahan()
{
	call CustomNamed "Nerobahan" "639.571472,23.426392,564.551025"
}
function Ghest()
{
	call CustomNamed "Ghest Roppep" "371.037506,35.760571,569.124878"
}
function Ropscion()
{
	call WaitForLastNamedChest START
	call PreHeal
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,481.981323,30.217960,578.265015,1,1000]
	call PullNamed Ropscion
	call CustomNamed "Ropscion Mindeye-NMB" "451.018616,18.688366,539.470093"
	call WaitForLastNamedChest
}

;;;;;;;; End Aurelian Coast: Reishi Rumble
;;;;;;;; Start Aurelian Coast: Maiden's Eye

function Drudge()
{
	call CustomNamed "The Drudge Lord" "-305.597931,4.741745,-226.931305"
}
function Xylox()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["his should help clear the air.."]
	AnnounceText:Clear
	AnnounceText:Insert["Xylox summons poisonous waves"]
	;AnnounceText:Insert["The shield dissipates"]
	call CustomNamed "Xylox the Poisonous-NMB" "-498.070923,31.269993,-148.6769873" XyloxCustom
}

function XyloxCustom(int _NamedID)
{
	if ${Trigger}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			; if ${TriggerMessage.Find["Xylox begins to cast a powerful shield around him"]}
			; {
				; if !${RI_Var_Bool_GlobalOthers}
				; {
					; Actor[id,${Me.ID}]:DoTarget
				; }
			; }
			; elseif ${TriggerMessage.Find["The shield dissipates"]}
			; {
				; Trigger:Set[FALSE]
			; }
			; else
			; {
				if ${Actor[id, ${_NamedID}].Distance}<30
				{
					if ${Me.Distance[-498.070923,31.269993,-148.6769873]}<10
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-459.246399,30.097427,-224.127747]
					;elseif ${Actor[id,${_NamedID}].Distance[-498.070923,31.269993,-148.6769873]}<30
					;	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-457.382080,30.019697,-237.328156]
					else
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-498.070923,31.269993,-148.6769873]
					Actor[id,${Me.ID}]:DoTarget
				}
				wait 50 ${Me.IsMoving}
				wait 100 !${Me.IsMoving}
				Trigger:Set[FALSE]
				eq2ex target_none
			; }
		}
		else
			Trigger:Set[FALSE]
	}
	else
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			if ${Actor[id,${_NamedID}].Distance}>50
				Actor[id,${Me.ID}]:DoTarget
			else
				call RIObj.Target "Xylox the Poisonous"
		}
	}
}
function Shadowed()
{
	call CustomNamed "Shadowed Abomination" "-567.794739,59.946609,30.354818"
}
function Va()
{
	call CustomNamed "Va Dyn Kar" "-677.951355,58.746983,-101.430580"
}
function Shadow()
{
	call WaitForLastNamedChest START
	call CustomNamed "The Shadow Overlord-NMB" "-660.178040,76.891739,70.412712" NONE Shadowed
	call WaitForLastNamedChest
}


;;;;;;;; End Aurelian Coast: Maiden's Eye

;;;;;;; Start Sanctus Seru: Echelon of Order

function Moggtu()
{
	call CustomNamed "Moggtu the Mad" "-246.726868,87.679039,142.898804"
}
function Cerio()
{
	call CustomNamed "Cerio Vallain" "0.452483,87.648544,346.692352"
}
function Raizyl()
{
	call CustomNamed "Raizyl Pajdu-NMB" "-150.178848,82.870377,-297.967041" NONE apprentice
}
function Dichromanus()
{
	call CustomNamed "Dichromanus" "-27.421337,87.674698,-325.223785"
}
function Warglave()
{
	call WaitForLastNamedChest START
	call CustomNamed "Lady Warglave" "-248.209732,90.707596,-24.579607" NONE Divinion
	call WaitForLastNamedChest
}

;;;;;;;; End Sanctus Seru: Echelon of Order

;;;;;;;; Start Sanctus Seru: Echelon of Divinity

function Buffo()
{
	call CustomNamed "Divine Prophet Buffo II" "-70.560173,176.888641,151.959641"
}
function Typhenon()
{
	call CustomNamed "Grand Cruciator Typhenon" "-33.319767,179.787155,-202.385468" TyphenonCustom 
}
function TyphenonCustom(int _NamedID)
{
	call RIObj.Target wall luminary -Distance 15 echelon -Distance 15 ${_NamedID}
}
function Unhilynd()
{
	call CustomNamed "Unhilynd" "-119.965477,175.885437,-169.925446"
}
function Prysmerah()
{
	IncomingText:Insert["gathers fire and poison"]
	call CustomNamed "Prysmerah, Arx Patrona-NMB" "-235.021988,179.759079,-0.059676"
}
function PrysmerahCustom()
{
	if ${Trigger}
	{
		RIMUIObj:SetLockSpot[ALL,-230.620697,179.757187,20.956955]
		wait 50
		RIMUIObj:SetLockSpot[ALL,-235.021988,179.759079,-0.059676]
		Trigger:Set[0]
	}
}
function Triskian()
{
	relay ${RI_Var_String_RelayGroup} RI_Var_Bool_SkipLoot:Set[1]
	call WaitForLastNamedChest START
	call CustomNamed "Lord Triskian Seru" "122.769249,79.128601,4.076076" NONE Chronosphere
	wait 50
	relay ${RI_Var_String_RelayGroup} RI_Var_Bool_SkipLoot:Set[0]
	call WaitForLastNamedChest
}

;;;;;;;; End Sanctus Seru: Echelon of Divinity

;;;;;;;; Start Sanctus Seru: Arx Aeturnus

function ArxEvent1()
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	
	;first determine which pole the first set of mobs is at and add that to the index, and so on
	declare RI_Var_IndexString_ArxEvent1 index:string globalkeep
	
	variable string lummob
;-54.909554,78.199844,27.233425
;7.799590,78.122375,27.199543 
;8.259869,78.247208,-19.330343
;-55.173817,78.122383,-18.828714
	

	;echo mobset 1
	if ${Actor[Query, Name=-"Luminary"].Distance[-54.909554,78.199844,27.233425]}<20
		RI_Var_IndexString_ArxEvent1:Insert["-54.909554,78.199844,27.233425"]
	elseif ${Actor[Query, Name=-"Luminary"].Distance[7.799590,78.122375,27.199543]}<20
		RI_Var_IndexString_ArxEvent1:Insert["7.799590,78.122375,27.199543"]
	elseif ${Actor[Query, Name=-"Luminary"].Distance[8.259869,78.247208,-19.330343]}<20
		RI_Var_IndexString_ArxEvent1:Insert["8.259869,78.247208,-19.330343"]
	elseif ${Actor[Query, Name=-"Luminary"].Distance[-55.173817,78.122383,-18.828714]}<20
		RI_Var_IndexString_ArxEvent1:Insert["-55.173817,78.122383,-18.828714"]
	lummob:Set[${Actor[Query, Name=-"Luminary"]}]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${RI_Var_IndexString_ArxEvent1.Get[1]},5,500]
	
	while ${Actor[Query, Name=-"${lummob}" && IsDead=FALSE](exists)}
	{
		Actor[Query, Name=-"${lummob}" && IsDead=FALSE && Distance<10]:DoTarget
		wait 1
	}
	wait 50
		
	;echo mobset 2
	if ${Actor[Query, Name=-"Luminary"].Distance[-54.909554,78.199844,27.233425]}<20
		RI_Var_IndexString_ArxEvent1:Insert["-54.909554,78.199844,27.233425"]
	elseif ${Actor[Query, Name=-"Luminary"].Distance[7.799590,78.122375,27.199543]}<20
		RI_Var_IndexString_ArxEvent1:Insert["7.799590,78.122375,27.199543"]
	elseif ${Actor[Query, Name=-"Luminary"].Distance[8.259869,78.247208,-19.330343]}<20
		RI_Var_IndexString_ArxEvent1:Insert["8.259869,78.247208,-19.330343"]
	elseif ${Actor[Query, Name=-"Luminary"].Distance[-55.173817,78.122383,-18.828714]}<20
		RI_Var_IndexString_ArxEvent1:Insert["-55.173817,78.122383,-18.828714"]
	lummob:Set[${Actor[Query, Name=-"Luminary"]}]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${RI_Var_IndexString_ArxEvent1.Get[2]},5,500]
	
	while ${Actor[Query, Name=-"${lummob}" && IsDead=FALSE](exists)}
	{
		Actor[Query, Name=-"${lummob}" && IsDead=FALSE && Distance<10]:DoTarget
		wait 1
	}
	wait 50
	
	;echo mobset 3
	if ${Actor[Query, Name=-"Luminary"].Distance[-54.909554,78.199844,27.233425]}<20
		RI_Var_IndexString_ArxEvent1:Insert["-54.909554,78.199844,27.233425"]
	elseif ${Actor[Query, Name=-"Luminary"].Distance[7.799590,78.122375,27.199543]}<20
		RI_Var_IndexString_ArxEvent1:Insert["7.799590,78.122375,27.199543"]
	elseif ${Actor[Query, Name=-"Luminary"].Distance[8.259869,78.247208,-19.330343]}<20
		RI_Var_IndexString_ArxEvent1:Insert["8.259869,78.247208,-19.330343"]
	elseif ${Actor[Query, Name=-"Luminary"].Distance[-55.173817,78.122383,-18.828714]}<20
		RI_Var_IndexString_ArxEvent1:Insert["-55.173817,78.122383,-18.828714"]
	lummob:Set[${Actor[Query, Name=-"Luminary"]}]	
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${RI_Var_IndexString_ArxEvent1.Get[3]},5,500]
	
	while ${Actor[Query, Name=-"${lummob}" && IsDead=FALSE](exists)}
	{
		Actor[Query, Name=-"${lummob}" && IsDead=FALSE && Distance<10]:DoTarget
		wait 1
	}
	wait 50
	
	;echo mobset 4
	if ${Actor[Query, Name=-"Luminary"].Distance[-54.909554,78.199844,27.233425]}<20
		RI_Var_IndexString_ArxEvent1:Insert["-54.909554,78.199844,27.233425"]
	elseif ${Actor[Query, Name=-"Luminary"].Distance[7.799590,78.122375,27.199543]}<20
		RI_Var_IndexString_ArxEvent1:Insert["7.799590,78.122375,27.199543"]
	elseif ${Actor[Query, Name=-"Luminary"].Distance[8.259869,78.247208,-19.330343]}<20
		RI_Var_IndexString_ArxEvent1:Insert["8.259869,78.247208,-19.330343"]
	elseif ${Actor[Query, Name=-"Luminary"].Distance[-55.173817,78.122383,-18.828714]}<20
		RI_Var_IndexString_ArxEvent1:Insert["-55.173817,78.122383,-18.828714"]
	lummob:Set[${Actor[Query, Name=-"Luminary"]}]	
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${RI_Var_IndexString_ArxEvent1.Get[4]},5,500]
	
	while ${Actor[Query, Name=-"${lummob}" && IsDead=FALSE](exists)}
	{
		Actor[Query, Name=-"${lummob}" && IsDead=FALSE && Distance<10]:DoTarget
		wait 1
	}
	wait 50
}
function Life()
{
	AnnounceText:Clear
	AnnounceText:Insert["The Archon of Life's Pole Position fortifies its defenses"]
	call CustomNamed "Archon of Life-NMB" "-42.978535,78.122383,4.232473" LifeCustom
	if ${RI_Var_IndexString_ArxEvent1(exists)}
		DeleteVariable RI_Var_IndexString_ArxEvent1
}
function LifeCustom(int _NamedID)
{
	if !${RI_Var_Bool_GlobalOthers}
	{
		call RIObj.Target ${_NamedID}
		if ${Actor[id,${_NamedID}].Health}>76
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${RI_Var_IndexString_ArxEvent1.Get[1]}]
		}
		elseif ${Actor[id,${_NamedID}].Health}>51
		; && ${Trigger}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${RI_Var_IndexString_ArxEvent1.Get[2]}]
			Trigger:Set[FALSE]
		}
		elseif ${Actor[id,${_NamedID}].Health}>26
		; && ${Trigger}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${RI_Var_IndexString_ArxEvent1.Get[3]}]
			Trigger:Set[FALSE]
		}
		elseif ${Actor[id,${_NamedID}].Health}<27
		; && ${Trigger}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${RI_Var_IndexString_ArxEvent1.Get[4]}]
			Trigger:Set[FALSE]
		}
	}
}

function Death()
{
	;Archon of Death // Pole Position // 357
	;-23.537786,78.234230,14.592766
	;-23.963137,78.206825,-6.632393
	
	declare RI_Var_Bool_ArchonofDeathImmunity bool global 0
	
	call CustomNamed "Archon of Death-NMB" "-26.712732,78.122375,4.080623" DeathCustom
	
}
function DeathCustom(int _NamedID)
{
	if !${RI_Var_Bool_GlobalOthers}
	{
		call RIObj.Target ${_NamedID}
		if ${RIMUIObj.MainIconIDExists[${_NamedID},357]} && !${RI_Var_Bool_ArchonofDeathImmunity}
		{
			if ${Me.Distance[-23.537786,78.234230,14.592766]}<10
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-23.963137,78.206825,-6.632393]
			else
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-23.537786,78.234230,14.592766]
				
			RI_Var_Bool_ArchonofDeathImmunity:Set[1]
			TimedCommand 100 RI_Var_Bool_ArchonofDeathImmunity:Set[0]
		}
	}
}
function Eternus()
{
	call CustomNamed "Sanctus Eternus-NMB" "128.101929,79.249512,3.486075"
}

;;;;;;;; End Sanctus Seru: Arx Aeturnus

;;;;;;;; Start Fordel Midst: The Listless Spires

function Witherby()
{
	call CustomNamed "Old Witherby" "198.092285,-36.151951,844.748230"
}
function Ryzon()
{
	call CustomNamed "War Master Ryzon" "266.212189,-27.644432,778.343933" NONE Diretusk
}
function Baltar()
{
	call CustomNamed "Fire Monger Baltar" "279.073944,-35.989235,697.237183"
}

;;;;;;;; End Fordel Midst: The Listless Spires

;;;;;;;; Start Fordel Midst: Wayward Manor

function CustomDapperlingSpawn()
{

	call RIMObj.Move 567.823364 -22.081345 -580.778870 2 0 TRUE FALSE TRUE FALSE TRUE
	
	while ${Actor[Query, ( Name=-"a reishi" || Name=-"baleful" || Name=-"umbral" || Name=-"rotting" ) && IsDead=FALSE && Distance<10](exists)} && !${Actor[Query, Name=-"The Deadly Dapperling"](exists)}
		wait 1
	wait 20
	if !${Actor[Query, Name=-"The Deadly Dapperling"](exists)}
	{
		call RIMObj.Move 554.734863 -23.477221 -603.918762 2 0 TRUE FALSE TRUE FALSE TRUE
		while ${Actor[Query, ( Name=-"a reishi" || Name=-"baleful" || Name=-"umbral" || Name=-"rotting" ) && IsDead=FALSE && Distance<10](exists)} && !${Actor[Query, Name=-"The Deadly Dapperling"](exists)}
			wait 1
		call RIMObj.Move 567.823364 -22.081345 -580.778870 2 0 TRUE FALSE TRUE FALSE TRUE
		wait 20
	}
	if !${Actor[Query, Name=-"The Deadly Dapperling"](exists)}
	{
		call RIMObj.Move 554.336182 -23.429367 -558.502563 2 0 TRUE FALSE TRUE FALSE TRUE
		while ${Actor[Query, ( Name=-"a reishi" || Name=-"baleful" || Name=-"umbral" || Name=-"rotting" ) && IsDead=FALSE && Distance<10](exists)} && !${Actor[Query, Name=-"The Deadly Dapperling"](exists)}
			wait 1
		call RIMObj.Move 567.823364 -22.081345 -580.778870 2 0 TRUE FALSE TRUE FALSE TRUE
		wait 20
	}
	if !${Actor[Query, Name=-"The Deadly Dapperling"](exists)}
	{
		call RIMObj.Move 600.624268 -23.421547 -603.745972 2 0 TRUE FALSE TRUE FALSE TRUE
		while ${Actor[Query, ( Name=-"a reishi" || Name=-"baleful" || Name=-"umbral" || Name=-"rotting" ) && IsDead=FALSE && Distance<10](exists)} && !${Actor[Query, Name=-"The Deadly Dapperling"](exists)}
			wait 1
		call RIMObj.Move 567.823364 -22.081345 -580.778870 2 0 TRUE FALSE TRUE FALSE TRUE
		wait 20
	}
	if !${Actor[Query, Name=-"The Deadly Dapperling"](exists)}
	{
		
		call RIMObj.Move 600.265198 -23.423006 -555.624939 2 0 TRUE FALSE TRUE FALSE TRUE
		while ${Actor[Query, ( Name=-"a reishi" || Name=-"baleful" || Name=-"umbral" || Name=-"rotting" ) && IsDead=FALSE && Distance<10](exists)} && !${Actor[Query, Name=-"The Deadly Dapperling"](exists)}
			wait 1
		call RIMObj.Move 567.823364 -22.081345 -580.778870 2 0 TRUE FALSE TRUE FALSE TRUE
		wait 20
	}
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,567.823364 -22.081345 -580.778870]
	wait 100 ${Actor[Query, Name=-"The Deadly Dapperling"](exists)}
	while ${Actor[Query, Name=-"The Deadly Dapperling"].Distance}>20 && !${Actor[Query, Name=-"The Deadly Dapperling"].IsDead}
	{
		Actor[Query, Name=-"The Deadly Dapperling" && IsDead=FALSE]:DoTarget
		wait 5
	}
	call Dapperling
	relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Dapperling"]
}
function Dapperling()
{
	if !${RI_Var_Bool_GlobalOthers}
	{
		while ${Actor[Query, Name=-"The Deadly Dapperling" && IsDead=FALSE].Distance}>10
		{
			Actor[Query, Name=-"The Deadly Dapperling" && IsDead=FALSE]:DoTarget
			wait 1
		}
	}
	else
	{
		while ${Actor[Query, Name=-"The Deadly Dapperling" && IsDead=FALSE].Distance}>10
		{
			wait 1
		}
	}
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,531.667358,-21.434948,-593.719177]
	while ${Me.Distance[531.667358,-21.434948,-593.719177]}>5
		wait 1
	wait 20
	call CustomNamed "The Deadly Dapperling" "530.676758,-21.435129,-604.148438"
}
function Waywardcustomseattack(bool _On)
{
	if ${_On}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsRangedAutoCheckBox,1]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsMeleeAutoCheckBox,1]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
	}
	else
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsRangedAutoCheckBox,0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsMeleeAutoCheckBox,0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
		relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
		relay ${RI_Var_String_RelayGroup} eq2ex pet backoff
	}
}
function Waywardcustomcheckcombat()
{
	while ( ${Me.InCombat} || ${Me.IsHated} ) && ${RI_Var_Bool_Start}
	{
		if ${Actor[stone-worked trap](exists)} && ${Target.ID}!=${Actor[stone-worked trap].ID}
			Actor[stone-worked trap]:DoTarget
		wait 1
	}
}
function SpawnEegutPull(int _muckID, string _TrappedLoc)
{
	if ${_muckID}==0
		return
	if ${Actor[Query, Name=="a trapped muck digger"](exists)} && ${Actor[Query, Name=="a trapped muck digger"].Distance[${_TrappedLoc}]}<2
		return
	variable string _Loc
	variable int _failcnt=0
	_Loc:Set["${Actor[id,${_muckID}].Loc}"]
	Actor[id,${_muckID}]:DoTarget
	Actor[id,${_muckID}]:DoFace
	_failcnt:Set[0]
	while ${Actor[id,${_muckID}].Target.ID}!=${Me.ID} && ${Actor[id,${_muckID}].Distance[${_Loc}]}<1 && ${_failcnt:Inc}<150
	{
		eq2ex togglerangedattack
		wait 2
	}
	while ${Actor[Query, ID=${_muckID} && IsDead=FALSE](exists)} && ${_failcnt:Inc}<300 && ${Actor[id,${_muckID}].Distance}>8
	{
		Actor[id,${_muckID}]:DoTarget
		Actor[id,${_muckID}]:DoFace
		wait 1
	}
}
function SpawnEegut()
{
	variable int _muckID
	variable int _failcnt=0
	AnnounceText:Clear
	AnnounceText:Insert["It checks its TRAPS"]
	while !${Trigger} && ${_failcnt:Inc}<=5
	{
		wait 20
		call LockAndWait -Loc "682.057861,-23.477221,-599.390015" -RelayToGroup
		wait 20
		call Waywardcustomseattack 0
		wait 5
		_muckID:Set[${Actor[Query, Name=="a muck digger" && X=658.679993 && Y=-22.099909 && Z=-611.989990].ID}]
		call SpawnEegutPull ${_muckID} "677.919983,-23.437988,-601.760010"
		wait 20
		call LockAndWait -Loc "690.571655,-23.477222,-601.006104" -RelayToGroup
		wait 20
		call Waywardcustomseattack 1
		call Waywardcustomcheckcombat
		call Waywardcustomseattack 0
		wait 5
		_muckID:Set[${Actor[Query, Name=="a muck digger" && X=673.539978 && Y=-22.099657 && Z=-626.859985].ID}]
		call SpawnEegutPull ${_muckID} "688.179993,-23.477221,-605.200012"
		wait 20
		call LockAndWait -Loc "691.210266,-22.107286,-585.510803" -RelayToGroup
		wait 20
		call LockAndWait -Loc "686.224731,-22.107286,-578.093140" -RelayToGroup
		wait 20
		call LockAndWait -Loc "679.450317,-22.107290,-586.313965" -RelayToGroup
		wait 20
		call LockAndWait -Loc "685.940857,-22.901522,-593.328552" -RelayToGroup
		call LockAndWait -Loc "690.779907,-23.477221,-602.343201" -RelayToGroup

		call LockAndWait -Loc "699.552588,-23.477221,-606.945313" -RelayToGroup
		wait 20
		call Waywardcustomseattack 1
		call Waywardcustomcheckcombat
		call Waywardcustomseattack 0
		wait 5
		_muckID:Set[${Actor[Query, Name=="a muck digger" && X=716.049988 && Y=-23.477221 && Z=-599.109985].ID}]
		call SpawnEegutPull ${_muckID} "704.640015,-23.421547,-604.739990"
		wait 20
		call LockAndWait -Loc "700.012024,-23.477221,-603.180908" -RelayToGroup
		call LockAndWait -Loc "669.598999,-22.082491,-578.435913" -RelayToGroup
		wait 20
		call LockAndWait -Loc "682.445801,-23.477221,-561.693054" -RelayToGroup
		wait 20
		call Waywardcustomseattack 1
		call Waywardcustomcheckcombat
		call Waywardcustomseattack 0
		wait 5
		Face 127
		_muckID:Set[${Actor[Query, Name=="a muck digger" && X=658.489990 && Y=-22.099703 && Z=-547.700012].ID}]
		wait 5
		_muckID:Set[${Actor[Query, Name=="a muck digger" && X=658.489990 && Y=-22.099703 && Z=-547.700012].ID}]
		call SpawnEegutPull ${_muckID} "679.419983,-23.477221,-559.520020"
		wait 20
		call LockAndWait -Loc "688.998389,-23.477221,-561.773315" -RelayToGroup
		wait 20
		call Waywardcustomseattack 1
		call Waywardcustomcheckcombat
		call Waywardcustomseattack 0
		wait 5
		_muckID:Set[${Actor[Query, Name=="a muck digger" && X=695.270020 && Y=-22.099524 && Z=-534.500000].ID}]
		call SpawnEegutPull ${_muckID} "689.469971,-23.477221,-556.530029"
		wait 20
		call LockAndWait -Loc "695.168152,-23.477221,-562.178223" -RelayToGroup
		call LockAndWait -Loc "698.566223,-23.477221,-552.561523" -RelayToGroup
		call LockAndWait -Loc "701.191040,-23.423014,-558.817139" -RelayToGroup
		wait 20
		call Waywardcustomseattack 1
		call Waywardcustomcheckcombat
		call Waywardcustomseattack 0
		wait 5
		_muckID:Set[${Actor[Query, Name=="a muck digger" && X=726.450012 && Y=-23.477221 && Z=-549.250000].ID}]
		call SpawnEegutPull ${_muckID} "705.130005,-23.423008,-558.000000"
		wait 20
		call LockAndWait -Loc "694.949707,-23.477221,-564.592529" -RelayToGroup -WaitAfter 50
		call Waywardcustomseattack 1
		call Waywardcustomcheckcombat
		if !${Trigger} && ${_failcnt:Inc}<=5
		{
			call LockAndWait -Loc "689.920288,-22.523958,-592.715576" -RelayToGroup -WaitAfter 20
		}
	}
	if !${Trigger}
		call MessageBox "We failed spawning Eegut spawn him and resume at 694.949707,-23.477221,-564.592529"
	else
		Trigger:Set[0]

}
function Eegut()
{
	call CustomNamed "Eegut Stonegut" "720.989075,-21.799664,-586.574158"
}
function Yelloweyes()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["but towards"]
	IncomingText:Insert["dread to those nearby"]
	RI_CMD_AbilityEnableDisable "Cure Curse" 0
	declare YE_GotCursed bool global FALSE
	call CustomNamed "Yelloweyes-NMB" "627.560181,-7.976874,-528.934448" YelloweyesCustom
	RI_CMD_AbilityEnableDisable "Cure Curse" 1
	deletevariable YE_GotCursed
}
function YelloweyesCustom(int _NamedID)
{
	if ${Trigger} && ${TriggerMessage.Find["but towards"](exists)}
	{
		;echo TRIGGER ${TriggerMessage} // \${TriggerMessage.Find[${Me.Archetype}](exists)} // ${TriggerMessage.Find[${Me.Archetype}](exists)}
		if ${Me.Cursed}==1 && ${TriggerMessage.Find[${Me.Archetype}](exists)}
		{
			;echo its me and im the right archetype: ${TriggerMessage}
			YE_GotCursed:Set[1]
			relay ${RI_Var_String_RelayGroup} RI_Var_String_CurseName:Set[${Me.Name}]
			wait 10
		}
		elseif !${TriggerMessage.Find[${Me.Archetype}](exists)}
		{
			Trigger:Set[FALSE]
		}
		elseif ${TriggerMessage.Find[${Me.Archetype}](exists)} && ${Me.Cursed}<1 && ${YE_GotCursed}
		{
			Trigger:Set[FALSE]
			YE_GotCursed:Set[0]
		}
	}
	elseif ${Trigger} && ${TriggerMessage.Find["dread to those nearby"](exists)}
	{
		if ${Me.Distance[627.560181,-7.976874,-528.934448]}<5
			RIMUIObj:SetLockSpot[ALL,654.493103,-7.998078,-504.817383]
		else
			RIMUIObj:SetLockSpot[ALL,627.560181,-7.976874,-528.934448]
		Trigger:Set[0]
	}
	if ${RIMUIObj.MainIconIDExists[${_NamedID},717]}
	{
		if ${Me.Group}>4 && ${Me.Archetype.Equal[priest]}
			return
		call UseItem "Bottle of Screaming Flames" 2
	}
	if !${RI_Var_Bool_GlobalOthers}
	{
		call RIObj.Target ${_NamedID}
	}
}
function Waywardcustomvoilend()
{
	if ${RI_Var_Bool_GlobalOthers}
		while 1
			wait 1
	wait 50
	if ${Math.Distance[${Me.Y},-8.63]}>5
	{
		if ${Me.Distance[568.553040,-23.477221,-546.567139]}<10
		{
			call RIMObj.Move 559.836914 -23.477221 -563.800964 2 0 TRUE FALSE TRUE FALSE TRUE
			wait 20
		}
		if ${Math.Distance[${Me.Y},-21.759998]}<10
		{
			if ${Me.Distance[634.411987,-21.756823,-592.931702]}>10
				call RIMObj.Move 609.983154 -22.081347 -580.730896 2 0 TRUE FALSE TRUE FALSE TRUE
			call RIMObj.Move 634.411987 -21.756823 -592.931702 2 0 TRUE FALSE TRUE FALSE TRUE
			wait 20
			variable int MEY
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,OFF]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetRIFollow[ALL,OFF]
			MEY:Set[${Me.Y}]
			while ${Math.Distance[${Me.Y},${MEY}]}<5 || ( !${RIMObj.AllGroupWithinRange[5]} && !${Zone.Name.Find["[Solo]"]} )
			{
				relay ${RI_Var_String_RelayGroup} Actor["black hole 2"]:DoubleClick
				waitframe
			}
			wait 20
			wait 300 ${RIMObj.AllGroupWithinRange[5]}
		}
	}
	else
	{
		variable index:string _Locs
		variable int _i
		variable int _closestWaypointIndex=0
		variable int _closestWaypointDistance=10000

		_Locs:Insert["659.829102,-8.654459,-567.066162"]
		_Locs:Insert["640.386047,-8.654518,-567.132019"]
		_Locs:Insert["621.964294,-8.654470,-567.322693"]
		_Locs:Insert["616.246826,-8.601758,-542.237122"]
		_Locs:Insert["580.158691,-8.613431,-538.103394"]
		_Locs:Insert["556.280396,-8.651175,-538.393555"]
		_Locs:Insert["541.947693,-8.632845,-543.327942"]
		_Locs:Insert["535.962646,-8.654644,-579.741760"]
		_Locs:Insert["543.169434,-8.605640,-619.400146"]
		_Locs:Insert["582.494629,-8.613464,-623.567261"]
		_Locs:Insert["616.901306,-8.632845,-616.968994"]
		_Locs:Insert["622.863708,-8.654472,-593.817627"]
		_Locs:Insert["640.889343,-8.627186,-593.779663"]

		for(_i:Set[1];${_i}<=${_Locs.Used};_i:Inc)
		{
			if ${Me.Distance[${_Locs.Get[${_i}]}]}<${_closestWaypointDistance}
			{
				_closestWaypointDistance:Set[${Me.Distance[${_Locs.Get[${_i}]}]}]
				_closestWaypointIndex:Set[${_i}]
			}
		}
		for(_i:Set[${_closestWaypointIndex}];${_i}<=${_Locs.Used};_i:Inc)
		{
			call LockAndWait -Loc "${_Locs.Get[${_i}]}" -RelayToGroup
			wait 50 ${RIMObj.AllGroupWithinRange[3]}
		}
	}
	wait 20
}
function Voil()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["vanishes to another floor"]
	call CustomNamed "Tog Voil-NLP" "641.158752 -8.654509 -568.052856" VoilCustom
}
function VoilCustom(int _NamedID)
{
	variable int MEY=0
	if ${Trigger} || ${RIMUIObj.MainIconIDExists[${_NamedID},553]}
	{
		RIMUIObj:SetLockSpot[ALL,OFF]
		MEY:Set[${Me.Y}]
		if ${Math.Distance[${MEY},-8.627186]}<5
		{
			while ${Math.Distance[${Me.Y},${MEY}]}<5 || ( !${RIMObj.AllGroupWithinRange[5]} && !${Zone.Name.Find["[Solo]"]} )
			{
				relay ${RI_Var_String_RelayGroup} Actor["black hole 1"]:DoubleClick
				waitframe
			}
		}
		else
		{
			while ${Math.Distance[${Me.Y},${MEY}]}<5 || ( !${RIMObj.AllGroupWithinRange[5]} && !${Zone.Name.Find["[Solo]"]} )
			{
				relay ${RI_Var_String_RelayGroup} Actor["black hole 2"]:DoubleClick
				waitframe
			}
		}
		Trigger:Set[0]
		RIMUIObj:SetLockSpot[ALL,${Me.Loc}]
		if ${Zone.Name.Find["[Solo]"]}
			wait 150
		else
			wait 150 ${RIMObj.AllGroupWithinRange[5]} && !${RIMUIObj.MainIconIDExists[${_NamedID},553]}
	}
	if !${RI_Var_Bool_GlobalOthers}
		call RIObj.Target netherbian -Distance 10 baleful -Distance 10 umbral -Distance 10 rotting -Distance 10 ${_NamedID}
}
function Famyra()
{
	call CustomNamed "Famyra the Biblioghost" "760.726074 -8.550653 -733.980957" FamyraCustom
}
function FamyraCustom(int _NamedID)
{
	if !${RI_Var_Bool_GlobalOthers}
	{
		if ${Actor[an ancient tome](exists)}
		{
			call RIObj.Target ${Actor[an ancient tome].ID}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[an ancient tome].Loc},25,100]
		}
		else
		{
			call RIObj.Target ${_NamedID}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,760.295654,-8.550663,-731.974915]
		}
	}
}

;;;;;;;; End Fordel Midst: Wayward Manor
;;;;;;;; Start The Ruins of Ssraeshza
function Ruin()
{
	AnnounceText:Clear
	AnnounceText:Insert["The Architect of Ruin shines moonlight in your direction"]
	call CustomNamed "The Architect of Ruin" "-55.180870,-32.003540,-53.481030" RuinCustom
}
function RuinCustom(int _NamedID)
{
	if !${RI_Var_Bool_GlobalOthers}
		call RIObj.Target ${_NamedID}

	if ${Trigger}
	{	
		variable point3f PointSideMob
		PointSideMob:Set[${Position.PointAtAngle[${_NamedID},90,15]}]
		wait 1
		RIMUIObj:SetLockSpot[ALL,${PointSideMob}]
		wait 80
		if ${Me.Archetype.Equal[scout]}
			RIMUIObj:ComeOn[${Me.Name}]
		else
			RIMUIObj:SetLockSpot[ALL,"-55.180870,-32.003540,-53.481030"]
		Trigger:Set[0]
	}
}
function Ruinscustombridgehighlightcheck()
{
	if ${Zone.Name.Find["[Solo]"]}
		return
	while !${Actor[Query, Name=-"spike room button highlight" && Distance<5](exists)}
	{
		face 90
		wait 2
		press -hold w
		wait 5
		press -release w
		wait 20
	}
}
function Ruinscustombridge(int _Stage)
{
	if ${_Stage}==1
	{
		declare RI_Var_Int_RuinsCustomBridge int globalkeep 0
		;echo STAGE1
		CustomLoc:Set["0 0 0"]
		RI_Var_Bool_Follow:Set[0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,2.562085,-169.613907,-272.315216,1,100]
		;call RIMObj.Move 2.562085 -169.613907 -272.315216 1
		wait 20
		if ${Zone.Name.Find["[Solo]"]}
		{
			call ClickActor -Actor "spike room floor plate 1" -ExactName
			wait 20
		}
		call Ruinscustombridgehighlightcheck
		;echo after
		relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:StopMove[ALL]
		wait 5
		if ${Actor["invisible walkway 1"](exists)}
		{
			RIMUIObj:SetLockSpot[ALL,2.955392,-169.613541,-331.560211,1,100]
			wait 150 ${Me.Distance[2.955392,-169.613541,-331.560211]}<=1
			wait 20
			call Ruinscustombridgehighlightcheck
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,2.955392,-169.613541,-331.560211,1,100]
			wait 150 ${RIMObj.AllGroupWithinRange[2]}
			RI_Var_Bool_Follow:Set[1]
			call RIMObj.Move 16.154007 -169.877014 -336.855621
			wait 20
			call RIMObj.Move 15.675031 -169.877014 -349.420532
			RI_Var_Int_RuinsCustomBridge:Set[1]
			return
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-14.096043,-169.615326,-272.463654,1,100]
		;call RIMObj.Move -14.096043 -169.615326 -272.463654 1
		wait 20
		relay ${RI_Var_String_RelayGroup} RIMUIObj:StopMove[ALL]
		wait 5
		if ${Zone.Name.Find["[Solo]"]}
		{
			call ClickActor -Actor "spike room floor plate 2" -ExactName
			wait 20
		}
		call Ruinscustombridgehighlightcheck
		if ${Actor["invisible walkway 2"](exists)}
		{
			RIMUIObj:SetLockSpot[ALL,-14.137972,-169.614212,-331.667816,1,100]
			wait 150 ${Me.Distance[-14.137972,-169.614212,-331.667816]}<=1
			wait 20
			call Ruinscustombridgehighlightcheck
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-14.137972,-169.614212,-331.667816,1,100]
			wait 150 ${RIMObj.AllGroupWithinRange[2]}
			RI_Var_Bool_Follow:Set[1]
			call RIMObj.Move 16.154007 -169.877014 -336.855621
			wait 20
			call RIMObj.Move 15.675031 -169.877014 -349.420532
			RI_Var_Int_RuinsCustomBridge:Set[2]
			return
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-30.013706,-169.614395,-272.300049,1,100]
		;call RIMObj.Move -30.013706 -169.614395 -272.300049 1
		wait 20
		relay ${RI_Var_String_RelayGroup} RIMUIObj:StopMove[ALL]
		wait 5
		if ${Zone.Name.Find["[Solo]"]}
		{
			call ClickActor -Actor "spike room floor plate 3" -ExactName
			wait 20
		}
		call Ruinscustombridgehighlightcheck
		if ${Actor["invisible walkway 3"](exists)}
		{
			RIMUIObj:SetLockSpot[ALL,-29.919804,-169.614090,-331.608795,1,100]
			wait 150 ${Me.Distance[-29.919804,-169.614090,-331.608795]}<=1
			wait 20
			call Ruinscustombridgehighlightcheck
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-29.919804,-169.614090,-331.608795,1,100]
			wait 150 ${RIMObj.AllGroupWithinRange[2]}
			RI_Var_Bool_Follow:Set[1]
			call RIMObj.Move -76.967842 -169.877014 -336.179108
			wait 20
			call RIMObj.Move -77.043182 -169.877014 -350.282227
			RI_Var_Int_RuinsCustomBridge:Set[3]
			return
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-46.053577,-169.615494,-272.535797,1,100]
		;call RIMObj.Move -46.053577 -169.615494 -272.535797 1
		wait 20
		relay ${RI_Var_String_RelayGroup} RIMUIObj:StopMove[ALL]
		wait 5
		if ${Zone.Name.Find["[Solo]"]}
		{
			call ClickActor -Actor "spike room floor plate 4" -ExactName
			wait 20
		}
		call Ruinscustombridgehighlightcheck
		if ${Actor["invisible walkway 4"](exists)}
		{
			RIMUIObj:SetLockSpot[ALL,-45.959658,-169.614227,-331.557007,1,100]
			wait 150 ${Me.Distance[-45.959658,-169.614227,-331.557007]}<=1
			wait 20
			call Ruinscustombridgehighlightcheck
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-45.959658,-169.614227,-331.557007,1,100]
			wait 150 ${RIMObj.AllGroupWithinRange[2]}
			RI_Var_Bool_Follow:Set[1]
			call RIMObj.Move -76.967842 -169.877014 -336.179108
			wait 20
			call RIMObj.Move -77.043182 -169.877014 -350.282227
			RI_Var_Int_RuinsCustomBridge:Set[4]
			return
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-62.295345,-169.615356,-272.436615,1,100]
		;call RIMObj.Move -62.295345 -169.615356 -272.436615 1
		wait 20
		relay ${RI_Var_String_RelayGroup} RIMUIObj:StopMove[ALL]
		wait 5
		if ${Zone.Name.Find["[Solo]"]}
		{
			call ClickActor -Actor "spike room floor plate 5" -ExactName
			wait 20
		}
		call Ruinscustombridgehighlightcheck
		if ${Actor["invisible walkway 5"](exists)}
		{
			RIMUIObj:SetLockSpot[ALL,-61.826420,-169.614807,-331.659302,1,100]
			wait 150 ${Me.Distance[-61.826420,-169.614807,-331.659302]}<=1
			wait 20
			call Ruinscustombridgehighlightcheck
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-61.826420,-169.614807,-331.659302,1,100]
			wait 150 ${RIMObj.AllGroupWithinRange[2]}
			RI_Var_Bool_Follow:Set[1]
			call RIMObj.Move -76.967842 -169.877014 -336.179108
			wait 20
			call RIMObj.Move -77.043182 -169.877014 -350.282227
			RI_Var_Int_RuinsCustomBridge:Set[5]
			return
		}
		if ${RI_Var_Int_RuinsCustomBridge}==0
			call MessageBox "We did not see the invisible bridge do this part and resume when its up"
	}
	else
	{
		;echo STAGE2
		RI_Var_Bool_Follow:Set[0]
		if ${RI_Var_Int_RuinsCustomBridge}==5
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-62.036610,-169.614944,-331.611206,1,100]
			wait 150 ${Me.Distance[-62.036610,-169.614944,-331.611206]}<=1
			wait 20
			relay ${RI_Var_String_RelayGroup} RIMUIObj:StopMove[ALL]
			wait 5
			RIMUIObj:SetLockSpot[ALL,-62.295345,-169.615356,-272.436615,1,100]
			wait 150 ${Me.Distance[-62.295345,-169.615356,-272.436615]}<=1
			wait 20
			call Ruinscustombridgehighlightcheck
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-62.295345,-169.615356,-272.436615,1,100]
			wait 150 ${RIMObj.AllGroupWithinRange[2]}
		}
		if ${RI_Var_Int_RuinsCustomBridge}==4
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-45.790775,-169.615097,-331.717560,1,100]
			wait 150 ${Me.Distance[-45.790775,-169.615097,-331.717560]}<=1
			wait 20
			relay ${RI_Var_String_RelayGroup} RIMUIObj:StopMove[ALL]
			wait 5
			RIMUIObj:SetLockSpot[ALL,-46.053577,-169.615494,-272.535797,1,100]
			wait 150 ${Me.Distance[-46.053577,-169.615494,-272.535797]}<=1
			wait 20
			call Ruinscustombridgehighlightcheck
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-46.053577,-169.615494,-272.535797,1,100]
			wait 150 ${RIMObj.AllGroupWithinRange[2]}
		}
		if ${RI_Var_Int_RuinsCustomBridge}==3
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-29.782019,-169.614655,-331.666351,1,100]
			wait 150 ${Me.Distance[-29.782019,-169.614655,-331.666351]}<=1
			wait 20
			relay ${RI_Var_String_RelayGroup} RIMUIObj:StopMove[ALL]
			wait 5
			RIMUIObj:SetLockSpot[ALL,-30.013706,-169.614395,-272.300049,1,100]
			wait 150 ${Me.Distance[-30.013706,-169.614395,-272.300049]}<=1
			wait 20
			call Ruinscustombridgehighlightcheck
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-30.013706,-169.614395,-272.300049,1,100]
			wait 150 ${RIMObj.AllGroupWithinRange[2]}
		}
		if ${RI_Var_Int_RuinsCustomBridge}==2
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-13.979129,-169.614899,-331.664337,1,100]
			wait 150 ${Me.Distance[-13.979129,-169.614899,-331.664337]}<=1
			wait 20
			relay ${RI_Var_String_RelayGroup} RIMUIObj:StopMove[ALL]
			wait 5
			RIMUIObj:SetLockSpot[ALL,-14.096043,-169.615326,-272.463654,1,100]
			wait 150 ${Me.Distance[-14.096043,-169.615326,-272.463654]}<=1
			wait 20
			call Ruinscustombridgehighlightcheck
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-14.096043,-169.615326,-272.463654,1,100]
			wait 150 ${RIMObj.AllGroupWithinRange[2]}
		}
		if ${RI_Var_Int_RuinsCustomBridge}==1
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,2.020472,-169.614777,-331.541931,1,100]
			wait 150 ${Me.Distance[2.020472,-169.614777,-331.541931]}<=1
			wait 20
			relay ${RI_Var_String_RelayGroup} RIMUIObj:StopMove[ALL]
			wait 5
			RIMUIObj:SetLockSpot[ALL,2.562085,-169.613907,-272.315216,1,100]
			wait 150 ${Me.Distance[2.562085,-169.613907,-272.315216]}<=1
			wait 20
			call Ruinscustombridgehighlightcheck
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,2.562085,-169.613907,-272.315216,1,100]
			wait 150 ${RIMObj.AllGroupWithinRange[2]}
		}
		deletevariable RI_Var_Int_RuinsCustomBridge
	}
	RI_Var_Bool_Follow:Set[1]
}

function Vesshtri()
{
	call CustomNamed "Vesshtri the Swordfang" "-30.279108,-169.877014,-365.168732" VesshtriCustom
}
function VesshtriCustom()
{
	call RIObj.Target ${_NamedID}
	if ( ${Me.GetGameData[Target.Casting].Label.Equal[Slicing Fangs]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[Slicing Fangs]} )
	{
		RIMUIObj:SetLockSpot[OFF]
		RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[1]
		call MoveBehind 1
		RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[1]
	}
	else
	{
		if ${Me.Archetype.Equal[scout]} && ${RI_Var_Bool_GlobalOthers}
			noop
		else
		{
			RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
			call MoveBehind 0
			RI_Var_Bool_MoveBehindIgnoreAggroCheck:Set[0]
			RIMUIObj:SetLockSpot[ALL,-30.279108,-169.877014,-365.168732]
		}
	}
}
;Rath'Argoth
;Rath'Girosz
function Rath()
{
	call CustomNamed "Rath" "178.580353,-160.771133,-29.563877"
	call CustomNamed "Rath" "178.580353,-160.771133,-29.563877"
}
function RathCustom()
{
	;LOL cant figure out what to determine Time of day.
	;0.000107    12
	;30.000046   1
	;60.000015   2
	;90.000000   3
	;120.000000  4
	;149.999985  5
	;180.000000  6
	;210.000000  7
	;240.000000  8
	;270.000000  9
	;300.000000  10
	;329.999939  11
	;6pm to 5:59am
	if !${RI_Var_Bool_GlobalOthers}
	{
		if ${Actor[clock hour hand].Heading}==180.000000 || ${Actor[clock hour hand].Heading}==210.000000 || ${Actor[clock hour hand].Heading}==240.000000 || ${Actor[clock hour hand].Heading}==270.000000 || ${Actor[clock hour hand].Heading}==300.000000 || ${Actor[clock hour hand].Heading}==329.999939 || ${Actor[clock hour hand].Heading}==0.000107 || ${Actor[clock hour hand].Heading}==30.000046 || ${Actor[clock hour hand].Heading}==60.000015 || ${Actor[clock hour hand].Heading}==90.000000 || ${Actor[clock hour hand].Heading}==120.000000 || ${Actor[clock hour hand].Heading}==149.999985
		{
			echo 6PM to 6AM
			call RIObj.Target ${Actor[Rath'Girosz].ID}
		}
		else
		{
			echo 6AM to 6PM
			call RIObj.Target ${Actor[Rath'Argoth].ID}
		}
	}
}
function Ruinscustomclock()
{
	;Hour Clock
	;0.000107    12
	;30.000046   1
	;60.000015   2
	;90.000000   3
	;120.000000  4
	;149.999985  5
	;180.000000  6
	;210.000000  7
	;240.000000  8
	;270.000000  9
	;300.000000  10
	;329.999939  11
	variable int _failcnt
	_failcnt:Set[0]
	while ${Actor[clock adjustment].Interactable} && ${_failcnt:Inc}<=30
	{
		switch ${Actor[clock hour hand].Heading}
		{
			variable int _hour
			variable int _min
			variable string _minconvert
			variable int _cnt

			case 360.000000
			case 0.000107
			{
				_hour:Set[12]
				break
			}
			case 30.000046
			{
				_hour:Set[1]
				break
			}
			case 60.000015
			{
				_hour:Set[2]
				break
			}
			case 90.000000
			{
				_hour:Set[3]
				break
			}
			case 120.000000
			{
				_hour:Set[4]
				break
			}
			case 149.999985
			{
				_hour:Set[5]
				break
			}
			case 180.000000
			{
				_hour:Set[6]
				break
			}
			case 210.000000
			{
				_hour:Set[7]
				break
			}
			case 240.000000
			{
				_hour:Set[8]
				break
			}
			case 270.000000
			{
				_hour:Set[9]
				break
			}
			case 300.000000
			{
				_hour:Set[10]
				break
			}
			case 329.999939 
			{
				_hour:Set[11]
				break
			}
		}
		
		;MinuteClock
		;180.000000 0
		;210.000000 5
		;240.000000 10
		;270.000000 15
		;300.000000 20
		;330.000000 25
		;0.000000 30
		;30.000000 35
		;60.000000 40
		;90.000000 45
		;120.000000 50
		;150.000000 55
		if ${Actor[clock minute hand].Heading}>=180 && ${Actor[clock minute hand].Heading}<210
		{
			_min:Set[0]
			_minconvert:Set[00]
		}
		elseif ${Actor[clock minute hand].Heading}>=210 && ${Actor[clock minute hand].Heading}<240
		{
			_min:Set[5]
			_minconvert:Set[05]
		}
		elseif ${Actor[clock minute hand].Heading}>=240 && ${Actor[clock minute hand].Heading}<270
		{
			_min:Set[10]
			_minconvert:Set[10]
		}
		elseif ${Actor[clock minute hand].Heading}>=270 && ${Actor[clock minute hand].Heading}<300
		{
			_min:Set[15]
			_minconvert:Set[15]
		}
		elseif ${Actor[clock minute hand].Heading}>=300 && ${Actor[clock minute hand].Heading}<330
		{
			_min:Set[20]
			_minconvert:Set[20]
		}
		elseif ${Actor[clock minute hand].Heading}>=330 && ${Actor[clock minute hand].Heading}<360
		{
			_min:Set[25]
			_minconvert:Set[25]
		}
		elseif ${Actor[clock minute hand].Heading}>=0 && ${Actor[clock minute hand].Heading}<30
		{
			_min:Set[30]
			_minconvert:Set[30]
		}
		elseif ${Actor[clock minute hand].Heading}>=30 && ${Actor[clock minute hand].Heading}<60
		{
			_min:Set[35]
			_minconvert:Set[35]
		}
		elseif ${Actor[clock minute hand].Heading}>=60 && ${Actor[clock minute hand].Heading}<90
		{
			_min:Set[40]
			_minconvert:Set[40]
		}
		elseif ${Actor[clock minute hand].Heading}>=90 && ${Actor[clock minute hand].Heading}<120
		{
			_min:Set[45]
			_minconvert:Set[45]
		}
		elseif ${Actor[clock minute hand].Heading}>=120 && ${Actor[clock minute hand].Heading}<150
		{
			_min:Set[50]
			_minconvert:Set[50]
		}
		elseif ${Actor[clock minute hand].Heading}>=150 && ${Actor[clock minute hand].Heading}<180
		{
			_min:Set[55]
			_minconvert:Set[55]
		}

		;echo ${_hour}:${_min}
		_cnt:Set[0]
		while ${Actor[clock adjustment].Interactable} && ${_cnt:Inc}<=5
		{
			;echo inputing ${_hour}:${_minconvert}
			Actor[clock adjustment]:DoubleClick
			wait 2
			Actor[clock adjustment]:DoubleClick
			wait 2
			Actor[clock adjustment]:DoubleClick
			wait 2
			type ${_hour}:${_minconvert}
			wait 2
			press enter
			wait 2
			press enter
			wait 2
			press enter
			wait 10
			_min:Inc
			if ${_min}<10
				_minconvert:Set[0${_min}]
			else
				_minconvert:Set[${_min}]
		}
	}
	if ${Actor[clock adjustment].Interactable}
		call MessageBox "We failed inputing the correct time! please do so and resume"
}
function Gorgorah()
{
	wait 20
	echo ISXRI: Starting "Gorgorah the Shadowmania"

	call RIObj.LockAndPull "Gorgorah the Shadowmania" "-230.816711,-138.321747,65.921249" 10 FALSE
	
	while ${Actor[Dark Sphere](exists)} || ${EQ2.Zoning} || ${Me.IsDead}
	{
		call GorgorahCustom "Gorgorah the Shadowmania"
		waitframe
	}
	call MoveBehind 0
	wait 5
	wait 45 !${Me.IsMoving}
	if !${RI_Var_Bool_GlobalOthers} && ${Actor[Chest,radius,100](exists)} && ${Me.WaterDepth}==0 && !${Me.FlyingUsingMount} && !${RI_Var_Bool_SkipLoot}
	{
		eq2ex summon
		wait 2
		call RIMObj.LootChest
		wait 2
		eq2ex summon
	}
	wait 50 !${Me.IsMoving}
	echo ISXRI: Ending "Gorgorah the Shadowmania"
}
function GorgorahCustom(int _NamedID)
{
	if !${RI_Var_Bool_GlobalOthers}
	{
		call RIObj.Target ${_NamedID}
		if ${Me.Distance[${Actor[Dark Sphere].Loc}]}>5
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Dark Sphere].Loc}]
	}
}
function Ruinscustomrotatingramp()
{
	CustomLoc:Set["0 0 0"]
	if ${Zone.Name.Find["[Solo]"](exists)}
	{
		call LockAndWait -Loc "-230.865768,-138.321747,65.935303" -RelayToGroup -WaitAfter 20
		call ClickActor -Actor "Ramp Wheel" -LoopUntilNotInteractable
		wait 20
		call Ruinscustomrotatingrampsouthclicker
		call LockAndWait -Loc "-230.955933,-138.321777,66.540810" -RelayToGroup -WaitAfter 20
		call ClickActor -Actor "Ramp Wheel" -LoopUntilNotInteractable
		wait 20
		call Ruinscustomrotatingrampwestclicker
		call LockAndWait -Loc "-230.339355,-138.321793,65.972015" -RelayToGroup -WaitAfter 20
		call ClickActor -Actor "Ramp Wheel" -LoopUntilNotInteractable
		wait 20
		call Ruinscustomrotatingrampnorthclicker
		call LockAndWait -Loc "-230.911926,-138.321793,65.074127" -RelayToGroup -WaitAfter 20
		call ClickActor -Actor "Ramp Wheel" -LoopUntilNotInteractable
		wait 20
		call Ruinscustomrotatingrampdoorclicker
	}
	else
	{
		call LockAndWait -Loc "-230.865768,-138.321747,65.935303" -RelayToGroup -WaitAfter 20
		call Ruinscustomrotatingrampheroicrampwheelclicker
		wait 10
		call ReplyDialog -OnlyMain "Turn it clockwise."
		wait 70
		call Ruinscustomrotatingrampsouthclicker
		call LockAndWait -Loc "-230.865768,-138.321747,65.935303" -RelayToGroup -WaitAfter 20
		call Ruinscustomrotatingrampheroicrampwheelclicker
		wait 10
		call ReplyDialog -OnlyMain "Turn it clockwise."
		wait 70
		call Ruinscustomrotatingrampheroicrampwheelclicker
		wait 10
		call ReplyDialog -OnlyMain "Turn it clockwise."
		wait 70
		call Ruinscustomrotatingrampnorthclicker
		call LockAndWait -Loc "-230.865768,-138.321747,65.935303" -RelayToGroup -WaitAfter 20
		call Ruinscustomrotatingrampheroicrampwheelclicker
		wait 10
		call ReplyDialog -OnlyMain "Turn it counter-clockwise."
		wait 70
		call Ruinscustomrotatingrampheroicrampwheelclicker
		wait 10
		call ReplyDialog -OnlyMain "Turn it counter-clockwise."
		wait 70
		call Ruinscustomrotatingrampheroicrampwheelclicker
		wait 10
		call ReplyDialog -OnlyMain "Turn it clockwise."
		wait 70
		call Ruinscustomrotatingrampwestclicker
		call LockAndWait -Loc "-230.865768,-138.321747,65.935303" -RelayToGroup -WaitAfter 20
		call Ruinscustomrotatingrampheroicrampwheelclicker
		wait 10
		call ReplyDialog -OnlyMain "Turn it clockwise."
		wait 70
		call Ruinscustomrotatingrampheroicrampwheelclicker
		wait 10
		call ReplyDialog -OnlyMain "Turn it clockwise."
		wait 70
		call Ruinscustomrotatingrampdoorclicker
	}
}
function Ruinscustomrotatingrampheroicrampwheelclicker()
{
	variable bool _ReplyDialogExists=FALSE
	while !${_ReplyDialogExists}
	{
		call ClickActor "Ramp Wheel"
		if ${ReplyDialog(exists)}
			_ReplyDialogExists:Set[TRUE]
	}
}
function Ruinscustomrotatingrampsouthclicker()
{
	call LockAndWait -Loc "-266.064941,-138.171585,83.636192" -RelayToGroup -WaitAfter 20
	call LockAndWait -Loc "-255.383926,-129.851898,95.770897" -RelayToGroup
	call LockAndWait -Loc "-246.867188,-123.813736,101.068764" -RelayToGroup
	call LockAndWait -Loc "-231.284943,-119.911156,104.916855" -RelayToGroup -WaitAfter 20
	call LockAndWait -Loc "-230.944885,-119.008713,125.545479" -RelayToGroup -WaitAfter 20
	call ClickActor -Actor "rotating room switch 1" -LoopUntilNotInteractable
}
function Ruinscustomrotatingrampwestclicker()
{
	call LockAndWait -Loc "-211.376343,-138.170593,98.618301" -RelayToGroup -WaitAfter 20
	call LockAndWait -Loc "-200.538712,-129.586304,90.105934" -RelayToGroup
	call LockAndWait -Loc "-195.634186,-123.347252,80.561226" -RelayToGroup
	call LockAndWait -Loc "-191.089020,-119.911079,65.596695" -RelayToGroup -WaitAfter 20
	call LockAndWait -Loc "-171.394974,-119.008713,65.880814" -RelayToGroup -WaitAfter 20
	call ClickActor -Actor "rotating room switch 2" -LoopUntilNotInteractable
}
function Ruinscustomrotatingrampnorthclicker()
{
	call LockAndWait -Loc "-198.216522,-138.170471,46.499340" -RelayToGroup -WaitAfter 20
	call LockAndWait -Loc "-205.116867,-130.390686,35.127048" -RelayToGroup
	call LockAndWait -Loc "-216.467880,-123.340179,30.548471" -RelayToGroup
	call LockAndWait -Loc "-230.769180,-119.911186,26.486328" -RelayToGroup -WaitAfter 20
	call LockAndWait -Loc "-231.313339,-119.010963,6.266468" -RelayToGroup -WaitAfter 20
	call ClickActor -Actor "rotating room switch 3"
}
function Ruinscustomrotatingrampdoorclicker()
{
		call LockAndWait -Loc "-251.033478,-138.170746,33.295448" -RelayToGroup -WaitAfter 20
		call LockAndWait -Loc "-260.957916,-129.800522,41.678604" -RelayToGroup
		call LockAndWait -Loc "-266.202515,-123.451653,51.067505" -RelayToGroup
		call LockAndWait -Loc "-270.150482,-119.911316,65.258362" -RelayToGroup -WaitAfter 20
		call LockAndWait -Loc "-291.684448,-119.467720,65.702393" -RelayToGroup -WaitAfter 20
		call ClickActor -Actor "door rotating room" -LoopUntilNotInteractable
		wait 50
		call LockAndWait -Loc "-296.031250,-119.193039,65.853806" -RelayToGroup -WaitAfter 20
		call ClickActor -Actor "progression symbol - royalty" -LoopUntilNotInteractable
		call RIMObj.Move -265.222351 -119.818268 66.186760
}
function Ruinscustomsettings(int _Stage)
{
	;33345 - Hammer
	;33343 - Symbol
	;33344 - Sword
	;33342 - Staff
	variable int _FaceDegree=0
	if ${_Stage}==1
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-66.450790,-150.100403,-101.077026]
		wait 20
		declare RI_Var_Int_RuinsCustomSettingsSymbol1 int globalkeep 0
		waitframe
		while ${RI_Var_Int_RuinsCustomSettingsSymbol1}==0
		{
			_FaceDegree:Set[180]
			while !${Actor[center main symbol 1](exists)}
			{
				face ${_FaceDegree}
				wait 2
				press -hold ${RI_Var_String_ForwardKey}
				wait 5
				press -release ${RI_Var_String_ForwardKey}
				if ${Actor[center main symbol 1](exists)}
					RI_Var_Int_RuinsCustomSettingsSymbol1:Set[${Actor[center main symbol 1].TintFlags}]
				wait 3
				if ${_FaceDegree}==180
					_FaceDegree:Set[0]
				else	
					_FaceDegree:Set[180]
			}
			if ${Actor[center main symbol 1](exists)}
				RI_Var_Int_RuinsCustomSettingsSymbol1:Set[${Actor[center main symbol 1].TintFlags}]
			;echo ${RI_Var_Int_RuinsCustomSettingsSymbol1}
		}
		switch ${RI_Var_Int_RuinsCustomSettingsSymbol1}
		{
			case 33345
			{
				echo ISXRI: Setting symbol 1 as Hammer
				break
			}
			case 33343
			{
				echo ISXRI: Setting symbol 1 as Symbol
				break
			}
			case 33344
			{
				echo ISXRI: Setting symbol 1 as Sword
				break
			}
			case 33342
			{
				echo ISXRI: Setting symbol 1 as Staff
				break
			}
		}
	}
	elseif ${_Stage}==2
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-98.897934,-150.100403,-66.491386]
		wait 20
		declare RI_Var_Int_RuinsCustomSettingsSymbol2 int globalkeep 0
		waitframe
		while ${RI_Var_Int_RuinsCustomSettingsSymbol2}==0
		{
			_FaceDegree:Set[270]
			while !${Actor[center main symbol 2](exists)}
			{
				face ${_FaceDegree}
				wait 2
				press -hold ${RI_Var_String_ForwardKey}
				wait 5
				press -release ${RI_Var_String_ForwardKey}
				if ${Actor[center main symbol 2](exists)}
					RI_Var_Int_RuinsCustomSettingsSymbol2:Set[${Actor[center main symbol 2].TintFlags}]
				wait 3
				if ${_FaceDegree}==270
					_FaceDegree:Set[90]
				else	
					_FaceDegree:Set[270]
			}
			if ${Actor[center main symbol 2](exists)}
			{
				;echo setting to ${Actor[center main symbol 2].TintFlags}
				RI_Var_Int_RuinsCustomSettingsSymbol2:Set[${Actor[center main symbol 2].TintFlags}]
			}
			;echo ${RI_Var_Int_RuinsCustomSettingsSymbol2}
			wait 1
		}
		switch ${RI_Var_Int_RuinsCustomSettingsSymbol2}
		{
			case 33345
			{
				echo ISXRI: Setting symbol 2 as Hammer
				break
			}
			case 33343
			{
				echo ISXRI: Setting symbol 2 as Symbol
				break
			}
			case 33344
			{
				echo ISXRI: Setting symbol 2 as Sword
				break
			}
			case 33342
			{
				echo ISXRI: Setting symbol 2 as Staff
				break
			}
		}
	}
	elseif ${_Stage}==3
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-65.874435,-150.100418,-34.489075]
		wait 20
		declare RI_Var_Int_RuinsCustomSettingsSymbol3 int globalkeep 0
		waitframe
		while ${RI_Var_Int_RuinsCustomSettingsSymbol3}==0
		{
			_FaceDegree:Set[0]
			while !${Actor[center main symbol 3](exists)}
			{
				face ${_FaceDegree}
				wait 2
				press -hold ${RI_Var_String_ForwardKey}
				wait 5
				press -release ${RI_Var_String_ForwardKey}
				if ${Actor[center main symbol 3](exists)}
					RI_Var_Int_RuinsCustomSettingsSymbol3:Set[${Actor[center main symbol 3].TintFlags}]
				wait 3
				if ${_FaceDegree}==0
					_FaceDegree:Set[180]
				else	
					_FaceDegree:Set[0]
			}
			if ${Actor[center main symbol 3](exists)}
				RI_Var_Int_RuinsCustomSettingsSymbol3:Set[${Actor[center main symbol 3].TintFlags}]
			;echo ${RI_Var_Int_RuinsCustomSettingsSymbol3}
		}
		switch ${RI_Var_Int_RuinsCustomSettingsSymbol3}
		{
			case 33345
			{
				echo ISXRI: Setting symbol 3 as Hammer
				break
			}
			case 33343
			{
				echo ISXRI: Setting symbol 3 as Symbol
				break
			}
			case 33344
			{
				echo ISXRI: Setting symbol 3 as Sword
				break
			}
			case 33342
			{
				echo ISXRI: Setting symbol 3 as Staff
				break
			}
		}
	}
	elseif ${_Stage}==4
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-34.252087,-150.100403,-66.681160]
		wait 20
		declare RI_Var_Int_RuinsCustomSettingsSymbol4 int globalkeep 0
		waitframe
		while ${RI_Var_Int_RuinsCustomSettingsSymbol4}==0
		{
			_FaceDegree:Set[90]
			while !${Actor[center main symbol 4](exists)}
			{
				face ${_FaceDegree}
				wait 2
				press -hold ${RI_Var_String_ForwardKey}
				wait 5
				press -release ${RI_Var_String_ForwardKey}
				if ${Actor[center main symbol 4](exists)}
					RI_Var_Int_RuinsCustomSettingsSymbol4:Set[${Actor[center main symbol 4].TintFlags}]
				wait 3
				if ${_FaceDegree}==90
					_FaceDegree:Set[270]
				else	
					_FaceDegree:Set[90]
			}
			if ${Actor[center main symbol 4](exists)}
				RI_Var_Int_RuinsCustomSettingsSymbol4:Set[${Actor[center main symbol 4].TintFlags}]
			;echo ${RI_Var_Int_RuinsCustomSettingsSymbol4}
		}
		switch ${RI_Var_Int_RuinsCustomSettingsSymbol4}
		{
			case 33345
			{
				echo ISXRI: Setting symbol 4 as Hammer
				break
			}
			case 33343
			{
				echo ISXRI: Setting symbol 4 as Symbol
				break
			}
			case 33344
			{
				echo ISXRI: Setting symbol 4 as Sword
				break
			}
			case 33342
			{
				echo ISXRI: Setting symbol 4 as Staff
				break
			}
		}
	}
	else
	{
		variable int _cnt=0
		variable int _wordcnt=0
		variable string _word
		variable string _wordchange

		if ${_Stage} == 5 && ${RI_Var_Int_RuinsCustomSettingsSymbol1}>0
		{
			switch ${RI_Var_Int_RuinsCustomSettingsSymbol1}
			{
				case 33345
				{
					_word:Set[hammer]
					break
				}
				case 33343
				{
					_word:Set[symbol]
					break
				}
				case 33344
				{
					_word:Set[sword]
					break
				}
				case 33342
				{
					_word:Set[staff]
					break
				}
			}
			if ${_word.Equal[symbol]}
				_wordchange:Set[Shissar]
			else
				_wordchange:Set[${_word}]
			while !${Actor[statue 1 ${_wordchange} rings](exists)} && ${_cnt:Inc}<60
			{
				;echo inputing ${_word}
				Actor[switch transporter room statue]:DoubleClick
				wait 2
				Actor[switch transporter room statue]:DoubleClick
				wait 2
				Actor[switch transporter room statue]:DoubleClick
				wait 2
				type ${_word}
				wait 2
				press enter
				wait 2
				press enter
				wait 2
				press enter
				wait 20
				wait 300 ${Actor[switch transporter room statue].Interactable} || ${Actor[statue 1 ${_wordchange} rings](exists)}
				wait 20
			}
		}
		elseif ${_Stage} == 6 && ${RI_Var_Int_RuinsCustomSettingsSymbol2}>0
		{
			switch ${RI_Var_Int_RuinsCustomSettingsSymbol2}
			{
				case 33345
				{
					_word:Set[hammer]
					break
				}
				case 33343
				{
					_word:Set[symbol]
					break
				}
				case 33344
				{
					_word:Set[sword]
					break
				}
				case 33342
				{
					_word:Set[staff]
					break
				}
			}
			if ${_word.Equal[symbol]}
				_wordchange:Set[Shissar]
			else
				_wordchange:Set[${_word}]
			while !${Actor[statue 2 ${_wordchange} rings](exists)} && ${_cnt:Inc}<60
			{
				;echo inputing ${_word}
				Actor[switch transporter room statue]:DoubleClick
				wait 2
				Actor[switch transporter room statue]:DoubleClick
				wait 2
				Actor[switch transporter room statue]:DoubleClick
				wait 2
				type ${_word}
				wait 2
				press enter
				wait 2
				press enter
				wait 2
				press enter
				wait 20
				wait 300 ${Actor[switch transporter room statue].Interactable} || ${Actor[statue 2 ${_wordchange} rings](exists)}
				wait 20
			}
		}
		elseif ${_Stage} == 7 && ${RI_Var_Int_RuinsCustomSettingsSymbol3}>0
		{
			switch ${RI_Var_Int_RuinsCustomSettingsSymbol3}
			{
				case 33345
				{
					_word:Set[hammer]
					break
				}
				case 33343
				{
					_word:Set[symbol]
					break
				}
				case 33344
				{
					_word:Set[sword]
					break
				}
				case 33342
				{
					_word:Set[staff]
					break
				}
			}
			if ${_word.Equal[symbol]}
				_wordchange:Set[Shissar]
			else
				_wordchange:Set[${_word}]
			while !${Actor[statue 3 ${_wordchange} rings](exists)} && ${_cnt:Inc}<60
			{
				;echo inputing ${_word}
				Actor[switch transporter room statue]:DoubleClick
				wait 2
				Actor[switch transporter room statue]:DoubleClick
				wait 2
				Actor[switch transporter room statue]:DoubleClick
				wait 2
				type ${_word}
				wait 2
				press enter
				wait 2
				press enter
				wait 2
				press enter
				wait 20
				wait 300 ${Actor[switch transporter room statue].Interactable} || ${Actor[statue 3 ${_wordchange} rings](exists)}
				wait 20
			}
		}
		elseif ${_Stage} == 8 && ${RI_Var_Int_RuinsCustomSettingsSymbol4}>0
		{
			switch ${RI_Var_Int_RuinsCustomSettingsSymbol4}
			{
				case 33345
				{
					_word:Set[hammer]
					break
				}
				case 33343
				{
					_word:Set[symbol]
					break
				}
				case 33344
				{
					_word:Set[sword]
					break
				}
				case 33342
				{
					_word:Set[staff]
					break
				}
			}
			if ${_word.Equal[symbol]}
				_wordchange:Set[Shissar]
			else
				_wordchange:Set[${_word}]
			while !${Actor[statue 4 ${_wordchange} rings](exists)} && ${_cnt:Inc}<60
			{
				;echo inputing ${_word}
				Actor[switch transporter room statue]:DoubleClick
				wait 2
				Actor[switch transporter room statue]:DoubleClick
				wait 2
				Actor[switch transporter room statue]:DoubleClick
				wait 2
				type ${_word}
				wait 2
				press enter
				wait 2
				press enter
				wait 2
				press enter
				wait 20
				wait 300 ${Actor[switch transporter room statue].Interactable} || ${Actor[statue 4 ${_wordchange} rings](exists)}
				wait 20
			}
		}
		else
		{
			while ${Actor[switch transporter room statue].Interactable} && ${_cnt:Inc}<60 && !${_done}
			{
				if ${_wordcnt}<=4
					_wordcnt:Inc
				else
					_wordcnt:Set[1]
				switch ${_wordcnt}
				{
					case 1
					{
						_word:Set[hammer]
						break
					}
					case 2
					{
						_word:Set[staff]
						break
					}
					case 3
					{
						_word:Set[sword]
						break
					}
					case 4
					{
						_word:Set[symbol]
						break
					}
				}
				;echo inputing ${_word}
				Actor[switch transporter room statue]:DoubleClick
				wait 2
				Actor[switch transporter room statue]:DoubleClick
				wait 2
				Actor[switch transporter room statue]:DoubleClick
				wait 2
				type ${_word}
				wait 2
				press enter
				wait 2
				press enter
				wait 2
				press enter
				wait 20
				wait 300 ${Actor[switch transporter room statue].Interactable} || (!${Actor[switch transporter room statue].Interactable} && ${Actor[Query, Name=-"rings" && Distance<20](exists)})
				wait 20
			}
		}
	}

	if ${_Stage} == 8
	{
		if ${RI_Var_Int_RuinsCustomSettingsSymbol1(exists)}
			deletevariable RI_Var_Int_RuinsCustomSettingsSymbol1
		if ${RI_Var_Int_RuinsCustomSettingsSymbol2(exists)}
			deletevariable RI_Var_Int_RuinsCustomSettingsSymbol2
		if ${RI_Var_Int_RuinsCustomSettingsSymbol3(exists)}
			deletevariable RI_Var_Int_RuinsCustomSettingsSymbol3
		if ${RI_Var_Int_RuinsCustomSettingsSymbol4(exists)}
			deletevariable RI_Var_Int_RuinsCustomSettingsSymbol4
	}
}
function Xian()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["prepares to knock back everyone within 10 meters of him"]
	call CustomNamed "Kor Va Xian" "-64.815247,-146.063492,-67.061028" XianCustom
}
function XianCustom(string _NamedID)
{
	variable int _cnt=0
	if ${Me.Inventory[Query, Location=="Inventory" && Name=-"luclinite bomb"](exists)}
		Me.Inventory[Query, Location=="Inventory" && Name=-"luclinite bomb"]:Destroy
	if !${RI_Var_Bool_GlobalOthers}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-64.815247,-146.063492,-67.061028,1,100]
		call RIObj.Target ${_NamedID}
		if ${Trigger}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-22.005571,-150.100403,-66.243095,1,50]
			while ${_cnt:Inc}<50
			{
				wait 1
				if ${Me.Inventory[Query, Location=="Inventory" && Name=-"luclinite bomb"](exists)}
					Me.Inventory[Query, Location=="Inventory" && Name=-"luclinite bomb"]:Destroy
			}
			Trigger:Set[FALSE]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-64.815247,-146.063492,-67.061028,1,100]
		}
	}
	if ${Me.Distance[-66.381088,-150.144989,-173.367859]}<30
	{
		call RIMObj.Move -74.988770 -150.145538 -168.717789
 		call RIMObj.Move -66.579834 -150.059479 -148.639236
		call RIMObj.Move -64.815247 -146.063492 -67.061028
	}
	if ${Me.Distance[-173.887421,-150.144836,-66.360168]}<30
	{
		call RIMObj.Move -168.259125 -150.145538 -56.777462
		call RIMObj.Move -148.874969 -150.052078 -65.922531
		call RIMObj.Move -64.815247 -146.063492 -67.061028
	}
	if ${Me.Distance[-66.038216,-150.144638,42.165756]}<30
	{
		call RIMObj.Move -56.753090 -150.145340 37.059597
		call RIMObj.Move -65.613800 -150.052078 15.910136
		call RIMObj.Move -64.815247 -146.063492 -67.061028
	}
	if ${Me.Distance[44.267311,-150.144470,-65.781174]}<30
	{
		call RIMObj.Move 39.148270 -150.145096 -75.140190
		call RIMObj.Move 15.807122 -150.059402 -66.697403
		call RIMObj.Move -64.815247 -146.063492 -67.061028
	}
}
;;;;;;;; End The Ruins of Ssraeshza

;;;;;;;; Start The Venom of Ssraeshza

function Sekez()
{
	call CustomNamed "Rhag'Sekez-NMB" "33.876316,-188.258148,199.541458" SekezCustom
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsRangedAutoCheckBox,1]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsMeleeAutoCheckBox,1]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
}
function SekezCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
	variable int _cnt=0
	;supposed to pull him towards crystals for something i just T+S
	;33327 - Blue
	;33781 - Red
	;Midpoint formula - x=(x1 + x2)/2  z=(z1 + z2)/2
	if !${RI_Var_Bool_GlobalOthers}
	{
		;Proxima Noesis // 244 - BLUE
		;Proxima Sanguis // 390 - RED
		;Proxima Aequus // 757 - MID
		if ${RIMUIObj.MainIconIDExists[${_NamedID},244]} || ${RIMUIObj.MainIconIDExists[${_NamedID},390]}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsRangedAutoCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsMeleeAutoCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
			relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
			relay ${RI_Var_String_RelayGroup} eq2ex pet backoff
		}
		else
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsRangedAutoCheckBox,1]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsMeleeAutoCheckBox,1]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
		}
		if ${Actor[Query, Name=="" & TintFlags=33327](exists)} && ${Actor[Query, Name=="" & TintFlags=33781](exists)} 
		{
			if ${Me.Distance[${Math.Calc[(${Actor[Query, Name=="" & TintFlags=33327].X}+${Actor[Query, Name=="" & TintFlags=33781].X})/2]},-188.26,${Math.Calc[(${Actor[Query, Name=="" & TintFlags=33327].Z}+${Actor[Query, Name=="" & TintFlags=33781].Z})/2]}]}>5
			{
				wait 1
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Math.Calc[(${Actor[Query, Name=="" & TintFlags=33327].X}+${Actor[Query, Name=="" & TintFlags=33781].X})/2]},-188.26,${Math.Calc[(${Actor[Query, Name=="" & TintFlags=33327].Z}+${Actor[Query, Name=="" & TintFlags=33781].Z})/2]}]
				;echo wait 1
				_cnt:Set[0]
				while ${_cnt:Inc}<300 && ${Me.Distance[${Math.Calc[(${Actor[Query, Name=="" & TintFlags=33327].X}+${Actor[Query, Name=="" & TintFlags=33781].X})/2]},-188.26,${Math.Calc[(${Actor[Query, Name=="" & TintFlags=33327].Z}+${Actor[Query, Name=="" & TintFlags=33781].Z})/2]}]}>10
				{
					wait 1
					if ${RIMUIObj.MainIconIDExists[${_NamedID},244]} || ${RIMUIObj.MainIconIDExists[${_NamedID},390]}
					{
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsRangedAutoCheckBox,0]
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsMeleeAutoCheckBox,0]
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
						relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
						relay ${RI_Var_String_RelayGroup} eq2ex pet backoff
					}
					else
					{
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsRangedAutoCheckBox,1]
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsMeleeAutoCheckBox,1]
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
					}
				}
				;echo wait 2
				_cnt:Set[0]
				while ${_cnt:Inc}<300 && ${Actor[id,${_NamedID}].Distance}>7
				{
					wait 1
					if ${RIMUIObj.MainIconIDExists[${_NamedID},244]} || ${RIMUIObj.MainIconIDExists[${_NamedID},390]}
					{
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsRangedAutoCheckBox,0]
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsMeleeAutoCheckBox,0]
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
						relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
						relay ${RI_Var_String_RelayGroup} eq2ex pet backoff
					}
					else
					{
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsRangedAutoCheckBox,1]
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsMeleeAutoCheckBox,1]
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
					}
				}
				wait 300 ${Actor[id,${_NamedID}].Distance}<7
				;echo end wait
			}
			if ${RIMUIObj.MainIconIDExists[${_NamedID},244]}
			{
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsRangedAutoCheckBox,0]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsMeleeAutoCheckBox,0]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
				relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
				relay ${RI_Var_String_RelayGroup} eq2ex pet backoff
				RI_Obj_CB:SetUISetting[SettingsFaceMobCheckBox,0]
				;if ${Actor[id,${_NamedID}].Distance}<8
				if ${Me.Distance[${Math.Calc[(${Actor[Query, Name=="" & TintFlags=33327].X}+${Actor[Query, Name=="" & TintFlags=33781].X})/2]},-188.26,${Math.Calc[(${Actor[Query, Name=="" & TintFlags=33327].Z}+${Actor[Query, Name=="" & TintFlags=33781].Z})/2]}]}<10
				{
					Actor[Query, Name=="" & TintFlags=33781]:DoFace
					press -hold w
				}
				else
					press -release w
			}
			elseif ${RIMUIObj.MainIconIDExists[${_NamedID},390]}
			{
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsRangedAutoCheckBox,0]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsMeleeAutoCheckBox,0]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
				relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
				relay ${RI_Var_String_RelayGroup} eq2ex pet backoff
				RI_Obj_CB:SetUISetting[SettingsFaceMobCheckBox,0]
				;if ${Actor[id,${_NamedID}].Distance}<8
				if ${Me.Distance[${Math.Calc[(${Actor[Query, Name=="" & TintFlags=33327].X}+${Actor[Query, Name=="" & TintFlags=33781].X})/2]},-188.26,${Math.Calc[(${Actor[Query, Name=="" & TintFlags=33327].Z}+${Actor[Query, Name=="" & TintFlags=33781].Z})/2]}]}<10
				{
					Actor[Query, Name=="" & TintFlags=33327]:DoFace
					press -hold w
				}
				else
					press -release w
			}
			else
			{
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsRangedAutoCheckBox,1]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsMeleeAutoCheckBox,1]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_NamedID}].Loc},5,1000]
				RI_Obj_CB:SetUISetting[SettingsFaceMobCheckBox,1]
			}
		}
		else
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_NamedID}].Loc},5,1000]
		}
	}

}

function Voreth()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["reinforces her scales in a"]
	IncomingText:Insert["begin wane while she remains"]
	AnnounceText:Clear
	AnnounceText:Insert["Scales recede!"]
	call CustomNamed "Rhag'Voreth-NMB" "34.279888,-188.259293,351.201355" VorethCustom
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsRangedAutoCheckBox,1]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsMeleeAutoCheckBox,1]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
}
function VorethCustomHealthCheck(string _Loc)
{
	variable int _cnt=0
	while ${_cnt:Inc}<=300 && ${Me.Distance[${_Loc}]}>3
	{
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RIMUIObj:ComeOn[ALL]
		wait 1
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RIMUIObj:SetRIFollow[ALL,${Me.Name},1,200]
		wait 1
		if ${RIObj.LowestGroupHealth}<=50
			RIMUIObj:SetLockSpot[ALL,OFF]
		else
			RIMUIObj:SetLockSpot[ALL,${_Loc},1,1000]
		wait 1
	}
}
function VorethCustom(int _NamedID)
{
	;supposed to bring him in between the 2 colors that make up his layer, i just T+S, need to determine if the location of the colors change
	;also the text to determine his layer color is incomingtext
	if !${RI_Var_Bool_GlobalOthers}
	{
		variable int _cnt=0
		call RIObj.Target sentry -Distance 30 ${_NamedID}
		if ${Trigger}
		{
			;echo triggered ${TriggerMessage}
			if ${TriggerMessage.Find["begin wane while she remains"](exists)}
			{
				;echo wane
				Trigger:Set[0]
				return
			}
			if ${TriggerMessage.Find["Scales recede!"](exists)}
			{
				;echo recede
				Trigger:Set[0]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsRangedAutoCheckBox,1]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsMeleeAutoCheckBox,1]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
				wait 20
				Actor[id,${_NamedID}]:DoTarget
				Actor[id,${_NamedID}]:DoFace
				press -hold ${RI_Var_String_BackwardKey}
				wait 5
				press -release ${RI_Var_String_BackwardKey}
				;relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,34.279888,-188.259293,351.201355]
				return
			}
			
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsRangedAutoCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsMeleeAutoCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
			relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
			relay ${RI_Var_String_RelayGroup} eq2ex pet backoff
			;purple
			if ${TriggerMessage.Find["in a purple layer!"](exists)}
			{
				;echo purple
				call VorethCustomHealthCheck "-20.989998,-188.26,352.244995"
				wait 150 ${Actor[id,${_NamedID}].Distance}<8
				wait 10
				RIMUIObj:SetLockSpot[OFF]
				Actor[id,${_NamedID}]:DoFace
				press -hold s
				wait 5
				press -release s
				wait 5
			}
			;orange
			if ${TriggerMessage.Find["in an orange layer!"](exists)}
			{
				;echo orange
				call VorethCustomHealthCheck "90.870003,-188.26,352.269989"
				wait 150 ${Actor[id,${_NamedID}].Distance}<8
				wait 10
				RIMUIObj:SetLockSpot[OFF]
				Actor[id,${_NamedID}]:DoFace
				press -hold s
				wait 5
				press -release s
				wait 5
			}
			;green
			if ${TriggerMessage.Find["in a green layer!"](exists)}
			{
				;echo green
				call VorethCustomHealthCheck "69.180000,-188.26,352.284989"
				wait 150 ${Actor[id,${_NamedID}].Distance}<8
				wait 10
				RIMUIObj:SetLockSpot[OFF]
				Actor[id,${_NamedID}]:DoFace
				press -hold s
				wait 5
				press -release s
				wait 5
			}
			;silvery
			if ${TriggerMessage.Find["in a silvery layer!"](exists)}
			{
				;echo silver
				call VorethCustomHealthCheck "1.295000,-188.26,352.265000"
				wait 150 ${Actor[id,${_NamedID}].Distance}<8
				wait 10
				RIMUIObj:SetLockSpot[OFF]
				Actor[id,${_NamedID}]:DoFace
				press -hold s
				wait 5
				press -release s
				wait 5
			}
			;echo end if
		}
		
	}
	else
	{
		if ${Trigger}
			Trigger:Set[0]
	}
	;33577 red
	;33573 blue
	;33578 yellow
	;33783 white
	;33572 black
	;23:15:04:IT: Found reinforces her scales in PC 281146 Rhag'Voreth:Rhag'Voreth/a reinforces her scales in a purple layer!  - red and blue
	;23:16:12:IT: Found reinforces her scales in PC 281146 Rhag'Voreth:Rhag'Voreth/a reinforces her scales in an orange layer! red and yellow
	;23:16:34:IT: Found reinforces her scales in PC 281146 Rhag'Voreth:Rhag'Voreth/a reinforces her scales in a green layer! yellow and blue
	;23:16:34:IT: Found reinforces her scales in PC 281146 Rhag'Voreth:Rhag'Voreth/a reinforces her scales in a silvery layer!   -- Black and White
	;23:22:15:Announce: Rhag'Voreth's Arcane Scales recede! -- go back to lockspot
}
function Nazza()
{
	;AnnounceText:Clear
	;AnnounceText:Insert["A large bubble forms nearby!"]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
	relay ${RI_Var_String_RelayGroup} RI_Obj_CB:CastWhileMoving[1]
	if !${RI_Var_Bool_GlobalOthers}
		Actor[Arch Nemesis Rhag'Nazza]:DoTarget
	if !${RI_Var_Bool_GlobalOthers}
	{
		wait 1
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RIMUIObj:ComeOn[ALL]
		wait 1
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RIMUIObj:SetRIFollow[ALL,${Me.Name},1,200]
		wait 1
		;call RIMObj.Move 35.005032 -96.817757 276.104370
		call RIMObj.Move -28.056892 -169.374222 338.808685
		call RIMObj.Move -41.181824 -191.257996 351.601074
		relay "other ${RI_Var_String_RelayGroup}" -noredirect RIMUIObj:SetRIFollow[ALL,${Me.Name},1,200]
		wait 1
		wait 50
	}
	else
		wait 600 ${Me.Distance[-41.181824 -191.257996 351.601074]}<10
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
	call CustomNamed "Arch Nemesis Rhag'Nazza-NMB" "-41.181824,-191.257996,351.601074"
	if ${Me.Inventory["Totem of the Otter"].AutoConsumeOn}
		Me.Inventory["Totem of the Otter"]:ToggleAutoConsume
	relay ${RI_Var_String_RelayGroup} RI_Obj_CB:CastWhileMoving[0]
}
function NazzaCustom(int _NamedID)
{
	;goto X and Z of actor then swim down until not swimming
	;after the bubble pops call swim up then do again
	;if !${RI_Var_Bool_GlobalOthers}
	;{
	;	call RIObj.Target serpent -Distance 30 ${_NamedID}
	;	if ${Trigger}
	;	{
	;		call SwimUp
	;		call RIMObj.Move 34.915325 -96.817749 275.335999
	;		call RIMObj.Move ${Actor[Bubble Sphere].X} -96.817749 ${Actor[Bubble Sphere].Z}
	;		press -hold ${RI_Var_String_FlyDownKey}
	;		wait 30 !${Me.IsSwimming}
	;		press -release ${RI_Var_String_FlyDownKey}
	;		Trigger:Set[0]
	;	}
	;}
}
function Venomcustompuzzle()
{
	wait 50
	if ${Zone.Name.Find["[Solo]"]}
		return
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-40.999912,-188.258453,304.293152]
	wait 300 ${Me.Distance[-40.999912,-188.258453,304.293152]}<3
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-45.805195,-188.246704,241.902252]
	wait 300 ${Me.Distance[-45.805195,-188.246704,241.902252]}<3

	while ${Actor[Query, Name=-"a travailing flood control engineer" && IsDead=FALSE](exists)}
	{
		Actor[Query, Name=-"a travailing flood control engineer" && IsDead=FALSE]:DoTarget
		wait 1
	}

	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-40.999912,-188.258453,304.293152]
	wait 300 ${Me.Distance[-40.999912,-188.258453,304.293152]}<3
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-36.721031,-188.268921,347.077240]
	wait 300 ${Me.Distance[-36.721031,-188.268921,347.077240]}<3

	return
	CustomLoc:Set["0 0 0"]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Movable Block 10].Loc},1,1000]
	wait 300 ${Me.Distance[${Actor[Movable Block 10].Loc}]}<2
	wait 10
	Actor[Movable Block 10]:DoubleClick
	wait 2
	Actor[Movable Block 10]:DoubleClick
	wait 2
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,26.916777,-187.768707,358.294830,1,1000]
	wait 300 ${Me.Distance[26.916777,-187.768707,358.294830]}<2
	wait 10
	call PlaceHouseItem 270
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Movable Block 9].Loc},1,1000]
	wait 300 ${Me.Distance[${Actor[Movable Block 9].Loc}]}<2
	wait 10
	Actor[Movable Block 9]:DoubleClick
	wait 2
	Actor[Movable Block 9]:DoubleClick
	wait 2
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,26.873474,-187.811829,356.650818,1,1000]
	wait 300 ${Me.Distance[26.873474,-187.811829,356.650818]}<2
	wait 10
	call PlaceHouseItem 270
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[exactname,Movable Block 1].Loc},1,1000]
	wait 300 ${Me.Distance[${Actor[exactname,Movable Block 1].Loc}]}<2
	wait 10
	Actor[Movable Block 1]:DoubleClick
	wait 2
	Actor[Movable Block 1]:DoubleClick
	wait 2
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,26.873474,-187.811829,356.650818,1,1000]
	wait 300 ${Me.Distance[26.873474,-187.811829,356.650818]}<2
	wait 10
	call PlaceHouseItem 270
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-42.066479,-188.255829,352.178833,1,1000]
	wait 300 ${Me.Distance[-42.066479,-188.255829,352.178833]}<2
	wait 10
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-46.717861,-188.191879,264.867767,1,1000]
	wait 300 ${Me.Distance[-46.717861,-188.191879,264.867767]}<2
	wait 10
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Movable Block 8].Loc},1,1000]
	wait 300 ${Me.Distance[${Actor[Movable Block 8].Loc}]}<2
	wait 10
	Actor[Movable Block 8]:DoubleClick
	wait 2
	Actor[Movable Block 8]:DoubleClick
	wait 2
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-47.458832,-187.908234,267.332153,1,1000]
	wait 300 ${Me.Distance[-47.458832,-187.908234,267.332153]}<2
	wait 10
	call PlaceHouseItem 180
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Movable Block 7].Loc},1,1000]
	wait 300 ${Me.Distance[${Actor[Movable Block 7].Loc}]}<2
	wait 10
	Actor[Movable Block 7]:DoubleClick
	wait 2
	Actor[Movable Block 7]:DoubleClick
	wait 2
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-46.145863,-188.106247,267.204071,1,1000]
	wait 300 ${Me.Distance[-46.145863,-188.106247,267.204071]}<2
	wait 10
	call PlaceHouseItem 180
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-40.278946,-188.258133,199.546509,1,1000]
	wait 300 ${Me.Distance[-40.278946,-188.258133,199.546509]}<2
	wait 10
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,53.344505,-188.244736,194.070908,1,1000]
	wait 300 ${Me.Distance[53.344505,-188.244736,194.070908]}<2
	wait 10
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Movable Block 5].Loc},1,1000]
	wait 300 ${Me.Distance[${Actor[Movable Block 5].Loc}]}<2
	wait 10
	Actor[Movable Block 5]:DoubleClick
	wait 2
	Actor[Movable Block 5]:DoubleClick
	wait 2
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,42.896370,-187.781937,194.263763,1,1000]
	wait 300 ${Me.Distance[42.896370,-187.781937,194.263763]}<2
	wait 10
	call PlaceHouseItem 90
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,111.663849,-188.256470,201.077835,1,1000]
	wait 300 ${Me.Distance[111.663849,-188.256470,201.077835]}<2
	wait 10
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,116.272789,-188.245178,295.834717,1,1000]
	wait 300 ${Me.Distance[116.272789,-188.245178,295.834717]}<2
	wait 10
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Movable Block 6].Loc},1,1000]
	wait 300 ${Me.Distance[${Actor[Movable Block 6].Loc}]}<2
	wait 10
	Actor[Movable Block 6]:DoubleClick
	wait 2
	Actor[Movable Block 6]:DoubleClick
	wait 2
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,117.468658,-188.004822,284.057831,1,1000]
	wait 300 ${Me.Distance[117.468658,-188.004822,284.057831]}<2
	wait 10
	call PlaceHouseItem 0
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Movable Block 4].Loc},1,1000]
	wait 300 ${Me.Distance[${Actor[Movable Block 4].Loc}]}<2
	wait 10
	Actor[Movable Block 4]:DoubleClick
	wait 2
	Actor[Movable Block 4]:DoubleClick
	wait 2
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,116.054306,-187.967697,283.933472,1,1000]
	wait 300 ${Me.Distance[115.054306,-187.967697,283.933472]}<2
	wait 10
	call PlaceHouseItem 0
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,109.647888,-188.259766,351.001038,1,1000]
	wait 300 ${Me.Distance[109.647888,-188.259766,351.001038]}<2
	wait 10
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,35.441181,-188.277100,344.728546,1,1000]
	wait 300 ${Me.Distance[35.441181,-188.277100,344.728546]}<2
	wait 10
	if !${Me.IsSwimming}
		call MessageBox "We failed the puzzle go see what we did wrong and fix it then resume right here"
}
;;;;;;;; End The Venom of Ssraeshza

;;;;;;;; Start The Vault of Ssraeshza
function Vaultcustomclickactor(string _ActorName, string _ToonName)
{
	waitframe
	if ${_ToonName.NotEqual[${Me.Name}]}
		return
	RI_CMD_PauseCombatBots 1
	wait 5
	Actor[${_ActorName}]:DoubleClick
	wait 5
	Actor[${_ActorName}]:DoubleClick
	wait 5
	Actor[${_ActorName}]:DoubleClick
	wait 5 ${Me.CastingSpell}
	wait 50 !${Me.CastingSpell}
	wait 5
	RI_CMD_PauseCombatBots 0
}
function Vaultcustomcheckcombat()
{
	while ( ${Me.InCombat} || ${Me.IsHated} ) && ${RI_Var_Bool_Start}
	{
		wait 1
	}
}
function Vaultcustomcylinder(int _Stage)
{
	CustomLoc:Set["0 0 0"]
	Follow:Set[0]
	
	variable int _HealerGroupNum=1
	variable int _NonHealerGroupNum=2
	variable int _cnt=0
	for(_cnt:Set[1];${_cnt}<${Me.Group};_cnt:Inc)
	{
		if ${RIObj.Archetype[${Me.Group[${_cnt}].ID}].Equal[priest]}
			_HealerGroupNum:Set[${_cnt}]
		else
			_NonHealerGroupNum:Set[${_cnt}]
	}
	;echo ${_HealerGroupNum}
	;echo ${_NonHealerGroupNum}
	switch ${_Stage}
	{
		case 1
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:StopMove[ALL]
			wait 1
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-262.961761,-161.829285,669.940125]
			wait 10
			waitframe
			RIMUIObj:SetLockSpot[${Me.Name},-273.110748,-161.829224,669.290955]
			if ${Zone.Name.Find["[Heroic]"](exists)}
			{
				;echo heroic
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-257.282471,-161.829285,664.449585]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-257.226837,-161.829285,677.867188]
				wait 300 ${Me.Distance[-273.110748,-161.829224,669.290955]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-257.282471,-161.829285,664.449585]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-257.226837,-161.829285,677.867188]}<3
				wait 10
				while ${Actor[sphere red main room](exists)}
				{
					relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Vaultcustomclickactor \"sphere red main room\" ${Me.Group[${_HealerGroupNum}]}"]
					relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Vaultcustomclickactor \"sphere red main room\" ${Me.Group[${_NonHealerGroupNum}]}"]
					call Vaultcustomclickactor "sphere red main room" ${Me.Name}
					wait 50
				}
				RIMUIObj:SetLockSpot[${Me.Name},-291.647064,-161.829285,671.121887]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-291.647064,-161.829285,671.121887]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-291.647064,-161.829285,671.121887]
				wait 300 ${Me.Distance[-291.647064,-161.829285,671.121887]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-291.647064,-161.829285,671.121887]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-291.647064,-161.829285,671.121887]}<3
				wait 10
 				RIMUIObj:SetLockSpot[${Me.Name},-311.337646,-161.829285,692.773254]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-311.337646,-161.829285,692.773254]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-311.337646,-161.829285,692.773254]
				wait 300 ${Me.Distance[-311.337646,-161.829285,692.773254]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-311.337646,-161.829285,692.773254]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-311.337646,-161.829285,692.773254]}<3
				wait 30
				call Vaultcustomcheckcombat
				while !${Actor[Query, Name=="sphere red side room" && Distance<10](exists)}
				{
					call Vaultcustomclickactor "sphere stand red room" ${Me.Name}
					wait 5
				}
				;RIMUIObj:SetLockSpot[${Me.Name},-312.820770,-161.573547,671.091980]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-312.820770,-161.573547,671.091980]
				;relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-312.820770,-161.573547,671.091980]
				;relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-312.820770,-161.573547,671.091980]
				wait 300 ${Me.Distance[-312.820770,-161.573547,671.091980]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-312.820770,-161.573547,671.091980]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-312.820770,-161.573547,671.091980]}<3
				wait 20
				call Vaultcustomcheckcombat
				RIMUIObj:SetLockSpot[${Me.Name},-311.337646,-161.829285,692.773254]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-311.337646,-161.829285,692.773254]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-311.337646,-161.829285,692.773254]
				wait 300 ${Me.Distance[-311.337646,-161.829285,692.773254]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-311.337646,-161.829285,692.773254]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-311.337646,-161.829285,692.773254]}<3
				wait 10
				while ${Actor[sphere purple red room](exists)}
				{
					call Vaultcustomclickactor "sphere purple red room" ${Me.Name}
					wait 5
				}

				RIMUIObj:SetLockSpot[${Me.Name},-327.152283,-161.829285,655.283875]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-327.152283,-161.829285,655.283875]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-327.152283,-161.829285,655.283875]
				wait 300 ${Me.Distance[-327.152283,-161.829285,655.283875]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-327.152283,-161.829285,655.283875]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-327.152283,-161.829285,655.283875]}<3
				wait 30
				call Vaultcustomcheckcombat
				while !${Actor[Query, Name=="sphere red side room" && Distance<10](exists)}
				{
					relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Vaultcustomclickactor \"sphere stand red room\" ${Me.Group[${_HealerGroupNum}]}"]
					wait 50
				}
				;call Vaultcustomclickactor "sphere stand red room" ${Me.Name}
				RIMUIObj:SetLockSpot[${Me.Name},-312.820770,-161.573547,671.091980]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-312.820770,-161.573547,671.091980]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-312.820770,-161.573547,671.091980]
				wait 300 ${Me.Distance[-312.820770,-161.573547,671.091980]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-312.820770,-161.573547,671.091980]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-312.820770,-161.573547,671.091980]}<3
				wait 20
				call Vaultcustomcheckcombat
				RIMUIObj:SetLockSpot[${Me.Name},-327.152283,-161.829285,655.283875]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-327.152283,-161.829285,655.283875]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-327.152283,-161.829285,655.283875]
				wait 300 ${Me.Distance[-327.152283,-161.829285,655.283875]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-327.152283,-161.829285,655.283875]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-327.152283,-161.829285,655.283875]}<3
				wait 10
				while ${Actor[sphere purple red room](exists)}
				{
					relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Vaultcustomclickactor \"sphere purple red room\" ${Me.Group[${_HealerGroupNum}]}"]
					wait 50
				}
				;call Vaultcustomclickactor "sphere purple red room" ${Me.Name}

				RIMUIObj:SetLockSpot[${Me.Name},-299.530731,-161.829285,656.073975]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-299.530731,-161.829285,656.073975]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-299.530731,-161.829285,656.073975]
				wait 300 ${Me.Distance[-299.530731,-161.829285,656.073975]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-299.530731,-161.829285,656.073975]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-299.530731,-161.829285,656.073975]}<3
				wait 30
				call Vaultcustomcheckcombat
				while !${Actor[Query, Name=="sphere red side room" && Distance<10](exists)}
				{
					relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Vaultcustomclickactor \"sphere stand red room\" ${Me.Group[${_NonHealerGroupNum}]}"]
					wait 50
				}
				;call Vaultcustomclickactor "sphere stand red room" ${Me.Name}
				RIMUIObj:SetLockSpot[${Me.Name},-312.820770,-161.573547,671.091980]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-312.820770,-161.573547,671.091980]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-312.820770,-161.573547,671.091980]
				wait 300 ${Me.Distance[-312.820770,-161.573547,671.091980]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-312.820770,-161.573547,671.091980]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-312.820770,-161.573547,671.091980]}<3
				wait 20
				call Vaultcustomcheckcombat
				RIMUIObj:SetLockSpot[${Me.Name},-299.530731,-161.829285,656.073975]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-299.530731,-161.829285,656.073975]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-299.530731,-161.829285,656.073975]
				wait 300 ${Me.Distance[-299.530731,-161.829285,656.073975]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-299.530731,-161.829285,656.073975]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-299.530731,-161.829285,656.073975]}<3
				wait 10
				while ${Actor[sphere purple red room](exists)}
				{
					relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Vaultcustomclickactor \"sphere purple red room\" ${Me.Group[${_NonHealerGroupNum}]}"]
					wait 50
				}
				;call Vaultcustomclickactor "sphere purple red room" ${Me.Name}
				RIMUIObj:SetLockSpot[${Me.Name},-290.433411,-161.829285,671.646301]
				;relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-290.433411,-161.829285,671.646301]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-290.433411,-161.829285,671.646301]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-290.433411,-161.829285,671.646301]
				wait 300 ${Me.Distance[-290.433411,-161.829285,671.646301]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-290.433411,-161.829285,671.646301]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-290.433411,-161.829285,671.646301]}<3
				wait 20
				RIMUIObj:SetLockSpot[ALL,-273.762756,-161.829285,668.977661]
				;relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-273.762756,-161.829285,668.977661]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-273.762756,-161.829285,668.977661]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-273.762756,-161.829285,668.977661]
				wait 300 ${Me.Distance[-273.762756,-161.829285,668.977661]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-273.762756,-161.829285,668.977661]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-273.762756,-161.829285,668.977661]}<3
				relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,OFF]
				wait 1
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-257.221924,-161.829285,663.889587]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-257.311310,-161.829285,677.926880]
				wait 300 ${Me.Group[${_HealerGroupNum}].Distance[-257.221924,-161.829285,663.889587]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-257.311310,-161.829285,677.926880]}<3
				wait 20
				call Vaultcustomcheckcombat
				while ${Actor[sphere stand red main room].Interactable}
				{
					call Vaultcustomclickactor "sphere stand red main room" ${Me.Name}
					relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Vaultcustomclickactor \"sphere stand red main room\" ${Me.Group[${_HealerGroupNum}]}"]
					relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Vaultcustomclickactor \"sphere stand red main room\" ${Me.Group[${_NonHealerGroupNum}]}"]
					wait 50
				}
				RIMUIObj:SetLockSpot[${Me.Name},-253.010101,-161.829285,669.038086]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-268.573120,-161.829285,677.886414]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-268.618408,-161.829269,663.965271]
				wait 300 ${Me.Distance[-253.010101,-161.829285,669.038086]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-268.573120,-161.829285,677.886414]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-268.618408,-161.829269,663.965271]}<3
				wait 10
				while ${Actor[sphere blue main room](exists)}
				{
					relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Vaultcustomclickactor \"sphere blue main room\" ${Me.Group[${_HealerGroupNum}]}"]
					relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Vaultcustomclickactor \"sphere blue main room\" ${Me.Group[${_NonHealerGroupNum}]}"]
					call Vaultcustomclickactor "sphere blue main room" ${Me.Name}
					wait 50
				}
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-262.900024,-161.829285,673.577942]
				wait 1
				RIMUIObj:SetLockSpot[${Me.Name},-235.028915,-161.829285,671.241638]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-235.028915,-161.829285,671.241638]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-235.028915,-161.829285,671.241638]
				wait 300 ${Me.Distance[-235.028915,-161.829285,671.241638]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-235.028915,-161.829285,671.241638]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-235.028915,-161.829285,671.241638]}<3
				wait 10
				RIMUIObj:SetLockSpot[${Me.Name},-214.817184,-161.829285,650.185303]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-214.817184,-161.829285,650.185303]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-214.817184,-161.829285,650.185303]
				wait 300 ${Me.Distance[-214.817184,-161.829285,650.185303]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-214.817184,-161.829285,650.185303]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-214.817184,-161.829285,650.185303]}<3
				wait 30
				call Vaultcustomcheckcombat
				while !${Actor[Query, Name=="sphere blue side room" && Distance<10](exists)}
				{
					call Vaultcustomclickactor "sphere stand blue room" ${Me.Name}
					wait 5
				}
				;RIMUIObj:SetLockSpot[${Me.Name},-212.465637,-161.573547,671.214172]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-212.465637,-161.573547,671.214172]
				;relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-212.465637,-161.573547,671.214172]
				;relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-212.465637,-161.573547,671.214172]
				wait 300 ${Me.Distance[-212.465637,-161.573547,671.214172]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-212.465637,-161.573547,671.214172]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-212.465637,-161.573547,671.214172]}<3
				wait 20
				call Vaultcustomcheckcombat
				RIMUIObj:SetLockSpot[${Me.Name},-214.817184,-161.829285,650.185303]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-214.817184,-161.829285,650.185303]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-214.817184,-161.829285,650.185303]
				wait 300 ${Me.Distance[-214.817184,-161.829285,650.185303]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-214.817184,-161.829285,650.185303]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-214.817184,-161.829285,650.185303]}<3
				wait 10
				while ${Actor[sphere purple blue room](exists)}
				{
					call Vaultcustomclickactor "sphere purple blue room" ${Me.Name}
					wait 5
				}
				RIMUIObj:SetLockSpot[${Me.Name},-196.775833,-161.829285,685.502563]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-196.775833,-161.829285,685.502563]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-196.775833,-161.829285,685.502563]
				wait 300 ${Me.Distance[-196.775833,-161.829285,685.502563]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-196.775833,-161.829285,685.502563]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-196.775833,-161.829285,685.502563]}<3
				wait 30
				call Vaultcustomcheckcombat
				while !${Actor[Query, Name=="sphere blue side room" && Distance<10](exists)}
				{
					relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Vaultcustomclickactor \"sphere stand blue room\" ${Me.Group[${_HealerGroupNum}]}"]
					wait 50
				}
				;call Vaultcustomclickactor "sphere stand blue room" ${Me.Name}
				RIMUIObj:SetLockSpot[${Me.Name},-212.465637,-161.573547,671.214172]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-212.465637,-161.573547,671.214172]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-212.465637,-161.573547,671.214172]
				wait 300 ${Me.Distance[-212.465637,-161.573547,671.214172]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-212.465637,-161.573547,671.214172]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-212.465637,-161.573547,671.214172]}<3
				wait 20
				call Vaultcustomcheckcombat
				RIMUIObj:SetLockSpot[${Me.Name},-196.775833,-161.829285,685.502563]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-196.775833,-161.829285,685.502563]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-196.775833,-161.829285,685.502563]
				wait 300 ${Me.Distance[-196.775833,-161.829285,685.502563]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-196.775833,-161.829285,685.502563]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-196.775833,-161.829285,685.502563]}<3
				wait 10
				while ${Actor[sphere purple blue room](exists)}
				{
					relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Vaultcustomclickactor \"sphere purple blue room\" ${Me.Group[${_HealerGroupNum}]}"]
					wait 50
				}
				;call Vaultcustomclickactor "sphere purple blue room" ${Me.Name}

				RIMUIObj:SetLockSpot[${Me.Name},-227.337921,-161.829285,684.763855]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-227.337921,-161.829285,684.763855]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-227.337921,-161.829285,684.763855]
				wait 300 ${Me.Distance[-227.337921,-161.829285,684.763855]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-227.337921,-161.829285,684.763855]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-227.337921,-161.829285,684.763855]}<3
				wait 30
				call Vaultcustomcheckcombat
				while !${Actor[Query, Name=="sphere blue side room" && Distance<10](exists)}
				{
					relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Vaultcustomclickactor \"sphere stand blue room\" ${Me.Group[${_NonHealerGroupNum}]}"]
					wait 50
				}
				;call Vaultcustomclickactor "sphere stand blue room" ${Me.Name}
				
				RIMUIObj:SetLockSpot[${Me.Name},-212.465637,-161.573547,671.214172]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-212.465637,-161.573547,671.214172]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-212.465637,-161.573547,671.214172]
				wait 300 ${Me.Distance[-212.465637,-161.573547,671.214172]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-212.465637,-161.573547,671.214172]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-212.465637,-161.573547,671.214172]}<3
				wait 20
				call Vaultcustomcheckcombat
				RIMUIObj:SetLockSpot[${Me.Name},-227.337921,-161.829285,684.763855]
				relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,OFF]
				wait 1
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-227.337921,-161.829285,684.763855]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-227.337921,-161.829285,684.763855]
				wait 300 ${Me.Distance[-227.337921,-161.829285,684.763855]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-227.337921,-161.829285,684.763855]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-227.337921,-161.829285,684.763855]}<3
				wait 10
				while ${Actor[sphere purple blue room](exists)}
				{
					relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Vaultcustomclickactor \"sphere purple blue room\" ${Me.Group[${_NonHealerGroupNum}]}"]
					wait 50
				}
				;call Vaultcustomclickactor "sphere purple blue room" ${Me.Name}
				RIMUIObj:SetLockSpot[${Me.Name},-235.028915,-161.829285,671.241638]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-235.028915,-161.829285,671.241638]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-235.028915,-161.829285,671.241638]
				wait 300 ${Me.Distance[-235.028915,-161.829285,671.241638]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-235.028915,-161.829285,671.241638]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-235.028915,-161.829285,671.241638]}<3
				wait 10
				RIMUIObj:SetLockSpot[ALL,-252.601685,-161.829285,668.994751]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-252.601685,-161.829285,668.994751]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-252.601685,-161.829285,668.994751]
				wait 300 ${Me.Distance[-252.601685,-161.829285,668.994751]}<3 && ${Me.Group[${_HealerGroupNum}].Distance[-252.601685,-161.829285,668.994751]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-252.601685,-161.829285,668.994751]}<3
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}]},-268.173248,-161.831635,678.114685]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-268.662903,-161.830978,663.932739]
				wait 300 ${Me.Group[${_HealerGroupNum}].Distance[-268.173248,-161.831635,678.114685]}<3 && ${Me.Group[${_NonHealerGroupNum}].Distance[-268.662903,-161.830978,663.932739]}<3
				wait 20
				call Vaultcustomcheckcombat
				while ${Actor[sphere stand blue main room].Interactable}
				{
					call Vaultcustomclickactor "sphere stand blue main room" ${Me.Name}
					relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Vaultcustomclickactor \"sphere stand blue main room\" ${Me.Group[${_HealerGroupNum}]}"]
					relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call Vaultcustomclickactor \"sphere stand blue main room\" ${Me.Group[${_NonHealerGroupNum}]}"]
					wait 50
				}
				wait 20
			}
			else
			{
				wait 300 ${Me.Distance[-273.110748,-161.829224,669.290955]}<3
				wait 10
				while ${Actor[sphere red main room](exists)}
				{
					call Vaultcustomclickactor "sphere red main room" ${Me.Name}
					wait 5
				}
				RIMUIObj:SetLockSpot[${Me.Name},-291.647064,-161.829285,671.121887]
				wait 300 ${Me.Distance[-291.647064,-161.829285,671.121887]}<3
				wait 10
				RIMUIObj:SetLockSpot[${Me.Name},-311.337646,-161.829285,692.773254]
				wait 300 ${Me.Distance[-311.337646,-161.829285,692.773254]}<3
				wait 30
				call Vaultcustomcheckcombat
				while !${Actor[sphere red side room](exists)}
				{
					call Vaultcustomclickactor "sphere stand red room" ${Me.Name}
					wait 5
				}
				wait 30
				RIMUIObj:SetLockSpot[${Me.Name},-312.820770,-161.573547,671.091980]
				wait 300 ${Me.Distance[-312.820770,-161.573547,671.091980]}<3
				wait 20
				call Vaultcustomcheckcombat
				wait 1
				RIMUIObj:SetLockSpot[${Me.Name},-311.337646,-161.829285,692.773254]
				wait 300 ${Me.Distance[-311.337646,-161.829285,692.773254]}<3
				wait 30
				while ${Actor[sphere purple red room](exists)}
				{
					call Vaultcustomclickactor "sphere purple red room" ${Me.Name}
					wait 5
				}
				RIMUIObj:SetLockSpot[${Me.Name},-290.433411,-161.829285,671.646301]
				wait 300 ${Me.Distance[-290.433411,-161.829285,671.646301]}<3
				wait 20
				RIMUIObj:SetLockSpot[ALL,-273.762756,-161.829285,668.977661]
				wait 20
				call Vaultcustomcheckcombat
				while ${Actor[sphere stand red main room].Interactable}
				{
					call Vaultcustomclickactor "sphere stand red main room" ${Me.Name}
					wait 5
				}
				RIMUIObj:SetLockSpot[${Me.Name},-253.010101,-161.829285,669.038086]
				wait 300 ${Me.Distance[-253.010101,-161.829285,669.038086]}<3
				wait 10
				while ${Actor[sphere blue main room](exists)}
				{
					call Vaultcustomclickactor "sphere blue main room" ${Me.Name}
					wait 5
				}
				wait 20
				RIMUIObj:SetLockSpot[${Me.Name},-235.028915,-161.829285,671.241638]
				wait 300 ${Me.Distance[-235.028915,-161.829285,671.241638]}<3
				wait 10
				RIMUIObj:SetLockSpot[${Me.Name},-214.817184,-161.829285,650.185303]
				wait 300 ${Me.Distance[-214.817184,-161.829285,650.185303]}<3
				wait 30
				call Vaultcustomcheckcombat
				while !${Actor[sphere blue side room](exists)}
				{
					call Vaultcustomclickactor "sphere stand blue room" ${Me.Name}
					wait 5
				}
				wait 30
				RIMUIObj:SetLockSpot[${Me.Name},-212.465637,-161.573547,671.214172]
				wait 300 ${Me.Distance[-212.465637,-161.573547,671.214172]}<3
				wait 20
				call Vaultcustomcheckcombat
				RIMUIObj:SetLockSpot[${Me.Name},-214.817184,-161.829285,650.185303]
				wait 300 ${Me.Distance[-214.817184,-161.829285,650.185303]}<3
				wait 30
				while ${Actor[sphere purple blue room](exists)}
				{
					call Vaultcustomclickactor "sphere purple blue room" ${Me.Name}
					wait 5
				}
				wait 20
				RIMUIObj:SetLockSpot[${Me.Name},-235.028915,-161.829285,671.241638]
				wait 300 ${Me.Distance[-235.028915,-161.829285,671.241638]}<3
				wait 10
				RIMUIObj:SetLockSpot[ALL,-252.601685,-161.829285,668.994751]
				wait 300 ${Me.Distance[-252.601685,-161.829285,668.994751]}<3
				wait 20
				call Vaultcustomcheckcombat
				while ${Actor[sphere stand blue main room].Interactable}
				{
					call Vaultcustomclickactor "sphere stand blue main room" ${Me.Name}
					wait 5
				}
				wait 20
			}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-262.961761,-161.829285,669.940125]
			break
		}
		case 2
		{
			call LockAndWait -Loc "-252.281433,-160.710953,602.785278" -RelayToGroup -WaitAfter 20
			;while ${Actor[platform 1].TintFlags}==33325
			;{
			;	relay ${RI_Var_String_RelayGroup} RIMUIObj:Jump[ALL]
			;	wait 20
			;}
			if ${Zone.Name.Find["[Heroic]"](exists)}
			{
				relay ${RI_Var_String_RelayGroup} RIMUIObj:StopMove[${Me.Group[${_NonHealerGroupNum}]}]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:PauseRIM[${Me.Group[${_NonHealerGroupNum}]}]
				wait 5
			}
			call LockAndWait -Loc "-235.660889,-161.957092,602.559326" -RelayToGroup
			if ${Zone.Name.Find["[Heroic]"](exists)}
			{
				wait 50
				relay ${RI_Var_String_RelayGroup} RIMUIObj:ResumeRIM[${Me.Group[${_NonHealerGroupNum}]}]
				wait 5
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-242.876694,-161.957092,602.456909]
				wait 20
				relay ${RI_Var_String_RelayGroup} RIMUIObj:StopMove[${Me.Group[${_NonHealerGroupNum}]}]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:PauseRIM[${Me.Group[${_NonHealerGroupNum}]}]
				wait 50
			}
			call LockAndWait -Loc "-207.338913,-161.701492,614.735168" -RelayToGroup
			wait 20
			call Vaultcustomcheckcombat
			call LockAndWait -Loc "-209.204666,-161.701477,589.636047" -RelayToGroup
			wait 20
			call Vaultcustomcheckcombat
			call LockAndWait -Loc "-235.880005,-161.957092,599.694702" -RelayToGroup
			if ${Zone.Name.Find["[Heroic]"](exists)}
			{
				wait 50
				relay ${RI_Var_String_RelayGroup} RIMUIObj:ResumeRIM[${Me.Group[${_NonHealerGroupNum}]}]
				wait 5
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-252.281433,-160.710953,602.785278]
				wait 20
				;while ${Actor[platform 1].TintFlags}==33325
				;{
				;	relay ${RI_Var_String_RelayGroup} RIMUIObj:Jump[${_NonHealerGroupNum}]
				;	wait 20
				;}
				relay ${RI_Var_String_RelayGroup} RIMUIObj:StopMove[${Me.Group[${_NonHealerGroupNum}]}]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:PauseRIM[${Me.Group[${_NonHealerGroupNum}]}]
				wait 50
			}
			call LockAndWait -Loc "-254.045181,-161.957092,598.039246" -RelayToGroup -WaitAfter 20
			if ${Zone.Name.Find["[Heroic]"](exists)}
				relay ${RI_Var_String_RelayGroup} RIMUIObj:ResumeRIM[${Me.Group[${_NonHealerGroupNum}]}]
			call LockAndWait -Loc "-273.203430,-160.710938,602.776428" -RelayToGroup -WaitAfter 20
			;while ${Actor[platform 2].TintFlags}==33325
			;{
			;	relay ${RI_Var_String_RelayGroup} RIMUIObj:Jump[ALL]
			;	wait 20
			;}
			if ${Zone.Name.Find["[Heroic]"](exists)}
			{
				relay ${RI_Var_String_RelayGroup} RIMUIObj:StopMove[${Me.Group[${_NonHealerGroupNum}]}]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:PauseRIM[${Me.Group[${_NonHealerGroupNum}]}]
				wait 5
			}
			call LockAndWait -Loc "-290.894104,-161.957108,603.059326" -RelayToGroup
			if ${Zone.Name.Find["[Heroic]"](exists)}
			{
				wait 50
				relay ${RI_Var_String_RelayGroup} RIMUIObj:ResumeRIM[${Me.Group[${_NonHealerGroupNum}]}]
				wait 5
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-283.306763,-161.375092,602.984375]
				wait 20
				relay ${RI_Var_String_RelayGroup} RIMUIObj:StopMove[${Me.Group[${_NonHealerGroupNum}]}]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:PauseRIM[${Me.Group[${_NonHealerGroupNum}]}]
				wait 50
			}
			call LockAndWait -Loc "-318.132263,-161.701477,588.526367" -RelayToGroup
			wait 20
			call Vaultcustomcheckcombat
			call LockAndWait -Loc "-316.133453,-161.701477,609.063843" -RelayToGroup
			wait 20
			call Vaultcustomcheckcombat
			call LockAndWait -Loc "-292.066254,-161.957108,602.119324" -RelayToGroup
			;if ${Zone.Name.Find["[Heroic]"](exists)}
			;{
			;	wait 50
			;	relay ${RI_Var_String_RelayGroup} RIMUIObj:ResumeRIM[${Me.Group[${_NonHealerGroupNum}]}]
			;	wait 5
			;	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}]},-273.203430,-160.710938,602.776428]
			;	wait 20
			;	while ${Actor[platform 1].TintFlags}==33325
			;	{
			;		relay ${RI_Var_String_RelayGroup} RIMUIObj:Jump[${_NonHealerGroupNum}]
			;		wait 20
			;	}
			;	relay ${RI_Var_String_RelayGroup} RIMUIObj:StopMove[${Me.Group[${_NonHealerGroupNum}]}]
			;	relay ${RI_Var_String_RelayGroup} RIMUIObj:PauseRIM[${Me.Group[${_NonHealerGroupNum}]}]
			;	wait 50
			;}
			call LockAndWait -Loc "-264.167175,-161.957092,594.597229" -RelayToGroup
			if ${Zone.Name.Find["[Heroic]"](exists)}
			{
				relay ${RI_Var_String_RelayGroup} RIMUIObj:ResumeRIM[${Me.Group[${_NonHealerGroupNum}]}]
				wait 20
			}
			call LockAndWait -Loc "-233.241333,-161.957092,602.651184" -RelayToGroup
			break
		}
	}
	Follow:Set[1]
}
function Vaultcustomfloorpanelcyl1(int _Room)
{
	variable bool _Activated=FALSE
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-262.808441,-161.829285,672.285889]
	wait 300 ${Me.Group[5].Distance[-262.808441,-161.829285,672.285889]}<3
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-313.167694,-161.573563,671.534241]
	wait 300 ${Me.Group[5].Distance[-313.167694,-161.573563,671.534241]}<3
	;-313.200012,-161.570007,671.299988
	wait 20
	while ${Actor[Query, Name=="switch ring" && X=-313.200012 && Y=-161.570007 && Z=671.299988].Aura.NotEqual[design_cylinder_cage_red]}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:Jump[${Me.Group[5]}]
		wait 20
	}
	wait 10
	while ${Actor[room ${_Room} floor switch 1].Interactable}
	{
		call Vaultcustomclickactor "room ${_Room} floor switch 1" ${Me.Name}
		_Activated:Set[1]
	}
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-262.808441,-161.829285,672.285889]
	wait 300 ${Me.Group[5].Distance[-262.808441,-161.829285,672.285889]}<3
	if !${_Activated}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-212.472153,-161.573547,671.407715]
		wait 300 ${Me.Group[5].Distance[-212.472153,-161.573547,671.407715]}<3
		;-212.500000,-161.570007,671.299988
		wait 20
		while ${Actor[Query, Name=="switch ring" && X=-212.500000 && Y=-161.570007 && Z=671.299988].Aura.NotEqual[design_cylinder_cage_red]}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Jump[${Me.Group[5]}]
			wait 20
		}
		wait 10
		while ${Actor[room ${_Room} floor switch 1].Interactable}
			call Vaultcustomclickactor "room ${_Room} floor switch 1" ${Me.Name}
		
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-262.808441,-161.829285,672.285889]
		wait 300 ${Me.Group[5].Distance[-262.808441,-161.829285,672.285889]}<3
	}
}
function Vaultcustomfloorpanelcyl2(int _Room)
{
	variable bool _Activated=FALSE
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-263.032898,-161.957092,596.951965]
	wait 300 ${Me.Group[5].Distance[-263.032898,-161.957092,596.951965]}<3
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-313.106720,-161.701477,602.750488]
	wait 300 ${Me.Group[5].Distance[-313.106720,-161.701477,602.750488]}<3
	;-313.250000,-161.699997,602.770020
	wait 20
	while ${Actor[Query, Name=="switch ring" && X=-313.250000 && Y=-161.699997 && Z=602.770020].Aura.NotEqual[design_cylinder_cage_red]}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:Jump[${Me.Group[5]}]
		wait 20
	}
	wait 10
	while ${Actor[room ${_Room} floor switch 2].Interactable}
	{
		call Vaultcustomclickactor "room ${_Room} floor switch 2" ${Me.Name}
		_Activated:Set[1]
	}
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-263.032898,-161.957092,596.951965]
	wait 300 ${Me.Group[5].Distance[-263.032898,-161.957092,596.951965]}<3
	if !${_Activated}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-212.654846,-161.701477,602.895752]
		wait 300 ${Me.Group[5].Distance[-212.654846,-161.701477,602.895752]}<3
		;-212.520004,-161.699997,602.840027
		wait 20
		while ${Actor[Query, Name=="switch ring" && X=-212.520004 && Y=-161.699997 && Z=602.840027].Aura.NotEqual[design_cylinder_cage_red]}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Jump[${Me.Group[5]}]
			wait 20
		}
		wait 10
		while ${Actor[room ${_Room} floor switch 2].Interactable}
			call Vaultcustomclickactor "room ${_Room} floor switch 2" ${Me.Name}
		
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-263.032898,-161.957092,596.951965]
		wait 300 ${Me.Group[5].Distance[-263.032898,-161.957092,596.951965]}<3
	}
}
function Vaultcustomfloorpanelcyl3(int _Room)
{
	variable bool _Activated=FALSE
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-262.912018,-161.957092,528.205078]
	wait 300 ${Me.Group[5].Distance[-262.912018,-161.957092,528.205078]}<3
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-313.175751,-161.701492,528.012756]
	wait 300 ${Me.Group[5].Distance[-313.175751,-161.701492,528.012756]}<3
	;-313.239990,-161.699997,527.890015
	wait 20
	while ${Actor[Query, Name=="switch ring" && X=-313.239990 && Y=-161.699997 && Z=527.890015].Aura.NotEqual[design_cylinder_cage_red]}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:Jump[${Me.Group[5]}]
		wait 20
	}
	wait 10
	while ${Actor[room ${_Room} floor switch 3].Interactable}
	{
		call Vaultcustomclickactor "room ${_Room} floor switch 3" ${Me.Name}
		_Activated:Set[1]
	}
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-262.912018,-161.957092,528.205078]
	wait 300 ${Me.Group[5].Distance[-262.912018,-161.957092,528.205078]}<3
	if !${_Activated}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-212.586929,-161.701477,527.958252]
		wait 300 ${Me.Group[5].Distance[-212.586929,-161.701477,527.958252]}<3
		;-212.539993,-161.699997,527.919983
		wait 20
		while ${Actor[Query, Name=="switch ring" && X=-212.539993 && Y=-161.699997 && Z=527.919983].Aura.NotEqual[design_cylinder_cage_red]}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Jump[${Me.Group[5]}]
			wait 20
		}
		wait 10
		while ${Actor[room ${_Room} floor switch 3].Interactable}
			call Vaultcustomclickactor "room ${_Room} floor switch 3" ${Me.Name}
		
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-262.912018,-161.957092,528.205078]
		wait 300 ${Me.Group[5].Distance[-262.912018,-161.957092,528.205078]}<3
	}
}
function Vaultcustomfloorpanelcyl4(int _Room)
{
	variable bool _Activated=FALSE
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-262.720428,-162.428619,452.865173]
	wait 300 ${Me.Group[5].Distance[-262.720428,-162.428619,452.865173]}<3
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-313.194977,-161.701477,453.298004]
	wait 300 ${Me.Group[5].Distance[-313.194977,-161.701477,453.298004]}<3
	;-313.220001,-161.699997,453.070007
	wait 20
	while ${Actor[Query, Name=="switch ring" && X=-313.220001 && Y=-161.699997 && Z=453.070007].Aura.NotEqual[design_cylinder_cage_red]}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:Jump[${Me.Group[5]}]
		wait 20
	}
	wait 10
	while ${Actor[room ${_Room} floor switch 4].Interactable}
	{
		call Vaultcustomclickactor "room ${_Room} floor switch 4" ${Me.Name}
		_Activated:Set[1]
	}
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-262.720428,-162.428619,452.865173]
	wait 300 ${Me.Group[5].Distance[-262.720428,-162.428619,452.865173]}<3
	if !${_Activated}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-212.607941,-161.701477,452.897736]
		wait 300 ${Me.Group[5].Distance[-212.607941,-161.701477,452.897736]}<3
		;-212.539993,-161.699997,453.079987
		wait 20
		while ${Actor[Query, Name=="switch ring" && X=-212.539993 && Y=-161.699997 && Z=453.079987].Aura.NotEqual[design_cylinder_cage_red]}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Jump[${Me.Group[5]}]
			wait 20
		}
		wait 10
		while ${Actor[room ${_Room} floor switch 4].Interactable}
			call Vaultcustomclickactor "room ${_Room} floor switch 4" ${Me.Name}
		
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-262.720428,-162.428619,452.865173]
		wait 300 ${Me.Group[5].Distance[-262.720428,-162.428619,452.865173]}<3
	}
}
function Vaultcustomfloorpanel(int _Stage)
{
	wait 20
	CustomLoc:Set["0 0 0"]
	Follow:Set[0]
	relay "other ${RI_Var_String_RelayGroup}" squelch endscript Buffer:CoT
	relay ${RI_Var_String_RelayGroup} RIMUIObj:StopMove[ALL]
	waitframe
	switch ${_Stage}
	{
		case 1
		{
			if ${Zone.Name.Find["[Heroic]"](exists)}
			{
				call Vaultcustomfloorpanelcyl1 1
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},${Me.Loc}]
				wait 300 ${Me.Group[5].Distance}<3
				wait 100
			}
			else
			{
				call ClickActor "room 1 floor switch 1"
			}
			if ${Zone.Name.Find["[Solo]"](exists)}
				wait 150
			break
		}
		case 2
		{
			if ${Zone.Name.Find["[Heroic]"](exists)}
			{
				call Vaultcustomfloorpanelcyl2 2
				call Vaultcustomfloorpanelcyl1 2
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},${Me.Loc},1,1000]
				wait 300 ${Me.Group[5].Distance}<3
				wait 50
			}
			else
			{
				call ClickActor "room 2 floor switch 2"
				call ClickActor "room 2 floor switch 1"
			}
			if ${Zone.Name.Find["[Solo]"](exists)}
				wait 150
			break
		}
		case 3
		{
			if ${Zone.Name.Find["[Heroic]"](exists)}
			{
				call Vaultcustomfloorpanelcyl3 3
				call Vaultcustomfloorpanelcyl2 3
				call Vaultcustomfloorpanelcyl1 3
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},${Me.Loc},1,1000]
				wait 300 ${Me.Group[5].Distance}<3
			}
			else
			{
				call ClickActor "room 3 floor switch 3"
				call ClickActor "room 3 floor switch 2"
				call ClickActor "room 3 floor switch 1"
			}
			if ${Zone.Name.Find["[Solo]"](exists)}
				wait 150
			break
		}
		case 4
		{
			if ${Zone.Name.Find["[Heroic]"](exists)}
			{
				call Vaultcustomfloorpanelcyl4 4
				call Vaultcustomfloorpanelcyl3 4
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-255.426010,-161.957092,430.732178,1,100]
				wait 1
				call Vaultcustomfloorpanelcyl2 4
				call Vaultcustomfloorpanelcyl1 4
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},-262.720428,-162.428619,452.865173,1,1000]
				wait 300 ${Me.Group[5].Distance[-262.720428,-162.428619,452.865173]}<3
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5]},${Me.Loc},1,1000]
				wait 300 ${Me.Group[5].Distance}<3
			}
			else
			{
				call ClickActor "room 4 floor switch 4"
				call ClickActor "room 4 floor switch 3"
				call RIMObj.Move -255.426010 -161.957092 430.732178
				call ClickActor "room 4 floor switch 2"
				call ClickActor "room 4 floor switch 1"
			}
			if ${Zone.Name.Find["[Solo]"](exists)}
				wait 150
			break
		}
	}
	Follow:Set[1]
	relay ${RI_Var_String_RelayGroup} RI_CoT
}
function Nev()
{
	call CustomNamed "Nev Dax'Thall-NMB" "-263.103699,-161.829285,671.844604" NevCustom
}
function NevCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
	if ${Actor[sphere purple main room](exists)}
		Actor[sphere purple main room]:DoubleClick
}
function Azrinax()
{
	call CustomNamed "Gloombeast Azrinax" "-213.904861,-161.701477,602.761169"
}
function Yzo()
{
	call CustomNamed "Umbral Lord Yzo-NMB" "-263.124756,-161.957092,528.895081" YzoCustom
}
function YzoCustom(int _NamedID)
{
	if !${RI_Var_Bool_GlobalOthers}
	{
		call RIObj.Target ${_NamedID}
		if ${Actor[id,${_NamedID}].Distance[-313.190002,-161.701492,527.979980]}<5 && ${Actor[shadowspren](exists)}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-292.192017,-161.957108,528.047058]
			wait 300 ${Me.Distance[-292.192017,-161.957108,528.047058]}<3
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-299.458832,-161.957092,514.973572]
			wait 300 ${Me.Distance[-299.458832,-161.957092,514.973572]}<3
			call Target shadowspren 1 15
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-322.196045,-161.951340,511.487122]
			wait 300 ${Me.Distance[-322.196045,-161.951340,511.487122]}<3
			call Target shadowspren 1 15
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-329.687134,-161.837616,534.040649]
			wait 300 ${Me.Distance[-329.687134,-161.837616,534.040649]}<3
			call Target shadowspren 1 15
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-312.474792,-161.957092,546.966309]
			wait 300 ${Me.Distance[-312.474792,-161.957092,546.966309]}<3
			call Target shadowspren 1 15
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-296.548065,-161.957108,537.251526]
			wait 300 ${Me.Distance[-296.548065,-161.957108,537.251526]}<3
			call Target shadowspren 1 15
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-312.821106,-161.701492,529.034058]
			wait 10
		}
		if ${Actor[id,${_NamedID}].Distance[-212.440002,-161.701477,528.119995]}<5 && ${Actor[shadowspren](exists)}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-233.831146,-161.957108,527.759277]
			wait 300 ${Me.Distance[-233.831146,-161.957108,527.759277]}<3
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-228.910690,-161.929489,536.613281]
			wait 300 ${Me.Distance[-228.910690,-161.929489,536.613281]}<3
			call Target shadowspren 1 15
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-212.183762,-161.880463,545.819702]
			wait 300 ${Me.Distance[-212.183762,-161.880463,545.819702]}<3
			call Target shadowspren 1 15
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-194.602844,-161.931839,532.205566]
			wait 300 ${Me.Distance[-194.602844,-161.931839,532.205566]}<3
			call Target shadowspren 1 15
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-203.654312,-161.907974,511.895203]
			wait 300 ${Me.Distance[-203.654312,-161.907974,511.895203]}<3
			call Target shadowspren 1 15
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-224.008636,-161.953003,513.219360]
			wait 300 ${Me.Distance[-224.008636,-161.953003,513.219360]}<3
			call Target shadowspren 1 15
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-214.106216,-161.701477,526.591187]
			wait 10
		}
	}
}
function Ikeshzi()
{
	call CustomNamed "Shadow Rhozth Ikeshzi-NMB" "-259.407990,-359.499756,628.242249" NONE soldier beast shissar
}
function Shade()
{
	call CustomNamed "Shade of Vyzh'dra" "-260.032654,-161.446838,293.148499"
}
;;;;;;;; End The Vault of Ssraeshza

;;;;;;;; Start Fordel Midst: Bizarre Bazaar

function Fendilix()
{
	call CustomNamed "Financier Fendilix" "-275.081207,-1.685512,32.970196"
}

;Mandee Quin
;Mannee Quin
function Quin()
{
	call CustomNamed "Quin" "-120.387802,-1.494008,72.475723"
	call CustomNamed "Quin" "-120.387802,-1.494008,72.475723"
}
function Shift()
{
	call CustomNamed "Short Shift" "-63.471298,-1.741144,202.257202"
}
function Elsindir()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["Your Cat's Eye Agate begins to glow!"]
	call CustomNamed "Trade Baroness Elsindir-NLC" "-29.738201,-1.490341,63.742359" ElsindirCustom
	wait 20
	call RILoot 0
	call LootOptions RoundRobin
	wait 5
	if !${RI_Var_Bool_GlobalOthers} && ${Actor[Chest,radius,100](exists)}
	{
		eq2ex summon
		wait 2
		Actor[Chest,radius,100]:DoubleClick
		wait 2
		eq2ex summon
	}
	if !${RI_Var_Bool_GlobalOthers} && ${Actor[Chest,radius,100](exists)}
	{
		eq2ex summon
		wait 2
		Actor[Chest,radius,100]:DoubleClick
		wait 2
		eq2ex summon
	}
	if !${RI_Var_Bool_GlobalOthers} && ${Actor[Chest,radius,100](exists)}
	{
		eq2ex summon
		wait 2
		Actor[Chest,radius,100]:DoubleClick
		wait 2
		eq2ex summon
	}
	RI_Var_IndexInt_InvalidChest:Insert[${Actor[Chest,radius,100].ID}]
	wait 20
}
function ElsindirCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
	if ${Trigger}
	{
		;echo Triggered: ${TriggerMessage} // ${Me.Inventory[Query, Name=="Cat's Eye Agate" && Location=="Inventory"].TimeUntilReady}
		RI_CMD_PauseCombatBots 1
		while ${Me.Inventory[Query, Name=="Cat's Eye Agate" && Location=="Inventory"].TimeUntilReady}<=0
		{
			wait 2
			Me.Inventory[Query, Name=="Cat's Eye Agate" && Location=="Inventory"]:Use
			wait 2
		}
		RI_CMD_PauseCombatBots 0
		Trigger:Set[0]
	}
}
function Brixwald()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["Your Cat's Eye Agate begins to glow!"]
	IncomingText:Insert["Your Paludal Catnip starts to give off a strong scent!"]
	call CustomNamed "Bazaar Baron Brixwald-NMB" "262.990570,-33.059879,26.555954" BrixwaldCustom
}
function BrixwaldCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
	if ${Trigger}
	{
		;echo Triggered: ${TriggerMessage}
		RI_CMD_PauseCombatBots 1
		if ${TriggerMessage.Find["Your Cat's Eye Agate begins to glow"](exists)}
		{
			while ${Me.Inventory[Query, Name=="Cat's Eye Agate" && Location=="Inventory"].TimeUntilReady}<=0
			{
				wait 2
				Me.Inventory[Query, Name=="Cat's Eye Agate" && Location=="Inventory"]:Use
				wait 2
			}
		}
		else
		{
			while ${Me.Inventory[Query, Name=="Paludal Catnip" && Location=="Inventory"].TimeUntilReady}<=0
			{
				wait 2
				Me.Inventory[Query, Name=="Paludal Catnip" && Location=="Inventory"]:Use
				wait 2
			}
		}
		RI_CMD_PauseCombatBots 0
		Trigger:Set[0]
	}
}
;;;;;;;; End Fordel Midst: Bizarre Bazaar

;;;;;;;; Start Solusek Eye: The Calling

function Widow()
{
	call CustomNamed "The Iron Widow" "18.192625,-13.440747,218.081314" WidowCustom
}
function WidowCustom(int _NamedID)
{
	call RIObj.Target maker -Distance 15 ${_NamedID}
}
function Novinctus()
{
	call CustomNamed "Novinctus the Unleashed" "-68.111809,-34.140427,-118.787788"
}
function Vezarra()
{
	call CustomNamed "Dread Lady Vezarra-NLP" "-279.508240,-40.448433,-160.450745" VezarraCustom
}
function VezarraCustom(int _NamedID)
{
	call RIObj.Target unearthed -Distance 5 ${_NamedID}
}
function Babagoosh()
{
	RI_CMD_AbilityEnableDisable "Cure Curse" 0
	call CustomNamed "Chief Babagoosh" "-251.989731,-239.753830,-25.929913"
	RI_CMD_AbilityEnableDisable "Cure Curse" 1
}
function Sickleclaw()
{
	call CustomNamed "Evisceraptor" "8.206963,-247.991837,24.617353 " NONE Sickleclaw
}

function Izeroth()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert[takes the brunt of the Sokokar Bomb]
	call CustomNamed "Lord Commander Izeroth-NLP" "51.511246,-359.497498,175.481934" IzerothCustom
}
function IzerothCustom(int _NamedID)
{
	if ${Trigger}
	{
		call RIObj.Target Korvisaur
		wait 110
		Trigger:Set[0]
	}
	RIMUIObj:SetLockSpot[ALL,51.511246,-359.497498,175.481934]
	if ${Actor[Query, Name=-"Xerin" && IsDead=FALSE](exists)}
		call RIObj.Target Xerin
	elseif ${Actor[Query, Name=-"Korvisaur" && IsDead=FALSE](exists)}
		call RIObj.Target Korvisaur
	else
		call RIObj.Target ${_NamedID}
}
function Surtaug()
{
	call CustomNamed "Pyreduke Surtaug" "-54.266716,-336.819000,-32.537575" NONE twisting
}
function Onakoome()
{
	RI_CMD_AbilityEnableDisable "Cure Curse" 0
	if !${RI_Var_Bool_GlobalOthers}
	{
		declare _HealerGroupNum int script 1
		variable int _cnt=0
		for(_cnt:Set[1];${_cnt}<${Me.Group};_cnt:Inc)
		{
			if ${RIObj.Archetype[${Me.Group[${_cnt}].ID}].Equal[priest]}
				_HealerGroupNum:Set[${_cnt}]
		}
	}
	call CustomNamed "Onakoome-NMB" "-156.508133,-369.836182,-287.070282" OnakoomeCustom
	if !${RI_Var_Bool_GlobalOthers}
		deletevariable _HealerGroupNum
	RI_CMD_AbilityEnableDisable "Cure Curse" 1
}
function OnakoomeCustom(int _NamedID)
{
	if !${RI_Var_Bool_GlobalOthers}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_HealerGroupNum}].Name},-152.043625,-369.533142,-287.324829]
		if ${Me.Cursed}==1
			relay ${RI_Var_String_RelayGroup} RIMUIObj:CastOn[PRIESTS,"Cure Curse",${Me.Group[${_HealerGroupNum}].Name},1]
		call RIObj.Target ascended ${_NamedID}
	}
}

function Galadoon()
{
	RI_CMD_AbilityEnableDisable "Cure Curse" 0
	call CustomNamed "Galadoon-NMB" "-255.069397,-371.068054,-97.962288" GaladoonCustom
	RI_CMD_AbilityEnableDisable "Cure Curse" 1
}
function GaladoonCustom(int _NamedID)
{
	call RIObj.MageAbsorbMagic ${_NamedID} 205 1 
	;(int _ID, int _MainIconID=-1, int _Increments=0)
	if !${RI_Var_Bool_GlobalOthers}
	{
		if ${RIObj.GroupDetrimentCount[Curse]}>0
		{
			;echo CURSE
			declare uncurableMember int 0
			declare curableMember int 0
			declare _i int 0
			for(_i:Set[0];${_i}<${Me.Group};_i:Inc)
			{
				if ${Me.Group[${_i}].Cursed}==-1
					uncurableMember:Set[${_i}]
				if ${Me.Group[${_i}].Cursed}==1
					curableMember:Set[${_i}]
			}
			while ${Me.Group[${uncurableMember}].Cursed}==-1 && !${Me.Group[${uncurableMember}].IsDead}
			{
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Group[${uncurableMember}].X},${Me.Y},${Me.Group[${uncurableMember}].Z},3,1000]
				if ${Me.Distance2D[${Me.Group[${uncurableMember}].X},${Me.Group[${uncurableMember}].Z}]}<=3
					relay ${RI_Var_String_RelayGroup} RIMUIObj:CastOn[PRIESTS,"Cure Curse",${Me.Group[${curableMember}].Name},1]
				wait 1
			}
		}
		elseif ${RIMUIObj.MainIconIDExists[${_NamedID},509]}
		{
			;echo SLAG DIVING
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_NamedID}].Loc}]
			call RIObj.Target slag
		}
		else
		{
			;echo NORMAL
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-255.069397,-371.068054,-97.962288]
			call RIObj.Target ${_NamedID}
		}
	}
}

function Hortu()
{
	if !${RI_Var_Bool_GlobalOthers}
	{
		declare _NonHealerGroupNum int script 1
		variable int _cnt=0
		for(_cnt:Set[1];${_cnt}<${Me.Group};_cnt:Inc)
		{
			if !${RIObj.Archetype[${Me.Group[${_cnt}].ID}].Equal[priest]}
				_NonHealerGroupNum:Set[${_cnt}]
		}
	}
	call CustomNamed "Hortu the Scorched-NMB" "-199.447769,-557.484436,212.077820" HortuCustom
	if !${RI_Var_Bool_GlobalOthers}
		deletevariable _NonHealerGroupNum
}
function HortuCustom()
{
	call RIObj.MageAbsorbMagic ${_NamedID} 205 1 
	if ${Me.IsDead} && ${Math.Distance[${Me.Y},-557]}>20
	{
		while ${Me.IsDead}
		{
			eq2ex "select_junction 4"
			wait 5
		}
		wait 600 ${EQ2.Zoning}!=0
		wait 600 ${EQ2.Zoning}==0
		while ${Me.Distance[-197.500290,-557.344177,201.892990]}>3
		{
			RIMUIObj:SetLockSpot[${Me.Name},-197.500290,-557.344177,201.892990]
			wait 1
		}
		RIMUIObj:SetLockSpot[ALL,-199.447769,-557.484436,212.077820]
	}
	if !${RI_Var_Bool_GlobalOthers}
	{
		if ${Actor[Query, Name=="a singeing scion"](exists)}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor["a singeing scion"].Loc},5,1000]
			call RIObj.Target ${Actor[Query, Name=="a singeing scion"].ID}
		}
		elseif ${Actor[Query, Name=="a singing scion" && X=-213.860001 && Y=-556.340027 && Z=200.839996](exists)}
		{
			echo NORTH
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Assist[${Me.Group[${_NonHealerGroupNum}].Name},0]
			wait 1
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Target[${Me.Group[${_NonHealerGroupNum}].Name},${Me.Group[${_NonHealerGroupNum}].Name}]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-201.687592,-557.163025,229.287735]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}].Name},-197.205154,-557.344177,202.632660]
			wait 300 ${Me.Distance[-201.687592,-557.163025,229.287735]}<3
			wait 300 ${Me.Group[${_NonHealerGroupNum}].Distance[-197.205154,-557.344177,202.632660]}<3
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}].Name},-211.841110,-556.343140,201.008057]
			wait 300 ${Me.Group[${_NonHealerGroupNum}].Distance[-204.416107,-557.344177,201.538544]}<4
			eq2ex /g jump
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Jump[${Me.Group[${_NonHealerGroupNum}].Name}]
			wait 1
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Jump[${Me.Group[${_NonHealerGroupNum}].Name}]
			wait 20
			Actor[Query, Name=="a singing scion" && X=-213.860001 && Y=-556.340027 && Z=200.839996]:DoTarget
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}].Name},-197.205154,-557.344177,202.632660]
			wait 300 ${Me.Group[${_NonHealerGroupNum}].Distance[-197.205154,-557.344177,202.632660]}<4
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Assist[${Me.Group[${_NonHealerGroupNum}].Name},1]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-199.447769,-557.484436,212.077820]
			wait 50
		}
		elseif ${Actor[Query, Name=="a singing scion" && X=-216.809998 && Y=-556.340027 && Z=218.630005](exists)}
		{
			echo SOUTH
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Assist[${Me.Group[${_NonHealerGroupNum}].Name},0]
			wait 1
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Target[${Me.Group[${_NonHealerGroupNum}].Name},${Me.Group[${_NonHealerGroupNum}].Name}]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-196.182541,-557.344177,195.493484]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}].Name},-200.640366,-557.163025,222.816528]
			wait 300 ${Me.Distance[-196.182541,-557.344177,195.493484]}<3
			wait 300 ${Me.Group[${_NonHealerGroupNum}].Distance[-200.640366,-557.163025,222.816528]}<3
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}].Name},-215.119354,-556.343201,219.193741]
			wait 300 ${Me.Group[${_NonHealerGroupNum}].Distance[-207.958923,-557.163025,220.980362]}<4
			eq2ex /g jump
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Jump[${Me.Group[${_NonHealerGroupNum}].Name}]
			wait 1
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Jump[${Me.Group[${_NonHealerGroupNum}].Name}]
			wait 20
			Actor[Query, Name=="a singing scion" && X=-216.809998 && Y=-556.340027 && Z=218.630005]:DoTarget
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[${_NonHealerGroupNum}].Name},-200.640366,-557.163025,222.816528]
			wait 300 ${Me.Group[${_NonHealerGroupNum}].Distance[-200.640366,-557.163025,222.816528]}<4
			relay ${RI_Var_String_RelayGroup} RIMUIObj:Assist[${Me.Group[${_NonHealerGroupNum}].Name},1]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-199.447769,-557.484436,212.077820]
			wait 50
		}
		else
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-199.447769,-557.484436,212.077820]
	}
}
function Ayquini()
{
	call CustomNamed "Ayquini the Firemind-NMB" "-285.547760,-516.409607,120.104797" AyquiniCustom
}
function AyquiniCustom()
{
	call RIObj.MageAbsorbMagic ${_NamedID} 205 1 
	;echo custom
	if !${RI_Var_Bool_GlobalOthers}
	{
		;echo ngo
		if ${Actor[Query, Name=-"Scorion's doppel" && IsDead=FALSE](exists)}
			Actor[Query, Name=-"Scorion's doppel" && IsDead=FALSE]:DoTarget
		else
			RIObj:BalanceMobs[ALL,0,500]
	}
}
;01:13:49: guardian / 141.306732,-494.430695,309.131226
;Lord Kargurak
;the Usurper's guard
;At Ease Description: BackDropIconID: 313 MainIconID: 434 ID: 2827563 Duration: -1.000000 MaxDuration: -1.000000 CurrentIncrements: 0
;Roll Call Description: Sign up, or die! BackDropIconID: 315 MainIconID: 566 ID: 2887883 Duration: 18.000000 MaxDuration: 20.000000 CurrentIncrements: 0
function Kargurak()
{
	call CustomNamed "Lord Kargurak-NMB" "141.306732,-494.430695,309.131226" KargurakCustom
}
function KargurakCustom(int _NamedID)
{
	call RIObj.MageAbsorbMagic ${_NamedID} 205 1 
	if !${RI_Var_Bool_GlobalOthers}
		call RIObj.Target guard -distance 10 ${_NamedID}
	if ${RIMUIObj.MainIconIDExists[${Me.ID},434]}
	{
		while !${Me.IsCrouching} && ${RIMUIObj.MainIconIDExists[${Me.ID},434]}
		{
			press ${RI_Var_String_CrouchKey}
			wait 2
		}
		while ${RIMUIObj.MainIconIDExists[${Me.ID},434]}
			wait 1
		while ${Me.IsCrouching}
		{
			press ${RI_Var_String_CrouchKey}
			wait 2
		}
	}
	if ${RIMUIObj.MainIconIDExists[${Me.ID},566]}
	{
		;eq2ex gu roll call
		while !${Actor[Query, Name=="" && TintFlags=${Me.TintFlags}](exists)}
		{
			;echo waiting for my statue
			wait 1
		}
		RIMUIObj:SetLockSpot[${Me.Name},${Actor[Query, Name=="" && TintFlags=${Me.TintFlags}].Loc},3,1000]
		wait 150 ${Me.Distance[${Actor[Query, Name=="" && TintFlags=${Me.TintFlags}].Loc}]}<4
		wait 20
		while ${RIMUIObj.MainIconIDExists[${Me.ID},566]}
		{
			Actor[Query, Name=-"boss 12 statue sign" && Distance<5]:DoubleClick
			wait 5
			type ${Me.Name}
			wait 2
			press enter
			wait 13
		}
		RIMUIObj:SetLockSpot[${Me.Name},141.306732,-494.430695,309.131226]
	}
}

;;;;;;;; End Solusek Eye: The Calling


;;;;;;;; Start BoL Raid Coding

function Rockhopper()
{
	;00:39:02: guardian / -709.398926,6.139619,644.550781
    ;00:39:06: guardian / -694.173157,4.685901,654.502869
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["prepares to pounce"]
	call ToggleWalkRun
	call CustomNamed "Rockhopper Pouncer" "-709.398926,6.139619,644.550781" RockhopperCustom
	call ToggleWalkRun
}
function RockhopperCustom(int _NamedID)
{
	if ${Trigger}
	{
		if !${RI_Var_Bool_GlobalOthers} || ${Me.Archetype.Equal[fighter]}
		{
			if ${Me.Distance[-709.398926,6.139619,644.550781]}<5
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-694.173157,4.685901,654.502869]
			else
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-709.398926,6.139619,644.550781]
			Trigger:Set[FALSE]
		}
		else
			Trigger:Set[FALSE]
	}
	else
	{
		if ${Actor[id,${_NamedID}].Distance}<10 && ${Me.Archetype.Equal[Scout]}
			RIMUIObj:ComeOn[${Me.Name}]
		if !${RI_Var_Bool_GlobalOthers} || ${Me.Archetype.Equal[fighter]}
		{
			call RIObj.Target ${_NamedID}
		}
	}
}
function Praetorian()
{
	declare _PStage int script 0
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["unwittingly unleashes a nasty pustule at his feet"]
	call CustomNamed "Praetorian K'Tikrn" "416.769196,97.053978,766.322449" PraetorianCustom
	deletevariable _PStage
}
function PraetorianCustom(int _NamedID)
{
	if ${Trigger}
	{
		;echo 2
		if !${RI_Var_Bool_GlobalOthers} || ${Me.Archetype.Equal[fighter]}
		{
			if ${_PStage}==2
			{
				;echo 3
				_PStage:Set[0]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,416.769196,97.053978,766.322449]
			}
			elseif ${_PStage}==0
			{
			;	echo 4
				_PStage:Inc				
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,479.362152,100.560600,750.807068]
			}
			elseif ${_PStage}==1
			{
				;echo 5
				_PStage:Inc				
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,435.930054,82.919701,706.278381]
			}
			wait 50
			Trigger:Set[FALSE]
		}
		else
		{
			wait 50
			Trigger:Set[FALSE]
		}
	}
	else
	{
		if ${Me.Archetype.Equal[scout]} && ${Actor[id,${_NamedID}].Distance}<10
			RIMUIObj:ComeOn[${Me.Name}]
		if !${RI_Var_Bool_GlobalOthers} || ${Me.Archetype.Equal[fighter]}
		{
			call RIObj.Target ${_NamedID}
		}
	}
}
function Overfiend() 
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["angers as he has moved too far"]
	IncomingText:Insert["massive mind spike"]
	RIMUIObj:SetLockSpot[ALL,-533.415527,62.421314,259.907715]
	if !${RI_Var_Bool_GlobalOthers} || ${Me.Archetype.Equal[fighter]}
	{
		call RIObj.Target "Thought Horror Overfiend"
		wait 20
		RIMUIObj:SetLockSpot[ALL,-533.019043,61.457664,277.267517]
	}
	call CustomNamed "Thought Horror Overfiend" "-533.415527,62.421314,259.907715" OverfiendCustom
}
function OverfiendCustom(int _NamedID)
{
	if !${RI_Var_Bool_GlobalOthers} || ${Me.Archetype.Equal[fighter]}
	{
		call RIObj.Target ${_NamedID}
		if ${RIMUIObj.MainIconIDExists[${Me.ID},60]} || ( ${Trigger} && ${TriggerMessage.Find[angers as he has moved too far](exists)} )
		{
			if ${Me.Distance[-533.019043,61.457664,277.267517]}<15
				RIMUIObj:SetLockSpot[ALL,-533.489136,61.604141,242.635895]
			else
				RIMUIObj:SetLockSpot[ALL,-533.019043,61.457664,277.267517]
			wait 300 !${RIMUIObj.MainIconIDExists[${Me.ID},60]}
			Trigger:Set[FALSE]
		}
		elseif ${Trigger} && ${TriggerMessage.Find[massive mind spike](exists)}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-533.415527,62.421314,259.907715]
			if ${Me.Distance[-533.019043,61.457664,277.267517]}<15
				RIMUIObj:SetLockSpot[ALL,-533.148315,61.516685,289.822968]
			else
				RIMUIObj:SetLockSpot[ALL,-533.019836,61.544247,230.961197]
			wait 50
			Trigger:Set[FALSE]
		}
	}
	else
	{
		if ${Trigger} && ${TriggerMessage.Find[massive mind spike](exists)}
		{
			if ${Me.Archetype.Equal[scout]}
			{
				wait 50
				RIMUIObj:ComeOn[${Me.Name}]
			}
			Trigger:Set[FALSE]
		}
		elseif ${Trigger}
			Trigger:Set[FALSE]

	}
}
;Prismatic Shield 911
;a prismatic shield
function Stonegrabber()
{
	;00:39:02: guardian / -709.398926,6.139619,644.550781
    ;00:39:06: guardian / -694.173157,4.685901,654.502869
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["prepares to pounce"]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-312.923431,4.328952,-225.615631]
	wait 300 ${Me.Distance[-312.923431,4.328952,-225.615631]}<3
	call CustomNamed "The Stonegrabber Colossus-NMB" "-312.923431,4.328952,-225.615631" StonegrabberCustom
}
function StonegrabberCustom(int _NamedID)
{
	if !${RI_Var_Bool_GlobalOthers} || ${Me.Archetype.Equal[fighter]}
	{
		call RIObj.Target ${_NamedID}
	}
	elseif ${Me.Class.Equal[bard]} && ( ${Me.RaidGroupNum}==1 || !${Me.InRaid} )&& ${Actor[Query, ID=${_NamedID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},911]}].CurrentIncrements}>1
	{
		echo found ${Actor[Query, ID=${_NamedID} && IsDead=FALSE].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},911]}].CurrentIncrements}
		variable int _prismaticshieldID
		_prismaticshieldID:Set[${Actor[Query, Name=="a prismatic shield" && Aura=="cast_cyclone_stones"].ID}]
		RIMUIObj:SetLockSpot[ALL,${Actor[id,${_prismaticshieldID}].Loc},3,1000]
		wait 300 ${Me.Distance[${Actor[id,${_prismaticshieldID}].Loc}]}<4 || !${Actor[id,${_prismaticshieldID}].Aura.Find["cast_cyclone_stones"](exists)}
		RIMUIObj:SetLockSpot[ALL,-318.060913,4.800460,-232.227249,1,1000]
		wait 50
	}
	else
	{
		RIMUIObj:SetLockSpot[ALL,-318.060913,4.800460,-232.227249,1,1000]
	}
}
function Sambata()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["Bring on the rocks"]
	IncomingText:Insert["drops a nasty grime"]
	declare _Lockspot string script "-570.059509,33.675255,770.237122"
	declare _Joustspot string script "-550.881226,34.484768,763.166748"
	declare _SambataChampionCastStoneskin_ bool global FALSE
	call CustomNamed "The Sambata Champion-NMB" "-570.059509,33.675255,770.237122" SambataCustom
	deletevariable _Lockspot
	deletevariable _Joustspot
	deletevariable _SambataChampionCastStoneskin_
}
function SambataCustom(int _NamedID)
{
	if ${Me.Archetype.Equal[fighter]}
	{
		if ${_SambataChampionCastStoneskin_}
		{
			call SambataFighterStoneskin
			_SambataChampionCastStoneskin_:Set[0]
		}
		call RIObj.Target Mutagenic ${_NamedID}
		if ${Trigger} && ${TriggerMessage.Find["Bring on the rocks"]}
		{
			relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,${_Joustspot}]
			TimedCommand 140 relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Lockspot}]
			TimedCommand 110 _SambataChampionCastStoneskin_:Set[TRUE]
			Trigger:Set[0]
		}
		if ${Trigger} && ${TriggerMessage.Find["drops a nasty grime"]}
		{
			if ${_Lockspot.Equal["-601.460938,34.691975,782.799988"]}
			{
				_Lockspot:Set["-570.059509,33.675255,770.237122"]
				_Joustspot:Set["-550.881226,34.484768,763.166748"]
			}
			else
			{
				_Lockspot:Set["-601.460938,34.691975,782.799988"]
				_Joustspot:Set["-618.644592,34.843853,791.141052"]
			}
			wait 1
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Lockspot}]
			Trigger:Set[0]
		}
	}

}
function SambataFighterStoneskin()
{
	;echo FSK
	switch ${Me.SubClass}
	{
		case guardian
		{
			;echo Guard
			if ${Me.Ability[id,2822291254].IsReady}
			{
				;echo LMS
				do
				{
					RI_Obj_CB:Cast[Last Man Standing,1]
					wait 1
				}
				while ${Me.Ability[id,2822291254].TimeUntilReady}<1
			}
			elseif ${Me.Ability[id,2660262412].IsReady}
			{
				;echo PC
				do
				{
					RI_Obj_CB:Cast[Perfect Counter,1]
					wait 1
				}
				while ${Me.Ability[id,2660262412].TimeUntilReady}<1
			}
			elseif ${Me.Ability[id,1110318339].IsReady}
			{
				;echo TOS
				do
				{
					RI_Obj_CB:Cast[Tower of Stone,1]
					wait 1
				}
				while ${Me.Ability[id,1110318339].TimeUntilReady}<1
			}
			break
		}
	}
}
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; End of BoL Zone CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; Start of RoS QUEST CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

function RoSTSSigCustomCalming()
{
	switch ${Me.TSSubClass}
	{
		case jeweler
		{
			call CraftIt "Calming Epilogue of Sleep" 1
			call CraftIt "Calming Thought Horror Gem" 1
			break
		}
		case armorer
		{
			call CraftIt "Calming Mirrored Dinner Plate" 1
			call CraftIt "Calming Zelniak Strap of Leather" 1
			break
		}
		case woodworker
		{
			call CraftIt "Calming Totem of the Snail" 1
			call CraftIt "Wracked Calming Hourglass" 1
			break
		}
		case sage
		{
			call CraftIt "Calming Echo Scroll" 1
			call CraftIt "Calming Epilogue of Sleep" 1
			break
		}
		case alchemist
		{
			call CraftIt "Calming Epilogue of Sleep" 1
			call CraftIt "Calming Eucalyptus Spray" 1
			break
		}
		case provisioner
		{
			call CraftIt "Denmum's Calming Vulrich Drumstick" 1
			call CraftIt "Wracked Calming Hourglass" 1
			break
		}
		case carpenter
		{
			call CraftIt "Calming Effigy of Quellious" 1
			call CraftIt "Wracked Calming Hourglass" 1
			break
		}
		case tailor
		{
			call CraftIt "Calming Zelniak Strap of Leather" 1
			call CraftIt "Enchanted Cloth of Calming" 1
			break
		}
		case weaponsmith
		{
			call CraftIt "Calming Polished Buckler" 1
			call CraftIt "Calming Zelniak Strap of Leather" 1
			break
		}
	}
}
function RoSTSSigCustomCalm(int _Stage)
{
	variable int _ReishiID=0
	variable string Item1
	variable string Item2

	RI_CMD_PauseCombatBots 1
	switch ${Me.TSSubClass}
	{
		case jeweler
		{
			Item1:Set["Calming Epilogue of Sleep"]
			Item2:Set["Calming Thought Horror Gem"]
			break
		}
		case armorer
		{
			Item1:Set["Calming Mirrored Dinner Plate"]
			Item2:Set["Calming Zelniak Strap of Leather"]
			break
		}
		case woodworker
		{
			Item1:Set["Calming Totem of the Snail"]
			Item2:Set["Wracked Calming Hourglass"]
			break
		}
		case sage
		{
			Item1:Set["Calming Echo Scroll"]
			Item2:Set["Calming Epilogue of Sleep"]
			break
		}
		case alchemist
		{
			Item1:Set["Calming Epilogue of Sleep"]
			Item2:Set["Calming Eucalyptus Spray"]
			break
		}
		case provisioner
		{
			Item1:Set["Denmum's Calming Vulrich Drumstick"]
			Item2:Set["Wracked Calming Hourglass"]
			break
		}
		case carpenter
		{
			Item1:Set["Calming Effigy of Quellious"]
			Item2:Set["Wracked Calming Hourglass"]
			break
		}
		case weaponsmith
		{
			Item1:Set["Calming Polished Buckle"]
			Item2:Set["Calming Zelniak Strap of Leather"]
			break
		}
		case tailor
		{
			Item1:Set["Calming Zelniak Strap of Leather"]
			Item2:Set["Enchanted Cloth of Calming"]
			break
		}
	}
	switch ${_Stage}
	{
		case 1
		{
			_ReishiID:Set[${Actor[Query, Name=-"reishi" && X==414.049988 && Y==197.956329 && Z==-113.970001].ID}]
			wait 1
			if ${Actor[id,${_ReishiID}].Name.Find[Dormant]}
				return
			Actor[id,${_ReishiID}]:DoTarget
			wait 2
			Actor[id,${_ReishiID}]:DoTarget
			wait 2
			call UseItem "${Item1}"
			wait 50
			break
		}
		case 2
		{
			;363.700012,196.282623,-118.790001
			_ReishiID:Set[${Actor[Query, Name=-"reishi" && X==363.700012 && Y==196.282623 && Z==-118.790001].ID}]
			wait 1
			if ${Actor[id,${_ReishiID}].Name.Find[Dormant]}
				return
			Actor[id,${_ReishiID}]:DoTarget
			wait 2
			Actor[id,${_ReishiID}]:DoTarget
			wait 2
			if ${Me.Inventory["${Item1}"].TimeUntilReady}<1
			{
				wait 600 ${Me.Inventory["${Item1}"].TimeUntilReady}<1
				wait 10
				call UseItem "${Item1}"
			}
			else
			{
				wait 600 ${Me.Inventory["${Item2}"].TimeUntilReady}<1
				wait 10
				call UseItem "${Item2}"
			}
			wait 50
			break
		}
		case 21
		{
			;345.100006,193.735672,-129.020004
			_ReishiID:Set[${Actor[Query, Name=-"reishi" && X==345.100006 && Y==193.735672 && Z==-129.020004].ID}]
			wait 1
			if ${Actor[id,${_ReishiID}].Name.Find[Dormant]}
				return
			Actor[id,${_ReishiID}]:DoTarget
			wait 2
			Actor[id,${_ReishiID}]:DoTarget
			wait 2
			if ${Me.Inventory["${Item1}"].TimeUntilReady}<1
			{
				wait 600 ${Me.Inventory["${Item1}"].TimeUntilReady}<1
				wait 10
				call UseItem "${Item1}"
			}
			else
			{
				wait 600 ${Me.Inventory["${Item2}"].TimeUntilReady}<1
				wait 10
				call UseItem "${Item2}"
			}
			wait 50
			break
		}
		case 3
		{
			;440.829987,204.127823,-95.769997
			_ReishiID:Set[${Actor[Query, Name=-"reishi" && X==440.829987 && Y==204.127823 && Z==-95.769997].ID}]
			wait 1
			if ${Actor[id,${_ReishiID}].Name.Find[Dormant]}
				return
			Actor[id,${_ReishiID}]:DoTarget
			wait 2
			Actor[id,${_ReishiID}]:DoTarget
			wait 2
			if ${Me.Inventory["${Item1}"].TimeUntilReady}<1
			{
				wait 600 ${Me.Inventory["${Item1}"].TimeUntilReady}<1
				wait 10
				call UseItem "${Item1}"
			}
			else
			{
				wait 600 ${Me.Inventory["${Item2}"].TimeUntilReady}<1
				wait 10
				call UseItem "${Item2}"
			}
			wait 50
			break
		}
		case 4
		{
			;460.019989,212.224319,-81.470001
			_ReishiID:Set[${Actor[Query, Name=-"reishi" && X==460.019989 && Y==212.224319 && Z==-81.470001].ID}]
			wait 1
			if ${Actor[id,${_ReishiID}].Name.Find[Dormant]}
				return
			Actor[id,${_ReishiID}]:DoTarget
			wait 2
			Actor[id,${_ReishiID}]:DoTarget
			wait 2
			if ${Me.Inventory["${Item1}"].TimeUntilReady}<1
			{
				wait 600 ${Me.Inventory["${Item1}"].TimeUntilReady}<1
				wait 10
				call UseItem "${Item1}"
			}
			else
			{
				wait 600 ${Me.Inventory["${Item2}"].TimeUntilReady}<1
				wait 10
				call UseItem "${Item2}"
			}
			wait 50
			break
		}
		case 5
		{
			;543.090027,223.625595,-50.619999
			_ReishiID:Set[${Actor[Query, Name=-"reishi" && X==543.090027 && Y==223.625595 && Z==-50.619999].ID}]
			wait 1
			if ${Actor[id,${_ReishiID}].Name.Find[Dormant]}
				return
			Actor[id,${_ReishiID}]:DoTarget
			wait 2
			Actor[id,${_ReishiID}]:DoTarget
			wait 2
			if ${Me.Inventory["${Item1}"].TimeUntilReady}<1
			{
				wait 600 ${Me.Inventory["${Item1}"].TimeUntilReady}<1
				wait 10
				call UseItem "${Item1}"
			}
			else
			{
				wait 600 ${Me.Inventory["${Item2}"].TimeUntilReady}<1
				wait 10
				call UseItem "${Item2}"
			}
			wait 50
			break
		}
	}
	eq2ex target_none
	wait 2
	eq2ex target_none
	wait 2
	RI_CMD_PauseCombatBots 0
}
function ROSSigAIICustomKaVethan()
{
	variable int _KAID
	_KAID:Set[${Actor[Query, Name=-"Ka Vethan" && Distance<100].ID}]

	while ${Actor[id, ${_KAID}].IsAggro}
	{
		Actor[id, ${_KAID}]:DoTarget
		if ${Actor[id, ${_KAID}].Health}<=40
			RI_Obj_CB:Cast[Item:Va Urssan,1]
		wait 2
	}
}
function BuyBaubles(string _VendorName, string _Which)
{
	variable int GUCnt=0
	GUCnt:Set[0]
	while ${RIMUIObj.InventoryQuantity["${_Which}"]}<20 && ${GUCnt:Inc}<10
		call BuyFromVendor "${_VendorName}" "${_Which}" ${Math.Calc[20-${RIMUIObj.InventoryQuantity["${_Which}"]}].Precision[0]}
}
function SingularFocus(int _OnOff)
{
	if !${RI_Var_Bool_GlobalOthers}
		relay "other ${RI_Var_String_RelayGroup}" -noredirect Script[${RI_Var_String_RunInstancesScriptName}]:QueueCommand["call SingularFocus ${_OnOff}"]
	call RIObj.SingularFocus ${_OnOff}
}
function DoNotCastAE(bool _OnOff)
{
	relay ${RI_Var_String_RelayGroup} RI_Obj_CB:DoNotCastAE[${_OnOff}]
	
}
function DoNotCastEnc(bool _OnOff)
{
	relay ${RI_Var_String_RelayGroup} RI_Obj_CB:DoNotCastEncounter[${_OnOff}]
}
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; End of RoS QUEST CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;; Start of RoS Zone CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;


;Start Echo Caverns: Quarry Quandary

function Zemilox()
{
	call CustomNamed "Undertaker Zemilox" "134.652176,110.004822,9.788691" NONE soulsapper shade
}
function Needlite()
{
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,704.013672,180.417877,283.524048]
	call CustomNamed "The Needlite Queen-NLP" "704.013672,180.417877,283.524048" NeedliteCustom
}
function NeedliteCustom(int _NamedID)
{
	if ${Actor[id,${_NamedID}].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},496]}].CurrentIncrements}>=1
	{
		;echo blood
		if ${Me.Archetype.Equal[mage]} || ${Me.SubClass.Equal[warden]} || ${Me.Class.Equal[shaman]}
		{
			;echo dispell
			call RIObj.Dispell ${_NamedID} 496 1
		}
		elseif ${Me.Inventory[Query, Name=="a needlite bloodsac" && Location=="Inventory"].TimeUntilReady}<1
		{
			RI_Obj_CB:Cast["Item:a needlite bloodsac",1]
		}
		else
			call RIObj.Target bloodsapper -Distance 10 ${_NamedID}
	}
	else
		call RIObj.Target bloodsapper -Distance 10 ${_NamedID}
}

function Broglyn()
{
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,10.300790,157.118057,319.954285]
	call CustomNamed "Broglyn-NLP-INC" "10.300790,157.118057,319.954285" BroglynCustom
}
function BroglynCustom(int _NamedID)
{
	if ${Me.Trauma}==1 && ${Me.Inventory[Query, Name=-"Cure Trauma" && Location=="Inventory"].TimeUntilReady}<1
	{
		if !${RI_Var_Bool_GlobalOthers}
			Actor[${Me.ID}]:DoTarget
		if ${Zone.Name.Findp[Solo]} && ${Me.Archetype.NotEqual[priest]}
			RI_Obj_CB:Cast["Item:Cure Trauma",1]
	}
	call RIObj.Target bogling -Distance 10 ${_NamedID}
}

function Killmodo()
{
	call CustomNamed "Killmodo" "-236.855484,223.871567,50.304039" NONE tuatara
}

function Scyphodon()
{
	call WaitForLastNamedChest START
	AnnounceText:Clear
	AnnounceText:Insert["Those with a bit of sugar in their veins may soon be devoured"]
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["opens its maw"]
	IncomingText:Insert["bites down on nothing"]
	RI_Obj_CB:DoNotCastAE[TRUE]
	;IncomingText:Insert["lashes out at anyone"]
	if !${RI_Var_Bool_GlobalOthers} && ${Me.Inventory[Query, Name=="colossal cane" && Location=="Inventory"](exists)}
	{
		while !${Me.Maintained[Magic Sugar](exists)}
		; && ( ${Me.GetGameData[Spells.Casting].NotEqual[Magic Sugar]} || !${Me.CastingSpell} )
		{
			Me.Inventory[Query, Name=="colossal cane" && Location=="Inventory"]:Use
			wait 5 ${Me.CastingSpell}
			wait 50 !${Me.CastingSpell}
			wait 5
		}
	}
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-389.944092,176.069504,322.958282]
	wait 300 ${Me.Distance[-389.944092,176.069504,322.958282]}<17
	call CustomNamed "Scyphodon" "-389.944092,176.069504,322.958282" ScyphodonCustom
	switch ${Me.SubClass}
	{
		case warden
		{
			;Aspect of The Forest X
			RI_CMD_AbilityEnableDisable "Aspect of The Forest" 1
			break
		}
		case defiler
		{
			;Harbinger X
			RI_CMD_AbilityEnableDisable "Harbinger" 1
			break
		}
		case dirge
		{
			;Hyren's Seething Sonata IV
			RI_CMD_AbilityEnableDisable "Hyren's Seething Sonata " 1
			break
		}
	}
	RI_Obj_CB:DoNotCastAE[FALSE]
	call WaitForLastNamedChest
	
}
function ScyphodonCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
	if ${Actor[id,${_NamedID}].CurrentAnimation.Equal[maw_enter]} || ( ${Trigger} && ( ${TriggerMessage.Find["opens its maw"](exists)} || ${TriggerMessage.Find["Those with a bit of sugar in their veins may soon be devoured"](exists)} ) )
	{
		Trigger:Set[0]
		;echo gonna bite me
		eq2ex cancel_spellcast
		;if ${TriggerMessage.Find["lashes out at anyone"]}
		;{
		;	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-414.757477 182.114700 318.033844]
		;	wait 50
		;	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-389.944092,176.069504,322.958282]
		;}
		;else
		;{
			do
			{
				Me.Maintained[Magic Sugar]:Cancel
				wait 2 !${Me.Maintained[Magic Sugar](exists)}
				Me.Maintained[Magic Sugar]:Cancel
			}
			while ${Me.Maintained[Magic Sugar](exists)} && ${Actor[Query, ID=${_NamedID} && IsDead=FALSE](exists)}
		;}
		wait 100 ${Trigger} || ${Actor[id,${_NamedID}].CurrentAnimation.Equal[maw_exit]}
		if ${Trigger} && ${TriggerMessage.Find["bites down on nothing"](exists)}
			Trigger:Set[0]
		;echo he bit
		wait 20
		if ${Trigger} && ${TriggerMessage.Find["bites down on nothing"](exists)}
			Trigger:Set[0]
		if ${Trigger} && ( ${TriggerMessage.Find["opens its maw"](exists)} || ${TriggerMessage.Find["Those with a bit of sugar in their veins may soon be devoured"](exists)} )
			return
	}
	if !${Me.Maintained[Magic Sugar](exists)} && !${Trigger} && !${Actor[id,${_NamedID}].CurrentAnimation.Equal[maw_enter]}
	{
		if !${RI_Var_Bool_GlobalOthers} && !${Me.Inventory[Query, Name=="colossal cane" && Location=="Inventory"](exists)} && !${Trigger} && !${Actor[id,${_NamedID}].CurrentAnimation.Equal[maw_enter]}
		{
			variable int _CaneID
			_CaneID:Set[${Actor[colossal cane].ID}]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_CaneID}].Loc},8,1000]
			wait 300 ${Me.Distance[${Actor[id,${_CaneID}].Loc}]}<9 || ${Trigger}
			while !${Actor[id,${_NamedID}].CurrentAnimation.Equal[maw_enter]} && !${Trigger} && ${Actor[id,${_CaneID}](exists)} && !${Me.Inventory[Query, Name=="colossal cane" && Location=="Inventory"](exists)} && ${Actor[Query, ID=${_NamedID} && IsDead=FALSE](exists)}
			{
				Actor[id,${_CaneID}]:DoubleClick
				wait 2 ${Trigger} || ${Actor[id,${_NamedID}].CurrentAnimation.Equal[maw_enter]}
			}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-389.944092,176.069504,322.958282]
			wait 300 ${Me.Distance[-389.944092,176.069504,322.958282]}<3 || ${Trigger} || ${Actor[id,${_NamedID}].CurrentAnimation.Equal[maw_enter]}
		}
		else
		{
			while !${RI_Var_Bool_GlobalOthers} && !${Actor[id,${_NamedID}].CurrentAnimation.Equal[maw_enter]} && !${Trigger} && !${Me.Maintained[Magic Sugar](exists)} && ${Me.Inventory[Query, Name=="colossal cane" && Location=="Inventory"](exists)} && ${Actor[Query, ID=${_NamedID} && IsDead=FALSE](exists)}
			{
				Me.Inventory[Query, Name=="colossal cane" && Location=="Inventory"]:Use
				wait 5 ${Me.CastingSpell} || ${Trigger} || ${Actor[id,${_NamedID}].CurrentAnimation.Equal[maw_enter]}
				wait 50 !${Me.CastingSpell} || ${Trigger} || ${Actor[id,${_NamedID}].CurrentAnimation.Equal[maw_enter]}
				wait 5 ${Trigger} || ${Actor[id,${_NamedID}].CurrentAnimation.Equal[maw_enter]}
				if ${Trigger} || ${Actor[id,${_NamedID}].CurrentAnimation.Equal[maw_enter]}
				{
					eq2ex cancel_spellcast
					do
					{
						Me.Maintained[Magic Sugar]:Cancel
						wait 2 !${Me.Maintained[Magic Sugar](exists)}
					}
					while ${Me.Maintained[Magic Sugar](exists)} && ${Actor[Query, ID=${_NamedID} && IsDead=FALSE](exists)}
				}
			}
		}
	}
	if ${Zone.Name.Find[Solo]} && ${Me.Archetype.NotEqual[priest]}
	{
		if ${Me.Trauma}==1 && ${Me.Inventory[Query, Name=-"Cure Trauma" && Location=="Inventory"].TimeUntilReady}<1
		{
			;echo TRAUM
			RI_Obj_CB:Cast["Item:Cure Trauma",1]
		}
		elseif ${Me.Elemental}==1 && ${Me.Inventory[Query, Name=-"Cure Elemental" && Location=="Inventory"].TimeUntilReady}<1
		{
			;echo ELE
			RI_Obj_CB:Cast["Item:Cure Elemental",1]
		}
	}
}

;End Echo Caverns: Quarry Quandary

;Start Echo Caverns: Fungal Foray

function Construct()
{
	;AnnounceText:Clear
	;IncomingText:Clear
	;IncomingText2:Clear
	;AnnounceText:Insert["10 meter blast around itself"]
	;IncomingText:Insert["fists become infected"]
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,0]
	call CustomNamed "Corrupted Construct-NMB" "-139.818710,58.472710,-405.702118" NONE
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,1]
}
function ConstructCustom(int _NamedID)
{
	if ${Me.Cursed}
	{
		relay ${RI_Var_String_RelayGroup} relay ${RI_Var_String_RelayGroup} RI_CMD_CastOn "Cure Curse" ${Me.Name} 1
	}
	call RIObj.Target ${_NamedID}
	if ${Trigger}
	{
		if ${Me.Distance[-155.947571,56.363277,-368.294098]}<5
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-185.030670,55.568680,-329.553131]
		else
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-155.947571,56.363277,-368.294098]
		Trigger:Set[0]
	}
}
function Shadowphage()
{
	call CustomNamed "Shadowphage-NMB" "-263.842102,254.177261,-301.471313" NONE feedling
}
function Vinzerah()
{
	call CustomNamed "Vinzerah Ral'Moor" "-190.138702,312.685364,-315.130585" VinzerahCustom
}
function VinzerahCustom(int _NamedID)
{
	call RIObj.Target anima -Distance 30 balanzite -Distance 30 ${_NamedID}
	if ${Actor[Query, Name=-"anima"].Distance}>25
		RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=-"anima"].Loc},25,1000]
	elseif ${Actor[Query, Name=-"balanzite"].Distance}>25
		RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=-"balanzite"].Loc},25,1000]
	else
		RIMUIObj:SetLockSpot[ALL,-190.138702,312.685364,-315.130585,1,1000]
	if ${Zone.Name.Find[Solo]} && ${Me.Archetype.NotEqual[priest]}
	{
		if ${Me.Arcane}==1 && ${Me.Inventory[Query, Name=-"Cure Arcane" && Location=="Inventory"].TimeUntilReady}<1
		{
			;echo TRAUM
			RI_Obj_CB:Cast["Item:Cure Arcane",1]
		}
	}
}
function Zugu()
{
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,293.872742,12.740015,-474.118561]
	call CustomNamed "Sporefiend Zugu-NLP" "293.872742,12.740015,-474.118561" NONE bolete spore voracious
}

function Cremini()
{
	call WaitForLastNamedChest START
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["brings the rain"]
	;IncomingText:Insert["You find it difficult to grasp"]
	while !${Actor[Fungus King Cremini](exists)} && ${Me.Inventory[puffball](exists)}
	{
		eq2ex use_itemvdl ${Me.Inventory[puffball].LinkID}
		wait 5
	}
	call CustomNamed "Fungus King Cremini-INC" "442.845062,257.483673,-435.829193" CreminiCustom
	call WaitForLastNamedChest
}
function CreminiCustom(int _NamedID)
{
	while !${Actor[Fungus King Cremini](exists)} && ${Me.Inventory[puffball](exists)}
	{
		eq2ex use_itemvdl ${Me.Inventory[puffball].LinkID}
		wait 5
	}
	call RIObj.Target royal -Distance 15 spore -Distance 15 ${_NamedID}
	if ${Trigger}
	{
		Trigger:Set[0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,452.984497,257.630127,-433.241211]
		wait 120
		while ${Actor[Query, Name=-"mushroom" && Distance<5].Interactable}
		{
			relay ${RI_Var_String_RelayGroup} Actor[mushroom]:DoubleClick
		}
		Trigger:Set[0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,442.845062,257.483673,-435.829193]
	}
}

;End Echo Caverns: Fungal Foray

;Start Savage Weald: Chaotic Caverns

function Bloodbath()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["Brutal Bloodbath throws some disgusting ichor your way"]
	call CustomNamed "Brutal Bloodbath-NMB" "-1126.007446,70.868431,-355.964355" BloodbathCustom
	IncomingText:Clear
}

function BloodbathCustom(int _NamedID)
{
	if ${Trigger}
	{
		RIMUIObj:SetLockSpot[${Me.Name},-1141.138672,71.185913,-345.902740]
		wait 30
		RIMUIObj:SetLockSpot[${Me.Name},-1126.007446,70.868431,-355.964355]
		Trigger:Set[0]
	}
	call RIObj.Dispell ${_NamedID} 496 1
	call RIObj.Target bloodpriest -Distance 30 ${_NamedID}
}

function Spelobanzeothitem()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["That thing reels"]
	call CustomNamed "The Spelobanzeothitem-NMB" "-955.619568,67.441833,-487.397614" SpelobanzeothitemCustom
	IncomingText:Clear
	wait 5
	eq2ex target_none
	wait 2
	eq2ex target_none
}
function SpelobanzeothitemCustom(int _NamedID)
{
	if ${Trigger}
	{
		;echo moving
		RIMUIObj:SetLockSpot[${Me.Name},-985.716858,67.440567,-488.596436]
		wait 100
		RIMUIObj:SetLockSpot[${Me.Name},-955.619568,67.441833,-487.397614]
		Trigger:Set[0]
	}
	call RIObj.Dispell ${_NamedID} 483 1
	call RIObj.Target whirling -Distance 20 speleothem -Distance 30 grimling -Distance 30 ${_NamedID}
}
function Forblarg()
{
	call CustomNamed "Forblarg the Foul-INC-NMB" "-1044.432617,53.555458,-610.935181" ForblargCustom follower
}
function ForblargCustom(int _NamedID)
{
	call RIObj.Target follower -Distance 30 ${_NamedID}
	;Shadow Shackles 828
	if ${RIMUIObj.MainIconIDExists[${Me.ID},828]}
	{
		RIMUIObj:SetLockSpot[${Me.Name},-1053.285400,53.439915,-618.648865]	
	}
	else
	{
		RIMUIObj:SetLockSpot[${Me.Name},-1044.432617,53.555458,-610.935181]
	}
}

function Morbigog()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["Morbigog goes under"]
	call CustomNamed "Morbigog-NMB-INC" "-1022.236511,11.385015,-606.868713" MorbigogCustom eruption swarmer
	IncomingText:Clear
}
function MorbigogCustom(int _NamedID)
{
	call RIObj.Target eruption -Distance 30 swarmer -Distance 30 ${_NamedID}
	if ${Trigger}
	{
		RIMUIObj:SetLockSpot[ALL,-1035.743286,11.385406,-623.816223]
		wait 50 
		;${Actor[id,${_NamedID}](exists)}
		;wait 50 ${Actor[id,${_NamedID}].Distance}<10
		RIMUIObj:SetLockSpot[ALL,-1022.236511,11.385015,-606.868713]
		Trigger:Set[0]
	}
}
function Tashakhi()
{
	call WaitForLastNamedChest START
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["You must find safety in the"]
	IncomingText:Insert["Death draws near to one of you"]
	call CustomNamed "Shred of Tashakhi" "-1175.009766,69.779556,-524.510498" TashakhiCustom warder
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,1]
	call WaitForLastNamedChest
}
function TashakhiCustom()
{
	call RIObj.Target warder -Distance 30 ${_NamedID}
	if ${Trigger}
	{
		if ${TriggerMessage.Find[You must find safety in the]}
		{
			wait 50 ${Actor[bubble](exists)}
			;echo SAFETY // ${Actor[Query, Name=="bubble"].Aura}
			if ${TriggerMessage.Find[RED]}
			{
				;echo RED: RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="bubble" && Aura=-"RED"].Loc}]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="bubble" && Aura=-"RED"].Loc}]
			}
			elseif ${TriggerMessage.Find[BLUE]}
			{
				;echo BLUE: RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="bubble" && Aura=-"BLUE"].Loc}]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="bubble" && Aura=-"BLUE"].Loc}]
			}
			elseif ${TriggerMessage.Find[WHITE]}
			{
				;echo WHITE: RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="bubble" && Aura=-"WHITE"].Loc}]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="bubble" && Aura=-"WHITE"].Loc}]
			}
			elseif ${TriggerMessage.Find[GREEN]}
			{
				;echo GREEN: RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="bubble" && Aura=-"GREEN"].Loc}]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="bubble" && Aura=-"GREEN"].Loc}]
			}
			elseif ${TriggerMessage.Find[YELLOW]}
			{
				;echo YELLOW: RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="bubble" && Aura=-"YELLOW"].Loc}]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="bubble" && Aura=-"YELLOW"].Loc}]
			}
			elseif ${TriggerMessage.Find[ORANGE]}
			{
				;echo ORANGE: RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="bubble" && Aura=-"ORANGE"].Loc}]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="bubble" && Aura=-"ORANGE"].Loc}]
			}
			elseif ${TriggerMessage.Find[PURPLE]}
			{
				;echo PURPLE: RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="bubble" && Aura=-"PURPLE"].Loc}]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="bubble" && Aura=-"PURPLE"].Loc}]
			}
			while ${Actor[bubble](exists)}
			{
				call RIObj.Target warder -Distance 30 ${_NamedID}
				wait 1
			}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-1175.009766,69.779556,-524.510498]
		}
		elseif ${TriggerMessage.Find[Death draws near to one of you]}
		{
			;echo deaths sight
			RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,0]
			wait 50 ${Me.Arcane}>0
			while ${Me.Arcane}>0
			{
				call RIObj.Target warder -Distance 30 ${_NamedID}
				if ${Me.Archetype.Equal[priest]}
				{
					if ${Actor[Query, Name==""].TintFlags}==${Me.TintFlags}
					{
						RI_Obj_CB:CastOn["Cure",${Me.Name},1]
					}
					elseif ${Actor[Query, Name==""].TintFlags}==${Me.Group[1].TintFlags}
					{
						RI_Obj_CB:CastOn["Cure",${Me.Group[1].Name},1]
					}
					elseif ${Actor[Query, Name==""].TintFlags}==${Me.Group[2].TintFlags}
					{
						RI_Obj_CB:CastOn["Cure",${Me.Group[2].Name},1]
					}
					elseif ${Actor[Query, Name==""].TintFlags}==${Me.Group[3].TintFlags}
					{
						RI_Obj_CB:CastOn["Cure",${Me.Group[3].Name},1]
					}
					elseif ${Actor[Query, Name==""].TintFlags}==${Me.Group[4].TintFlags}
					{
						RI_Obj_CB:CastOn["Cure",${Me.Group[4].Name},1]
					}
					elseif ${Actor[Query, Name==""].TintFlags}==${Me.Group[5].TintFlags}
					{
						RI_Obj_CB:CastOn["Cure",${Me.Group[5].Name},1]
					}
				}
				wait 1
			}
			RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,1]
		}
		Trigger:Set[0]
	}
}
;End Savage Weald: Chaotic Caverns

;Start Savage Weald: Fort Grim
function Nacisroc()
{
	;05:13:41: guardian / -29.685295,41.632233,-285.720825
	;05:13:47: guardian /  -- center
	;05:13:52: guardian / -25.640493,41.496494,-314.312836
	;grimling firechucker  -- white circle -- need to spewactor
	;grimling horde  -- add
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["begins to intercept damage from her sister"]
	IncomingText:Insert["Suffer as we have suffered"]
	declare RI_Var_NacisrocTargetID int global 0
	declare RI_Var_NacisrocNeedToJoust bool global FALSE
	call CustomNamed "Nacisroc-NMB-INC" "-30.256741,43.494931,-300.062714" NacisrocCustom
	deletevariable RI_Var_NacisrocTargetID
}

function NacisrocCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	if !${Actor[id,${RI_Var_NacisrocTargetID}](exsits)}
		RI_Var_NacisrocTargetID:Set[${Actor[Nacisroc].ID}]
	if ${Trigger}
	{
		if ${TriggerMessage.Find["begins to intercept damage from her sister"]}
		{
			if ${TriggerMessage.Find["Ulosi"]}
			{
				RI_Var_NacisrocTargetID:Set[${Actor[Ulosi Nacisroc].ID}]
			}
			else
			{
				RI_Var_NacisrocTargetID:Set[${Actor[Ulcine Nacisroc].ID}]
			}
		}
		else
		{
			echo joust set
			RI_Var_NacisrocNeedToJoust:Set[1]
			TimedCommand 45 RI_Var_NacisrocNeedToJoust:Set[0]
		}
		Trigger:Set[FALSE]
	}

	call RIObj.Target disjoiner -Distance 30 horde -Distance 30 ${RI_Var_NacisrocTargetID}
	;add lockspots to index then query all actors, 
	;then move to closest locspot that is more than 10 from every actor
	variable index:string _Locs
	variable int _i
	variable int _f
	variable index:actor _ActorIndex
	variable int _ClosestDistance=100000
	variable int _ClosestDistanceToMe=100000
	variable int _ClosestLoc=0
	variable int _DistanceAllowed=0
	EQ2:GetActors[_ActorIndex,range,100]
	if ${RI_Var_NacisrocNeedToJoust}
	{
		_DistanceAllowed:Set[20]
		EQ2:QueryActors[_ActorIndex, ( Name=="a grimling firechucker" && Overlay=="design_horizontal_target_warning_fx" ) || Name=="Ulosi Nacisroc" || Name=="Ulcine Nacisroc"]
		echo adding nameds to query //  ${_ActorIndex.Used}
	}
	else
	{
		_DistanceAllowed:Set[5]
		EQ2:QueryActors[_ActorIndex, Name=="a grimling firechucker" && Overlay=="design_horizontal_target_warning_fx"]
	}
	;echo ${Actor[Query, Name=="" && Overlay=="design_sinkhole_warning"]} // ${_ActorIndex.Used} // ${Actor[Query, Name=="" && TintFlags=2306]}
	if ${_ActorIndex.Used}==0
		return
	_Locs:Insert["-35.256741,43.494931,-275.062714"]
	_Locs:Insert["-35.256741,42.964931,-280.062714"]
	_Locs:Insert["-35.256741,42.354931,-285.062714"]
	_Locs:Insert["-35.256741,42.324931,-290.062714"]
	_Locs:Insert["-35.256741,42.324931,-295.062714"]
	_Locs:Insert["-35.256741,41.814931,-300.062714"]
	_Locs:Insert["-35.256741,41.904931,-305.062714"]
	_Locs:Insert["-35.256741,42.184931,-310.062714"]
	_Locs:Insert["-35.256741,42.724931,-315.062714"]
		
	_Locs:Insert["-30.256741,43.434931,-275.062714"]
	_Locs:Insert["-30.256741,42.754931,-280.062714"]
	_Locs:Insert["-30.256741,41.714931,-285.062714"]
	_Locs:Insert["-30.256741,41.544931,-290.062714"]
	_Locs:Insert["-30.256741,41.514931,-295.062714"]
	_Locs:Insert["-30.256741,41.234931,-300.062714"]
	_Locs:Insert["-30.256741,41.554931,-305.062714"]
	_Locs:Insert["-30.256741,40.954931,-310.062714"]
	_Locs:Insert["-30.256741,42.194931,-315.062714"]
		
	_Locs:Insert["-25.256741,43.884931,-275.062714"]
	_Locs:Insert["-25.256741,43.094931,-280.062714"]
	_Locs:Insert["-25.256741,41.194931,-285.062714"]
	_Locs:Insert["-25.256741,40.244931,-290.062714"]
	_Locs:Insert["-25.256741,40.554931,-295.062714"]
	_Locs:Insert["-25.256741,40.254931,-300.062714"]
	_Locs:Insert["-25.256741,40.174931,-305.062714"]
	_Locs:Insert["-25.256741,40.944931,-310.062714"]
	_Locs:Insert["-25.256741,41.504931,-315.062714"]
	
	;_Locs:Insert["-24.046013,41.231297,-284.922424"]
	;_Locs:Insert["-34.390327,42.253273,-285.501831"]
	;_Locs:Insert["-34.240734,42.214359,-294.379456"]
	;_Locs:Insert["-25.414078,40.544552,-294.230560"]
	;_Locs:Insert["-25.755686,40.151062,-303.928162"]
	;_Locs:Insert["-34.603954,41.697304,-303.423706"]

	;First check each loc distance from each actor and check they are at allowed distance or more
	;add each loc to the index that meets the requirements
	;then check which of those locs is closest to me and set it

	variable bool _Meets=TRUE
	variable index:int _LocMeets
	for(_i:Set[1];${_i}<=${_Locs.Used};_i:Inc)
	{
		_Meets:Set[TRUE]
		for(_f:Set[1];${_f}<=${_ActorIndex.Used};_f:Inc)
		{
			echo ${_i}\${Math.Distance[${_Locs.Get[${_i}]},${_ActorIndex.Get[${_f}].Loc}]}<\${_DistanceAllowed} =${Math.Distance[${_Locs.Get[${_i}]},${_ActorIndex.Get[${_f}].Loc}]}<${_DistanceAllowed}
			if ${Math.Distance[${_Locs.Get[${_i}]},${_ActorIndex.Get[${_f}].Loc}]}<${_DistanceAllowed}
				_Meets:Set[FALSE]
		}
		if ${_Meets}
		{
			_LocMeets:Insert[${_i}]
		}
	}
	echo _LocMeets=${_LocMeets.Used}
	echo _DistanceAllowed=${_DistanceAllowed}
	_ClosestDistance:Set[10000000]
	for(_i:Set[1];${_i}<=${_LocMeets.Used};_i:Inc)
	{
		echo ${_LocMeets.Get[${_i}]}: \${Me.Distance[${_Locs.Get[${_LocMeets.Get[${_i}]}]}]}<${_ClosestDistance} // ${Me.Distance[${_Locs.Get[${_LocMeets.Get[${_i}]}]}]}<${_ClosestDistance}
		if ${Me.Distance[${_Locs.Get[${_LocMeets.Get[${_i}]}]}]}<${_ClosestDistance}
		{
			_ClosestDistance:Set[${Me.Distance[${_Locs.Get[${_LocMeets.Get[${_i}]}]}]}]
			_ClosestLoc:Set[${_LocMeets.Get[${_i}]}]
		}
	}
	echo ${_ClosestLoc}
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Locs.Get[${_ClosestLoc}]}]
	if ${RI_Var_NacisrocNeedToJoust}
	{
		wait 5
		wait 150 !${Me.IsMoving}
		wait 5
	}
}

function Gadzuuks()
{
	;137.765884,51.425072,-216.954819
	;05:25:29: guardian / 124.308205,48.747246,-225.845825  -- center
	;111.752541,51.584370,-237.183121
	;a grimling skullcracker --- add
	;grimling firechucker  -- white circle -- need to spewactor
	call CustomNamed "Chief Gadzuuks" "124.308205,48.747246,-225.845825" GadzuuksCustom
}
function GadzuuksCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	call RIObj.Target skullcracker -Distance 30 ${_NamedID}
	;add lockspots to index then query all actors named a toxic shadow puddle, 
	;then move to closest locspot that is more than 10 from every puddle
	variable index:string _Locs
	variable index:actor _ActorIndex
	EQ2:GetActors[_ActorIndex,range,100]
	EQ2:QueryActors[_ActorIndex, Name=="a grimling firechucker" && Overlay=="design_horizontal_target_warning_fx"]
	;echo ${Actor[Query, Name=="" && Overlay=="design_sinkhole_warning"]} // ${_ActorIndex.Used} // ${Actor[Query, Name=="" && TintFlags=2306]}
	if ${_ActorIndex.Used}==0
		return
	
	_Locs:Insert["108.804222,50.839912,-225.085724"]
	_Locs:Insert["118.786057,49.968975,-216.702850"]
	_Locs:Insert["130.050629,52.615482,-208.632721"]
	_Locs:Insert["136.256119,51.319130,-217.511475"]
	_Locs:Insert["125.474808,48.820538,-225.432541"]
	_Locs:Insert["116.566452,49.788948,-232.580536"]
	_Locs:Insert["125.227051,47.589912,-241.545731"]
	_Locs:Insert["134.429535,47.757820,-232.655884"]
	_Locs:Insert["146.642197,50.500801,-225.949112"]
	_Locs:Insert["153.026016,49.354485,-235.500336"]
	_Locs:Insert["143.673813,45.577370,-242.170914"]
	_Locs:Insert["134.643448,43.258514,-249.262787"]

	call RIObj.AvoidActors _Locs _ActorIndex 5
}
function Felnir()
{
	call WaitForLastNamedChest START
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["stops to bark"]
	call CustomNamed "Felnir the Shadow Prowler" "60.427582,31.790459,-284.736450" FelnirCustom
	IncomingText:Clear
	call WaitForLastNamedChest
}

function FelnirCustom(int _NamedID)
{
	call RIObj.Target wolf -Distance 10 Pyre -Distance 30 ${_NamedID}
	if ${Trigger}
	{	
		variable point3f PointSideMob
		PointSideMob:Set[${Position.PointAtAngle[${_NamedID},${Math.Calc[${Math.Rand[10]}-5]},3]}]
		wait 1
		RIMUIObj:SetLockSpot[ALL,${PointSideMob}]
		wait 50
		RIMUIObj:SetLockSpot[ALL,60.427582,31.790459,-284.736450]
		Trigger:Set[0]
	}
}
;End Savage Weald: Fort Grim

;Start Shadeweaver's Thicket: Feral Reserve

function Greeneyes(string _Loc)
{
	call CustomNamed "Greeneyes" "${_Loc}" NONE glowbeak
}

function Hopper()
{
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-488.126038,117.240852,-300.886322]
	wait 300 ${Me.Distance[-488.126038,117.240852,-300.886322]}<5
	Actor[Hopper the Blood-Drenched]:DoTarget
	wait 300 ${Actor[Hopper the Blood-Drenched].Distance}<10
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-462.267029,115.578598,-350.630981]
	wait 300 ${Me.Distance[-462.267029,115.578598,-350.630981]}<3
	;wait 300 ${Actor[Hopper the Blood-Drenched].Distance}<10
	call CustomNamed "Hopper the Blood-Drenched-NMB" "-462.267029,115.578598,-350.630981" HopperCustom 
}
function HopperCustom(int _NamedID)
{
	;echo ${Actor[id,${_NamedID}]} // ${_NamedID} // ${Actor[id,${_NamedID}].Loc} // ${Actor[id,${_NamedID}].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},496]}].CurrentIncrements}>=1
	variable int _AqualingID
	call RIObj.Target saurek -Distance 10 ${_NamedID}
	if !${RI_Var_Bool_GlobalOthers} && ${Actor[Query, Name=-"aqualing" && IsDead=FALSE && Distance<50](exists)} && ${Actor[id,${_NamedID}].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},496]}].CurrentIncrements}>=21
	{
		_AqualingID:Set[${Actor[Query, Name=-"aqualing" && IsDead=FALSE && Distance<50].ID}]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_AqualingID}].Loc},1,1000]
		while ${Me.Distance[${Actor[id,${_AqualingID}].X},${Me.Y},${Actor[id,${_AqualingID}].Z}]}>1 && ${Actor[Query, ID=${_AqualingID} && IsDead=FALSE](exists)} && ${Actor[Query, ID=${_NamedID} && IsDead=FALSE](exists)} 
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_AqualingID}].Loc},1,1000]
			waitframe
		}
		wait 5
		Actor[id,${_AqualingID}]:DoTarget
		wait 50 ${Actor[id,${_AqualingID}].IsAggro}
		;Actor[id,${_NamedID}]:DoTarget
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_NamedID}].Loc},1,1000]
		;wait 300 ${Actor[id,${_AqualingID}].Distance}<10
		;Actor[id,${_AqualingID}]:DoTarget
		while ${Actor[Query, ID=${_AqualingID} && IsDead=FALSE](exists)} && ${Actor[Query, ID=${_NamedID} && IsDead=FALSE](exists)} 
		{
			Actor[id,${_AqualingID}]:DoTarget
			waitframe
		}
	}
	else
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-462.267029,115.578598,-350.630981]
		wait 300 ${Me.Distance[-462.267029,115.578598,-350.630981]}<3
		wait 50
	}
}
function Spawnpoacher()
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	AnnounceText:Clear
	AnnounceText:Insert["A foul wind blows through the forest"]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
	eq2ex pet backoff
	eq2ex pet stay here
	RI_CMD_PauseCombatBots 1
	if ${Me.SubClass.Equal[guardian]} && ${Me.Ability[id,1432018334].IsReady}
	{
		while !${Me.Maintained[Focused Offensive](exists)}
		{
			while ${Me.Ability[id,1432018334].IsReady}
			{
				Me.Ability[id,1432018334]:Use
				wait 5 ${Me.Maintained[Focused Offensive](exists)}
			}
			wait 5 ${Me.Maintained[Focused Offensive](exists)}
		}
	}
	elseif ${Me.Ability[id,4026518400].IsReady}
	{
		
		while !${Me.Maintained[Singular Focus](exists)}
		{
			while ${Me.Ability[id,4026518400].IsReady}
			{
				Me.Ability[id,4026518400]:Use
				wait 5 ${Me.Maintained[Singular Focus](exists)}
			}
			wait 5 ${Me.Maintained[Singular Focus](exists)}
		}
	}

	wait 10
	
	RI_Obj_CB:DoNotCastEncounter[TRUE]
	RI_Obj_CB:DoNotCastAE[TRUE]

	while !${Trigger}
	{
		call LockAndWait -Loc "-308.380005,99.495590,61.709999" -RelayToGroup -AllGroupWithinRange 3 300
		call LockAndWait -Loc "-318.539612,97.264008,41.564098" -RelayToGroup -AllGroupWithinRange 3 300
		call Poachercustomspawn
		call LockAndWait -Loc "-326.074524,100.790474,80.777397" -RelayToGroup -AllGroupWithinRange 3 300
		call LockAndWait -Loc "-293.631958,101.669197,124.002121" -RelayToGroup -AllGroupWithinRange 3 300
		call LockAndWait -Loc "-267.299988,109.443085,98.529999" -RelayToGroup -AllGroupWithinRange 3 300
		call Poachercustomspawn
		call LockAndWait -Loc "-257.839996,106.989899,120.379997" -RelayToGroup -AllGroupWithinRange 3 300
		call Poachercustomspawn
		call LockAndWait -Loc "-350.459991,112.048584,107.349998" -RelayToGroup -AllGroupWithinRange 3 300
		call LockAndWait -Loc "-337.489990,105.439636,120.830818" -RelayToGroup -AllGroupWithinRange 3 300
		call Poachercustomspawn
		call LockAndWait -Loc "-270.459991,101.602959,70.940002" -RelayToGroup -AllGroupWithinRange 3 300
		call Poachercustomspawn
		call LockAndWait -Loc "-272.695770,97.165184,49.318527" -RelayToGroup -AllGroupWithinRange 3 300
		call LockAndWait -Loc "-262.980011,101.260147,32.279999" -RelayToGroup -AllGroupWithinRange 3 300
		call LockAndWait -Loc "-267.809204,97.425240,45.806820" -RelayToGroup -AllGroupWithinRange 3 300
		call LockAndWait -Loc "-264.515961,100.388428,41.547348" -RelayToGroup -AllGroupWithinRange 3 300
		call Poachercustomspawn
		call LockAndWait -Loc "-308.380005,99.495590,61.709999" -RelayToGroup -AllGroupWithinRange 3 300
		call LockAndWait -Loc "-318.539612,97.264008,41.564098" -RelayToGroup -AllGroupWithinRange 3 300
		call LockAndWait -Loc "-338.378113,96.993126,44.354252" -RelayToGroup -WaitAfter 20 -AllGroupWithinRange 3 300
		if ${Trigger}
			continue
		call LockAndWait -Loc "-342.941650,100.402641,7.424779" -RelayToGroup -AllGroupWithinRange 3 300
		call LockAndWait -Loc "-314.339996,112.315300,-9.720000" -RelayToGroup -AllGroupWithinRange 3 300
		call Poachercustomspawn
		call LockAndWait -Loc "-342.941650,100.402641,7.424779" -RelayToGroup -AllGroupWithinRange 3 300
		call LockAndWait -Loc "-338.378113,96.993126,44.354252" -RelayToGroup -WaitAfter 20 -AllGroupWithinRange 3 300
	}
	Trigger:Set[0]
	AnnounceText:Clear
	RI_Obj_CB:DoNotCastEncounter[FALSE]
	RI_Obj_CB:DoNotCastAE[FALSE]
	
	;if ${Me.SubClass.Equal[guardian]}
		relay ${RI_Var_String_RelayGroup} Me.Maintained[Focused Offensive]:Cancel
	;else
		relay ${RI_Var_String_RelayGroup} Me.Maintained[Singular Focus]:Cancel
	relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 0
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
	relay ${RI_Var_String_RelayGroup} eq2ex pet follow
}
function Poachercustomspawn(string _Loc=${Me.Loc})
{
	if ${Trigger}
		return
	relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 1
	variable int _failcnt
	variable int _WhisperlingID
	;RIMUIObj:SetLockSpot[ALL,${Actor[desecrated beast].Loc},2]
	;wait 300 ${Actor[desecrated beast].Distance}<5
	_WhisperlingID:Set[${Actor[Query, Name=-"whisperling" && Distance<50].ID}]
	Actor[id,${_WhisperlingID}]:DoFace
	Actor[id,${_WhisperlingID}]:DoTarget
	wait 10
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Loc.Replace[" ",","]}]
	wait 300 ${Me.Distance[${_Loc.Replace[" ",","]}]}<3
	wait 300 ${RIMObj.AllGroupWithinRange[3]}
	wait 300 !${Me.IsMoving}
	while !${Actor[id,${_WhisperlingID}].Target.InMyGroup}
	{
		while !${Actor[id,${_WhisperlingID}].Target.InMyGroup} && ${_failcnt:Inc}<150
		{
			Actor[id,${_WhisperlingID}]:DoTarget
			if !${Me.IsMoving}
				Actor[id,${_WhisperlingID}]:DoFace
			while !${Me.RangedAutoAttackOn}
			{
				eq2ex togglerangedattack
				wait 2
			}
			wait 2
		}
		while ${Me.RangedAutoAttackOn}
		{
			eq2ex togglerangedattack
			wait 2
		}
		;echo not aggero
	}
	while ${Actor[Query, ID=${_WhisperlingID} && IsDead=FALSE](exists)} && ${_failcnt:Inc}<300 && ${Actor[Query, ID=${_WhisperlingID} && IsDead=FALSE].Distance}>8
	{
		;echo too far
		Actor[Query, Name=-"whisperling" && IsDead=FALSE]:DoTarget
		;Actor[Query, Name=-"whisperling" && IsDead=FALSE]:DoFace
		wait 1
	}
	relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 0
	while ${Actor[Query, ID=${_WhisperlingID} && IsDead=FALSE](exists)}
	{
		Actor[Query, Name=-"whisperling" && IsDead=FALSE]:DoTarget
		;Actor[Query, Name=-"whisperling" && IsDead=FALSE]:DoFace
		wait 1
	}
	relay ${RI_Var_String_RelayGroup} RI_CMD_PauseCombatBots 1
}
function Poacher()
{
	AnnounceText:Clear
	AnnounceText:Insert["reveals his true persona"]
	call CustomNamed "The Poached Poacher-NLP" "1,1,1" PoacherCustom
}
function PoacherCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
	if ${Trigger}
	{
		variable int _BeastID
		_BeastID:Set[${Actor[Query, Type=="NoKill NPC"].ID}]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-338.378113,96.993126,44.354252]
		wait 300 ${Me.Distance[-338.378113,96.993126,44.354252]}<3
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_BeastID}].Loc}]
		wait 300 ${Me.Distance[${Actor[id,${_BeastID}].Loc}]}<3
		while ${Actor[id,${_BeastID}](exists)}
		{
			Actor[id,${_BeastID}]:DoubleClick
			waitframe
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-338.378113,96.993126,44.354252]
		wait 300 ${Me.Distance[-338.378113,96.993126,44.354252]}<3
		Trigger:Set[0]
	}
	else
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_NamedID}].Loc},5,1000]
}
function Thraxinae()
{
	call CustomNamed "Thraxinae-NMB" "-183.506531,-399.988312,-406.382111" NONE silkspinner hatchling
}
function Kovari()
{
	call WaitForLastNamedChest START
	call CustomNamed "Kovari" "-548.681824,-325.703003,-326.468994" KovariCustom
	call CustomNamed "Kovari" "-548.681824,-325.703003,-326.468994" KovariCustom
	call WaitForLastNamedChest
}
function KovariCustom(int _NamedID)
{
	;echo ${Actor[Query, Name=="a bestial daemon anchor" && IsDead=FALSE]} // ${Actor[Query, Name=="a bestial daemon anchor" && IsDead=FALSE](exists)} // ${Actor[Query, Name=="a bestial daemon anchor" && IsDead=FALSE].Loc}
	variable int _AnchorID
	call RIObj.Target deathbiter -Distance 10 ${_NamedID}
	if ${Actor[Query, Name=="a bestial daemon anchor" && IsDead=FALSE](exists)}
	{
		_AnchorID:Set[${Actor[Query, Name=="a bestial daemon anchor" && IsDead=FALSE].ID}]
		;echo ${_AnchorID}
		;echo relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_AnchorID} && IsDead=FALSE].Loc}]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_AnchorID} && IsDead=FALSE].Loc},5,1000]
		while ${Actor[Query, ID=${_AnchorID} && IsDead=FALSE](exists)}
		{
			;echo exists
			Actor[Query, ID=${_AnchorID} && IsDead=FALSE]:DoTarget
			waitframe
		}
		
	}
	else
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-548.681824,-325.703003,-326.468994]
}

;End Shadeweaver's Thicket: Feral Reserve

;Start Shadeweaver's Thicket: Untamed Lands

function Goretilla()
{
	call CustomNamed "Goretilla-NMB" "-93.493202,66.069939,-402.478912" GoretillaCustom 
}
function GoretillaCustom(int _NamedID)
{
	call RIObj.Target shadeweaver -Distance 20 silkweaver -Distance 10 ${_NamedID}
	if ${Actor[Query, Name=="shadeweaver silk strand" && Distance<20](exists)}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="shadeweaver silk strand" && Distance<20].Loc}]
	}
	else
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-93.493202,66.069939,-402.478912]
	}
}
function STULSotekPet()
{
	wait 20
	RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
	eq2ex pet backoff
	eq2ex pet stay here
}
function Sotek()
{
	call CustomNamed "Sotek-NMB" "-173.915497,40.310238,-125.081650" SotekCustom
	RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
	eq2ex pet follow
}
function SotekCustom()
{
	if ${Actor[Query, Name=="a Gor Taku raider" && IsAggro=FALSE && IsDead=FALSE](exists)} && !${Actor[Query, Name=="a Gor Taku raider" && IsDead=FALSE].Target.InMyGroup}
	{
		Actor[a Gor Taku raider]:DoTarget
	}
	else
		call RIObj.Target ${_NamedID}
	if ${Me.Distance[-173.915497,40.310238,-125.081650]}>5
	{
		if ${Me.Arcane}==1 || ${Me.Group[1].Arcane}==1
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[OFF]
		else
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-173.915497,40.310238,-125.081650]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
	}
	else
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
	}
	if ${Zone.Name.Find[Solo]}
	{
		if ${Me.Archetype.Equal[priest]}
		{
			if ${Me.Arcane}==1 
			{
				if ${Me.Group}>1
				{
					switch ${Me.SubClass}
					{
						case warden
						{
							if ${Me.Ability[id,3708345871].TimeUntilReady}==0
								RI_Obj_CB:Cast["Shatter Infections",1]
							elseif ${Me.Ability[id,2194318360].TimeUntilReady}==0
								RI_Obj_CB:Cast["Tunare's Grace",1]
							elseif ${Me.Ability[id,633582527].TimeUntilReady}==0
								RI_Obj_CB:Cast["Verdant Whisper IV",1]
							else
							{
								if ${Me.Group[1].Arcane}==1
									RI_Obj_CB:CastOn["Cure",${Me.Group[1].Name},1]
								else
									RI_Obj_CB:CastOn["Cure",${Me.Name},1]
							}
							break
						}
						case fury
						{
							if ${Me.Ability[id,2612381697].TimeUntilReady}==0
								RI_Obj_CB:Cast["Natural Cleanse",1]
							elseif ${Me.Ability[id,2194318360].TimeUntilReady}==0
								RI_Obj_CB:Cast["Tunare's Grace",1]
							elseif ${Me.Ability[id,731480684].TimeUntilReady}==0
								RI_Obj_CB:Cast["Abolishment IV",1]
							else
							{
								if ${Me.Group[1].Arcane}==1
									RI_Obj_CB:CastOn["Cure",${Me.Group[1].Name},1]
								else
									RI_Obj_CB:CastOn["Cure",${Me.Name},1]
							}
							break
						}
						case defiler
						{
							if ${Me.Ability[id,3648477361].TimeUntilReady}==0
								RI_Obj_CB:Cast["Mail of Souls IV",1]
							else
							{
								if ${Me.Group[1].Arcane}==1
									RI_Obj_CB:CastOn["Cure",${Me.Group[1].Name},1]
								else
									RI_Obj_CB:CastOn["Cure",${Me.Name},1]
							}
							break
						}
						case mystic
						{
							if ${Me.Ability[id,3866216519].TimeUntilReady}==0
								RI_Obj_CB:Cast["Ebbing Spirit IV",1]
							else
							{
								if ${Me.Group[1].Arcane}==1
									RI_Obj_CB:CastOn["Cure",${Me.Group[1].Name},1]
								else
									RI_Obj_CB:CastOn["Cure",${Me.Name},1]
							}
							break
						}
						case templar
						{
							if ${Me.Ability[id,1906241692].TimeUntilReady}==0
								RI_Obj_CB:Cast["Devoted Resolve IV",1]
							else
							{
								if ${Me.Group[1].Arcane}==1
									RI_Obj_CB:CastOn["Cure",${Me.Group[1].Name},1]
								else
									RI_Obj_CB:CastOn["Cure",${Me.Name},1]
							}
							break
						}
						case inquisitor
						{
							if ${Me.Ability[id,481903671].TimeUntilReady}==0
								RI_Obj_CB:Cast["Resolute Flagellant IV",1]
							else
							{
								if ${Me.Group[1].Arcane}==1
									RI_Obj_CB:CastOn["Cure",${Me.Group[1].Name},1]
								else
									RI_Obj_CB:CastOn["Cure",${Me.Name},1]
							}
							break
						}
						case channeler
						{
							if ${Me.Ability[id,3528311980].TimeUntilReady}==0 && ${Me.Dissonance}<7150
								RI_Obj_CB:Cast["Channeled Cleansing",1]
							elseif ${Me.Ability[id,92825849].TimeUntilReady}==0
								RI_Obj_CB:Cast["Brood Cure IV",1]
							else
							{
								if ${Me.Group[1].Arcane}==1
									RI_Obj_CB:CastOn["Cure",${Me.Group[1].Name},1]
								else
									RI_Obj_CB:CastOn["Cure",${Me.Name},1]
							}
							break
						}
					}
				}
				else
					RI_Obj_CB:CastOn["Cure",${Me.Name},1]
			}
		}
		else
		{
			if ${Me.Arcane}==1 && ${Me.Inventory[Query, Name=-"Cure Arcane" && Location=="Inventory"].TimeUntilReady}<1
			{
				;echo Arcane
				RI_Obj_CB:Cast["Item:Cure Arcane",1]
			}
		}
	}
}
function Hakka()
{
	call CustomNamed "Nok Hakka" "87.341187,53.831421,-145.339340" NONE
	; Jobn Ganab
}

function Karina()
{
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,0]
	call CustomNamed "Spiritist Karina" "${Me.Loc}" KarinaCustom
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,1]
}
function KarinaCustom(int _NamedID)
{
	variable int _cnt=0
	if ${Me.Inventory[Query, Name=-"a darkened jawbone" && Location=="Inventory"](exists)}
		Me.Inventory[Query, Name=-"a darkened jawbone" && Location=="Inventory"]:Destroy
	variable int _ShadeID
	call RIObj.Target shade -Distance 15 ${_NamedID}
	if ${Actor[Query, Name=="a lesser shade" && IsDead=FALSE && Distane<100](exists)}
	{
		_ShadeID:Set[${Actor[Query, Name=="a lesser shade" && IsDead=FALSE && Distane<100].ID}]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_ShadeID}].Loc},6,1000]
		while ${Me.Distance[${Actor[id,${_ShadeID}].X},${Me.Y},${Actor[id,${_ShadeID}].Z}]}>11 && ${_cnt:Inc}<300
		{
			Actor[id,${_ShadeID}]:DoTarget
			if ${Me.Inventory[Query, Name=-"a darkened jawbone" && Location=="Inventory"](exists)}
				Me.Inventory[Query, Name=-"a darkened jawbone" && Location=="Inventory"]:Destroy
			wait 1
		}
		while ${Actor[Query, ID=${_ShadeID} && IsDead=FALSE](exists)}
		{
			if ${Me.Inventory[Query, Name=-"a darkened jawbone" && Location=="Inventory"](exists)}
				Me.Inventory[Query, Name=-"a darkened jawbone" && Location=="Inventory"]:Destroy
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_ShadeID}].Loc},6,1000]
			call RIObj.Target shade -Distance 15 ${_NamedID}
			waitframe
		}
		wait 30
	}
	else
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,177.724503,54.904110,-534.695313]
	}
}

function Desolator()
{
	relay ${RI_Var_String_RelayGroup} RI_Obj_CB:CastWhileMoving[1]
	variable index:string _StartLocs
	variable index:string _LightningSpots
	call WaitForLastNamedChest START
	declare RI_Var_DesolatorClosestLoc int global 0
	declare RI_Var_DesolatorLocs index:string global
	variable int _WhereWeAre=${Math.Calc[${MainArrayCounter}-475]}
	variable int _i=0
	variable bool _FoundMySpot=FALSE
	variable int _EndSpot=0
	RI_Obj_CB:SetUISetting[SettingsCancelCastingGroupCureCheckBox,1]
	_StartLocs:Insert["197.440125,16.396854,-374.852814"]
	_StartLocs:Insert["205.166580,16.716805,-381.382782"]
	_StartLocs:Insert["208.116959,17.370642,-387.408142"]
	_StartLocs:Insert["216.652359,16.802797,-393.098022"]
	_StartLocs:Insert["225.100998,16.820736,-398.946045"]
	_StartLocs:Insert["233.544601,17.297562,-405.337646"]
	_StartLocs:Insert["241.678818,17.847822,-411.200348"]
	_StartLocs:Insert["250.584946,18.083282,-416.439484"]
	_StartLocs:Insert["259.390167,18.646627,-421.490997"]
	_StartLocs:Insert["268.118988,19.894743,-426.361572"]
	_StartLocs:Insert["277.261627,20.711777,-430.626495"]
	_StartLocs:Insert["286.869843,20.271370,-433.429504"]
	_StartLocs:Insert["297.135040,19.481489,-434.111847"]
	_StartLocs:Insert["307.242371,18.401081,-434.937012"]
	_StartLocs:Insert["317.344238,17.213575,-435.963745"]
	_StartLocs:Insert["327.403503,17.305716,-436.986084"]
	_StartLocs:Insert["337.361786,17.554289,-437.997986"]
	_StartLocs:Insert["347.585175,17.842697,-439.336517"]
	_StartLocs:Insert["357.848511,17.825911,-439.608276"]
	_StartLocs:Insert["367.704224,16.591591,-438.415894"]
	_StartLocs:Insert["377.718750,16.139673,-436.915253"]
	_StartLocs:Insert["387.805237,16.409615,-434.935577"]
	_StartLocs:Insert["397.332245,15.918510,-431.766724"]
	_StartLocs:Insert["406.348328,15.890383,-427.205872"]
	_StartLocs:Insert["415.172577,16.067585,-422.293610"]
	_StartLocs:Insert["424.026459,15.947027,-417.643890"]
	_StartLocs:Insert["432.682526,16.145075,-412.522369"]
	_StartLocs:Insert["440.329010,15.929703,-405.930664"]
	_StartLocs:Insert["449.126526,16.060986,-401.151611"]
	_StartLocs:Insert["458.680176,15.840740,-397.534515"]
	_StartLocs:Insert["467.475555,15.443409,-392.271698"]
	_StartLocs:Insert["475.367401,17.933550,-386.390839"]
	_StartLocs:Insert["482.860596,19.315214,-380.996368"]
	_StartLocs:Insert["492.734558,18.452776,-382.765930"]
	_StartLocs:Insert["500.502991,15.390882,-388.605835"]
	_StartLocs:Insert["507.335510,13.888639,-395.792206"]
	_StartLocs:Insert["512.500671,18.225416,-403.405029"]
	_StartLocs:Insert["518.367676,20.530012,-411.475281"]
	_StartLocs:Insert["524.122620,20.599186,-419.710266"]
	_StartLocs:Insert["529.814697,18.307526,-427.850159"]
	_StartLocs:Insert["535.211548,15.944151,-436.253937"]
	_StartLocs:Insert["540.012512,16.176626,-445.369781"]
	_StartLocs:Insert["544.524170,19.397301,-453.878510"]
	_StartLocs:Insert["547.667908,20.550390,-459.835541"]
	_StartLocs:Insert["538.361328,20.216133,-463.793518"]
	_StartLocs:Insert["529.898987,17.388287,-468.445343"]
	_StartLocs:Insert["520.944336,16.475401,-473.542053"]
	_StartLocs:Insert["511.123383,16.716270,-475.587402"]
	_StartLocs:Insert["501.663513,16.502651,-471.922516"]
	_StartLocs:Insert["491.247986,16.374050,-470.313995"]
	_StartLocs:Insert["481.620605,15.873640,-473.855011"]
	_StartLocs:Insert["488.625885,17.341536,-491.040344"]
	_StartLocs:Insert["495.500061,17.619169,-498.686829"]
	_StartLocs:Insert["504.077576,16.891384,-504.369080"]
	_StartLocs:Insert["512.028870,16.631741,-510.507904"]
	_StartLocs:Insert["512.121826,17.967083,-520.522644"]
	_StartLocs:Insert["511.861877,18.183928,-530.616516"]
	_StartLocs:Insert["513.920532,17.418524,-540.526367"]
	_StartLocs:Insert["511.612915,16.476835,-550.494873"]
	_StartLocs:Insert["507.443237,15.850401,-559.797058"]
	_StartLocs:Insert["499.679535,15.850401,-566.196838"]
	_StartLocs:Insert["491.150879,15.850401,-571.765686"]
	_StartLocs:Insert["483.294006,15.850401,-578.111877"]
	_StartLocs:Insert["477.148926,15.850401,-584.250183"]
	_StartLocs:Insert["466.882111,15.850401,-583.874146"]
	_StartLocs:Insert["456.666718,15.850401,-584.234009"]
	_StartLocs:Insert["446.765259,16.388039,-582.738403"]
	_StartLocs:Insert["436.976410,17.491455,-579.748413"]
	_StartLocs:Insert["427.795441,18.433689,-575.827271"]
	_StartLocs:Insert["418.554565,18.588640,-571.420532"]
	_StartLocs:Insert["409.811066,17.523586,-566.346985"]
	_StartLocs:Insert["400.965057,16.886301,-561.401306"]
	_StartLocs:Insert["392.486084,16.938387,-555.908875"]
	_StartLocs:Insert["383.817169,17.591303,-550.395569"]
	_StartLocs:Insert["375.692780,17.731928,-544.538391"]
	_StartLocs:Insert["367.937897,17.665001,-537.977295"]
	_StartLocs:Insert["360.221100,17.007772,-531.448730"]
	_StartLocs:Insert["353.118103,17.216236,-524.170715"]
	_StartLocs:Insert["346.167938,20.365631,-517.567566"]
	_StartLocs:Insert["342.192261,21.622393,-513.060486"]
	_StartLocs:Insert["337.923492,20.577255,-503.934448"]
	_StartLocs:Insert["334.333069,19.516972,-494.625854"]
	_StartLocs:Insert["331.562866,19.572844,-484.862366"]
	_StartLocs:Insert["330.740173,19.649689,-481.188354"]
	_StartLocs:Insert["330.741425,21.257202,-471.301361"]
	_StartLocs:Insert["323.635681,21.248365,-463.805481"]
	_StartLocs:Insert["316.511047,20.530159,-456.729736"]
	_StartLocs:Insert["309.271454,19.588543,-449.773834"]
	_StartLocs:Insert["301.779297,19.702515,-443.010101"]
	_StartLocs:Insert["294.206696,20.096741,-436.159332"]
	_StartLocs:Insert["286.737305,19.051176,-429.229950"]
	_StartLocs:Insert["278.777954,17.921873,-423.126953"]
	_StartLocs:Insert["269.563354,17.954475,-418.417053"]
	_StartLocs:Insert["260.255371,17.966120,-414.327515"]
	_StartLocs:Insert["250.814911,17.877993,-410.459839"]
	_StartLocs:Insert["241.496857,17.473911,-405.948151"]
	_StartLocs:Insert["232.385422,17.194996,-401.280273"]
	_StartLocs:Insert["227.862946,17.702345,-392.303040"]
	_StartLocs:Insert["230.858749,18.860106,-384.332214"]
	_StartLocs:Insert["224.375717,17.027197,-376.517670"]
	_StartLocs:Insert["218.542496,17.043545,-368.361969"]
	_StartLocs:Insert["214.936447,15.783745,-361.820557"]
	_StartLocs:Insert["224.991409,16.455076,-360.790955"]
	_StartLocs:Insert["234.986969,16.637003,-358.840607"]
	_StartLocs:Insert["244.328979,16.208857,-354.788361"]
	_StartLocs:Insert["252.934372,16.554367,-349.465790"]
	_StartLocs:Insert["259.506409,15.575258,-341.935272"]
	_StartLocs:Insert["266.381500,15.355490,-334.367126"]
	_StartLocs:Insert["273.978882,15.822111,-327.582458"]
	_StartLocs:Insert["282.064606,16.248516,-321.596954"]
	_StartLocs:Insert["291.108795,16.740032,-316.517883"]
	_StartLocs:Insert["301.180176,16.984125,-315.117676"]
	_StartLocs:Insert["310.698181,16.388304,-312.092926"]
	_StartLocs:Insert["320.479218,16.207731,-309.944580"]
	_StartLocs:Insert["330.629272,16.209776,-310.430542"]
	_StartLocs:Insert["340.905457,15.901670,-311.742767"]
	_StartLocs:Insert["350.889313,15.939022,-312.644470"]
	_StartLocs:Insert["361.094208,15.850401,-311.011169"]
	_StartLocs:Insert["371.296387,15.881483,-312.735535"]
	_StartLocs:Insert["381.066437,16.087219,-315.478821"]
	_StartLocs:Insert["390.303864,16.660496,-319.782593"]
	_StartLocs:Insert["398.279083,17.477705,-325.863831"]
	_StartLocs:Insert["405.956665,17.030756,-332.596130"]
	_StartLocs:Insert["413.395477,16.289253,-339.309082"]
	_StartLocs:Insert["421.390625,15.944151,-345.631683"]
	_StartLocs:Insert["429.367065,15.944151,-351.794464"]
	_StartLocs:Insert["436.871857,17.636774,-358.185669"]
	_StartLocs:Insert["444.720703,20.537552,-363.685211"]
	_StartLocs:Insert["452.685059,21.927149,-369.647278"]
	_StartLocs:Insert["460.614288,20.110689,-375.639130"]
	_StartLocs:Insert["468.833313,17.849224,-381.329346"]
	_StartLocs:Insert["477.213593,17.674328,-387.364044"]
	_StartLocs:Insert["484.943512,14.411192,-393.383423"]
	_StartLocs:Insert["492.988007,14.569381,-399.771973"]
	_StartLocs:Insert["500.263763,18.338566,-405.649933"]
	_StartLocs:Insert["507.506378,20.461777,-412.263916"]
	_StartLocs:Insert["515.531921,21.246099,-418.332275"]
	_StartLocs:Insert["523.864014,19.798067,-424.053558"]
	_StartLocs:Insert["531.973267,17.496637,-430.073517"]
	_StartLocs:Insert["540.166870,15.944151,-435.660004"]
	_StartLocs:Insert["549.725220,15.944151,-439.372131"]
	_StartLocs:Insert["559.183228,15.944151,-443.040558"]
	_StartLocs:Insert["566.537354,18.334152,-449.917877"]
	_StartLocs:Insert["573.818054,19.217638,-456.913910"]
	_StartLocs:Insert["578.582581,17.401491,-465.572174"]
	_StartLocs:Insert["582.028381,16.193615,-475.041351"]
	_StartLocs:Insert["585.226563,16.272125,-484.853302"]
	_StartLocs:Insert["587.527893,19.805599,-494.143799"]
	_StartLocs:Insert["590.304749,22.143574,-503.478790"]
	_StartLocs:Insert["583.500854,20.271553,-510.658264"]
	_StartLocs:Insert["575.391602,19.268379,-516.760315"]
	_StartLocs:Insert["566.960449,17.870182,-522.104919"]
	_StartLocs:Insert["561.604004,15.677578,-530.427124"]
	_StartLocs:Insert["554.909546,14.575307,-538.204529"]
	_StartLocs:Insert["548.857544,16.210150,-546.063538"]
	_StartLocs:Insert["543.556213,19.060015,-552.682068"]
	_StartLocs:Insert["537.481995,14.314855,-545.802795"]
	_StartLocs:Insert["531.032471,15.154747,-537.875854"]
	_StartLocs:Insert["524.697510,15.126707,-530.046448"]
	_StartLocs:Insert["518.279541,16.382504,-522.462036"]
	_StartLocs:Insert["511.618988,17.096149,-514.778442"]
	_StartLocs:Insert["504.811401,17.122929,-507.108307"]
	_StartLocs:Insert["498.061554,17.241436,-499.503204"]
	_StartLocs:Insert["490.841431,17.206144,-492.257355"]
	_StartLocs:Insert["483.420044,16.867647,-485.083099"]
	_StartLocs:Insert["475.826019,16.135365,-478.186462"]
	_StartLocs:Insert["466.986176,15.850401,-472.873566"]
	_StartLocs:Insert["457.403229,15.850401,-469.672882"]
	_StartLocs:Insert["447.644470,15.850401,-466.778381"]
	_StartLocs:Insert["438.282990,16.931591,-462.746216"]
	_StartLocs:Insert["428.500122,17.697092,-459.250916"]
	_StartLocs:Insert["418.853363,16.756868,-456.292236"]
	_StartLocs:Insert["408.857635,16.757172,-454.417542"]
	_StartLocs:Insert["398.036896,17.269819,-454.542969"]
	_StartLocs:Insert["387.900116,17.927023,-456.001251"]
	_StartLocs:Insert["380.416595,21.097757,-462.064453"]
	_StartLocs:Insert["379.714539,21.272188,-462.571808"]
	_StartLocs:Insert["370.386841,22.080873,-458.676788"]
	_StartLocs:Insert["360.424774,21.351431,-456.149170"]
	_StartLocs:Insert["350.250031,20.391350,-454.639282"]
	_StartLocs:Insert["339.976379,20.402954,-453.343475"]
	_StartLocs:Insert["331.681793,20.529509,-452.297363"]
	_StartLocs:Insert["333.226990,18.432877,-442.465973"]
	_StartLocs:Insert["334.424957,17.051104,-432.460419"]
	_StartLocs:Insert["335.245514,17.481789,-422.231323"]
	_StartLocs:Insert["336.458801,17.693083,-412.137360"]
	_StartLocs:Insert["337.200989,18.186852,-401.647858"]
	_StartLocs:Insert["337.904510,19.384924,-391.710754"]
	_StartLocs:Insert["338.705383,18.977905,-381.480743"]
	_StartLocs:Insert["339.415131,17.052446,-371.268951"]
	_StartLocs:Insert["339.446625,15.458366,-361.105774"]
	_StartLocs:Insert["340.031769,16.361931,-351.061707"]
	_StartLocs:Insert["340.156891,17.968983,-342.323029"]
	_StartLocs:Insert["330.543823,17.575788,-338.595459"]
	_StartLocs:Insert["320.802032,16.729973,-335.446747"]
	_StartLocs:Insert["310.975098,15.842247,-333.811920"]
	_StartLocs:Insert["300.889374,15.330038,-331.347656"]
	_StartLocs:Insert["295.200317,17.181524,-322.729065"]
	_StartLocs:Insert["295.251160,17.083870,-313.663208"]
	_StartLocs:Insert["285.186615,16.713665,-316.349274"]
	_StartLocs:Insert["275.525116,16.416876,-319.068237"]
	_StartLocs:Insert["265.038269,16.204741,-322.265930"]
	_StartLocs:Insert["255.335419,15.476212,-325.605011"]
	_StartLocs:Insert["245.850861,16.250851,-328.905640"]
	_StartLocs:Insert["240.092560,17.660759,-330.909576"]
	_StartLocs:Insert["235.597717,18.583099,-339.927094"]
	_StartLocs:Insert["230.925629,17.566278,-348.780212"]
	_StartLocs:Insert["226.133286,16.233847,-357.534607"]
	_StartLocs:Insert["220.534698,17.242836,-366.208740"]
	_StartLocs:Insert["217.264450,16.575342,-371.434631"]
	if ${MainArrayCounter}==0
	{
		variable int _ClosestLoc=0
		variable int _ClosestDistance=9999999999999999
		for(_i:Set[1];${_i}<=${_StartLocs.Used};_i:Inc)
		{
			if ${Me.Distance[${_StartLocs.Get[${_i}]}]}<${_ClosestDistance}
			{
				_ClosestDistance:Set[${Me.Distance[${_StartLocs.Get[${_i}]}]}]
				_ClosestLoc:Set[${_i}]
			}
		}
		_WhereWeAre:Set[${_ClosestLoc}]
	}
	;echo WhereWeAre: ${_WhereWeAre} 
	;spots (1-Lightning Spot 2-Lockspot 3-JoustSpot) 
	;Lightning 1-
	RI_Var_DesolatorLocs:Insert["251.159241,18.103634,-417.050690"]
	RI_Var_DesolatorLocs:Insert["240.386978,25.514429,-438.358185"]
	RI_Var_DesolatorLocs:Insert["269.315063,21.090008,-444.510681"]
	;Lightning 2-
	RI_Var_DesolatorLocs:Insert["334.029236,19.394447,-499.589752"]
	RI_Var_DesolatorLocs:Insert["295.080902,17.790916,-492.223755"]
	RI_Var_DesolatorLocs:Insert["292.508606,17.958212,-521.907593"]
	;Lightning 3-
	RI_Var_DesolatorLocs:Insert["468.771393,15.850401,-582.576538"]
	RI_Var_DesolatorLocs:Insert["466.917358,20.153799,-554.687744"]
	RI_Var_DesolatorLocs:Insert["436.199158,17.215849,-555.908447"]
	;Lightning 4-
	RI_Var_DesolatorLocs:Insert["578.442322,16.475401,-623.661804"]
	RI_Var_DesolatorLocs:Insert["552.475830,17.038357,-602.924316"]
	RI_Var_DesolatorLocs:Insert["532.343384,17.608706,-625.459290"]
	;Lightning 5-
	RI_Var_DesolatorLocs:Insert["513.432678,17.360611,-463.930298"]
	RI_Var_DesolatorLocs:Insert["500.263306,19.874472,-485.187958"]
	RI_Var_DesolatorLocs:Insert["499.839752,19.572754,-515.307251"]
	;Lightning 6-
	RI_Var_DesolatorLocs:Insert["390.448486,15.795511,-442.819122"]
	RI_Var_DesolatorLocs:Insert["418.004120,16.506639,-439.383209"]
	RI_Var_DesolatorLocs:Insert["424.626373,18.866535,-468.175171"]
	;Lightning 7-
	RI_Var_DesolatorLocs:Insert["460.674225,17.078157,-387.766052"]
	RI_Var_DesolatorLocs:Insert["441.866394,16.671579,-412.847290"]
	RI_Var_DesolatorLocs:Insert["430.158020,21.566063,-386.562042"]
	;Lightning 8-
	RI_Var_DesolatorLocs:Insert["379.702972,15.966488,-308.923859"]
	RI_Var_DesolatorLocs:Insert["352.587616,19.661453,-291.363007"]
	RI_Var_DesolatorLocs:Insert["325.857544,16.209776,-303.777039"]
	;Lightning 9-
	RI_Var_DesolatorLocs:Insert["270.382477,15.005335,-333.802612"]
	RI_Var_DesolatorLocs:Insert["255.917328,17.361769,-356.089661"]
	RI_Var_DesolatorLocs:Insert["229.643127,18.811077,-344.927002"]
	;Lightning 10-
	RI_Var_DesolatorLocs:Insert["336.646973,19.237564,-394.325104"]
	RI_Var_DesolatorLocs:Insert["362.332581,18.796167,-381.302155"]
	RI_Var_DesolatorLocs:Insert["386.733948,15.371937,-364.630737"]

	;here we need to determine where we are in the locs list and start from there and go until the next lightning, 
	;then move to that lightenings safespot aka xakra
	;1
	_LightningSpots:Insert[8|1]
	;6
	_LightningSpots:Insert[22|16]
	;7
	_LightningSpots:Insert[30|19]
	;5
	_LightningSpots:Insert[48|13]
	;3
	_LightningSpots:Insert[65|7]
	;2
	_LightningSpots:Insert[81|4]
	;1
	_LightningSpots:Insert[94|1]
	;10
	_LightningSpots:Insert[108|28]
	;8
	_LightningSpots:Insert[119|22]
	;7
	_LightningSpots:Insert[131|19]
	;6
	_LightningSpots:Insert[174|16]
	;10
	_LightningSpots:Insert[188|28]
	;9
	_LightningSpots:Insert[202|25]
	;1
	_LightningSpots:Insert[210|1]
	;echo LigtningSpots: ${_LightningSpots.Used}
	;now determine first _LightningSpots that is > than ${_WhereWeAre}
	for(_i:Set[1];${_i}<=${_LightningSpots.Used};_i:Inc)
	{
		;echo ${_LightningSpots.Get[${_i}].Token[1,|]}>${_WhereWeAre} && !${_FoundMySpot}
		if ${_LightningSpots.Get[${_i}].Token[1,|]}>${_WhereWeAre} && !${_FoundMySpot}
		{
			_EndSpot:Set[${_LightningSpots.Get[${_i}].Token[1,|]}]
			RI_Var_DesolatorClosestLoc:Set[${_LightningSpots.Get[${_i}].Token[2,|]}]
			_FoundMySpot:Set[1]
		}
	}
	;echo _EndSpot: ${_EndSpot}
	;echo RI_Var_DesolatorClosestLoc: ${RI_Var_DesolatorClosestLoc}
	if !${RI_Var_Bool_GlobalOthers}
	{
		for(_i:Set[${_WhereWeAre}];${_i}<=${_EndSpot};_i:Inc)
		{
			Me:DoTarget
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_StartLocs.Get[${_i}]},1,1000]
			Me:DoTarget
			wait 300 ${Me.Distance[${_StartLocs.Get[${_i}]}]}<3
			Me:DoTarget
			;wait 300 ${RIMObj.AllGroupWithinRange[5]}
			Me:DoTarget
		}
	}
	wait 300 ${RIMObj.AllGroupWithinRange[3]}
	;IncomingText:Insert[prepares to destroy everyone nearby]
	IncomingText:Insert[releases devastating arcane energies in an area around him]
	call CustomNamed "Desolator-NMB-INC" "${RI_Var_DesolatorLocs.Get[${Math.Calc[${RI_Var_DesolatorClosestLoc}+1]}]}" DesolatorCustom
	MainArrayCounter:Set[9999999]
	if ${Zone.Name.Find["[Solo]"]}
		noop
	else
	{
		wait 50 ${Me.Equipment[1].IsItemInfoAvailable}
		while ${Me.Equipment[1].ToItemInfo.Condition}<100
		{
			if ${Actor[Kela Zov Xakra].Distance}<10
				Actor[Kela Zov Xakra]:DoubleClick
			wait 1
		}
	}
	wait 20
	if !${RI_Var_Bool_GlobalOthers}
	{
		call WaitForLastNamedChest
		if ${Me.Distance[580.827209,16.475399,-623.062988]}<50
		{
			call RIMObj.Move 519.791016 16.098490 -623.997192
		}
		if ${Me.Distance[250.537720,18.117197,-417.524780]}<50
		{
			call RIMObj.Move 323.279938 21.232162 -455.559937
		}
		elseif ${Me.Distance[269.666260,15.071657,-333.964661]}<50
		{
			call RIMObj.Move 338.781982 16.041248 -351.658356
		}
		elseif ${Me.Distance[513.960022,16.866116,-465.377319]}<50
		{
			call RIMObj.Move 359.703552 17.719460 -506.263794
		}
		elseif ${Me.Distance[462.968109,17.340069,-385.804138]}<50
		{
			call RIMObj.Move 364.560547 21.121548 -455.290192
		}
		elseif ${Me.Distance[380.052490,15.989151,-309.745667]}<50
		{
			call RIMObj.Move 441.444824 15.921669 -405.880402
			call RIMObj.Move 364.560547 21.121548 -455.290192
		}
		call RIMObj.Move 354.270844 17.706196 -541.197815
	}
	deletevariable RI_Var_DesolatorClosestLoc
	deletevariable RI_Var_DesolatorLocs
	relay ${RI_Var_String_RelayGroup} RI_Obj_CB:CastWhileMoving[0]
}
function DesolatorCustom(int _NamedID)
{
	variable int _i
	variable int _timer=0
	;Va Xin Domination 859
	call RIObj.Dispell ${_NamedID} 859

	if ${RIMUIObj.MainIconIDExists[${Me.ID},372]} && ${Script.RunningTime}>${Math.Calc[${_timer}+5000]}
	{
		_timer:Set[${Script.RunningTime}]
		wait 50 ${Me.Equipment[1].IsItemInfoAvailable}
		while ${Me.Equipment[1].ToItemInfo.Condition}<=50
		{
			if ${Actor[Kela Zov Xakra].Distance}<10
				Actor[Kela Zov Xakra]:DoubleClick
			wait 1
		}
	}
	if ${Trigger}
	{
		if ${Actor[id, ${_NamedID}].Distance}<30
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${RI_Var_DesolatorLocs.Get[${Math.Calc[${RI_Var_DesolatorClosestLoc}+2]}]}]
			wait 50
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${RI_Var_DesolatorLocs.Get[${Math.Calc[${RI_Var_DesolatorClosestLoc}+1]}]}]
		}
		Trigger:Set[0]
	}

	if ${Actor[boss 5 portal - right](exists)}
	{
		wait 50
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[boss 5 portal - right].Loc}]
		wait 300 ${Me.Distance[${Actor[boss 5 portal - right].Loc}]}<3
		wait 300 ${RIMObj.AllGroupWithinRange[3]}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,OFF]
		while ${Actor[boss 5 portal - right](exists)}
		{
			;echo while
			;relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[boss 5 portal - right].Loc}]
			relay ${RI_Var_String_RelayGroup} Actor["boss 5 portal - right"]:DoubleClick
			wait 1
		}
		;echo after while
		wait 10
		;here we need to determine which lightning we ported too and set our lockspot to the xakra near it
		for(_i:Set[1];${_i}<${RI_Var_DesolatorLocs.Used};_i:Inc)
		{
			if ${Me.Distance[${RI_Var_DesolatorLocs.Get[${_i}]}]}<15
			{
				;echo RI_Var_DesolatorClosestLoc:Set[${_i}]
				RI_Var_DesolatorClosestLoc:Set[${_i}]
			}
		}
		;Va Xin Domination 859
		while ${RIMUIObj.MainIconIDExists[${_NamedID},859]}
		{
			call RIObj.Dispell ${_NamedID} 859
			wait 1
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${RI_Var_DesolatorLocs.Get[${Math.Calc[${RI_Var_DesolatorClosestLoc}+1]}]}]
	}
}
;End Shadeweaver's Thicket: Untamed Lands

;Start Vex Thal: Shadow Citadel

function Xiuhsiss()
{
	call CustomNamed "Rhag'Xiuhsiss" "85.774017,-30.630754,-214.171936"
}

function Shaaho()
{
	call CustomNamed "Enforcer Shaaho" "-81.514809,31.049467,-420.590668"
}

;End Vex Thal: Shadow Citadel

;Start Shar Vahl: Siege Break

function Obscura()
{
	call CustomNamed "Obscura Zun'Xakra" "-48.461372,94.478394,330.688721" NONE guard burrower
}
function CheckCures()
{
	if ${Me.Archetype.NotEqual[priest]}
	{
		if ${Me.Trauma}>0 && ${Me.Inventory[Query, Name=-"Cure Trauma" && Location=="Inventory"].TimeUntilReady}<1
		{
			;echo Trauma
			RI_Obj_CB:Cast["Item:Cure Trauma",1]
		}
		elseif ${Me.Elemental}>0 && ${Me.Inventory[Query, Name=-"Cure Elemental" && Location=="Inventory"].TimeUntilReady}<1
		{
			;echo Elemental
			RI_Obj_CB:Cast["Item:Cure Elemental",1]
		}
		if ${Me.Arcane}>0 && ${Me.Inventory[Query, Name=-"Cure Arcane" && Location=="Inventory"].TimeUntilReady}<1
		{
			;echo Arcane
			RI_Obj_CB:Cast["Item:Cure Arcane",1]
		}
		elseif ${Me.Noxious}>0 && ${Me.Inventory[Query, Name=-"Cure Noxious" && Location=="Inventory"].TimeUntilReady}<1
		{
			;echo Noxious
			RI_Obj_CB:Cast["Item:Cure Noxious",1]
		}
	}
}
function Calamitus()
{
	call RIObj.SingularFocus 1
	RI_Obj_CB:DoNotCastEncounter[TRUE]
	RI_Obj_CB:DoNotCastAE[TRUE]
	call CustomNamed "Do'om Calamitus-NLP" "1,1,1" CalamitusCustom
	RI_Obj_CB:DoNotCastEncounter[FALSE]
	RI_Obj_CB:DoNotCastAE[FALSE]
	call RIObj.SingularFocus 0
}
function CalamitusCustom(int _NamedID)
{
	if ${Zone.Name.Find[Solo]}
		call CheckCures
	if !${Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=157.089996 && Y=72.449997 && Z=234.880005].Target.InMyGroup} && ${Zone.Name.Find["[Solo]"]}==0
	{
		while !${Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=157.089996 && Y=72.449997 && Z=234.880005].Target.InMyGroup}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,171.368515,70.678200,254.264969]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
			relay ${RI_Var_String_RelayGroup} eq2ex pet backoff	
			relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
			Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=157.089996 && Y=72.449997 && Z=234.880005]:DoTarget
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
	}
	elseif ${Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=160.699997 && Y=75.889999 && Z=220.500000](exists)}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,178.280518,76.111237,232.636124]
		Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=160.699997 && Y=75.889999 && Z=220.500000]:DoTarget
	}
	elseif ${Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=200.990005 && Y=72.449997 && Z=263.079987](exists)}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,184.768326,72.620979,252.613266]
		Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=200.990005 && Y=72.449997 && Z=263.079987]:DoTarget
	}
	elseif ${Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=212.710007 && Y=75.889999 && Z=253.929993](exists)}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,195.069839,76.359039,241.251724]
		Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=212.710007 && Y=75.889999 && Z=253.929993]:DoTarget
	}
	elseif ${Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=225.630005 && Y=78.529999 && Z=243.089996](exists)}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,209.393585,77.200005,233.508423]
		Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=225.630005 && Y=78.529999 && Z=243.089996]:DoTarget
	}
	elseif ${Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=229.880005 && Y=75.889999 && Z=227.309998](exists)}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,211.155533,75.824493,214.662613]
		Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=229.880005 && Y=75.889999 && Z=227.309998]:DoTarget
	}
	elseif ${Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=233.550003 && Y=72.449997 && Z=212.339996](exists)}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,217.481003,72.965904,202.779083]
		Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE ]:DoTarget
	}
	elseif ${Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=189.630005 && Y=72.449997 && Z=184.149994](exists)}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,205.230209,72.892540,196.014801]
		Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=189.630005 && Y=72.449997 && Z=184.149994]:DoTarget
	}
	elseif ${Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=177.580002 && Y=75.889999 && Z=193.759995](exists)}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,193.472153,76.694389,207.393585]
		Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=177.580002 && Y=75.889999 && Z=193.759995]:DoTarget
	}
	elseif ${Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=165.130005 && Y=78.529999 && Z=204.429993](exists)}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,181.796478,77.201408,215.230408]
		Actor[Query, Name=="a Zov Dyn Dabo" && IsDead=FALSE && X=165.130005 && Y=78.529999 && Z=204.429993]:DoTarget
	}
	else
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,199.476273,77.136993,217.620621]
		call RIObj.Target ${_NamedID}
	}
}
;will need to update DAT from Zethon to Kaas
function Kaas()
{
	call CustomNamed "An'Kaas Fer'Zethon-NMB-INC" "-165.296997,-196.585724,577.642334" KaasCustom
}
function KaasCustom(int _NamedID)
{
	call RIObj.Target shadowbeast -Distance 30 shadow -Distance 15 Zun -Distance 15 ${_NamedID}
	if ${Actor[fire spot](exists)} && ${Me.Class.Equal[bard]}
	{
		variable int _Crate
		variable int _FireSpot
		RIMUIObj:SetLockSpot[ALL,-130.948624,-189.853485,577.599854]
		wait 300 ${Me.Distance[-130.948624,-189.853485,577.599854]}<3
		;Movable crate
		_Crate:Set[${Actor[Movable crate].ID}]
		RIMUIObj:SetLockSpot[ALL,${Actor[id,${_Crate}].Loc}]
		wait 300 ${Me.Distance[${Actor[id,${_Crate}].Loc}]}<3
		Actor[id,${_Crate}]:DoubleClick
		wait 2
		Actor[id,${_Crate}]:DoubleClick
		wait 2
		Actor[id,${_Crate}]:DoubleClick
		RIMUIObj:SetLockSpot[ALL,-130.948624,-189.853485,577.599854]
		wait 300 ${Me.Distance[-130.948624,-189.853485,577.599854]}<3
		RIMUIObj:SetLockSpot[ALL,-178.509720,-197.980011,577.937561]
		wait 300 ${Me.Distance[-178.509720,-197.980011,577.937561]}<3
		while ${Actor[fire spot](exists)}
		{
			;fire spot
			_FireSpot:Set[${Actor[fire spot].ID}]
			RIMUIObj:SetLockSpot[ALL,${Actor[id,${_FireSpot}].Loc},3]
			wait 300 ${Me.Distance[${Actor[id,${_FireSpot}].Loc}]}<4
			RI_Obj_CB:SetUISetting[SettingsFaceMobCheckBox,0]
			Actor[id,${_FireSpot}]:DoFace
			call PlaceHouseItem
			wait 10
			_Crate:Set[${Actor[Movable crate].ID}]
			Actor[id,${_Crate}]:DoubleClick
			wait 2
			Actor[id,${_Crate}]:DoubleClick
			wait 2
			Actor[id,${_Crate}]:DoubleClick
			RIMUIObj:SetLockSpot[ALL,-178.509720,-197.980011,577.937561]
			wait 300 ${Me.Distance[-178.509720,-197.980011,577.937561]}<3
			wait 10
		}
		RI_Obj_CB:SetUISetting[SettingsFaceMobCheckBox,1]
		RIMUIObj:SetLockSpot[ALL,-165.296997,-196.585724,577.642334]
		wait 300 ${Me.Distance[-165.296997,-196.585724,577.642334]}<3
	}
	if ${Me.Distance[-165.296997,-196.585724,577.642334]}>10
	{
		if ${Me.X}<-200 && ${Me.Z}<577
		{
	    	RIMUIObj:SetLockSpot[ALL,-203.984940,-197.948456,566.528870]
			wait 300 ${Me.Distance[-203.984940,-197.948456,566.528870]}<3
		}
		elseif ${Me.X}<-200 && ${Me.Z}>=577
		{
			RIMUIObj:SetLockSpot[ALL,-203.794281,-197.948563,588.886108]
			wait 300 ${Me.Distance[-203.794281,-197.948563,588.886108]}<3
		}
		RIMUIObj:SetLockSpot[ALL,-175.695923,-197.952805,577.874756]
		wait 300 ${Me.Distance[-175.695923,-197.952805,577.874756]}<3
		RIMUIObj:SetLockSpot[ALL,-165.296997,-196.585724,577.642334]
	}
}
function Tshakez()
{
	if !${RI_Var_Bool_GlobalOthers}
		RIMUIObj:SetLockSpot[ALL,78.210083,-197.952835,577.183167]
	else
		RIMUIObj:SetLockSpot[ALL,59.271576,-194.046982,577.577698]
	call CustomNamed "Venomess Tshakez-NMB-NLP" "0,0,0" NONE Shed shissar
}

function Yisith()
{
	call WaitForLastNamedChest START
	;echo before walkrun
	call ToggleWalkRun
	;echo before crouch
	;while !${Me.IsCrouching}
	;{
;		press ${RI_Var_String_CrouchKey}
	;	wait 5
	;}
	;echo after both
	call CustomNamed "Enforcer Yisith-INC-NMB" "-48.121853,-181.792099,558.575867" YisithCustom
	call WaitForLastNamedChest
	call ToggleWalkRun
}
function YisithCustom(int _NamedID)
{
	;237 Shadowmania || no makes oyu not be able to cure fear --> 330 Many-Armed Strike  || ${RIMUIObj.MainIconIDExists[${Me.ID},330]} )
	if ${RIMUIObj.MainIconIDExists[${Me.ID},237]} && ${Me.Noxious}==-1 
	{
		if ${Me.Inventory[Itraer Crys Rune].TimeUntilReady}>0
			noop
		else
		{
			RI_CMD_PauseCombatBots 1
			RIMUIObj:SetLockSpot[ALL,OFF]
			if ${Me.CastingSpell} && ${Me.GetGameData[Spells.Casting].Label.NotEqual[Acrylia Antibody Injection]}
				eq2ex cancel_spellcast
			Me.Inventory[Itraer Crys Rune]:Use
		}
	}
	elseif ${RIMUIObj.MainIconIDExists[${Me.ID},237]} && ${Me.Noxious}>-1
	{
		RI_CMD_PauseCombatBots 0
	}
	if ${RI_Var_Bool_GlobalOthers}
		return
	call RIObj.Target invader -Distance 30 zun -Distance 30 shadow -Distance 30 ${_NamedID}
	;add lockspots to index then query all actors named a toxic shadow puddle, 
	;then move to closest locspot that is more than 10 from every puddle
	variable index:string _Locs
	variable index:actor _ActorIndex
	EQ2:QueryActors[_ActorIndex, Name=="a toxic shadow puddle"]
	if ${_ActorIndex.Used}==0
		return
	_Locs:Insert["-48.167870,-179.786163,567.687012"]
	_Locs:Insert["-48.002644,-180.839050,563.750122"]
	_Locs:Insert["-47.944908,-181.751984,559.127197"]
	_Locs:Insert["-48.291546,-181.792526,555.133301"]
	_Locs:Insert["-48.069065,-181.800079,551.374390"]
	_Locs:Insert["-48.250965,-181.856628,547.104431"]
	_Locs:Insert["-48.305614,-181.856339,543.964294"]
	_Locs:Insert["-48.379936,-181.856659,540.623535"]
	_Locs:Insert["-48.053223,-181.856354,537.308167"]
	_Locs:Insert["-48.508999,-181.856644,533.625427"]
	_Locs:Insert["-48.267868,-181.856354,530.501587"]
	_Locs:Insert["-48.367867,-181.856659,527.012390"]
	_Locs:Insert["-48.273464,-181.838562,523.591370"]
	_Locs:Insert["-48.169537,-181.838577,517.719849"]

	call RIObj.AvoidActors _Locs _ActorIndex 5
}
;End Shar Vahl: Siege Break

;Start Echo Caverns: Zelmie Sortie

function Kwillix()
{
	call CustomNamed "Kwillix Quickshot-NMB" "720.953796,27.421082,-335.700775" NONE zoomie
}

function Steena()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["buzz everyone"]
	call CustomNamed "Steena Dragonflyer" "753.539795,11.639593,-517.853821" SteenaCustom
	IncomingText:Clear
}
function SteenaCustom(int _NamedID)
{
	call RIObj.Target soldier -Distance 30 ${_NamedID}
	if ${Trigger}
	{	
		Trigger:Set[0]
		variable int _cnt
		;echo TRIGGERED ${TriggerMessage}
		variable point3f PointSideMob
		while ${_cnt:Inc}<50
		{
			PointSideMob:Set[${Position.PointAtAngle[${_NamedID},1]}]
			wait 1
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${PointSideMob}]
			call RIObj.Target soldier -Distance 30 ${_NamedID}
		}
	}
}
function Frindel()
{
	call WaitForLastNamedChest START
	call CustomNamed "Frindel Sporemiser-NMB" "677.242432,17.904991,-439.928345" FrindelCustom
	call WaitForLastNamedChest
}

function FrindelCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	;Death Cap 53
	if ${RIMUIObj.MainIconIDExists[${_NamedID},53]}
	{
		RI_CMD_Assisting 0
		RI_Obj_CB:DoNotCastAE[TRUE]
		while ${RIMUIObj.MainIconIDExists[${_NamedID},53]}
		{
			if ${Actor[Query, Name=-"minishri" && Distance<=20](exists)}
				Actor[Query, Name=-"minishri" && Distance<=20]:DoTarget
			else
				Actor[${Me.ID}]:DoTarget
			wait 1
		}
		RI_CMD_Assisting 1
		RI_Obj_CB:DoNotCastAE[FALSE]
	}
	call RIObj.Target minishri -Distance 20 ${_NamedID}
	;add lockspots to index then query all actors named a toxic shadow puddle, 
	;then move to closest locspot that is more than 10 from every puddle
	variable index:string _Locs
	variable index:actor _ActorIndex
	EQ2:QueryActors[_ActorIndex, Name=="" && Overlay=="design_sinkhole_warning"]
	;echo ${Actor[Query, Name=="" && Overlay=="design_sinkhole_warning"]} // ${_ActorIndex.Used} // ${Actor[Query, Name=="" && TintFlags=2306]}
	if ${_ActorIndex.Used}==0
		return
	_Locs:Insert["676.129944,17.909481,-437.515015"]
	_Locs:Insert["683.142151,18.058496,-428.367035"]
	_Locs:Insert["690.195557,17.985287,-416.294220"]
	_Locs:Insert["676.257263,17.934042,-420.639465"]
	_Locs:Insert["667.761597,17.868635,-428.459778"]
	_Locs:Insert["662.145142,18.101076,-419.362427"]
	_Locs:Insert["672.855164,17.937147,-411.335144"]
	_Locs:Insert["664.310913,17.978106,-402.864868"]
	_Locs:Insert["652.764099,18.157434,-409.316101"]

	call RIObj.AvoidActors _Locs _ActorIndex 5
}

;End Echo Caverns: Zelmie Sortie

;Start Vasty Deep: Toil and Trouble

function Palovina()
{
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,12.045919,-14.997500,-37.702202]
	wait 300 ${Me.Distance[12.045919,-14.997500,-37.702202]}<5
	Actor[Palovina Vodlak]:DoTarget
	wait 300 ${Actor[Palovina Vodlak].Distance}<10
	call CustomNamed "Palovina Vodlak-NMB" "0.102117,-14.997500,-37.307487" PalovinaCustom
}
function PalovinaCustom(int _NamedID)
{
	call RIObj.Target "a Dreadfell lycan" -Distance 20 ${_NamedID}
	if ${RIMUIObj.MainIconIDExists[${Me.ID},268]}
	{
		;echo Transmogrify 268
		wait 20
		;have me move to the lockspot and the rest lockspot by 10. once cured, move nack to center
		;cooked/characters/ec/pc/ratman/scenes/optimize/ratman_lod0.skeleton  - Ratonga  10874
		;22.383829,-14.789917,-44.863308
		;cooked/characters/ap02/fungusman/scenes/fungusman_l0.skeleton  - Fungusman  8173
		;-22.271414,-14.797569,-30.102888
		;_exp03/cooked/characters/tool_users/satyr/scenes/satyr.skeleton   -Satyr 7038
		;22.348156,-14.793922,-30.154001
		;_exp04/cooked/characters/monsters/cocatrice/scenes/cocatrice.skeleton   -Cokatrice  7235
		;-7.393810,-14.787530,-45.115097
		;_exp02/cooked/characters/tool_users/hooluk_owl/scenes/hooluk_owl.skeleton   - Owl   6040
		;7.657083,-14.787773,-45.022964
		;  cooked/characters/ec/pc/humanmale/scenes/optimized/humanmale_lod0.skeleton - Humanoid  10021
		;-22.819118,-14.807521,-44.869820
		; cooked/characters/creatures/monsters/displacement_beast/scenes/displacer_beast.skeleton - Catbeast 11211
		;-7.487314,-14.775376,-29.983479
		; cooked/characters/ec/pc/humanmale/scenes/optimized/humanmale_lod0.skeleton -  Spikedman   11363
		;7.359355,-14.785847,-29.988363
		;echo ${Me.TintFlags}
		if ${Me.TintFlags}==10874
		{
			RIMUIObj:SetLockSpot[${Me.Name},22.383829,-14.789917,-44.863308,1,1000]
			relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,22.383829,-14.789917,-44.863308,20,1000]
		}  
		elseif ${Me.TintFlags}==8173
		{
			RIMUIObj:SetLockSpot[${Me.Name},-22.271414,-14.797569,-30.102888,1,1000]
			relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,-22.271414,-14.797569,-30.102888,20,1000]
		}  
		elseif ${Me.TintFlags}==7038
		{
			RIMUIObj:SetLockSpot[${Me.Name},22.348156,-14.793922,-30.154001,1,1000]
			relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,22.348156,-14.793922,-30.154001,20,1000]
		}  
		elseif ${Me.TintFlags}==7235
		{
			RIMUIObj:SetLockSpot[${Me.Name},-7.393810,-14.787530,-45.115097,1,1000]
			relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,-7.393810,-14.787530,-45.115097,20,1000]
		}  
		elseif ${Me.TintFlags}==6040
		{
			RIMUIObj:SetLockSpot[${Me.Name},7.657083,-14.787773,-45.022964,1,1000]
			relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,7.657083,-14.787773,-45.022964,20,1000]
		}  
		elseif ${Me.TintFlags}==10021
		{
			RIMUIObj:SetLockSpot[${Me.Name},-22.819118,-14.807521,-44.869820,1,1000]
			relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,-22.819118,-14.807521,-44.869820,20,1000]
		}  
		elseif ${Me.TintFlags}==11211
		{
			RIMUIObj:SetLockSpot[${Me.Name},-7.487314,-14.775376,-29.983479,1,1000]
			relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,-7.487314,-14.775376,-29.983479,20,1000]
		}  
		elseif ${Me.TintFlags}==11363
		{
			RIMUIObj:SetLockSpot[${Me.Name},7.359355,-14.785847,-29.988363,1,1000]
			relay "other ${RI_Var_String_RelayGroup}" RIMUIObj:SetLockSpot[ALL,7.359355,-14.785847,-29.988363,20,1000]
		} 
		while ${RIMUIObj.MainIconIDExists[${Me.ID},268]}
		{
			if ${Zone.Name.Find[Solo]}
				call CheckCures
			wait 1
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,0.102117,-14.997500,-37.307487]
		wait 20
		;relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[SCOUTS,OFF]
	}
	if ${Zone.Name.Find["[Solo]"](exists)}
	{
		;echo solo
		noop
	}
	else
	{
		;echo not solo
		noop
	}
}


;we are gonna have to modify this fight for heroic, we need to just run the circle aggroing the spiders and then pull them out of the circle
function Vulgrat()
{
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,0]
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["stops to gore everyone around it"]
	;declare RI_Var_VulgratSpidersSpawned index:string global
	declare RI_Var_VulgratClosestLoc int global 1
	;Event[EQ2_ActorSpawned]:AttachAtom[EQ2_ActorSpawnedVulgrat]
	call CustomNamed "Vulgrat Vilebones-NMB" "-0.159696,-14.997499,-178.487473" VulgratCustom
	;Event[EQ2_ActorSpawned]:DetachAtom[EQ2_ActorSpawnedVulgrat]
	;deletevariable RI_Var_VulgratSpidersSpawned
	deletevariable RI_Var_VulgratClosestLoc
	IncomingText:Clear
	eq2ex summon
	wait 2
	eq2ex summon
	;if at start position need to move to oposite position here so ri can pickup from there
	if ${Me.Distance[-0.159696,-14.997499,-178.487473]}<30
	{
		RIMUIObj:SetLockSpot[ALL,18.555691,-14.997500,-190.121185,1,1000]
		wait 300 ${Me.Distance[18.555691,-14.997500,-190.121185]}<3
		RIMUIObj:SetLockSpot[ALL,19.829639,-14.997500,-212.018967,1,1000]
		wait 300 ${Me.Distance[19.829639,-14.997500,-212.018967]}<3
		RIMUIObj:SetLockSpot[ALL,-0.267371,-14.997500,-240.915878,1,1000]
		wait 300 ${Me.Distance[-0.267371,-14.997500,-240.915878]}<3
		wait 300 ${RIMObj.AllGroupWithinRange[3]}
	}
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,1]
}
;atom EQ2_ActorSpawnedVulgrat(string ID, string Name)
;{
;	if ${Name.Find[vile vertebra](exists)}
;	{	
;		variable bool _AlreadyIn
;		variable int _i
;		for(_i:Set[1];${_i}<=${RI_Var_VulgratSpidersSpawned.Used};_i:Inc)
;		{
;			if ${RI_Var_VulgratSpidersSpawned.Get[${_i}].Equals["${Actor[id, ${ID}].Loc}"]}
;				_AlreadyIn:Set[1]
;		}
;		if !${_AlreadyIn}
;		{
;			echo SPAWNED: ${RI_Var_VulgratSpidersSpawned.Used} // ${Actor[id, ${ID}].Loc}
;			RI_Var_VulgratSpidersSpawned:Insert["${Actor[id, ${ID}].Loc}"]
;		}
;	}
;}
function VulgratCustom(int _NamedID)
{
	call RIObj.Target "vile vertebra" "fear blighter" -Distance 20 "a darkening horror" -Distance 20 "a wretched" -Distance 20 "a ghastly" -Distance 20 "a rotten scorn" -Distance 20 "a dreadfell wrench" -Distance 20 "a rotten scorn" -Distance 20 "a haunted ratrotter" -Distance 20 ${_NamedID}
	;Scavenge 927
	while ${RIMUIObj.MainIconIDExists[${Me.ID},927]} && ${Me.Effect[detrimental,${RIMUIObj.MainIconIDExists[${Me.ID},927]}].Duration}<3 && !${Trigger} && ${RIMUIObj.MainIconIDExists[${_NamedID},373]}==0
	{
		;wait 2
		;echo Triggered: ${Trigger} // ${Me.Distance[0.131838,-14.997500,-178.601791]}<5 // ${Me.Distance[0.195595,-14.997500,-156.028320]}<5 // ${Me.Distance[-0.001278,-14.997500,-224.450790]}<5 // ${Me.Distance[-0.007315,-14.997500,-249.148727]}<5
		if ${RI_Var_VulgratClosestLoc}==4
		{
			RIMUIObj:SetLockSpot[ALL,-0.007315,-14.997500,-249.148727]
		}
		else
		{
			RIMUIObj:SetLockSpot[ALL,0.195595,-14.997500,-156.028320]
		}
		wait 2 ${RIMUIObj.MainIconIDExists[${Me.ID},927]}==0
	}
	if ${Trigger}
	{
		wait 2
		;echo Triggered: ${Trigger} // ${Me.Distance[0.131838,-14.997500,-178.601791]}<5 // ${Me.Distance[0.195595,-14.997500,-156.028320]}<5 // ${Me.Distance[-0.001278,-14.997500,-224.450790]}<5 // ${Me.Distance[-0.007315,-14.997500,-249.148727]}<5
		;OppSide
		if ${RI_Var_VulgratClosestLoc}==4
		{
			if ${Actor[Query, Name=="vile vertebra" && IsDead=FALSE](exists)}
			{
				if ${Actor[id,${_NamedID}].Distance[-0.007315,-14.997500,-249.148727]}<10
				{
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,0.083742,-14.984611,-269.793365]
				}
				elseif ${Actor[id,${_NamedID}].Distance[0.083742,-14.984611,-269.793365]}<10
				{
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-0.007315,-14.997500,-249.148727]
				}
			}
			else
			{
				if ${Actor[id,${_NamedID}].Distance[-0.001278,-14.997500,-224.450790]}<10
				{
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-0.007315,-14.997500,-249.148727]
				}
				elseif ${Actor[id,${_NamedID}].Distance[-0.007315,-14.997500,-249.148727]}<10
				{
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-0.001278,-14.997500,-224.450790]
				}
			}
		}
		else
		{
			;MainSide
			;1 - 0.131838,-14.997500,-178.601791
			;2 - 0.195595,-14.997500,-156.028320
			;3 - 0.231001,-14.997499,-135.513977
			if ${Actor[Query, Name=="vile vertebra" && IsDead=FALSE](exists)}
			{
				if ${Actor[id,${_NamedID}].Distance[0.195595,-14.997500,-156.028320]}<10
				{
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,0.231001,-14.997499,-135.513977]
				}
				elseif ${Actor[id,${_NamedID}].Distance[0.231001,-14.997499,-135.513977]}<10
				{
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,0.195595,-14.997500,-156.028320]
				}
			}
			else
			{
				if ${Actor[id,${_NamedID}].Distance[0.131838,-14.997500,-178.601791]}<10
				{
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,0.195595,-14.997500,-156.028320]
				}
				elseif ${Actor[id,${_NamedID}].Distance[0.195595,-14.997500,-156.028320]}<10
				{
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,0.131838,-14.997500,-178.601791]
				}
			}
		}
		wait 40 ${RIMUIObj.MainIconIDExists[${_NamedID},373]}
		Trigger:Set[0]
	}
	if ${RIMUIObj.MainIconIDExists[${_NamedID},373]}
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,1]
			wait 10
			;373 - Bone Ballyhoo
			;first determine where vulgrat ported too
			;then determine which direction he is headed in
			;then move there and wait for the spider to spawn
			;do this through all of them then go out of circle (this lockspot will depend on which side we are on)
			;1 - 0.131838,-14.997500,-178.601791
			;2 - 18.555691,-14.997500,-190.121185 
			;3 - 19.829639,-14.997500,-212.018967 
			;4 - -0.001278,-14.997500,-224.450790  OPP
			;5 - -17.790739,-14.997500,-214.599457
			;6 - -21.077456,-14.997500,-192.231308
			variable index:string _Locs
			variable int _i
			variable int _f
			variable int _ClosestDistance
			variable bool _Inc
			
			_Locs:Insert["0.131838,-14.997500,-178.601791"]
			_Locs:Insert["18.555691,-14.997500,-190.121185"]
			_Locs:Insert["19.829639,-14.997500,-212.018967"]
			_Locs:Insert["-0.001278,-14.997500,-224.450790"]
			_Locs:Insert["-17.790739,-14.997500,-214.599457"] 
			_Locs:Insert["-21.077456,-14.997500,-192.231308"]
			_Locs:Insert["0.131838,-14.997500,-178.601791"]

			;first determine where vulgrat ported too
			_ClosestDistance:Set[10000000]
			for(_i:Set[1];${_i}<=${_Locs.Used};_i:Inc)
			{
				if ${Math.Distance[${_Locs.Get[${_i}]},${Actor[id, ${_NamedID}].Loc}]}<${_ClosestDistance}
				{
					_ClosestDistance:Set[${Math.Distance[${_Locs.Get[${_i}]},${Actor[id, ${_NamedID}].Loc}]}]
					relay ${RI_Var_String_RelayGroup} RI_Var_VulgratClosestLoc:Set[${_i}]
				}
			}
			;echo Determined Vulgrat is at ${RI_Var_VulgratClosestLoc}
			;then determine which direction he is headed in
			wait 10
			if ${RI_Var_VulgratClosestLoc}==4
			{
				;echo Vulgrat is at opp point
				if ${Math.Distance[-17.790739,-14.997500,-214.599457,${Actor[id, ${_NamedID}].Loc}]}<${Math.Distance[19.829639,-14.997500,-212.018967,${Actor[id, ${_NamedID}].Loc}]}
					_Inc:Set[1]
				else
					_Inc:Set[0]
				
				;echo Vulgrat is at opp point: INC: ${_Inc}

				if ${Me.Distance[-0.001278,-14.997500,-224.450790]}>10 && ${_Inc}
				{
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,22.987736,-14.997499,-202.185257,1,1000]
					wait 300 ${Me.Distance[22.987736,-14.997499,-202.185257]}<3 && ${RIMObj.AllGroupWithinRange[3]}
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-0.001278,-14.997500,-224.450790,1,1000]
					wait 300 ${Me.Distance[-0.001278,-14.997500,-224.450790]}<3 && ${RIMObj.AllGroupWithinRange[3]}
				}
				elseif ${Me.Distance[-0.001278,-14.997500,-224.450790]}>10 && !${_Inc}
				{
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-22.987736,-14.997499,-202.185257,1,1000]
					wait 300 ${Me.Distance[-22.987736,-14.997499,-202.185257]}<3 && ${RIMObj.AllGroupWithinRange[3]}
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-0.001278,-14.997500,-224.450790,1,1000]
					wait 300 ${Me.Distance[-0.001278,-14.997500,-224.450790]}<3 && ${RIMObj.AllGroupWithinRange[3]}
				}
				;echo after opp move
				_Locs:Clear
				_Locs:Insert["-0.001278,-14.997500,-224.450790"]
				_Locs:Insert["-17.790739,-14.997500,-214.599457"] 
				_Locs:Insert["-21.077456,-14.997500,-192.231308"]
				_Locs:Insert["0.131838,-14.997500,-178.601791"]
				_Locs:Insert["18.555691,-14.997500,-190.121185"]
				_Locs:Insert["19.829639,-14.997500,-212.018967"]
				_Locs:Insert["-0.001278,-14.997500,-224.450790"]
				;echo after opp locs insert
			}
			else
			{
				if ${Math.Distance[18.555691,-14.997500,-190.121185,${Actor[id, ${_NamedID}].Loc}]}<${Math.Distance[-21.077456,-14.997500,-192.231308,${Actor[id, ${_NamedID}].Loc}]}
					_Inc:Set[1]
				else
					_Inc:Set[0]

				if ${Me.Distance[0.131838,-14.997500,-178.601791]}>10
				{
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,19.829639,-14.997500,-212.018967,1,1000]
					wait 300 ${Me.Distance[19.829639,-14.997500,-212.018967]}<3 && ${RIMObj.AllGroupWithinRange[3]}
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,18.555691,-14.997500,-190.121185,1,1000]
					wait 300 ${Me.Distance[18.555691,-14.997500,-190.121185]}<3 && ${RIMObj.AllGroupWithinRange[3]}
				}

				;echo Vulgrat is at main point: INC: ${_Inc}
			}
			;echo now time to move around circle
			;then move there and wait for the spider to spawn (probably gonna have to wait for actorspawn) or the MID to go away
			;do this through all of them
			if ${_Inc}
			{
				wait 300 ${Actor[Query, Name=="vile vertebra"](exists)}
				for(_i:Set[1];${_i}<=7;_i:Inc)
				{
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Locs.Get[${_i}]},1,1000]
					wait 300 ${Me.Distance[${_Locs.Get[${_i}]}]}<3 && ${RIMObj.AllGroupWithinRange[3]}
					Actor[Query, Name=="vile vertebra" && Distance<25 && IsDead=FALSE]:DoTarget
					;echo waiting until spawn: ${RI_Var_VulgratSpidersSpawned.Used} // ${_i}
					;if ${_i}<7 && ${_i}>1 && !${Zone.Name.Find["[Solo]"](exists)}
					;{
					;	while ${RI_Var_VulgratSpidersSpawned.Used}<${_i} && ${RIMUIObj.MainIconIDExists[${_NamedID},373]}>0
					;	{
					;		Actor[Query, Name=="vile vertebra" && Distance<25 && IsDead=FALSE]:DoTarget
					;		waitframe
					;	}
					;	;echo spawned
					;}
					if ${_i}<7
					{
						while ${Actor[id, ${_NamedID}].Distance[${_Locs.Get[${Math.Calc[${_i}+1]}]}]}<10 && ${RIMUIObj.MainIconIDExists[${_NamedID},373]}>0
							wait 1
					}
				}
			}
			else
			{
				wait 300 ${Actor[Query, Name=="vile vertebra"](exists)}
				_f:Set[1]
				for(_i:Set[7];${_i}>=1;_i:Dec)
				{
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Locs.Get[${_i}]},1,1000]
					wait 300 ${Me.Distance[${_Locs.Get[${_i}]}]}<3 && ${RIMObj.AllGroupWithinRange[3]}
					Actor[Query, Name=="vile vertebra" && Distance<25 && IsDead=FALSE]:DoTarget
					;if ${_i}>2 && ${_i}<7 && !${Zone.Name.Find["[Solo]"](exists)}
					;{
				    ;	echo waiting until spawn: ${RI_Var_VulgratSpidersSpawned.Used} // ${_f}
					;	while ${RI_Var_VulgratSpidersSpawned.Used}<${_f} && ${RIMUIObj.MainIconIDExists[${_NamedID},373]}>0
					;	{
					;		Actor[Query, Name=="vile vertebra" && Distance<25 && IsDead=FALSE]:DoTarget
					;		waitframe
					;	}
					;	;echo spawned
					;}
					;RI_Var_VulgratSpiderSpawned:Clear
					_f:Inc
					if ${_i}>1
					{
						while ${Actor[id, ${_NamedID}].Distance[${_Locs.Get[${Math.Calc[${_i}-1]}]}]}<10 && ${RIMUIObj.MainIconIDExists[${_NamedID},373]}>0
							wait 1
					}
				}
			}
			;echo Done with moving
			if ${RI_Var_VulgratClosestLoc}==4
			{
				if ${Zone.Name.Find[Solo](exists)}
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-0.001278,-14.997500,-224.450790,1,1000]
				elseif ${Actor[Query, Name=="vile vertebra" && IsDead=FALSE](exists)}
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-0.007315,-14.997500,-249.148727,1,1000]	
				else
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-0.001278,-14.997500,-224.450790,1,1000]
			}
			else
			{
				if ${Zone.Name.Find[Solo](exists)}
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-0.159696,-14.997499,-178.487473,1,1000]
				elseif ${Actor[Query, Name=="vile vertebra" && IsDead=FALSE](exists)}
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,0.195595,-14.997500,-156.028320,1,1000]
				else
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-0.159696,-14.997499,-178.487473,1,1000]
			}
			wait 50
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,0]
			Actor[vile vertebra]:DoTarget
			wait 300 ${RIMUIObj.MainIconIDExists[${_NamedID},373]}==0
			;wait 300 ${Trigger}
			;Trigger:Set[0]
			RI_Var_VulgratSpidersSpawned:Clear
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,0]
		}
		else
		{
			while ${RIMUIObj.MainIconIDExists[${_NamedID},373]}>0
			{
				wait 2
			}
		}
	}
	if ${RI_Var_VulgratClosestLoc}==4 && !${Me.Arcane}
	{
		if ${Zone.Name.Find[Solo](exists)}
			RIMUIObj:SetLockSpot[ALL,-0.001278,-14.997500,-224.450790,1,1000]
		elseif ${Actor[Query, Name=="vile vertebra" && IsDead=FALSE](exists)}
			RIMUIObj:SetLockSpot[ALL,-0.007315,-14.997500,-249.148727,1,1000]	
		else
			RIMUIObj:SetLockSpot[ALL,-0.001278,-14.997500,-224.450790,1,1000]
	}
	elseif !${Me.Arcane}
	{
		if ${Zone.Name.Find[Solo](exists)}
			RIMUIObj:SetLockSpot[ALL,-0.159696,-14.997499,-178.487473,1,1000]
		elseif ${Actor[Query, Name=="vile vertebra" && IsDead=FALSE](exists)}
			RIMUIObj:SetLockSpot[ALL,0.195595,-14.997500,-156.028320,1,1000]
		else
			RIMUIObj:SetLockSpot[ALL,-0.159696,-14.997499,-178.487473,1,1000]
	}
}
	;for heroic 2
	;2nd boss- cure trauma only, do not cure arcane(heals)
;get behind
;joust bone gore, has pre-message in chat
;everyone needs to, 5% heal any fails, so priority- cures can be on for this fight
;75/50/25 boss goes immune
;have group get off center circle, stand about 15m away from it, have bard go pull adds around center, be smart about pathing, as often they can get stuck on center area
;boss spawns little spider adds every 10 seconds, 20m apart, around entire ring
;if you can focus an add down before next add comes up, boss comes out of immune phase(very hard in VD2)
;most groups just kill all the adds, then return to center ring, boss is immune to damage when out of center
;rinse, repeat
;if a player goes in front of boss while in immune phase, they get a trauma det that hurts, cure fast, if on bard, cure with pot or run back with speed right away
function FrancineCustomEnd()
{
	if ${Me.Distance[-33.286285,-14.997499,-412.322754]}<30 || ${Me.Distance[-18.770828,-14.997500,-423.970734]}<30
	{
		RIMUIObj:SetLockSpot[ALL,-15.684020,-14.997500,-420.071350,1,1000]
		wait 300 ${Me.Distance[-15.684020,-14.997500,-420.071350]}<3
		RIMUIObj:SetLockSpot[ALL,-6.767591,-14.997500,-400.783142,1,1000]
		wait 300 ${Me.Distance[-6.767591,-14.997500,-400.783142]}<3
	}
	elseif ${Me.Distance[-21.643415,-14.997500,-356.095886]}<30
	{
		RIMUIObj:SetLockSpot[ALL,-30.060055,-14.997500,-373.440430,1,1000]
		wait 300 ${Me.Distance[-30.060055,-14.997500,-373.4404303]}<3
		RIMUIObj:SetLockSpot[ALL,-9.055240,-14.997500,-385.647339,1,1000]
		wait 300 ${Me.Distance[-9.055240,-14.997500,-385.647339]}<3
	}
	elseif ${Me.Distance[33.194210,-14.997500,-368.057526]}<30
	{
		RIMUIObj:SetLockSpot[ALL,13.233263,-14.997499,-358.704285,1,1000]
		wait 300 ${Me.Distance[13.233263,-14.997499,-358.704285]}<3
		RIMUIObj:SetLockSpot[ALL,5.213544,-14.997500,-375.322205,1,1000]
		wait 300 ${Me.Distance[5.213544,-14.997500,-375.322205]}<3
	}
	elseif ${Me.Distance[22.252705,-14.997500,-422.251862]}<30
	{
		RIMUIObj:SetLockSpot[ALL,31.121338,-14.997499,-406.405334,1,1000]
		wait 300 ${Me.Distance[31.121338,-14.997499,-406.405334]}<3
		RIMUIObj:SetLockSpot[ALL,13.706396,-14.997500,-400.694977,1,1000]
		wait 300 ${Me.Distance[13.706396,-14.997500,-400.694977]}<3
		RIMUIObj:SetLockSpot[ALL,-3.368738,-14.997499,-398.260925,1,1000]
		wait 300 ${Me.Distance[-3.368738,-14.997499,-398.260925]}<3
	}
	wait 300 ${RIMObj.AllGroupWithinRange[3]}
}
function Francine()
{
	if ${Zone.Name.Find["[Heroic II]"]}
	{
		IncomingText:Clear
		IncomingText:Insert["cadaverous"]
		IncomingText:Insert["concoction"]
		AbilityToInterrupt:Set[Cadaverous Concoction]
		if !${RI_Var_Bool_GlobalOthers}
			call MessageBox "Do this fight. I will handle interrupting and targeting. you handle clicking the cauldron and following the correct hag and placing the cauldron. press ok when ready to start then engage named" 0
		echo Starting Wretched Francine @ ${Time}
		while ${Actor[Wretched Francine](exists)} || ${Me.InCombatMode}
		{
			if ${Trigger}
			{
				TimedCommand 40 Script[${RI_Var_String_RunInstancesScriptName}].Variable[Trigger]:Set[FALSE]
				call RIObj.Target "Wretched Francine"
			}
			else
				call RIObj.Target "a reef familiar" -Distance 20 "lost" -Distance 20 "Wretched Francine"
			;echo loop: ${AbilityToInterrupt}
			if ${Me.GetGameData[Target.Casting].Label.Equal["${AbilityToInterrupt}"]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal["${AbilityToInterrupt}"]}
			{
				;if ${RI_Var_Bool_Debug}
					;echo ${Time}: Detected interrupt ability: ${AbilityToInterrupt} casting 
				call SetInterruptSpell
				call Interrupt
			}
			wait 1
		}
		echo Ending Wretched Francine @ ${Time}
		return
	}
	IncomingText:Clear
	IncomingText:Insert["Thrice I appear"]
	call CustomNamed "Wretched Francine-NMB-INC" "-33.286285,-14.997499,-412.322754" FrancineCustom
	IncomingText:Clear
}
function FrancineCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	call RIObj.Target "a reef familiar" -Distance 20 ${_NamedID}
	if !${Actor[id,${_NamedID}].IsAggro} || ${Trigger}
	{
		Trigger:Set[0]
		wait 50 !${Actor[id,${_NamedID}](exists)}
		wait 50
		variable index:string _Locs
		variable int _i
		if ${Me.Distance[-33.286285,-14.997499,-412.322754]}<30
		{
			if !${RI_Var_Bool_GlobalOthers}
				Actor[movable cauldron]:DoubleClick
			wait 2
			if !${RI_Var_Bool_GlobalOthers}
				Actor[movable cauldron]:DoubleClick
			wait 2
			if !${RI_Var_Bool_GlobalOthers}
				Actor[movable cauldron]:DoubleClick
			_Locs:Insert["-15.513475,-14.997499,-420.176453"]
			_Locs:Insert["-5.945165,-14.997500,-398.156494"]
			_Locs:Insert["-31.485420,-14.997499,-367.917358"]
			_Locs:Insert["-25.021708,-14.997499,-356.674652"]
			for(_i:Set[1];${_i}<=${_Locs.Used};_i:Inc)
			{
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Locs.Get[${_i}]},1,1000]
				wait 300 ${Me.Distance[${_Locs.Get[${_i}]}]}<2
			}
			;echo 215
			if !${RI_Var_Bool_GlobalOthers}
				RI_Obj_CB:SetUISetting[SettingsFaceMobCheckBox,0]
			if !${RI_Var_Bool_GlobalOthers}
				call PlaceHouseItem 215
			wait 2
			Actor[movable cauldron]:DoubleClick
			Face 0
			wait 2
			if !${RI_Var_Bool_GlobalOthers}		
				call PlaceHouseItem 215
			if !${RI_Var_Bool_GlobalOthers}
				RI_Obj_CB:SetUISetting[SettingsFaceMobCheckBox,1]
			wait 300 ${Actor[id,${_NamedID}](exists)}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-19.220995,-14.997500,-357.751770]
			wait 300 ${Me.Distance[-19.220995,-14.997500,-357.751770]}<3
			wait 300 ${RIMObj.AllGroupWithinRange[3]}
			wait 300 !${Actor[a reef familiar](exists)}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-21.643415,-14.997500,-356.095886]
			wait 20
		}
		else
		{
			if !${RI_Var_Bool_GlobalOthers}
				Actor[movable cauldron]:DoubleClick
			wait 2
			if !${RI_Var_Bool_GlobalOthers}
				Actor[movable cauldron]:DoubleClick
			wait 2
			if !${RI_Var_Bool_GlobalOthers}
				Actor[movable cauldron]:DoubleClick
			
			_Locs:Insert["-28.677296,-14.997500,-373.601044"]
			_Locs:Insert["-7.574728,-14.997500,-391.337463"]
			_Locs:Insert["-14.790520,-14.997499,-421.679108"]
			_Locs:Insert["-32.418190,-14.997499,-415.637329"]

			for(_i:Set[1];${_i}<=${_Locs.Used};_i:Inc)
			{
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Locs.Get[${_i}]},1,1000]
				wait 300 ${Me.Distance[${_Locs.Get[${_i}]}]}<3
			}
			;echo 125
			if !${RI_Var_Bool_GlobalOthers}
				RI_Obj_CB:SetUISetting[SettingsFaceMobCheckBox,0]
			if !${RI_Var_Bool_GlobalOthers}
				call PlaceHouseItem 125
			wait 2
			Actor[movable cauldron]:DoubleClick
			Face 0
			wait 2
			if !${RI_Var_Bool_GlobalOthers}
				call PlaceHouseItem 125
			if !${RI_Var_Bool_GlobalOthers}
				RI_Obj_CB:SetUISetting[SettingsFaceMobCheckBox,1]
			wait 300 ${Actor[id,${_NamedID}](exists)}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-31.705996,-14.997500,-409.313812]
			wait 300 ${Me.Distance[-31.705996,-14.997500,-409.313812]}<3
			wait 300 ${RIMObj.AllGroupWithinRange[3]}
			wait 300 !${Actor[a reef familiar](exists)}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-33.714298,-14.997500,-411.887604]
			wait 50
		}
	}
}
;Wretched Francine
;movable cauldron
;${Actor[francine].IsAggro}
;-33.286285,-14.997499,-412.322754 / -33.286285 -14.997499 -412.322754 / -33.286285 -412.322754 / 23:28:34: guardian
;3rd boss- cures can be on for this fight
;Clear adds around circular room, alcoves have easy to kill adds, do not go in room with boss in it till all adds(or most) are clear
;there are a lot of tables/chairs in the way, be smart about pathing
;Witch boss has 75/50/25 phases as well
;casted heal by boss, something concoction, plenty of time to interrupt, and dispellable if missed
;set all chars to interrupt on cast
;then set mages to dispel after cast
;at 75/50/25, boss goes immune, jumps in cauldron, then takes off with 2 similar immune bosses
;the one with the hat is the real boss
;cauldron becomes able to pick up, take cauldron to correct alcove and place in spot
;you die if you fail this in VD2
;rinse repeat until dead
;recommend forcing camera directly above character grabbing cauldron, and moving to a correct spot, then moving mouse to a correct spot, then dropping


function Viktor()
{
	RI_Obj_CB:DoNotCastAE[TRUE]
	IncomingText:Clear
	IncomingText:Insert["to bypass its defenses"]
	call CustomNamed "Viktor Vodlak" "-152.600494,-59.997501,-290.202454" ViktorCustom
	RIMUIObj:SetLockSpot[${Me.Name},-145.091141,-14.997507,-244.248505]
	wait 300 ${Me.Distance[-145.091141,-14.997507,-244.248505]}<3
	RIMUIObj:SetLockSpot[${Me.Name},-146.794006,-15.007621,-254.136566]
	wait 300 ${Me.Distance[-146.794006,-15.007621,-254.136566]}<3
	RIMUIObj:SetLockSpot[${Me.Name},-141.943039,-15.171372,-263.103943]
	wait 300 ${Me.Distance[-141.943039,-15.171372,-263.103943]}<3
	RIMUIObj:SetLockSpot[${Me.Name},-132.263992,-14.997499,-266.317902]
	wait 300 ${Me.Distance[-132.263992,-14.997499,-266.317902]}<3
	RIMUIObj:SetLockSpot[${Me.Name},-122.428185,-14.997500,-268.910797]
	wait 300 ${Me.Distance[-122.428185,-14.997500,-268.910797]}<3
	RIMUIObj:SetLockSpot[${Me.Name},-112.514420,-14.997500,-270.532959]
	wait 300 ${Me.Distance[-112.514420,-14.997500,-270.532959]}<3
	RIMUIObj:SetLockSpot[${Me.Name},-109.463722,-14.991604,-270.370331]
	wait 20
	wait 300 ${Me.Distance[-109.463722,-14.991604,-270.370331]}<3
	RIMUIObj:SetLockSpot[${Me.Name},-109.463722,-14.991604,-270.370331]
	wait 300 ${Me.Distance[-109.463722,-14.991604,-270.370331]}<3
	wait 50
	call RIMObj.CheckCombat 0
	RIMUIObj:SetLockSpot[OFF]
	wait 2
	Actor["boss 4 library portal static"]:DoubleClick
	wait 2
	Actor["boss 4 library portal static"]:DoubleClick
	wait 2
	Actor["boss 4 library portal static"]:DoubleClick
	wait 300 ${RIMObj.AllGroupWithinRange[10]}
	RI_Obj_CB:DoNotCastAE[FALSE]
}
function ViktorCustom(int _NamedID)
{
	;Archaic Disruption 22
	call RIObj.Dispell ${Actor[an experimental].ID} 22 1
	call RIObj.Dispell ${_NamedID} 22 1

	if ${Actor[an experimental](exists)}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-158.431961,-59.997501,-363.081329]
		if !${Trigger}
		{
			RI_CMD_PauseCombatBots 1
			Actor[an experimental]:DoTarget
			eq2ex cancel_spellcast
			Me.Ability[id,738679878]:Use
			wait 2
		}
		else
		{
			RI_CMD_PauseCombatBots 0
			call RIObj.Target "an experimental"
		}
	}

	elseif !${Actor["boss 4 library portal spawned"](exists)} && ${Math.Distance[${Me.Y},-60]}<5
	{
		Trigger:Set[0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-152.600494,-59.997501,-290.202454]
		call RIObj.Target "Study on Proximity Translocation" -Distance 20 ${_NamedID}
	}
	if ${Actor["boss 4 library portal spawned"](exists)} && ${Math.Distance[${Me.Y},-60]}<5
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor["boss 4 library portal spawned"].Loc},1,1000]
		wait 300 ${Me.Distance[${Actor["boss 4 library portal spawned"].Loc}]}<3
		wait 300 ${RIMObj.AllGroupWithinRange[3]}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,OFF]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetRIFollow[OFF]
		
		while ${Math.Distance[${Me.Y},-60]}<5 || !${RIMObj.AllGroupWithinRange[5]}
		{
			relay ${RI_Var_String_RelayGroup} Actor["boss 4 library portal spawned"]:DoubleClick
			waitframe
		}
		
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-133.124741,-14.997507,-248.055954]
	}
}
;need to add a check whie in the golem stage for all group health if anyone under 70 stop and let the healers do their thing, also turn on cures while in water stage
function Nogrovska()
{
	IncomingText:Clear
	IncomingText:Insert["You begin to boil and bubble"]
	IncomingText:Insert["to nurse with your Cure Curse"]
	if ${Zone.Name.Find["[Heroic II]"]}
	{
		RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,0]
		RI_CMD_AbilityEnableDisable "Cure Curse" 0
	}
	declare RI_Nogrovska_CycloneID int global 0
	wait 300 ${Actor[Nogrovska Vodlak](exists)}
	call NogrovskaMove 1
	wait 20
	call CustomNamed "Nogrovska Vodlak-NMB" "0,0,0" NogrovskaCustom
	;after the fight move back to spot 1
	eq2ex summon
	wait 2 
	eq2ex summon
	wait 2
	if !${RI_Var_Bool_SkipLoot}
		call RIMObj.LootChest
	wait 2
	call NogrovskaMove 3
	call NogrovskaMove 2
	deletevariable RI_Nogrovska_CycloneID
	if ${Zone.Name.Find["[Heroic II]"]}
	{
		RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,1]
		RI_CMD_AbilityEnableDisable "Cure Curse" 1
	}
}
function NogrovskaCurse()
{
	RIMUIObj:SetLockSpot[ALL,OFF]
	if ${Trigger} && ${TriggerMessage.Find["to nurse with your Cure Curse"]}
	{
		;echo grave reminder: ${Me.Effect[detrimental,${RIMUIObj.MainIconIDExists[${Me.ID},452]}].CurrentIncrements}
		wait 5
		if ${TriggerMessage.Find[first]} && ${Me.Effect[detrimental,${RIMUIObj.MainIconIDExists[${Me.ID},452]}].CurrentIncrements}==1
		{
			if ${Me.Archetype.Equal[priest]} && ${Me.Ability[id,969542071].IsReady}
			{
				while ${Me.Cursed}
				{
					RI_CMD_CastOn "Cure Curse" ${Me.Name} 1
					wait 1
				}
			}
			else
			{
				while ${Me.Cursed}
				{
					relay ${RI_Var_String_RelayGroup} relay ${RI_Var_String_RelayGroup} RI_CMD_CastOn "Cure Curse" ${Me.Name} 1
					wait 1
				}
			}
		}
		elseif ${TriggerMessage.Find[second]} && ${Me.Effect[detrimental,${RIMUIObj.MainIconIDExists[${Me.ID},452]}].CurrentIncrements}==2
		{
			if ${Me.Archetype.Equal[priest]} && ${Me.Ability[id,969542071].IsReady}
			{
				while ${Me.Cursed}
				{
					RI_CMD_CastOn "Cure Curse" ${Me.Name} 1
					wait 1
				}
			}
			else
			{
				while ${Me.Cursed}
				{
					relay ${RI_Var_String_RelayGroup} relay ${RI_Var_String_RelayGroup} RI_CMD_CastOn "Cure Curse" ${Me.Name} 1
					wait 1
				}
			}
		}
		elseif ${TriggerMessage.Find[third]} && ${Me.Effect[detrimental,${RIMUIObj.MainIconIDExists[${Me.ID},452]}].CurrentIncrements}==3
		{
			if ${Me.Archetype.Equal[priest]} && ${Me.Ability[id,969542071].IsReady}
			{
				while ${Me.Cursed}
				{
					RI_CMD_CastOn "Cure Curse" ${Me.Name} 1
					wait 1
				}
			}
			else
			{
				while ${Me.Cursed}
				{
					relay ${RI_Var_String_RelayGroup} relay ${RI_Var_String_RelayGroup} RI_CMD_CastOn "Cure Curse" ${Me.Name} 1
					wait 1
				}
			}
		}
		elseif ${TriggerMessage.Find[fourth]} && ${Me.Effect[detrimental,${RIMUIObj.MainIconIDExists[${Me.ID},452]}].CurrentIncrements}==4
		{
			if ${Me.Archetype.Equal[priest]} && ${Me.Ability[id,969542071].IsReady}
			{
				while ${Me.Cursed}
				{
					RI_CMD_CastOn "Cure Curse" ${Me.Name} 1
					wait 1
				}
			}
			else
			{
				while ${Me.Cursed}
				{
					relay ${RI_Var_String_RelayGroup} relay ${RI_Var_String_RelayGroup} RI_CMD_CastOn "Cure Curse" ${Me.Name} 1
					wait 1
				}
			}
		}
		elseif ${TriggerMessage.Find[fifth]} && ${Me.Effect[detrimental,${RIMUIObj.MainIconIDExists[${Me.ID},452]}].CurrentIncrements}==5
		{
			if ${Me.Archetype.Equal[priest]} && ${Me.Ability[id,969542071].IsReady}
			{
				while ${Me.Cursed}
				{
					RI_CMD_CastOn "Cure Curse" ${Me.Name} 1
					wait 1
				}
			}
			else
			{
				while ${Me.Cursed}
				{
					relay ${RI_Var_String_RelayGroup} relay ${RI_Var_String_RelayGroup} RI_CMD_CastOn "Cure Curse" ${Me.Name} 1
					wait 1
				}
			}
		}
		elseif ${TriggerMessage.Find[sixth]} && ${Me.Effect[detrimental,${RIMUIObj.MainIconIDExists[${Me.ID},452]}].CurrentIncrements}==6
		{
			if ${Me.Archetype.Equal[priest]} && ${Me.Ability[id,969542071].IsReady}
			{
				while ${Me.Cursed}
				{
					RI_CMD_CastOn "Cure Curse" ${Me.Name} 1
					wait 1
				}
			}
			else
			{
				while ${Me.Cursed}
				{
					relay ${RI_Var_String_RelayGroup} relay ${RI_Var_String_RelayGroup} RI_CMD_CastOn "Cure Curse" ${Me.Name} 1
					wait 1
				}
			}
		}
		Trigger:Set[0]
	}
}
function NogrovskaCustom(int _NamedID)
{
	;echo custom
	;Blood Surge 496
	;Mind Surge 602
	if ${RIMUIObj.MainIconIDExists[${Me.ID},496]} || ${RIMUIObj.MainIconIDExists[${Me.ID},602]}
	{
		while ${Me.Elemental}>0
		{
			;echo while
			relay ${RI_Var_String_RelayGroup} RI_CMD_CastOn Cure ${Me.Name} 1
			wait 2
		}
	}
	;Grave Reminder 452
	if ${Trigger}
	{
		;echo trigger: ${TriggerMessage}
		;grave reminder
		if ${TriggerMessage.Find["to nurse with your Cure Curse"]}
		{
			call NogrovskaCurse
		}
		if ${TriggerMessage.Find["You begin to boil and bubble"]}
		{
			;echo boil and bubble
			if ${TriggerMessage.Find[water]}
			{
				;echo water
				if ${Me.Distance[-0.236990,-47.527943,-237.152908]}<10
				{
					RIMUIObj:SetLockSpot[${Me.Name},0.131003,-49.997505,-243.592285]
					wait 300 ${Me.Distance[0.131003,-49.997505,-243.592285]}<2
				}
				if ${Me.Distance[34.545944,-47.563663,-202.617310]}<10
				{
					RIMUIObj:SetLockSpot[${Me.Name},43.333908,-49.997509,-202.385681]
					wait 300 ${Me.Distance[43.333908,-49.997509,-202.385681]}<2
				}
				if ${Me.Distance[-0.006720,-47.563663,-167.899933]}<10
				{
					RIMUIObj:SetLockSpot[${Me.Name},0.212977,-49.997505,-160.969452]
					wait 300 ${Me.Distance[0.212977,-49.997505,-160.969452]}<2
				}
				if ${Me.Distance[-34.474503,-47.563660,-202.300430]}<10
				{
					RIMUIObj:SetLockSpot[${Me.Name},-43.440025,-49.997505,-202.658066]
					wait 300 ${Me.Distance[-43.440025,-49.997505,-202.658066]}<2
				}
				wait 50 ${Me.Noxious}>0
				wait 10
				while ${Me.Noxious}>0
				{
					;echo while
					relay ${RI_Var_String_RelayGroup} RI_CMD_CastOn Cure ${Me.Name} 1
					wait 2
				}
				if ${Me.Distance[0.131003,-49.997505,-243.592285]}<5
				{
					RIMUIObj:SetLockSpot[${Me.Name},-0.236990,-47.527943,-237.152908]
					wait 300 ${Me.Distance[-0.236990,-47.527943,-237.152908]}<2
				}
				if ${Me.Distance[41.333908,-49.997509,-202.385681]}<5
				{
					RIMUIObj:SetLockSpot[${Me.Name},34.545944,-47.563663,-202.617310]
					wait 300 ${Me.Distance[34.545944,-47.563663,-202.617310]}<2
				}
				if ${Me.Distance[0.212977,-49.997505,-160.969452]}<5
				{
					RIMUIObj:SetLockSpot[${Me.Name},-0.006720,-47.563663,-167.899933]
					wait 300 ${Me.Distance[-0.006720,-47.563663,-167.899933]}<2
				}
				if ${Me.Distance[-41.440025,-49.997505,-202.658066]}<5
				{
					RIMUIObj:SetLockSpot[${Me.Name},-34.474503,-47.563660,-202.300430]
					wait 300 ${Me.Distance[-34.474503,-47.563660,-202.300430]}<2
				}
				Trigger:Set[0]
			}
			else
			{
				;echo land
				wait 50 ${Me.Noxious}>0
				while ${Me.Noxious}>0
				{
					;echo while
					relay ${RI_Var_String_RelayGroup} RI_CMD_CastOn Cure ${Me.Name} 1
					wait 2
				}
			}
			Trigger:Set[0]
		}
	}
	variable string _Charge
	variable string _Cyclone
	
	;echo ${_Charge}
	if ${RIMUIObj.MainIconIDExists[${_NamedID},161]}
	{
		wait 300 !${Actor[id,${_NamedID}].Guild.Find[Dreadfell Dark Priestess]}
		if ${Actor[id,${_NamedID}].Guild.Find[Positive]}
		{
			_Charge:Set[Negative]
			_Cyclone:Set[electrons]
		}
		else
		{
			_Charge:Set[Positive]
			_Cyclone:Set[protons]
		}
		while !${Actor[Query, Name=-"a galvanic golem" && Distance<15](exists)}
		{
			call NogrovskaCurse
			wait 5
		}
		; && !${Actor[golem].Guild.Find["${_Charge}"]}
		;Magnetic Maleficium 161
		if ${Actor[golem].Guild.Find["${_Charge}"]}
		{
			call NogrovskaMove 3
			wait 20
			RI_Nogrovska_CycloneID:Set[0]
			call RIObj.Target "a galvanic golem"
		}
		elseif ${RI_Nogrovska_CycloneID}==0
		{
			if ${Zone.Name.Find["[Solo]"]}
			{
				noop
			}
			else
			{
				if !${RI_Var_Bool_GlobalOthers}
					relay ${RI_Var_String_RelayGroup} RIMUIObj:PreHeal[ALL,${Me.Name}]
				wait 50
			}
			call NogrovskaMove 0 "${_Charge}" "${_Cyclone}"
		}
		elseif !${Actor[golem].Guild.Find["${_Charge}"]}
		{
			;RIMUIObj:SetLockSpot[ALL,${Actor[id,${RI_Nogrovska_CycloneID}].Loc},1,1000]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${RIMUIObj.3rdPointLine[${Actor[a galvanic golem].X},${Actor[a galvanic golem].Z},${Actor[id,${RI_Nogrovska_CycloneID}].X},${Actor[id,${RI_Nogrovska_CycloneID}].Z},5].Token[1,"\,"]},${Me.Y},${RIMUIObj.3rdPointLine[${Actor[a galvanic golem].X},${Actor[a galvanic golem].Z},${Actor[id,${RI_Nogrovska_CycloneID}].X},${Actor[id,${RI_Nogrovska_CycloneID}].Z},5].Token[2,"\,"]}]
		}
		wait 5

	}
	else
		call RIObj.Target ${_NamedID}
}
function NogrovskaMove(int _Stage=0, string _Charge, string _Cyclone)
{
	if ${Zone.Name.Find["[Heroic II]"]}
	{
		RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,1]
	}
		;echo Cyclone: ${_Cyclone}
		;echo Charge: ${_Charge}
		;echo nogrovska move
		variable index:string _Locs
		variable int _i
		variable int _f
		variable int _ClosestDistance
		variable int _ClosestLoc
		variable int _ClosestCycloneLoc
		

		;_Locs:Insert["22.113968,-49.997612,-221.702011"]
		;_Locs:Insert["43.196320,-49.997528,-220.331573"]
		;_Locs:Insert["38.338120,-49.003201,-200.251389"]
		;_Locs:Insert["44.503986,-49.997532,-172.373672"]
		;_Locs:Insert["45.308056,-49.997509,-150.545807"]
		;_Locs:Insert["25.513563,-49.987984,-153.741577"]
		;_Locs:Insert["1.190960,-48.588764,-164.711411"]
		;_Locs:Insert["-26.407978,-48.997589,-155.159653"]
		;_Locs:Insert["-47.821934,-49.997505,-151.308945"]
		;_Locs:Insert["-47.401436,-49.997505,-177.036469"]
		;_Locs:Insert["-36.813358,-48.023232,-202.562073"]
		;_Locs:Insert["-45.476620,-49.997532,-231.566132"]
		;_Locs:Insert["-44.820568,-49.997513,-254.130661"]
		;_Locs:Insert["-20.532934,-49.997513,-252.911011"]
		;_Locs:Insert["0.320724,-48.076466,-239.414825"]
		
		;_Locs:Insert["-0.100023,-49.997513,-250.954727"]
		;_Locs:Insert["44.148914,-49.997513,-202.424042"]
		;_Locs:Insert["-0.093610,-49.997509,-157.087433"]
		;_Locs:Insert["-44.281197,-49.997520,-202.14643"]

		;_Locs:Insert["0.076326,-48.997601,-240.845306"]
		;_Locs:Insert["38.290783,-48.922070,-202.479004"]
		;_Locs:Insert["0.046580,-48.997780,-163.888870"]
		;_Locs:Insert["-38.249729,-48.849178,-202.465515"]

		_Locs:Insert["-0.236990,-47.467943,-237.152908"]
		_Locs:Insert["34.545944,-47.563663,-202.617310"]
		_Locs:Insert["-0.006720,-47.563663,-167.899933"]
		_Locs:Insert["-34.474503,-47.563660,-202.300430"]

		;_Locs:Insert["0.094187,-49.997513,-250.993317"]
		;_Locs:Insert["28.940199,-49.997524,-253.598709"]
		;_Locs:Insert["47.308392,-49.997505,-253.647018"]
		;_Locs:Insert["44.376766,-49.997513,-237.144348"]
		;_Locs:Insert["31.003859,-49.997574,-222.272263"]
		;_Locs:Insert["43.089249,-49.997513,-202.027008"]
		;_Locs:Insert["46.526299,-49.997528,-169.789093"]
		;_Locs:Insert["46.140144,-49.997505,-149.067459"]
		;_Locs:Insert["27.033342,-49.997509,-150.048492"]
		;_Locs:Insert["14.404881,-49.997570,-165.103561"]
		;_Locs:Insert["-0.584877,-49.997513,-155.745041"]
		;_;Locs:Insert["-27.258802,-49.997532,-151.897354"]
		;_Locs:Insert["-47.969048,-49.997501,-151.929596"]
		;_Locs:Insert["-45.105511,-49.997509,-174.346573"]
		;_Locs:Insert["-29.095814,-49.997581,-182.891144"]
		;_Locs:Insert["-43.572353,-49.997513,-202.741882"]
		;_Locs:Insert["-46.691429,-49.997532,-236.149170"]
		;_Locs:Insert["-47.627678,-49.997513,-254.899719"]
		;_Locs:Insert["-22.478996,-49.997509,-254.118607"]
		;_Locs:Insert["-14.058354,-49.997562,-242.469528"]

		;first determine which loc i am at
		_ClosestDistance:Set[10000000]
		for(_i:Set[1];${_i}<=${_Locs.Used};_i:Inc)
		{
			;echo ${_Locs.Get[${_i}]}: ${Me.Distance[${_Locs.Get[${_i}]}]}<${_ClosestDistance}
			if ${Me.Distance[${_Locs.Get[${_i}]}]}<${_ClosestDistance}
			{
				;echo setting
				_ClosestDistance:Set[${Me.Distance[${_Locs.Get[${_i}]}]}]
				_ClosestLoc:Set[${_i}]
			}
		}
		if ${_Stage}==3 
		;|| !${Actor[Query, Name=-"cyclonic ${_Cyclone}"](exists)} - this was if we did not have a cyclone of either up, but this is not correct, if that happens we need to goto closesy cyclone and change them
		{
			;echo stage 3
			;echo relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Locs.Get[${_ClosestLoc}]},1,1000]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Locs.Get[${_ClosestLoc}]},1,1000]
			wait 300 ${Me.Distance[${_Locs.Get[${_ClosestLoc}]}]}<2
			wait 300 ${RIMObj.AllGroupWithinRange[3]}
			return
		}
		if ${_Stage}!=2
		{
			;echo not stage 2
			;now determine which loc the closest correct charge is at
			_ClosestDistance:Set[10000000]
			for(_i:Set[1];${_i}<=${_Locs.Used};_i:Inc)
			{
				if ${_Stage}==1
				{
					if ${Math.Distance[${_Locs.Get[${_i}]},${Actor[Query, Name=-"Nogrovska Vodlak"].Loc}]}<${_ClosestDistance}
					{
						_ClosestDistance:Set[${Math.Distance[${_Locs.Get[${_i}]},${Actor[Query, Name=-"Nogrovska Vodlak"].Loc}]}]
						_ClosestCycloneLoc:Set[${_i}]
					}
				}
				else
				{
					if ${Math.Distance[${_Locs.Get[${_i}]},${Actor[Query, Name=-"cyclonic ${_Cyclone}"].Loc}]}<${_ClosestDistance}
					{
						_ClosestDistance:Set[${Math.Distance[${_Locs.Get[${_i}]},${Actor[Query, Name=-"cyclonic ${_Cyclone}"].Loc}]}]
						_ClosestCycloneLoc:Set[${_i}]
						RI_Nogrovska_CycloneID:Set[${Actor[Query, Name=-"cyclonic ${_Cyclone}"].ID}]
					}
				}
			}
			;echo ${_ClosestLoc}
			;echo ${_ClosestCycloneLoc}
		}
		;now move from my loc to that loc and kill golem or the beggining
		if ${_Stage}==2
		{
			;echo stage 2
			for(_i:Set[${_ClosestLoc}];${_i}>=1;_i:Dec)
			{
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Locs.Get[${_i}]},1,1000]
				wait 300 ${Me.Distance[${_Locs.Get[${_i}]}]}<2
				wait 300 ${RIMObj.AllGroupWithinRange[3]}
				if ${_i}==3
				{
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,24.092203,-49.020859,-173.807831,1,1000]
					wait 300 ${Me.Distance[24.092203,-49.020859,-173.807831]}<2
					wait 300 ${RIMObj.AllGroupWithinRange[3]}
				}
			}
		}
		elseif ${_ClosestLoc}==${_ClosestCycloneLoc}
		{
			;echo same loc
			if ${_Stage}==1
			{
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Locs.Get[${_ClosestLoc}]}]
				echo relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Locs.Get[${_ClosestLoc}]}]
			}
			else
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=-"cyclonic ${_Cyclone}"].Loc},2,1000]
			;echo relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=-"cyclonic ${_Cyclone}"].Loc},2,1000]
		}
		else
		{
			;echo other
			if ${_ClosestLoc}==1 && ${_ClosestCycloneLoc}==4
			{
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Locs.Get[4]},1,1000]
				wait 300 ${Me.Distance[${_Locs.Get[4]}]}<2
				wait 300 ${RIMObj.AllGroupWithinRange[3]}
			}
			else
			{
				;if ${_ClosestLoc}==4
				;	_i:Set[1]
				;else
					_i:Set[${_ClosestLoc}]
				if ${_ClosestLoc}>${_ClosestCycloneLoc}
				{
					;echo dec
					
					for(;${_i}>${_ClosestCycloneLoc};_i:Dec)
					{
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Locs.Get[${_i}]},1,1000]
						wait 300 ${Me.Distance[${_Locs.Get[${_i}]}]}<2
						wait 300 ${RIMObj.AllGroupWithinRange[3]}
						if ${_i}==3
						{
							
							relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,24.092203,-49.020859,-173.807831,1,1000]
							wait 300 ${Me.Distance[24.092203,-49.020859,-173.807831]}<2
							wait 300 ${RIMObj.AllGroupWithinRange[3]}
						}
					}
				}
				else
				{
					;echo inc
					for(;${_i}<=${_ClosestCycloneLoc};_i:Inc)
					{
						if ${_i}==3
						{
							
							relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,24.092203,-49.020859,-173.807831,1,1000]
							wait 300 ${Me.Distance[24.092203,-49.020859,-173.807831]}<2
							wait 300 ${RIMObj.AllGroupWithinRange[3]}
						}
						relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Locs.Get[${_i}]},1,1000]
						wait 300 ${Me.Distance[${_Locs.Get[${_i}]}]}<2
						wait 300 ${RIMObj.AllGroupWithinRange[3]}
					}
				}
			}
		}
		if ${_Stage}!=2 && ${_Stage}!=1
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=-"cyclonic ${_Cyclone}"].Loc},2,1000]
			;echo relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=-"cyclonic ${_Cyclone}"].Loc},2,1000]
		}
		;echo end nogrovskamove
		if ${Zone.Name.Find["[Heroic II]"]}
		{
			RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,0]
		}
}
function Labomination()
{
	declare RI_Labomination_Maths index:string global
	RI_Obj_CB:DoNotCastAE[TRUE]
	call CustomNamed "The Abandoned Labomination" "67.494720,-14.892214,-37.548088" LabominationCustom
	RI_Obj_CB:DoNotCastAE[FALSE]
	;after the fight move back to middle - 67.494720,-14.892214,-37.548088
}
function LabominationCustom(int _NamedID)
{
	;Name: Wrath of the Math Description: Maths! BackDropIconID: -1 MainIconID: 270
	if ${RIMUIObj.MainIconIDExists[${Me.ID},270]} && ${Zone.Name.Find["[Heroic II]"]}
	{
		variable int _LabominationInc=${Actor[id,${_NamedID}].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},270]}].CurrentIncrements}
		variable int _MyIncs=${Me.Effect[detrimental,${RIMUIObj.MainIconIDExists[${Me.ID},270]}].CurrentIncrements}
		variable int _AddedIncs
		echo MyIncs: ${_MyIncs} / ${_LabominationInc}
		variable int _i
		variable int _f
		variable string _Curers
		relay ${RI_Var_String_RelayGroup} RI_Labomination_Maths:Insert[${Me.Name}|${_MyIncs}]
		wait 300 ${RI_Labomination_Maths.Used}==${Me.Group}
		echo USED: ${RI_Labomination_Maths.Used}
		;math time
		for(_i:Set[1];${_i}<=${Me.Group};_i:Inc)
		{
			for(_f:Set[1];${_f}<=${Me.Group};_f:Inc)
			{
				if ${_i}!=${_f}
				{
					echo ${Math.Calc[${RI_Labomination_Maths.Get[${_i}].Token[2,|]}+${RI_Labomination_Maths.Get[${_f}].Token[2,|]}]}==${_LabominationInc}
					_AddedIncs:Set[${Math.Calc[${RI_Labomination_Maths.Get[${_i}].Token[2,|]}+${RI_Labomination_Maths.Get[${_f}].Token[2,|]}]}]
					if ${_AddedIncs}==${_LabominationInc}
					{
						echo Equals: _Curers:Set["${RI_Labomination_Maths.Get[${_i}].Token[1,|]}|${RI_Labomination_Maths.Get[${_f}].Token[1,|]}"]
						_Curers:Set["${RI_Labomination_Maths.Get[${_i}].Token[1,|]}|${RI_Labomination_Maths.Get[${_f}].Token[1,|]}"]
					}
				}
			}
		}
		echo ${_Curers} \\ ${_Curers.Token[1,|]}:${Me.Group[${_Curers.Token[1,|]}].Cursed} \\ ${_Curers.Token[2,|]}:${Me.Group[${_Curers.Token[2,|]}].Cursed}
		while ${Me.Group[${_Curers.Token[1,|]}].Cursed}
		{
			relay ${RI_Var_String_RelayGroup} RI_CMD_CastOn "Cure Curse" ${_Curers.Token[1,|]} 1
			wait 1
		}
		while ${Me.Group[${_Curers.Token[2,|]}].Cursed}
		{
			relay ${RI_Var_String_RelayGroup} RI_CMD_CastOn "Cure Curse" ${_Curers.Token[2,|]} 1
			wait 1
		}
		RI_Labomination_Maths:Clear
	}
	else
	{
		RI_Labomination_Maths:Clear
	}
	if ${RIMUIObj.MainIconIDExists[${_NamedID},471]} && ${Actor[id,${_NamedID}].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},471]}].BackDropIconID}!=312
	{
		;echo Osseous
		;Osseous Osmosis 471 - 33080  -- Poison
		;75.756134,-14.997500,-28.243177
		;boss 6 panel
		;Acid Crawler Queen

		;Osseous Osmosis 33083 - Slashing
		;59.965382,-14.997500,-46.925465
		;Shale Crawler Queen

		;Osseous Osmosis 33082 - Mental
		;75.593742,-14.997500,-47.513500

		;Osseous Osmosis 33084
		;60.807545,-14.997500,-28.003977
		;Lava Crawler Queen
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
		relay ${RI_Var_String_RelayGroup} eq2ex pet backoff	
		relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
		if ${Actor[id,${_NamedID}].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},471]}].BackDropIconID}==33080
		{
			while ${Actor[Query, Name=-"Crawler Queen" && IsDead=FALSE](exists)} && !${Actor[Query, Name=-"Acid Crawler Queen" && IsDead=FALSE](exists)}
			{
				Actor[Query, Name=-"Crawler Queen" && IsDead=FALSE]:DoTarget
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
				waitframe
			}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
			relay ${RI_Var_String_RelayGroup} eq2ex pet backoff	
			relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,75.756134,-14.997500,-28.243177]
			wait 300 ${Me.Distance[75.756134,-14.997500,-28.243177]}<3
			while !${Actor[Query, Name=="Acid Crawler Queen"](exists)}
			{
				Actor[boss 6 panel]:DoubleClick
				waitframe
			}
			while ${Actor[Query, Name=="Acid Crawler Queen" && IsAggro=FALSE](exists)}
			{
				Actor[Acid Crawler Queen]:DoTarget
				waitframe
			}
			Actor[id,${_NamedID}]:DoTarget
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
			while ${Actor[id,${_NamedID}].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},471]}].BackDropIconID}==33080
			{
				Actor[id,${_NamedID}]:DoTarget
				waitframe
			}
		}
		elseif ${Actor[id,${_NamedID}].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},471]}].BackDropIconID}==33083
		{
			while ${Actor[Query, Name=-"Crawler Queen" && IsDead=FALSE](exists)} && !${Actor[Query, Name=-"Shale Crawler Queen" && IsDead=FALSE](exists)}
			{
				Actor[Query, Name=-"Crawler Queen" && IsDead=FALSE]:DoTarget
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
				waitframe
			}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
			relay ${RI_Var_String_RelayGroup} eq2ex pet backoff	
			relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,59.965382,-14.997500,-46.925465]
			wait 300 ${Me.Distance[59.965382,-14.997500,-46.925465]}<3
			while !${Actor[Query, Name=="Shale Crawler Queen"](exists)}
			{
				Actor[boss 6 panel]:DoubleClick
				waitframe
			}
			while ${Actor[Query, Name=="Shale Crawler Queen" && IsAggro=FALSE](exists)}
			{
				Actor[Shale Crawler Queen]:DoTarget
				waitframe
			}
			Actor[id,${_NamedID}]:DoTarget
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
			while ${Actor[id,${_NamedID}].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},471]}].BackDropIconID}==33083
			{
				Actor[id,${_NamedID}]:DoTarget
				waitframe
			}
		}
		elseif ${Actor[id,${_NamedID}].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},471]}].BackDropIconID}==33082
		{
			while ${Actor[Query, Name=-"Crawler Queen" && IsDead=FALSE](exists)} && !${Actor[Query, Name=-"Mind Crawler Queen" && IsDead=FALSE](exists)}
			{
				Actor[Query, Name=-"Crawler Queen" && IsDead=FALSE]:DoTarget
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
				waitframe
			}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
			relay ${RI_Var_String_RelayGroup} eq2ex pet backoff	
			relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,75.593742,-14.997500,-47.513500]
			wait 300 ${Me.Distance[75.593742,-14.997500,-47.513500]}<3
			while !${Actor[Query, Name=="Mind Crawler Queen"](exists)}
			{
				Actor[boss 6 panel]:DoubleClick
				waitframe
			}
			while ${Actor[Query, Name=="Mind Crawler Queen" && IsAggro=FALSE](exists)}
			{
				Actor[Mind Crawler Queen]:DoTarget
				waitframe
			}
			Actor[id,${_NamedID}]:DoTarget
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
			while ${Actor[id,${_NamedID}].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},471]}].BackDropIconID}==33082
			{
				Actor[id,${_NamedID}]:DoTarget
				waitframe
			}
		}
		elseif ${Actor[id,${_NamedID}].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},471]}].BackDropIconID}==33084
		{
			while ${Actor[Query, Name=-"Crawler Queen" && IsDead=FALSE](exists)} && !${Actor[Query, Name=-"Lava Crawler Queen" && IsDead=FALSE](exists)}
			{
				Actor[Query, Name=-"Crawler Queen" && IsDead=FALSE]:DoTarget
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
				waitframe
			}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
			relay ${RI_Var_String_RelayGroup} eq2ex pet backoff	
			relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,60.807545,-14.997500,-28.003977]
			wait 300 ${Me.Distance[60.807545,-14.997500,-28.003977]}<3
			while !${Actor[Query, Name=="Lava Crawler Queen"](exists)}
			{
				Actor[boss 6 panel]:DoubleClick
				waitframe
			}
			while ${Actor[Query, Name=="Lava Crawler Queen" && IsAggro=FALSE](exists)}
			{
				Actor[Lava Crawler Queen]:DoTarget
				waitframe
			}
			Actor[id,${_NamedID}]:DoTarget
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
			while ${Actor[id,${_NamedID}].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},471]}].BackDropIconID}==33084
			{
				Actor[id,${_NamedID}]:DoTarget
				waitframe
			}
		}
	}
	else
		call RIObj.Target "Crawler Queen" ${_NamedID}
}

;End Vasty Deep: Toil and Trouble

;Start Shadeweaver's Thicket: Loda Kai Isle

;830.081604,50.476349,256.224152 / 830.081604 50.476349 256.22415
;813.621155,52.112473,252.537079 / 813.621155 52.112473 252.53707
;Running Announce v1
;a Loda Kai grunt
;18:05:14:Announce: Kayzen pulls out his longbow!
;Killmaster Kayzen
;18:05:19:Announce: Defidus is Kayzen's next BIG GAME TARGET!
;752.484009,60.074165,251.033096 / 752.484009 60.074165 251.03309
;18:06:03:Announce: Kayzen pulls out his longbow!
;18:06:08:Announce: Ichu is Kayzen's next BIG GAME TARGET!
;18:06:43:Announce: Kayzen pulls out his longbow!
;18:06:48:Announce: Poufelord is Kayzen's next BIG GAME TARGET!

function Kayzen()
{
	variable int _EndCnt=0
	IncomingText:Clear
	IncomingText:Insert["Kayzen's next BIG GAME TARGET"]
	declare RI_Kayzen_Stage int global 0
	declare RI_Kayzen_Done bool global FALSE
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
	relay ${RI_Var_String_RelayGroup} eq2ex pet backoff	
	relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
	Actor[Killmaster]:DoTarget
	wait 600 ${Actor[Killmaster].Target.InMyGroup}
	RIMUIObj:SetLockSpot[ALL,830.081604,50.476349,256.224152]
	wait 300 ${Me.Distance[830.081604,50.476349,256.224152]}<3
	_EndCnt:Set[0]
	while ${_EndCnt:Inc}<300 && ${Me.Distance[830.081604,50.476349,256.224152]}>3
	{
		call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
		wait 1
	}
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
	_EndCnt:Set[0]
	while  ${_EndCnt:Inc}<300 && ${Me.Distance[813.621155,52.112473,252.537079]}>3 && ${Actor[id, ${_NamedID}].Distance}>10
	{
		call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
		wait 1
	}
	call CustomNamed "Killmaster Kayzen-NMB-NLP" "830.081604,50.476349,256.224152" KayzenCustom
	if ${Me.Distance[752.484009,60.074165,251.033096]}<50
	{
		RIMUIObj:SetLockSpot[ALL,788.336609,47.960670,296.587830]
		wait 300 ${Me.Distance[788.336609,47.960670,296.587830]}<3
		wait 300 ${RIMObj.AllGroupWithinRange[3]}
	}
}
function KayzenCustom(int _NamedID)
{
	variable int _EndCnt=0
	call RIObj.Target "a Loda Kai grunt" -Distance 25 ${_NamedID}
	if ${Trigger}
	{
		RI_Kayzen_Stage:Inc
		RI_Kayzen_Done:Set[0]
		Trigger:Set[0]
	}
	if ${RI_Kayzen_Stage}==1 && !${RI_Kayzen_Done}
	{
		wait 300 ${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE](exists)}
		while ${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE](exists)}
		{
			RIMUIObj:SetLockSpot[ALL,${RIMUIObj.3rdPointLine[${Actor[Killmaster Kayzen].X},${Actor[Killmaster Kayzen].Z},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].X},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].Z},5].Token[1,"\,"]},${Me.Y},${RIMUIObj.3rdPointLine[${Actor[Killmaster Kayzen].X},${Actor[Killmaster Kayzen].Z},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].X},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].Z},5].Token[2,"\,"]}]
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
		}
		RIMUIObj:SetLockSpot[ALL,823.183960,46.362434,280.753143]
		_EndCnt:Set[0]
		while ${_EndCnt:Inc}<300 && ${Me.Distance[823.183960,46.362434,280.753143]}>3
		{
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
			wait 1
		}
		RIMUIObj:SetLockSpot[ALL,813.621155,52.112473,252.537079]
		while ${_EndCnt:Inc}<300 && ${Me.Distance[813.621155,52.112473,252.537079]}>3
		{
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
			wait 1
		}
		_EndCnt:Set[0]
		while  ${_EndCnt:Inc}<300 && ${Me.Distance[813.621155,52.112473,252.537079]}>3 && ${Actor[id, ${_NamedID}].Distance}>10
		{
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
			wait 1
		}
		RI_Kayzen_Done:Set[1]
	}
	if ${RI_Kayzen_Stage}==2 && !${RI_Kayzen_Done}
	{
		wait 300 ${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE](exists)}
		while ${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE](exists)}
		{
			RIMUIObj:SetLockSpot[ALL,${RIMUIObj.3rdPointLine[${Actor[Killmaster Kayzen].X},${Actor[Killmaster Kayzen].Z},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].X},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].Z},5].Token[1,"\,"]},${Me.Y},${RIMUIObj.3rdPointLine[${Actor[Killmaster Kayzen].X},${Actor[Killmaster Kayzen].Z},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].X},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].Z},5].Token[2,"\,"]}]
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
		}
		RIMUIObj:SetLockSpot[ALL,823.620911,45.395958,290.701233]
		_EndCnt:Set[0]
		while ${_EndCnt:Inc}<300 && ${Me.Distance[823.620911,45.395958,290.701233]}>3
		{
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
			wait 1
		}
		RIMUIObj:SetLockSpot[ALL,781.314819,46.743942,307.942322]
		_EndCnt:Set[0]
		while ${_EndCnt:Inc}<300 && ${Me.Distance[781.314819,46.743942,307.942322]}>3
		{
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
			wait 1
		}
		RIMUIObj:SetLockSpot[ALL,765.819641,58.257885,265.968201]
		_EndCnt:Set[0]
		while ${_EndCnt:Inc}<300 && ${Me.Distance[765.819641,58.257885,265.968201]}>3
		{
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
			wait 1
		}
		RIMUIObj:SetLockSpot[ALL,752.484009,60.074165,251.033096]
		while ${_EndCnt:Inc}<300 && ${Me.Distance[752.484009,60.074165,251.033096]}>3
		{
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
			wait 1
		}
		_EndCnt:Set[0]
		while  ${_EndCnt:Inc}<300 && ${Me.Distance[813.621155,52.112473,252.537079]}>3 && ${Actor[id, ${_NamedID}].Distance}>10
		{
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
			wait 1
		}
		RI_Kayzen_Done:Set[1]
	}
	if ${RI_Kayzen_Stage}==3 && !${RI_Kayzen_Done}
	{
		wait 300 ${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE](exists)}
		while ${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE](exists)}
		{
			RIMUIObj:SetLockSpot[ALL,${RIMUIObj.3rdPointLine[${Actor[Killmaster Kayzen].X},${Actor[Killmaster Kayzen].Z},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].X},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].Z},5].Token[1,"\,"]},${Me.Y},${RIMUIObj.3rdPointLine[${Actor[Killmaster Kayzen].X},${Actor[Killmaster Kayzen].Z},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].X},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].Z},5].Token[2,"\,"]}]
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
		}
		RIMUIObj:SetLockSpot[ALL,786.047363,46.299946,307.077087]
		_EndCnt:Set[0]
		while ${_EndCnt:Inc}<300 && ${Me.Distance[786.047363,46.299946,307.077087]}>3
		{
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
			wait 1
		}
		RIMUIObj:SetLockSpot[ALL,748.357239,50.266830,336.263702]
		while ${_EndCnt:Inc}<300 && ${Me.Distance[748.357239,50.266830,336.263702]}>3
		{
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
			wait 1
		}
		_EndCnt:Set[0]
		while  ${_EndCnt:Inc}<300 && ${Me.Distance[813.621155,52.112473,252.537079]}>3 && ${Actor[id, ${_NamedID}].Distance}>10
		{
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
			wait 1
		}
		RI_Kayzen_Done:Set[1]
	}
	if ${RI_Kayzen_Stage}==4 && !${RI_Kayzen_Done}
	{
		wait 300 ${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE](exists)}
		while ${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE](exists)}
		{
			RIMUIObj:SetLockSpot[ALL,${RIMUIObj.3rdPointLine[${Actor[Killmaster Kayzen].X},${Actor[Killmaster Kayzen].Z},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].X},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].Z},5].Token[1,"\,"]},${Me.Y},${RIMUIObj.3rdPointLine[${Actor[Killmaster Kayzen].X},${Actor[Killmaster Kayzen].Z},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].X},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].Z},5].Token[2,"\,"]}]
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
		}
		RIMUIObj:SetLockSpot[ALL,774.843384,46.583462,316.718140]
		_EndCnt:Set[0]
		while ${_EndCnt:Inc}<300 && ${Me.Distance[774.843384,46.583462,316.718140]}>3
		{
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
			wait 1
		}
		RIMUIObj:SetLockSpot[ALL,839.989929,45.569611,321.633270]
		_EndCnt:Set[0]
		while ${_EndCnt:Inc}<300 && ${Me.Distance[839.989929,45.569611,321.633270]}>3
		{
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
			wait 1
		}
		RIMUIObj:SetLockSpot[ALL,856.930847,44.976868,312.260834]
		while ${_EndCnt:Inc}<300 && ${Me.Distance[856.930847,44.976868,312.260834]}>3
		{
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
			wait 1
		}
		_EndCnt:Set[0]
		while  ${_EndCnt:Inc}<300 && ${Me.Distance[813.621155,52.112473,252.537079]}>3 && ${Actor[id, ${_NamedID}].Distance}>10
		{
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
			wait 1
		}
		RI_Kayzen_Done:Set[1]
	}
	if ${RI_Kayzen_Stage}==5 && !${RI_Kayzen_Done}
	{
		wait 300 ${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE](exists)}
		while ${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE](exists)}
		{
			RIMUIObj:SetLockSpot[ALL,${RIMUIObj.3rdPointLine[${Actor[Killmaster Kayzen].X},${Actor[Killmaster Kayzen].Z},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].X},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].Z},5].Token[1,"\,"]},${Me.Y},${RIMUIObj.3rdPointLine[${Actor[Killmaster Kayzen].X},${Actor[Killmaster Kayzen].Z},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].X},${Actor[Query, Name=="a hungry highland alphaweaver" && IsAggro=TRUE].Z},5].Token[2,"\,"]}]
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
		}
		RIMUIObj:SetLockSpot[ALL,818.382324,46.477661,320.919373]
		while ${_EndCnt:Inc}<300 && ${Me.Distance[818.382324,46.477661,320.919373]}>3
		{
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
			wait 1
		}
		_EndCnt:Set[0]
		while  ${_EndCnt:Inc}<300 && ${Me.Distance[813.621155,52.112473,252.537079]}>3 && ${Actor[id, ${_NamedID}].Distance}>10
		{
			call RIObj.Target "a Loda Kai grunt" -Distance 25 ${Me.ID}
			wait 1
		}
		RI_Kayzen_Done:Set[1]
	}
}
function Rodderick()
{
	;call LootOptions ROUNDROBIN
	;wait 20
	;IncomingText:Clear
	;IncomingText:Insert[""]
	call CustomNamed "Nimble Rodderick" "817.844727,47.436901,445.026886" RodderickCustom
}
function RodderickCustom(int _NamedID)
{
	;Jum Jum Jamboree 707
	call RIObj.Dispell ${_NamedID} 707 1
}
function Verath()
{
	RIMUIObj:SetLockSpot[${Me.Name},895.052979,47.901249,378.899384]
	wait 300 ${Me.Distance[895.052979,47.901249,378.899384]}<3
	call CustomNamed "Taja Verath" "895.052979,47.901249,378.899384" VerathCustom
}
function VerathCustom(int _NamedID)
{
	call RIObj.Target "a tamed forest tiger" -Distance 25 ${_NamedID}
	if ${Me.Arcane}==-1 ||  ${Me.Arcane}>0
	{
		RIMUIObj:SetLockSpot[${Me.Name},878.735779,47.325550,389.823761]
	}
	else
	{
		RIMUIObj:SetLockSpot[${Me.Name},895.052979,47.901249,378.899384]
	}
}
;End Shadeweaver's Thicket: Loda Kai Isle

;Start Vex Thal: Den of Shadows

function Oograll()
{
	RI_Obj_CB:DoNotCastAE[TRUE]
	call CustomNamed "Pall of Oograll" "-106.889343,139.819397,-150.248932" NONE enslaved Zin
	RI_Obj_CB:DoNotCastAE[FALSE]
}
function Warden()
{
	call CustomNamed "The Umbral Warden" "95.610413,142.985535,-317.854370"
}
function Zethon()
{
	wait 150 ${Actor[Eom Va Zethon](exists)}
	call CustomNamed "Eom Va Zethon-INC" "-0.792673,139.842468,-443.740173" NONE Xakra
}
function Ssyssyx()
{
	RI_Obj_CB:DoNotCastAE[TRUE]
	call CustomNamed "Gloomscale Ssyssyx" "-0.928404,150.794250,-206.746796" SsyssyxCustom
	RI_Obj_CB:DoNotCastAE[FALSE]
}
function SsyssyxCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
	if ${Actor[Query, Name=="an ebon bloodeye" && X=-19.030001 & Y=150.789993 & Z=-202.750000 && IsAggro=FALSE](exists)}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
		relay ${RI_Var_String_RelayGroup} eq2ex pet backoff	
		relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-0.928404,150.794250,-206.746796]
		wait 300 ${Me.Distance[-0.928404,150.794250,-206.746796]}<3
		while ${Actor[Query, Name=="an ebon bloodeye" && X=-19.030001 & Y=150.789993 & Z=-202.750000 && IsAggro=FALSE](exists)}
		{
			Actor[Query, Name=="an ebon bloodeye" && X=-19.030001 & Y=150.789993 & Z=-202.750000 && IsAggro=FALSE]:DoTarget
			waitframe
		}
		Actor[id, ${_NamedID}]:DoTarget
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
	}
	if ${Actor[Query, Name=="an ebon bloodeye" && X=-19.010000 & Y=150.789993 & Z=-188.279999 && IsAggro=FALSE](exists)}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
		relay ${RI_Var_String_RelayGroup} eq2ex pet backoff	
		relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-1.059300,150.794250,-190.877182]
		wait 300 ${Me.Distance[-1.059300,150.794250,-190.877182]}<3
		while ${Actor[Query, Name=="an ebon bloodeye" && X=-19.010000 & Y=150.789993 & Z=-188.279999 && IsAggro=FALSE](exists)}
		{
			Actor[Query, Name=="an ebon bloodeye" && X=-19.010000 & Y=150.789993 & Z=-188.279999 && IsAggro=FALSE]:DoTarget
			waitframe
		}
		Actor[id, ${_NamedID}]:DoTarget
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
	}
	if ${Actor[Query, Name=="an ebon bloodeye" && X=-19.000000 & Y=150.789993 & Z=-173.559998 && IsAggro=FALSE](exists)}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,0]
		relay ${RI_Var_String_RelayGroup} eq2ex pet backoff	
		relay ${RI_Var_String_RelayGroup} eq2ex cancel_spellcast
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-1.046345,150.794250,-175.889862]
		wait 300 ${Me.Distance[-1.046345,150.794250,-175.889862]}<3
		while ${Actor[Query, Name=="an ebon bloodeye" && X=-19.000000 & Y=150.789993 & Z=-173.559998 && IsAggro=FALSE](exists)}
		{
			Actor[Query, Name=="an ebon bloodeye" && X=-19.000000 & Y=150.789993 & Z=-173.559998 && IsAggro=FALSE]:DoTarget
			waitframe
		}
		Actor[id, ${_NamedID}]:DoTarget
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastHostileCheckBox,1]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsCastNamedHostileCheckBox,1]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetUISetting[ALL,SettingsSendPetsCheckBox,1]
	}
}
function Zeom()
{
	call CustomNamed "Vasszhin Zeom" "-106.695282,150.152420,-313.655426" ZeomCustom
}
function ZeomCustom(int _NamedID)
{
	call RIObj.Target darkmelder -Distance 30 ${_NamedID}
	variable int _SphereNum=0
	if ${Actor[sphere blue ceiling 1](exists)}
	{
		_SphereNum:Set[1]
	}
	elseif ${Actor[sphere blue ceiling 2](exists)}
	{
		_SphereNum:Set[2]
	}
	elseif ${Actor[sphere blue ceiling 3](exists)}
	{
		_SphereNum:Set[3]
	}
	elseif ${Actor[sphere blue ceiling 4](exists)}
	{
		_SphereNum:Set[4]
	}
	elseif ${Actor[sphere blue ceiling 5](exists)}
	{
		_SphereNum:Set[5]
	}
	elseif ${Actor[sphere blue ceiling 6](exists)}
	{
		_SphereNum:Set[6]
	}
	elseif ${Actor[sphere blue ceiling 7](exists)}
	{
		_SphereNum:Set[7]
	}
	elseif ${Actor[sphere blue ceiling 8](exists)}
	{
		_SphereNum:Set[8]
	}
	if ${_SphereNum}>0
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[sphere stand ${_SphereNum}].Loc},3]
		wait 300 ${Me.Distance[${Actor[sphere stand ${_SphereNum}].Loc}]}<4
		Actor[sphere stand ${_SphereNum}]:DoubleClick
		wait 2
	}
	else
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-106.695282,150.152420,-313.655426]
	}
}

function Ssraeshza()
{
	call CustomNamed "Shade of Ssraeshza-NMB" "207.788589,139.414017,-286.608459" SsraeshzaCustom
}
function SsraeshzaCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	call RIObj.Target shadowguard -Distance 30 ${_NamedID}
	;add lockspots to index then query all actors, 
	;then move to closest locspot that is more than 10 from every puddle
	variable index:string _Locs
	variable index:actor _ActorIndex
	EQ2:QueryActors[_ActorIndex, Name=="" && Overlay=="design_black_hole_area"]
	;echo ${Actor[Query, Name=="" && Overlay=="design_black_hole_area"]} // ${_ActorIndex.Used} // ${Actor[Query, Name=="" && TintFlags=2306]}
	if ${_ActorIndex.Used}==0
		return
	_Locs:Insert["186.076050,139.398987,-277.678528"]
	_Locs:Insert["186.035675,139.399002,-287.897675"]
	_Locs:Insert["186.035675,139.399002,-297.897675"]
	_Locs:Insert["186.035675,139.399002,-307.897675"]
	_Locs:Insert["186.035675,139.399002,-317.897675"]
	_Locs:Insert["186.035675,139.399002,-327.897675"]
	_Locs:Insert["196.076050,139.398987,-267.678528"]
	_Locs:Insert["196.076050,139.398987,-277.678528"]
	_Locs:Insert["196.035675,139.399002,-287.897675"]
	_Locs:Insert["196.035675,139.399002,-297.897675"]
	_Locs:Insert["196.035675,139.399002,-307.897675"]
	_Locs:Insert["196.035675,139.399002,-317.897675"]
	_Locs:Insert["196.035675,139.399002,-327.897675"]
	_Locs:Insert["196.035675,139.399002,-337.897675"]
	_Locs:Insert["206.076050,139.398987,-267.678528"]
	_Locs:Insert["206.076050,139.398987,-277.678528"]
	_Locs:Insert["206.035675,139.399002,-287.897675"]
	_Locs:Insert["206.035675,139.399002,-297.897675"]
	_Locs:Insert["206.035675,139.399002,-307.897675"]
	_Locs:Insert["206.035675,139.399002,-317.897675"]
	_Locs:Insert["206.035675,139.399002,-327.897675"]
	_Locs:Insert["206.035675,139.399002,-337.897675"]
	_Locs:Insert["216.076050,139.398987,-267.678528"]
	_Locs:Insert["216.076050,139.398987,-277.678528"]
	_Locs:Insert["216.035675,139.399002,-287.897675"]
	_Locs:Insert["216.035675,139.399002,-317.897675"]
	_Locs:Insert["216.035675,139.399002,-327.897675"]
	_Locs:Insert["216.035675,139.399002,-337.897675"]
	_Locs:Insert["226.076050,139.398987,-267.678528"]
	_Locs:Insert["226.076050,139.398987,-277.678528"]
	_Locs:Insert["226.035675,139.399002,-287.897675"]
	_Locs:Insert["226.035675,139.399002,-297.897675"]
	_Locs:Insert["226.035675,139.399002,-307.897675"]
	_Locs:Insert["226.035675,139.399002,-317.897675"]
	_Locs:Insert["226.035675,139.399002,-327.897675"]
	_Locs:Insert["226.035675,139.399002,-337.897675"]
	_Locs:Insert["236.076050,139.398987,-277.678528"]
	_Locs:Insert["236.035675,139.399002,-287.897675"]
	_Locs:Insert["236.035675,139.399002,-297.897675"]
	_Locs:Insert["236.035675,139.399002,-307.897675"]
	_Locs:Insert["236.035675,139.399002,-317.897675"]
	_Locs:Insert["236.035675,139.399002,-327.897675"]

	call RIObj.AvoidActors _Locs _ActorIndex 5
}
function VTFindPortal(string _Portal)
{
	if ${_Portal.Equal[Portal p4_01]}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Portal p4_01].X},139.842468,-444.276093]
		wait 300 ${Me.Distance[${Actor[Portal p4_01].X},139.842468,-444.276093]}<3
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Portal p4_01].Loc},3]
		wait 300 ${Me.Distance[${Actor[Portal p4_01].Loc}]}<4
		wait 20
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,OFF]
	}
	elseif ${_Portal.Equal[Portal p5_01]}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-1.031736,150.794250,${Actor[Portal p5_01].Z}]
		wait 300 ${Me.Distance[-1.031736,150.794250,${Actor[Portal p5_01].Z}]}<3
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Portal p5_01].Loc},3]
		wait 300 ${Me.Distance[${Actor[Portal p5_01].Loc}]}<4
		wait 20
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,OFF]
	}
}
;End Vex Thal: Den of Shadows

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;; End of RoS Zone CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;; Start of VoV Zone CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

function VoVCheckDaily()
{
	if ${QuestJournalWindow.ActiveQuest["Basement Building: Treats for Ziggy"](exists)}
		call Quest "Basement Building: Treats for Ziggy"
	elseif ${QuestJournalWindow.ActiveQuest["Basement Building: Forlorn Furnishings"](exists)}
		call Quest "Basement Building: Forlorn Furnishings"
	elseif ${QuestJournalWindow.ActiveQuest["Basement Building: Restocking Run"](exists)}
		call Quest "Basement Building: Restocking Run"
	elseif ${QuestJournalWindow.ActiveQuest["Basement Building: Feeding Renfry"](exists)}
		call Quest "Basement Building: Feeding Renfry"
}

function VoVWeeklyTSMission()
{
	variable index:collection:string Details    
	variable iterator DetailsIterator
	variable int DetailsCounter = 0
	variable bool _FoundIt = FALSE
	variable index:string WhatToGather
;    echo "Journal Current Quest:"
;    echo "- Name: ${QuestJournalWindow.CurrentQuest.Name.GetProperty["LocalText"]}"
;    echo "- Level: ${QuestJournalWindow.CurrentQuest.Level.GetProperty["LocalText"]}"
;    echo "- Category: ${QuestJournalWindow.CurrentQuest.Category.GetProperty["LocalText"]}"
;    echo "- CurrentZone: ${QuestJournalWindow.CurrentQuest.CurrentZone.GetProperty["LocalText"]}"
;    echo "- TimeStamp: ${QuestJournalWindow.CurrentQuest.TimeStamp.GetProperty["LocalText"]}"
;    echo "- MissionGroup: ${QuestJournalWindow.CurrentQuest.MissionGroup.GetProperty["LocalText"]}"
;    echo "- Status: ${QuestJournalWindow.CurrentQuest.Status.GetProperty["LocalText"]}"
;    echo "- ExpirationTime: ${QuestJournalWindow.CurrentQuest.ExpirationTime.GetProperty["LocalText"]}"
;    echo "- Body: ${QuestJournalWindow.CurrentQuest.Body.GetProperty["LocalText"]}"
	
	QuestJournalWindow.CurrentQuest:GetDetails[Details]
	Details:GetIterator[DetailsIterator]
;    echo "- Details:"
	if (${DetailsIterator:First(exists)})
	{
		do
		{
			if (${DetailsIterator.Value.FirstKey(exists)})
			{
				do
				{
					echo "-- ${DetailsCounter}::  '${DetailsIterator.Value.CurrentKey}' => '${DetailsIterator.Value.CurrentValue}'"
					;echo \${DetailsIterator.Value.CurrentValue.Find[${_QuestStep}](exists)} // ${DetailsIterator.Value.CurrentValue}
					;if ${DetailsIterator.Value.CurrentKey.Equal[Text]} && ${DetailsIterator.Value.CurrentValue.Find[${_QuestStep}](exists)}
					;	_FoundIt:Set[TRUE]
					if ${DetailsIterator.Value.CurrentKey.Equal[Text]}
					{
						switch ${DetailsIterator.Value.CurrentValue}
						{
							case Wooden Scrap
							{
								WhatToGather:Insert[TF-27838]
								WhatQuestStep:Insert[wooden]
								break
							}
							case Gather Animated Roots
							{
								WhatToGather:Insert[TF-6905]
								WhatQuestStep:Insert[roots]
								break
							}
							case Gather Sturdy Spiderweb
							{
								WhatToGather:Insert[TF-2876]
								WhatQuestStep:Insert[spiderwebs]
								break
							}
							case Gather Twisted Bits of Metal
							{
								WhatToGather:Insert[TF-3234]
								WhatQuestStep:Insert[metal]
								break
							}
							case Gather Shredded Bits of Werewolf Fur
							{
								WhatToGather:Insert[TF-52108]
								WhatQuestStep:Insert[fur]
								break
							}
							case Gather Dirt-Encrusted Stones
							{
								WhatToGather:Insert[TF-]
								WhatQuestStep:Insert[stones]
								break
							}
							case Gather Dessicated Bones
							{
								WhatToGather:Insert[]
								WhatQuestStep:Insert[]
								break
							}
							case Gather Ectoplasmic Goo
							{
								WhatToGather:Insert[]
								WhatQuestStep:Insert[]
								break
							}
							case Gather Cocooned Critters
							{
								WhatToGather:Insert[]
								WhatQuestStep:Insert[]
								break
							}
						}
					}

				}
				while ${DetailsIterator.Value.NextKey(exists)}
			}
			DetailsCounter:Inc
		}
		while ${DetailsIterator:Next(exists)}
	}

	echo IndexSize: ${WhatToGather}

	;for
}

;Start Karuupa Jungle: Heart of Conflict

function Green()
{
	call LockAndWait -Loc "626.89,89.26,-451.45" -AllGroupWithinRange 3
	call LockAndWait -Loc "610.67,89.49,-460.70" -AllGroupWithinRange 3
	while ${Actor[Query, Name=="latching root" && Distance<10 && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
			Actor[Query, Name=-"latching root" && Distance<10]:DoTarget
		call CheckCures
		wait 1
	}
	while ${Actor[Query, Name=="a maniacal botanical" && Distance<10 && IsDead=FALSE](exists)}
	{
		call RIObj.Target "a maniacal botanical" -Distance 10
		call CheckCures
		wait 1
	}
	call LockAndWait -Loc "623.68,89.26,-450.95" -AllGroupWithinRange 3
	call LockAndWait -Loc "625.79,89.30,-438.46" -AllGroupWithinRange 3
	while ${Actor[Query, Name=="latching root" && Distance<10 && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
			Actor[Query, Name=-"latching root" && Distance<10]:DoTarget
		call CheckCures
		wait 1
	}
	while ${Actor[Query, Name=="a maniacal botanical" && Distance<10 && IsDead=FALSE](exists)}
	{
		call RIObj.Target "a maniacal botanical" -Distance 10
		call CheckCures
		wait 1
	}
	call LockAndWait -Loc "633.84,91.41,-413.0" -AllGroupWithinRange 3
	call LockAndWait -Loc "600.26,88.64,-390.1" -AllGroupWithinRange 3
	while ${Actor[Query, Name=="latching root" && Distance<10 && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
			Actor[Query, Name=-"latching root" && Distance<10]:DoTarget
		call CheckCures
		wait 1
	}
	while ${Actor[Query, Name=="a maniacal botanical" && Distance<10 && IsDead=FALSE](exists)}
	{
		call RIObj.Target "a maniacal botanical" -Distance 10
		call CheckCures
		wait 1
	}
	call LockAndWait -Loc "584.43,87.67,-374.1" -AllGroupWithinRange 3
	while ${Actor[Query, Name=="latching root" && Distance<10 && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
			Actor[Query, Name=-"latching root" && Distance<10]:DoTarget
		call CheckCures
		wait 1
	}
	while ${Actor[Query, Name=="a maniacal botanical" && Distance<10 && IsDead=FALSE](exists)}
	{
		call RIObj.Target "a maniacal botanical" -Distance 10
		call CheckCures
		wait 1
	}
	call LockAndWait -Loc "563.70,86.98,-364.53" -AllGroupWithinRange 3
	while ${Actor[Query, Name=="latching root" && Distance<10 && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
			Actor[Query, Name=-"latching root" && Distance<10]:DoTarget
		call CheckCures
		wait 1
	}
	while ${Actor[Query, Name=="a maniacal botanical" && Distance<10 && IsDead=FALSE](exists)}
	{
		call RIObj.Target "a maniacal botanical" -Distance 10
		call CheckCures
		wait 1
	}
	call LockAndWait -Loc "534.33,86.63,-352.33" -AllGroupWithinRange 3
	while ${Actor[Query, Name=="latching root" && Distance<10 && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
			Actor[Query, Name=-"latching root" && Distance<10]:DoTarget
		call CheckCures
		wait 1
	}
	while ${Actor[Query, Name=="a maniacal botanical" && Distance<10 && IsDead=FALSE](exists)}
	{
		call RIObj.Target "a maniacal botanical" -Distance 10
		call CheckCures
		wait 1
	}
	call LockAndWait -Loc "540.79,89.27,-375.51" -AllGroupWithinRange 3
	while ${Actor[Query, Name=="latching root" && Distance<10 && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
			Actor[Query, Name=-"latching root" && Distance<10]:DoTarget
		call CheckCures
		wait 1
	}
	while ${Actor[Query, Name=="a maniacal botanical" && Distance<10 && IsDead=FALSE](exists)}
	{
		call RIObj.Target "a maniacal botanical" -Distance 10
		call CheckCures
		wait 1
	}
	call LockAndWait -Loc "520.38,89.30,-383.68" -AllGroupWithinRange 3
	while ${Actor[Query, Name=="latching root" && Distance<10 && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
			Actor[Query, Name=-"latching root" && Distance<10]:DoTarget
		call CheckCures
		wait 1
	}
	while ${Actor[Query, Name=="a maniacal botanical" && Distance<10 && IsDead=FALSE](exists)}
	{
		call RIObj.Target "a maniacal botanical" -Distance 10
		call CheckCures
		wait 1
	}
	call LockAndWait -Loc "530.96,89.30,-405.12" -AllGroupWithinRange 3
	call LockAndWait -Loc "543.80,89.30,-420.62" -AllGroupWithinRange 3
	while ${Actor[Query, Name=="latching root" && Distance<10 && IsDead=FALSE](exists)}
	{
		if !${RI_Var_Bool_GlobalOthers}
			Actor[Query, Name=-"latching root" && Distance<10]:DoTarget
		call CheckCures
		wait 1
	}
	while ${Actor[Query, Name=="a maniacal botanical" && Distance<10 && IsDead=FALSE](exists)}
	{
		call RIObj.Target "a maniacal botanical" -Distance 10
		call CheckCures
		wait 1
	}
	call CustomNamed "Mean Green-NMB" "543.80,89.30,-420.62" NONE floraform
}
function Agrodemus()
{
	call CustomNamed "Agrodemus-INC" "638.08,65.77,-213.00" NONE glitterdrake Sumedorga
}
function Nakka()
{
	call CustomNamed "Nakka Nakka" "635.41,60.47,-57.83" NakkaCustom
}
function NakkaCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
	;569 Solid Ground
	if ${RIMUIObj.MainIconIDExists[${_NamedID},569]}
	{
		wait 300 ${Actor[Query, Name=="" && Overlay=="design_boiling_disease_warning"].ID}>0
		variable int _BubblesID
		_BubblesID:Set[${Actor[Query, Name=="" && Overlay=="design_boiling_disease_warning"].ID}]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${RIMUIObj.3rdPointLine[${Actor[id,${_NamedID}].X},${Actor[id,${_NamedID}].Z},${Actor[id,${_BubblesID}].X},${Actor[id,${_BubblesID}].Z},9].Token[1,"\,"]},${Me.Y},${RIMUIObj.3rdPointLine[${Actor[id,${_NamedID}].X},${Actor[id,${_NamedID}].Z},${Actor[id,${_BubblesID}].X},${Actor[id,${_BubblesID}].Z},9].Token[2,"\,"]}]
	}
	else
		RIMUIObj:SetLockSpot[ALL,635.41,60.47,-57.83]
}
function Dk()
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	call VoVHCDK
}
function VoVHCDK()
{
	if ${Zone.Name.Find[Solo]}
	{
		call LockAndWait -Loc "273.12,44.94,33.54" -RelayToGroup
		call LockAndWait -Loc "270.66,43.98,23.68" -RelayToGroup
		call LockAndWait -Loc "268.26,45.67,14.08" -RelayToGroup
		call LockAndWait -Loc "265.28,47.26,4.58" -RelayToGroup
		call LockAndWait -Loc "262.73,48.11,-5.13" -RelayToGroup
		call LockAndWait -Loc "262.28,48.02,-7.20" -RelayToGroup
		wait 50
		CustomLoc:Set["0 0 0"]
		call ClickActor "boss 4 event bypass portal"
	}
	else
	{
		RI_CMD_PauseCombatBots 1
		StopForCombat:Set[FALSE]
		RIMUIObj:StopMove[ALL]
		wait 1
		RIMUIObj:ComeOn[${Me.Name}]
		call LockAndWaitDK "271.21,48.77,-11.12"
		call LockAndWaitDK "287.20,48.65,-40.92"
		while ${Actor[Query, Name=="boss 4 hammer clicky" && Distance<5](exists)}
		{
			Actor[Query, Name=="boss 4 hammer clicky" && Distance<5]:DoubleClick
			wait 1
		}
		call LockAndWaitDK "290.19,48.65,-37.49"
		call LockAndWaitDK "294.86,48.65,-33.72"
		call LockAndWaitDK "299.48,48.65,-29.43"
		call LockAndWaitDK "302.93,48.65,-25.90"
		call LockAndWaitDK "303.39,48.67,-21.77"
		call LockAndWaitDK "304.11,48.75,-17.05"
		call LockAndWaitDK "314.12,51.07,-10.10"
		call LockAndWaitDK "322.07,54.01,-4.69"
		call LockAndWaitDK "329.72,55.31,0.52"
		call LockAndWaitDK "335.04,55.76,4.14"
		while ${Actor[Query, Name=="boss 4 hammer clicky" && Distance<5](exists)}
		{
			Actor[Query, Name=="boss 4 hammer clicky" && Distance<5]:DoubleClick
			wait 1
		}
		call LockAndWaitDK "335.31,55.62,-6.14"
 		call LockAndWaitDK "336.56,55.76,-15.69"
 		call LockAndWaitDK "337.20,57.31,-20.60"
		call LockAndWaitDK "337.65,59.20,-24.06"
		call LockAndWaitDK "336.55,65.08,-33.14"
		call LockAndWaitDK "335.55,70.41,-42.16"
		call LockAndWaitDK "335.16,72.74,-45.86"
		call LockAndWaitDK "334.68,75.68,-49.97"
		call LockAndWaitDK "333.71,79.09,-55.24"
		call LockAndWaitDK "332.94,81.16,-59.15"
		call LockAndWaitDK "338.18,81.77,-62.01"
		call LockAndWaitDK "342.58,82.63,-64.26"
		call LockAndWaitDK "346.54,83.72,-66.33"
		while ${Actor[Query, Name=="boss 4 hammer clicky" && Distance<5](exists)}
		{
			Actor[Query, Name=="boss 4 hammer clicky" && Distance<5]:DoubleClick
			wait 1
		}
		call LockAndWaitDK "349.33,84.49,-67.31"
		call LockAndWaitDK "352.34,85.44,-68.29"
		call LockAndWaitDK "358.13,84.12,-60.57"
		call LockAndWaitDK "363.07,85.74,-54.10"
		call LockAndWaitDK "365.40,87.08,-51.05"
		call LockAndWaitDK "366.94,88.00,-49.04"
		call LockAndWaitDK "371.52,89.45,-48.73"
		call LockAndWaitDK "374.97,90.49,-48.54"
		call LockAndWaitDK "379.33,91.77,-48.27"
		call LockAndWaitDK "383.26,92.83,-48.02"
		call LockAndWaitDK "387.20,93.82,-47.77"
		call LockAndWaitDK "392.04,94.91,-47.46"
		while ${Actor[Query, Name=="boss 4 hammer clicky" && Distance<5](exists)}
		{
			Actor[Query, Name=="boss 4 hammer clicky" && Distance<5]:DoubleClick
			wait 1
		}
		call LockAndWaitDK "391.33,95.03,-54.37"
		call LockAndWaitDK "390.91,96.42,-58.81"
		call LockAndWaitDK "390.63,97.81,-61.88"
		call LockAndWaitDK "390.34,99.17,-64.94"
		call LockAndWaitDK "388.65,101.31,-70.21"
		call LockAndWaitDK "387.01,104.18,-75.57"
		call LockAndWaitDK "385.43,106.79,-80.71"
		call LockAndWaitDK "383.72,109.53,-86.29"
		call LockAndWaitDK "382.72,111.84,-90.91"
		call LockAndWaitDK "381.65,113.92,-95.67"
		call LockAndWaitDK "380.63,115.28,-100.23"
		call LockAndWaitDK "379.52,116.03,-105.04"
		RI_CMD_PauseCombatBots 0
	}
}
function LockAndWaitDK(string _Loc, bool _Checkgoon=TRUE)
{
	wait 1
	;echo lawdk ${_Loc}
	variable string _tempLoc
	while ${Me.Distance[${_Loc}]}>4
	{
		;echo in while
		RIMUIObj:SetLockSpot[${Me.Name},${_Loc},2]
		if ${Actor[goon].Distance}<7 && ${RIMUIObj.MaintainedEffectExists[Megaton Mallet Time!]} && ${_Checkgoon}
		{
			_tempLoc:Set[${Me.Loc}]
			while ${Actor[Query, Name=-"goon" && Distance<7 && IsDead=FALSE](exists)} && ${RIMUIObj.MaintainedEffectExists[Megaton Mallet Time!]}
			{
				;echo in while 2
				RIMUIObj:SetLockSpot[${Me.Name},${Actor[Query, Name=-"goon" && Distance<7 && IsDead=FALSE].Loc}]
				wait 1
			}
			RIMUIObj:SetLockSpot[${Me.Name},${_tempLoc}]
			wait 300 ${Me.Distance[${_tempLoc}]}<3
			RIMUIObj:SetLockSpot[${Me.Name},${_Loc},1]
			wait 300 ${Me.Distance[${_Loc}]}<=1
		}
		wait 1
	}
	;echo end lawdk
}
function Gharaka()
{
	call CustomNamed "Gharaka" "387.92,115.98,-104.49" 
}
function Ugweepai()
{
	declarevariable RI_Var_Ugweepai_Target int global ${Actor[Ugweepai].ID}
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["can now be damaged"]
	while !${Actor[Ugweepai].IsAggro}
	{
		Actor[Ugweepai]:DoubleClick
		wait 1
	}
	call CustomNamed "Ugweepai-INC-NMB" "472.66,164.52,-162.76" UgweepaiCustom
	IncomingText:Clear
	IncomingText2:Clear
	deletevariable RI_Var_Ugweepai_Target
}
function UgweepaiCustom(int _NamedID)
{
	call RIObj.Target ${RI_Var_Ugweepai_Target} ${_NamedID}
	if ${Trigger}
	{
		if ${TriggerMessage.Find[Veranir]}
		{
			RI_Var_Ugweepai_Target:Set[${Actor[Query, Name=="Veranir" && IsDead=FALSE].ID}]
		}
		elseif ${TriggerMessage.Find[Ceron]}
		{
			RI_Var_Ugweepai_Target:Set[${Actor[Query, Name=="Ceron" && IsDead=FALSE].ID}]
		}
		elseif ${TriggerMessage.Find[Heshwani]}
		{
			RI_Var_Ugweepai_Target:Set[${Actor[Query, Name=="Heshwani" && IsDead=FALSE].ID}]
		}
		Trigger:Set[0]
	}
}

;Start Karuupa Jungle: Dedraka's Descent

function Zaag()
{
	call CustomNamed "Zaag the Unburied" "-343.14,105.34,-621.42" ZaagCustom
}
function ZaagCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	call RIObj.Target cadaverous -Distance 25 revenant -Distance 25 ${_NamedID}
	if ${Actor[id,${_NamedID}].Distance}>10
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_NamedID}].Loc},7,1000]
	}
}
function Scarfeather()
{
	call CustomNamed "Scarfeather" "-443.69,102.47,-471.79" ScarfeatherCustom
}
function ScarfeatherCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	;Aura=design_boiling_water_warning
	;864 Scar-Hardened Hide
	if ${Actor[id,${_NamedID}].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},864]}].CurrentIncrements}>50
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${RIMUIObj.3rdPointLine[${Me.X},${Me.Z},${Actor[Query, Name=="" && Aura=="design_boiling_water_warning"].X},${Actor[Query, Name=="" && Aura=="design_boiling_water_warning"].Z},10].Token[1,"\,"]},${Me.Y},${RIMUIObj.3rdPointLine[${Me.X},${Me.Z},${Actor[Query, Name=="" && Aura=="design_boiling_water_warning"].X},${Actor[Query, Name=="" && Aura=="design_boiling_water_warning"].Z},10].Token[2,"\,"]},2]
		while ${Actor[id,${_NamedID}].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},864]}].CurrentIncrements}>50
			wait 1
	}
}
function Krelburn()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert[underground]
	call CustomNamed "Krelburn" "-485.30,125.78,-286.39" KrelburnCustom
	IncomingText:Clear
	IncomingText2:Clear
}
function KrelburnCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	call RIObj.Target ${_NamedID}
	if ${Trigger}
	{
		if ${Me.Distance[-485.30,125.78,-286.39]}<5
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-485.84,125.09,-276.67]
		else
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-485.30,125.78,-286.39]
		Trigger:Set[0]
	}
}
function Cannibrea()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["is about to unleash a deadly attack"]
	IncomingText:Insert["spreads her wings"]
	;while !${Me.Maintained[Pteranodons of a Feather](exists)}
	;{
	;	if ${Me.CastingSpell} && ${Me.GetGameData[Spells.Casting].Label.Equal[]}
	;		noop
	;	else
	;		Me.Inventory[pristine pteranodon feather]:Use
	;	wait 5 ${Me.Maintained[Pteranodons of a Feather](exists)}
	;}
	RI_Var_Bool_SkipLoot:Set[1]
	call CustomNamed "Cannibrea-NMB" "-612.08,178.51,-99.12" CannibreaCustom
	IncomingText:Clear
	IncomingText2:Clear
	RI_Var_Bool_SkipLoot:Set[0]
}
function CannibreaCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	call RIObj.Target hatchling -Distance 20 pirate -Distance 10 ${_NamedID}
	if ${Trigger}
	{
		variable int _failcnt
		call RIObj.Target ${_NamedID}
		_failcnt:Set[1]
		while ${Actor[Query, ID=${_NamedID} && IsDead=FALSE](exists)} && ${_failcnt:Inc}<100 && !${Me.GetGameData[Target.Casting].Label.Equal[Pummeling Plumage]} && !${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[Pummeling Plumage]}
		{
			call RIObj.Target ${_NamedID}
			wait 1
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-620.29,182.34,-90.45]
		_failcnt:Set[1]
		while ${Actor[Query, ID=${_NamedID} && IsDead=FALSE](exists)} && ${_failcnt:Inc}<100 && ${Me.GetGameData[Target.Casting].Label.Equal[Pummeling Plumage]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[Pummeling Plumage]}
		{
			call RIObj.Target ${_NamedID}
			wait 1
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-612.08,178.51,-99.12]
		Trigger:Set[0]
	}
}
function Gromekus()
{
	call CustomNamed "Elder Gromekus-INC" "-595.67,86.39,85.86" NONE Olipna Ponshudu
}
;End Karuupa Jungle: Dedraka's Descent

;Start Mahngavi Wastes: Phantasmal Shades

function Bartus()
{
	call CustomNamed "Bartus Morrand" "426.89,28.46,-350.84" NONE spectral wispling
}

function Muhg()
{
	call CustomNamed "Soul Eater Muhg" "250.83,24.80,-252.79" NONE friend ireful
}

function Dremaera()
{
	call CustomNamed "Dremaera Forsaken" "52.22,33.05,-316.82" NONE torrmented torment wispling
}

function Gorok()
{
	call CustomNamed "Rune Protector Gorok" "-252.64,31.45,-788.23" NONE runic destroyer 
}

function Esmerelda()
{
	call CustomNamed "Esmerelda Everghast-NMB" "-613.32,16.37,-376.33" EsmereldaCustom
}
function EsmereldaCustom(int _NamedID)
{
	call RIObj.Target summoned -Distance 20 angry -Distance 20 ${_NamedID}
	if ${Me.Y}>50 && ( ${Me.Distance[-613.32,16.37,-376.33]}>10 || ${Me.Distance[-623.27,16.37,-356.48]}>10 )
	{
		if ${Me.Distance[-613.32,16.37,-376.33]}<${Me.Distance[-623.27,16.37,-356.48]}
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-613.32,16.37,-376.33]
		}
		else
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-623.27,16.37,-356.48]
		}
	}
}
;End Mahngavi Wastes: Phantasmal Shades

;Start Castle Vacrul: Rosy Reverie

function Kartur()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert[notices a missing]
	call CustomNamed "Kartur" "-38.86,-0.80,51.60" KarturCustom
	IncomingText:Clear
	IncomingText2:Clear
}
function KarturCustom(int _NamedID)
{
	call RIObj.Target footman -Distance 20 ${_NamedID}
	if ${Trigger}
	{
		variable string _Item
		Trigger:Set[0]
		_Item:Set["${TriggerMessage.Right[${Math.Calc[(${TriggerMessage.Find[notices a missing]}+17)*-1]}].Left[-1]}"]
		;echo \"${_Item}\"
		if ${Me.Inventory[${_Item}](exists)}
		{
			wait 300 ${Me.Distance[-38.86,-0.80,51.60]}<3
			RIMUIObj:SetLockSpot[ALL,${Actor[boss 1 artifact placement - ${_Item}].Loc},3]
			wait 300 ${Me.Distance[${Actor[boss 1 artifact placement - ${_Item}].Loc}]}<4
			wait 300 ${Actor[boss 1 artifact placement - ${_Item}].Interactable}
			while ${Actor[boss 1 artifact placement - ${_Item}].Interactable} && ${Actor[Query, ID=${_NamedID} && IsDead=FALSE](exists)}
			{
				;echo Actor[boss 1 artifact placement - ${_Item}]:DoubleClick // ${Actor[boss 1 artifact placement - ${_Item}].Interactable}
				Actor[boss 1 artifact placement - ${_Item}]:DoubleClick
				wait 2
			}
			RIMUIObj:SetLockSpot[ALL,-38.86,-0.80,51.60]
		}
	}
}
function Rilayne()
{
	Actor[Rilayne]:DoTarget
	wait 150 ${Actor[Rilayne].Distance}<10
	call LockAndWait -Loc "70.73,-0.75,-8.83"
	call CustomNamed "T'valla Rilayne" "45.88,-0.76,-8.27" RilayneCustom
}
function RilayneCustom(int _NamedID)
{
	if ${Actor[Query, Name=="bloodrose bouquet" && Distance<=12 && IsDead=FALSE](exists)} && ${RIMUIObj.MainIconIDExists[${Me.ID},476]}>0
	{
		Actor[Query, Name=="bloodrose bouquet" && Distance<=12 && IsDead=FALSE]:DoTarget
		return
	}
	else
	{
		if ${RIObj.CountAllAggroActors}>1
		{
			variable index:actor ActorIndex
			variable iterator ActorIterator
			variable int BalanceMobWithHighestHealth=0
			
			if ${Actor[Query, Name=="bloodrose bouquet" && Distance<=12 && IsDead=FALSE](exists)} && ${RIMUIObj.MainIconIDExists[${Me.ID},476]}>0
			{
				Actor[Query, Name=="bloodrose bouquet" && Distance<=12 && IsDead=FALSE]:DoTarget
				return
			}
			
			;QueryActors to our ActorIndex that are NPC or NamedNPC and within distance 20 and InCombatMode and NotDead
			EQ2:QueryActors[ActorIndex, Type =="NPC" && InCombatMode = TRUE && IsDead = FALSE && Distance <= 20]
				
			ActorIndex:GetIterator[ActorIterator]
			
			;echo ${ActorIndex.Used}
			if ${ActorIterator:First(exists)}
			{
				do
				{
					;if the actor's health is higher than BalanceMobWithHighestHealth
					;set them to BalanceMobWithHighestHealth
					if ${ActorIterator.Value.Health}>${Math.Calc[${Actor[${BalanceMobWithHighestHealth}].Health}+${BalanceNum}]}
						BalanceMobWithHighestHealth:Set[${ActorIterator.Value.ID}]
				}
				while ${ActorIterator:Next(exists)}
				;if i am not targeting BalanceMobWithHighestHealth and it is not 0 and exists
				;target BalanceMobWithHighestHealth
				if ${Target.ID}!=${BalanceMobWithHighestHealth} && ${BalanceMobWithHighestHealth}!=0 && ${Actor[${BalanceMobWithHighestHealth}](exists)} && !${Actor[${BalanceMobWithHighestHealth}].IsDead} && ${Script.RunningTime}>${Math.Calc[${ScriptTargetTime}+${WaitTime}]}
				{
					;echo ${Time}: Targeting ${BalanceMobWithHighestHealth} / ${Actor[${BalanceMobWithHighestHealth}]} Health: ${Actor[${BalanceMobWithHighestHealth}].Health}
					Actor[${BalanceMobWithHighestHealth}]:DoTarget
					ScriptTargetTime:Set[${Script.RunningTime}]
				}
			}
		}
		else
			call RIObj.Target ${_NamedID}
	}
}

function Vhenex()
{
	call CustomNamed "Vhenex the Werefather" "108.01,-15.46,94.42" NONE Herex Shen
}
function RosySpawnKing()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["Where'd you learn to play chess"]
	IncomingText:Insert["Wrong move"]
	IncomingText:Insert["CHECKMATE"]
	CustomLoc:Set["0 0 0"]
	variable int _failcnt=0
	while !${TriggerMessage.Find["CHECKMATE"]} && ${_failcnt:Inc}<=10
	{
		Trigger:Set[0]
		call LockAndWait -Loc "157.56,-15.28,80.66" -RelayToGroup -AllGroupWithinRange 3
		call ClickActor -Actor "chess black rook 1" -NoRelayToGroup
		call LockAndWait -Loc "159.26,-15.28,112.32" -RelayToGroup -AllGroupWithinRange 3
		wait 10
		call PlaceHouseItem 180
		call PlaceHouseItem 180
		wait 50
		if ${Trigger}
			continue
		call LockAndWait -Loc "150.48,-15.28,88.81" -RelayToGroup -AllGroupWithinRange 3
		wait 300 ${Actor[chess black bishop 1].Interactable}
		call ClickActor -Actor "chess black bishop 1" -NoRelayToGroup
		call LockAndWait -Loc "162.27,-15.28,99.85" -RelayToGroup -AllGroupWithinRange 3
		wait 10
		call PlaceHouseItem 218
		call PlaceHouseItem 218
		wait 50
		if ${Trigger}
			continue
		call LockAndWait -Loc "145.37,-15.28,104.59" -RelayToGroup -AllGroupWithinRange 3
		wait 300 ${Actor[chess black queen].Interactable}
		call ClickActor -Actor "chess black queen" -NoRelayToGroup
		call LockAndWait -Loc "149.54,-15.28,108.21" -RelayToGroup -AllGroupWithinRange 3
		wait 10
		call PlaceHouseItem 180
		call PlaceHouseItem 180
		wait 50
		Trigger:Set[0]
	}
	Trigger:Set[0]
	if !${TriggerMessage.Find["CHECKMATE"]}
	{
		call MessageBox "We failed the chess game after 10 tries. finish the game and spawn king then resume"
	}
}
function King()
{
	RIMUIObj:SetLockSpot[ALL,154.31,-15.28,106.58]
	wait 50
	RIMUIObj:SetLockSpot[ALL,149.55,-15.28,106.43]
	waitframe
	call CustomNamed "The Black King-NLP" "149.55,-15.28,106.43" NONE bishop pawn rook Queen
}

function Thornblood()
{
	call CustomNamed "Thornblood-INC" "286.88,-14.31,95.82" ThornbloodCustom
}
function ThornbloodCustom(int _NamedID)
{
	if ${Actor[id,${_NamedID}](exists)}
	{
		call RIObj.Target ${_NamedID}
	}
	else
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Roseblood].Loc},5,1000]
		call RIObj.Target Roseblood
	}
}

;End Castle Vacrul: Rosy Reverie
 
;Start Castle Vacrul: Caverns of the Forsaken

function Sypheria()
{
	RI_Obj_CB:DoNotCastEncounter[TRUE]
	RI_Obj_CB:DoNotCastAE[TRUE]
	call RIObj.SingularFocus 1
	call CustomNamed "Sypheria the Shackled-NLP-NMB" "-118.86,-73.26,265.16" SypheriaCustom
	RI_Obj_CB:DoNotCastEncounter[FALSE]
	RI_Obj_CB:DoNotCastAE[FALSE]
	call RIObj.SingularFocus 0
}
function SypheriaCustom(int _NamedID)
{
	if ${Actor[id,${_NamedID}].Distance}>7 && !${RI_Var_Bool_GlobalOthers}
	{
		variable index:string _Locs
		variable int _i
		variable int _ClosestDistance
		variable int _ClosestLoc
		variable int _ClosestNamedLoc
		
		_Locs:Insert["-118.86,-73.26,265.16"]
		_Locs:Insert["-124.34,-73.26,252.53"]
		_Locs:Insert["-136.82,-73.26,247.49"]
		_Locs:Insert["-149.27,-73.26,252.80"]
		_Locs:Insert["-154.57,-73.26,264.55"]
		_Locs:Insert["-149.44,-73.26,277.50"]
		_Locs:Insert["-137.13,-73.26,282.88"]
		_Locs:Insert["-124.56,-73.26,277.68"]
		
		;first determine which loc i am at
		_ClosestDistance:Set[10000000]
		for(_i:Set[1];${_i}<=${_Locs.Used};_i:Inc)
		{
			;echo ${_Locs.Get[${_i}]}: ${Me.Distance[${_Locs.Get[${_i}]}]}<${_ClosestDistance}
			if ${Me.Distance[${_Locs.Get[${_i}]}]}<${_ClosestDistance}
			{
				;echo setting
				_ClosestDistance:Set[${Me.Distance[${_Locs.Get[${_i}]}]}]
				_ClosestLoc:Set[${_i}]
			}
		}
			;now determine which loc the named is at
		_ClosestDistance:Set[10000000]
		for(_i:Set[1];${_i}<=${_Locs.Used};_i:Inc)
		{
			if ${Math.Distance[${_Locs.Get[${_i}]},${Actor[Query, ID=${_NamedID}].Loc}]}<${_ClosestDistance}
			{
				_ClosestDistance:Set[${Math.Distance[${_Locs.Get[${_i}]},${Actor[Query, ID=${_NamedID}].Loc}]}]
				_ClosestNamedLoc:Set[${_i}]
			}
		}
		;echo ${_ClosestLoc}
		;echo ${_ClosestNamedLoc}
		if ${_ClosestLoc}>${_ClosestNamedLoc}
		{
			;echo dec
			for(_i:Set[${_ClosestLoc}];${_i}>=${_ClosestNamedLoc};_i:Dec)
			{
				;echo dec for ${_i}
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Locs.Get[${_i}]},1,1000]
				wait 300 ${Me.Distance[${_Locs.Get[${_i}]}]}<3
				wait 300 ${RIMObj.AllGroupWithinRange[5]}
			}
		}
		else
		{
			;echo inc
			for(_i:Set[${_ClosestLoc}];${_i}<=${_ClosestNamedLoc};_i:Inc)
			{
				;echo inc for ${_i}
				relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${_Locs.Get[${_i}]},1,1000]
				wait 300 ${Me.Distance[${_Locs.Get[${_i}]}]}<3
				wait 300 ${RIMObj.AllGroupWithinRange[5]}
			}
		}
	}
	;Bloodlinked Chains 828
	if ${Actor[id,${_NamedID}].Distance}<=7
		call RIObj.Dispell ${_NamedID} 828
	call RIObj.Target ${_NamedID}
}
function Skelegore()
{
	call CustomNamed "Skelegore the Regurgitated-NMB" "-287.12,-82.32,216.06" SkelegoreCustom Bonewretch
}
function SkelegoreCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	
	call RIObj.Target Bonewretch ${_NamedID}
	
	if ${Me.Distance[-257.19,-82.98,246.68]}<5 || ${Me.Distance[-275.68,-82.98,173.68]}<5 || ${Me.Distance[-328.76,-82.98,227.18]}<5
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Loc},19]
		wait 1
		RIMUIObj:SetLockSpot[${Me.Name},-287.12,-82.32,216.06]
	}
	elseif ${Me.Group[1].Distance[-257.19,-82.98,246.68]}<5 || ${Me.Group[1].Distance[-275.68,-82.98,173.68]}<5 || ${Me.Group[1].Distance[-328.76,-82.98,227.18]}<5
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Group[1].Loc},19]
		wait 1
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[1].Name},-287.12,-82.32,216.06]
	}
	elseif ${Me.Group[2].Distance[-257.19,-82.98,246.68]}<5 || ${Me.Group[2].Distance[-275.68,-82.98,173.68]}<5 || ${Me.Group[2].Distance[-328.76,-82.98,227.18]}<5
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Group[2].Loc},19]
		wait 1
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[2].Name},-287.12,-82.32,216.06]
	}
	elseif ${Me.Group[3].Distance[-257.19,-82.98,246.68]}<5 || ${Me.Group[3].Distance[-275.68,-82.98,173.68]}<5 || ${Me.Group[3].Distance[-328.76,-82.98,227.18]}<5
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Group[3].Loc},19]
		wait 1
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[3].Name},-287.12,-82.32,216.06]
	}
	elseif ${Me.Group[4].Distance[-257.19,-82.98,246.68]}<5 || ${Me.Group[4].Distance[-275.68,-82.98,173.68]}<5 || ${Me.Group[4].Distance[-328.76,-82.98,227.18]}<5
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Group[4].Loc},19]
		wait 1
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[4].Name},-287.12,-82.32,216.06]
	}
	elseif ${Me.Group[5].Distance[-257.19,-82.98,246.68]}<5 || ${Me.Group[5].Distance[-275.68,-82.98,173.68]}<5 || ${Me.Group[5].Distance[-328.76,-82.98,227.18]}<5
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Me.Group[5].Loc},19]
		wait 1
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[${Me.Group[5].Name},-287.12,-82.32,216.06]
	}
	else
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-287.12,-82.32,216.06]
	}
}
function Mazza()
{
	call CustomNamed "Mazza Zanzeer" "11.95,-15.39,173.78" NONE Porzo
}

function Lysander()
{
	wait 600 ${Actor[Lysander Mistmoore].IsAggro}
	call CustomNamed "Lysander Mistmoore" "-106.37,-45.46,-0.35" NONE mistmyrmidon
}

function Vorigan()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["What goes up"]
	IncomingText:Insert["Up up"]
	IncomingText:Insert["Will just have to feed on others"]
	while !${Actor[Vorigan Mistmoore].IsAggro}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Vorigan Mistmoore].Loc},3,1000]
		if ${Actor[Vorigan Mistmoore].Distance}<5
			Actor[Vorigan Mistmoore]:DoubleClick
		wait 1
	}
	call CustomNamed "Vorigan Mistmoore" "-210.04,-62.31,-164.72" VoriganCustom
	IncomingText:Clear
	IncomingText2:Clear
}
;need to code this to go in the pool and then jump out literally jump
function VoriganCustom(int _NamedID)
{
	call RIObj.Target rotting -Distance 20 ${_NamedID}
	if ${Zone.Name.Find[Solo]} && ( ${Trigger} || (${Me.GetGameData[Target.Casting].Label.Equal[Vampiric Hemorrhage]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal[Vampiric Hemorrhage]}) )
	{
		Trigger:Set[0]
		if ${Actor[id,${_NamedID}].Distance[-194.89,-56.34,-219.84]}<${Actor[id,${_NamedID}].Distance[-190.75,-62.30,-151.05]}
			RIMUIObj:SetLockSpot[ALL,-190.75,-62.30,-151.05]
		else
			RIMUIObj:SetLockSpot[ALL,-194.89,-56.34,-219.84]
		wait 30
	}
	elseif ${Actor[Query, Name=="vampiric boil" && Aura=="result_blood_essence_dead"](exists)}
	{
		RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="vampiric boil" && Aura=="result_blood_essence_dead"].Loc}]
	}
	else
	{
		RIMUIObj:SetLockSpot[ALL,-210.04,-62.31,-164.72]
		wait 20
		if ${Me.Archetype.Equal[scout]}
			RIMUIObj:SetLockSpot[OFF]
	}
}

;End Castle Vacrul: Caverns of the Forsaken

;Start Castle Vacrul: Throne of the Ydal

function Zabrina()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["taunts you as she eyes the sigil"]
	IncomingText:Insert["is obviously lying as she eyes the"]
	call CustomNamed "Zabrina Selymes" "43.19,-50.12,235.53" ZabrinaCustom
	IncomingText:Clear
	IncomingText2:Clear
}
function ZabrinaCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	call RIObj.Target ${_NamedID}
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_NamedID}].Loc},2]
	;0=North
	;90=East
	;180=South
	;270=West
	if ${Trigger}
	{
		if ${Actor[id,${_NamedID}].Distance}>3
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_NamedID}].Loc},2]
			wait 300 ${Actor[id,${_NamedID}].Distance}<3
			wait 20
		}
		
		Trigger:Set[0]
		variable string _Direction
		variable int _FaceNum
		variable string _MyLoc
		if ${TriggerMessage.Find[taunts you as she eyes the sigil]}
			_Direction:Set["${TriggerMessage.Right[${Math.Calc[(${TriggerMessage.Find[es the sigil to the]}+19)*-1]}].Left[-1]}"]
		else
			_Direction:Set["${TriggerMessage.Right[${Math.Calc[(${TriggerMessage.Find[ing as she eyes the]}+19)*-1]}].Left[-7]}"]
		;echo ${_Direction}
		switch ${_Direction}
		{
			case north
			{
				_FaceNum:Set[0]
				break
			}
			case northeast
			{
				_FaceNum:Set[45]
				break
			}
			case northwest
			{
				_FaceNum:Set[315]
				break
			}
			case east
			{
				_FaceNum:Set[90]
				break
			}
			case south
			{
				_FaceNum:Set[180]
				break
			}
			case southeast
			{
				_FaceNum:Set[135]
				break
			}
			case southwest
			{
				_FaceNum:Set[225]
				break
			}
			case west
			{
				_FaceNum:Set[270]
				break
			}
		}
		RIMUIObj:SetLockSpot[ALL,OFF]
		;now face that direction and move 7m
		_MyLoc:Set["${Me.Loc}"]
		while ${Me.Distance[${_MyLoc}]}<7
		{
			Me:DoTarget
			face ${_FaceNum}
			press -hold ${RI_Var_String_ForwardKey}
			waitframe
		}
		press -release ${RI_Var_String_ForwardKey}
		while ${Actor[Query, Name=-"a restraining sigil" && Distance<=5](exists)}
		{
			;echo sigil
			Actor[Query, Name=-"a restraining sigil" && Distance<=5]:DoTarget
			wait 1
		}
		wait 5
	}
}


function Veldahn()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["prepares to summon"]
	declare RI_Var_VeldahnMobsVV index:string global
	call CustomNamed "Veldahn Keyven" "41.00,-50.19,368.65" VeldahnCustom
	deletevariable RI_Var_VeldahnMobsVV
	IncomingText:Clear
	IncomingText2:Clear
}
function VeldahnCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	if ${Trigger}
	{
		if ${TriggerMessage.Find[single]}
		{
			wait 300 ${Actor[Query, Name=-"a risen wretch" && IsAggro=TRUE](exists)}
			wait 20
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,58.74,-50.19,366.68]
			RI_Var_VeldahnMobsVV:Insert["${Actor[a risen wretch].VisualVariant}"]
			if ${RI_Var_Bool_Debug}
			{
				echo ${RI_Var_VeldahnMobsVV.Used}
				echo ${RI_Var_VeldahnMobsVV.Get[1]}
			}
			while ${Actor[Query, Name=="a risen wretch" && IsDead=FALSE](exists)}
			{
				Actor[Query, Name=="a risen wretch"]:DoTarget
				wait 1
			}
		}
		if ${TriggerMessage.Find[two]}
		{
			wait 300 ${Actor[Query, Name=-"a risen wretch" && IsAggro=TRUE](exists)}
			wait 20
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,58.74,-50.19,366.68]
			RI_Var_VeldahnMobsVV:Insert["${Actor[Query, Name=="a risen wretch" && VisualVariant!="${RI_Var_VeldahnMobsVV.Get[1]}"].VisualVariant}"]
			if ${RI_Var_Bool_Debug}
			{
				echo ${RI_Var_VeldahnMobsVV.Used}
				echo ${RI_Var_VeldahnMobsVV.Get[1]}
				echo ${RI_Var_VeldahnMobsVV.Get[2]}
			}
			while ${Actor[Query, Name=="a risen wretch" && IsDead=FALSE](exists)}
			{
				if ${Actor[Query, Name=="a risen wretch" && VisualVariant=="${RI_Var_VeldahnMobsVV.Get[1]}" && IsDead=FALSE](exists)}
					Actor[Query, Name=="a risen wretch" && VisualVariant=="${RI_Var_VeldahnMobsVV.Get[1]}" && IsDead=FALSE]:DoTarget
				else
					Actor[Query, Name=="a risen wretch"]:DoTarget
				wait 1
			}
		}
		if ${TriggerMessage.Find[three]}
		{
			wait 300 ${Actor[Query, Name=-"a risen wretch" && IsAggro=TRUE](exists)}
			wait 20
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,58.74,-50.19,366.68]
			RI_Var_VeldahnMobsVV:Insert["${Actor[Query, Name=="a risen wretch" && VisualVariant!="${RI_Var_VeldahnMobsVV.Get[1]}" && VisualVariant!="${RI_Var_VeldahnMobsVV.Get[2]}"].VisualVariant}"]
			if ${RI_Var_Bool_Debug}
			{
				echo ${RI_Var_VeldahnMobsVV.Used}
				echo ${RI_Var_VeldahnMobsVV.Get[1]}
				echo ${RI_Var_VeldahnMobsVV.Get[2]}
				echo ${RI_Var_VeldahnMobsVV.Get[3]}
			}
			while ${Actor[Query, Name=="a risen wretch" && IsDead=FALSE](exists)}
			{
				if ${Actor[Query, Name=="a risen wretch" && VisualVariant=="${RI_Var_VeldahnMobsVV.Get[1]}" && IsDead=FALSE](exists)}
					Actor[Query, Name=="a risen wretch" && VisualVariant=="${RI_Var_VeldahnMobsVV.Get[1]}" && IsDead=FALSE]:DoTarget
				elseif ${Actor[Query, Name=="a risen wretch" && VisualVariant=="${RI_Var_VeldahnMobsVV.Get[2]}" && IsDead=FALSE](exists)}
					Actor[Query, Name=="a risen wretch" && VisualVariant=="${RI_Var_VeldahnMobsVV.Get[2]}" && IsDead=FALSE]:DoTarget
				else
					Actor[Query, Name=="a risen wretch"]:DoTarget
				wait 1
			}
		}
		if ${TriggerMessage.Find[four]}
		{
			wait 300 ${Actor[Query, Name=-"a risen wretch" && IsAggro=TRUE](exists)}
			wait 20
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,58.74,-50.19,366.68]
			while ${Actor[Query, Name=="a risen wretch" && IsDead=FALSE](exists)}
			{
				if ${Actor[Query, Name=="a risen wretch" && VisualVariant=="${RI_Var_VeldahnMobsVV.Get[1]}" && IsDead=FALSE](exists)}
					Actor[Query, Name=="a risen wretch" && VisualVariant=="${RI_Var_VeldahnMobsVV.Get[1]}" && IsDead=FALSE]:DoTarget
				elseif ${Actor[Query, Name=="a risen wretch" && VisualVariant=="${RI_Var_VeldahnMobsVV.Get[2]}" && IsDead=FALSE](exists)}
					Actor[Query, Name=="a risen wretch" && VisualVariant=="${RI_Var_VeldahnMobsVV.Get[2]}" && IsDead=FALSE]:DoTarget
				elseif ${Actor[Query, Name=="a risen wretch" && VisualVariant=="${RI_Var_VeldahnMobsVV.Get[3]}" && IsDead=FALSE](exists)}
					Actor[Query, Name=="a risen wretch" && VisualVariant=="${RI_Var_VeldahnMobsVV.Get[3]}" && IsDead=FALSE]:DoTarget
				else
					Actor[Query, Name=="a risen wretch"]:DoTarget
				wait 1
			}
		}
		Trigger:Set[0]
	}
	RIMUIObj:SetLockSpot[ALL,41.00,-50.19,368.65]
	call RIObj.Target ${_NamedID}
}
function Mayong()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["looks toward the sanguine"]
	wait 600 ${Actor[Lord Mayong Mistmoore].IsAggro}
	Actor[Lord Mayong Mistmoore]:DoTarget
	wait 20 ${Actor[Lord Mayong Mistmoore].Target.InMyGroup}
	call CustomNamed "Lord Mayong Mistmoore" "-93.39,-57.91,493.53" MayongCustom
	IncomingText:Clear
	IncomingText2:Clear
}
function MayongCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	call RIObj.Target Vishra bloodthirsty cur -Distance 20 mistmyrmidon -Distance 20 ${_NamedID}
	if ${Trigger}
	{
		;echo trigger
		wait 300 ${Me.Health}>30
		variable int _cnt=1
		while ${_cnt:Inc}<300 && ${Me.Distance[-94.17,-60.77,478.39]}>3
		{
			RIMUIObj:SetLockSpot[ALL,-94.17,-60.77,478.39]
			wait 1
		}
		;echo after w1
		wait 50 ${Actor[Vishra].Distance}<10
		;echo after w2
		RIMUIObj:SetLockSpot[ALL,-93.39,-57.91,493.53]
		;echo after LS
		Trigger:Set[0]
		;echo end trigg
	}
	if ${Actor[Query, Name=-"a Bloodthirsty" && IsDead=FALSE](exists)}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=-"a Bloodthirsty" && IsDead=FALSE].Loc},6,1000]
	elseif ${Actor[Vishra](exists)}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-93.39,-57.91,493.53,1,1000]
	else
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-29.31,-58.12,461.36,1,1000]
}

;End Castle Vacrul: Throne of the Ydal

;Start Svarni Expanse: Carrion Crag

function Olyxa()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["Avoid getting picked off by Olyxa"]
	AbilityToInterrupt:Set["Triage"]
	RIMUIObj:SetLockSpot[ALL,-490.82,132.02,-742.09]
	call CustomNamed "High Shikari Olyxa-INC-NMB" "-490.82,132.02,-742.09" OlyxaCustom
	IncomingText:Clear
	IncomingText2:Clear
	if !${RI_Var_Bool_GlobalOthers}
	{
		if ${Me.Distance[-500.92,125.20,-750.23]}<20
		{
			call LockAndWait -Loc "-500.92,125.20,-750.23" -RelayToGroup
			call LockAndWait -Loc "-468.00,127.22,-754.99" -RelayToGroup
			call LockAndWait -Loc "-428.03,131.29,-760.33" -RelayToGroup
		}
		elseif ${Me.Distance[-468.00,127.22,-754.99]}<20
		{
			call LockAndWait -Loc "-468.00,127.22,-754.99" -RelayToGroup
			call LockAndWait -Loc "-428.03,131.29,-760.33" -RelayToGroup
		}
		elseif ${Me.Distance[-428.03,131.29,-760.33]}<20
		{
			call LockAndWait -Loc "-428.03,131.29,-760.33" -RelayToGroup
		}
	}
}
function OlyxaCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	call RIObj.Target ${_NamedID}
	if ${Me.GetGameData[Target.Casting].Label.Equal["${AbilityToInterrupt}"]} || ${Me.GetGameData[ImpliedTarget.Casting].Label.Equal["${AbilityToInterrupt}"]}
	{
		f ${RI_Var_Bool_Debug}
			echo ${Time}: Detected interrupt ability: ${AbilityToInterrupt} casting 
		call SetInterruptSpell
		call Interrupt
	}
	if ${Trigger}
	{
		Trigger:Set[0]
		if ${Me.Distance[-490.82,132.02,-742.09]}<5
		{
			call LockAndWait -Loc "-500.92,125.20,-750.23" -RelayToGroup
		}
		if ${Me.Distance[-500.92,125.20,-750.23]}<${Me.Distance[-428.03,131.29,-760.33]} && ${Me.Distance[-500.92,125.20,-750.23]}<${Me.Distance[-468.00,127.22,-754.99]}
		{
			call LockAndWait -Loc "-500.92,125.20,-750.23" -RelayToGroup
		}
		if ${Me.Distance[-428.03,131.29,-760.33]}<${Me.Distance[-500.92,125.20,-750.23]} && ${Me.Distance[-428.03,131.29,-760.33]}<${Me.Distance[-468.00,127.22,-754.99]}
		{
			call LockAndWait -Loc "-428.03,131.29,-760.33" -RelayToGroup
		}
		if ${Me.Distance[-468.00,127.22,-754.99]}<${Me.Distance[-500.92,125.20,-750.23]} && ${Me.Distance[-468.00,127.22,-754.99]}<${Me.Distance[-428.03,131.29,-760.33]}
		{
			call LockAndWait -Loc "-468.00,127.22,-754.99" -RelayToGroup
		}
		if ${TriggerMessage.Find[east]}
		{
			call LockAndWait -Loc "-500.92,125.20,-750.23" -RelayToGroup
			wait 300 !${Actor[id, ${_NamedID}](exists)}
			while !${Actor[id, ${_NamedID}](exists)}
			{
				if ${Actor[Query, Name=="" && Overlay=="cast_aa_shield_bars"].Distance}>2
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="" && Overlay=="cast_aa_shield_bars"].Loc}]
				wait 2
			}
			call LockAndWait -Loc "-500.92,125.20,-750.23" -RelayToGroup
		}
		elseif ${TriggerMessage.Find[west]}
		{
			call LockAndWait -Loc "-428.03,131.29,-760.33" -RelayToGroup
			wait 300 !${Actor[id, ${_NamedID}](exists)}
			while !${Actor[id, ${_NamedID}](exists)}
			{
				if ${Actor[Query, Name=="" && Overlay=="cast_aa_shield_bars"].Distance}>2
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="" && Overlay=="cast_aa_shield_bars"].Loc}]
				wait 2
			}
			call LockAndWait -Loc "-428.03,131.29,-760.33" -RelayToGroup
		}
		elseif ${TriggerMessage.Find[on the bridge]}
		{
			call LockAndWait -Loc "-468.00,127.22,-754.99" -RelayToGroup
			wait 300 !${Actor[id, ${_NamedID}](exists)}
			while !${Actor[id, ${_NamedID}](exists)}
			{
				if ${Actor[Query, Name=="" && Overlay=="cast_aa_shield_bars"].Distance}>2
					relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="" && Overlay=="cast_aa_shield_bars"].Loc}]
				wait 2
			}
			call LockAndWait -Loc "-468.00,127.22,-754.99" -RelayToGroup
		}
		;wait 300 ${Actor[id, ${_NamedID}].Distance}<30
		;variable int _failcnt=1
		;while ${Actor[id, ${_NamedID}].Distance}>7 && ${_failcnt}<150
		;{
	;		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id, ${_NamedID}].Loc},7]
;			wait 1
;		}
	}
}
function Skulkor()
{
	call CustomNamed "Skulkor" "-449.78,160.05,-569.37" SkulkorCustom
	call LockAndWait -Loc "-449.78,160.05,-569.37"
}
function SkulkorCustom(int _NamedID)
{
	call RIObj.Target harrower -Distance 20 ${_NamedID}
	if ${Actor[boss 2 pygmy skull](exists)}
	{
		if ${Actor[boss 2 pygmy skull].Distance}>5
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[boss 2 pygmy skull].Loc},4]
		Actor[boss 2 pygmy skull]:DoubleClick
	}
}
function Corpsetalon()
{
	Actor[Corpsetalon]:DoTarget
	call CustomNamed "Corpsetalon-NLP" "-554.71,177.41,-623.52" CorpsetalonCustom
	call LockAndWait -Loc "-554.71,177.41,-623.52"
}
function CorpsetalonCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	call RIObj.Target deathsister -Distance 20 skully -Distance 20 adder -Distance 20 ${_NamedID}
	if ${Me.Distance[${Actor[id,${_NamedID}].X},${Me.Y},${Actor[id,${_NamedID}].Z}]}>5
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_NamedID}].X},${Me.Y},${Actor[id,${_NamedID}].Z}]
}
function Gangrerious()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["searches the area for sustenance"]
	call CustomNamed "Gangrerious-NMB" "-452.84,188.13,-537.43" GangreriousCustom
	IncomingText:Clear
	IncomingText2:Clear
}
function GangreriousCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	call RIObj.Target Necrodaverus -Distance 20 ${_NamedID}
	if ${Trigger}
	{
		if ${Me.Distance[-452.84,188.13,-537.43]}<5
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-474.74,188.18,-541.19]
		else
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-452.84,188.13,-537.43]
		Trigger:Set[0]
	}
}
function Grumblugtin()
{
	call CustomNamed "Grumblugtin" "-358.64,193.23,-717.52" GrumblugtinCustom
}
function GrumblugtinCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	if ${Actor[Query, Name=-"a wretched corpsecur" && IsDead = FALSE](exists)}
	{
		;228 Unleashed
		variable index:actor ActorIndex
		variable iterator ActorIterator
		
		EQ2:QueryActors[ActorIndex, Name=-"a wretched corpsecur" && IsDead = FALSE && Distance <= 30]
			
		ActorIndex:GetIterator[ActorIterator]
		
		;echo ${ActorIndex.Used}
		if ${ActorIterator:First(exists)}
		{
			do
			{
				if !${RIMUIObj.MainIconIDExists[${ActorIterator.Value.ID},228]}
					ActorIterator.Value:DoTarget
			}
			while ${ActorIterator:Next(exists)}
		}
	}
	else
		call RIObj.Target ${_NamedID}
}
;End Svarni Expanse: Carrion Crag

;Start Mahngavi Wastes: Warpwood Cairn

function Krel()
{
	call CustomNamed "Krel Korek Mal" "-151.23,100.72,87.30"
}

function Bolor()
{
	call CustomNamed "Warlock Ren Bolor-NMB" "361.20,107.77,-14.21" NONE summoned
}

function Oororr()
{
	call CustomNamed "Oororr the Corrupted" "506.13,89.60,275.13" NONE pustule
}

function Felazhor()
{
	call CustomNamed "Felazhor Khan" "-73.33,101.07,214.61" NONE blood divine
}

function Lagrecia()
{
	call CustomNamed "Lagrecia Vyl'Tayne" "-48.89,95.55,608.69" NONE Chernala Drivazia Dead
}

;End Mahngavi Wastes: Warpwood Cairn

;Start Forlorn Gist: Nightmares of Old

function Lavec()
{
	AnnounceText:Clear
	AnnounceText:Insert["The air begins"]
	AnnounceText:Insert["The air becomes thick with the smell of iron"]
	call CustomNamed "Lavec Conun'Stah-NMB" "-302.33,13.19,276.67" LavecCustom
	AnnounceText:Clear
}
function LavecCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	call RIObj.Target vampire -Distance 10 ${_NamedID}
	if ${Trigger}
	{
		if ${Me.Distance[-302.33,13.19,276.67]}<5
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-309.02,12.98,267.77]
		else
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-302.33,13.19,276.67]
		Trigger:Set[0]
	}
}
function Krinas()
{
	call CustomNamed "Krinas Bledso" "-132.57,16.05,315.26" KrinasCustom thrall werehound
}
function KrinasCustom(int _NamedID)
{
	call RIObj.Target thrall -Distance 10 werehound -Distance 10 ${_NamedID}
}
function Stenkannreif()
{
	;call ToggleWalkRun 1
	call CustomNamed "Stenkannreif, the Monster-NMB" "-226.67,48.04,345.84" NONE necrotic lich
	;call ToggleWalkRun 0
}

function Perisha()
{
	call CustomNamed "Perisha, the Mistress of Flies" "143.26,47.20,359.45" NONE corrupted resident lich
}

function Aga()
{
	call CustomNamed "Aga-Yagaba" "434.59,108.74,204.02" NONE madcap lich resident
}

;End Forlorn Gist: Nightmares of Old

;Start Castle Vacrul: Suite of Screams

function Durogan()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["Captain Durogan chooses YOU"]
	call CustomNamed "Bloodlord Durogan" "54.46,-50.19,370.59" DuroganCustom
	IncomingText:Clear
	IncomingText2:Clear
}
function DuroganCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
	if ${Trigger}
	{
		Trigger:Set[0]
		variable int _AlchoholID
		_AlchoholID:Set[${Actor[Query, Name=="wine bottle" || Name=="stein"].ID}]
		;echo ${Actor[id, ${_AlchoholID}].Distance}
		RI_CMD_PauseCombatBots 1
		wait 1
		eq2ex cancel_spellcast
		while ${Actor[id, ${_AlchoholID}](exists)}
		{
			if ${Actor[id, ${_AlchoholID}].Distance}>=11
				RIMUIObj:SetLockSpot[ALL,${Actor[id, ${_AlchoholID}].Loc},10]
			if ${Me.GetGameData[Spells.Casting].Label.NotEqual[Drink]}
			{
				Actor[id, ${_AlchoholID}]:DoubleClick
			}
			wait 5
		}
		RI_CMD_PauseCombatBots 0
	}
}

function Devioth()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["The Bloodmaiden searched far and wide for her precious"]
	call LockAndWait -Loc "35.56,-50.17,293.10" -RelayToGroup
	call CustomNamed "Taskmistress Devioth" "36.77,-50.09,304.31" DeviothCustom
	IncomingText:Clear
	IncomingText2:Clear
}
function DeviothCustom()
{
	call RIObj.Target ${_NamedID}
	if ${Trigger}
	{
		Trigger:Set[0]
		variable string _Race
		_Race:Set[${TriggerMessage.Right[${Math.Calc[(${TriggerMessage.Find[de for her precious]}+19)*-1]}].Left[-2]}]

		if ${_Race.Find[dark elves]}
			_Race:Set[dark elf]
		elseif ${_Race.Find[wood elves]}
			_Race:Set[wood elf]
		elseif ${_Race.Find[high elves]}
			_Race:Set[high elf]
		elseif ${_Race.Find[kerrans]}
			_Race:Set[kerra]
		elseif ${_Race.Find[dwarves]}
			_Race:Set[dwarf]
		elseif ${_Race.Right[1].Equal[s]}
			_Race:Set[${_Race.Left[-1]}]
		
		
		if ${_Race.Find[erudite]} || ${_Race.Find[fae]} || ${_Race.Find[froglok]} || ${_Race.Find[gnome]} || ${_Race.Find[halfling]} || ${_Race.Find[high elf]}
			call LockAndWait -Loc "60.63,-50.09,304.30" -RelayToGroup
		
		call LockAndWait -Loc "${Actor[${_Race} bookcase].Loc}" -RelayToGroup -Precision 15 -Max 500
		RI_CMD_PauseCombatBots 1
		wait 1
		eq2ex cancel_spellcast
		while ${Actor[${_Race} bookcase].Interactable}
		{
			Actor[${_Race} bookcase]:DoubleClick
			wait 2
		}
		RI_CMD_PauseCombatBots 0
		if ${_Race.Find[erudite]} || ${_Race.Find[fae]} || ${_Race.Find[froglok]} || ${_Race.Find[gnome]} || ${_Race.Find[halfling]} || ${_Race.Find[high elf]}
			call LockAndWait -Loc "60.63,-50.09,304.30" -RelayToGroup

		call LockAndWait -Loc "36.77,-50.09,304.31" -RelayToGroup
	}
}

function Syvanti()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["The Bloodmaiden's victims from"]
	while !${Actor[Bloodmaiden Syvanti].IsAggro}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Bloodmaiden Syvanti].Loc},5,1000]
		if ${Actor[Bloodmaiden Syvanti].Distance}<5
			Actor[Bloodmaiden Syvanti]:DoubleClick
	}
	call CustomNamed "Bloodmaiden Syvanti" "31.82,-50.19,241.84" SyvantiCustom
	IncomingText:Clear
	IncomingText2:Clear
}
function SyvantiCustom(int _NamedID)
{
	if ${Actor[shrieking](exists)}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[shrieking].Loc},7,1000]
	else
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,31.82,-50.19,241.84]
	call RIObj.Target shrieking -Distance 100 ${_NamedID}
	if ${Trigger}
	{
		Trigger:Set[0]
		if ${TriggerMessage.Find[Kamapor]}
		{
			call LockAndWait -Loc "53.81,-50.19,250.74" -RelayToGroup
			wait 300 ${Me.Elemental}==0 && ${Me.Group[1].Elemental}==0
		}
		elseif ${TriggerMessage.Find[Karuupa Jungle]}
		{
			call LockAndWait -Loc "29.10,-50.19,252.16" -RelayToGroup
			wait 300 ${Me.Trauma}==0 && ${Me.Group[1].Trauma}==0
		}
		elseif ${TriggerMessage.Find[Mahngavi Wastes]}
		{
			call LockAndWait -Loc "49.47,-50.12,227.03" -RelayToGroup
			wait 300 ${Me.Arcane}<1 && ${Me.Group[1].Arcane}<1
		}
		elseif ${TriggerMessage.Find[Svarni Expanse]}
		{
			call LockAndWait -Loc "24.67,-50.19,231.41" -RelayToGroup
			wait 300 ${Me.Noxious}==0 && ${Me.Group[1].Noxious}==0
		}
	}

}

;pygmy
;29.10 -50.19 252.16 / 29.10,-50.19,252.16
;kyv
;24.67 -50.19 231.41 / 24.67,-50.19,231.41
;witches
;49.47 -50.12 227.03 / 49.47,-50.12,227.03
;centaurs
;53.81 -50.19 250.74 / 53.81,-50.19,250.74

;End Castle Vacrul: Suite of Screams

;Start Karuupa Jungle: Predator's Perch
function PterrordaxStart()
{
	variable int _failcnt
	while !${Actor[Pterrordax].IsAggro} && ${_failcnt:Inc}<300
	{
		;add lockspots to index then query all actors named a toxic shadow puddle, 
		;then move to closest locspot that is more than 10 from every puddle
		variable index:string _Locs
		variable index:actor _ActorIndex
		EQ2:GetActors[_ActorIndex,range,200]
		EQ2:QueryActors[_ActorIndex, Name=="pygmy bomb"]
		;echo ${Actor[Query, Name=="" && Overlay=="design_sinkhole_warning"]} // ${_ActorIndex.Used} // ${Actor[Query, Name=="" && TintFlags=2306]}
		if ${_ActorIndex.Used}==0
			return
		
		;NW -700.83 227.98 -390.55

		;SW -700.21 227.98 -320.14

		;SE -780.73 227.98 -320.03

		;NE -780.30 227.98 -390.70

		_Locs:Insert["-700.83,227.98,-390.55"]
		_Locs:Insert["-700.83,227.98,-380.55"]
		_Locs:Insert["-700.83,227.98,-370.55"]
		_Locs:Insert["-700.83,227.98,-360.55"]
		_Locs:Insert["-700.83,227.98,-350.55"]
		_Locs:Insert["-700.83,227.98,-340.55"]
		_Locs:Insert["-700.83,227.98,-330.55"]
		_Locs:Insert["-700.83,227.98,-320.55"]
		_Locs:Insert["-710.83,227.98,-390.55"]
		_Locs:Insert["-710.83,227.98,-380.55"]
		_Locs:Insert["-710.83,227.98,-370.55"]
		_Locs:Insert["-710.83,227.98,-360.55"]
		_Locs:Insert["-710.83,227.98,-350.55"]
		_Locs:Insert["-710.83,227.98,-340.55"]
		_Locs:Insert["-710.83,227.98,-330.55"]
		_Locs:Insert["-710.83,227.98,-320.55"]
		_Locs:Insert["-720.83,227.98,-390.55"]
		_Locs:Insert["-720.83,227.98,-380.55"]
		_Locs:Insert["-720.83,227.98,-370.55"]
		_Locs:Insert["-720.83,227.98,-360.55"]
		_Locs:Insert["-720.83,227.98,-350.55"]
		_Locs:Insert["-720.83,227.98,-340.55"]
		_Locs:Insert["-720.83,227.98,-330.55"]
		_Locs:Insert["-720.83,227.98,-320.55"]
		_Locs:Insert["-730.83,227.98,-390.55"]
		_Locs:Insert["-730.83,227.98,-380.55"]
		_Locs:Insert["-730.83,227.98,-370.55"]
		_Locs:Insert["-730.83,227.98,-360.55"]
		_Locs:Insert["-730.83,227.98,-350.55"]
		_Locs:Insert["-730.83,227.98,-340.55"]
		_Locs:Insert["-730.83,227.98,-330.55"]
		_Locs:Insert["-730.83,227.98,-320.55"]
		_Locs:Insert["-740.83,227.98,-390.55"]
		_Locs:Insert["-740.83,227.98,-380.55"]
		_Locs:Insert["-740.83,227.98,-370.55"]
		_Locs:Insert["-740.83,227.98,-360.55"]
		_Locs:Insert["-740.83,227.98,-350.55"]
		_Locs:Insert["-740.83,227.98,-340.55"]
		_Locs:Insert["-740.83,227.98,-330.55"]
		_Locs:Insert["-740.83,227.98,-320.55"]
		_Locs:Insert["-750.83,227.98,-390.55"]
		_Locs:Insert["-750.83,227.98,-380.55"]
		_Locs:Insert["-750.83,227.98,-370.55"]
		_Locs:Insert["-750.83,227.98,-360.55"]
		_Locs:Insert["-750.83,227.98,-350.55"]
		_Locs:Insert["-750.83,227.98,-340.55"]
		_Locs:Insert["-750.83,227.98,-330.55"]
		_Locs:Insert["-750.83,227.98,-320.55"]
		_Locs:Insert["-760.83,227.98,-390.55"]
		_Locs:Insert["-760.83,227.98,-380.55"]
		_Locs:Insert["-760.83,227.98,-370.55"]
		_Locs:Insert["-760.83,227.98,-360.55"]
		_Locs:Insert["-760.83,227.98,-350.55"]
		_Locs:Insert["-760.83,227.98,-340.55"]
		_Locs:Insert["-760.83,227.98,-330.55"]
		_Locs:Insert["-760.83,227.98,-320.55"]
		_Locs:Insert["-770.83,227.98,-390.55"]
		_Locs:Insert["-770.83,227.98,-380.55"]
		_Locs:Insert["-770.83,227.98,-370.55"]
		_Locs:Insert["-770.83,227.98,-360.55"]
		_Locs:Insert["-770.83,227.98,-350.55"]
		_Locs:Insert["-770.83,227.98,-340.55"]
		_Locs:Insert["-770.83,227.98,-330.55"]
		_Locs:Insert["-770.83,227.98,-320.55"]
		_Locs:Insert["-780.83,227.98,-390.55"]
		_Locs:Insert["-780.83,227.98,-380.55"]
		_Locs:Insert["-780.83,227.98,-370.55"]
		_Locs:Insert["-780.83,227.98,-360.55"]
		_Locs:Insert["-780.83,227.98,-350.55"]
		_Locs:Insert["-780.83,227.98,-340.55"]
		_Locs:Insert["-780.83,227.98,-330.55"]
		_Locs:Insert["-780.83,227.98,-320.55"]

		call RIObj.AvoidActors _Locs _ActorIndex 20
		wait 1
	}
}
function Pterrordax()
{
	variable bool _HeroicOpsWereOff
	if !${RI_Obj_CB.GetUISetting[SettingsStartHeroicCheckBox]}
	{
		RI_Obj_CB:SetUISetting[SettingsStartHeroicCheckBox,TRUE]
		_HeroicOpsWereOff:Set[1]
	}
	call CustomNamed "Pterrordax-NLP" "-758.13,226.33,-352.12" PterrordaxCustom
	if ${_HeroicOpsWereOff}
		RI_Obj_CB:SetUISetting[SettingsStartHeroicCheckBox,FALSE]
}
function PterrordaxCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
	;383 Piercing Plumes
	if ${Me.Effect[detrimental,${RIMUIObj.MainIconIDExists[${Me.ID},383]}].CurrentIncrements}>0
	{
		;code for heroic ops
		;Scout Starter -41
		;Mage Starter -25
		;Priest Starter -14
		;Tank Starter -0
		variable int _StarterID
		switch ${Me.Archetype}
		{
			case fighter
			{
				_StarterID:Set[0]
				break
			}
			case scout
			{
				_StarterID:Set[41]
				break
			}
			case mage
			{
				_StarterID:Set[25]
				break
			}
			case priest
			{
				_StarterID:Set[14]
				break
			}
		}
		if ${EQ2.HOWheelState}==0 && ${Int[${RI_Obj_CB.GetHOIconIDAbility[${_StarterID}]}]}>-1
		{
			;echo our HO is on State ${EQ2.HOWheelState}, Casting ${RI_Obj_CB.GetHOIconIDAbility[${_StarterID}]}
			RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${_StarterID}]},1]
		}
		elseif ${EQ2.HOWheelState}==2
		; && ${Int[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID1}]}]}>-1
		{
			if ${RI_Obj_CB.HOIconIDExists[${EQ2.HOIconID1}]}
			{
				RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID1}]},1]
			}
			;echo our HO is on State ${EQ2.HOWheelState}, Casting ${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID1}]}
			if ${RI_Obj_CB.HOIconIDExists[${EQ2.HOIconID2}]}
			{
				RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID2}]},1]
			}
			elseif ${RI_Obj_CB.HOIconIDExists[${EQ2.HOIconID3}]}
			{
				RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID3}]},1]
			}
			elseif ${RI_Obj_CB.HOIconIDExists[${EQ2.HOIconID4}]}
			{
				RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID4}]},1]
			}
			elseif ${RI_Obj_CB.HOIconIDExists[${EQ2.HOIconID5}]}
			{
				RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID5}]},1]
			}
			elseif ${RI_Obj_CB.HOIconIDExists[${EQ2.HOIconID6}]}
			{
				RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID6}]},1]
			}
		}
		wait 5
	}
	if ${RI_Var_Bool_GlobalOthers}
		return

	;add lockspots to index then query all actors named a toxic shadow puddle, 
	;then move to closest locspot that is more than 10 from every puddle
	variable index:string _Locs
	variable index:actor _ActorIndex
	EQ2:GetActors[_ActorIndex,range,200]
	EQ2:QueryActors[_ActorIndex, Name=="pygmy bomb"]
	;echo ${Actor[Query, Name=="" && Overlay=="design_sinkhole_warning"]} // ${_ActorIndex.Used} // ${Actor[Query, Name=="" && TintFlags=2306]}
	if ${_ActorIndex.Used}==0
		return
	
	;NW -700.83 227.98 -390.55

	;SW -700.21 227.98 -320.14

	;SE -780.73 227.98 -320.03

	;NE -780.30 227.98 -390.70

	_Locs:Insert["-700.83,227.98,-390.55"]
	_Locs:Insert["-700.83,227.98,-380.55"]
	_Locs:Insert["-700.83,227.98,-370.55"]
	_Locs:Insert["-700.83,227.98,-360.55"]
	_Locs:Insert["-700.83,227.98,-350.55"]
	_Locs:Insert["-700.83,227.98,-340.55"]
	_Locs:Insert["-700.83,227.98,-330.55"]
	_Locs:Insert["-700.83,227.98,-320.55"]
	_Locs:Insert["-710.83,227.98,-390.55"]
	_Locs:Insert["-710.83,227.98,-380.55"]
	_Locs:Insert["-710.83,227.98,-370.55"]
	_Locs:Insert["-710.83,227.98,-360.55"]
	_Locs:Insert["-710.83,227.98,-350.55"]
	_Locs:Insert["-710.83,227.98,-340.55"]
	_Locs:Insert["-710.83,227.98,-330.55"]
	_Locs:Insert["-710.83,227.98,-320.55"]
	_Locs:Insert["-720.83,227.98,-390.55"]
	_Locs:Insert["-720.83,227.98,-380.55"]
	_Locs:Insert["-720.83,227.98,-370.55"]
	_Locs:Insert["-720.83,227.98,-360.55"]
	_Locs:Insert["-720.83,227.98,-350.55"]
	_Locs:Insert["-720.83,227.98,-340.55"]
	_Locs:Insert["-720.83,227.98,-330.55"]
	_Locs:Insert["-720.83,227.98,-320.55"]
	_Locs:Insert["-730.83,227.98,-390.55"]
	_Locs:Insert["-730.83,227.98,-380.55"]
	_Locs:Insert["-730.83,227.98,-370.55"]
	_Locs:Insert["-730.83,227.98,-360.55"]
	_Locs:Insert["-730.83,227.98,-350.55"]
	_Locs:Insert["-730.83,227.98,-340.55"]
	_Locs:Insert["-730.83,227.98,-330.55"]
	_Locs:Insert["-730.83,227.98,-320.55"]
	_Locs:Insert["-740.83,227.98,-390.55"]
	_Locs:Insert["-740.83,227.98,-380.55"]
	_Locs:Insert["-740.83,227.98,-370.55"]
	_Locs:Insert["-740.83,227.98,-360.55"]
	_Locs:Insert["-740.83,227.98,-350.55"]
	_Locs:Insert["-740.83,227.98,-340.55"]
	_Locs:Insert["-740.83,227.98,-330.55"]
	_Locs:Insert["-740.83,227.98,-320.55"]
	_Locs:Insert["-750.83,227.98,-390.55"]
	_Locs:Insert["-750.83,227.98,-380.55"]
	_Locs:Insert["-750.83,227.98,-370.55"]
	_Locs:Insert["-750.83,227.98,-360.55"]
	_Locs:Insert["-750.83,227.98,-350.55"]
	_Locs:Insert["-750.83,227.98,-340.55"]
	_Locs:Insert["-750.83,227.98,-330.55"]
	_Locs:Insert["-750.83,227.98,-320.55"]
	_Locs:Insert["-760.83,227.98,-390.55"]
	_Locs:Insert["-760.83,227.98,-380.55"]
	_Locs:Insert["-760.83,227.98,-370.55"]
	_Locs:Insert["-760.83,227.98,-360.55"]
	_Locs:Insert["-760.83,227.98,-350.55"]
	_Locs:Insert["-760.83,227.98,-340.55"]
	_Locs:Insert["-760.83,227.98,-330.55"]
	_Locs:Insert["-760.83,227.98,-320.55"]
	_Locs:Insert["-770.83,227.98,-390.55"]
	_Locs:Insert["-770.83,227.98,-380.55"]
	_Locs:Insert["-770.83,227.98,-370.55"]
	_Locs:Insert["-770.83,227.98,-360.55"]
	_Locs:Insert["-770.83,227.98,-350.55"]
	_Locs:Insert["-770.83,227.98,-340.55"]
	_Locs:Insert["-770.83,227.98,-330.55"]
	_Locs:Insert["-770.83,227.98,-320.55"]
	_Locs:Insert["-780.83,227.98,-390.55"]
	_Locs:Insert["-780.83,227.98,-380.55"]
	_Locs:Insert["-780.83,227.98,-370.55"]
	_Locs:Insert["-780.83,227.98,-360.55"]
	_Locs:Insert["-780.83,227.98,-350.55"]
	_Locs:Insert["-780.83,227.98,-340.55"]
	_Locs:Insert["-780.83,227.98,-330.55"]
	_Locs:Insert["-780.83,227.98,-320.55"]

	call RIObj.AvoidActors _Locs _ActorIndex 20
}
function Gilan()
{
	call CustomNamed "gilan" "-749.06,225.79,-383.99" NONE "ribon"
}
function Hinokawu()
{
	variable bool _HeroicOpsWereOff
	if !${RI_Obj_CB.GetUISetting[SettingsStartHeroicCheckBox]}
	{
		RI_Obj_CB:SetUISetting[SettingsStartHeroicCheckBox,TRUE]
		_HeroicOpsWereOff:Set[1]
	}
	call CustomNamed "Hinokawu" "-749.61,225.79,-384.30" HinokawuCustom
	if ${_HeroicOpsWereOff}
		RI_Obj_CB:SetUISetting[SettingsStartHeroicCheckBox,FALSE]
}
function HinokawuCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
	;code for heroic ops
	;Scout Starter -41
	;Mage Starter -25
	;Priest Starter -14
	;Tank Starter -0
	variable int _StarterID
	switch ${Me.Archetype}
	{
		case fighter
		{
			_StarterID:Set[0]
			break
		}
		case scout
		{
			_StarterID:Set[41]
			break
		}
		case mage
		{
			_StarterID:Set[25]
			break
		}
		case priest
		{
			_StarterID:Set[14]
			break
		}
	}
	if ${EQ2.HOWheelState}==0 && ${Int[${RI_Obj_CB.GetHOIconIDAbility[${_StarterID}]}]}>-1
	{
		echo our HO is on State ${EQ2.HOWheelState}, Casting ${RI_Obj_CB.GetHOIconIDAbility[${_StarterID}]}
		RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${_StarterID}]}]
	}
	elseif ${EQ2.HOWheelState}==2
	; && ${Int[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID1}]}]}>-1
	{
		if ${RI_Obj_CB.HOIconIDExists[${EQ2.HOIconID1}]}
		{
			RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID1}]},1]
		}
		;echo our HO is on State ${EQ2.HOWheelState}, Casting ${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID1}]}
		if ${RI_Obj_CB.HOIconIDExists[${EQ2.HOIconID2}]}
		{
			RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID2}]},1]
		}
		elseif ${RI_Obj_CB.HOIconIDExists[${EQ2.HOIconID3}]}
		{
			RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID3}]},1]
		}
		elseif ${RI_Obj_CB.HOIconIDExists[${EQ2.HOIconID4}]}
		{
			RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID4}]},1]
		}
		elseif ${RI_Obj_CB.HOIconIDExists[${EQ2.HOIconID5}]}
		{
			RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID5}]},1]
		}
		elseif ${RI_Obj_CB.HOIconIDExists[${EQ2.HOIconID6}]}
		{
			RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID6}]},1]
		}
	}
	wait 5
	return
	if ${Actor[astral egg](exists)}
	{
		variable int _EggID
		_EggID:Set[${Actor[astral egg].ID}]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_EggID}].Loc},1,1000]
		while ${Actor[id,${_EggID}](exists)}
		{
			eq2ex apply_verb ${Actor[id,${_EggID}].ID} "Destroy"
			Actor[id,${_EggID}]:DoubleClick
			Actor[id,${_EggID}]:RightClick
			waitframe
		}
	}
}

;End Karuupa Jungle: Predator's Perch

;Start The Merchant's Den
function Merchantsdenwall()
{
	while !${Actor[Query, Name=="a cracked wall" && Aura=="dead"](exists)}
	{
		Actor[Query, Name=="a cracked wall"]:DoTarget
		wait 1
	}
}
function Merchantsdenshadysupplier()
{
	while ${Actor[Query, Name=="a shady supplier" && IsDead=FALSE](exists)}
	{
		Actor[Query, Name=="a shady supplier" && IsDead=FALSE]:DoTarget
		wait 2
	}
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert[You find a note with just the word]
	variable int _failcnt=0
	while !${Trigger} && ${_failcnt:Inc}<10
	{
		if ${Actor[a dead shady supplier].Distance}>6
			call LockAndWait -Loc "${Actor[a dead shady supplier].Loc}"
		Actor[a dead shady supplier]:DoubleClick
		wait 2
		Actor[a dead shady supplier]:DoubleClick
		wait 2
		Actor[a dead shady supplier]:DoubleClick
		wait 2
		;echo ${TriggerMessage}
		;echo \"${TriggerMessage.Right[${Math.Calc[(${_fart.Find["You find a note with just the word, #2EFEF7"]}+50)*-1]}]}\"
		declarevariable RI_Var_ShadySupplier string global ${TriggerMessage.Right[${Math.Calc[(${_fart.Find["You find a note with just the word, #2EFEF7"]}+50)*-1]}]}
		RI_Var_ShadySupplier:Set[${RI_Var_ShadySupplier.Left[${RI_Var_ShadySupplier.Find[#]}].Left[-1]}]
		;echo \"${RI_Var_ShadySupplier}\"
		wait 10
	}
	Trigger:Set[0]
	IncomingText:Clear
	IncomingText2:Clear
	if ${Me.Distance[-133.21,1.40,-62.13]}>3
		call LockAndWait -Loc "-133.21,1.40,-62.13"
}
function Merchantsdengateman()
{
	CustomLoc:Set["0 0 0"]
	call HailActor Gateman 2
	call RIMObj.CheckCombat
	wait 2
	type ${RI_Var_ShadySupplier}
	wait 2
	press enter
	wait 2
	press enter
	wait 2
	press enter
	wait 20
	deletevariable RI_Var_ShadySupplier
}
function Twoshanks()
{
	;bilge
	call CustomNamed "Captain Twoshanks" "-162.70,-0.30,-51.82" NONE bilge freebooter
}

function Grimalda()
{
	;armless
	call CustomNamed "Grimalda Goodhand" "-198.18,-0.47,-51.473" NONE armless freebooter
}

function Gelda()
{
	call LockAndWait -Loc "-252.92,0.11,-48.51" -RelayToGroup
	call CustomNamed "Gelda Glintswift" "-242.32,0.11,-48.58" GeldaCustom
}
function GeldaCustom(int _NamedID)
{
	wait 1
	if ${RI_Var_Bool_GlobalOthers}
		return
	call RIObj.Target ${_NamedID}
	;bubble 
	;Move too kill and move back to lockspot
	if ${Actor[bubble](exists)}
	{
		while ${Actor[bubble](exists)}
		{
			;a lycan thug  --- prolly ignore these
			call RIObj.Target lycan -Distance 20 bodyguard -Distance 20 assertive -Distance 20 seller -Distance 20
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[bubble].Loc}]
			Actor[bubble]:DoubleClick
			wait 5
		}
	}
	elseif ${Me.Distance[-242.32,0.11,-48.58]}>5
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-242.32,0.11,-48.58]
}


function Furdock()
{
	;henchman
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,0]
	call CustomNamed "Elder Furdock" "-240.48,0.16,-3.46" NONE henchman
	RIMUIObj:SetUISetting[ALL,SettingsCastCureCheckBox,1]
}

function Lavalle()
{
	; hail at beggining
	while !${Actor[Liegess Lavalle].IsAggro}
	{
		Actor[Liegess Lavalle]:DoubleClick
		wait 5
	}
	;bloodthirsty
	call CustomNamed "Liegess Lavalle" "-285.40,-4.44,46.51" NONE
}

function Beefcake()
{
	IncomingText:Clear
	IncomingText2:Clear
	IncomingText:Insert["Beefcake feels a bit crowded"]
	
	variable bool _HeroicOpsWereOff
	if !${RI_Obj_CB.GetUISetting[SettingsStartHeroicCheckBox]}
	{
		RI_Obj_CB:SetUISetting[SettingsStartHeroicCheckBox,TRUE]
		_HeroicOpsWereOff:Set[1]
	}
	; hail at beggining
	while !${Actor[Beefcake].IsAggro}
	{
		Actor[Beefcake]:DoubleClick
		wait 5
	}

	call CustomNamed "Beefcake" "-240.03,0.62,58.27" BeefcakeCustom

	if ${_HeroicOpsWereOff}
		RI_Obj_CB:SetUISetting[SettingsStartHeroicCheckBox,FALSE]

	IncomingText:Clear
	IncomingText2:Clear
}

;complete ho to drop inc's cant go above 20 so do a ho at 10 i spose
function BeefcakeCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
	if ${Trigger}
	{
		Trigger:Set[0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-260.60,-4.45,58.35]
		wait 50
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-240.74,0.62,58.67]
	}
	;868 Handsome Boys
	;echo ${Actor[id,${_NamedID}]} // ${_NamedID} // ${Actor[id,${_NamedID}].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},868]}].CurrentIncrements}>5
	if ${Actor[id,${_NamedID}].Effect[${RIMUIObj.MainIconIDExists[${_NamedID},868]}].CurrentIncrements}>9
	{
		;echo HO
		;code for heroic ops
		;Scout Starter -41
		;Mage Starter -25
		;Priest Starter -14
		;Tank Starter -0
		variable int _StarterID
		switch ${Me.Archetype}
		{
			case fighter
			{
				_StarterID:Set[0]
				break
			}
			case scout
			{
				_StarterID:Set[41]
				break
			}
			case mage
			{
				_StarterID:Set[25]
				break
			}
			case priest
			{
				_StarterID:Set[14]
				break
			}
		}
		if ${EQ2.HOWheelState}==0 && ${Int[${RI_Obj_CB.GetHOIconIDAbility[${_StarterID}]}]}>-1
		{
			;echo our HO is on State ${EQ2.HOWheelState}, Casting ${RI_Obj_CB.GetHOIconIDAbility[${_StarterID}]}
			RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${_StarterID}]},1]
		}
		elseif ${EQ2.HOWheelState}==2
		; && ${Int[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID1}]}]}>-1
		{
			if ${RI_Obj_CB.HOIconIDExists[${EQ2.HOIconID1}]}
			{
				RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID1}]},1]
			}
			;echo our HO is on State ${EQ2.HOWheelState}, Casting ${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID1}]}
			if ${RI_Obj_CB.HOIconIDExists[${EQ2.HOIconID2}]}
			{
				RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID2}]},1]
			}
			elseif ${RI_Obj_CB.HOIconIDExists[${EQ2.HOIconID3}]}
			{
				RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID3}]},1]
			}
			elseif ${RI_Obj_CB.HOIconIDExists[${EQ2.HOIconID4}]}
			{
				RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID4}]},1]
			}
			elseif ${RI_Obj_CB.HOIconIDExists[${EQ2.HOIconID5}]}
			{
				RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID5}]},1]
			}
			elseif ${RI_Obj_CB.HOIconIDExists[${EQ2.HOIconID6}]}
			{
				RI_Obj_CB:Cast[${RI_Obj_CB.GetHOIconIDAbility[${EQ2.HOIconID6}]},1]
			}
		}
		wait 5
	}
}

function Dyrraga()
{
	while !${Actor[Arachlord Dyrraga].IsAggro}
	{
		wait 5
	}
	call CustomNamed "Arachlord Dyrraga-INC" "-236.87,-5.01,111.67" NONE commodity claret
}

;End The Merchant's Den

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;; End of VoV Zone CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;; Start of RoR Zone CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

function ResearchRequisitionsCustom(int _Craft=0)
{
	if ${_Craft}==0
	{
		variable index:string harvests
		variable index:string announces
		echo ISXRI: Research Requisitions Active Quests:
		echo  ___________________________________
		if ${QuestJournalWindow.ActiveQuest["Plateaus Field Research Requisition A"](exists)}
		{
			echo ISXRI: Plateaus Field Research Requisition A
			;15 Goat Meat
			;18 Apatite Gems
			;21 Brittlebush Taproot
			harvests:Insert["animal den|Goat Meat (15)|I Have Harvested Goat Meat|Plateaus Field Research Requisition A"]
			harvests:Insert["gem cluster|Apatite Gems (18)|I Have Harvested Apatite Gem|Plateaus Field Research Requisition A"]
			harvests:Insert["twisted roots|Brittlebush Taproot (21)|I Have Harvested Brittlebush Taproot|Plateaus Field Research Requisition A"]
		}
		if ${QuestJournalWindow.ActiveQuest["Plateaus Field Research Requisition B"](exists)}
		{
			echo ISXRI: Plateaus Field Research Requisition B
			;15 Cactus Fruit
			;18 Takish Fig
			;21 Bonytail Chub
			harvests:Insert["desert shrub|Cactus Fruit (15)|I Have Harvested Cactus Fruit|Plateaus Field Research Requisition B"]
			harvests:Insert["desert shrub|Takish Fig (18)|I Have Harvested Takish Fig|Plateaus Field Research Requisition B"]
			harvests:Insert["shoal of fish|Bonytail Chub (21)|I Have Harvested Bonytail Chub|Plateaus Field Research Requisition B"]
		}
		if ${QuestJournalWindow.ActiveQuest["Plateaus Field Research Requisition C"](exists)}
		{
			echo ISXRI: Plateaus Field Research Requisition C
			;15 Pallasite Ore
			;18 Desert Willow Wood
			;21 Dustmaw Hide
			harvests:Insert["rough ore|Pallasite Ore (15)|I Have Harvested Pallasite Ore|Plateaus Field Research Requisition C"]
			harvests:Insert["fallen branch|Desert Willow Wood (18)|I Have Harvested Willow Wood|Plateaus Field Research Requisition C"]
			harvests:Insert["animal den|Dustmaw Hide (21)|I Have Harvested Dustmaw Hides|Plateaus Field Research Requisition C"]
		}
		if ${QuestJournalWindow.ActiveQuest["Delta Field Research Requisition A"](exists)}
		{
			echo ISXRI: Delta Field Research Requisition A
			;15 Apatite Gems
			;18 Pallasite Ore
			;21 Desert Willow Wood
			harvests:Insert["gem cluster|Apatite Gems (15)|I Have Harvested Apatite Gems|Delta Field Research Requisition A"]
			harvests:Insert["rough ore|Pallasite Ore (18)|I Have Harvested Pallasite Ore|Delta Field Research Requisition A"]
			harvests:Insert["fallen branch|Desert Willow Wood (21)|I Have Harvested Desert Willow Wood|Delta Field Research Requisition A"]
		}
		if ${QuestJournalWindow.ActiveQuest["Delta Field Research Requisition B"](exists)}
		{
			echo ISXRI: Delta Field Research Requisition B
			;15 Goat Meat
			;18 Takish Fig
			;21 Cactus Fruit
			harvests:Insert["animal den|Goat Meat (15)|I Have Harvested Goat Meat|Delta Field Research Requisition B"]
			harvests:Insert["desert shrub|Takish Fig (18)|I Have Harvested Takish Fig|Delta Field Research Requisition B"]
			harvests:Insert["desert shrub|Cactus Fruit (21)|I Have Harvested Cactus Fruit|Delta Field Research Requisition B"]
		}
		if ${QuestJournalWindow.ActiveQuest["Delta Field Research Requisition C"](exists)}
		{
			echo ISXRI: Delta Field Research Requisition C
			;15 Dustmaw Hides
			;18 Bonytail Chub
			;21 Brittlebush Taproot
			harvests:Insert["animal den|Dustmaw Hide (15)|I Have Harvested Dustmaw Hides|Delta Field Research Requisition C"]
			harvests:Insert["shoal of fish|Bonytail Chub (18)|I Have Harvested Bonytail Chub|Delta Field Research Requisition C"]
			harvests:Insert["twisted roots|Brittlebush Taproot (21)|I Have Harvested Brittlebush Taproot|Delta Field Research Requisition C"]
		}
		if ${QuestJournalWindow.ActiveQuest["Takish Field Research Requisition A"](exists)}
		{
			echo ISXRI: Takish Field Research Requisition A
			;15 Apatite Gems
			;18 Pallasite Ore
			;21 Bonytail Chub
			harvests:Insert["gem cluster|Apatite Gems (15)|I Have Harvested Apatite Gems|Takish Field Research Requisition A"]
			harvests:Insert["rough ore|Pallasite Ore (18)|I Have Harvested Pallasite Ore|Takish Field Research Requisition A"]
			harvests:Insert["shoal of fish|Bonytail Chub (21)|I Have Harvested Bonytail Chub|Takish Field Research Requisition A"]
		}
		if ${QuestJournalWindow.ActiveQuest["Takish Field Research Requisition B"](exists)}
		{
			echo ISXRI: Takish Field Research Requisition B
			;15 Dustmaw Hides
			;18 Goat Meat
			;21 Brittlebush Taproot
			harvests:Insert["animal den|Dustmaw Hide (15)|I Have Harvested Dustmaw Hides|Takish Field Research Requisition B"]
			harvests:Insert["animal den|Goat Meat (18)|I Have Harvested Goat Meat|Takish Field Research Requisition B"]
			harvests:Insert["twisted roots|Brittlebush Taproot (21)|I Have Harvested Brittlebush Taproot|Takish Field Research Requisition B"]
		}
		if ${QuestJournalWindow.ActiveQuest["Takish Field Research Requisition C"](exists)}
		{
			echo ISXRI: Takish Field Research Requisition C
			;15 Takish Figs
			;18 Cactus Fruit
			;21 Desert Willow Wood
			harvests:Insert["desert shrub|Takish Fig (15)|I Have Harvested Takish Fig|Takish Field Research Requisition C"]
			harvests:Insert["desert shrub|Cactus Fruit (18)|I Have Harvested Cactus Fruit|Takish Field Research Requisition C"]
			harvests:Insert["fallen branch|Desert Willow Wood (21)|I Have Harvested Willow Wood|Takish Field Research Requisition C"]
		}
		echo  ___________________________________
		;I Have Harvested Takish Fig
		;I Have Harvested Cactus Fruit
		;I Have Harvested Bonytail Chub
		;I Have Harvested the needed components for my current requisition

		echo ISXRI: We will be harvesting:
		echo  ___________________________________
		echo ISXRI: ${harvests.Get[1].Token[2,|]}
		echo ISXRI: ${harvests.Get[2].Token[2,|]}
		echo ISXRI: ${harvests.Get[3].Token[2,|]}
		echo ISXRI: ${harvests.Get[4].Token[2,|]}
		echo ISXRI: ${harvests.Get[5].Token[2,|]}
		echo ISXRI: ${harvests.Get[6].Token[2,|]}
		echo ISXRI: ${harvests.Get[7].Token[2,|]}
		echo ISXRI: ${harvests.Get[8].Token[2,|]}
		echo ISXRI: ${harvests.Get[9].Token[2,|]}
		echo  ___________________________________
		call Path -PL 372 -L -DFPWD -YD 10 -QA "-QD|75|-A|${harvests.Get[1].Token[1,|]}|-T|QSC:${harvests.Get[1].Token[3,|]}+${harvests.Get[1].Token[4,|]}|-E|H" -QA "-QD|75|-A|${harvests.Get[2].Token[1,|]}|-T|QSC:${harvests.Get[2].Token[3,|]}+${harvests.Get[2].Token[4,|]}|-E|H" -QA "-QD|75|-A|${harvests.Get[3].Token[1,|]}|-T|QSC:${harvests.Get[3].Token[3,|]}+${harvests.Get[3].Token[4,|]}|-E|H" -QA "-QD|75|-A|${harvests.Get[4].Token[1,|]}|-T|QSC:${harvests.Get[4].Token[3,|]}+${harvests.Get[4].Token[4,|]}|-E|H" -QA "-QD|75|-A|${harvests.Get[5].Token[1,|]}|-T|QSC:${harvests.Get[5].Token[3,|]}+${harvests.Get[5].Token[4,|]}|-E|H" -QA "-QD|75|-A|${harvests.Get[6].Token[1,|]}|-T|QSC:${harvests.Get[6].Token[3,|]}+${harvests.Get[6].Token[4,|]}|-E|H" -QA "-QD|75|-A|${harvests.Get[7].Token[1,|]}|-T|QSC:${harvests.Get[7].Token[3,|]}+${harvests.Get[7].Token[4,|]}|-E|H" -QA "-QD|75|-A|${harvests.Get[8].Token[1,|]}|-T|QSC:${harvests.Get[8].Token[3,|]}+${harvests.Get[8].Token[4,|]}|-E|H" -QA "-QD|75|-A|${harvests.Get[9].Token[1,|]}|-T|QSC:${harvests.Get[9].Token[3,|]}+${harvests.Get[9].Token[4,|]}|-E|H" -CT "QSC:I Have Harvested the needed components for my current requisition"
	}
	elseif ${_Craft}>0
	{
		variable string craft
		if ${_Craft}==1
		{
			echo ISXRI: Research Requisitions Active Quest:
			echo  ___________________________________
			if ${QuestJournalWindow.ActiveQuest["Plateaus Field Research Requisition A"](exists)}
			{
				echo ISXRI: Plateaus Field Research Requisition A
				;3 Improved Desert Curse Protection Potion on a Chemistry Table
				craft:Set["Improved Desert Curse Protection Potion|3|Chemistry Table"]
			}
			if ${QuestJournalWindow.ActiveQuest["Plateaus Field Research Requisition B"](exists)}
			{
				echo ISXRI: Plateaus Field Research Requisition B
				;3 Desert Delicacies on a Chemistry Table
				craft:Set["Desert Delicacies|3|Chemistry Table"]
			}
			if ${QuestJournalWindow.ActiveQuest["Plateaus Field Research Requisition C"](exists)}
			{
				echo ISXRI: Plateaus Field Research Requisition C
				;3 Amazing Amphorae on a Work Bench
				craft:Set["Amazing Amphorae|3|Work Bench"]
			}
			
			echo ISXRI: We will be crafting:
			echo  ___________________________________
			echo ISXRI: ${craft}
			echo  ___________________________________

			call MoveToActor "${craft.Token[3,|]}"
			call RICraftIt "${craft.Token[1,|]}" ${craft.Token[2,|]}
		}
		if ${_Craft}==2
		{
			echo ISXRI: Research Requisitions Active Quest:
			echo  ___________________________________
			if ${QuestJournalWindow.ActiveQuest["Takish Field Research Requisition A"](exists)}
			{
				echo ISXRI: Takish Field Research Requisition A
				;3 Additional Research Equipment on a Woodworking Table
				craft:Set["Additional Research Equipment|3|Woodworking Table"]
			}
			if ${QuestJournalWindow.ActiveQuest["Takish Field Research Requisition B"](exists)}
			{
				echo ISXRI: Takish Field Research Requisition B
				;3 Protective Desert Clothing on a Loom
				craft:Set["Protective Desert Clothing|3|Sewing Table"]
			}
			if ${QuestJournalWindow.ActiveQuest["Takish Field Research Requisition C"](exists)}
			{
				echo ISXRI: Takish Field Research Requisition C
				;3 Growth Sample Evaluations on a Woodworking Table
				craft:Set["Growth Sample Evaluations|3|Woodworking Table"]
			}
			
			echo ISXRI: We will be crafting:
			echo  ___________________________________
			echo ISXRI: ${craft}
			echo  ___________________________________

			call MoveToActor "${craft.Token[3,|]}"
			call RICraftIt "${craft.Token[1,|]}" ${craft.Token[2,|]}
		}
		if ${_Craft}==3
		{
			echo ISXRI: Research Requisitions Active Quest:
			echo  ___________________________________
			
			if ${QuestJournalWindow.ActiveQuest["Delta Field Research Requisition A"](exists)}
			{
				echo ISXRI: Delta Field Research Requisition A
				;3 on a
				craft:Set["Farm Implements|3|Forge"]
			}
			if ${QuestJournalWindow.ActiveQuest["Delta Field Research Requisition B"](exists)}
			{
				echo ISXRI: Delta Field Research Requisition B
				;3 Plateaus Meat Pies at a Stove & Keg
				craft:Set["Plateaus Meat Pies|3|Stove & Keg"]
			}
			if ${QuestJournalWindow.ActiveQuest["Delta Field Research Requisition C"](exists)}
			{
				echo ISXRI: Delta Field Research Requisition C
				;3 Improved Pest Repellant Scrolls on a Engraved Desk
				craft:Set["Improved Pest Repellent Scrolls|3|Engraved Desk"]
			}
			echo ISXRI: We will be crafting:
			echo  ___________________________________
			echo ISXRI: ${craft}
			echo  ___________________________________

			call MoveToActor "${craft.Token[3,|]}"
			call RICraftIt "${craft.Token[1,|]}" ${craft.Token[2,|]}
		}
	}
}
;Start Raj'Dur Plateaus: Blood and Sand
function Baka()
{
	call CustomNamed "Baka" "193.93,-60.30,462.21" NONE
}
function Khadra()
{
	call CustomNamed "Khadra Chatt" "328.33,9.29,159.21" NONE
}
function Hamid()
{
	call CustomNamed "Quartermaster Hamid" "-527.76,1.74,495.42" NONE
}
function Farid()
{
	call CustomNamed "Farid" "-437.80,8.54,138.90" NONE
}
function Mustapha()
{
	call CustomNamed "Mustapha Droughtbringer" "19.11,-0.06,150.52" NONE
}
;End Raj'Dur Plateaus: Blood and Sand
;Start Raj'Dur Plateaus: The Sultan's Dagger 

function Bashida()
{
	call CustomNamed "Bashida the Blade" "-34.66,89.49,-498.23" NONE
}
function Kerem()
{
	call CustomNamed "Kerem B'ayet" "-174.59,85.27,-488.96" NONE
}
function Carrionpicker()
{
	call CustomNamed "Carrionpicker" "-301.57,106.92,-398.48" NONE
}
function Albusat()
{
	call CustomNamed "Albusat Alsihriu" "-184.07,111.22,-247.69" NONE
}
function Akalay()
{
	call CustomNamed "Aqile Akalay" "-274.88,114.84,-178.78" NONE
}
function Aldys()
{
	call CustomNamed "Aldys, Sultan of the Daggers" "-295.36,116.50,-147.80" NONE
}

;End Raj'Dur Plateaus: The Sultan's Dagger 

;Start Buried Takish'Hiz: Terrene Threshold

function Shiroth()
{
	if !${Actor[petrified_trunk_tunnel_blocker](exists)}
	{
		echo ISXRI: ${Time} Shiroth Avinox already dead, Moving on
		return
	}
	echo ISXRI: Waiting for Shiroth Avinox to exist within 50
	wait 600 ${Actor[Query, Name=="Shiroth Avinox" && Distance<=50](exists)}
	wait 600 ${Actor[Query, Name=-"Shiroth Avinox" && IsDead=FALSE && ( Type=="NamedNPC" || Type=="NPC" )](exists)}
	IncomingText:Clear
	IncomingText:Insert["beats her wings"]
	IncomingText:Insert["breathes fire at"]
	call CustomNamed "Shiroth Avinox-NMB" "-772.62,-16.89,-19.09" ShirothCustom
	IncomingText:Clear
}
function ShirothCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
	if ${Trigger}
	{
		if ${TriggerMessage.Find["${Me.Name}"](exists)}
		{
			noop
		}
		else
		{	
			if ${Me.Distance[-772.62,-16.89,-19.09]}<5
				RIMUIObj:SetLockSpot[ALL,-800.22,-11.78,-30.28]
			else
				RIMUIObj:SetLockSpot[ALL,-772.62,-16.89,-19.09]
		}
		Trigger:Set[0]
	}
}
function Terrenepuzzle()
{
	if ${Actor[teleporter_puzzle_to_royal](exists)}
	{
		call RIMObj.Move -248.08 44.98 371.19 2 0 0 0 1 0 1 1
		return
	}
	AnnounceText:Clear
	AnnounceText:Insert["The Haunting of Tualanan pleads"]

	if ${RI_Var_IndexString_PuzzleSquares(exists)}
		DeleteVariable RI_Var_IndexString_PuzzleSquares
	declare RI_Var_IndexString_PuzzleSquares index:string globalkeep
	variable string _notIDs="&&ID!=0"
	variable int _i=1
	for(_i:Set[1];${_i}<1000;_i:Inc)
	{
		if ${Trigger}
		{
			_i:Set[10000]
			Trigger:Set[0]
			continue
		}
		RI_Var_IndexString_PuzzleSquares:Insert["${Actor[Query,Name=-"puzzle_square"${_notIDs}].Loc}|${Actor[Query,Name=-"puzzle_square"${_notIDs}].ID}"]
		_notIDs:Concat["&&ID!=${Actor[Query,Name=-"puzzle_square"${_notIDs}].ID}"]
		call RIMObj.Move ${String["${RI_Var_IndexString_PuzzleSquares.Get[${_i}].Token[1,|]}"].Replace[","," "]} 2 0 0 0 1 0 1 1
		wait 50 ${Actor[Query,Name=-"puzzle_square"${_notIDs}](exists)}
	}
	AnnounceText:Clear
	call RIMObj.Move -248.08 44.98 371.19 2 0 0 0 1 0 1 1
	call RIMObj.Move -248.30 47.72 380.16 2 0 0 0 1 0 1 1
	call RIMObj.Move -248.08 44.98 371.19 2 0 0 0 1 0 1 1
}
function Tualanan()
{
	if ${Actor[teleporter_puzzle_to_royal](exists)}
	{
		echo ISXRI: ${Time} The Haunting of Tualanan already dead, Moving on
		return
	}
	while ${Actor[Query, Name=-"a captive spirit" && Distance<15](exists)}
	{
		Actor[Query, Name=-"a captive spirit" && Distance<15]:DoTarget
		wait 2
	}
	echo ISXRI: Waiting for The Haunting of Tualanan to exist
	wait 600 ${Actor[The Haunting of Tualanan](exists)}
	IncomingText:Clear
	IncomingText:Insert["She screams"]
	variable int _i
	variable int _ClosestDistance=100000000
	declare RI_Var_Int_ClosestLoc int global 1
	
	;echo RI_Var_IndexString_PuzzleSquares=${RI_Var_IndexString_PuzzleSquares.Used}
	_ClosestDistance:Set[10000000]
	for(_i:Set[${RI_Var_IndexString_PuzzleSquares.Used}];${_i}>=1;_i:Dec)
	{
		;echo ${RI_Var_IndexString_PuzzleSquares.Get[${_i}]}: \${Me.Distance[${RI_Var_IndexString_PuzzleSquares.Get[${_i}]}]}<${_ClosestDistance} // ${Me.Distance[${RI_Var_IndexString_PuzzleSquares.Get[${_i}]}]}<${_ClosestDistance}
		if ${Actor[Query, Name=-"Tualanan"].Distance[${RI_Var_IndexString_PuzzleSquares.Get[${_i}].Token[1,|]}]}<${_ClosestDistance}
		{
			_ClosestDistance:Set[${Actor[Query, Name=-"Tualanan"].Distance[${RI_Var_IndexString_PuzzleSquares.Get[${_i}].Token[1,|]}]}]
			RI_Var_Int_ClosestLoc:Set[${_i}]
		}
	}
	;echo ${_ClosestDistance} // ${RI_Var_Int_ClosestLoc}
	
	for(_i:Set[${RI_Var_IndexString_PuzzleSquares.Used}];${_i}>=${RI_Var_Int_ClosestLoc};_i:Dec)
	{
		call RIMObj.Move ${String["${RI_Var_IndexString_PuzzleSquares.Get[${_i}].Token[1,|]}"].Replace[","," "]} 2 0 0 0 1 0 1 1
	}
	;echo ${_ClosestDistance} // ${RI_Var_Int_ClosestLoc}
	call CustomNamed "The Haunting of Tualanan-NMB" "0,0,0" TualananCustom
	call RIMObj.Move -248.08 44.98 371.19 2 0 0 0 1 0 1 1
	IncomingText:Clear
	DeleteVariable RI_Var_IndexString_PuzzleSquares
	DeleteVariable RI_Var_Int_ClosestLoc
	wait 50
}
function TualananCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	call RIObj.Target ${_NamedID}
	if ${Trigger}
	{
		wait 50 ${Actor[id,${_NamedID}].Distance}>10
		variable int _ClosestDistance=100000000
		variable int _MyLoc
		_MyLoc:Set[${RI_Var_Int_ClosestLoc}]
		_ClosestDistance:Set[10000000]
		for(_i:Set[${RI_Var_IndexString_PuzzleSquares.Used}];${_i}>=1;_i:Dec)
		{
			;echo ${RI_Var_IndexString_PuzzleSquares.Get[${_i}]}: \${Me.Distance[${RI_Var_IndexString_PuzzleSquares.Get[${_i}]}]}<${_ClosestDistance} // ${Me.Distance[${RI_Var_IndexString_PuzzleSquares.Get[${_i}]}]}<${_ClosestDistance}
			if ${Actor[Query, Name=-"Tualanan"].Distance[${RI_Var_IndexString_PuzzleSquares.Get[${_i}].Token[1,|]}]}<${_ClosestDistance}
			{
				_ClosestDistance:Set[${Actor[Query, Name=-"Tualanan"].Distance[${RI_Var_IndexString_PuzzleSquares.Get[${_i}].Token[1,|]}]}]
				RI_Var_Int_ClosestLoc:Set[${_i}]
			}
		}
		variable int _i
		if ${_MyLoc}>${RI_Var_Int_ClosestLoc}
		{
			;echo my loc is greater than closest loc // ${_MyLoc}>${RI_Var_Int_ClosestLoc}
			for(_i:Set[${_MyLoc}];${_i}>=${RI_Var_Int_ClosestLoc};_i:Dec)
			{
				;echo ${_i}: ${String["${RI_Var_IndexString_PuzzleSquares.Get[${_i}].Token[1,|]}"].Replace[","," "]}
				call RIMObj.Move ${String["${RI_Var_IndexString_PuzzleSquares.Get[${_i}].Token[1,|]}"].Replace[","," "]} 2 0 0 0 1 0 1 1
			}
		}
		else
		{
			;echo my loc is not greater than closest loc // ${_MyLoc}>${RI_Var_Int_ClosestLoc}
			for(_i:Set[${_MyLoc}];${_i}<=${RI_Var_Int_ClosestLoc};_i:Inc)
			{
				;echo ${_i}: ${String["${RI_Var_IndexString_PuzzleSquares.Get[${_i}].Token[1,|]}"].Replace[","," "]}
				call RIMObj.Move ${String["${RI_Var_IndexString_PuzzleSquares.Get[${_i}].Token[1,|]}"].Replace[","," "]} 2 0 0 0 1 0 1 1
			}
		}
		;then cast a dazed, feared, mesmerized, stifled, or stunned until Evoke Agony is gone
		;Evoke Agony // 608
		while ${RIMUIObj.MainIconIDExists[${_NamedID},608]} && ${Actor[Query, ID=${_NamedID} && IsDead=FALSE](exists)}
		{
			call CastDazeFearMezStifleStun
			wait 5
		}
		Trigger:Set[0]
	}
}
function CastDazeFearMezStifleStun()
{
	echo ISXRI: Cast DazeFearMezStifleStun Coming Soon
}
function Terranus()
{
	call CustomNamed "Terranus" "-931.63,33.08,550.26" TerranusCustom
}
function TerranusCustom(int _NamedID)
{
	if ${RI_Var_Bool_GlobalOthers}
		return
	call RIObj.Target fragment -Distance 25 ${_NamedID}
	if ${Actor[Query, ID=${_NamedID}].Distance}>4
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, ID=${_NamedID}].Loc},3]
}
function Terratha()
{
	call CustomNamed "Terratha-INC-NMB" "-928.70,38.39,471.69" NONE
}
function Malachiel()
{
	call CustomNamed "Malachiel Caedor-NMB" "-928.25,33.85,324.61" NONE
}
;End Buried Takish'Hiz: Terrene Threshold

;Start Buried Takish'Hiz: The Sacred Gift

function Exorax()
{
	AnnounceText:Clear
	IncomingText:Clear
	AnnounceText:Insert["Clear 4 piles of refuse to break the storm"]
	;store our istrmain in a tempindex
	variable int _i
	variable index:string _istrMainTemp
    variable int _MainArrayCounterTemp
	_MainArrayCounterTemp:Set[${MainArrayCounter}]
	for(_i:Set[1];${_i}<=${istrMain.Used};_i:Inc)
		_istrMainTemp:Insert[${istrMain.Get[${_i}]}]

	istrMain:Clear
	istrMain:Insert["-1075.82 71.17 239.45"]
	istrMain:Insert["-1075.82 71.17 239.45"]
	istrMain:Insert["-1093.39 75.60 221.48"]
	istrMain:Insert["-1075.82 71.17 239.45"]
	istrMain:Insert["-1057.78 71.14 220.61"]
	istrMain:Insert["-1072.29 71.14 216.21"]
	istrMain:Insert["-1072.10 77.63 192.81"]
	istrMain:Insert["-1072.47 71.16 220.51"]
	istrMain:Insert["-1047.68 71.14 209.98"]
	istrMain:Insert["-1044.34 71.11 200.52"]
	istrMain:Insert["-1070.87 71.14 203.43"]
	istrMain:Insert["-1100.83 74.49 203.70"]
	istrMain:Insert["-1110.51 74.49 213.82"]
	istrMain:Insert["-1111.80 71.14 243.60"]
	istrMain:Insert["-1113.39 71.11 269.44"]
	istrMain:Insert["-1100.26 71.13 267.86"]
	istrMain:Insert["-1097.13 71.14 254.18"]
	istrMain:Insert["-1097.78 71.14 243.14"]
	istrMain:Insert["-1121.13 77.63 243.36"]
	istrMain:Insert["-1075.82 71.17 239.45"]
	MainArrayCounter:Set[1]

	call CustomNamed "Exorax-NMB" "-1075.82,71.17,239.45" ExoraxCustom
	
	AnnounceText:Clear
	IncomingText:Clear
	;restore our istrMain

	istrMain:Clear
	for(_i:Set[1];${_i}<=${_istrMainTemp.Used};_i:Inc)
		istrMain:Insert[${_istrMainTemp.Get[${_i}]}]
	MainArrayCounter:Set[${_MainArrayCounterTemp}]

}

function ExoraxCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
	if ${Trigger}
	{
		wait 10
		Me:DoTarget
		StopForCombat:Set[0]
		;boss_01_pile_of_refuse_good
		;-1066.439941,74.169998,248.070007
		if ${Actor[Query, Name=="boss_01_pile_of_refuse_good" && X=-1066.439941 && Y=74.169998 && Z=248.070007](exists)}
		{
			call RIMObj.Move -1071.81 71.17 243.03 1 0 0 0 1 0 1 1
			;function JumpUp(float _X, float _Y, float _Z, float _YTarget, int _FaceDegree, int _GiveUpCNT=10)
			call JumpUp -1071.81 71.17 243.03 72 226.593445 1000
			call RIMObj.Move -1066.40 74.21 248.20 1 0 0 0 1 0 1 1
			CustomLoc:Set[0 0 0]
			call ClickActor boss_01_pile_of_refuse_good
		}
		Trigger:Set[FALSE]
		call Path -PL 19 -DSFC -QA "-A|boss_01_pile_of_refuse_good|-T|IT:Enough piles of refuse have been cleared|-E|H"
		Trigger:Set[FALSE]
		StopForCombat:Set[1]
	}
}
function Ganadan()
{
	AnnounceText:Clear
	IncomingText:Clear
	IncomingText:Insert["fades from view"]
	
	call CustomNamed "Ganadan-INC-NMB" "-1171.58,71.17,143.8" GanadanCustom
	
	AnnounceText:Clear
	IncomingText:Clear
}
function GanadanCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
	if ${Trigger}
	{
		call RIMObj.Move -1182.62 71.17 153.37 1 0 0 0 1 0 1 1
		wait 30
		while ${Me.Trauma}>0
		{
			call CheckCures
			wait 2
		}
		call RIMObj.Move -1171.58 71.17 143.8 1 0 0 0 1 0 1 1
		Trigger:Set[0]
	}
}
function Anirath()
{
	AnnounceText:Clear
	IncomingText:Clear
	AnnounceText:Insert["Clear 6 piles of refuse to break the storm"]
	;store our istrmain in a tempindex
	variable int _i
	variable index:string _istrMainTemp
    variable int _MainArrayCounterTemp
	_MainArrayCounterTemp:Set[${MainArrayCounter}]
	for(_i:Set[1];${_i}<=${istrMain.Used};_i:Inc)
		_istrMainTemp:Insert[${istrMain.Get[${_i}]}]

	istrMain:Clear
	istrMain:Insert["-1076.60 71.17 144.69"]
	istrMain:Insert["-1076.60 71.17 144.69"]
	istrMain:Insert["-1097.25 76.33 165.37"]
	istrMain:Insert["-1075.68 71.17 143.97"]
	istrMain:Insert["-1095.32 71.16 140.03"]
	istrMain:Insert["-1118.59 77.62 139.63"]
	istrMain:Insert["-1096.42 71.14 140.28"]
	istrMain:Insert["-1095.78 71.14 122.52"]
	istrMain:Insert["-1105.81 71.14 113.76"]
	istrMain:Insert["-1114.34 71.11 112.96"]
	istrMain:Insert["-1111.24 71.14 140.13"]
	istrMain:Insert["-1109.39 71.14 151.56"]
	istrMain:Insert["-1110.62 74.49 169.52"]
	istrMain:Insert["-1099.75 74.49 179.59"]
	istrMain:Insert["-1088.61 71.17 168.37"]
	istrMain:Insert["-1084.20 71.14 179.11"]
	istrMain:Insert["-1071.71 71.14 179.83"]
	istrMain:Insert["-1044.20 71.26 177.62"]
	istrMain:Insert["-1047.44 71.13 166.20"]
	istrMain:Insert["-1059.00 71.14 163.11"]
	istrMain:Insert["-1070.43 71.14 164.38"]
	istrMain:Insert["-1073.23 77.63 188.62"]
	istrMain:Insert["-1074.53 71.17 145.74"]
	MainArrayCounter:Set[1]

	call CustomNamed "Anirath Andirin-NMB" "-1076.60,71.17,144.69" AnirathCustom
	
	AnnounceText:Clear
	IncomingText:Clear
	;restore our istrMain

	istrMain:Clear
	for(_i:Set[1];${_i}<=${_istrMainTemp.Used};_i:Inc)
		istrMain:Insert[${_istrMainTemp.Get[${_i}]}]
	MainArrayCounter:Set[${_MainArrayCounterTemp}]

}

function AnirathCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
	if ${Trigger}
	{
		wait 10
		Me:DoTarget
		StopForCombat:Set[0]
		;boss_03_pile_of_refuse_good
		;-1066.439941,74.169998,248.070007
		if ${Actor[Query, Name=="boss_03_pile_of_refuse_good" && X=-1066.439941 && Y=74.169998 && Z=248.070007](exists)}
		{
			call RIMObj.Move -1071.81 71.17 243.03 1 0 0 0 1 0 1 1
			;function JumpUp(float _X, float _Y, float _Z, float _YTarget, int _FaceDegree, int _GiveUpCNT=10)
			call JumpUp -1071.81 71.17 243.03 72 226.593445 1000
			call RIMObj.Move -1066.40 74.21 248.20 1 0 0 0 1 0 1 1
			CustomLoc:Set[0 0 0]
			call ClickActor boss_03_pile_of_refuse_good
		}
		Trigger:Set[FALSE]
		call Path -PL 22 -DSFC -QA "-A|boss_03_pile_of_refuse_good|-T|IT:Enough piles of refuse have been cleared|-E|H"
		Trigger:Set[FALSE]
		StopForCombat:Set[1]
	}
}

;End Buried Takish'Hiz: The Sacred Gift

;Start Takish Badlands: Overgrowth

function Florafang()
{
	call CustomNamed "Florafang" "726.44,58.13,52.36" NONE
}

function Gobbler()
{
	call CustomNamed "The Gobbler" "744.50,56.83,-281.98" NONE
}

function Cleavespine()
{
	call CustomNamed "Cleavespine" "462.50,111.07,-614.97" NONE
}

function Tawerek()
{
	call CustomNamed "Tawerek" "197.20,92.89,-479.50" NONE
}
function Leafjaw()
{
	call CustomNamed "Leafjaw-NMB" "88.98,79.97,-312.25" LeafjawCustom
}
function LeafjawCustom(int _NamedID)
{
	
	if ${Actor[Query, Name=="Orb of Overgrowth"](exists)}
	{
		call RIObj.Target "Orb of Overgrowth"
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="Orb of Overgrowth"].Loc},3]
	}
	else
	{
		call RIObj.Target ${_NamedID}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,88.98,79.97,-312.25,2]
		wait 150 ${Me.Distance[88.98,79.97,-312.25]}<5
	}
}
;End Takish Badlands: Overgrowth

;Start Takish Badlands: Kigathor's Glade
function Lopik()
{
	call CustomNamed "Lopik Runtbottom" "-791.61,181.02,196.97" NONE
}
function Migral()
{
	call CustomNamed "Migral Strongfeet" "-825.25,260.36,-168.20" NONE
}
function Dunesea()
{
	call CustomNamed "Chief Dunesea" "-538.36,101.83,-120.59" NONE
}
function Harrower()
{
	call CustomNamed "The Harrower" "-407.79,140.05,-513.00" NONE
}
function Kigathor()
{
	call CustomNamed "Kigathor Stonebark" "-664.38,145.06,-540.17" NONE
}

;End Takish Badlands: Kigathor's Glade

;Start Sandstone Delta: Eye of the Storm

function Gallopagus()
{
	if !${Actor[Query, Name=="boss_01_column"](exists)}
	{
		echo ISXRI: ${Time} Gallopagus already dead, Moving on
		return
	}
	while !${Actor[Gallopagus](exists)}
		wait 1
	AnnounceText:Clear
	IncomingText:Clear
	AnnounceText:Insert["Gallopagus's calves bulge as he prepares to bull rush you! Be careful when attacking him from the front!"]
	RI_Obj_CB:DoNotCastEncounter[TRUE]
	RI_Obj_CB:DoNotCastAE[TRUE]
	while ${Actor[Query, Name=="boss_01_column" && Interactable=TRUE](exists)}
	{
		variable int _ColumnID
		_ColumnID:Set[${Actor[Query, Name=="boss_01_column" && Interactable=TRUE].ID}]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_ColumnID}].Loc}]
		RI_CMD_PauseCombatBots 1
		eq2ex cancel_spellcast
		;wait 300 ${Me.Distance[${Actor[id,${_ColumnID}].Loc}]}>2
		eq2ex cancel_spellcast
		while ${Actor[id,${_ColumnID}].Interactable}
		{
			Actor[id,${_ColumnID}]:DoubleClick
			wait 2
		}
		wait 1
	}
	RI_CMD_PauseCombatBots 0
	call CustomNamed "Gallopagus" "265.91,116.88,14.72" GallopagusCustom
	RI_Obj_CB:DoNotCastEncounter[FALSE]
	RI_Obj_CB:DoNotCastAE[FALSE]
	AnnounceText:Clear
}
function GallopagusCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}

	if ${Trigger}
	{
		RI_CMD_PauseCombatBots 1
		eq2ex cancel_spellcast
		eq2ex pet backoff
		eq2ex merc backoff
		variable int _ColumnID
		_ColumnID:Set[${Actor[Query, Name=="boss_01_column"].ID}]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${RIMUIObj.3rdPointLine[${Actor[id,${_NamedID}].X},${Actor[id,${_NamedID}].Z},${Actor[id,${_ColumnID}].X},${Actor[id,${_ColumnID}].Z},15].Token[1,"\,"]},${Me.Y},${RIMUIObj.3rdPointLine[${Actor[id,${_NamedID}].X},${Actor[id,${_NamedID}].Z},${Actor[id,${_ColumnID}].X},${Actor[id,${_ColumnID}].Z},15].Token[2,"\,"]}]
		;Bull Rush // 352
		wait 300 ${RIObj.MainIconIDExists[${_NamedID},352]}
		while ${RIObj.MainIconIDExists[${_NamedID},352]} && ${Actor[Query, ID=${_NamedID} && IsDead=FALSE](exists)}
		{
			if ${Actor[id,${_ColumnID}].Interactable}
			{
				while ${Actor[id,${_ColumnID}].Interactable}
				{
					Actor[id,${_ColumnID}]:DoubleClick
					wait 2
				}
			}
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${RIMUIObj.3rdPointLine[${Actor[id,${_NamedID}].X},${Actor[id,${_NamedID}].Z},${Actor[id,${_ColumnID}].X},${Actor[id,${_ColumnID}].Z},15].Token[1,"\,"]},${Me.Y},${RIMUIObj.3rdPointLine[${Actor[id,${_NamedID}].X},${Actor[id,${_NamedID}].Z},${Actor[id,${_ColumnID}].X},${Actor[id,${_ColumnID}].Z},15].Token[2,"\,"]}]
			wait 2
		}
		Trigger:Set[0]
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,265.91,116.88,14.72]
		wait 300 ${Me.Distance[265.91,116.88,14.72]}>3
		RI_CMD_PauseCombatBots 0
	}
}
function Hargan()
{
	call CustomNamed "Hargan-NMB-NWM" "196.87,91.54,233.20" HarganCustom
}
function HarganCustom(int _NamedID)
{
	call RIObj.Target Fushuga ${_NamedID}
	if ${Actor[Query, Name=="fresh catch" && Type=="NoKill NPC"](exists)}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="fresh catch" && Type=="NoKill NPC"].Loc},5]
		Actor[Query, Name=="fresh catch" && Type=="NoKill NPC"]:DoubleClick
	}
	else
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,196.87,91.54,233.20]
	}
}
function Withers()
{
	call CustomNamed "Stormy Withers" "171.08,86.52,386.60" WithersCustom
}
function WithersCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
	;Gangway! // 295
	if ${RIObj.MainIconIDExists[${Me.ID},295]}
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,168.80,82.79,412.03]
	}
	else
	{
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,171.08,86.52,386.60]
	}
}
function Pri()
{
	call CustomNamed "Wa'la'kra'na" "62.30,76.94,376.68" None
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,61.34,80.09,341.59]
	wait 300 ${Me.Distance[61.34,80.09,341.59]}<3
	call CustomNamed "Pri'ki'ori'ki" "61.34,80.09,341.59" None
}
function Agmork()
{
	call CustomNamed "Agmork the Almighty Angler-NMB-INC-NWM" "-65.04,118.31,272.58" AgmorkCustom
}
function AgmorkCustom(int _NamedID)
{
	call RIObj.Target ${_NamedID}
		
	if ${Actor[boss_tidal_wave_big_cube](exists)}
	{
		;echo trigger
		if ${Me.Distance[-65.04,118.31,272.58]}>3
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-65.04,118.31,272.58]
			wait 300 ${Me.Distance[-65.04,118.31,272.58]}<3
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-77.91,119.29,285.80]
		while ${Actor[boss_tidal_wave_big_cube](exists)}
		{
			if ${Actor[Query, Name=="a thrashing thrasher" && Distance<5 && Overlay=="thrash_idle"](exists)}
				Actor[Query, Name=="a thrashing thrasher" && Distance<5 && Overlay=="thrash_idle"]:DoubleClick
			wait 1
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-65.04,118.31,272.58]
	}
	elseif ${Actor[Query, Name=="fresh catch" && Type=="NoKill NPC"](exists)}
	{
		;echo catch
		if ${Me.Distance[-65.04,118.31,272.58]}>3
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-65.04,118.31,272.58]
			wait 300 ${Me.Distance[-65.04,118.31,272.58]}<3
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Query, Name=="fresh catch" && Type=="NoKill NPC"].Loc},5]
		while ${Actor[Query, Name=="fresh catch" && Type=="NoKill NPC"].Distance}>5 && !${Actor[boss_tidal_wave_big_cube](exists)}
		{
			wait 1
		}
		while ${Actor[Query, Name=="fresh catch" && Type=="NoKill NPC"](exists)} && !${Actor[boss_tidal_wave_big_cube](exists)}
		{
			Actor[Query, Name=="fresh catch" && Type=="NoKill NPC"]:DoubleClick
			wait 2
		}
	}
	elseif ${Actor[Query, Name=="a thrashing thrasher" && Distance<5 && Overlay=="thrash_idle"](exists)}
	{
		;echo thrasher
		variable int _ThrasherID
		_ThrasherID:Set[${Actor[Query, Name=="a thrashing thrasher" && Distance<5 && Overlay=="thrash_idle"].ID}]
		if ${Me.Distance[-65.04,118.31,272.58]}>3
		{
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-65.04,118.31,272.58]
			wait 300 ${Me.Distance[-65.04,118.31,272.58]}<3
		}
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[id,${_ThrasherID}].Loc},3]
		while ${Me.Distance[${Actor[id,${_ThrasherID}].Loc}]}>3 && !${Actor[boss_tidal_wave_big_cube](exists)}
		{
			wait 1
		}
		while ${Actor[id,${_ThrasherID}].Overlay.Equal[thrash_idle]} && !${Actor[boss_tidal_wave_big_cube](exists)}
		{
			Actor[id,${_ThrasherID}]:DoubleClick
			wait 2
		}
	}
	else
	{
		;echo none
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,-65.04,118.31,272.58]
	}
}

;End Sandstone Delta: Eye of the Storm

;Start Sandstone Delta: Eye of Night

function Palaendor()
{
	call CustomNamed "Crusader Palaendor-NWM" "326.05,143.57,-413.37" NONE
}

function Shadowscum()
{
	call CustomNamed "Shadowscum" "167.24,2.60,-525.31" NONE
}

function Granight()
{
	variable int _cnt=1
	relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,38.38,12.72,-311.77]
	while ${Actor[Tarsun].Distance}>15 && ${_cnt:Inc}<100
	{
		if !${RI_Var_Bool_GlobalOthers}
		{
			Actor[Tarsun]:DoTarget
		}
		wait 1
	}
	call CustomNamed "Granight-NLP-NWM" "0,0,0" GranightCustom
}
function GranightCustom(int _NamedID)
{
	if ${Actor[Query,(Name=-"Tarsun"&&IsDead=FALSE)||(Name=-"Brahmir"&&IsDead=FALSE)](exists)}
	{
		call RIObj.Target Tarsun Brahmir
		relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,22.82,13.22,-283.25]
	}
	elseif ${Actor[Query,(Name=-"Marig"&&IsDead=FALSE)](exists)}
	{
		if ${Actor[Marig].Distance}>5
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Marig].Loc},5]
		call RIObj.Target Marig
	}
	elseif ${Actor[Query,(Name=-"Kirat"&&IsDead=FALSE)](exists)}
	{
		if ${Actor[Kirat].Distance}>5
			relay ${RI_Var_String_RelayGroup} RIMUIObj:SetLockSpot[ALL,${Actor[Kirat].Loc},5]
		call RIObj.Target Kirat
	}
	else
		call RIObj.Target ${_NamedID}
}
function Ahuttam()
{
	call CustomNamed "Ahuttam the Sword's Breeze" "39.97,43.51,-460.53" NONE
}

function Nenmioseh()
{
	call CustomNamed "Nenmioseh the Night's Eye" "-213.99,96.58,-499.19" NONE
}
;End Sandstone Delta: Eye of Night

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;; End of RoR Zone CODING ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

